!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(j,g){if(!b[j]){if(!i[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(a){return a(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=b[j]={exports:{}};i[j][0].call(f.exports,function(p){var m=i[j][1][p];return k(m?m:p)},f,f.exports,d,i,b,l)}return b[j].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,r,l,h,j,f;if(this._events||(this._events={}),"error"===k&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[k],i(r)){return !1}if(b(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(m(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(g,j){function f(){this.removeListener(g,f),h||(h=!0,j.apply(this,arguments))}if(!b(j)){throw TypeError("listener must be a function")}var h=!1;return f.listener=j,this.on(g,f),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(m(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(u,s,l){function r(){o&&a&&(o=!1,a.length?f=a.concat(f):t=-1,f.length&&n())}function n(){if(!o){var g=h(r);o=!0;for(var j=f.length;j;){for(a=f,f=[];++t<j;){a&&a[t].run()}t=-1,j=f.length}a=null,o=!1,b(g)}}function i(g,j){this.fun=g,this.array=j}function B(){}var h,b,e=s.exports={};!function(){try{h=setTimeout}catch(g){h=function(){throw new Error("setTimeout is not defined")}}try{b=clearTimeout}catch(g){b=function(){throw new Error("clearTimeout is not defined")}}}();var a,f=[],o=!1,t=-1;e.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}f.push(new i(j,k)),1!==f.length||o||h(n,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=B,e.addListener=B,e.once=B,e.off=B,e.removeListener=B,e.removeAllListeners=B,e.emit=B,e.binding=function(g){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(g){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],3:[function(a,b,e){(function(cn,gk){function gC(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fU(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function h0(ac){if("function"==typeof ac.slice){return ac.slice(0)}var aa=new ArrayBuffer(ac.byteLength),ab=new Uint8Array(aa),t=new Uint8Array(ac);return ab.set(t),aa}function ge(ab){if(ab instanceof ArrayBuffer){return h0(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function er(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&et.call(aa)==je}function gO(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=gO(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(fU(ac)){return ge(ac)}if(!er(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=gO(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function jg(t){var aa=!1;return fs(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function fy(t){return fs(function(ac){ac=gO(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){cn.nextTick(function(){ad(ah,ag)})});var af=new gp(function(ah,aj){var al;try{var ag=jg(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function iD(ab,t){function aa(ah,ac,af){if(q.enabled){for(var aj=[ah._db_name,ac],ag=0;ag<af.length-1;ag++){aj.push(af[ag])}q.apply(null,aj);var ad=af[af.length-1];af[af.length-1]=function(ak,am){var al=[ah._db_name,ac];al=al.concat(ak?["error",ak]:["success",am]),q.apply(null,al),ad(ak,am)}}}return fy(fs(function(ad){if(this._closed){return gp.reject(new Error("database is closed"))}if(this._destroyed){return gp.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new gp(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function gf(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function gz(t){return t}function fW(t){return[{ok:t}]}function co(af,ab,am){function au(){var av=[];ad.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),am(null,{results:av})}function aq(){++ap===aj&&au()}function ak(aw,ax,av){ad[aw]={id:ax,docs:av},aq()}function aa(){if(!(al>=ag.length)){var av=Math.min(al+gR,ag.length),aw=ag.slice(al,av);ac(aw,al),al+=aw.length}}function ac(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=t[aC],aB=gf(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(gz);var ax=gz;0===aB.open_revs.length&&(delete aB.open_revs,ax=fW),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ab&&(aB[aD]=ab[aD])}),af.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),ak(ay,aC,aE),aa()})})}var ah=ab.docs,t={};ah.forEach(function(av){av.id in t?t[av.id].push(av):t[av.id]=[av]});var aj=Object.keys(t).length,ap=0,ad=new Array(aj),ag=Object.keys(t),al=0;aa()}function L(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fc(){return be}function fZ(t){L()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fc()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function hB(){i8.EventEmitter.call(this),this._listeners={},fZ(this)}function gM(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function iC(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function gd(t){var aa=0;return t||(aa=2000),iC(t,aa)}function iO(t,aa){gM("info","The above "+t+" is totally normal. "+aa)}function hn(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function fq(ac,aa,ab){function t(af){for(var ad in ac){"function"!=typeof ac[ad]&&(this[ad]=ac[ad])}void 0!==ab&&(this.name=ab),void 0!==af&&(this.reason=af)}return t.prototype=hn.prototype,new t(aa)}function fa(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=gu("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=hy:"doc_validation"===aa?(ad=fz,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=D),ad||(ad=gu("status",ac.status,af)||br),t=fq(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function g5(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return fq(D,ab)}}function a7(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&g5(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function hH(ac){for(var aa=[],ab=0,t=ac.length;t>ab;ab++){aa=aa.concat(ac[ab])}return aa}function iu(t){var aa;if(t?"string"!=typeof t?aa=fq(iB):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=fq(ez)):aa=fq(hM),aa){throw aa}}function gE(t,aa){return"listenerCount" in t?t.listenerCount(aa):i8.EventEmitter.listenerCount(t,aa)}function g9(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function g(t){var aa=g9(t);return aa?aa.join("/"):null}function iS(ab){for(var ad=ei.exec(ab),ag={},ac=14;ac--;){var aa=ij[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[hY]={},ag[ij[12]].replace(at,function(ak,aj,ah){aj&&(ag[hY][aj]=ah)}),ag}function hf(ab,t,aa){return new gp(function(ad,ac){ab.get(t,function(ag,aj){if(ag){if(404!==ag.status){return ac(ag)}aj={}}var af=aj._rev,ah=aa(aj);return ah?(ah._id=t,ah._rev=af,void ad(hU(ab,ah,aa))):ad({updated:!1,rev:af})})})}function hU(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return hf(ab,t._id,aa)})}function ii(t){return 0|Math.random()*t}function h2(ac,aa){aa=aa||dn.length;var ab="",t=-1;if(ac){for(;++t<ac;){ab+=dn[ii(aa)]}return ab}for(;++t<36;){switch(t){case 8:case 13:case 18:case 23:ab+="-";break;case 19:ab+=dn[3&ii(16)|8];break;default:ab+=dn[ii(16)]}}return ab}function gl(t){for(var ad,aa,ac,ab,am=t.rev_tree.slice();ab=am.pop();){var ag=ab.ids,al=ag[2],af=ab.pos;if(al.length){for(var ah=0,ak=al.length;ak>ah;ah++){am.push({pos:af+1,ids:al[ah]})}}else{var ap=!!ag[1].deleted,aj=ag[0];ad&&!(ac!==ap?ac:aa!==af?af>aa:aj>ad)||(ad=aj,aa=af,ac=ap)}}return aa+"-"+ad}function ib(af,ac){for(var ah,ak=af.slice();ah=ak.pop();){for(var aj=ah.pos,ag=ah.ids,ad=ag[2],aa=ac(0===ad.length,aj,ag[0],ah.ctx,ag[1]),t=0,ab=ad.length;ab>t;t++){ak.push({pos:aj+1,ids:ad[t],ctx:aa})}}}function gA(t,aa){return t.pos-aa.pos}function hL(ac){var aa=[];ib(ac,function(af,aj,ag,ad,ah){af&&aa.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),aa.sort(gA).reverse();for(var ab=0,t=aa.length;t>ab;ab++){delete aa[ab].pos}return aa}function w(ab){for(var ad=gl(ab),ag=hL(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function ex(t){var aa=[];return ib(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function iv(t){for(var ad,aa=[],ac=t.slice();ad=ac.pop();){var ab=ad.pos,am=ad.ids,ag=am[0],al=am[1],af=am[2],ah=0===af.length,ak=ad.history?ad.history.slice():[];ak.push({id:ag,opts:al}),ah&&aa.push({pos:ab+1-ak.length,ids:ak});for(var ap=0,aj=af.length;aj>ap;ap++){ac.push({pos:ab+1,ids:af[ap],history:ak})}}return aa.reverse()}function iW(t,aa){return t.pos-aa.pos}function ga(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function iM(ac,aa,ab){var t=ga(ac,aa,ab);ac.splice(t,0,aa)}function fg(ad,ab){for(var aa,t,ac=ab,ag=ad.length;ag>ac;ac++){var ah=ad[ac],af=[ah.id,ah.opts,[]];t?(t[2].push(af),t=af):aa=t=af}return aa}function ee(t,aa){return t[0]<aa[0]?-1:1}function iz(af,ac){for(var ah=[{tree1:af,tree2:ac}],ak=!1;ah.length>0;){var aj=ah.pop(),ag=aj.tree1,ad=aj.tree2;(ag[1].status||ad[1].status)&&(ag[1].status="available"===ag[1].status||"available"===ad[1].status?"available":"missing");for(var aa=0;aa<ad[2].length;aa++){if(ag[2][0]){for(var t=!1,ab=0;ab<ag[2].length;ab++){ag[2][ab][0]===ad[2][aa][0]&&(ah.push({tree1:ag[2][ab],tree2:ad[2][aa]}),t=!0)}t||(ak="new_branch",iM(ag[2],ad[2][aa],ee))}else{ak="new_leaf",ag[2][0]=ad[2][aa]}}}return{conflicts:ak,tree:af}}function fd(ag,aa,aj){var am,av=[],ab=!1,ac=!1;if(!ag.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=ag.length;aw>ak;ak++){var al=ag[ak];if(al.pos===aa.pos&&al.ids[0]===aa.ids[0]){am=iz(al.ids,aa.ids),av.push({pos:al.pos,ids:am.tree}),ab=ab||am.conflicts,ac=!0}else{if(aj!==!0){var ap=al.pos<aa.pos?al:aa,ad=al.pos<aa.pos?aa:al,af=ad.pos-ap.pos,t=[],ax=[];for(ax.push({ids:ap.ids,diff:af,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],aq=0,ah=az.length;ah>aq;aq++){ax.push({ids:az[aq],diff:ay.diff-1,parent:ay.ids,parentIdx:aq})}}else{ay.ids[0]===ad.ids[0]&&t.push(ay)}}var au=t[0];au?(am=iz(au.ids,ad.ids),au.parent[2][au.parentIdx]=am.tree,av.push({pos:ap.pos,ids:ap.ids}),ab=ab||am.conflicts,ac=!0):av.push(al)}else{av.push(al)}}}return ac||av.push(aa),av.sort(iW),{tree:av,conflicts:ab||"internal_node"}}function j(t,ad){for(var aa,ac=iv(t),ab={},am=0,ag=ac.length;ag>am;am++){for(var al=ac[am],af=al.ids,ah=Math.max(0,af.length-ad),ak={pos:al.pos+ah,ids:fg(af,ah)},ap=0;ah>ap;ap++){var aj=al.pos+ap+"-"+af[ap].id;ab[aj]=!0}aa=aa?fd(aa,ak,!0).tree:[ak]}return ib(aa,function(au,av,aq){delete ab[av+"-"+aq]}),{tree:aa,revs:Object.keys(ab)}}function fu(ac,t,aa){var ad=fd(ac,t),ab=j(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function iT(af,ac){for(var ah,ak=af.slice(),aj=ac.split("-"),ag=parseInt(aj[0],10),ad=aj[1];ah=ak.pop();){if(ah.pos===ag&&ah.ids[0]===ad){return !0}for(var aa=ah.ids[2],t=0,ab=aa.length;ab>t;t++){ak.push({pos:ah.pos+1,ids:aa[t]})}}return !1}function fi(t){return t.ids}function h1(ac,t){t||(t=gl(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(fi);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function im(t){return/^_local/.test(t)}function an(t){return hw("return "+t+";",{})}function jB(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function P(ab,t){try{ab.emit("change",t)}catch(aa){gM("error",'Error in .on("change", function):',aa)}}function gX(ab,ad,ag){function ac(){aa.cancel()}i8.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?gO(ad):{};var t=ad.complete=jg(function(ah,aj){ah?gE(aa,"error")>0&&aa.emit("error",ah):aa.emit("complete",aj),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(P(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new gp(function(ah,aj){ad.complete=function(al,ak){al?aj(al):ah(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function gI(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=hL(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return h1(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=w(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function i1(t,aa){return aa>t?-1:t>aa?1:0}function i6(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function a3(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function gK(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=gf(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function hZ(ac,t){var aa=i1(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return i1(ad,ab)}function ar(ab){var t={},aa=[];return ib(ab,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(t[ah]=0),void 0!==ag&&aa.push({from:ag,to:ah}),ah}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function jE(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return gp.all(ad.map(function(af){var ag=g8.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new gp(function(ah,aj){ac._allDocs(ag,function(ak,al){return ak?aj(ak):(ab.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function iN(ac){var aa=ac._compactionQueue[0],t=aa.opts,ab=aa.callback;ac.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(t.last_seq=ad.last_seq),ac._compact(t,function(ag,af){ag?ab(ag):ab(null,af),cn.nextTick(function(){ac._compactionQueue.shift(),ac._compactionQueue.length&&iN(ac)})})})}function hA(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function go(){i8.EventEmitter.call(this)}function ja(){this.isReady=!1,this.failed=!1,this.queue=[]}function eu(t){t&&gk.debug&&gM("error",t)}function g4(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function a9(ab,ad,ag){if(!(this instanceof a9)){return new a9(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=eu}else{var aa=ag;ag=function(){return gM("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=gO(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=a9.prefix,go.call(ac),ac.taskqueue=new ja;var af=new gp(function(ak,ah){ag=function(ap,am){return ap?ah(ap):(delete am.then,void ak(am))},ad=gO(ad);var aj,al;return function(){try{if("string"!=typeof ab){throw al=new Error("Missing/invalid DB name"),al.code=400,al}var ap=(ad.prefix||"")+ab;if(aj=a9.parseAdapter(ap,ad),ad.originalName=ab,ad.name=aj.name,ad.adapter=ad.adapter||aj.adapter,ac._adapter=ad.adapter,gN("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!a9.adapters[ad.adapter]){throw al=new Error("Adapter is missing"),al.code=404,al}if(!a9.adapters[ad.adapter].valid()){throw al=new Error("Invalid Adapter"),al.code=404,al}}catch(am){ac.taskqueue.fail(am)}}(),al?ah(al):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void a9.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(g4(ac,ad),ac.emit("created",ac),a9.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function ih(t){Object.keys(i8.EventEmitter.prototype).forEach(function(ab){"function"==typeof i8.EventEmitter.prototype[ab]&&(t[ab]=fX[ab].bind(fX))});var aa=t._destructionListeners=new he.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function jd(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function fv(ac){if(!/^\d+\-./.test(ac)){return fq(fm)}var aa=ac.indexOf("-"),ab=ac.substring(0,aa),t=ac.substring(aa+1);return{prefix:parseInt(ab,10),id:t}}function hv(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function bn(af,ac){var ah,ak,aj,ag={status:"available"};if(af._deleted&&(ag.deleted=!0),ac){if(af._id||(af._id=h2()),ak=h2(32,16).toLowerCase(),af._rev){if(aj=fv(af._rev),aj.error){return aj}af._rev_tree=[{pos:aj.prefix,ids:[aj.id,{status:"missing"},[[ak,ag,[]]]]}],ah=aj.prefix+1}else{af._rev_tree=[{pos:1,ids:[ak,ag,[]]}],ah=1}}else{if(af._revisions&&(af._rev_tree=hv(af._revisions,ag),ah=af._revisions.start,ak=af._revisions.ids[0]),!af._rev_tree){if(aj=fv(af._rev),aj.error){return aj}ah=aj.prefix,ak=aj.id,af._rev_tree=[{pos:ah,ids:[ak,ag,[]]}]}}iu(af._id),af._rev=ah+"-"+ak;var ad={metadata:{},data:{}};for(var aa in af){if(Object.prototype.hasOwnProperty.call(af,aa)){var t="_"===aa[0];if(t&&!iX[aa]){var ab=fq(fz,aa);throw ab.message=fz.message+": "+aa,ab}t&&!gv[aa]?ad.metadata[aa.slice(1)]=af[aa]:ad.data[aa]=af[aa]}}return ad}function gh(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function jl(t){return h3(gh(t))}function js(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function hE(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function hX(t,aa){return js([hE(t)],{type:aa})}function jq(t,aa){return hX(gT(t),aa)}function fh(ac,aa){if("undefined"==typeof FileReader){return aa(gh((new FileReaderSync).readAsArrayBuffer(ac)))}var ab=new FileReader,t="function"==typeof ab.readAsBinaryString;ab.onloadend=function(af){var ad=af.target.result||"";return t?aa(ad):void aa(gh(ad))},t?ab.readAsBinaryString(ac):ab.readAsArrayBuffer(ac)}function O(t,aa){fh(t,function(ab){aa(h3(ab))})}function hz(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function i3(t){return h3(t)}function y(ac,aa,ab,t){(ab>0||t<aa.byteLength)&&(aa=new Uint8Array(aa,ab,Math.min(t,aa.byteLength)-ab)),ac.append(aa)}function jt(ac,aa,ab,t){(ab>0||t<aa.length)&&(aa=aa.substring(ab,t)),ac.appendBinary(aa)}function H(af,ac){function ah(){var aq=aa*ag,al=aq+ag;if(aa++,ad>aa){ab(t,af,aq,al),iU(ah)}else{ab(t,af,aq,al);var ap=t.end(!0),am=i3(ap);ac(am),t.destroy()}}var ak="string"==typeof af,aj=ak?af.length:af.byteLength,ag=Math.min(ht,aj),ad=Math.ceil(aj/ag),aa=0,t=ak?new gx:new gx.ArrayBuffer,ab=ak?jt:y;ah()}function iy(t){return gx.hash(t)}function gy(ad,ab,aa){function t(al){try{return gT(al)}catch(aj){var ak=fq(hG,"Attachment is not a valid base64 string");return{error:ak}}}function ac(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=t(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ab?aj.data=hX(al,aj.content_type):"base64"===ab?aj.data=h3(al):aj.data=al,H(al,function(am){aj.digest="md5-"+am,ak()})}else{hz(aj.data,function(am){"binary"===ab?aj.data=gh(am):"base64"===ab&&(aj.data=jl(am)),H(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ag(){af++,ad.length===af&&(ah?aa(ah):aa())}if(!ad.length){return aa()}var ah,af=0;ad.forEach(function(ak){function am(aq){ah=aq,al++,al===aj.length&&ag()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ag()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ac(ak.data._attachments[ap],am)}})}function ix(av,al,ax,af,ay,ag,aa,t){if(iT(al.rev_tree,ax.metadata.rev)){return af[ay]=ax,ag()}var az=al.winningRev||gl(al),au="deleted" in al?al.deleted:h1(al,az),ah="deleted" in ax.metadata?ax.metadata.deleted:h1(ax.metadata),aq=/^1-/.test(ax.metadata.rev);if(au&&!ah&&t&&aq){var aw=ax.data;aw._rev=az,aw._id=ax.metadata.id,ax=bn(aw,t)}var ac=fu(al.rev_tree,ax.metadata.rev_tree[0],av),aA=t&&(au&&ah||!au&&"new_leaf"!==ac.conflicts||au&&!ah&&"new_branch"===ac.conflicts);if(aA){var am=fq(hg);return af[ay]=am,ag()}var ak=ax.metadata.rev;ax.metadata.rev_tree=ac.tree,ax.stemmedRevs=ac.stemmedRevs||[],al.rev_map&&(ax.metadata.rev_map=al.rev_map);var ad,aj=gl(ax.metadata),ap=h1(ax.metadata,aj),ab=au===ap?0:ap>au?-1:1;ad=ak===aj?ap:h1(ax.metadata,ak),aa(ax,aj,ap,ad,!0,ab,ay,ag)}function z(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jD(aq,ad,af,am,ak,t,ah,ac,al){function aj(aw,aA,aC){var az=gl(aw.metadata),ax=h1(aw.metadata,az);if("was_delete" in ac&&ax){return t[aA]=fq(hy,"deleted"),aC()}var ay=ab&&z(aw);if(ay){var av=fq(hg);return t[aA]=av,aC()}var aB=ax?0:1;ah(aw,az,ax,ax,!1,aB,aA,aC)}function aa(){++ag===ap&&al&&al()}aq=aq||1000;var ab=ac.new_edits,au=new he.Map,ag=0,ap=ad.length;ad.forEach(function(ay,aw){if(ay._id&&im(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void af[av](ay,{ctx:ak},function(aA,az){t[aw]=aA||az,aa()})}var ax=ay.metadata.id;au.has(ax)?(ap--,au.get(ax).push([ay,aw])):au.set(ax,[[ay,aw]])}),au.forEach(function(aw,ay){function az(){++ax<aw.length?av():aa()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(am.has(ay)){ix(aq,am.get(ay),aA,t,aB,az,ah,ab)}else{var aD=fu([],aA.metadata.rev_tree[0],aq);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],aj(aA,aB,az)}}var ax=0;av()})}function hT(t){try{return JSON.parse(t)}catch(aa){return g1.parse(t)}}function jn(t){return t.length<50000?JSON.parse(t):hT(t)}function ci(t){try{return JSON.stringify(t)}catch(aa){return g1.stringify(t)}}function a8(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function jc(t){if(!gS.running&&gS.queue.length){gS.running=!0;var aa=gS.queue.shift();aa.action(function(ac,ab){a8(aa.callback,this,[ac,ab],t),gS.running=!1,cn.nextTick(function(){jc(t)})})}}function ji(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(fq(gt,aa,ab.type))}}function R(ab,t,aa){return{data:ci(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function jy(t){if(!t){return null}var aa=jn(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function S(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function ig(ac,aa,ab,t){ab?t(ac?"string"!=typeof ac?ac:jq(ac,aa):js([""],{type:aa})):ac?"string"!=typeof ac?fh(ac,function(ad){t(h3(ad))}):t(ac):t("")}function i2(ad,ab,aa,t){function ac(){++af===ah.length&&t&&t()}function ag(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=aa.objectStore(en).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ac()}}var ah=Object.keys(ad._attachments||{});if(!ah.length){return t&&t()}var af=0;ah.forEach(function(aj){ab.attachments&&ab.include_docs?ag(ad,aj):(ad._attachments[aj].stub=!0,ac())})}function jk(t,aa){return gp.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return gp.all(ab.map(function(af){var ah=ac.doc._attachments[af];if("body" in ah){var ag=ah.body,ad=ah.content_type;return new gp(function(aj){ig(ag,ad,aa,function(ak){ac.doc._attachments[af]=g8.extend(gf(ah,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function hN(af,ac,ah){function ak(){ab--,ab||aj()}function aj(){ag.length&&ag.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aa["delete"](am)}})}var ag=[],ad=ah.objectStore(h8),aa=ah.objectStore(en),t=ah.objectStore(o),ab=af.length;af.forEach(function(al){var am=ad.index("_doc_id_rev"),ap=ac+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return ak()}ad["delete"](aq);var au=t.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];ag.push(ay),t["delete"](ax.primaryKey),ax["continue"]()}else{ak()}}}})}function dt(ac,aa,ab){try{return{txn:ac.transaction(aa,ab)}}catch(t){return{error:t}}}function iw(aH,ay,ax,am,ah,aF,aj){function aG(){var aN=[ik,h8,en,iR,o],aO=dt(ah,aN,"readwrite");return aO.error?aj(aO.error):(ag=aO.txn,ag.onabort=ji(aj),ag.ontimeout=ji(aj),ag.oncomplete=aI,aB=ag.objectStore(ik),aC=ag.objectStore(h8),aq=ag.objectStore(en),al=ag.objectStore(o),void aM(function(aP){return aP?(aE=!0,aj(aP)):void aL()}))}function aD(){jD(aH.revs_limit,ab,am,aw,ag,aa,au,ax)}function aL(){function aO(){++aT===ab.length&&aD()}function aQ(aU){var aV=jy(aU.target.result);aV&&aw.set(aV.id,aV),aO()}if(ab.length){for(var aT=0,aP=0,aN=ab.length;aN>aP;aP++){var aR=ab[aP];if(aR._id&&im(aR._id)){aO()}else{var aS=aB.get(aR.metadata.id);aS.onsuccess=aQ}}}}function aI(){aE||(aF.notify(am._meta.name),am._meta.docCount+=aA,aj(null,aa))}function ap(aO,aP){var aN=aq.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=fq(fV,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(ab.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){ap(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function au(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?az(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(aZ){var bb=aP.stemmedRevs||[];aV&&am.auto_compaction&&(bb=bb.concat(ex(aP.metadata))),bb&&bb.length&&hN(bb,aP.metadata.id,ag),aT.seq=aZ.target.result,delete aT.rev;var bc=R(aT,aW,aU),ba=aB.put(bc);ba.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=aC.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=aC.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aa[aS]={ok:!0,id:aT.id,rev:aW},aw.set(aP.metadata.id,aP.metadata),aJ(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=aC.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function az(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;av(ba,bb,aV)}})}function aJ(aR,aU,aP){function aS(){++aN===aO.length&&aP()}function aQ(aX){var aV=aR.data._attachments[aX].digest,aW=al.put({seq:aU,digestSeq:aV+"::"+aU});aW.onsuccess=aS,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aS()}}var aN=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function av(aO,aQ,aN){var aP=aq.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=aq.put(aS);aT.onsuccess=aN}}for(var ag,aB,aC,aq,al,ak,ab=ay.docs,aA=0,ac=0,af=ab.length;af>ac;ac++){var t=ab[ac];t._id&&im(t._id)||(t=ab[ac]=bn(t,ax.new_edits),t.error&&!ak&&(ak=t))}if(ak){return aj(ak)}var aa=new Array(ab.length),aw=new he.Map,aE=!1,aK=am._meta.blobSupport?"blob":"base64";gy(ab,aK,function(aN){return aN?aj(aN):void aG()})}function jj(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function gr(ac,aa,ab,t){return"DataError"===ab.name&&0===ab.code?t(null,{total_rows:ac._meta.docCount,offset:aa.skip,rows:[]}):void t(fq(gt,ab.name,ab.message))}function hs(ac,t,aa,ad){function ab(aC,ax){function am(aM,aN,aL){var aK=aM.id+"::"+aL;az.get(aK).onsuccess=function(aO){aN.doc=S(aO.target.result),aC.conflicts&&(aN.doc._conflicts=w(aM)),i2(aN.doc,aC,aI)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===aC.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):aC.include_docs&&am(aK,aM,aO)}else{if(!aN&&aD--<=0&&(aJ.push(aM),aC.include_docs&&am(aK,aM,aO),0===--ah)){return}}aL["continue"]()}function aq(aL){ag=t._meta.docCount;var aN=aL.target.result;if(aN){var aM=jy(aN.value),aK=aM.winningRev;av(aN,aK,aM)}}function ay(){ax(null,{total_rows:ag,offset:aC.skip,rows:aJ})}function aE(){aC.attachments?jk(aJ,aC.binary).then(ay):ay()}var au="startkey" in aC?aC.startkey:!1,aA="endkey" in aC?aC.endkey:!1,aj="key" in aC?aC.key:!1,aD=aC.skip||0,ah="number"==typeof aC.limit?aC.limit:-1,aH=aC.inclusive_end!==!1,aG="descending" in aC&&aC.descending?"prev":null,aw=jj(au,aA,aH,aj,aG);if(aw&&aw.error){return gr(t,aC,aw.error,ax)}var aB=[ik,h8];aC.attachments&&aB.push(en);var ak=dt(aa,aB,"readonly");if(ak.error){return ax(ak.error)}var aI=ak.txn,al=aI.objectStore(ik),ap=aI.objectStore(h8),aF=aG?al.openCursor(aw,aG):al.openCursor(aw),az=ap.index("_doc_id_rev"),aJ=[],ag=0;aI.oncomplete=aE,aF.onsuccess=aq}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:t._meta.docCount,offset:ag.skip,rows:[]}):void ab(ag,ah)}af(ac,ad)}function jA(t){return new gp(function(ab){var aa=js([""]);t.objectStore(jh).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function I(ab,t){var aa=this;gS.queue.push({action:function(ac){jx(aa,ab,ac)},callback:t}),jc(aa.constructor)}function jx(ap,am,ah){function af(au){var av=au.createObjectStore(ik,{keyPath:"id"});au.createObjectStore(h8,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(en,{keyPath:"digest"}),au.createObjectStore(v,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jh),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(iR,{keyPath:"_id"});var aw=au.createObjectStore(o,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ad(au,av){var aw=au.objectStore(ik);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=h1(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function aj(au){au.createObjectStore(iR,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aq(ax,av){var aw=ax.objectStore(iR),az=ax.objectStore(ik),ay=ax.objectStore(h8),au=az.openCursor();au.onsuccess=function(aG){var aJ=aG.target.result;if(aJ){var aD=aJ.value,aA=aD.id,aB=im(aA),aE=gl(aD);if(aB){var aH=aA+"::"+aE,aK=aA+"::",aF=aA+"::~",aI=ay.index("_doc_id_rev"),aL=IDBKeyRange.bound(aK,aF,!1,!1),aC=aI.openCursor(aL);aC.onsuccess=function(aN){if(aC=aN.target.result){var aM=aC.value;aM._doc_id_rev===aH&&aw.put(aM),ay["delete"](aC.primaryKey),aC["continue"]()}else{az["delete"](aJ.primaryKey),aJ["continue"]()}}}else{aJ["continue"]()}}else{av&&av()}}}function ac(au){var av=au.createObjectStore(o,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ab(ax,av){var aw=ax.objectStore(h8),az=ax.objectStore(en),ay=ax.objectStore(o),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aI){var aC=aI.target.result;if(!aC){return av()}for(var aD=aC.value,aK=aC.primaryKey,aG=Object.keys(aD._attachments||{}),aE={},aF=0;aF<aG.length;aF++){var aH=aD._attachments[aG[aF]];aE[aH.digest]=!0}var aJ=Object.keys(aE);for(aF=0;aF<aJ.length;aF++){var aL=aJ[aF];ay.put({seq:aK,digestSeq:aL+"::"+aK})}aC["continue"]()}):av()}}function al(av){function au(az){return az.data?jy(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(h8),ax=av.objectStore(ik),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=R(aD,aD.winningRev,aD.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=au(aA.value);return aD.winningRev=aD.winningRev||gl(aD),aD.seq?az():void aB()}}}var ag=am.name,ak=null;ap._meta=null,ap.type=function(){return"idb"},ap._id=fy(function(au){au(null,ap._meta.instanceId)}),ap._bulkDocs=function(aw,av,au){iw(am,aw,av,ap,ak,hQ,au)},ap._get=function(aA,aw,ax){function aC(){ax(az,{doc:aB,metadata:au,ctx:av})}var aB,au,az,av=aw.ctx;if(!av){var ay=dt(ak,[ik,h8,en],"readonly");if(ay.error){return ax(ay.error)}av=ay.txn}av.objectStore(ik).get(aA).onsuccess=function(aG){if(au=jy(aG.target.result),!au){return az=fq(hy,"missing"),aC()}if(h1(au)&&!aw.rev){return az=fq(hy,"deleted"),aC()}var aE=av.objectStore(h8),aD=aw.rev||au.winningRev,aF=au.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aB=aH.target.result,aB&&(aB=S(aB)),aB?void aC():(az=fq(hy,"missing"),aC())}}},ap._getAttachment=function(aA,aw,ax,aC,aB){var au;if(aC.ctx){au=aC.ctx}else{var az=dt(ak,[ik,h8,en],"readonly");if(az.error){return aB(az.error)}au=az.txn}var av=ax.digest,ay=ax.content_type;au.objectStore(en).get(av).onsuccess=function(aE){var aD=aE.target.result.body;ig(aD,ay,aC.binary,function(aF){aB(null,aF)})}},ap._info=function(av){if(null===ak||!ff.has(ag)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,ay,au=dt(ak,[h8],"readonly");if(au.error){return av(au.error)}var aw=au.txn,ax=aw.objectStore(h8).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,ay=ap._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:az,idb_attachment_format:ap._meta.blobSupport?"binary":"base64"})}},ap._allDocs=function(av,au){hs(av,ap,ak,au)},ap._changes=function(az){function aG(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aC=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=av.get(aU);aT.onsuccess=function(aV){aO(S(aV.target.result))}}function aO(aU){var aT=az.processChange(aU,aN,az);aT.seq=aN.seq;var aV=au(aT);return"object"==typeof aV?az.complete(aV):(aV&&(aJ++,ax&&aA.push(aT),az.attachments&&az.include_docs?i2(aU,az,aK,function(){jk([aT],az.binary).then(function(){az.onChange(aT)})}):az.onChange(aT)),void (aJ!==aH&&aS["continue"]()))}var aQ=S(aS.value),aR=aS.key;if(aD&&!aD.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aw.get(aQ._id).onsuccess=function(aT){aN=jy(aT.target.result),ay.set(aQ._id,aN),aM()})}function aI(aN){var aM=aN.target.result;aM&&aG(aM)}function aL(){var aM=[ik,h8];az.attachments&&aM.push(en);var aN=dt(ak,aM,"readonly");if(aN.error){return az.complete(aN.error)}aK=aN.txn,aK.onabort=ji(az.complete),aK.oncomplete=aF,aB=aK.objectStore(h8),aw=aK.objectStore(ik),av=aB.index("_doc_id_rev");var aO;aO=az.descending?aB.openCursor(null,"prev"):aB.openCursor(IDBKeyRange.lowerBound(az.since,!0)),aO.onsuccess=aI}function aF(){function aM(){az.complete(null,{results:aA,last_seq:aC})}!az.continuous&&az.attachments?jk(aA).then(aM):aM()}if(az=gO(az),az.continuous){var aE=ag+":"+h2();return hQ.addListener(ag,aE,ap,az),hQ.notify(ag),{cancel:function(){hQ.removeListener(ag,aE)}}}var aD=az.doc_ids&&new he.Set(az.doc_ids);az.since=az.since||0;var aC=az.since,aH="limit" in az?az.limit:-1;0===aH&&(aH=1);var ax;ax="return_docs" in az?az.return_docs:"returnDocs" in az?az.returnDocs:!0;var aK,aB,aw,av,aA=[],aJ=0,au=a7(az),ay=new he.Map;aL()},ap._close=function(au){return null===ak?au(fq(ew)):(ak.close(),ff["delete"](ag),ak=null,void au())},ap._getRevisionTree=function(av,au){var aw=dt(ak,[ik],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(ik).get(av);ay.onsuccess=function(aA){var az=jy(aA.target.result);az?au(null,az.rev_tree):au(fq(hy))}},ap._doCompaction=function(aA,av,ay){var ax=[ik,h8,en,o],az=dt(ak,ax,"readwrite");if(az.error){return ay(az.error)}var au=az.txn,aw=au.objectStore(ik);aw.get(aA).onsuccess=function(aC){var aE=jy(aC.target.result);ib(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),hN(av,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(ik).put(R(aE,aD,aB))},au.onabort=ji(ay),au.oncomplete=function(){ay()}},ap._getLocal=function(av,au){var aw=dt(ak,[iR],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(iR).get(av);ay.onerror=ji(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(fq(hy))}},ap._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=dt(ak,[iR],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=ji(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(iR);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(fq(hg))}}):(az=aC.add(aD),az.onerror=function(aE){aA(fq(hg)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ap._removeLocal=function(aA,aw,ax){"function"==typeof aw&&(ax=aw,aw={});var aC=aw.ctx;if(!aC){var aB=dt(ak,[iR],"readwrite");if(aB.error){return ax(aB.error)}aC=aB.txn,aC.oncomplete=function(){au&&ax(null,au)}}var au,az=aA._id,av=aC.objectStore(iR),ay=av.get(az);ay.onerror=ji(ax),ay.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aA._rev?(av["delete"](az),au={ok:!0,id:az,rev:"0-0"},aw.ctx&&ax(null,au)):ax(fq(hy))}},ap._destroy=function(av,ax){hQ.removeAllListeners(ag);var au=jr.get(ag);au&&au.result&&(au.result.close(),ff["delete"](ag));var aw=indexedDB.deleteDatabase(ag);aw.onsuccess=function(){jr["delete"](ag),fc()&&ag in localStorage&&delete localStorage[ag],ax(null,{ok:!0})},aw.onerror=ji(ax)};var aa=ff.get(ag);if(aa){return ak=aa.idb,ap._meta=aa.global,void cn.nextTick(function(){ah(null,ap)})}var t;t=am.storage?fx(ag,am.storage):indexedDB.open(ag,g2),jr.set(ag,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return af(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&aj(az),av.oldVersion<4&&ac(az);var ay=[ad,aq,ab,al],au=av.oldVersion;ax()},t.onsuccess=function(az){ak=az.target.result,ak.onversionchange=function(){ak.close(),ff["delete"](ag)},ak.onabort=function(aA){gM("error","Database has a global failure",aA.target.error),ak.close(),ff["delete"](ag)};var aw=ak.transaction([v,jh,ik],"readwrite"),ay=aw.objectStore(v).get(v),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(ap._meta={name:ag,instanceId:au,blobSupport:av,docCount:ax},ff.set(ag,{idb:ak,global:ap._meta}),ah(null,ap))},aA=aB.target.result||{id:v};ag+"_id" in aA?(au=aA[ag+"_id"],aD()):(au=h2(),aA[ag+"_id"]=au,aw.objectStore(v).put(aA).onsuccess=function(){aD()}),fo||(fo=jA(aw)),fo.then(function(aE){av=aE,aD()});var aC=aw.objectStore(ik).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";gM("error",au),ah(fq(gt,au))}}function fx(ab,t){try{return indexedDB.open(ab,{version:g2,storage:t})}catch(aa){return indexedDB.open(ab,g2)}}function hq(t){t.adapter("idb",I,!0)}function jv(t){return decodeURIComponent(escape(t))}function gn(t){return 65>t?t-48:t-55}function Y(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(gn(ac.charCodeAt(aa++))<<4|gn(ac.charCodeAt(aa++)))}return t}function hk(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(gn(ac.charCodeAt(aa+2))<<12|gn(ac.charCodeAt(aa+3))<<8|gn(ac.charCodeAt(aa))<<4|gn(ac.charCodeAt(aa+1))),aa+=4}return t}function gj(t,aa){return"UTF-8"===aa?jv(Y(t,0,t.length)):hk(t,0,t.length)}function id(t){return"'"+t+"'"}function iJ(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function it(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function iI(t){return delete t._id,delete t._rev,JSON.stringify(t)}function ft(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function gQ(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function a6(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function iH(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+dr+" WHERE seq IN "+gQ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+dr+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+dr+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new he.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+dr+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+hh+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(ah){var aj="SELECT seq FROM "+hD+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ad,ah],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+hD+" WHERE seq=?",[ak],ac)})})}}function a2(t){return function(ad){gM("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(fq(fn,ab,ac))}}function ie(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function hW(aj,aa,aB,av,au,ad,af){function ax(){return am?af(am):(ad.notify(av._name),av._docCount=-1,void af(null,ac))}function ab(aD,aE){var aC="SELECT count(*) as cnt FROM "+hh+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=fq(fV,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aw(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ab(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function al(aD,aK,aP,aF,aH,aN,aI,aL){function aQ(){function aV(bc,ba){function bb(){return ++bg===bd.length&&ba(),!1}function aZ(bj){var bi="INSERT INTO "+dr+" (digest, seq) VALUES (?,?)",bh=[aW._attachments[bj].digest,bc];ap.executeSql(bi,bh,bb,bb)}var bg=0,bd=Object.keys(aW._attachments||{});if(!bd.length){return ba()}for(var bf=0;bf<bd.length;bf++){aZ(bd[bf])}}var aW=aD.data,aT=aF?1:0,aY=aW._id,aU=aW._rev,aS=iI(aW),aR="INSERT INTO "+hD+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aX=[aY,aU,aS,aT];ap.executeSql(aR,aX,function(ba,bb){var aZ=bb.insertId;aV(aZ,function(){aC(ba,aZ)})},function(){var aZ=a6("seq",hD,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aY,aU],function(bd,bc){var bb=bc.rows.item(0).seq,bf="UPDATE "+hD+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aS,aT,aY,aU];bd.executeSql(bf,ba,function(bg){aV(bb,function(){aC(bg,bb)})})}),!1})}function aE(aR){aG||(aR?(aG=aR,aL(aG)):aM===aO.length&&aQ())}function aJ(aR){aM++,aE(aR)}function aC(aR,aS){var aW=aD.metadata.id,aX=aD.stemmedRevs||[];aH&&av.auto_compaction&&(aX=ex(aD.metadata).concat(aX)),aX.length&&iH(aX,aW,aR),aD.metadata.seq=aS,delete aD.metadata.rev;var aV=aH?"UPDATE "+i9+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+hD+" WHERE doc_id="+i9+".id AND rev=?) WHERE id=?":"INSERT INTO "+i9+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aU=ci(aD.metadata),aT=aH?[aU,aS,aK,aW]:[aW,aS,aS,aU];aR.executeSql(aV,aT,function(){ac[aI]={ok:!0,id:aD.metadata.id,rev:aK},ah.set(aW,aD.metadata),aL()})}var aG=null,aM=0;aD.data._id=aD.metadata.id,aD.data._rev=aD.metadata.rev;var aO=Object.keys(aD.data._attachments||{});aF&&(aD.data._deleted=!0),aO.forEach(function(aS){var aU=aD.data._attachments[aS];if(aU.stub){aM++,aE()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aK,10);var aR=aU.digest;t(aR,aT,aJ)}}),aO.length||aQ()}function ag(){jD(aj.revs_limit,aq,av,ah,ap,ac,al,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&im(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+i9+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=jn(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function t(aD,aF,aC){var aE="SELECT digest FROM "+hh+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+hh+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iJ(aF)],function(){aC()},function(){return aC(),!1}))})}var ay=aB.new_edits,aA=aa.docs,aq=aA.map(function(aC){if(aC._id&&im(aC._id)){return aC}var aD=bn(aC,ay);return aD}),ak=aq.filter(function(aC){return aC.error});if(ak.length){return af(ak[0])}var ap,am,ac=new Array(aq.length),ah=new he.Map;gy(aq,"binary",function(aC){return aC?af(aC):void au.transaction(function(aD){ap=aD,aw(function(aE){aE?am=aE:az(ag)})},a2(af),ax)})}function T(t){return t.websql(t.name,t.version,t.description,t.size)}function gH(t){try{return{db:T(t)}}catch(aa){return{error:aa}}}function jp(t){var aa=i0.get(t.name);return aa||(aa=gH(t),i0.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function E(ah,af,aa,ab,aj){function ag(){++t===ac.length&&aj&&aj()}function ad(am,ak){var al=am._attachments[ak],ap={binary:af.binary,ctx:ab};aa._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=g8.extend(gf(al,["digest","content_type"]),{data:aq}),ag()})}var ac=Object.keys(ah._attachments||{});if(!ac.length){return aj&&aj()}var t=0;ac.forEach(function(ak){af.attachments&&af.include_docs?ad(ah,ak):(ah._attachments[ak].stub=!0,ag())})}function fS(ak,ay){function al(){fc()&&(window.localStorage["_pouch__websqldb_"+ag._name]=!0),ay(null,ag)}function aw(aD,aE){aD.executeSql(r),aD.executeSql("ALTER TABLE "+hD+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(V),aD.executeSql("ALTER TABLE "+i9+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+i9+" (local, id)");var aF="SELECT "+i9+".winningseq AS seq, "+i9+".json AS metadata FROM "+hD+" JOIN "+i9+" ON "+hD+".seq = "+i9+".winningseq";aD.executeSql(aF,[],function(aH,aL){for(var aI=[],aN=[],aM=0;aM<aL.rows.length;aM++){var aK=aL.rows.item(aM),aJ=aK.seq,aG=JSON.parse(aK.metadata);h1(aG)&&aI.push(aJ),im(aG.id)&&aN.push(aG.id)}aH.executeSql("UPDATE "+i9+"SET local = 1 WHERE id IN "+gQ(aN.length),aN,function(){aH.executeSql("UPDATE "+hD+" SET deleted = 1 WHERE seq IN "+gQ(aI.length),aI,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hu+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+i9+".id AS id, "+hD+".json AS data FROM "+hD+" JOIN "+i9+" ON "+hD+".seq = "+i9+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+hu+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+i9+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+hD+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function aC(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aN=aH.shift(),aJ=gj(aN.hex,ab),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+hD+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aI()})}aI()}var aF="ALTER TABLE "+hD+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+hD+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(hV,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+hD;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function aa(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+hh;aI.executeSql(aH,[],function(aO,aM){function aJ(){var aP=a6(hm+", "+i9+".id AS id",[i9,hD],jf,null,i9+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aQ){function aW(bc,bd){var bf=aY[bc]=aY[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aQ.rows.length){return aG(ba)}for(var aY={},aU=0;aU<aQ.rows.length;aU++){for(var aS=aQ.rows.item(aU),aT=ft(aS.data,aS.id,aS.rev),aX=Object.keys(aT._attachments||{}),aV=0;aV<aX.length;aV++){var aZ=aT._attachments[aX[aV]];aW(aZ.digest,aS.seq)}}var bb=[];if(Object.keys(aY).forEach(function(bc){var bd=aY[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aJ()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+dr+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+dr+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(ir,[],function(aI){aI.executeSql(il,[],aD)})})}function am(aE,aF){var aD="ALTER TABLE "+hh+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+i9+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+i9+" SET max_seq=(SELECT MAX(seq) FROM "+hD+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+i9+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ah(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ab=2===aG.length?"UTF-8":"UTF-16",aE()})}function ac(){for(;af.length>0;){var aD=af.pop();aD(null,az)}}function aj(aM,aE){if(0===aE){var aH="CREATE TABLE IF NOT EXISTS "+iL+" (dbid, db_version INTEGER)",aK="CREATE TABLE IF NOT EXISTS "+hh+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aN="CREATE TABLE IF NOT EXISTS "+dr+" (digest, seq INTEGER)",aD="CREATE TABLE IF NOT EXISTS "+i9+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aO="CREATE TABLE IF NOT EXISTS "+hD+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aI="CREATE TABLE IF NOT EXISTS "+hu+" (id UNIQUE, rev, json)";aM.executeSql(aK),aM.executeSql(aI),aM.executeSql(aN,[],function(){aM.executeSql(il),aM.executeSql(ir)}),aM.executeSql(aD,[],function(){aM.executeSql(r),aM.executeSql(aO,[],function(){aM.executeSql(V),aM.executeSql(hV),aM.executeSql(aH,[],function(){var aP="INSERT INTO "+iL+" (db_version, dbid) VALUES (?,?)";az=h2();var aQ=[iY,az];aM.executeSql(aP,aQ,function(){ac()})})})})}else{var aG=function(){var aQ=iY>aE;aQ&&aM.executeSql("UPDATE "+iL+" SET db_version = "+iY);var aP="SELECT dbid FROM "+iL;aM.executeSql(aP,[],function(aR,aS){az=aS.rows.item(0).dbid,ac()})},aJ=[aw,aq,aC,aa,am,ap,aG],aL=aE,aF=function(aP){aJ[aL-1](aP,aF),aL++};aF(aM)}}function au(){ax.transaction(function(aD){ah(aD,function(){ad(aD)})},a2(ay),al)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+iL;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+iL,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;aj(aJ,aI)}):aF.executeSql("ALTER TABLE "+iL+" ADD COLUMN db_version INTEGER",[],function(){aj(aF,1)}):aj(aF,0)})}function aB(aE,aF){if(-1!==ag._docCount){return aF(ag._docCount)}var aD=a6("COUNT("+i9+".id) AS 'num'",[i9,hD],jf,hD+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ag._docCount=aH.rows.item(0).num,aF(ag._docCount)})}var ab,ag=this,az=null,av=ie(ak),af=[];ag._docCount=-1,ag._name=ak.name;var t=g8.extend({},ak,{version:ce,description:ak.name,size:av}),aA=jp(t);if(aA.error){return a2(ay)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),au(),ag.type=function(){return"websql"},ag._id=fy(function(aD){aD(null,az)}),ag._info=function(aD){ax.readTransaction(function(aE){aB(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+hD;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:ax._sqlitePlugin,websql_encoding:ab})})})},a2(aD))},ag._bulkDocs=function(aF,aD,aE){hW(ak,aF,aD,ag,ax,fp,aE)},ag._get=function(aF,aE,aH){function aK(){aH(aM,{doc:aJ,metadata:aG,ctx:aI})}var aJ,aG,aM,aI=aE.ctx;if(!aI){return ax.readTransaction(function(aN){ag._get(aF,g8.extend({ctx:aN},aE),aH)})}var aL,aD;aE.rev?(aL=a6(hm,[i9,hD],i9+".id="+hD+".doc_id",[hD+".doc_id=?",hD+".rev=?"]),aD=[aF,aE.rev]):(aL=a6(hm,[i9,hD],jf,i9+".id=?"),aD=[aF]),aI.executeSql(aL,aD,function(aP,aO){if(!aO.rows.length){return aM=fq(hy,"missing"),aK()}var aN=aO.rows.item(0);return aG=jn(aN.metadata),aN.deleted&&!aE.rev?(aM=fq(hy,"deleted"),aK()):(aJ=ft(aN.data,aG.id,aN.rev),void aK())})},ag._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(i9+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(i9+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(i9+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(i9+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(hD+".deleted = 0"),ax.readTransaction(function(aR){aB(aR,function(aS){if(aF=aS,0!==aH){var aT=a6(hm,[i9,hD],jf,aL,i9+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(bb,aY){for(var aZ=0,aV=aY.rows.length;aV>aZ;aZ++){var bc=aY.rows.item(aZ),ba=jn(bc.metadata),aW=ba.id,aU=ft(bc.data,aW,bc.rev),aX=aU._rev,bd={id:aW,key:aW,value:{rev:aX}};if(aQ.include_docs&&(bd.doc=aU,bd.doc._rev=aX,aQ.conflicts&&(bd.doc._conflicts=w(ba)),E(bd.doc,aQ,ag,bb)),bc.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},a2(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ag._changes=function(aI){function aH(){var aN=i9+".json AS metadata, "+i9+".max_seq AS maxSeq, "+hD+".json AS winningDoc, "+hD+".rev AS winningRev ",aM=i9+" JOIN "+hD,aO=i9+".id="+hD+".doc_id AND "+i9+".winningseq="+hD+".seq",aP=["maxSeq > ?"],aR=[aI.since];aI.doc_ids&&(aP.push(i9+".id IN "+gQ(aI.doc_ids.length)),aR=aR.concat(aI.doc_ids));var aL="maxSeq "+(aD?"DESC":"ASC"),aS=a6(aN,aM,aO,aP,aL),aT=a7(aI);aI.view||aI.filter||(aS+=" LIMIT "+aG);var aQ=aI.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(bb,ba){function bc(bg){return function(){aI.onChange(bg)}}for(var aW=0,aX=ba.rows.length;aX>aW;aW++){var aY=ba.rows.item(aW),aZ=jn(aY.metadata);aQ=aY.maxSeq;var bf=ft(aY.winningDoc,aZ.id,aY.winningRev),bd=aI.processChange(bf,aZ,aI);bd.seq=aY.maxSeq;var aV=aT(bd);if("object"==typeof aV){return aI.complete(aV)}if(aV&&(aE++,aJ&&aK.push(bd),aI.attachments&&aI.include_docs?E(bf,aI,ag,bb,bc(bd)):bc(bd)()),aE===aG){break}}})},a2(aI.complete),function(){aI.continuous||aI.complete(null,{results:aK,last_seq:aQ})})}if(aI=gO(aI),aI.continuous){var aF=ag._name+":"+h2();return fp.addListener(ag._name,aF,ag,aI),fp.notify(ag._name),{cancel:function(){fp.removeListener(ag._name,aF)}}}var aD=aI.descending;aI.since=aI.since&&!aD?aI.since:0;var aG="limit" in aI?aI.limit:-1;0===aG&&(aG=1);var aJ;aJ="return_docs" in aI?aI.return_docs:"returnDocs" in aI?aI.returnDocs:!0;var aK=[],aE=0;aH()},ag._close=function(aD){aD()},ag._getAttachment=function(aF,aE,aH,aK,aJ){var aG,aM=aK.ctx,aI=aH.digest,aL=aH.content_type,aD="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+hh+" WHERE digest=?";aM.executeSql(aD,[aI],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?it(aO.body):gj(aO.body,ab);aG=aK.binary?hX(aN,aL):h3(aN),aJ(null,aG)})},ag._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+i9+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=jn(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(fq(hy))}})})},ag._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+i9+" WHERE id = ?";aH.executeSql(aG,[aE],function(aK,aI){var aL=jn(aI.rows.item(0).metadata);ib(aL.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aJ="UPDATE "+i9+" SET json = ? WHERE id = ?";aK.executeSql(aJ,[ci(aL),aE])}),iH(aF,aE,aH)},a2(aD),function(){aD()}):aD()},ag._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hu+" WHERE id=?";aF.executeSql(aG,[aD],function(aJ,aH){if(aH.rows.length){var aK=aH.rows.item(0),aI=ft(aK.json,aD,aK.rev);aE(null,aI)}else{aE(fq(hy))}})})},ag._putLocal=function(aE,aJ,aG){function aI(aO){var aM,aN;aF?(aM="UPDATE "+hu+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aH,aK,aL,aF]):(aM="INSERT INTO "+hu+" (id, rev, json) VALUES (?,?,?)",aN=[aL,aH,aK]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aD={ok:!0,id:aL,rev:aH},aJ.ctx&&aG(null,aD)):aG(fq(hg))},function(){return aG(fq(hg)),!1})}"function"==typeof aJ&&(aG=aJ,aJ={}),delete aE._revisions;var aH,aF=aE._rev,aL=aE._id;aH=aF?aE._rev="0-"+(parseInt(aF.split("-")[1],10)+1):aE._rev="0-1";var aD,aK=iI(aE);aJ.ctx?aI(aJ.ctx):ax.transaction(aI,a2(aG),function(){aD&&aG(null,aD)})},ag._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+hu+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(fq(hy))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,a2(aH),function(){aD&&aH(null,aD)})},ag._destroy=function(aD,aE){fp.removeAllListeners(ag._name),ax.transaction(function(aF){var aG=[i9,hD,hh,iL,hu,dr];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},a2(aE),function(){fc()&&(delete window.localStorage["_pouch__websqldb_"+ag._name],delete window.localStorage[ag._name]),aE(null,{ok:!0})})}}function hK(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gV(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=fc(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=hK();return ab&&(localStorage[t]=aa?"1":"0"),aa}function es(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gV()}function g0(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=g8.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function hF(ac,aa){var ab=g0(ac),t=g8.extend({websql:ab},ac);fS.call(this,t,aa)}function fT(t){t.adapter("websql",hF,!0)}function di(){for(var ac={},aa=new gp(function(af,ad){ac.resolve=af,ac.reject=ad}),ab=new Array(arguments.length),t=0;t<ab.length;t++){ab[t]=arguments[t]}return ac.promise=aa,gp.resolve().then(function(){return fetch.apply(null,ab)}).then(function(ad){ac.resolve(ad)})["catch"](function(ad){ac.reject(ad)}),ac}function Z(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?hz(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=di(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function l(ah,af){var aa,ab,aj=!1,ag=function(){aa.abort()},ad=function(){aj=!0,aa.abort()};aa=ah.xhr?new ah.xhr:new XMLHttpRequest;try{aa.open(ah.method,ah.url)}catch(ac){af(ac,{statusCode:413})}aa.withCredentials="withCredentials" in ah?ah.withCredentials:!0,"GET"===ah.method?delete ah.headers["Content-Type"]:ah.json&&(ah.headers.Accept="application/json",ah.headers["Content-Type"]=ah.headers["Content-Type"]||"application/json",ah.body&&ah.processData&&"string"!=typeof ah.body&&(ah.body=JSON.stringify(ah.body))),ah.binary&&(aa.responseType="arraybuffer"),"body" in ah||(ah.body=null);for(var t in ah.headers){ah.headers.hasOwnProperty(t)&&aa.setRequestHeader(t,ah.headers[t])}return ah.timeout>0&&(ab=setTimeout(ad,ah.timeout),aa.onprogress=function(){clearTimeout(ab),4!==aa.readyState&&(ab=setTimeout(ad,ah.timeout))},"undefined"!=typeof aa.upload&&(aa.upload.onprogress=aa.onprogress)),aa.onreadystatechange=function(){if(4===aa.readyState){var ak={statusCode:aa.status};if(aa.status>=200&&aa.status<300){var am;am=ah.binary?js([aa.response||""],{type:aa.getResponseHeader("Content-Type")}):aa.responseText,af(null,ak,am)}else{var ap={};if(aj){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(aa.response)}catch(al){}}af(ap,ak)}}},ah.body&&ah.body instanceof Blob?hz(ah.body,function(ak){aa.send(ak)}):aa.send(ah.body),{abort:ag}}function ip(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function iP(t,aa){return hb||t.xhr?l(t,aa):Z(t,aa)}function hR(){return""}function hr(ac,t){function aa(aj,af,ah){if(!ac.binary&&ac.json&&"string"==typeof aj){try{aj=JSON.parse(aj)}catch(ag){return ah(ag)}}Array.isArray(aj)&&(aj=aj.map(function(ak){return ak.error||ak.missing?fa(ak):ak})),ac.binary&&U(aj,af),ah(null,aj,af)}function ad(ah,ak){var af,aj;if(ah.code&&ah.status){var ag=new Error(ah.message||ah.code);return ag.status=ah.status,ak(ag)}if(ah.message&&"ETIMEDOUT"===ah.message){return ak(ah)}try{af=JSON.parse(ah.responseText),aj=fa(af)}catch(al){aj=fa(ah)}ak(aj)}ac=gO(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=g8.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),iP(ac,function(aj,am,ag){if(aj){return aj.status=am?am.statusCode:400,ad(aj,t)}var al,af=am.headers&&am.headers["content-type"],ah=ag||hR();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof ah&&(/json/.test(af)||/^[\s]*\{/.test(ah)&&/\}[\s]*$/.test(ah))){try{ah=JSON.parse(ah.toString())}catch(ak){}}am.statusCode>=200&&am.statusCode<300?aa(ah,am,t):(al=fa(ah),al.status=am.statusCode,t(al))})}function ey(af,ac){var ah=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ak=-1!==ah.indexOf("safari")&&-1===ah.indexOf("chrome"),aj=-1!==ah.indexOf("msie"),ag=-1!==ah.indexOf("edge"),ad=ak||(aj||ag)&&"GET"===af.method,aa="cache" in af?af.cache:!0,t=/^blob:/.test(af.url);if(!t&&(ad||!aa)){var ab=-1!==af.url.indexOf("?");af.url+=(ab?"&":"?")+"_nonce="+Date.now()}return hr(af,ac)}function g7(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=jq(ab.data,ab.content_type)})}function g6(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function bo(t){return t._attachments&&Object.keys(t._attachments)?gp.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new gp(function(ac){O(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):gp.resolve()}function iE(ab){var t=iS(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function gY(t,aa){return s(t,t.db+"/"+aa)}function s(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function ev(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function iF(ak,aj){function ah(ax,aA,az){var ay=ax.ajax||{},aw=g8.extend(gO(am),ay,aA);return K(aw.method+" "+aw.url),ab._ajax(aw,az)}function ap(aw,ax){return new gp(function(az,ay){ah(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(aw,ax){return iD(aw,fs(function(ay){ac().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ac(){if(ak.skipSetup||ak.skip_setup){return gp.resolve()}if(af){return af}var aw={method:"GET",url:al};return af=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(iO(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:al})):gp.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:gp.reject(ax)}),af["catch"](function(){af=null}),af}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,au=iE;ak.getHost&&(au=ak.getHost);var ad=au(ak.name,ak),al=gY(ad,"");ak=gO(ak);var am=ak.ajax||{};if(ab.getUrl=function(){return al},ab.getHeaders=function(){return am.headers||{}},ak.auth||ad.auth){var av=ak.auth||ad.auth,t=av.username+":"+av.password,aa=h3(unescape(encodeURIComponent(t)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=ey;var af;setTimeout(function(){aj(null,ab)}),ab.type=function(){return"http"},ab.id=aq("id",function(aw){ah({},{method:"GET",url:s(ad,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ad.db:gY(ad,"");aw(null,ay)})}),ab.request=aq("request",function(aw,ax){aw.url=gY(ad,aw.url),ah({},aw,ax)}),ab.compact=aq("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=gO(aw),ah(aw,{url:gY(ad,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ab.bulkGet=iD("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:gY(ad,"_bulk_get"+ev(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aI(aK){return function(aM,aL){aF[aK]=aL.results,++aH===aD&&aA(null,{results:hH(aF)})}}for(var aE=fl,aD=Math.ceil(aC.docs.length/aE),aH=0,aF=new Array(aD),aG=0;aD>aG;aG++){var aJ=gf(aC,["revs","attachments"]);aJ.ajax=am,aJ.docs=aC.docs.slice(aG*aE,Math.min(aC.docs.length,(aG+1)*aE)),co(aw,aJ,aI(aG))}}var aw=this,az=s(ad,""),ay=h6[az];"boolean"!=typeof ay?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(h6[az]=!1,iO(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{h6[az]=!0,aA(null,aE)}}):ay?ax(aA):aB()}),ab._info=function(aw){ac().then(function(){ah({},{method:"GET",url:gY(ad,"")},function(ay,ax){return ay?aw(ay):(ax.host=gY(ad,""),void aw(null,ax))})})["catch"](aw)},ab.get=aq("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?gp.all(aF.map(function(aI){var aH=aD[aI],aG=g6(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(aC,{method:"GET",url:gY(ad,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:new gp(function(aK){O(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?gp.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=gO(aC);var ay={};aC.revs&&(ay.revs=!0),aC.revs_info&&(ay.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),ay.open_revs=aC.open_revs),aC.rev&&(ay.rev=aC.rev),aC.conflicts&&(ay.conflicts=aC.conflicts),aA=g6(aA);var az={method:"GET",url:gY(ad,aA+ev(ay))};ap(aC,az).then(function(aD){return gp.resolve().then(function(){return aC.attachments?aw(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ab.remove=aq("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:gY(ad,g6(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=aq("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=gY(ad,g6(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=aq("removeAttachment",function(ax,aA,ay,az){var aw=gY(ad,g6(ax)+"/"+ag(aA))+"?rev="+ay;ah({},{method:"DELETE",url:aw},az)}),ab.putAttachment=aq("putAttachment",function(ay,aF,aD,aC,aA,aE){"function"==typeof aA&&(aE=aA,aA=aC,aC=aD,aD=null);var aG=g6(ay)+"/"+ag(aF),aw=gY(ad,aG);if(aD&&(aw+="?rev="+aD),"string"==typeof aC){var aB;try{aB=gT(aC)}catch(ax){return aE(fq(hG,"Attachment is not a valid base64 string"))}aC=aB?hX(aB,aA):""}var az={headers:{"Content-Type":aA},method:"PUT",url:aw,processData:!1,body:aC,timeout:am.timeout||60000};ah({},az,aE)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,ac().then(function(){return gp.all(ay.docs.map(bo))}).then(function(){ah(ax,{method:"POST",url:gY(ad,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=gO(aA);var ax,aB={},aw="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var az=ev(aB);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=B?az+="&"+ay:(aw="POST",ax={keys:aA.keys})}ap(aA,{method:aw,url:gY(ad,"_all_docs"+az),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(g7),aC(null,aD)})["catch"](aC)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:J;aB=gO(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aF=aB.timeout?{timeout:aB.timeout-5000}:{},az="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=az;if(aB.style&&(aF.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aF.include_docs=!0),aB.attachments&&(aF.attachments=!0),aB.continuous&&(aF.feed="longpoll"),aB.conflicts&&(aF.conflicts=!0),aB.descending&&(aF.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aF.heartbeat=aB.heartbeat):aF.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aF.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aF.filter="_view",aF.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var aJ in aB.query_params){aB.query_params.hasOwnProperty(aJ)&&(aF[aJ]=aB.query_params[aJ])}}var aD,aK="GET";if(aB.doc_ids){aF.filter="_doc_ids";var ax=JSON.stringify(aB.doc_ids);ax.length<B?aF.doc_ids=ax:(aK="POST",aD={doc_ids:aB.doc_ids})}var aA,aC,aE=function(aM,aN){if(!aB.aborted){aF.since=aM,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aB.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aw?aw:aH;var aL={method:aK,url:gY(ad,"_changes"+ev(aF)),timeout:aB.timeout,body:aD};aC=aM,aB.aborted||ac().then(function(){aA=ah(aB,aL,aN)})["catch"](aN)}},aG={results:[]},aI=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aG.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=a7(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&g7(aR),ay&&aG.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aC=aL.last_seq);var aO=az&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||az&&0>=aH)&&aO?aB.complete(null,aG):setTimeout(function(){aE(aC,aI)},0)}};return aE(aB.since||0,aI),{cancel:function(){aB.aborted=!0,aA&&aA.abort()}}},ab.revsDiff=aq("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:gY(ad,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(aw,ax){ah(aw,{url:gY(ad,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function ao(t){t.adapter("http",iF,!1),t.adapter("https",iF,!1)}function A(){this.promise=new gp(function(t){t()})}function fb(ad){var ab=ad.db,aa=ad.viewName,t=ad.map,ac=ad.reduce,ag=ad.temporary,ah=t.toString()+(ac&&ac.toString())+"undefined";if(!ag&&ab._cachedViews){var af=ab._cachedViews[ah];if(af){return gp.resolve(af)}}return ab.info().then(function(ak){function al(am){am.views=am.views||{};var aq=aa;-1===aq.indexOf("/")&&(aq=aa+"/"+aa);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ag?"temp":iy(ah));return hf(ab,"_local/mrviews",al).then(function(){return ab.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ab,adapter:ab.adapter,mapFun:t,reduceFun:ac};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ag||(ab._cachedViews=ab._cachedViews||{},ab._cachedViews[ah]=aq,aq.db.once("destroyed",function(){delete ab._cachedViews[ah]})),aq})})})})}function k(ac,t,aa,ad,ab,af){return hw("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function gF(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function ct(t){return 1===t.length&&/^1-/.test(t[0].rev)}function m(ab,t){try{ab.emit("error",t)}catch(aa){gM("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),gM("error",t)}}function iq(ac,aa,ab){try{return{output:aa.apply(null,ab)}}catch(t){return m(ac,t),{error:t}}}function fw(ab,t){var aa=x.collate(ab.key,t.key);return 0!==aa?aa:x.collate(ab.value,t.value)}function W(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function a4(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function jo(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=jq(ac.data,ac.content_type)})})}function hS(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&jo(aa),aa}}function eo(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new gm(aa)}function gG(ad){for(var ab=0,aa=0,t=ad.length;t>aa;aa++){var ac=ad[aa];if("number"!=typeof ac){if(!Array.isArray(ac)){throw eo("_sum")}ab="number"==typeof ab?[ab]:ab;for(var ag=0,ah=ac.length;ah>ag;ag++){var af=ac[ag];if("number"!=typeof af){throw eo("_sum")}"undefined"==typeof ab[ag]?ab.push(af):ab[ag]+=af}}else{"number"==typeof ab?ab+=ac:ab[0]+=ac}}return ab}function Q(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function gs(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function jw(t){return t.group_level=gs(t.group_level),t.limit=gs(t.limit),t.skip=gs(t.skip),t}function F(t){if(t){if("number"!=typeof t){return new h('Invalid value for integer: "'+t+'"')}if(0>t){return new h('Invalid value for positive integer: "'+t+'"')}}}function ha(ac,aa){var ab=ac.descending?"endkey":"startkey",t=ac.descending?"startkey":"endkey";if("undefined"!=typeof ac[ab]&&"undefined"!=typeof ac[t]&&x.collate(ac[ab],ac[t])>0){throw new h("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(aa.reduce&&ac.reduce!==!1){if(ac.include_docs){throw new h("{include_docs:true} is invalid for reduce")}if(ac.keys&&ac.keys.length>1&&!ac.group&&!ac.group_level){throw new h("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=F(ac[af]);if(ad){throw ad}})}function a0(ah,af,aa){var ab,aj=[],ag="GET";if(Q("reduce",aa,aj),Q("include_docs",aa,aj),Q("attachments",aa,aj),Q("limit",aa,aj),Q("descending",aa,aj),Q("group",aa,aj),Q("group_level",aa,aj),Q("skip",aa,aj),Q("stale",aa,aj),Q("conflicts",aa,aj),Q("startkey",aa,aj,!0),Q("start_key",aa,aj,!0),Q("endkey",aa,aj,!0),Q("end_key",aa,aj,!0),Q("inclusive_end",aa,aj),Q("key",aa,aj,!0),aj=aj.join("&"),aj=""===aj?"":"?"+aj,"undefined"!=typeof aa.keys){var ad=2000,ac="keys="+encodeURIComponent(JSON.stringify(aa.keys));ac.length+aj.length+1<=ad?aj+=("?"===aj[0]?"&":"?")+ac:(ag="POST","string"==typeof af?ab={keys:aa.keys}:af.keys=aa.keys)}if("string"==typeof af){var t=gF(af);return ah.request({method:ag,url:"_design/"+t[0]+"/_view/"+t[1]+aj,body:ab}).then(hS(aa))}return ab=ab||{},Object.keys(af).forEach(function(ak){Array.isArray(af[ak])?ab[ak]=af[ak]:ab[ak]=af[ak].toString()}),ah.request({method:"POST",url:"_temp_view"+aj,body:ab}).then(hS(aa))}function jm(ab,t,aa){return new gp(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function n(t){return new gp(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function cr(t){return function(aa){if(404===aa.status){return t}throw aa}}function hd(aj,ad,ak){function aa(){return ct(t)?gp.resolve(af):ad.db.get(ah)["catch"](cr(af))}function ac(am){return am.keys.length?ad.db.allDocs({keys:am.keys,include_docs:!0}):gp.resolve({rows:[]})}function al(aw,av){for(var aA=[],aq={},am=0,ay=av.rows.length;ay>am;am++){var ax=av.rows[am],ap=ax.doc;if(ap&&(aA.push(ap),aq[ap._id]=!0,ap._deleted=!ag[ap._id],!ap._deleted)){var au=ag[ap._id];"value" in au&&(ap.value=au.value)}}var az=Object.keys(ag);return az.forEach(function(aD){if(!aq[aD]){var aB={_id:aD},aC=ag[aD];"value" in aC&&(aB.value=aC.value),aA.push(aB)}}),aw.keys=h9(az.concat(aw.keys)),aA.push(aw),aA}var ah="_local/doc_"+aj,af={_id:ah,keys:[]},ab=ak[aj],ag=ab.indexableKeysToKeyValues,t=ab.changes;return aa().then(function(am){return ac(am).then(function(ap){return al(am,ap)})})}function fe(ac,aa,ab){var t="_local/lastSeq";return ac.db.get(t)["catch"](cr({_id:t,seq:0})).then(function(af){var ad=Object.keys(aa);return gp.all(ad.map(function(ag){return hd(ag,ac,aa)})).then(function(ag){var ah=hH(ag);return af.seq=ab,ah.push(af),ac.db.bulkDocs({docs:ah})})})}function a1(ab){var t="string"==typeof ab?ab:ab.name,aa=f[t];return aa||(aa=f[t]=new A),aa}function jC(t){return hJ(a1(t),function(){return iQ(t)})()}function iQ(ah){function af(am,ak){var al={id:aj._id,key:x.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=x.normalizeKey(ak)),ab.push(al)}function aa(ak,al){return function(){return fe(ah,ak,al)}}var ab,aj,ag;if("function"==typeof ah.mapFun&&2===ah.mapFun.length){var ad=ah.mapFun;ag=function(ak){return ad(ak,af)}}else{ag=k(ah.mapFun.toString(),af,gG,jz,Array.isArray,JSON.parse)}var ac=ah.seq||0,t=new A;return new gp(function(ap,ak){function al(){t.finish().then(function(){ah.seq=ac,ap()})}function am(){function aq(au){ak(au)}ah.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ac,limit:C}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var ay={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){ab=[],aj=ax.doc,aj._deleted||iq(ah.sourceDB,ag,[aj]),ab.sort(fw);for(var az,au={},aC=0,aG=ab.length;aG>aC;aC++){var aE=ab[aC],aB=[aE.key,aE.id];0===x.collate(aE.key,az)&&aB.push(aC);var aw=x.toIndexableString(aB);au[aw]=aE,az=aE.key}ay[ax.doc._id]={indexableKeysToKeyValues:au,changes:ax.changes}}ac=ax.seq}return t.add(aa(ay,ac)),aA.length<C?al():am()}).on("error",aq)}am()})}function M(aj,ad,ak){0===ak.group_level&&delete ak.group_level;var aa,ac=ak.group||ak.group_level;aa=iG[aj.reduceFun]?iG[aj.reduceFun]:k(aj.reduceFun.toString(),null,gG,jz,Array.isArray,JSON.parse);var al=[],ah=isNaN(ak.group_level)?Number.POSITIVE_INFINITY:ak.group_level;ad.forEach(function(aq){var am=al[al.length-1],ap=ac?aq.key:null;return ac&&Array.isArray(ap)&&(ap=ap.slice(0,ah)),am&&0===x.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void al.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ad=[];for(var af=0,ab=al.length;ab>af;af++){var ag=al[af],t=iq(aj.sourceDB,aa,[ag.keys,ag.values,!1]);if(t.error&&t.error instanceof gm){throw t.error}ad.push({value:t.error?null:t.output,key:ag.groupKey})}return{rows:W(ad,ak.limit,ak.skip)}}function ae(t,aa){return hJ(a1(t),function(){return fY(t,aa)})()}function fY(t,ad){function aa(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ab=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=x.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ac(aq){var au;if(au=am?M(t,aq,ad):{total_rows:ab,offset:ag,rows:aq},ad.include_docs){var av=h9(aq.map(a4));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:ad.conflicts,attachments:ad.attachments,binary:ad.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=a4(ay),az=ax["$"+aA];az&&(ay.doc=az)}),au})}return au}var ab,am=t.reduceFun&&ad.reduce!==!1,ag=ad.skip||0;if("undefined"==typeof ad.keys||ad.keys.length||(ad.limit=0,delete ad.keys),"undefined"!=typeof ad.keys){var al=ad.keys,af=al.map(function(aq){var au={startkey:x.toIndexableString([aq]),endkey:x.toIndexableString([aq,{}])};return aa(au)});return gp.all(af).then(hH).then(ac)}var ah={descending:ad.descending};if(ad.start_key&&(ad.startkey=ad.start_key),ad.end_key&&(ad.endkey=ad.end_key),"undefined"!=typeof ad.startkey&&(ah.startkey=ad.descending?x.toIndexableString([ad.startkey,{}]):x.toIndexableString([ad.startkey])),"undefined"!=typeof ad.endkey){var ak=ad.inclusive_end!==!1;ad.descending&&(ak=!ak),ah.endkey=x.toIndexableString(ak?[ad.endkey,{}]:[ad.endkey])}if("undefined"!=typeof ad.key){var ap=x.toIndexableString([ad.key]),aj=x.toIndexableString([ad.key,{}]);ah.descending?(ah.endkey=ap,ah.startkey=aj):(ah.startkey=ap,ah.endkey=aj)}return am||("number"==typeof ad.limit&&(ah.limit=ad.limit),ah.skip=ag),aa(ah).then(ac)}function G(t){return t.request({method:"POST",url:"_view_cleanup"})}function h4(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ag){var ad=gF(ag),ah="_design/"+ad[0],af=ad[1];aa[ah]=aa[ah]||{},aa[ah][af]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ag){var af={};ag.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){af[au]=af[au]||am})})});var ah=Object.keys(af).filter(function(aj){return !af[aj]}),ad=ah.map(function(aj){return hJ(a1(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return gp.all(ad).then(function(){return{ok:!0}})})},cr({ok:!0}))}function u(ac,af,ad){if("http"===ac.type()){return a0(ac,af,ad)}if("function"==typeof ac._query){return jm(ac,af,ad)}if("string"!=typeof af){ha(ad,af);var aa={db:ac,viewName:"temp_view/temp_view",map:af.map,reduce:af.reduce,temporary:!0};return hP.add(function(){return fb(aa).then(function(ak){function aj(){return ak.db.destroy()}return iK(jC(ak).then(function(){return ae(ak,ad)}),aj)})}),hP.finish()}var ab=af,ah=gF(ab),t=ah[0],ag=ah[1];return ac.get("_design/"+t).then(function(al){var ak=al.views&&al.views[ag];if(!ak||"string"!=typeof ak.map){throw new i7("ddoc "+t+" has no view named "+ag)}ha(ad,ak);var aj={db:ac,viewName:ab,map:ak.map,reduce:ak.reduce};return fb(aj).then(function(am){return"ok"===ad.stale||"update_after"===ad.stale?("update_after"===ad.stale&&cn.nextTick(function(){jC(am)}),ae(am,ad)):jC(am).then(function(){return ae(am,ad)})})})}function h(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,h)}catch(aa){}}function i7(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,i7)}catch(aa){}}function gm(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gm)}catch(aa){}}function gg(t){return/^1-/.test(t)}function gi(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function a5(ab,t){var aa=Object.keys(t._attachments);return gp.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function gD(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return gp.all(ab.map(function(ag){return gi(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return a5(t,aa)}):a5(t,aa)}function hx(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function fr(ak,af,al,ac){function aa(){var am=hx(al);if(am.docs.length){return ak.bulkGet(am).then(function(ap){if(ac.cancelled){throw new Error("cancelled")}return gp.all(ap.results.map(function(aq){return gp.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?gD(af,ak,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ag=ag.concat(hH(aq).filter(Boolean))})})}}function aj(am){return am._attachments&&Object.keys(am._attachments).length>0}function ah(am){return ak.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ac.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&gg(aq.value.rev)&&!aj(aq.doc)&&(ag.push(aq.doc),delete al[aq.id])})})}function ab(){var am=Object.keys(al).filter(function(aq){var ap=al[aq].missing;return 1===ap.length&&gg(ap[0])});return am.length>0?ah(am):void 0}function ad(){return{ok:t,docs:ag}}al=gO(al);var ag=[],t=!0;return gp.resolve().then(ab).then(aa).then(ad)}function iZ(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&iO(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:gZ}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,hj),af.version=gZ,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return iZ(ac,t,aa,ad,ab)}throw ag}))})}function i(ac,aa,ab,t){this.src=ac,this.target=aa,this.id=ab,this.returnValue=t}function io(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:hI(t.history,aa.history)}function hI(ad,ab){var aa=ad[0],t=ad.slice(1),ac=ab[0],ag=ab.slice(1);if(!aa||0===ab.length){return{last_seq:jb,history:[]}}var ah=aa.session_id;if(fj(ah,ab)){return{last_seq:aa.last_seq,history:ad}}var af=ac.session_id;return fj(af,t)?{last_seq:ac.last_seq,history:ag}:hI(t,ag)}function fj(ac,aa){var ab=aa[0],t=aa.slice(1);return ac&&0!==aa.length?ac===ab.session_id?!0:fj(ac,t):!1}function gJ(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function X(ac,aa,ab,t){return ac.retry===!1?(aa.emit("error",ab),void aa.removeAllListeners()):("function"!=typeof ac.back_off_function&&(ac.back_off_function=gd),aa.emit("requestError",ab),"active"!==aa.state&&"pending"!==aa.state||(aa.emit("paused",ab),aa.state="stopped",aa.once("active",function(){ac.current_back_off=p})),ac.current_back_off=ac.current_back_off||p,ac.current_back_off=ac.back_off_function(ac.current_back_off),void setTimeout(t,ac.current_back_off))}function gb(t){return Object.keys(t).sort(x.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function N(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(x.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(gb(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),gp.all([ab.id(),ad.id()]).then(function(aj){var ah=aj[0]+aj[1]+aa+af+t+ac;return new gp(function(ak){H(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function hi(aj,aQ,aE,aJ,aF){function ay(){return ap?gp.resolve():N(aj,aQ,aE).then(function(aS){aa=aS,ap=new i(aj,aQ,aa,aJ)})}function aK(){if(aM=[],0!==al.docs.length){var aS=al.docs;return aQ.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(aJ.cancelled){throw aG(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(aF.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),ak=ak.concat(aV),aF.docs_written+=al.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?aJ.emit("denied",gO(aY)):aM.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,ax("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw aF.doc_write_failures+=aS.length,aT})}}function aP(){if(al.error){throw new Error("There was a problem getting docs.")}aF.last_seq=az=al.seq;var aS=gO(aF);return aM.length&&(aS.docs=aM,aJ.emit("change",aS)),av=!0,ap.writeCheckpoint(al.seq,ah).then(function(){if(av=!1,aJ.cancelled){throw aG(),new Error("cancelled")}al=void 0,aC()})["catch"](aR)}function af(){var aS={};return al.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aQ.revsDiff(aS).then(function(aT){if(aJ.cancelled){throw aG(),new Error("cancelled")}al.diffs=aT})}function aq(){return fr(aj,aQ,al.diffs,aJ).then(function(aS){al.error=!aS.ok,aS.docs.forEach(function(aT){delete al.diffs[aT._id],aF.docs_read++,al.docs.push(aT)})})}function aB(){if(!aJ.cancelled&&!al){if(0===aA.length){return void ac(!0)}al=aA.shift(),af().then(aq).then(aK).then(aP).then(aB)["catch"](function(aS){ax("batch processing terminated with error",aS)})}}function ac(aS){return 0===aH.changes.length?void (0!==aA.length||al||((aN&&aD.live||aL)&&(aJ.state="pending",aJ.emit("paused")),aL&&aG())):void ((aS||aL||aH.changes.length>=ad)&&(aA.push(aH),aH={seq:0,changes:[],docs:[]},"pending"!==aJ.state&&"stopped"!==aJ.state||(aJ.state="active",aJ.emit("active")),aB()))}function ax(aS,aT){au||(aT.message||(aT.message=aS),aF.ok=!1,aF.status="aborting",aF.errors.push(aT),ak=ak.concat(aT),aA=[],aH={seq:0,changes:[],docs:[]},aG())}function aG(){if(!(au||aJ.cancelled&&(aF.status="cancelled",av))){aF.status=aF.status||"complete",aF.end_time=new Date,aF.last_seq=az,au=!0;var aS=ak.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=ak.pop();ak.length>0&&(aT.other_errors=ak),aT.result=aF,X(aE,aJ,aT,function(){hi(aj,aQ,aE,aJ)})}else{aF.errors=ak,aJ.emit("complete",aF),aJ.removeAllListeners()}}}function ag(aS){if(aJ.cancelled){return aG()}var aT=a7(aE)(aS);aT&&(aH.seq=aS.seq,aH.changes.push(aS),ac(0===aA.length&&aD.live))}function t(aS){if(aO=!1,aJ.cancelled){return aG()}if(aS.results.length>0){aD.since=aS.last_seq,aC(),ac(!0)}else{var aT=function(){aN?(aD.live=!0,aC()):aL=!0,ac(!0)};al||0!==aS.results.length?aT():(av=!0,ap.writeCheckpoint(aS.last_seq,ah).then(function(){av=!1,aF.last_seq=az=aS.last_seq,aT()})["catch"](aR))}}function aI(aS){return aO=!1,aJ.cancelled?aG():void ax("changes rejected",aS)}function aC(){function aU(){aS.cancel()}function aT(){aJ.removeListener("cancel",aU)}if(!aO&&!aL&&aA.length<ab){aO=!0,aJ._changes&&(aJ.removeListener("cancel",aJ._abortChanges),aJ._changes.cancel()),aJ.once("cancel",aU);var aS=aj.changes(aD).on("change",ag);aS.then(aT,aT),aS.then(t)["catch"](aI),aE.retry&&(aJ._changes=aS,aJ._abortChanges=aU)}}function aw(){ay().then(function(){return aJ.cancelled?void aG():ap.getCheckpoint().then(function(aS){az=aS,aD={since:az,limit:ad,batch_size:ad,style:"all_docs",doc_ids:am,return_docs:!0},aE.filter&&("string"!=typeof aE.filter?aD.include_docs=!0:aD.filter=aE.filter),"heartbeat" in aE&&(aD.heartbeat=aE.heartbeat),"timeout" in aE&&(aD.timeout=aE.timeout),aE.query_params&&(aD.query_params=aE.query_params),aE.view&&(aD.view=aE.view),aC()})})["catch"](function(aS){ax("getCheckpoint rejected with ",aS)})}function aR(aS){throw av=!1,ax("writeCheckpoint completed with error",aS),aS}var al,aa,ap,aA=[],aH={seq:0,changes:[],docs:[]},av=!1,aL=!1,au=!1,az=0,aN=aE.continuous||aE.live||!1,ad=aE.batch_size||100,ab=aE.batches_limit||10,aO=!1,am=aE.doc_ids,ak=[],aM=[],ah=h2();aF=aF||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aD={};return aJ.ready(aj,aQ),aJ.cancelled?void aG():(aJ._addedListeners||(aJ.once("cancel",aG),"function"==typeof aE.complete&&(aJ.once("error",aE.complete),aJ.once("complete",function(aS){aE.complete(null,aS)})),aJ._addedListeners=!0),void ("undefined"==typeof aE.since?aw():ay().then(function(){return av=!0,ap.writeCheckpoint(aE.since,ah)}).then(function(){return av=!1,aJ.cancelled?void aG():(az=aE.since,void aw())})["catch"](aR)))}function hO(){i8.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new gp(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function ai(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function gw(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw fq(D,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=gO(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new hO(ag),t=ai(ab,ag),af=ai(ad,ag);return hi(t,af,ag,aa),aa}function gc(ac,aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"undefined"==typeof ab&&(ab={}),ab=gO(ab),ab.PouchConstructor=ab.PouchConstructor||this,ac=ai(ac,ab),aa=ai(aa,ab),new h5(ac,aa,ab,t)}function h5(ah,t,aq,af){function aa(ay){ak.emit("change",{direction:"pull",change:ay})}function al(ay){ak.emit("change",{direction:"push",change:ay})}function ab(ay){ak.emit("denied",{direction:"push",doc:ay})}function ap(ay){ak.emit("denied",{direction:"pull",doc:ay})}function av(){ak.pushPaused=!0,ak.pullPaused&&ak.emit("paused")}function ad(){ak.pullPaused=!0,ak.pushPaused&&ak.emit("paused")}function aj(){ak.pushPaused=!1,ak.pullPaused&&ak.emit("active",{direction:"push"})}function am(){ak.pullPaused=!1,ak.pushPaused&&ak.emit("active",{direction:"pull"})}function ag(ay){return function(aC,aD){var az="change"===aC&&(aD===aa||aD===al),aA="denied"===aC&&(aD===ap||aD===ab),aE="paused"===aC&&(aD===ad||aD===av),aB="active"===aC&&(aD===am||aD===aj);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ak.removeAllListeners(aC))}}var ak=this;this.canceled=!1;var ac=aq.push?g8.extend({},aq,aq.push):aq,aw=aq.pull?g8.extend({},aq,aq.pull):aq;this.push=gw(ah,t,ac),this.pull=gw(t,ah,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};aq.live&&(this.push.on("complete",ak.pull.cancel.bind(ak.pull)),this.pull.on("complete",ak.push.cancel.bind(ak.push))),this.on("newListener",function(ay){"change"===ay?(ak.pull.on("change",aa),ak.push.on("change",al)):"denied"===ay?(ak.pull.on("denied",ap),ak.push.on("denied",ab)):"active"===ay?(ak.pull.on("active",am),ak.push.on("active",aj)):"paused"===ay&&(ak.pull.on("paused",ad),ak.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ak.pull.removeListener("change",aa),ak.push.removeListener("change",al)):"denied"===ay?(ak.pull.removeListener("denied",ap),ak.push.removeListener("denied",ab)):"active"===ay?(ak.pull.removeListener("active",am),ak.push.removeListener("active",aj)):"paused"===ay&&(ak.pull.removeListener("paused",ad),ak.push.removeListener("paused",av))}),this.pull.on("removeListener",ag("pull")),this.push.on("removeListener",ag("push"));var au=gp.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ak.emit("complete",az),af&&af(null,az),ak.removeAllListeners(),az},function(ay){if(ak.cancel(),af?af(ay):ak.emit("error",ay),ak.removeAllListeners(),af){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gP(t){t.replicate=gw,t.sync=gc}var be,g8=a(9),gN=gC(a(5)),i5=gC(a(8)),ju=gC(a(10)),he=a(14),fs=gC(a(4)),i8=a(1),hw=gC(a(15)),gx=gC(a(16)),g1=gC(a(17)),x=a(12),gp="function"==typeof Promise?Promise:ju,et=Function.prototype.toString,je=et.call(Object),q=gN("pouchdb:api"),gR=6;if(L()){be=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),be=!!localStorage.getItem("_pouch_check_localstorage")}catch(iA){be=!1}}i5(hB,i8.EventEmitter),hB.prototype.addListener=function(ab,ad,ag,ac){function aa(){function aj(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var ah=gf(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",aj)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},hB.prototype.removeListener=function(t,aa){aa in this._listeners&&i8.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},hB.prototype.notifyLocalWindows=function(t){L()?chrome.storage.local.set({dbName:t}):fc()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},hB.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},i5(hn,Error),hn.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hc=new hn({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),h7=new hn({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),hy=new hn({status:404,error:"not_found",reason:"missing"}),hg=new hn({status:409,error:"conflict",reason:"Document update conflict"}),iB=new hn({status:400,error:"invalid_id",reason:"_id field must contain a string"}),hM=new hn({status:412,error:"missing_id",reason:"_id is required for puts"}),ez=new hn({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),ew=new hn({status:412,error:"precondition_failed",reason:"Database not open"}),br=new hn({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),hG=new hn({status:500,error:"badarg",reason:"Some query argument is invalid"}),gB=new hn({status:400,error:"invalid_request",reason:"Request was invalid"}),ho=new hn({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),fz=new hn({status:500,error:"doc_validation",reason:"Bad special document member"}),D=new hn({status:400,error:"bad_request",reason:"Something wrong with the request"}),iV=new hn({status:400,error:"bad_request",reason:"Document must be a JSON object"}),g3=new hn({status:404,error:"not_found",reason:"Database not found"}),gt=new hn({status:500,error:"indexed_db_went_bad",reason:"unknown"}),fn=new hn({status:500,error:"web_sql_went_bad",reason:"unknown"}),gL=new hn({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),bt=new hn({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),fm=new hn({status:400,error:"bad_request",reason:"Invalid rev format"}),i4=new hn({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),fV=new hn({status:412,error:"missing_stub"}),gW=new hn({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hl=[hc,h7,hy,hg,iB,hM,ez,ew,br,hG,gB,ho,fz,D,iV,g3,fn,gL,bt,fm,i4,fV,gt,gW],gu=function(ac,aa,ab){var t=hl.filter(function(ad){return ad[ac]===aa});return ab&&t.filter(function(ad){return ad.message===ab})[0]||t[0]},ij=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],hY="queryKey",at=/(?:^|&)([^&=]*)=?([^&]*)/g,ei=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,dn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");i5(gX,i8.EventEmitter),gX.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},gX.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=gO(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=gI,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=g(ac.view):ac.filter=g(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=fs(function(af){ad.cancel(),ab.apply(this,af)})}},gX.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=fq(D,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=g9(ac.view);this.db.get("_design/"+ab[0],function(ah,aj){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ah){return aa(fa(ah))}var ag=aj&&aj.views&&aj.views[ab[1]]&&aj.views[ab[1]].map;return ag?(ac.filter=jB(ag),void t.doChanges(ac)):aa(fq(hy,aj.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=g9(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(ag,aj){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ag){return aa(fa(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ac.filter=an(ah),void t.doChanges(ac)):aa(fq(hy,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},i5(go,i8.EventEmitter),go.prototype.post=iD("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(fq(iV)):void this.bulkDocs({docs:[ab]},t,a3(aa))}),go.prototype.put=iD("put",fs(function(ah){function af(){ad||(gM("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ad=!0)}var aa,ab,aj,ag,ad=!1,ac=ah.shift(),t="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(ag=ah.pop())(fq(iV))}for(;;){if(aa=ah.shift(),ab=typeof aa,"string"!==ab||t?"string"!==ab||!t||"_rev" in ac?"object"===ab?aj=aa:"function"===ab&&(ag=aa):(af(),ac._rev=aa):(af(),ac._id=aa,t=!0),!ah.length){break}}return aj=aj||{},iu(ac._id),im(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,ag):this._putLocal(ac,ag):void this.bulkDocs({docs:[ac]},aj,a3(ag))})),go.prototype.putAttachment=iD("putAttachment",function(ab,ad,ag,ac,aa){function t(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ad]={content_type:aa,data:ac,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw fq(hg)}return t(ah)},function(ah){if(ah.reason===hy.message){return t({_id:ab})}throw ah})}),go.prototype.removeAttachment=iD("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(fq(hg)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),go.prototype.remove=iD("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,im(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,a3(ad))}),go.prototype.revsDiff=iD("revsDiff",function(ad,ab,aa){function t(ak,aj){af.has(ak)||af.set(ak,{missing:[]}),af.get(ak).missing.push(aj)}function ac(aj,ak){var al=ad[aj].slice(0);ib(ak,function(av,aw,am,aq,ap){var ax=aw+"-"+am,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==ap.status&&t(aj,ax))}),al.forEach(function(am){t(aj,am)})}"function"==typeof ab&&(aa=ab,ab={});var ag=Object.keys(ad);if(!ag.length){return aa(null,{})}var ah=0,af=new he.Map;ag.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){af.set(aj,{missing:ad[aj]})}else{if(al){return aa(al)}ac(aj,am)}if(++ah===ag.length){var ak={};return af.forEach(function(ap,aq){ak[aq]=ap}),aa(null,ak)}})},this)}),go.prototype.bulkGet=iD("bulkGet",function(t,aa){co(this,t,aa)}),go.prototype.compactDocument=iD("compactDocument",function(ac,aa,ab){var t=this;this._getRevisionTree(ac,function(aj,af){if(aj){return ab(aj)}var ah=ar(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>aa&&ad.push(ak)}),ib(af,function(aq,ak,am,au,ap){var al=ak+"-"+am;"available"===ap.status&&-1!==ad.indexOf(al)&&ag.push(al)}),t._doCompaction(ac,ag,ab)})}),go.prototype.compact=iD("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&iN(aa)}),go.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(ah){var aj=ah.last_seq;gp.all(af).then(function(){return hf(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},go.prototype.get=iD("get",function(ad,ab,aa){function t(){var ak=[],aj=ac.length;return aj?void ac.forEach(function(al){ag.get(ad,{rev:al,revs:ab.revs,attachments:ab.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||aa(null,ak)})}):aa(null,ak)}if("function"==typeof ab&&(aa=ab,ab={}),"string"!=typeof ad){return aa(fq(iB))}if(im(ad)&&"function"==typeof this._getLocal){return this._getLocal(ad,aa)}var ac=[],ag=this;if(!ab.open_revs){return this._get(ad,ab,function(am,aq){if(am){return aa(am)}var aB=aq.doc,ap=aq.metadata,az=aq.ctx;if(ab.conflicts){var aw=w(ap);aw.length&&(aB._conflicts=aw)}if(h1(ap,aB._rev)&&(aB._deleted=!0),ab.revs||ab.revs_info){var aj=iv(ap.rev_tree),au=i6(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aB._rev.split("-")[1])}),ax=au.ids.map(function(aC){return aC.id}).indexOf(aB._rev.split("-")[1])+1,al=au.ids.length-ax;if(au.ids.splice(ax,al),au.ids.reverse(),ab.revs&&(aB._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ab.revs_info){var aA=au.pos+au.ids.length;aB._revs_info=au.ids.map(function(aC){return aA--,{rev:aA+"-"+aC.id,status:aC.opts.status}})}}if(ab.attachments&&aB._attachments){var ak=aB._attachments,ay=Object.keys(ak).length;if(0===ay){return aa(null,aB)}Object.keys(ak).forEach(function(aC){this._getAttachment(aB._id,aC,ak[aC],{rev:aB._rev,binary:ab.binary,ctx:az},function(aE,aD){var aF=aB._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--ay||aa(null,aB)})},ag)}else{if(aB._attachments){for(var av in aB._attachments){aB._attachments.hasOwnProperty(av)&&(aB._attachments[av].stub=!0)}}aa(null,aB)}})}if("all"===ab.open_revs){this._getRevisionTree(ad,function(ak,aj){return ak?aa(ak):(ac=hL(aj).map(function(al){return al.rev}),void t())})}else{if(!Array.isArray(ab.open_revs)){return aa(fq(br,"function_clause"))}ac=ab.open_revs;for(var ah=0;ah<ac.length;ah++){var af=ac[ah];if("string"!=typeof af||!/^\d+-/.test(af)){return aa(fq(fm))}}t()}}),go.prototype.getAttachment=iD("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(fq(hy))})}),go.prototype.allDocs=iD("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(fq(ho,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return jE(this,ab,t)}}return this._allDocs(ab,t)}),go.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new gX(this,t,aa)},go.prototype.close=iD("close",function(t){return this._closed=!0,this._close(t)}),go.prototype.info=iD("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),go.prototype.id=iD("id",function(t){return this._id(t)}),go.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},go.prototype.bulkDocs=iD("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(fq(h7))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(fq(iV))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||hA(ag)})}),ab?aa(fq(D,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(hZ),gK(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),go.prototype.registerDependentDatabase=iD("registerDependentDatabase",function(ac,aa){function ab(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ac]?!1:(ad.dependentDbs[ac]=!0,ad)}var t=new this.constructor(ac,this.__opts);hf(this,"_local/_pouch_dependentDbs",ab).then(function(){aa(null,{db:t})})["catch"](aa)}),go.prototype.destroy=iD("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});gp.all(ag).then(aa,t)})}),ja.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},ja.prototype.fail=function(t){this.failed=t,this.execute()},ja.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ja.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},i5(a9,go),a9.debug=gN,a9.adapters={},a9.preferredAdapters=[],a9.prefix="_pouch_";var fX=new i8.EventEmitter;ih(a9),a9.parseAdapter=function(ad,ab){var aa,t,ac=ad.match(/([a-z\-]*):\/\/(.*)/);if(ac){if(ad=/http(s?)/.test(ac[1])?ac[1]+"://"+ac[2]:ac[2],aa=ac[1],!a9.adapters[aa].valid()){throw"Invalid adapter"}return{name:ad,adapter:ac[1]}}var ag="idb" in a9.adapters&&"websql" in a9.adapters&&fc()&&localStorage["_pouch__websqldb_"+a9.prefix+ad];if(ab.adapter){t=ab.adapter}else{if("undefined"!=typeof ab&&ab.db){t="leveldb"}else{for(var ah=0;ah<a9.preferredAdapters.length;++ah){if(t=a9.preferredAdapters[ah],t in a9.adapters){if(ag&&"idb"===t){gM("log",'PouchDB is downgrading "'+ad+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}aa=a9.adapters[t];var af=aa&&"use_prefix" in aa?aa.use_prefix:!0;return{name:af?a9.prefix+ad:ad,adapter:t}},a9.adapter=function(ab,t,aa){t.valid()&&(a9.adapters[ab]=t,aa&&a9.preferredAdapters.push(ab))},a9.plugin=function(t){return"function"==typeof t?t(a9):Object.keys(t).forEach(function(aa){a9.prototype[aa]=t[aa]}),a9},a9.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=g8.extend({},t,ad),void a9.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return i5(aa,a9),aa.preferredAdapters=a9.preferredAdapters.slice(),Object.keys(a9).forEach(function(ab){ab in aa||(aa[ab]=a9[ab])}),aa};var de="5.4.4";a9.version=de;var fo,iX=jd(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gv=jd(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),gT=function(t){return atob(t)},h3=function(t){return btoa(t)},iU=gk.setImmediate||gk.setTimeout,ht=32768,g2=5,ik="document-store",h8="by-sequence",en="attach-store",o="attach-seq-store",v="meta-store",iR="local-store",jh="detect-blob-support",gS={running:!1,queue:[]},ff=new he.Map,hQ=new hB,jr=new he.Map;I.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var iY=7,i9=id("document-store"),hD=id("by-sequence"),hh=id("attach-store"),hu=id("local-store"),iL=id("metadata-store"),dr=id("attach-seq-store"),i0=new he.Map,fp=new hB,ce=1,V="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+hD+" (seq, deleted)",hV="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+hD+" (doc_id, rev)",r="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+i9+" (winningseq)",il="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+dr+" (seq)",ir="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+dr+" (digest, seq)",jf=hD+".seq = "+i9+".winningseq",hm=hD+".seq AS seq, "+hD+".deleted AS deleted, "+hD+".json AS data, "+hD+".rev AS rev, "+i9+".json AS metadata";hF.valid=es,hF.use_prefix=!0;var hb=ip(),U=function(){},J=25,fl=50,h6={},B=1800,K=gN("pouchdb:http");iF.valid=function(){return !0},A.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},A.prototype.finish=function(){return this.promise};var fk=function(t,aa){return aa&&t.then(function(ab){cn.nextTick(function(){aa(null,ab)})},function(ab){cn.nextTick(function(){aa(ab)})}),t},gq=function(t){return fs(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&fk(ab,aa),ab})},iK=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},hJ=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},h9=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},f={},hP=new A,C=50,jz=gM.bind(null,"log"),iG={_sum:function(t,aa){return gG(aa)},_count:function(t,aa){return aa.length},_stats:function(ab,t){function aa(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:gG(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},ia=gq(function(){var t=this;return"http"===t.type()?G(t):"function"==typeof t._viewCleanup?n(t):h4(t)}),ic=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?jw(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=gp.resolve().then(function(){return u(ad,ac,t)});return fk(ab,aa),ab};i5(h,Error),i5(i7,Error),i5(gm,Error);var hp={query:ic,viewCleanup:ia},gZ=1,gU="pouchdb",hj=5,jb=0;i.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},i.prototype.updateTarget=function(t,aa){return iZ(this.target,this.id,t,aa,this.returnValue)},i.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?gp.resolve(!0):iZ(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(gJ(ac)){return aa.readOnlySource=!0,!0}throw ac})};var hC={undefined:function(t,aa){return 0===x.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return io(aa,t).last_seq}};i.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?gp.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return jb}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hC?hC[ab](aa,ac):jb},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:jb}).then(function(){return jb},function(ac){return gJ(ac)?(t.readOnlySource=!0,aa.last_seq):jb})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return jb})};var p=0;i5(hO,i8.EventEmitter),hO.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},hO.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},i5(h5,i8.EventEmitter),h5.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},a9.plugin(hq).plugin(fT).plugin(ao).plugin(hp).plugin(gP),b.exports=a9}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var g="color: "+this.color;k=[k[0],g,"color: inherit"].concat(Array.prototype.slice.call(k,1));var f=0,j=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),k.splice(j,0,g),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(t,n,b){function f(){return b.colors[u++%b.colors.length]}function e(h){function k(){}function j(){var m=j,w=+new Date,l=w-(s||w);m.diff=l,m.prev=s,m.curr=w,s=w,null==m.useColors&&(m.useColors=b.useColors()),null==m.color&&m.useColors&&(m.color=f());var q=Array.prototype.slice.call(arguments);q[0]=b.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=b.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof b.formatArgs&&(q=b.formatArgs.apply(m,q));var p=j.log||b.log||console.log.bind(console);p.apply(m,q)}k.enabled=!1,j.enabled=!0;var g=b.enabled(h)?j:k;return g.namespace=h,g}function a(j){b.save(j);for(var h=(j||"").split(/[\s,]+/),k=h.length,g=0;k>g;g++){h[g]&&(j=h[g].replace(/\*/g,".*?"),"-"===j[0]?b.skips.push(new RegExp("^"+j.substr(1)+"$")):b.names.push(new RegExp("^"+j+"$")))}}function r(){b.enable("")}function i(g){var j,h;for(j=0,h=b.skips.length;h>j;j++){if(b.skips[j].test(g)){return !1}}for(j=0,h=b.names.length;h>j;j++){if(b.names[j].test(g)){return !0}}return !1}function o(g){return g instanceof Error?g.stack||g.message:g}b=n.exports=e,b.coerce=o,b.disable=r,b.enable=a,b.enabled=i,b.humanize=t(11),b.names=[],b.skips=[],b.formatters={};var s,u=0},{11:11}],7:[function(a,b,e){(function(r){function y(){s=!0;for(var h,j,g=x.length;g;){for(j=x,x=[],h=-1;++h<g;){j[h]()}g=x.length}s=!1}function i(g){1!==x.push(g)||s||f()}var f,u=r.MutationObserver||r.WebKitMutationObserver;if(u){var o=0,l=new u(y),n=r.document.createTextNode("");l.observe(n,{characterData:!0}),f=function(){n.data=o=++o%2}}else{if(r.setImmediate||"undefined"==typeof r.MessageChannel){f="document" in r&&"onreadystatechange" in r.document.createElement("script")?function(){var g=r.document.createElement("script");g.onreadystatechange=function(){y(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},r.document.documentElement.appendChild(g)}:function(){setTimeout(y,0)}}else{var z=new r.MessageChannel;z.port1.onmessage=y,f=function(){z.port2.postMessage(0)}}}var s,x=[];b.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(r,u,l){function t(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=m,this.queue=[],this.outcome=void 0,g!==t&&y(this,g)}function b(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function h(j,k,g){o(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function a(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(q,j){function w(A){x||(x=!0,K.reject(q,A))}function g(A){x||(x=!0,K.resolve(q,A))}function k(){j(g,w)}var x=!1,z=n(k);"error"===z.status&&w(z.value)}function n(q,j){var k={};try{k.value=q(j),k.status="success"}catch(g){k.status="error",k.value=g}return k}function s(g){return g instanceof this?g:K.resolve(new this(t),g)}function i(g){var j=new this(t);return K.reject(j,g)}function p(x){function j(E,D){function C(F){A[D]=F,++w!==g||z||(z=!0,K.resolve(q,A))}B.resolve(E).then(C,function(F){z||(z=!0,K.reject(q,F))})}var B=this;if("[object Array]"!==Object.prototype.toString.call(x)){return this.reject(new TypeError("must be an array"))}var g=x.length,z=!1;if(!g){return this.resolve([])}for(var A=new Array(g),w=0,k=-1,q=new this(t);++k<g;){j(x[k],k)}return q}function f(q){function j(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(g,B))},function(B){x||(x=!0,K.reject(g,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(q)){return this.reject(new TypeError("must be an array"))}var k=q.length,x=!1;if(!k){return this.resolve([])}for(var z=-1,g=new this(t);++z<k;){j(q[z])}return g}var o=r(7),K={},L=["REJECTED"],e=["FULFILLED"],m=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(g,j){if("function"!=typeof g&&this.state===e||"function"!=typeof j&&this.state===L){return this}var k=new this.constructor(t);if(this.state!==m){var q=this.state===e?g:j;h(k,q,this.outcome)}else{this.queue.push(new b(k,g,j))}return k},b.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){K.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},K.resolve=function(g,w){var k=n(a,w);if("error"===k.status){return K.reject(g,k.value)}var j=k.value;if(j){y(g,j)}else{g.state=e,g.outcome=w;for(var q=-1,x=g.queue.length;++q<x;){g.queue[q].callFulfilled(w)}}return g},K.reject=function(q,j){q.state=L,q.outcome=j;for(var k=-1,g=q.queue.length;++k<g;){q.queue[k].callRejected(j)}return q},v.resolve=s,v.reject=i,v.all=p,v.race=f},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function s(q){if(null!==q){switch(typeof q){case"boolean":return q?1:0;case"number":return p(q);case"string":return q.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var g=Array.isArray(q),m=g?q:Object.keys(q),v=-1,j=m.length,w="";if(g){for(;++v<j;){w+=h.toIndexableString(m[v])}}else{for(;++v<j;){var k=m[v];w+=h.toIndexableString(k)+h.toIndexableString(q[k])}}return w}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+n),m=parseInt(j,10)+e;for(x&&(m=-m),k+=n;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(m,v){var g=m.pop();if(v.length){var w=v[v.length-1];g===w.element&&(v.pop(),w=v[v.length-1]);var j=w.element,q=w.index;if(Array.isArray(j)){j.push(g)}else{if(q===m.length-2){var k=m.pop();j[k]=g}else{m.push(g)}}}}function b(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(q,g){for(var m=Object.keys(q),v=Object.keys(g),j=Math.min(m.length,v.length),w=0;j>w;w++){var k=h.collate(m[w],v[w]);if(0!==k){return k}if(k=h.collate(q[m[w]],g[v[w]]),0!==k){return k}}return m.length===v.length?0:m.length>v.length?1:-1}function a(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function p(m){if(0===m){return"1"}var g=m.toExponential().split(/e\+?/),v=parseInt(g[1],10),x=0>m,w=x?"0":"2",q=(x?-v:v)-e,k=i.padLeft(q.toString(),"0",n);w+=u+k;var y=Math.abs(parseFloat(g[0]));x&&(y=10-y);var j=y.toFixed(20);return j=j.replace(/\.?0+$/,""),w+=u+j}var e=-324,n=3,u="",i=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=a(j),g=a(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=h.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=h.normalizeKey(m))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),a(g)+u+s(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(b,h,a){function e(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var o,f=n.length,g=r.length;for(o=0;f>o;o++){if(o===g){return 1}var q=n.charAt(o),i=r.charAt(o);if(q!==i){return i>q?-1:1}}return g>f?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(t){function O(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function r(j,w,k,q,A,z,x){return O(w&k|~w&q,j,w,A,z,x)}function p(j,w,k,q,A,z,x){return O(w&q|k&~q,j,w,A,z,x)}function v(j,w,k,q,A,z,x){return O(w^k^q,j,w,A,z,x)}function P(j,w,k,q,A,z,x){return O(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=r(z,k,x,q,w[0],7,-680876936),q=r(q,z,k,x,w[1],12,-389564586),x=r(x,q,z,k,w[2],17,606105819),k=r(k,x,q,z,w[3],22,-1044525330),z=r(z,k,x,q,w[4],7,-176418897),q=r(q,z,k,x,w[5],12,1200080426),x=r(x,q,z,k,w[6],17,-1473231341),k=r(k,x,q,z,w[7],22,-45705983),z=r(z,k,x,q,w[8],7,1770035416),q=r(q,z,k,x,w[9],12,-1958414417),x=r(x,q,z,k,w[10],17,-42063),k=r(k,x,q,z,w[11],22,-1990404162),z=r(z,k,x,q,w[12],7,1804603682),q=r(q,z,k,x,w[13],12,-40341101),x=r(x,q,z,k,w[14],17,-1502002290),k=r(k,x,q,z,w[15],22,1236535329),z=p(z,k,x,q,w[1],5,-165796510),q=p(q,z,k,x,w[6],9,-1069501632),x=p(x,q,z,k,w[11],14,643717713),k=p(k,x,q,z,w[0],20,-373897302),z=p(z,k,x,q,w[5],5,-701558691),q=p(q,z,k,x,w[10],9,38016083),x=p(x,q,z,k,w[15],14,-660478335),k=p(k,x,q,z,w[4],20,-405537848),z=p(z,k,x,q,w[9],5,568446438),q=p(q,z,k,x,w[14],9,-1019803690),x=p(x,q,z,k,w[3],14,-187363961),k=p(k,x,q,z,w[8],20,1163531501),z=p(z,k,x,q,w[13],5,-1444681467),q=p(q,z,k,x,w[2],9,-51403784),x=p(x,q,z,k,w[7],14,1735328473),k=p(k,x,q,z,w[12],20,-1926607734),z=v(z,k,x,q,w[5],4,-378558),q=v(q,z,k,x,w[8],11,-2022574463),x=v(x,q,z,k,w[11],16,1839030562),k=v(k,x,q,z,w[14],23,-35309556),z=v(z,k,x,q,w[1],4,-1530992060),q=v(q,z,k,x,w[4],11,1272893353),x=v(x,q,z,k,w[7],16,-155497632),k=v(k,x,q,z,w[10],23,-1094730640),z=v(z,k,x,q,w[13],4,681279174),q=v(q,z,k,x,w[0],11,-358537222),x=v(x,q,z,k,w[3],16,-722521979),k=v(k,x,q,z,w[6],23,76029189),z=v(z,k,x,q,w[9],4,-640364487),q=v(q,z,k,x,w[12],11,-421815835),x=v(x,q,z,k,w[15],16,530742520),k=v(k,x,q,z,w[2],23,-995338651),z=P(z,k,x,q,w[0],6,-198630844),q=P(q,z,k,x,w[7],10,1126891415),x=P(x,q,z,k,w[14],15,-1416354905),k=P(k,x,q,z,w[5],21,-57434055),z=P(z,k,x,q,w[12],6,1700485571),q=P(q,z,k,x,w[3],10,-1894986606),x=P(x,q,z,k,w[10],15,-1051523),k=P(k,x,q,z,w[1],21,-2054922799),z=P(z,k,x,q,w[8],6,1873313359),q=P(q,z,k,x,w[15],10,-30611744),x=P(x,q,z,k,w[6],15,-1560198380),k=P(k,x,q,z,w[13],21,1309151649),z=P(z,k,x,q,w[4],6,-145523070),q=P(q,z,k,x,w[11],10,-1120210379),x=P(x,q,z,k,w[2],15,718787259),k=P(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function y(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function s(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function Q(C){var x,A,B,w,k,q,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;z>=x;x+=64){g(j,y(C.substring(x-64,x)))}for(C=C.substring(x-64),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;A>x;x+=1){B[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(B[x>>2]|=128<<(x%4<<3),x>55){for(g(j,B),x=0;16>x;x+=1){B[x]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),q=parseInt(w[1],16)||0,B[14]=k,B[15]=q,g(j,B),j}function u(C){var q,A,B,w,k,x,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(q=64;z>=q;q+=64){g(j,s(C.subarray(q-64,q)))}for(C=z>q-64?C.subarray(q-64):new Uint8Array(0),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=0;A>q;q+=1){B[q>>2]|=C[q]<<(q%4<<3)}if(B[q>>2]|=128<<(q%4<<3),q>55){for(g(j,B),q=0;16>q;q+=1){B[q]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,B[14]=k,B[15]=x,g(j,B),j}function o(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function n(j){var k;for(k=0;k<j.length;k+=1){j[k]=o(j[k])}return j.join("")}function l(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function m(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==n(Q("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(q,C){var B,x,D,w,k=this.byteLength,A=j(q,k),z=k;return C!==t&&(z=j(C,k)),A>z?new ArrayBuffer(0):(B=z-A,x=new ArrayBuffer(B),D=new Uint8Array(x),w=new Uint8Array(this,A,B),D.set(w),x)}}(),m.prototype.append=function(j){return this.appendBinary(l(j)),this},m.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,y(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},m.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},m.hash=function(j,k){return m.hashBinary(l(j),k)},m.hashBinary=function(j,w){var q=Q(j),k=n(q);return w?e(k):k},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,s(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var j=m.prototype.getState.call(this);return j.buff=S(j.buff),j},m.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),m.prototype.setState.call(this,j)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(j,w){var q=u(new Uint8Array(j)),k=n(q);return w?e(k):k},m})},{}],17:[function(b,h,a){function e(n,r,o){var f=o[o.length-1];n===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,q=f.index;if(Array.isArray(g)){g.push(n)}else{if(q===r.length-2){var i=r.pop();g[i]=n}else{r.push(n)}}}a.stringify=function(E){var F=[];F.push({obj:E});for(var i,u,D,n,f,g,s,t,l,o,r,C="";i=F.pop();){if(u=i.obj,D=i.prefix||"",n=i.val||"",C+=D,n){C+=n}else{if("object"!=typeof u){C+="undefined"==typeof u?null:JSON.stringify(u)}else{if(null===u){C+="null"}else{if(Array.isArray(u)){for(F.push({val:"]"}),f=u.length-1;f>=0;f--){g=0===f?"":",",F.push({obj:u[f],prefix:g})}F.push({val:"["})}else{s=[];for(t in u){u.hasOwnProperty(t)&&s.push(t)}for(F.push({val:"}"}),f=s.length-1;f>=0;f--){l=s[f],o=u[l],r=f>0?",":"",r+=JSON.stringify(l)+":",F.push({obj:o,prefix:r})}F.push({val:"{"})}}}}}return C},a.parse=function(n){for(var u,D,g,t,A,B,l,C,f,o=[],s=[],i=0;;){if(u=n[i++],"}"!==u&&"]"!==u&&"undefined"!=typeof u){switch(u){case" ":case"	":case"\n":case":":case",":break;case"n":i+=3,e(null,o,s);break;case"t":i+=3,e(!0,o,s);break;case"f":i+=4,e(!1,o,s);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",i--;;){if(g=n[i++],!/[\d\.\-e\+]/.test(g)){i--;break}D+=g}e(parseFloat(D),o,s);break;case'"':for(t="",A=void 0,B=0;;){if(l=n[i++],'"'===l&&("\\"!==A||B%2!==1)){break}t+=l,A=l,"\\"===A?B++:B=0}e(JSON.parse('"'+t+'"'),o,s);break;case"[":C={element:[],index:o.length},o.push(C.element),s.push(C);break;case"{":f={element:{},index:o.length},o.push(f.element),s.push(f);break;default:throw new Error("unexpectedly reached end of input: "+u)}}else{if(1===o.length){return o.pop()}e(o.pop(),o,s)}}}},{}]},{},[3])(3)});