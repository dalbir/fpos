!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(k,m){if(!c[k]){if(!h[k]){var l="function"==typeof require&&require;if(!m&&l){return l(k,!0)}if(d){return d(k,!0)}var i=new Error("Cannot find module '"+k+"'");throw i.code="MODULE_NOT_FOUND",i}var e=c[k]={exports:{}};h[k][0].call(e.exports,function(n){var o=h[k][1][n];return g(o?o:n)},e,e.exports,a,h,c,f)}return c[k].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,q,n,m,o,e;if(this._events||(this._events={}),"error"===p&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(q=this._events[p],g(q)){return !1}if(k(q)){switch(arguments.length){case 1:q.call(this);break;case 2:q.call(this,arguments[1]);break;case 3:q.call(this,arguments[1],arguments[2]);break;default:m=Array.prototype.slice.call(arguments,1),q.apply(this,m)}}else{if(c(q)){for(m=Array.prototype.slice.call(arguments,1),e=q.slice(),n=e.length,o=0;n>o;o++){e[o].apply(this,m)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(i,n){function m(){this.removeListener(i,m),e||(e=!0,n.apply(this,arguments))}if(!k(n)){throw TypeError("listener must be a function")}var e=!1;return m.listener=n,this.on(i,m),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(c(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(d,j,y){function c(){w&&k&&(w=!1,k.length?g=k.concat(g):p=-1,g.length&&x())}function x(){if(!w){var f=A(c);w=!0;for(var e=g.length;e;){for(k=g,g=[];++p<e;){k&&k[p].run()}p=-1,e=g.length}k=null,w=!1,v(f)}}function z(f,e){this.fun=f,this.array=e}function q(){}var A,v,m=j.exports={};!function(){try{A=setTimeout}catch(e){A=function(){throw new Error("setTimeout is not defined")}}try{v=clearTimeout}catch(e){v=function(){throw new Error("clearTimeout is not defined")}}}();var k,g=[],w=!1,p=-1;m.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}g.push(new z(f,e)),1!==g.length||w||A(x,0)},z.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=q,m.addListener=q,m.once=q,m.off=q,m.removeListener=q,m.removeAllListeners=q,m.emit=q,m.binding=function(e){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(e){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],3:[function(d,c,f){(function(du,bq){function fD(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function eK(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eG(g){if("function"==typeof g.slice){return g.slice(0)}var i=new ArrayBuffer(g.byteLength),h=new Uint8Array(i),j=new Uint8Array(g);return h.set(j),i}function eA(h){if(h instanceof ArrayBuffer){return eG(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function dy(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&ka.call(i)==cJ}function e0(g){var j,i,k;if(!g||"object"!=typeof g){return g}if(Array.isArray(g)){for(j=[],i=0,k=g.length;k>i;i++){j[i]=e0(g[i])}return j}if(g instanceof Date){return g.toISOString()}if(eK(g)){return eA(g)}if(!dy(g)){return g}j={};for(i in g){if(Object.prototype.hasOwnProperty.call(g,i)){var h=e0(g[i]);"undefined"!=typeof h&&(j[i]=h)}}return j}function aA(h){var g=!1;return b9(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function ed(g){return b9(function(j){j=e0(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){du.nextTick(function(){i(n,m)})});var h=new aK(function(p,o){var m;try{var q=aA(function(r,s){r?o(r):p(s)});j.push(q),m=g.apply(l,j),m&&"function"==typeof m.then&&p(m)}catch(n){o(n)}});return k&&h.then(function(m){k(null,m)},k),h})}function cI(h,g){function i(m,k,o){if(bW.enabled){for(var l=[m._db_name,k],n=0;n<o.length-1;n++){l.push(o[n])}bW.apply(null,l);var j=o[o.length-1];o[o.length-1]=function(r,p){var q=[m._db_name,k];q=q.concat(r?["error",r]:["success",p]),bW.apply(null,q),j(r,p)}}}return ed(b9(function(j){if(this._closed){return aK.reject(new Error("database is closed"))}if(this._destroyed){return aK.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new aK(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function dg(h,k){for(var j={},l=0,i=k.length;i>l;l++){var g=k[l];g in h&&(j[g]=h[g])}return j}function eC(g){return g}function e3(g){return[{ok:g}]}function eB(o,r,i){function v(){var w=[];l.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),i(null,{results:w})}function g(){++s===h&&v()}function k(x,w,y){l[x]={id:w,docs:y},g()}function u(){if(!(j>=n.length)){var x=Math.min(j+ca,n.length),w=n.slice(j,x);q(w,j),j+=w.length}}function q(x,w){x.forEach(function(z,D){var B=w+D,y=p[z],A=dg(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(eC);var C=eC;0===A.open_revs.length&&(delete A.open_revs,C=e3),["revs","attachments","binary","ajax"].forEach(function(E){E in r&&(A[E]=r[E])}),o.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),k(B,z,F),u()})})}var m=r.docs,p={};m.forEach(function(w){w.id in p?p[w.id].push(w):p[w.id]=[w]});var h=Object.keys(p).length,s=0,l=new Array(h),n=Object.keys(p),j=0;u()}function f0(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function e4(){return f7}function f3(g){f0()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):e4()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function eX(){dO.EventEmitter.call(this),this._listeners={},f3(this)}function aL(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function dT(g,j){var i=600000;g=parseInt(g,10)||0,j=parseInt(j,10),j!==j||g>=j?j=(g||1)<<1:j+=1,j>i&&(g=i>>1,j=i);var k=Math.random(),h=j-g;return ~~(h*k+g)}function d8(h){var g=0;return h||(g=2000),dT(h,g)}function av(h,g){aL("info","The above "+h+" is totally normal. "+g)}function bs(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function ds(g,i,h){function j(k){for(var l in g){"function"!=typeof g[l]&&(this[l]=g[l])}void 0!==h&&(this.name=h),void 0!==k&&(this.reason=k)}return j.prototype=bs.prototype,new j(i)}function e(h){var k,j,l,i,g;return j=h.error===!0&&"string"==typeof h.name?h.name:h.error,g=h.reason,l=dV("name",j,g),h.missing||"missing"===g||"deleted"===g||"not_found"===j?l=dJ:"doc_validation"===j?(l=fI,i=g):"bad_request"===j&&l.message!==g&&(l=df),l||(l=dV("status",h.status,g)||eF),k=ds(l,g,j),i&&(k.message=i),h.id&&(k.id=h.id),h.status&&(k.status=h.status),h.missing&&(k.missing=h.missing),k}function aU(g,j,i){try{return !g(j,i)}catch(k){var h="Filter function threw: "+k.toString();return ds(df,h)}}function dk(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&aU(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function fE(g){for(var i=[],h=0,j=g.length;j>h;h++){i=i.concat(g[h])}return i}function bc(h){var g;if(h?"string"!=typeof h?g=ds(bz):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=ds(fC)):g=ds(cs),g){throw g}}function d3(h,g){return"listenerCount" in h?h.listenerCount(g):dO.EventEmitter.listenerCount(h,g)}function d2(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function kc(h){var g=d2(h);return g?g.join("/"):null}function aE(j){for(var m=fO.exec(j),g={},i=14;i--;){var k=fG[i],l=m[i]||"",h=-1!==["user","password"].indexOf(k);g[k]=h?decodeURIComponent(l):l}return g[cG]={},g[fG[12]].replace(dw,function(o,p,n){p&&(g[cG][p]=n)}),g}function bl(h,g,i){return new aK(function(j,k){h.get(g,function(l,n){if(l){if(404!==l.status){return k(l)}n={}}var m=n._rev,o=i(n);return o?(o._id=g,o._rev=m,void j(aT(h,o,i))):j({updated:!1,rev:m})})})}function aT(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return bl(h,g._id,i)})}function ch(g){return 0|Math.random()*g}function dC(g,i){i=i||f1.length;var h="",j=-1;if(g){for(;++j<g;){h+=f1[ch(i)]}return h}for(;++j<36;){switch(j){case 8:case 13:case 18:case 23:h+="-";break;case 19:h+=f1[3&ch(16)|8];break;default:h+=f1[ch(16)]}}return h}function eO(r){for(var j,m,k,l,o=r.rev_tree.slice();l=o.pop();){var h=l.ids,p=h[2],i=l.pos;if(p.length){for(var g=0,q=p.length;q>g;g++){o.push({pos:i+1,ids:p[g]})}}else{var n=!!h[1].deleted,s=h[0];j&&!(k!==n?k:m!==i?i>m:s>j)||(j=s,m=i,k=n)}}return m+"-"+j}function aD(g,i){for(var m,k=g.slice();m=k.pop();){for(var l=m.pos,o=m.ids,h=o[2],j=i(0===h.length,l,o[0],m.ctx,o[1]),p=0,n=h.length;n>p;p++){k.push({pos:l+1,ids:h[p],ctx:j})}}}function e5(h,g){return h.pos-g.pos}function ap(g){var i=[];aD(g,function(k,m,o,l,n){k&&i.push({rev:m+"-"+o,pos:m,opts:n})}),i.sort(e5).reverse();for(var h=0,j=i.length;j>h;h++){delete i[h].pos}return i}function bP(j){for(var m=eO(j),g=ap(j.rev_tree),i=[],k=0,l=g.length;l>k;k++){var h=g[k];h.rev===m||h.opts.deleted||i.push(h.rev)}return i}function fH(h){var g=[];return aD(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function aP(r){for(var j,m=[],k=r.slice();j=k.pop();){var l=j.pos,o=j.ids,h=o[0],p=o[1],i=o[2],g=0===i.length,q=j.history?j.history.slice():[];q.push({id:h,opts:p}),g&&m.push({pos:l+1-q.length,ids:q});for(var n=0,s=i.length;s>n;n++){k.push({pos:l+1,ids:i[n],history:q})}}return m.reverse()}function bV(h,g){return h.pos-g.pos}function fB(h,k,j){for(var l,i=0,g=h.length;g>i;){l=i+g>>>1,j(h[l],k)<0?i=l+1:g=l}return i}function j4(g,i,h){var j=fB(g,i,h);g.splice(j,0,i)}function cV(l,n){for(var i,g,h=n,m=l.length;m>h;h++){var k=l[h],j=[k.id,k.opts,[]];g?(g[2].push(j),g=j):i=g=j}return i}function f5(h,g){return h[0]<g[0]?-1:1}function cP(g,i){for(var m=[{tree1:g,tree2:i}],k=!1;m.length>0;){var l=m.pop(),o=l.tree1,h=l.tree2;(o[1].status||h[1].status)&&(o[1].status="available"===o[1].status||"available"===h[1].status?"available":"missing");for(var j=0;j<h[2].length;j++){if(o[2][0]){for(var p=!1,n=0;n<o[2].length;n++){o[2][n][0]===h[2][j][0]&&(m.push({tree1:o[2][n],tree2:h[2][j]}),p=!0)}p||(k="new_branch",j4(o[2],h[2][j],f5))}else{k="new_leaf",o[2][0]=h[2][j]}}}return{conflicts:k,tree:g}}function eM(m,w,z){var v,k=[],o=!1,u=!1;if(!m.length){return{tree:[w],conflicts:"new_leaf"}}for(var y=0,j=m.length;j>y;y++){var x=m[y];if(x.pos===w.pos&&x.ids[0]===w.ids[0]){v=cP(x.ids,w.ids),k.push({pos:x.pos,ids:v.tree}),o=o||v.conflicts,u=!0}else{if(z!==!0){var s=x.pos<w.pos?x:w,n=x.pos<w.pos?w:x,q=n.pos-s.pos,p=[],i=[];for(i.push({ids:s.ids,diff:q,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],r=0,A=g.length;A>r;r++){i.push({ids:g[r],diff:h.diff-1,parent:h.ids,parentIdx:r})}}else{h.ids[0]===n.ids[0]&&p.push(h)}}var l=p[0];l?(v=cP(l.ids,n.ids),l.parent[2][l.parentIdx]=v.tree,k.push({pos:s.pos,ids:s.ids}),o=o||v.conflicts,u=!0):k.push(x)}else{k.push(x)}}}return u||k.push(w),k.sort(bV),{tree:k,conflicts:o||"internal_node"}}function aj(r,j){for(var m,k=aP(r),l={},o=0,h=k.length;h>o;o++){for(var p=k[o],i=p.ids,g=Math.max(0,i.length-j),q={pos:p.pos+g,ids:cV(i,g)},n=0;g>n;n++){var s=p.pos+n+"-"+i[n].id;l[s]=!0}m=m?eM(m,q,!0).tree:[q]}return aD(m,function(w,v,u){delete l[v+"-"+u]}),{tree:m,revs:Object.keys(l)}}function jY(g,j,i){var k=eM(g,j),h=aj(k.tree,i);return{tree:h.tree,stemmedRevs:h.revs,conflicts:k.conflicts}}function eY(g,i){for(var m,k=g.slice(),l=i.split("-"),o=parseInt(l[0],10),h=l[1];m=k.pop();){if(m.pos===o&&m.ids[0]===h){return !0}for(var j=m.ids[2],p=0,n=j.length;n>p;p++){k.push({pos:m.pos+1,ids:j[p]})}}return !1}function dd(g){return g.ids}function aI(g,j){j||(j=eO(g));for(var i,k=j.substring(j.indexOf("-")+1),h=g.rev_tree.map(dd);i=h.pop();){if(i[0]===k){return !!i[1].deleted}h=h.concat(i[2])}}function jQ(g){return/^_local/.test(g)}function fN(g){return e9("return "+g+";",{})}function dH(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function bU(h,g){try{h.emit("change",g)}catch(i){aL("error",'Error in .on("change", function):',i)}}function cm(j,m,g){function i(){k.cancel()}dO.EventEmitter.call(this);var k=this;this.db=j,m=m?e0(m):{};var l=m.complete=aA(function(o,n){o?d3(k,"error")>0&&k.emit("error",o):k.emit("complete",n),k.removeAllListeners(),j.removeListener("destroyed",i)});g&&(k.on("complete",function(n){g(null,n)}),k.on("error",g)),j.once("destroyed",i),m.onChange=function(n){m.isCancelled||(bU(k,n),k.startSeq&&k.startSeq<=n.seq&&(k.startSeq=!1))};var h=new aK(function(o,n){m.complete=function(p,q){p?n(p):o(q)}});k.once("cancel",function(){j.removeListener("destroyed",i),m.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){l(null,n)},l),j.taskqueue.isReady?k.doChanges(m):j.taskqueue.addTask(function(){k.isCancelled?k.emit("cancel"):k.doChanges(m)})}function eE(g,j,i){var k=[{rev:g._rev}];"all_docs"===i.style&&(k=ap(j.rev_tree).map(function(l){return{rev:l.rev}}));var h={id:j.id,changes:k,doc:g};return aI(j,g._rev)&&(h.deleted=!0),i.conflicts&&(h.doc._conflicts=bP(j),h.doc._conflicts.length||delete h.doc._conflicts),h}function aY(h,g){return g>h?-1:h>g?1:0}function kk(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function cd(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function f8(h){for(var k=0;k<h.length;k++){var j=h[k];if(j._deleted){delete j._attachments}else{if(j._attachments){for(var l=Object.keys(j._attachments),i=0;i<l.length;i++){var g=l[i];j._attachments[g]=dg(j._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function jF(g,j){var i=aY(g._id,j._id);if(0!==i){return i}var k=g._revisions?g._revisions.start:0,h=j._revisions?j._revisions.start:0;return aY(k,h)}function ek(h){var g={},i=[];return aD(h,function(k,j,l,n){var m=j+"-"+l;return k&&(g[m]=0),void 0!==n&&i.push({from:n,to:m}),m}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function e1(g,j,i){var k="limit" in j?j.keys.slice(j.skip,j.limit+j.skip):j.skip>0?j.keys.slice(j.skip):j.keys;if(j.descending&&k.reverse(),!k.length){return g._allDocs({limit:0},i)}var h={offset:j.skip};return aK.all(k.map(function(m){var l=jH.extend({key:m,deleted:"ok"},j);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new aK(function(o,n){g._allDocs(l,function(q,p){return q?n(q):(h.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return h.rows=l,h})}function dZ(g){var i=g._compactionQueue[0],j=i.opts,h=i.callback;g.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(j.last_seq=k.last_seq),g._compact(j,function(l,m){l?h(l):h(null,m),du.nextTick(function(){g._compactionQueue.shift(),g._compactionQueue.length&&dZ(g)})})})}function eR(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function bS(){dO.EventEmitter.call(this)}function c3(){this.isReady=!1,this.failed=!1,this.queue=[]}function eh(g){g&&bq.debug&&aL("error",g)}function bd(j,m){function g(){l.emit("destroyed",k)}function i(){j.removeListener("destroyed",g),j.emit("destroyed",j)}var k=m.originalName,l=j.constructor,h=l._destructionListeners;j.once("destroyed",g),h.has(k)||h.set(k,[]),h.get(k).push(i)}function c9(j,m,g){if(!(this instanceof c9)){return new c9(j,m,g)}var i=this;if("function"!=typeof m&&"undefined"!=typeof m||(g=m,m={}),j&&"object"==typeof j&&(m=j,j=void 0),"undefined"==typeof g){g=eh}else{var k=g;g=function(){return aL("warn","Using a callback for new PouchDB()is deprecated."),k.apply(null,arguments)}}j=j||m.name,m=e0(m),delete m.name,this.__opts=m;var l=g;i.auto_compaction=m.auto_compaction,i.prefix=c9.prefix,bS.call(i),i.taskqueue=new c3;var h=new aK(function(o,q){g=function(r,s){return r?q(r):(delete s.then,void o(s))},m=e0(m);var p,n;return function(){try{if("string"!=typeof j){throw n=new Error("Missing/invalid DB name"),n.code=400,n}var r=(m.prefix||"")+j;if(p=c9.parseAdapter(r,m),m.originalName=j,m.name=p.name,m.adapter=m.adapter||p.adapter,i._adapter=m.adapter,cf("pouchdb:adapter")("Picked adapter: "+m.adapter),i._db_name=j,!c9.adapters[m.adapter]){throw n=new Error("Adapter is missing"),n.code=404,n}if(!c9.adapters[m.adapter].valid()){throw n=new Error("Invalid Adapter"),n.code=404,n}}catch(s){i.taskqueue.fail(s)}}(),n?q(n):(i.adapter=m.adapter,i.replicate={},i.replicate.from=function(r,u,s){return i.constructor.replicate(r,i,u,s)},i.replicate.to=function(r,u,s){return i.constructor.replicate(i,r,u,s)},i.sync=function(r,u,s){return i.constructor.sync(i,r,u,s)},i.replicate.sync=i.sync,void c9.adapters[m.adapter].call(i,m,function(r){return r?(i.taskqueue.fail(r),void g(r)):(bd(i,m),i.emit("created",i),c9.emit("created",m.originalName),i.taskqueue.ready(i),void g(null,i))}))});h.then(function(n){l(null,n)},l),i.then=h.then.bind(h),i["catch"]=h["catch"].bind(h)}function dE(h){Object.keys(dO.EventEmitter.prototype).forEach(function(i){"function"==typeof dO.EventEmitter.prototype[i]&&(h[i]=bE[i].bind(bE))});var g=h._destructionListeners=new cS.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function dY(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function bR(g){if(!/^\d+\-./.test(g)){return ds(bA)}var i=g.indexOf("-"),h=g.substring(0,i),j=g.substring(i+1);return{prefix:parseInt(h,10),id:j}}function eU(j,m){for(var g=j.start-j.ids.length+1,i=j.ids,k=[i[0],m,[]],l=1,h=i.length;h>l;l++){k=[i[l],{status:"missing"},[k]]}return[{pos:g,ids:k}]}function jV(g,i){var m,k,l,o={status:"available"};if(g._deleted&&(o.deleted=!0),i){if(g._id||(g._id=dC()),k=dC(32,16).toLowerCase(),g._rev){if(l=bR(g._rev),l.error){return l}g._rev_tree=[{pos:l.prefix,ids:[l.id,{status:"missing"},[[k,o,[]]]]}],m=l.prefix+1}else{g._rev_tree=[{pos:1,ids:[k,o,[]]}],m=1}}else{if(g._revisions&&(g._rev_tree=eU(g._revisions,o),m=g._revisions.start,k=g._revisions.ids[0]),!g._rev_tree){if(l=bR(g._rev),l.error){return l}m=l.prefix,k=l.id,g._rev_tree=[{pos:m,ids:[k,o,[]]}]}}bc(g._id),g._rev=m+"-"+k;var h={metadata:{},data:{}};for(var j in g){if(Object.prototype.hasOwnProperty.call(g,j)){var p="_"===j[0];if(p&&!ck[j]){var n=ds(fI,j);throw n.message=fI.message+": "+j,n}p&&!cD[j]?h.metadata[j.slice(1)]=g[j]:h.data[j]=g[j]}}return h}function dj(g){for(var j="",i=new Uint8Array(g),k=i.byteLength,h=0;k>h;h++){j+=String.fromCharCode(i[h])}return j}function bM(g){return cA(dj(g))}function cU(h,k){h=h||[],k=k||{};try{return new Blob(h,k)}catch(j){if("TypeError"!==j.name){throw j}for(var l="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new l,g=0;g<h.length;g+=1){i.append(h[g])}return i.getBlob(k.type)}}function jG(g){for(var j=g.length,i=new ArrayBuffer(j),k=new Uint8Array(i),h=0;j>h;h++){k[h]=g.charCodeAt(h)}return i}function bJ(h,g){return cU([jG(h)],{type:g})}function aQ(h,g){return bJ(jR(h),g)}function j7(g,i){if("undefined"==typeof FileReader){return i(dj((new FileReaderSync).readAsArrayBuffer(g)))}var h=new FileReader,j="function"==typeof h.readAsBinaryString;h.onloadend=function(k){var l=k.target.result||"";return j?i(l):void i(dj(l))},j?h.readAsBinaryString(g):h.readAsArrayBuffer(g)}function jW(h,g){j7(h,function(i){g(cA(i))})}function aB(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function dz(g){return cA(g)}function db(g,i,h,j){(h>0||j<i.byteLength)&&(i=new Uint8Array(i,h,Math.min(j,i.byteLength)-h)),g.append(i)}function c1(g,i,h,j){(h>0||j<i.length)&&(i=i.substring(h,j)),g.appendBinary(i)}function aa(g,i){function m(){var q=j*o,u=q+o;if(j++,h>j){n(p,g,q,u),cM(m)}else{n(p,g,q,u);var r=p.end(!0),s=dz(r);i(s),p.destroy()}}var k="string"==typeof g,l=k?g.length:g.byteLength,o=Math.min(bG,l),h=Math.ceil(l/o),j=0,p=k?new eP:new eP.ArrayBuffer,n=k?c1:db;m()}function dv(g){return eP.hash(g)}function jM(l,n,i){function g(o){try{return jR(o)}catch(q){var p=ds(bw,"Attachment is not a valid base64 string");return{error:p}}}function h(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=g(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===n?q.data=bJ(o,q.content_type):"base64"===n?q.data=cA(o):q.data=o,aa(o,function(r){q.digest="md5-"+r,p()})}else{aB(q.data,function(r){"binary"===n?q.data=dj(r):"base64"===n&&(q.data=bM(r)),aa(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function m(){j++,l.length===j&&(k?i(k):i())}if(!l.length){return i()}var k,j=0;l.forEach(function(r){function p(u){k=u,q++,q===s.length&&m()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return m()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&h(r.data._attachments[o],p)}})}function bB(h,B,p,v,q,k,A,i){if(eY(B.rev_tree,p.metadata.rev)){return v[q]=p,k()}var s=B.winningRev||eO(B),m="deleted" in B?B.deleted:aI(B,s),u="deleted" in p.metadata?p.metadata.deleted:aI(p.metadata),n=/^1-/.test(p.metadata.rev);if(m&&!u&&i&&n){var g=p.data;g._rev=s,g._id=p.metadata.id,p=jV(g,i)}var j=jY(B.rev_tree,p.metadata.rev_tree[0],h),w=i&&(m&&u||!m&&"new_leaf"!==j.conflicts||m&&!u&&"new_branch"===j.conflicts);if(w){var z=ds(aZ);return v[q]=z,k()}var l=p.metadata.rev;p.metadata.rev_tree=j.tree,p.stemmedRevs=j.stemmedRevs||[],B.rev_map&&(p.metadata.rev_map=B.rev_map);var x,r=eO(p.metadata),o=aI(p.metadata,r),y=m===o?0:o>m?-1:1;x=l===r?o:aI(p.metadata,l),A(p,r,o,x,!0,y,q,k)}function eg(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function aO(g,m,o,i,k,q,l,p,j){function h(C,B,x){var z=eO(C.metadata),w=aI(C.metadata,z);if("was_delete" in p&&w){return q[B]=ds(dJ,"deleted"),x()}var D=r&&eg(C);if(D){var A=ds(aZ);return q[B]=A,x()}var y=w?0:1;l(C,z,w,w,!1,y,B,x)}function u(){++n===s&&j&&j()}g=g||1000;var r=p.new_edits,v=new cS.Map,n=0,s=m.length;m.forEach(function(y,w){if(y._id&&jQ(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void o[x](y,{ctx:k},function(B,A){q[w]=B||A,u()})}var z=y.metadata.id;v.has(z)?(s--,v.get(z).push([y,w])):v.set(z,[[y,w]])}),v.forEach(function(x,z){function y(){++w<x.length?A():u()}function A(){var C=x[w],E=C[0],D=C[1];if(i.has(z)){bB(g,i.get(z),E,q,D,y,l,r)}else{var B=jY([],E.metadata.rev_tree[0],g);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],h(E,D,y)}}var w=0;A()})}function aV(h){try{return JSON.parse(h)}catch(g){return b6.parse(h)}}function b8(g){return g.length<50000?JSON.parse(g):aV(g)}function j8(h){try{return JSON.stringify(h)}catch(g){return b6.stringify(h)}}function j0(g,j,i,k){try{g.apply(j,i)}catch(h){k.emit("error",h)}}function cw(h){if(!cW.running&&cW.queue.length){cW.running=!0;var g=cW.queue.shift();g.action(function(i,j){j0(g.callback,this,[i,j],h),cW.running=!1,du.nextTick(function(){cw(h)})})}}function aG(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(ds(cu,i,h.type))}}function cO(h,g,i){return{data:j8(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function bk(h){if(!h){return null}var g=b8(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function cp(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function bH(g,i,h,j){h?j(g?"string"!=typeof g?g:aQ(g,i):cU([""],{type:i})):g?"string"!=typeof g?j7(g,function(k){j(cA(k))}):j(g):j("")}function b1(l,n,i,g){function h(){++j===k.length&&g&&g()}function m(s,q){var r=s._attachments[q],p=r.digest,o=i.objectStore(j6).get(p);o.onsuccess=function(u){r.body=u.target.result.body,h()}}var k=Object.keys(l._attachments||{});if(!k.length){return g&&g()}var j=0;k.forEach(function(o){n.attachments&&n.include_docs?m(l,o):(l._attachments[o].stub=!0,h())})}function cR(h,g){return aK.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return aK.all(j.map(function(l){var n=i.doc._attachments[l];if("body" in n){var k=n.body,m=n.content_type;return new aK(function(o){bH(k,m,g,function(p){i.doc._attachments[l]=jH.extend(dg(n,["digest","content_type"]),{data:p}),o()})})}}))}}))}function ay(g,i,m){function k(){n--,n||l()}function l(){o.length&&o.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||j["delete"](q)}})}var o=[],h=m.objectStore(dG),j=m.objectStore(j6),p=m.objectStore(bL),n=g.length;g.forEach(function(s){var r=h.index("_doc_id_rev"),q=i+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return k()}h["delete"](u);var w=p.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];o.push(x),p["delete"](y.primaryKey),y["continue"]()}else{k()}}}})}function jN(g,i,h){try{return{txn:g.transaction(i,h)}}catch(j){return{error:j}}}function b4(D,A,C,v,j,k,u){function p(){var P=[e7,dG,j6,cB,bL],O=jN(j,P,"readwrite");return O.error?u(O.error):(q=O.txn,q.onabort=aG(u),q.ontimeout=aG(u),q.oncomplete=l,H=q.objectStore(e7),E=q.objectStore(dG),N=q.objectStore(j6),y=q.objectStore(bL),void g(function(Q){return Q?(L=!0,u(Q)):void h()}))}function n(){aO(D.revs_limit,o,v,z,q,w,m,C)}function h(){function P(){++R===o.length&&n()}function U(W){var V=bk(W.target.result);V&&z.set(V.id,V),P()}if(o.length){for(var R=0,O=0,Q=o.length;Q>O;O++){var T=o[O];if(T._id&&jQ(T._id)){P()}else{var S=H.get(T.metadata.id);S.onsuccess=U}}}}function l(){L||(k.notify(v._meta.name),v._meta.docCount+=B,u(null,w))}function r(P,O){var Q=N.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=ds(bF,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(o.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){r(T,function(U){U&&!P&&(P=U),O()})})}function m(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?x(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ai){var ao=X.stemmedRevs||[];R&&v.auto_compaction&&(ao=ao.concat(fH(X.metadata))),ao&&ao.length&&ay(ao,X.metadata.id,q),T.seq=ai.target.result,delete T.rev;var an=cO(T,Q,S),ae=H.put(an);ae.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=E.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=E.put(V,ar.target.result);ao.onsuccess=W}}function Z(){w[U]={ok:!0,id:T.id,rev:Q},z.set(X.metadata.id,X.metadata),G(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=E.put(V);Y.onsuccess=W,Y.onerror=P}function x(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;I(an,ai,Q)}})}function G(R,O,T){function Q(){++V===U.length&&T()}function S(W){var Y=R.data._attachments[W].digest,X=y.put({seq:O,digestSeq:Y+"::"+O});X.onsuccess=Q,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),Q()}}var V=0,U=Object.keys(R.data._attachments||{});if(!U.length){return T()}for(var P=0;P<U.length;P++){S(U[P])}}function I(Q,O,R){var P=N.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=N.put(U);T.onsuccess=R}}for(var q,H,E,N,y,M,o=A.docs,B=0,s=0,J=o.length;J>s;s++){var F=o[s];F._id&&jQ(F._id)||(F=o[s]=jV(F,C.new_edits),F.error&&!M&&(M=F))}if(M){return u(M)}var w=new Array(o.length),z=new cS.Map,L=!1,i=v._meta.blobSupport?"blob":"base64";jM(o,i,function(O){return O?u(O):void p()})}function bh(h,k,j,l,i){try{if(h&&k){return i?IDBKeyRange.bound(k,h,!j,!1):IDBKeyRange.bound(h,k,!1,!j)}if(h){return i?IDBKeyRange.upperBound(h):IDBKeyRange.lowerBound(h)}if(k){return i?IDBKeyRange.lowerBound(k,!j):IDBKeyRange.upperBound(k,!j)}if(l){return IDBKeyRange.only(l)}}catch(g){return{error:g}}return null}function dM(g,i,h,j){return"DataError"===h.name&&0===h.code?j(null,{total_rows:g._meta.docCount,offset:i.skip,rows:[]}):void j(ds(cu,h.name,h.message))}function aR(h,k,j,l){function i(y,C){function o(N,M,O){var L=N.id+"::"+O;w.get(L).onsuccess=function(P){M.doc=cp(P.target.result),y.conflicts&&(M.doc._conflicts=bP(N)),b1(M.doc,y,x)}}function v(L,N,M){var P={id:M.id,key:M.id,value:{rev:N}},O=M.deleted;if("ok"===y.deleted){D.push(P),O?(P.value.deleted=!0,P.doc=null):y.include_docs&&o(M,P,N)}else{if(!O&&G--<=0&&(D.push(P),y.include_docs&&o(M,P,N),0===--s)){return}}L["continue"]()}function J(O){K=k._meta.docCount;var M=O.target.result;if(M){var N=bk(M.value),L=N.winningRev;v(M,L,N)}}function u(){C(null,{total_rows:K,offset:y.skip,rows:D})}function B(){y.attachments?cR(D,y.binary).then(u):u()}var E="startkey" in y?y.startkey:!1,A="endkey" in y?y.endkey:!1,F="key" in y?y.key:!1,G=y.skip||0,s="number"==typeof y.limit?y.limit:-1,q=y.inclusive_end!==!1,H="descending" in y&&y.descending?"prev":null,r=bh(E,A,q,F,H);if(r&&r.error){return dM(k,y,r.error,C)}var I=[e7,dG];y.attachments&&I.push(j6);var z=jN(j,I,"readonly");if(z.error){return C(z.error)}var x=z.txn,m=x.objectStore(e7),p=x.objectStore(dG),n=H?m.openCursor(r,H):m.openCursor(r),w=p.index("_doc_id_rev"),D=[],K=0;x.oncomplete=B,n.onsuccess=J}function g(m,n){return 0===m.limit?n(null,{total_rows:k._meta.docCount,offset:m.skip,rows:[]}):void i(m,n)}g(h,l)}function bu(g){return new aK(function(h){var i=cU([""]);g.objectStore(aJ).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function t(h,g){var i=this;cW.queue.push({action:function(j){aq(i,h,j)},callback:g}),cw(i.constructor)}function aq(s,u,j){function l(x){var w=x.createObjectStore(e7,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(j6,{keyPath:"digest"}),x.createObjectStore(a8,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aJ),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(cB,{keyPath:"_id"});var v=x.createObjectStore(bL,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function m(x,w){var v=x.objectStore(e7);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=aI(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function i(v){v.createObjectStore(cB,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function q(y,v){var z=y.objectStore(cB),w=y.objectStore(e7),x=y.objectStore(dG),A=w.openCursor();A.onsuccess=function(B){var K=B.target.result;if(K){var E=K.value,H=E.id,G=jQ(H),D=eO(E);if(G){var M=H+"::"+D,J=H+"::",C=H+"::~",L=x.index("_doc_id_rev"),I=IDBKeyRange.bound(J,C,!1,!1),F=L.openCursor(I);F.onsuccess=function(N){if(F=N.target.result){var O=F.value;O._doc_id_rev===M&&z.put(O),x["delete"](F.primaryKey),F["continue"]()}else{w["delete"](K.primaryKey),K["continue"]()}}}else{K["continue"]()}}else{v&&v()}}}function n(w){var v=w.createObjectStore(bL,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function o(y,v){var z=y.objectStore(dG),w=y.objectStore(j6),x=y.objectStore(bL),A=w.count();A.onsuccess=function(B){var C=B.target.result;return C?void (z.openCursor().onsuccess=function(F){var L=F.target.result;if(!L){return v()}for(var K=L.value,D=L.primaryKey,H=Object.keys(K._attachments||{}),J={},I=0;I<H.length;I++){var G=K._attachments[H[I]];J[G.digest]=!0}var E=Object.keys(J);for(I=0;I<E.length;I++){var M=E[I];x.put({seq:D,digestSeq:M+"::"+D})}L["continue"]()}):v()}}function g(z){function v(A){return A.data?bk(A):(A.deleted="1"===A.deletedOrLocal,A)}var y=z.objectStore(dG),x=z.objectStore(e7),w=x.openCursor();w.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=y.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=cO(B,B.winningRev,B.deleted),F=x.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=v(E.value);return B.winningRev=B.winningRev||eO(B),B.seq?A():void D()}}}var k=u.name,h=null;s._meta=null,s.type=function(){return"idb"},s._id=ed(function(v){v(null,s._meta.instanceId)}),s._bulkDocs=function(v,w,x){b4(u,v,w,s,h,dQ,x)},s._get=function(v,z,y){function C(){y(w,{doc:D,metadata:B,ctx:A})}var D,B,w,A=z.ctx;if(!A){var x=jN(h,[e7,dG,j6],"readonly");if(x.error){return y(x.error)}A=x.txn}A.objectStore(e7).get(v).onsuccess=function(E){if(B=bk(E.target.result),!B){return w=ds(dJ,"missing"),C()}if(aI(B)&&!z.rev){return w=ds(dJ,"deleted"),C()}var G=A.objectStore(dG),H=z.rev||B.winningRev,F=B.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return D=I.target.result,D&&(D=cp(D)),D?void C():(w=ds(dJ,"missing"),C())}}},s._getAttachment=function(v,z,y,C,D){var B;if(C.ctx){B=C.ctx}else{var w=jN(h,[e7,dG,j6],"readonly");if(w.error){return D(w.error)}B=w.txn}var A=y.digest,x=y.content_type;B.objectStore(j6).get(A).onsuccess=function(E){var F=E.target.result.body;bH(F,x,C.binary,function(G){D(null,G)})}},s._info=function(A){if(null===h||!bX.has(k)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,z,B=jN(h,[dG],"readonly");if(B.error){return A(B.error)}var w=B.txn,x=w.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,z=s._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:v,idb_attachment_format:s._meta.blobSupport?"binary":"base64"})}},s._allDocs=function(v,w){aR(v,s,h,w)},s._changes=function(E){function B(N){function T(){return S.seq!==O?N["continue"]():(v=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=z.get(U);V.onsuccess=function(W){R(cp(W.target.result))}}function R(V){var W=E.processChange(V,S,E);W.seq=S.seq;var U=A(W);return"object"==typeof U?E.complete(U):(U&&(J++,x&&D.push(W),E.attachments&&E.include_docs?b1(V,E,L,function(){cR([W],E.binary).then(function(){E.onChange(W)})}):E.onChange(W)),void (J!==w&&N["continue"]()))}var P=cp(N.value),O=N.key;if(F&&!F.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (G.get(P._id).onsuccess=function(U){S=bk(U.target.result),y.set(P._id,S),T()})}function I(N){var O=N.target.result;O&&B(O)}function M(){var P=[e7,dG];E.attachments&&P.push(j6);var O=jN(h,P,"readonly");if(O.error){return E.complete(O.error)}L=O.txn,L.onabort=aG(E.complete),L.oncomplete=H,C=L.objectStore(dG),G=L.objectStore(e7),z=C.index("_doc_id_rev");var N;N=E.descending?C.openCursor(null,"prev"):C.openCursor(IDBKeyRange.lowerBound(E.since,!0)),N.onsuccess=I}function H(){function N(){E.complete(null,{results:D,last_seq:v})}!E.continuous&&E.attachments?cR(D).then(N):N()}if(E=e0(E),E.continuous){var K=k+":"+dC();return dQ.addListener(k,K,s,E),dQ.notify(k),{cancel:function(){dQ.removeListener(k,K)}}}var F=E.doc_ids&&new cS.Set(E.doc_ids);E.since=E.since||0;var v=E.since,w="limit" in E?E.limit:-1;0===w&&(w=1);var x;x="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var L,C,G,z,D=[],J=0,A=dk(E),y=new cS.Map;M()},s._close=function(v){return null===h?v(ds(eQ)):(h.close(),bX["delete"](k),h=null,void v())},s._getRevisionTree=function(z,v){var y=jN(h,[e7],"readonly");if(y.error){return v(y.error)}var x=y.txn,w=x.objectStore(e7).get(z);w.onsuccess=function(B){var A=bk(B.target.result);A?v(null,A.rev_tree):v(ds(dJ))}},s._doCompaction=function(y,A,z){var x=[e7,dG,j6,bL],v=jN(h,x,"readwrite");if(v.error){return z(v.error)}var B=v.txn,w=B.objectStore(e7);w.get(y).onsuccess=function(E){var C=bk(E.target.result);aD(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),ay(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(e7).put(cO(C,D,F))},B.onabort=aG(z),B.oncomplete=function(){z()}},s._getLocal=function(z,v){var y=jN(h,[cB],"readonly");if(y.error){return v(y.error)}var x=y.txn,w=x.objectStore(cB).get(z);w.onerror=aG(v),w.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,v(null,A)):v(ds(dJ))}},s._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=jN(h,[cB],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=aG(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(cB);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(ds(aZ))}}):(y=v.add(E),y.onerror=function(F){x(ds(aZ)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},s._removeLocal=function(v,z,y){"function"==typeof z&&(y=z,z={});var C=z.ctx;if(!C){var D=jN(h,[cB],"readwrite");if(D.error){return y(D.error)}C=D.txn,C.oncomplete=function(){B&&y(null,B)}}var B,w=v._id,A=C.objectStore(cB),x=A.get(w);x.onerror=aG(y),x.onsuccess=function(F){var E=F.target.result;E&&E._rev===v._rev?(A["delete"](w),B={ok:!0,id:w,rev:"0-0"},z.ctx&&y(null,B)):y(ds(dJ))}},s._destroy=function(w,y){dQ.removeAllListeners(k);var x=dl.get(k);x&&x.result&&(x.result.close(),bX["delete"](k));var v=indexedDB.deleteDatabase(k);v.onsuccess=function(){dl["delete"](k),e4()&&k in localStorage&&delete localStorage[k],y(null,{ok:!0})},v.onerror=aG(y)};var p=bX.get(k);if(p){return h=p.idb,s._meta=p.global,void du.nextTick(function(){j(null,s)})}var r;r=u.storage?j1(k,u.storage):indexedDB.open(k,e6),dl.set(k,r),r.onupgradeneeded=function(v){function y(){var B=x[A-1];A++,B&&B(z,y)}var w=v.target.result;if(v.oldVersion<1){return l(w)}var z=v.currentTarget.transaction;v.oldVersion<3&&i(w),v.oldVersion<4&&n(w);var x=[m,q,o,g],A=v.oldVersion;y()},r.onsuccess=function(w){h=w.target.result,h.onversionchange=function(){h.close(),bX["delete"](k)},h.onabort=function(B){aL("error","Database has a global failure",B.target.error),h.close(),bX["delete"](k)};var z=h.transaction([a8,aJ,e7],"readwrite"),x=z.objectStore(a8).get(a8),v=null,y=null,A=null;x.onsuccess=function(D){var B=function(){null!==v&&null!==y&&null!==A&&(s._meta={name:k,instanceId:A,blobSupport:v,docCount:y},bX.set(k,{idb:h,global:s._meta}),j(null,s))},E=D.target.result||{id:a8};k+"_id" in E?(A=E[k+"_id"],B()):(A=dC(),E[k+"_id"]=A,z.objectStore(a8).put(E).onsuccess=function(){B()}),d6||(d6=bu(z)),d6.then(function(F){v=F,B()});var C=z.objectStore(e7).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){y=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";aL("error",v),j(ds(cu,v))}}function j1(h,g){try{return indexedDB.open(h,{version:e6,storage:g})}catch(i){return indexedDB.open(h,e6)}}function al(g){g.adapter("idb",t,!0)}function am(g){return decodeURIComponent(escape(g))}function cH(g){return 65>g?g-48:g-55}function fK(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(cH(g.charCodeAt(i++))<<4|cH(g.charCodeAt(i++)))}return j}function cy(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(cH(g.charCodeAt(i+2))<<12|cH(g.charCodeAt(i+3))<<8|cH(g.charCodeAt(i))<<4|cH(g.charCodeAt(i+1))),i+=4}return j}function aw(h,g){return"UTF-8"===g?am(fK(h,0,h.length)):cy(h,0,h.length)}function c5(g){return"'"+g+"'"}function cZ(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function bf(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function b5(g){return delete g._id,delete g._rev,JSON.stringify(g)}function bY(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function bg(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function aW(g,j,i,k,h){return"SELECT "+g+" FROM "+("string"==typeof j?j:j.join(" JOIN "))+(i?" ON "+i:"")+(k?" WHERE "+("string"==typeof k?k:k.join(" AND ")):"")+(h?" ORDER BY "+h:"")}function aS(j,m,g){function i(){++l===j.length&&k()}function k(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+jT+" WHERE seq IN "+bg(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+jT+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+jT+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new cS.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+jT+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+b0+" WHERE digest=?",[A]))})})})}})}}if(j.length){var l=0,h=[];j.forEach(function(o){var n="SELECT seq FROM "+cK+" WHERE doc_id=? AND rev=?";g.executeSql(n,[m,o],function(q,p){if(!p.rows.length){return i()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+cK+" WHERE seq=?",[r],i)})})}}function az(g){return function(h){aL("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(ds(ba,j,i))}}function dX(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function aM(j,l,i,n,g,h,z){function m(){return r?z(r):(h.notify(n._name),n._docCount=-1,void z(null,A))}function C(E,D){var F="SELECT count(*) as cnt FROM "+b0+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=ds(bF,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function s(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){C(I,function(J){J&&!E&&(E=J),D()})})}function u(P,I,D,N,L,F,K,H){function R(){function W(ar,at){function a0(){return ++ae===ao.length&&at(),!1}function ai(a1){var a2="INSERT INTO "+jT+" (digest, seq) VALUES (?,?)",a3=[V._attachments[a1].digest,ar];p.executeSql(a2,a3,a0,a0)}var ae=0,ao=Object.keys(V._attachments||{});if(!ao.length){return at()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var V=P.data,Y=N?1:0,T=V._id,X=V._rev,Z=b5(V),S="INSERT INTO "+cK+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",U=[T,X,Z,Y];p.executeSql(S,U,function(an,ai){var ae=ai.insertId;W(ae,function(){Q(an,ae)})},function(){var ae=aW("seq",cK,null,"doc_id=? AND rev=?");return p.executeSql(ae,[T,X],function(ao,ar){var ai=ar.rows.item(0).seq,an="UPDATE "+cK+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[Z,Y,T,X];ao.executeSql(an,at,function(a0){W(ai,function(){Q(a0,ai)})})}),!1})}function O(S){M||(S?(M=S,H(M)):G===E.length&&R())}function J(S){G++,O(S)}function Q(Y,X){var T=P.metadata.id,S=P.stemmedRevs||[];L&&n.auto_compaction&&(S=fH(P.metadata).concat(S)),S.length&&aS(S,T,Y),P.metadata.seq=X,delete P.metadata.rev;var U=L?"UPDATE "+bD+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+cK+" WHERE doc_id="+bD+".id AND rev=?) WHERE id=?":"INSERT INTO "+bD+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",V=j8(P.metadata),W=L?[V,X,I,T]:[T,X,X,V];Y.executeSql(U,W,function(){A[K]={ok:!0,id:P.metadata.id,rev:I},w.set(T,P.metadata),H()})}var M=null,G=0;P.data._id=P.metadata.id,P.data._rev=P.metadata.rev;var E=Object.keys(P.data._attachments||{});N&&(P.data._deleted=!0),E.forEach(function(U){var S=P.data._attachments[U];if(S.stub){G++,O()}else{var T=S.data;delete S.data,S.revpos=parseInt(I,10);var V=S.digest;q(V,T,J)}}),E.length||R()}function y(){aO(j.revs_limit,o,n,w,p,A,u,i)}function k(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&jQ(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+bD+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=b8(I.rows.item(0).json);w.set(H,K)}D()})})}function q(F,D,G){var E="SELECT digest FROM "+b0+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+b0+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,cZ(D)],function(){G()},function(){return G(),!1}))})}var x=i.new_edits,B=l.docs,o=B.map(function(E){if(E._id&&jQ(E._id)){return E}var D=jV(E,x);return D}),v=o.filter(function(D){return D.error});if(v.length){return z(v[0])}var p,r,A=new Array(o.length),w=new cS.Map;jM(o,"binary",function(D){return D?z(D):void g.transaction(function(E){p=E,s(function(F){F?r=F:k(y)})},az(z),m)})}function el(g){return g.websql(g.name,g.version,g.description,g.size)}function bT(h){try{return{db:el(h)}}catch(g){return{error:g}}}function dx(h){var g=cv.get(h.name);return g||(g=bT(h),cv.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function cX(l,g,j,h,k){function m(){++o===i.length&&k&&k()}function n(q,s){var r=q._attachments[s],p={binary:g.binary,ctx:h};j._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=jH.extend(dg(r,["digest","content_type"]),{data:v}),m()})}var i=Object.keys(l._attachments||{});if(!i.length){return k&&k()}var o=0;i.forEach(function(p){g.attachments&&g.include_docs?n(l,p):(l._attachments[p].stub=!0,m())})}function eI(v,j){function i(){e4()&&(window.localStorage["_pouch__websqldb_"+C._name]=!0),j(null,C)}function k(F,E){F.executeSql(cQ),F.executeSql("ALTER TABLE "+cK+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(dW),F.executeSql("ALTER TABLE "+bD+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+bD+" (local, id)");var G="SELECT "+bD+".winningseq AS seq, "+bD+".json AS metadata FROM "+cK+" JOIN "+bD+" ON "+cK+".seq = "+bD+".winningseq";F.executeSql(G,[],function(O,K){for(var N=[],I=[],J=0;J<K.rows.length;J++){var L=K.rows.item(J),M=L.seq,H=JSON.parse(L.metadata);aI(H)&&N.push(M),jQ(H.id)&&I.push(H.id)}O.executeSql("UPDATE "+bD+"SET local = 1 WHERE id IN "+bg(I.length),I,function(){O.executeSql("UPDATE "+cK+" SET deleted = 1 WHERE seq IN "+bg(N.length),N,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+aF+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+bD+".id AS id, "+cK+".json AS data FROM "+cK+" JOIN "+bD+" ON "+cK+".seq = "+bD+".winningseq WHERE local = 1";F.executeSql(H,[],function(K,M){function J(){if(!L.length){return E(K)}var O=L.shift(),N=JSON.parse(O.data)._rev;K.executeSql("INSERT INTO "+aF+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+bD+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+cK+" WHERE seq=?",[O.seq],function(){J()})})})}for(var L=[],I=0;I<M.rows.length;I++){L.push(M.rows.item(I))}J()})})}function o(G,E){function H(J){function I(){if(!J.length){return E(G)}var L=J.shift(),P=aw(L.hex,s),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+cK+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){I()})}I()}var F="ALTER TABLE "+cK+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+cK+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(ej,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+cK;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function w(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+b0;I.executeSql(J,[],function(K,M){function P(){var Q=aW(cN+", "+bD+".id AS id",[bD,cK],aH,null,bD+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,T){function X(at,ar){var ao=V[at]=V[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!T.rows.length){return E(ai)}for(var V={},an=0;an<T.rows.length;an++){for(var S=T.rows.item(an),R=bY(S.data,S.id,S.rev),W=Object.keys(R._attachments||{}),Z=0;Z<W.length;Z++){var U=R._attachments[W[Z]];X(U.digest,S.seq)}}var ae=[];if(Object.keys(V).forEach(function(ar){var ao=V[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return P()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+jT+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+jT+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(c7,[],function(J){J.executeSql(jS,[],H)})})}function x(F,E){var G="ALTER TABLE "+b0+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+bD+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+bD+" SET max_seq=(SELECT MAX(seq) FROM "+cK+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+bD+" (max_seq)";J.executeSql(K,[],E)})})}function B(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;s=2===H.length?"UTF-8":"UTF-16",E()})}function D(){for(;q.length>0;){var E=q.pop();E(null,h)}}function y(K,G){if(0===G){var P="CREATE TABLE IF NOT EXISTS "+dL+" (dbid, db_version INTEGER)",M="CREATE TABLE IF NOT EXISTS "+b0+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",J="CREATE TABLE IF NOT EXISTS "+jT+" (digest, seq INTEGER)",H="CREATE TABLE IF NOT EXISTS "+bD+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",I="CREATE TABLE IF NOT EXISTS "+cK+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",O="CREATE TABLE IF NOT EXISTS "+aF+" (id UNIQUE, rev, json)";K.executeSql(M),K.executeSql(O),K.executeSql(J,[],function(){K.executeSql(jS),K.executeSql(c7)}),K.executeSql(H,[],function(){K.executeSql(cQ),K.executeSql(I,[],function(){K.executeSql(dW),K.executeSql(ej),K.executeSql(P,[],function(){var R="INSERT INTO "+dL+" (db_version, dbid) VALUES (?,?)";h=dC();var Q=[ak,h];K.executeSql(R,Q,function(){D()})})})})}else{var E=function(){var Q=ak>G;Q&&K.executeSql("UPDATE "+dL+" SET db_version = "+ak);var R="SELECT dbid FROM "+dL;K.executeSql(R,[],function(T,S){h=S.rows.item(0).dbid,D()})},N=[k,p,o,w,x,r,E],L=G,F=function(Q){N[L-1](Q,F),L++};F(K)}}function n(){z.transaction(function(E){B(E,function(){A(E)})},az(j),i)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+dL;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+dL,[],function(J,I){var K=I.rows.item(0).db_version;y(J,K)}):H.executeSql("ALTER TABLE "+dL+" ADD COLUMN db_version INTEGER",[],function(){y(H,1)}):y(H,0)})}function g(F,E){if(-1!==C._docCount){return E(C._docCount)}var G=aW("COUNT("+bD+".id) AS 'num'",[bD,cK],aH,cK+".deleted=0");F.executeSql(G,[],function(I,H){C._docCount=H.rows.item(0).num,E(C._docCount)})}var s,C=this,h=null,m=dX(v),q=[];C._docCount=-1,C._name=v.name;var u=jH.extend({},v,{version:kf,description:v.name,size:m}),l=dx(u);if(l.error){return az(j)(l.error)}var z=l.db;"function"!=typeof z.readTransaction&&(z.readTransaction=z.transaction),n(),C.type=function(){return"websql"},C._id=ed(function(E){E(null,h)}),C._info=function(E){z.readTransaction(function(F){g(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+cK;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:z._sqlitePlugin,websql_encoding:s})})})},az(E))},C._bulkDocs=function(E,G,F){aM(v,E,G,C,z,a9,F)},C._get=function(J,K,H){function E(){H(M,{doc:F,metadata:I,ctx:G})}var F,I,M,G=K.ctx;if(!G){return z.readTransaction(function(O){C._get(J,jH.extend({ctx:O},K),H)})}var N,L;K.rev?(N=aW(cN,[bD,cK],bD+".id="+cK+".doc_id",[cK+".doc_id=?",cK+".rev=?"]),L=[J,K.rev]):(N=aW(cN,[bD,cK],aH,bD+".id=?"),L=[J]),G.executeSql(N,L,function(O,P){if(!P.rows.length){return M=ds(dJ,"missing"),E()}var Q=P.rows.item(0);return I=b8(Q.metadata),Q.deleted&&!K.rev?(M=ds(dJ,"deleted"),E()):(F=bY(Q.data,I.id,Q.rev),void E())})},C._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(bD+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(bD+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(bD+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(bD+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(cK+".deleted = 0"),z.readTransaction(function(S){g(S,function(U){if(P=U,0!==N){var T=aW(cN,[bD,cK],aH,J,bD+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(W,Z){for(var Y=0,ao=Z.rows.length;ao>Y;Y++){var V=Z.rows.item(Y),X=b8(V.metadata),an=X.id,ar=bY(V.data,an,V.rev),ai=ar._rev,ae={id:an,key:an,value:{rev:ai}};if(E.include_docs&&(ae.doc=ar,ae.doc._rev=ai,E.conflicts&&(ae.doc._conflicts=bP(X)),cX(ae.doc,E,C,W)),V.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},az(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},C._changes=function(K){function L(){var S=bD+".json AS metadata, "+bD+".max_seq AS maxSeq, "+cK+".json AS winningDoc, "+cK+".rev AS winningRev ",T=bD+" JOIN "+cK,R=bD+".id="+cK+".doc_id AND "+bD+".winningseq="+cK+".seq",Q=["maxSeq > ?"],O=[K.since];K.doc_ids&&(Q.push(bD+".id IN "+bg(K.doc_ids.length)),O=O.concat(K.doc_ids));var U="maxSeq "+(H?"DESC":"ASC"),N=aW(S,T,R,Q,U),M=dk(K);K.view||K.filter||(N+=" LIMIT "+E);var P=K.since||0;z.readTransaction(function(V){V.executeSql(N,O,function(Y,Z){function X(a0){return function(){K.onChange(a0)}}for(var ao=0,an=Z.rows.length;an>ao;ao++){var ai=Z.rows.item(ao),W=b8(ai.metadata);P=ai.maxSeq;var ae=bY(ai.winningDoc,W.id,ai.winningRev),at=K.processChange(ae,W,K);at.seq=ai.maxSeq;var ar=M(at);if("object"==typeof ar){return K.complete(ar)}if(ar&&(G++,J&&I.push(at),K.attachments&&K.include_docs?cX(ae,K,C,Y,X(at)):X(at)()),G===E){break}}})},az(K.complete),function(){K.continuous||K.complete(null,{results:I,last_seq:P})})}if(K=e0(K),K.continuous){var F=C._name+":"+dC();return a9.addListener(C._name,F,C,K),a9.notify(C._name),{cancel:function(){a9.removeListener(C._name,F)}}}var H=K.descending;K.since=K.since&&!H?K.since:0;var E="limit" in K?K.limit:-1;0===E&&(E=1);var J;J="return_docs" in K?K.return_docs:"returnDocs" in K?K.returnDocs:!0;var I=[],G=0;L()},C._close=function(E){E()},C._getAttachment=function(J,K,H,E,F){var I,M=E.ctx,G=H.digest,N=H.content_type,L="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+b0+" WHERE digest=?";M.executeSql(L,[G],function(P,O){var Q=O.rows.item(0),R=Q.escaped?bf(Q.body):aw(Q.body,s);I=E.binary?bJ(R,N):cA(R),F(null,I)})},C._getRevisionTree=function(F,E){z.readTransaction(function(H){var G="SELECT json AS metadata FROM "+bD+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=b8(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(ds(dJ))}})})},C._doCompaction=function(F,E,G){return E.length?void z.transaction(function(H){var I="SELECT json AS metadata FROM "+bD+" WHERE id = ?";H.executeSql(I,[F],function(J,L){var M=b8(L.rows.item(0).metadata);aD(M.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var K="UPDATE "+bD+" SET json = ? WHERE id = ?";J.executeSql(K,[j8(M),F])}),aS(E,F,H)},az(G),function(){G()}):G()},C._getLocal=function(F,E){z.readTransaction(function(H){var G="SELECT json, rev FROM "+aF+" WHERE id=?";H.executeSql(G,[F],function(J,L){if(L.rows.length){var I=L.rows.item(0),K=bY(I.json,F,I.rev);E(null,K)}else{E(ds(dJ))}})})},C._putLocal=function(M,H,K){function I(N){var P,O;L?(P="UPDATE "+aF+" SET rev=?, json=? WHERE id=? AND rev=?",O=[J,G,F,L]):(P="INSERT INTO "+aF+" (id, rev, json) VALUES (?,?,?)",O=[F,J,G]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(E={ok:!0,id:F,rev:J},H.ctx&&K(null,E)):K(ds(aZ))},function(){return K(ds(aZ)),!1})}"function"==typeof H&&(K=H,H={}),delete M._revisions;var J,L=M._rev,F=M._id;J=L?M._rev="0-"+(parseInt(L.split("-")[1],10)+1):M._rev="0-1";var E,G=b5(M);H.ctx?I(H.ctx):z.transaction(I,az(K),function(){E&&K(null,E)})},C._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+aF+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(ds(dJ))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):z.transaction(G,az(E),function(){I&&E(null,I)})},C._destroy=function(F,E){a9.removeAllListeners(C._name),z.transaction(function(H){var G=[bD,cK,b0,dL,aF,jT];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},az(E),function(){e4()&&(delete window.localStorage["_pouch__websqldb_"+C._name],delete window.localStorage[C._name]),E(null,{ok:!0})})}}function dR(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cj(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=e4(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=dR();return h&&(localStorage[g]=i?"1":"0"),i}function ki(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cj()}function fM(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=jH.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function fP(g,i){var h=fM(g),j=jH.extend({websql:h},g);eI.call(this,j,i)}function kg(g){g.adapter("websql",fP,!0)}function af(){for(var g={},i=new aK(function(k,l){g.resolve=k,g.reject=l}),h=new Array(arguments.length),j=0;j<h.length;j++){h[j]=arguments[j]}return g.promise=i,aK.resolve().then(function(){return fetch.apply(null,h)}).then(function(k){g.resolve(k)})["catch"](function(k){g.reject(k)}),g}function fJ(j,m){var g,i,k,l=new Headers,h={method:j.method,credentials:"include",headers:l};return j.json&&(l.set("Accept","application/json"),l.set("Content-Type",j.headers["Content-Type"]||"application/json")),j.body&&j.body instanceof Blob?aB(j.body,function(n){h.body=n}):j.body&&j.processData&&"string"!=typeof j.body?h.body=JSON.stringify(j.body):"body" in j?h.body=j.body:h.body=null,Object.keys(j.headers).forEach(function(n){j.headers.hasOwnProperty(n)&&l.set(n,j.headers[n])}),g=af(j.url,h),j.timeout>0&&(i=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+j.url))},j.timeout)),g.promise.then(function(n){return k={statusCode:n.status},j.timeout>0&&clearTimeout(i),k.statusCode>=200&&k.statusCode<300?j.binary?n.blob():n.text():n.json()}).then(function(n){k.statusCode>=200&&k.statusCode<300?m(null,k,n):m(n,k)})["catch"](function(n){m(n,k)}),{abort:g.reject}}function ad(l,g){var j,h,k=!1,m=function(){j.abort()},n=function(){k=!0,j.abort()};j=l.xhr?new l.xhr:new XMLHttpRequest;try{j.open(l.method,l.url)}catch(i){g(i,{statusCode:413})}j.withCredentials="withCredentials" in l?l.withCredentials:!0,"GET"===l.method?delete l.headers["Content-Type"]:l.json&&(l.headers.Accept="application/json",l.headers["Content-Type"]=l.headers["Content-Type"]||"application/json",l.body&&l.processData&&"string"!=typeof l.body&&(l.body=JSON.stringify(l.body))),l.binary&&(j.responseType="arraybuffer"),"body" in l||(l.body=null);for(var o in l.headers){l.headers.hasOwnProperty(o)&&j.setRequestHeader(o,l.headers[o])}return l.timeout>0&&(h=setTimeout(n,l.timeout),j.onprogress=function(){clearTimeout(h),4!==j.readyState&&(h=setTimeout(n,l.timeout))},"undefined"!=typeof j.upload&&(j.upload.onprogress=j.onprogress)),j.onreadystatechange=function(){if(4===j.readyState){var s={statusCode:j.status};if(j.status>=200&&j.status<300){var q;q=l.binary?cU([j.response||""],{type:j.getResponseHeader("Content-Type")}):j.responseText,g(null,s,q)}else{var p={};if(k){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(j.response)}catch(r){}}g(p,s)}}},l.body&&l.body instanceof Blob?aB(l.body,function(p){j.send(p)}):j.send(l.body),{abort:m}}function c4(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function e8(h,g){return fF||h.xhr?ad(h,g):fJ(h,g)}function eb(){return""}function jJ(g,j){function i(n,m,o){if(!g.binary&&g.json&&"string"==typeof n){try{n=JSON.parse(n)}catch(l){return o(l)}}Array.isArray(n)&&(n=n.map(function(p){return p.error||p.missing?e(p):p})),g.binary&&d7(n,m),o(null,n,m)}function k(o,m){var q,n;if(o.code&&o.status){var p=new Error(o.message||o.code);return p.status=o.status,m(p)}if(o.message&&"ETIMEDOUT"===o.message){return m(o)}try{q=JSON.parse(o.responseText),n=e(q)}catch(l){n=e(o)}m(n)}g=e0(g);var h={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return g=jH.extend(h,g),g.json&&(g.binary||(g.headers.Accept="application/json"),g.headers["Content-Type"]=g.headers["Content-Type"]||"application/json"),g.binary&&(g.encoding=null,g.json=!1),g.processData||(g.json=!1),e8(g,function(n,r,p){if(n){return n.status=r?r.statusCode:400,k(n,j)}var l,q=r.headers&&r.headers["content-type"],o=p||eb();if(!g.binary&&(g.json||!g.processData)&&"object"!=typeof o&&(/json/.test(q)||/^[\s]*\{/.test(o)&&/\}[\s]*$/.test(o))){try{o=JSON.parse(o.toString())}catch(m){}}r.statusCode>=200&&r.statusCode<300?i(o,r,j):(l=e(o),l.status=r.statusCode,j(l))})}function eL(g,i){var m=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",k=-1!==m.indexOf("safari")&&-1===m.indexOf("chrome"),l=-1!==m.indexOf("msie"),o=-1!==m.indexOf("edge"),h=k||(l||o)&&"GET"===g.method,j="cache" in g?g.cache:!0,p=/^blob:/.test(g.url);if(!p&&(h||!j)){var n=-1!==g.url.indexOf("?");g.url+=(n?"&":"?")+"_nonce="+Date.now()}return jJ(g,i)}function eV(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=aQ(j.data,j.content_type)})}function cE(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function bI(g){return g._attachments&&Object.keys(g._attachments)?aK.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new aK(function(j){jW(i.data,j)}).then(function(j){i.data=j}):void 0})):aK.resolve()}function dA(h){var g=aE(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function dI(h,g){return jZ(h,h.db+"/"+g)}function jZ(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function bC(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function ep(m,o){function p(A,y,B){var z=A.ajax||{},x=jH.extend(e0(l),z,y);return f2(x.method+" "+x.url),w._ajax(x,B)}function k(x,y){return new aK(function(z,A){p(x,y,function(C,B){return C?A(C):void z(B)})})}function j(x,y){return cI(x,b9(function(z){v().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(m.skipSetup||m.skip_setup){return aK.resolve()}if(n){return n}var x={method:"GET",url:i};return n=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(av(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:i})):aK.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:aK.reject(y)}),n["catch"](function(){n=null}),n}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,h=dA;m.getHost&&(h=m.getHost);var r=h(m.name,m),i=dI(r,"");m=e0(m);var l=m.ajax||{};if(w.getUrl=function(){return i},w.getHeaders=function(){return l.headers||{}},m.auth||r.auth){var u=m.auth||r.auth,s=u.username+":"+u.password,g=cA(unescape(encodeURIComponent(s)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var n;setTimeout(function(){o(null,w)}),w.type=function(){return"http"},w.id=j("id",function(x){p({},{method:"GET",url:jZ(r,"")},function(y,A){var z=A&&A.uuid?A.uuid+r.db:dI(r,"");x(null,z)})}),w.request=j("request",function(x,y){x.url=dI(r,x.url),p({},x,y)}),w.compact=j("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=e0(x),p(x,{url:dI(r,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),w.bulkGet=cI("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:dI(r,"_bulk_get"+bC(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function E(L){return function(M,N){H[L]=N.results,++F===J&&C(null,{results:fE(H)})}}for(var I=aN,J=Math.ceil(y.docs.length/I),F=0,H=new Array(J),G=0;J>G;G++){var K=dg(y,["revs","attachments"]);K.ajax=l,K.docs=y.docs.slice(G*I,Math.min(y.docs.length,(G+1)*I)),eB(D,K,E(G))}}var D=this,x=jZ(r,""),z=ab[x];"boolean"!=typeof z?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(ab[x]=!1,av(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{ab[x]=!0,C(null,F)}}):z?A(C):B()}),w._info=function(x){v().then(function(){p({},{method:"GET",url:dI(r,"")},function(y,z){return y?x(y):(z.host=dI(r,""),void x(null,z))})})["catch"](x)},w.get=j("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?aK.all(E.map(function(J){var H=G[J],I=cE(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:dI(r,I),binary:!0}).then(function(K){return y.binary?K:new aK(function(L){jW(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?aK.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=e0(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=cE(C);var x={method:"GET",url:dI(r,C+bC(z))};k(y,x).then(function(E){return aK.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),w.remove=j("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:dI(r,cE(C._id))+"?rev="+y},A)}),w.getAttachment=j("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=dI(r,cE(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=j("removeAttachment",function(A,y,z,B){var x=dI(r,cE(A)+"/"+q(y))+"?rev="+z;p({},{method:"DELETE",url:x},B)}),w.putAttachment=j("putAttachment",function(D,H,y,z,B,x){"function"==typeof B&&(x=B,B=z,z=y,y=null);var G=cE(D)+"/"+q(H),F=dI(r,G);if(y&&(F+="?rev="+y),"string"==typeof z){var A;try{A=jR(z)}catch(E){return x(ds(bw,"Attachment is not a valid base64 string"))}z=A?bJ(A,B):""}var C={headers:{"Content-Type":B},method:"PUT",url:F,processData:!1,body:z,timeout:l.timeout||60000};p({},C,x)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,v().then(function(){return aK.all(x.docs.map(bI))}).then(function(){p(y,{method:"POST",url:dI(r,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=j("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=e0(C);var A,B={},D="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var x=bC(B);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=ag?x+="&"+z:(D="POST",A={keys:C.keys})}k(C,{method:D,url:dI(r,"_all_docs"+x),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:f4;H=e0(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var F in H.query_params){H.query_params.hasOwnProperty(F)&&(D[F]=H.query_params[F])}}var y,I="GET";if(H.doc_ids){D.filter="_doc_ids";var G=JSON.stringify(H.doc_ids);G.length<ag?D.doc_ids=G:(I="POST",y={doc_ids:H.doc_ids})}var E,C,z=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:I,url:dI(r,"_changes"+bC(D)),timeout:H.timeout,body:y};C=N,H.aborted||v().then(function(){E=p(H,O,M)})["catch"](M)}},K={results:[]},x=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,K.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=dk(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&K.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(C=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,K):setTimeout(function(){z(C,x)},0)}};return z(H.since||0,x),{cancel:function(){H.aborted=!0,E&&E.abort()}}},w.revsDiff=j("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:dI(r,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(x,y){p(x,{url:dI(r,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function ef(g){g.adapter("http",ep,!1),g.adapter("https",ep,!1)}function eN(){this.promise=new aK(function(g){g()})}function eD(l){var n=l.db,i=l.viewName,g=l.map,h=l.reduce,m=l.temporary,k=g.toString()+(h&&h.toString())+"undefined";if(!m&&n._cachedViews){var j=n._cachedViews[k];if(j){return aK.resolve(j)}}return n.info().then(function(p){function o(u){u.views=u.views||{};var r=i;-1===r.indexOf("/")&&(r=i+"/"+i);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(m?"temp":dv(k));return bl(n,"_local/mrviews",o).then(function(){return n.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:n,adapter:n.adapter,mapFun:g,reduceFun:h};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,m||(n._cachedViews=n._cachedViews||{},n._cachedViews[k]=r,r.db.once("destroyed",function(){delete n._cachedViews[k]})),r})})})})}function jU(h,k,j,l,i,g){return e9("return ("+h.replace(/;\s*$/,"")+");",{emit:k,sum:j,log:l,isArray:i,toJSON:g})}function e2(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function eS(g){return 1===g.length&&/^1-/.test(g[0].rev)}function eZ(h,g){try{h.emit("error",g)}catch(i){aL("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),aL("error",g)}}function bb(g,i,h){try{return{output:i.apply(null,h)}}catch(j){return eZ(g,j),{error:j}}}function dD(h,g){var i=bQ.collate(h.key,g.key);return 0!==i?i:bQ.collate(h.value,g.value)}function kj(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function bK(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function dh(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=aQ(k.data,k.content_type)})})}function aC(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&dh(h),h}}function cq(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new c8(g)}function cb(l){for(var n=0,i=0,g=l.length;g>i;i++){var h=l[i];if("number"!=typeof h){if(!Array.isArray(h)){throw cq("_sum")}n="number"==typeof n?[n]:n;for(var m=0,k=h.length;k>m;m++){var j=h[m];if("number"!=typeof j){throw cq("_sum")}"undefined"==typeof n[m]?n.push(j):n[m]+=j}}else{"number"==typeof n?n+=h:n[0]+=h}}return n}function bv(g,j,i,k){var h=j[g];"undefined"!=typeof h&&(k&&(h=encodeURIComponent(JSON.stringify(h))),i.push(g+"="+h))}function em(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function bi(g){return g.group_level=em(g.group_level),g.limit=em(g.limit),g.skip=em(g.skip),g}function f9(g){if(g){if("number"!=typeof g){return new kb('Invalid value for integer: "'+g+'"')}if(0>g){return new kb('Invalid value for positive integer: "'+g+'"')}}}function cc(g,i){var h=g.descending?"endkey":"startkey",j=g.descending?"startkey":"endkey";if("undefined"!=typeof g[h]&&"undefined"!=typeof g[j]&&bQ.collate(g[h],g[j])>0){throw new kb("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(i.reduce&&g.reduce!==!1){if(g.include_docs){throw new kb("{include_docs:true} is invalid for reduce")}if(g.keys&&g.keys.length>1&&!g.group&&!g.group_level){throw new kb("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=f9(g[k]);if(l){throw l}})}function cF(l,g,j){var h,k=[],m="GET";if(bv("reduce",j,k),bv("include_docs",j,k),bv("attachments",j,k),bv("limit",j,k),bv("descending",j,k),bv("group",j,k),bv("group_level",j,k),bv("skip",j,k),bv("stale",j,k),bv("conflicts",j,k),bv("startkey",j,k,!0),bv("start_key",j,k,!0),bv("endkey",j,k,!0),bv("end_key",j,k,!0),bv("inclusive_end",j,k),bv("key",j,k,!0),k=k.join("&"),k=""===k?"":"?"+k,"undefined"!=typeof j.keys){var n=2000,i="keys="+encodeURIComponent(JSON.stringify(j.keys));i.length+k.length+1<=n?k+=("?"===k[0]?"&":"?")+i:(m="POST","string"==typeof g?h={keys:j.keys}:g.keys=j.keys)}if("string"==typeof g){var o=e2(g);return l.request({method:m,url:"_design/"+o[0]+"/_view/"+o[1]+k,body:h}).then(aC(j))}return h=h||{},Object.keys(g).forEach(function(p){Array.isArray(g[p])?h[p]=g[p]:h[p]=g[p].toString()}),l.request({method:"POST",url:"_temp_view"+k,body:h}).then(aC(j))}function aX(h,g,i){return new aK(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function dS(g){return new aK(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function j3(g){return function(h){if(404===h.status){return g}throw h}}function km(m,h,l){function j(){return eS(q)?aK.resolve(g):h.db.get(n)["catch"](j3(g))}function i(r){return r.keys.length?h.db.allDocs({keys:r.keys,include_docs:!0}):aK.resolve({rows:[]})}function k(A,r){for(var w=[],v={},x=0,y=r.rows.length;y>x;x++){var B=r.rows[x],u=B.doc;if(u&&(w.push(u),v[u._id]=!0,u._deleted=!o[u._id],!u._deleted)){var s=o[u._id];"value" in s&&(u.value=s.value)}}var z=Object.keys(o);return z.forEach(function(C){if(!v[C]){var E={_id:C},D=o[C];"value" in D&&(E.value=D.value),w.push(E)}}),A.keys=fA(z.concat(A.keys)),w.push(A),w}var n="_local/doc_"+m,g={_id:n,keys:[]},p=l[m],o=p.indexableKeysToKeyValues,q=p.changes;return j().then(function(r){return i(r).then(function(s){return k(r,s)})})}function j2(g,i,h){var j="_local/lastSeq";return g.db.get(j)["catch"](j3({_id:j,seq:0})).then(function(k){var l=Object.keys(i);return aK.all(l.map(function(m){return km(m,g,i)})).then(function(m){var n=fE(m);return k.seq=h,n.push(k),g.db.bulkDocs({docs:n})})})}function eT(h){var g="string"==typeof h?h:h.name,i=ke[g];return i||(i=ke[g]=new eN),i}function cC(g){return j5(eT(g),function(){return eq(g)})()}function eq(l){function g(p,r){var q={id:k._id,key:bQ.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=bQ.normalizeKey(r)),h.push(q)}function j(q,p){return function(){return j2(l,q,p)}}var h,k,m;if("function"==typeof l.mapFun&&2===l.mapFun.length){var n=l.mapFun;m=function(p){return n(p,g)}}else{m=jU(l.mapFun.toString(),g,cb,dp,Array.isArray,JSON.parse)}var i=l.seq||0,o=new eN;return new aK(function(p,s){function r(){o.finish().then(function(){l.seq=i,p()})}function q(){function u(v){s(v)}l.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:i,limit:bN}).on("complete",function(v){var C=v.results;if(!C.length){return r()}for(var H={},A=0,x=C.length;x>A;A++){var F=C[A];if("_"!==F.doc._id[0]){h=[],k=F.doc,k._deleted||bb(l.sourceDB,m,[k]),h.sort(dD);for(var E,z={},D=0,w=h.length;w>D;D++){var y=h[D],B=[y.key,y.id];0===bQ.collate(y.key,E)&&B.push(D);var G=bQ.toIndexableString(B);z[G]=y,E=y.key}H[F.doc._id]={indexableKeysToKeyValues:z,changes:F.changes}}i=F.seq}return o.add(j(H,i)),C.length<bN?r():q()}).on("error",u)}q()})}function fQ(m,h,l){0===l.group_level&&delete l.group_level;var j,i=l.group||l.group_level;j=bj[m.reduceFun]?bj[m.reduceFun]:jU(m.reduceFun.toString(),null,cb,dp,Array.isArray,JSON.parse);var k=[],n=isNaN(l.group_level)?Number.POSITIVE_INFINITY:l.group_level;h.forEach(function(r){var u=k[k.length-1],s=i?r.key:null;return i&&Array.isArray(s)&&(s=s.slice(0,n)),u&&0===bQ.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void k.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),h=[];for(var g=0,p=k.length;p>g;g++){var o=k[g],q=bb(m.sourceDB,j,[o.keys,o.values,!1]);if(q.error&&q.error instanceof c8){throw q.error}h.push({value:q.error?null:q.output,key:o.groupKey})}return{rows:kj(h,l.limit,l.skip)}}function jP(h,g){return j5(eT(h),function(){return ah(h,g)})()}function ah(r,j){function m(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return l=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=bQ.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function k(u){var w;if(w=o?fQ(r,u,j):{total_rows:l,offset:h,rows:u},j.include_docs){var v=fA(u.map(bK));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:j.conflicts,attachments:j.attachments,binary:j.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),u.forEach(function(A){var B=bK(A),z=y["$"+B];z&&(A.doc=z)}),w})}return w}var l,o=r.reduceFun&&j.reduce!==!1,h=j.skip||0;if("undefined"==typeof j.keys||j.keys.length||(j.limit=0,delete j.keys),"undefined"!=typeof j.keys){var p=j.keys,i=p.map(function(v){var u={startkey:bQ.toIndexableString([v]),endkey:bQ.toIndexableString([v,{}])};return m(u)});return aK.all(i).then(fE).then(k)}var g={descending:j.descending};if(j.start_key&&(j.startkey=j.start_key),j.end_key&&(j.endkey=j.end_key),"undefined"!=typeof j.startkey&&(g.startkey=j.descending?bQ.toIndexableString([j.startkey,{}]):bQ.toIndexableString([j.startkey])),"undefined"!=typeof j.endkey){var q=j.inclusive_end!==!1;j.descending&&(q=!q),g.endkey=bQ.toIndexableString(q?[j.endkey,{}]:[j.endkey])}if("undefined"!=typeof j.key){var n=bQ.toIndexableString([j.key]),s=bQ.toIndexableString([j.key,{}]);g.descending?(g.endkey=n,g.startkey=s):(g.startkey=n,g.endkey=s)}return o||("number"==typeof j.limit&&(g.limit=j.limit),g.skip=h),m(g).then(k)}function ac(g){return g.request({method:"POST",url:"_view_cleanup"})}function bO(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(k){var m=e2(k),n="_design/"+m[0],l=m[1];j[n]=j[n]||{},j[n][l]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(k){var l={};k.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){l[v]=l[v]||s})})});var n=Object.keys(l).filter(function(o){return !l[o]}),m=n.map(function(o){return j5(eT(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return aK.all(m).then(function(){return{ok:!0}})})},j3({ok:!0}))}function eJ(h,j,l){if("http"===h.type()){return cF(h,j,l)}if("function"==typeof h._query){return aX(h,j,l)}if("string"!=typeof j){cc(l,j);var i={db:h,viewName:"temp_view/temp_view",map:j.map,reduce:j.reduce,temporary:!0};return b3.add(function(){return eD(i).then(function(o){function p(){return o.db.destroy()}return cg(cC(o).then(function(){return jP(o,l)}),p)})}),b3.finish()}var n=j,k=e2(n),g=k[0],m=k[1];return h.get("_design/"+g).then(function(o){var p=o.views&&o.views[m];if(!p||"string"!=typeof p.map){throw new dq("ddoc "+g+" has no view named "+m)}cc(l,p);var q={db:h,viewName:n,map:p.map,reduce:p.reduce};return eD(q).then(function(r){return"ok"===l.stale||"update_after"===l.stale?("update_after"===l.stale&&du.nextTick(function(){cC(r)}),jP(r,l)):cC(r).then(function(){return jP(r,l)})})})}function kb(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,kb)}catch(g){}}function dq(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,dq)}catch(g){}}function c8(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,c8)}catch(g){}}function fR(g){return/^1-/.test(g)}function d0(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function cl(h,g){var i=Object.keys(g._attachments);return aK.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function d5(g,j,i){var k="http"===j.type()&&"http"!==g.type(),h=Object.keys(i._attachments);return k?g.get(i._id).then(function(l){return aK.all(h.map(function(m){return d0(l,i,m)?j.getAttachment(i._id,m):g.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return cl(j,i)}):cl(j,i)}function au(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function ec(l,g,k,i){function j(){var r=au(k);if(r.docs.length){return l.bulkGet(r).then(function(s){if(i.cancelled){throw new Error("cancelled")}return aK.all(s.results.map(function(u){return aK.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?d5(g,l,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){o=o.concat(fE(u).filter(Boolean))})})}}function m(r){return r._attachments&&Object.keys(r._attachments).length>0}function n(r){return l.allDocs({keys:r,include_docs:!0}).then(function(s){if(i.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&fR(u.value.rev)&&!m(u.doc)&&(o.push(u.doc),delete k[u.id])})})}function h(){var r=Object.keys(k).filter(function(s){var u=k[s].missing;return 1===u.length&&fR(u[0])});return r.length>0?n(r):void 0}function p(){return{ok:q,docs:o}}k=e0(k);var o=[],q=!0;return aK.resolve().then(h).then(j).then(p)}function dU(g,j,i,k,h){return g.get(j)["catch"](function(l){if(404===l.status){return"http"===g.type()&&av(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:k,_id:j,history:[],replicator:dK,version:jK}}throw l}).then(function(l){return h.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==k}),l.history.unshift({last_seq:i,session_id:k}),l.history=l.history.slice(0,d9),l.version=jK,l.replicator=dK,l.session_id=k,l.last_seq=i,g.put(l)["catch"](function(m){if(409===m.status){return dU(g,j,i,k,h)}throw m}))})}function j9(g,i,h,j){this.src=g,this.target=i,this.id=h,this.returnValue=j}function cY(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:dN(h.history,g.history)}function dN(l,n){var i=l[0],g=l.slice(1),h=n[0],m=n.slice(1);if(!i||0===n.length){return{last_seq:cT,history:[]}}var k=i.session_id;if(jI(k,n)){return{last_seq:i.last_seq,history:l}}var j=h.session_id;return jI(j,g)?{last_seq:h.last_seq,history:m}:dN(g,m)}function jI(g,i){var h=i[0],j=i.slice(1);return g&&0!==i.length?g===h.session_id?!0:jI(g,j):!1}function f6(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function fL(g,i,h,j){return g.retry===!1?(i.emit("error",h),void i.removeAllListeners()):("function"!=typeof g.back_off_function&&(g.back_off_function=d8),i.emit("requestError",h),"active"!==i.state&&"pending"!==i.state||(i.emit("paused",h),i.state="stopped",i.once("active",function(){g.current_back_off=bp})),g.current_back_off=g.current_back_off||bp,g.current_back_off=g.back_off_function(g.current_back_off),void setTimeout(j,g.current_back_off))}function kl(g){return Object.keys(g).sort(bQ.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function jX(j,m,g){var i=g.doc_ids?g.doc_ids.sort(bQ.collate):"",k=g.filter?g.filter.toString():"",l="",h="";return g.filter&&g.query_params&&(l=JSON.stringify(kl(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),aK.all([j.id(),m.id()]).then(function(n){var o=n[0]+n[1]+k+h+l+i;return new aK(function(p){aa(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function c6(M,j,w,q,v){function C(){return I?aK.resolve():jX(M,j,w).then(function(T){h=T,I=new j9(M,j,h,q)})}function p(){if(n=[],0!==K.docs.length){var T=K.docs;return j.bulkDocs({docs:T,new_edits:!1}).then(function(V){if(q.cancelled){throw u(),new Error("cancelled")}var X=[],U={};V.forEach(function(Z){Z.error&&(v.doc_write_failures++,X.push(Z),U[Z.id]=Z)}),L=L.concat(X),v.docs_written+=K.docs.length-X.length;var Y=X.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=U[Z._id];ae?q.emit("denied",e0(ae)):n.push(Z)}),Y.length>0){var W=new Error("bulkDocs error");throw W.other_errors=X,D("target.bulkDocs failed to write docs",W),new Error("bulkWrite partial failure")}},function(U){throw v.doc_write_failures+=T.length,U})}}function k(){if(K.error){throw new Error("There was a problem getting docs.")}v.last_seq=B=K.seq;var T=e0(v);return n.length&&(T.docs=n,q.emit("change",T)),F=!0,I.writeCheckpoint(K.seq,N).then(function(){if(F=!1,q.cancelled){throw u(),new Error("cancelled")}K=void 0,y()})["catch"](i)}function P(){var T={};return K.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),j.revsDiff(T).then(function(U){if(q.cancelled){throw u(),new Error("cancelled")}K.diffs=U})}function H(){return ec(M,j,K.diffs,q).then(function(T){K.error=!T.ok,T.docs.forEach(function(U){delete K.diffs[U._id],v.docs_read++,K.docs.push(U)})})}function z(){if(!q.cancelled&&!K){if(0===A.length){return void R(!0)}K=A.shift(),P().then(H).then(p).then(k).then(z)["catch"](function(T){D("batch processing terminated with error",T)})}}function R(T){return 0===s.changes.length?void (0!==A.length||K||((m&&x.live||o)&&(q.state="pending",q.emit("paused")),o&&u())):void ((T||o||s.changes.length>=Q)&&(A.push(s),s={seq:0,changes:[],docs:[]},"pending"!==q.state&&"stopped"!==q.state||(q.state="active",q.emit("active")),z()))}function D(U,T){G||(T.message||(T.message=U),v.ok=!1,v.status="aborting",v.errors.push(T),L=L.concat(T),A=[],s={seq:0,changes:[],docs:[]},u())}function u(){if(!(G||q.cancelled&&(v.status="cancelled",F))){v.status=v.status||"complete",v.end_time=new Date,v.last_seq=B,G=!0;var U=L.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=L.pop();L.length>0&&(T.other_errors=L),T.result=v,fL(w,q,T,function(){c6(M,j,w,q)})}else{v.errors=L,q.emit("complete",v),q.removeAllListeners()}}}function O(U){if(q.cancelled){return u()}var T=dk(w)(U);T&&(s.seq=U.seq,s.changes.push(U),R(0===A.length&&x.live))}function S(U){if(l=!1,q.cancelled){return u()}if(U.results.length>0){x.since=U.last_seq,y(),R(!0)}else{var T=function(){m?(x.live=!0,y()):o=!0,R(!0)};K||0!==U.results.length?T():(F=!0,I.writeCheckpoint(U.last_seq,N).then(function(){F=!1,v.last_seq=B=U.last_seq,T()})["catch"](i))}}function r(T){return l=!1,q.cancelled?u():void D("changes rejected",T)}function y(){function U(){T.cancel()}function V(){q.removeListener("cancel",U)}if(!l&&!o&&A.length<g){l=!0,q._changes&&(q.removeListener("cancel",q._abortChanges),q._changes.cancel()),q.once("cancel",U);var T=M.changes(x).on("change",O);T.then(V,V),T.then(S)["catch"](r),w.retry&&(q._changes=T,q._abortChanges=U)}}function E(){C().then(function(){return q.cancelled?void u():I.getCheckpoint().then(function(T){B=T,x={since:B,limit:Q,batch_size:Q,style:"all_docs",doc_ids:J,return_docs:!0},w.filter&&("string"!=typeof w.filter?x.include_docs=!0:x.filter=w.filter),"heartbeat" in w&&(x.heartbeat=w.heartbeat),"timeout" in w&&(x.timeout=w.timeout),w.query_params&&(x.query_params=w.query_params),w.view&&(x.view=w.view),y()})})["catch"](function(T){D("getCheckpoint rejected with ",T)})}function i(T){throw F=!1,D("writeCheckpoint completed with error",T),T}var K,h,I,A=[],s={seq:0,changes:[],docs:[]},F=!1,o=!1,G=!1,B=0,m=w.continuous||w.live||!1,Q=w.batch_size||100,g=w.batches_limit||10,l=!1,J=w.doc_ids,L=[],n=[],N=dC();v=v||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var x={};return q.ready(M,j),q.cancelled?void u():(q._addedListeners||(q.once("cancel",u),"function"==typeof w.complete&&(q.once("error",w.complete),q.once("complete",function(T){w.complete(null,T)})),q._addedListeners=!0),void ("undefined"==typeof w.since?E():C().then(function(){return F=!0,I.writeCheckpoint(w.since,N)}).then(function(){return F=!1,q.cancelled?void u():(B=w.since,void E())})["catch"](i)))}function bm(){dO.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new aK(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function jO(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function cz(j,m,g,i){if("function"==typeof g&&(i=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw ds(df,"`doc_ids` filter parameter is not a list.")}g.complete=i,g=e0(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var k=new bm(g),l=jO(j,g),h=jO(m,g);return c6(l,h,g,k),k}function da(g,i,h,j){return"function"==typeof h&&(j=h,h={}),"undefined"==typeof h&&(h={}),h=e0(h),h.PouchConstructor=h.PouchConstructor||this,g=jO(g,h),i=jO(i,h),new dc(g,i,h,j)}function dc(v,n,o,x){function m(z){s.emit("change",{direction:"pull",change:z})}function r(z){s.emit("change",{direction:"push",change:z})}function l(z){s.emit("denied",{direction:"push",doc:z})}function p(z){s.emit("denied",{direction:"pull",doc:z})}function i(){s.pushPaused=!0,s.pullPaused&&s.emit("paused")}function y(){s.pullPaused=!0,s.pushPaused&&s.emit("paused")}function u(){s.pushPaused=!1,s.pullPaused&&s.emit("active",{direction:"push"})}function q(){s.pullPaused=!1,s.pushPaused&&s.emit("active",{direction:"pull"})}function w(z){return function(D,B){var C="change"===D&&(B===m||B===r),F="denied"===D&&(B===p||B===l),A="paused"===D&&(B===y||B===i),E="active"===D&&(B===q||B===u);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&s.removeAllListeners(D))}}var s=this;this.canceled=!1;var k=o.push?jH.extend({},o,o.push):o,h=o.pull?jH.extend({},o,o.pull):o;this.push=cz(v,n,k),this.pull=cz(n,v,h),this.pushPaused=!0,this.pullPaused=!0;var g={};o.live&&(this.push.on("complete",s.pull.cancel.bind(s.pull)),this.pull.on("complete",s.push.cancel.bind(s.push))),this.on("newListener",function(z){"change"===z?(s.pull.on("change",m),s.push.on("change",r)):"denied"===z?(s.pull.on("denied",p),s.push.on("denied",l)):"active"===z?(s.pull.on("active",q),s.push.on("active",u)):"paused"===z&&(s.pull.on("paused",y),s.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(s.pull.removeListener("change",m),s.push.removeListener("change",r)):"denied"===z?(s.pull.removeListener("denied",p),s.push.removeListener("denied",l)):"active"===z?(s.pull.removeListener("active",q),s.push.removeListener("active",u)):"paused"===z&&(s.pull.removeListener("paused",y),s.push.removeListener("paused",i))}),this.pull.on("removeListener",w("pull")),this.push.on("removeListener",w("push"));var j=aK.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return s.emit("complete",z),x&&x(null,z),s.removeAllListeners(),z},function(z){if(s.cancel(),x?x(z):s.emit("error",z),s.removeAllListeners(),x){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function dm(g){g.replicate=cz,g.sync=da}var f7,jH=d(9),cf=fD(d(5)),b2=fD(d(8)),cL=fD(d(10)),cS=d(14),b9=fD(d(4)),dO=d(1),e9=fD(d(15)),eP=fD(d(16)),b6=fD(d(17)),bQ=d(12),aK="function"==typeof Promise?Promise:cL,ka=Function.prototype.toString,cJ=ka.call(Object),bW=cf("pouchdb:api"),ca=6;if(f0()){f7=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),f7=!!localStorage.getItem("_pouch_check_localstorage")}catch(c0){f7=!1}}b2(eX,dO.EventEmitter),eX.prototype.addListener=function(j,m,g,i){function k(){function n(){h=!1}if(l._listeners[m]){if(h){return void (h="waiting")}h=!0;var o=dg(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>i.since&&!i.cancelled&&(i.since=p.seq,i.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){k()},0),h=!1}).on("error",n)}}if(!this._listeners[m]){var l=this,h=!1;this._listeners[m]=k,this.on(j,k)}},eX.prototype.removeListener=function(h,g){g in this._listeners&&dO.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},eX.prototype.notifyLocalWindows=function(g){f0()?chrome.storage.local.set({dbName:g}):e4()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},eX.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},b2(bs,Error),bs.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var by=new bs({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),cx=new bs({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),dJ=new bs({status:404,error:"not_found",reason:"missing"}),aZ=new bs({status:409,error:"conflict",reason:"Document update conflict"}),bz=new bs({status:400,error:"invalid_id",reason:"_id field must contain a string"}),cs=new bs({status:412,error:"missing_id",reason:"_id is required for puts"}),fC=new bs({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),eQ=new bs({status:412,error:"precondition_failed",reason:"Database not open"}),eF=new bs({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),bw=new bs({status:500,error:"badarg",reason:"Some query argument is invalid"}),d4=new bs({status:400,error:"invalid_request",reason:"Request was invalid"}),ea=new bs({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),fI=new bs({status:500,error:"doc_validation",reason:"Bad special document member"}),df=new bs({status:400,error:"bad_request",reason:"Something wrong with the request"}),c2=new bs({status:400,error:"bad_request",reason:"Document must be a JSON object"}),eW=new bs({status:404,error:"not_found",reason:"Database not found"}),cu=new bs({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ba=new bs({status:500,error:"web_sql_went_bad",reason:"unknown"}),kd=new bs({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),d1=new bs({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),bA=new bs({status:400,error:"bad_request",reason:"Invalid rev format"}),dP=new bs({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),bF=new bs({status:412,error:"missing_stub"}),eH=new bs({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),dF=[by,cx,dJ,aZ,bz,cs,fC,eQ,eF,bw,d4,ea,fI,df,c2,eW,ba,kd,d1,bA,dP,bF,cu,eH],dV=function(g,i,h){var j=dF.filter(function(k){return k[g]===i});return h&&j.filter(function(k){return k.message===h})[0]||j[0]},fG=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],cG="queryKey",dw=/(?:^|&)([^&=]*)=?([^&]*)/g,fO=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f1="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b2(cm,dO.EventEmitter),cm.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},cm.prototype.doChanges=function(g){var j=this,i=g.complete;if(g=e0(g),"live" in g&&!("continuous" in g)&&(g.continuous=g.live),g.processChange=eE,"latest"===g.since&&(g.since="now"),g.since||(g.since=0),"now"===g.since){return void this.db.info().then(function(l){return j.isCancelled?void i(null,{status:"cancelled"}):(g.since=l.update_seq,void j.doChanges(g))},i)}if(g.continuous&&"now"!==g.since&&this.db.info().then(function(l){j.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),g.view&&!g.filter&&(g.filter="_view"),g.filter&&"string"==typeof g.filter&&("_view"===g.filter?g.view=kc(g.view):g.filter=kc(g.filter),"http"!==this.db.type()&&!g.doc_ids)){return this.filterChanges(g)}"descending" in g||(g.descending=!1),g.limit=0===g.limit?1:g.limit,g.complete=i;var k=this.db._changes(g);if(k&&"function"==typeof k.cancel){var h=j.cancel;j.cancel=b9(function(l){k.cancel(),h.apply(this,l)})}},cm.prototype.filterChanges=function(h){var k=this,j=h.complete;if("_view"===h.filter){if(!h.view||"string"!=typeof h.view){var l=ds(df,"`view` filter parameter not found or invalid.");return j(l)}var i=d2(h.view);this.db.get("_design/"+i[0],function(m,o){if(k.isCancelled){return j(null,{status:"cancelled"})}if(m){return j(e(m))}var n=o&&o.views&&o.views[i[1]]&&o.views[i[1]].map;return n?(h.filter=dH(n),void k.doChanges(h)):j(ds(dJ,o.views?"missing json key: "+i[1]:"missing json key: views"))})}else{var g=d2(h.filter);if(!g){return k.doChanges(h)}this.db.get("_design/"+g[0],function(n,o){if(k.isCancelled){return j(null,{status:"cancelled"})}if(n){return j(e(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(h.filter=fN(m),void k.doChanges(h)):j(ds(dJ,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},b2(bS,dO.EventEmitter),bS.prototype.post=cI("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(ds(c2)):void this.bulkDocs({docs:[h]},g,cd(i))}),bS.prototype.put=cI("put",b9(function(l){function g(){n||(aL("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),n=!0)}var j,h,k,m,n=!1,i=l.shift(),o="_id" in i;if("object"!=typeof i||Array.isArray(i)){return(m=l.pop())(ds(c2))}for(;;){if(j=l.shift(),h=typeof j,"string"!==h||o?"string"!==h||!o||"_rev" in i?"object"===h?k=j:"function"===h&&(m=j):(g(),i._rev=j):(g(),i._id=j,o=!0),!l.length){break}}return k=k||{},bc(i._id),jQ(i._id)&&"function"==typeof this._putLocal?i._deleted?this._removeLocal(i,m):this._putLocal(i,m):void this.bulkDocs({docs:[i]},k,cd(m))})),bS.prototype.putAttachment=cI("putAttachment",function(j,m,g,i,k){function l(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[m]={content_type:k,data:i,revpos:++n},h.put(o)}var h=this;return"function"==typeof k&&(k=i,i=g,g=null),"undefined"==typeof k&&(k=i,i=g,g=null),h.get(j).then(function(n){if(n._rev!==g){throw ds(aZ)}return l(n)},function(n){if(n.reason===dJ.message){return l({_id:j})}throw n})}),bS.prototype.removeAttachment=cI("removeAttachment",function(g,j,i,k){var h=this;h.get(g,function(m,l){return m?void k(m):l._rev!==i?void k(ds(aZ)):l._attachments?(delete l._attachments[j],0===Object.keys(l._attachments).length&&delete l._attachments,void h.put(l,k)):k()})}),bS.prototype.remove=cI("remove",function(h,k,j,l){var i;"string"==typeof k?(i={_id:h,_rev:k},"function"==typeof j&&(l=j,j={})):(i=h,"function"==typeof k?(l=k,j={}):(l=j,j=k)),j=j||{},j.was_delete=!0;var g={_id:i._id,_rev:i._rev||j.rev};return g._deleted=!0,jQ(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(i,l):void this.bulkDocs({docs:[g]},j,cd(l))}),bS.prototype.revsDiff=cI("revsDiff",function(l,n,i){function g(o,p){j.has(o)||j.set(o,{missing:[]}),j.get(o).missing.push(p)}function h(q,p){var o=l[q].slice(0);aD(p,function(w,v,s,x,r){var y=v+"-"+s,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==r.status&&g(q,y))}),o.forEach(function(r){g(q,r)})}"function"==typeof n&&(i=n,n={});var m=Object.keys(l);if(!m.length){return i(null,{})}var k=0,j=new cS.Map;m.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){j.set(o,{missing:l[o]})}else{if(q){return i(q)}h(o,p)}if(++k===m.length){var r={};return j.forEach(function(u,s){r[s]=u}),i(null,r)}})},this)}),bS.prototype.bulkGet=cI("bulkGet",function(h,g){eB(this,h,g)}),bS.prototype.compactDocument=cI("compactDocument",function(g,i,h){var j=this;this._getRevisionTree(g,function(m,k){if(m){return h(m)}var n=ek(k),l=[],o=[];Object.keys(n).forEach(function(p){n[p]>i&&l.push(p)}),aD(k,function(s,q,v,r,u){var p=q+"-"+v;"available"===u.status&&-1!==l.indexOf(p)&&o.push(p)}),j._doCompaction(g,o,h)})}),bS.prototype.compact=cI("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&dZ(i)}),bS.prototype._compact=function(j,m){function g(n){h.push(k.compactDocument(n.id,0))}function i(o){var n=o.last_seq;aK.all(h).then(function(){return bl(k,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){m(null,{ok:!0})})["catch"](m)}var k=this,l={return_docs:!1,last_seq:j.last_seq||0},h=[];k.changes(l).on("change",g).on("complete",i).on("error",m)},bS.prototype.get=cI("get",function(l,n,i){function g(){var o=[],p=h.length;return p?void h.forEach(function(q){m.get(l,{rev:q,revs:n.revs,attachments:n.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||i(null,o)})}):i(null,o)}if("function"==typeof n&&(i=n,n={}),"string"!=typeof l){return i(ds(bz))}if(jQ(l)&&"function"==typeof this._getLocal){return this._getLocal(l,i)}var h=[],m=this;if(!n.open_revs){return this._get(l,n,function(u,C){if(u){return i(u)}var y=C.doc,B=C.metadata,s=C.ctx;if(n.conflicts){var v=bP(B);v.length&&(y._conflicts=v)}if(aI(B,y._rev)&&(y._deleted=!0),n.revs||n.revs_info){var r=aP(B.rev_tree),A=kk(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(y._rev.split("-")[1])}),w=A.ids.map(function(D){return D.id}).indexOf(y._rev.split("-")[1])+1,o=A.ids.length-w;if(A.ids.splice(w,o),A.ids.reverse(),n.revs&&(y._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),n.revs_info){var p=A.pos+A.ids.length;y._revs_info=A.ids.map(function(D){return p--,{rev:p+"-"+D.id,status:D.opts.status}})}}if(n.attachments&&y._attachments){var q=y._attachments,x=Object.keys(q).length;if(0===x){return i(null,y)}Object.keys(q).forEach(function(D){this._getAttachment(y._id,D,q[D],{rev:y._rev,binary:n.binary,ctx:s},function(F,G){var E=y._attachments[D];E.data=G,delete E.stub,delete E.length,--x||i(null,y)})},m)}else{if(y._attachments){for(var z in y._attachments){y._attachments.hasOwnProperty(z)&&(y._attachments[z].stub=!0)}}i(null,y)}})}if("all"===n.open_revs){this._getRevisionTree(l,function(o,p){return o?i(o):(h=ap(p).map(function(q){return q.rev}),void g())})}else{if(!Array.isArray(n.open_revs)){return i(ds(eF,"function_clause"))}h=n.open_revs;for(var k=0;k<h.length;k++){var j=h[k];if("string"!=typeof j||!/^\d+-/.test(j)){return i(ds(bA))}}g()}}),bS.prototype.getAttachment=cI("getAttachment",function(g,j,i,k){var h=this;i instanceof Function&&(k=i,i={}),this._get(g,i,function(m,l){return m?k(m):l.doc._attachments&&l.doc._attachments[j]?(i.ctx=l.ctx,i.binary=!0,h._getAttachment(g,j,l.doc._attachments[j],i,k),void 0):k(ds(dJ))})}),bS.prototype.allDocs=cI("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(ds(ea,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return e1(this,h,g)}}return this._allDocs(h,g)}),bS.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new cm(this,h,g)},bS.prototype.close=cI("close",function(g){return this._closed=!0,this._close(g)}),bS.prototype.info=cI("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),bS.prototype.id=cI("id",function(g){return this._id(g)}),bS.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},bS.prototype.bulkDocs=cI("bulkDocs",function(g,j,i){if("function"==typeof j&&(i=j,j={}),j=j||{},Array.isArray(g)&&(g={docs:g}),!g||!g.docs||!Array.isArray(g.docs)){return i(ds(cx))}for(var k=0;k<g.docs.length;++k){if("object"!=typeof g.docs[k]||Array.isArray(g.docs[k])){return i(ds(c2))}}var h;return g.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){h=h||eR(m)})}),h?i(ds(df,h)):("new_edits" in j||("new_edits" in g?j.new_edits=g.new_edits:j.new_edits=!0),j.new_edits||"http"===this.type()||g.docs.sort(jF),f8(g.docs),this._bulkDocs(g,j,function(m,l){return m?i(m):(j.new_edits||(l=l.filter(function(n){return n.error})),void i(null,l))}))}),bS.prototype.registerDependentDatabase=cI("registerDependentDatabase",function(g,i){function h(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[g]?!1:(k.dependentDbs[g]=!0,k)}var j=new this.constructor(g,this.__opts);bl(this,"_local/_pouch_dependentDbs",h).then(function(){i(null,{db:j})})["catch"](i)}),bS.prototype.destroy=cI("destroy",function(g,j){function i(){k._destroy(g,function(l,m){return l?j(l):(k._destroyed=!0,k.emit("destroyed"),void j(null,m||{ok:!0}))})}"function"==typeof g&&(j=g,g={});var k=this,h="use_prefix" in k?k.use_prefix:!0;return"http"===k.type()?i():void k.get("_local/_pouch_dependentDbs",function(n,l){if(n){return 404!==n.status?j(n):i()}var o=l.dependentDbs,m=k.constructor,p=Object.keys(o).map(function(r){var q=h?r.replace(new RegExp("^"+m.prefix),""):r;return new m(q,k.__opts).destroy()});aK.all(p).then(i,j)})}),c3.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},c3.prototype.fail=function(g){this.failed=g,this.execute()},c3.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},c3.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},b2(c9,bS),c9.debug=cf,c9.adapters={},c9.preferredAdapters=[],c9.prefix="_pouch_";var bE=new dO.EventEmitter;dE(c9),c9.parseAdapter=function(l,n){var i,g,h=l.match(/([a-z\-]*):\/\/(.*)/);if(h){if(l=/http(s?)/.test(h[1])?h[1]+"://"+h[2]:h[2],i=h[1],!c9.adapters[i].valid()){throw"Invalid adapter"}return{name:l,adapter:h[1]}}var m="idb" in c9.adapters&&"websql" in c9.adapters&&e4()&&localStorage["_pouch__websqldb_"+c9.prefix+l];if(n.adapter){g=n.adapter}else{if("undefined"!=typeof n&&n.db){g="leveldb"}else{for(var k=0;k<c9.preferredAdapters.length;++k){if(g=c9.preferredAdapters[k],g in c9.adapters){if(m&&"idb"===g){aL("log",'PouchDB is downgrading "'+l+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}i=c9.adapters[g];var j=i&&"use_prefix" in i?i.use_prefix:!0;return{name:j?c9.prefix+l:l,adapter:g}},c9.adapter=function(h,g,i){g.valid()&&(c9.adapters[h]=g,i&&c9.preferredAdapters.push(h))},c9.plugin=function(g){return"function"==typeof g?g(c9):Object.keys(g).forEach(function(h){c9.prototype[h]=g[h]}),c9},c9.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=jH.extend({},h,i),void c9.call(this,k,i,j)):new g(k,i,j)}return b2(g,c9),g.preferredAdapters=c9.preferredAdapters.slice(),Object.keys(c9).forEach(function(i){i in g||(g[i]=c9[i])}),g};var kh="5.4.4";c9.version=kh;var d6,ck=dY(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cD=dY(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),jR=function(g){return atob(g)},cA=function(g){return btoa(g)},cM=bq.setImmediate||bq.setTimeout,bG=32768,e6=5,e7="document-store",dG="by-sequence",j6="attach-store",bL="attach-seq-store",a8="meta-store",cB="local-store",aJ="detect-blob-support",cW={running:!1,queue:[]},bX=new cS.Map,dQ=new eX,dl=new cS.Map;t.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ak=7,bD=c5("document-store"),cK=c5("by-sequence"),b0=c5("attach-store"),aF=c5("local-store"),dL=c5("metadata-store"),jT=c5("attach-seq-store"),cv=new cS.Map,a9=new eX,kf=1,dW="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+cK+" (seq, deleted)",ej="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+cK+" (doc_id, rev)",cQ="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+bD+" (winningseq)",jS="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+jT+" (seq)",c7="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+jT+" (digest, seq)",aH=cK+".seq = "+bD+".winningseq",cN=cK+".seq AS seq, "+cK+".deleted AS deleted, "+cK+".json AS data, "+cK+".rev AS rev, "+bD+".json AS metadata";fP.valid=ki,fP.use_prefix=!0;var fF=c4(),d7=function(){},f4=25,aN=50,ab={},ag=1800,f2=cf("pouchdb:http");ep.valid=function(){return !0},eN.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},eN.prototype.finish=function(){return this.promise};var dB=function(h,g){return g&&h.then(function(i){du.nextTick(function(){g(null,i)})},function(i){du.nextTick(function(){g(i)})}),h},jL=function(g){return b9(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&dB(i,j),i})},cg=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},j5=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},fA=function(h){for(var k={},j=0,l=h.length;l>j;j++){k["$"+h[j]]=!0}var i=Object.keys(k),g=new Array(i.length);for(j=0,l=i.length;l>j;j++){g[j]=i[j].substring(1)}return g},ke={},b3=new eN,bN=50,dp=aL.bind(null,"log"),bj={_sum:function(h,g){return cb(g)},_count:function(h,g){return g.length},_stats:function(h,g){function i(j){for(var m=0,l=0,n=j.length;n>l;l++){var k=j[l];m+=k*k}return m}return{sum:cb(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},bZ=jL(function(){var g=this;return"http"===g.type()?ac(g):"function"==typeof g._viewCleanup?dS(g):bO(g)}),bx=function(g,j,i){"function"==typeof j&&(i=j,j={}),j=j?bi(j):{},"function"==typeof g&&(g={map:g});var k=this,h=aK.resolve().then(function(){return eJ(k,g,j)});return dB(h,i),h};b2(kb,Error),b2(dq,Error),b2(c8,Error);var ax={query:bx,viewCleanup:bZ},jK=1,dK="pouchdb",d9=5,cT=0;j9.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},j9.prototype.updateTarget=function(h,g){return dU(this.target,this.id,h,g,this.returnValue)},j9.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?aK.resolve(!0):dU(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(f6(j)){return i.readOnlySource=!0,!0}throw j})};var b7={undefined:function(h,g){return 0===bQ.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return cY(g,h).last_seq}};j9.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?aK.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return cT}var j;return j=h.version?h.version.toString():"undefined",j in b7?b7[j](h,i):cT},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:cT}).then(function(){return cT},function(j){return f6(j)?(g.readOnlySource=!0,h.last_seq):cT})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return cT})};var bp=0;b2(bm,dO.EventEmitter),bm.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},bm.prototype.ready=function(g,j){function i(){h.cancel()}function k(){g.removeListener("destroyed",i),j.removeListener("destroyed",i)}var h=this;h._readyCalled||(h._readyCalled=!0,g.once("destroyed",i),j.once("destroyed",i),h.once("complete",k))},b2(dc,dO.EventEmitter),dc.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},c9.plugin(al).plugin(kg).plugin(ef).plugin(ax).plugin(dm),c.exports=c9}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var o="color: "+this.color;n=[n[0],o,"color: inherit"].concat(Array.prototype.slice.call(n,1));var p=0,i=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),n.splice(i,0,o),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(h,m,c){function q(){return c.colors[g++%c.colors.length]}function v(f){function n(){}function e(){var o=e,s=+new Date,r=s-(j||s);o.diff=r,o.prev=j,o.curr=s,j=s,null==o.useColors&&(o.useColors=c.useColors()),null==o.color&&o.useColors&&(o.color=q());var u=Array.prototype.slice.call(arguments);u[0]=c.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=c.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof c.formatArgs&&(u=c.formatArgs.apply(o,u));var x=e.log||c.log||console.log.bind(console);x.apply(o,u)}n.enabled=!1,e.enabled=!0;var i=c.enabled(f)?e:n;return i.namespace=f,i}function d(e){c.save(e);for(var f=(e||"").split(/[\s,]+/),n=f.length,i=0;n>i;i++){f[i]&&(e=f[i].replace(/\*/g,".*?"),"-"===e[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")))}}function k(){c.enable("")}function p(i){var e,f;for(e=0,f=c.skips.length;f>e;e++){if(c.skips[e].test(i)){return !1}}for(e=0,f=c.names.length;f>e;e++){if(c.names[e].test(i)){return !0}}return !1}function l(e){return e instanceof Error?e.stack||e.message:e}c=m.exports=v,c.coerce=l,c.disable=k,c.enable=d,c.enabled=p,c.humanize=h(11),c.names=[],c.skips=[],c.formatters={};var j,g=0},{11:11}],7:[function(d,c,f){(function(m){function g(){k=!0;for(var l,i,n=h.length;n;){for(i=h,h=[],l=-1;++l<n;){i[l]()}n=h.length}k=!1}function v(i){1!==h.push(i)||k||w()}var w,j=m.MutationObserver||m.WebKitMutationObserver;if(j){var p=0,t=new j(g),q=m.document.createTextNode("");t.observe(q,{characterData:!0}),w=function(){q.data=p=++p%2}}else{if(m.setImmediate||"undefined"==typeof m.MessageChannel){w="document" in m&&"onreadystatechange" in m.document.createElement("script")?function(){var i=m.document.createElement("script");i.onreadystatechange=function(){g(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},m.document.documentElement.appendChild(i)}:function(){setTimeout(g,0)}}else{var e=new m.MessageChannel;e.port1.onmessage=g,w=function(){e.port2.postMessage(0)}}}var k,h=[];c.exports=v}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(A,k,w){function B(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=I,this.queue=[],this.outcome=void 0,e!==B&&g(this,e)}function C(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function J(f,e,h){E(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function F(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(h,l){function f(o){e||(e=!0,d.reject(h,o))}function m(o){e||(e=!0,d.resolve(h,o))}function i(){l(m,f)}var e=!1,n=D(i);"error"===n.status&&f(n.value)}function D(e,h){var f={};try{f.value=e(h),f.status="success"}catch(i){f.status="error",f.value=i}return f}function x(e){return e instanceof this?e:d.resolve(new this(B),e)}function G(f){var e=new this(B);return d.reject(e,f)}function H(m){function e(r,s){function t(u){o[s]=u,++f!==h||l||(l=!0,d.resolve(n,o))}i.resolve(r).then(t,function(u){l||(l=!0,d.reject(n,u))})}var i=this;if("[object Array]"!==Object.prototype.toString.call(m)){return this.reject(new TypeError("must be an array"))}var h=m.length,l=!1;if(!h){return this.resolve([])}for(var o=new Array(h),f=0,p=-1,n=new this(B);++p<h;){e(m[p],p)}return n}function q(h){function l(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(m,p))},function(p){e||(e=!0,d.reject(m,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var i=h.length,e=!1;if(!i){return this.resolve([])}for(var n=-1,m=new this(B);++n<i;){l(h[n])}return m}var E=A(7),d={},c=["REJECTED"],z=["FULFILLED"],I=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(i,h){if("function"!=typeof i&&this.state===z||"function"!=typeof h&&this.state===c){return this}var f=new this.constructor(B);if(this.state!==I){var e=this.state===z?i:h;J(f,e,this.outcome)}else{this.queue.push(new C(f,i,h))}return f},C.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},C.prototype.otherCallFulfilled=function(e){J(this.promise,this.onFulfilled,e)},C.prototype.callRejected=function(e){d.reject(this.promise,e)},C.prototype.otherCallRejected=function(e){J(this.promise,this.onRejected,e)},d.resolve=function(m,f){var i=D(F,f);if("error"===i.status){return d.reject(m,i.value)}var l=i.value;if(l){g(m,l)}else{m.state=z,m.outcome=f;for(var h=-1,e=m.queue.length;++h<e;){m.queue[h].callFulfilled(f)}}return m},d.reject=function(e,h){e.state=c,e.outcome=h;for(var f=-1,i=e.queue.length;++f<i;){e.queue[f].callRejected(h)}return e},j.resolve=x,j.reject=G,j.all=H,j.race=q},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(d,c,j){function y(n){if(null!==n){switch(typeof n){case"boolean":return n?1:0;case"number":return z(n);case"string":return n.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var o=Array.isArray(n),l=o?n:Object.keys(n),f=-1,e=l.length,i="";if(o){for(;++f<e;){i+=j.toIndexableString(l[f])}}else{for(;++f<e;){var h=l[f];i+=j.toIndexableString(h)+j.toIndexableString(n[h])}}return i}}return""}function v(o,e){var l,h=e,i="1"===o[e];if(i){l=0,e++}else{var n="0"===o[e];e++;var r="",f=o.substring(e,e+g),s=parseInt(f,10)+B;for(n&&(s=-s),e+=g;;){var p=o[e];if("\x00"===p){break}r+=p,e++}r=r.split("."),l=1===r.length?parseInt(r,10):parseFloat(r[0]+"."+r[1]),n&&(l-=10),0!==s&&(l=parseFloat(l+"e"+s))}return{num:l,length:e-h}}function m(l,f){var o=l.pop();if(f.length){var i=f[f.length-1];o===i.element&&(f.pop(),i=f[f.length-1]);var e=i.element,n=i.index;if(Array.isArray(e)){e.push(o)}else{if(n===l.length-2){var h=l.pop();e[h]=o}else{l.push(o)}}}}function C(e,i){for(var l=Math.min(e.length,i.length),f=0;l>f;f++){var h=j.collate(e[f],i[f]);if(0!==h){return h}}return e.length===i.length?0:e.length>i.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(n,o){for(var l=Object.keys(n),f=Object.keys(o),e=Math.min(l.length,f.length),i=0;e>i;i++){var h=j.collate(l[i],f[i]);if(0!==h){return h}if(h=j.collate(n[l[i]],o[f[i]]),0!==h){return h}}return l.length===f.length?0:l.length>f.length?1:-1}function q(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function z(p){if(0===p){return"1"}var f=p.toExponential().split(/e\+?/),n=parseInt(f[1],10),i=0>p,l=i?"0":"2",o=(i?-n:n)-B,r=k.padLeft(o.toString(),"0",g);l+=w+r;var h=Math.abs(parseFloat(f[0]));i&&(h=10-h);var e=h.toFixed(20);return e=e.replace(/\.?0+$/,""),l+=w+e}var B=-324,g=3,w="",k=d(13);j.collate=function(h,e){if(h===e){return 0}h=j.normalizeKey(h),e=j.normalizeKey(e);var f=q(h),i=q(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},j.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=j.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=j.normalizeKey(e))}}}}}return l},j.toIndexableString=function(f){var e="\x00";return f=j.normalizeKey(f),q(f)+w+y(f)+e},j.parseIndexableString=function(o){for(var e=[],i=[],h=0;;){var r=o[h++];if("\x00"!==r){switch(r){case"1":e.push(null);break;case"2":e.push("1"===o[h]),h++;break;case"3":var f=v(o,h);e.push(f.num),h+=f.length;break;case"4":for(var s="";;){var p=o[h];if("\x00"===p){break}s+=p,h++}s=s.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(s);break;case"5":var n={element:[],index:e.length};e.push(n.element),i.push(n);break;case"6":var l={element:{},index:e.length};e.push(l.element),i.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+r)}}else{if(1===e.length){return e.pop()}m(e,i)}}}},{13:13}],13:[function(f,c,g){function d(j,h,e){for(var i="",k=e-j.length;i.length<k;){i+=h}return i}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var m,l=j.length,h=p.length;for(m=0;l>m;m++){if(m===h){return 1}var e=j.charAt(m),k=p.charAt(m);if(e!==k){return k>e?-1:1}}return h>l?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(g,d,c){function f(){this.store={}}function h(i){if(this.store=new f,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}c.Map=f,c.Set=h,f.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},f.prototype.unmangle=function(e){return e.substring(1)},f.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},f.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},f.prototype.has=function(i){var e=this.mangle(i);return e in this.store},f.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},f.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},h.prototype.add=function(e){return this.store.set(e,!0)},h.prototype.has=function(e){return this.store.has(e)},h.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(i,m){var l,k,j,h;k=[],h=[];for(l in m){e.call(m,l)&&(j=m[l],"this"!==l&&(k.push(l),h.push(j)))}return Function.apply(null,g.call(k).concat([i])).apply(m["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(I){function A(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function G(m,i,l,n,h,o,g){return A(i&l|~i&n,m,i,h,o,g)}function J(m,i,l,n,h,o,g){return A(i&n|l&~n,m,i,h,o,g)}function E(m,i,l,n,h,o,g){return A(i^l^n,m,i,h,o,g)}function x(m,i,l,n,h,o,g){return A(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=G(n,i,g,m,h[0],7,-680876936),m=G(m,n,i,g,h[1],12,-389564586),g=G(g,m,n,i,h[2],17,606105819),i=G(i,g,m,n,h[3],22,-1044525330),n=G(n,i,g,m,h[4],7,-176418897),m=G(m,n,i,g,h[5],12,1200080426),g=G(g,m,n,i,h[6],17,-1473231341),i=G(i,g,m,n,h[7],22,-45705983),n=G(n,i,g,m,h[8],7,1770035416),m=G(m,n,i,g,h[9],12,-1958414417),g=G(g,m,n,i,h[10],17,-42063),i=G(i,g,m,n,h[11],22,-1990404162),n=G(n,i,g,m,h[12],7,1804603682),m=G(m,n,i,g,h[13],12,-40341101),g=G(g,m,n,i,h[14],17,-1502002290),i=G(i,g,m,n,h[15],22,1236535329),n=J(n,i,g,m,h[1],5,-165796510),m=J(m,n,i,g,h[6],9,-1069501632),g=J(g,m,n,i,h[11],14,643717713),i=J(i,g,m,n,h[0],20,-373897302),n=J(n,i,g,m,h[5],5,-701558691),m=J(m,n,i,g,h[10],9,38016083),g=J(g,m,n,i,h[15],14,-660478335),i=J(i,g,m,n,h[4],20,-405537848),n=J(n,i,g,m,h[9],5,568446438),m=J(m,n,i,g,h[14],9,-1019803690),g=J(g,m,n,i,h[3],14,-187363961),i=J(i,g,m,n,h[8],20,1163531501),n=J(n,i,g,m,h[13],5,-1444681467),m=J(m,n,i,g,h[2],9,-51403784),g=J(g,m,n,i,h[7],14,1735328473),i=J(i,g,m,n,h[12],20,-1926607734),n=E(n,i,g,m,h[5],4,-378558),m=E(m,n,i,g,h[8],11,-2022574463),g=E(g,m,n,i,h[11],16,1839030562),i=E(i,g,m,n,h[14],23,-35309556),n=E(n,i,g,m,h[1],4,-1530992060),m=E(m,n,i,g,h[4],11,1272893353),g=E(g,m,n,i,h[7],16,-155497632),i=E(i,g,m,n,h[10],23,-1094730640),n=E(n,i,g,m,h[13],4,681279174),m=E(m,n,i,g,h[0],11,-358537222),g=E(g,m,n,i,h[3],16,-722521979),i=E(i,g,m,n,h[6],23,76029189),n=E(n,i,g,m,h[9],4,-640364487),m=E(m,n,i,g,h[12],11,-421815835),g=E(g,m,n,i,h[15],16,530742520),i=E(i,g,m,n,h[2],23,-995338651),n=x(n,i,g,m,h[0],6,-198630844),m=x(m,n,i,g,h[7],10,1126891415),g=x(g,m,n,i,h[14],15,-1416354905),i=x(i,g,m,n,h[5],21,-57434055),n=x(n,i,g,m,h[12],6,1700485571),m=x(m,n,i,g,h[3],10,-1894986606),g=x(g,m,n,i,h[10],15,-1051523),i=x(i,g,m,n,h[1],21,-2054922799),n=x(n,i,g,m,h[8],6,1873313359),m=x(m,n,i,g,h[15],10,-30611744),g=x(g,m,n,i,h[6],15,-1560198380),i=x(i,g,m,n,h[13],21,1309151649),n=x(n,i,g,m,h[4],6,-145523070),m=x(m,n,i,g,h[11],10,-1120210379),g=x(g,m,n,i,h[2],15,718787259),i=x(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function H(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function w(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function B(g){var m,i,h,n,p,o,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;l>=m;m+=64){M(r,H(g.substring(m-64,m)))}for(g=g.substring(m-64),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;i>m;m+=1){h[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(h[m>>2]|=128<<(m%4<<3),m>55){for(M(r,h),m=0;16>m;m+=1){h[m]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),o=parseInt(n[1],16)||0,h[14]=p,h[15]=o,M(r,h),r}function D(g){var o,i,h,n,p,m,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(o=64;l>=o;o+=64){M(r,w(g.subarray(o-64,o)))}for(g=l>o-64?g.subarray(o-64):new Uint8Array(0),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;i>o;o+=1){h[o>>2]|=g[o]<<(o%4<<3)}if(h[o>>2]|=128<<(o%4<<3),o>55){for(M(r,h),o=0;16>o;o+=1){h[o]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,h[14]=p,h[15]=m,M(r,h),r}function q(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function z(h){var g;for(g=0;g<h.length;g+=1){h[g]=q(h[g])}return h.join("")}function F(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function C(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==z(B("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(o,l){var n,h,r,m,i=this.byteLength,s=g(o,i),p=i;return l!==I&&(p=g(l,i)),s>p?new ArrayBuffer(0):(n=p-s,h=new ArrayBuffer(n),r=new Uint8Array(h),m=new Uint8Array(this,s,n),r.set(m),h)}}(),C.prototype.append=function(g){return this.appendBinary(F(g)),this},C.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,H(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},C.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},C.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},C.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},C.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},C.hash=function(h,g){return C.hashBinary(F(h),g)},C.hashBinary=function(i,g){var l=B(i),h=z(l);return g?N(h):h},C.ArrayBuffer=function(){this.reset()},C.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,w(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},C.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.ArrayBuffer.prototype.getState=function(){var g=C.prototype.getState.call(this);return g.buff=j(g.buff),g},C.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),C.prototype.setState.call(this,g)},C.ArrayBuffer.prototype.destroy=C.prototype.destroy,C.ArrayBuffer.prototype._finish=C.prototype._finish,C.ArrayBuffer.hash=function(i,g){var l=D(new Uint8Array(i)),h=z(l);return g?N(h):h},C})},{}],17:[function(f,c,g){function d(j,p,m){var l=m[m.length-1];j===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,e=l.index;if(Array.isArray(h)){h.push(j)}else{if(e===p.length-2){var k=p.pop();h[k]=j}else{p.push(j)}}}g.stringify=function(A){var B=[];B.push({obj:A});for(var p,v,w,m,q,h,z,y,x,k,e,j="";p=B.pop();){if(v=p.obj,w=p.prefix||"",m=p.val||"",j+=w,m){j+=m}else{if("object"!=typeof v){j+="undefined"==typeof v?null:JSON.stringify(v)}else{if(null===v){j+="null"}else{if(Array.isArray(v)){for(B.push({val:"]"}),q=v.length-1;q>=0;q--){h=0===q?"":",",B.push({obj:v[q],prefix:h})}B.push({val:"["})}else{z=[];for(y in v){v.hasOwnProperty(y)&&z.push(y)}for(B.push({val:"}"}),q=z.length-1;q>=0;q--){x=z[q],k=v[x],e=q>0?",":"",e+=JSON.stringify(x)+":",B.push({obj:k,prefix:e})}B.push({val:"{"})}}}}}return j},g.parse=function(h){for(var p,q,m,v,e,r,y,j,x,w=[],k=[],z=0;;){if(p=h[z++],"}"!==p&&"]"!==p&&"undefined"!=typeof p){switch(p){case" ":case"	":case"\n":case":":case",":break;case"n":z+=3,d(null,w,k);break;case"t":z+=3,d(!0,w,k);break;case"f":z+=4,d(!1,w,k);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(q="",z--;;){if(m=h[z++],!/[\d\.\-e\+]/.test(m)){z--;break}q+=m}d(parseFloat(q),w,k);break;case'"':for(v="",e=void 0,r=0;;){if(y=h[z++],'"'===y&&("\\"!==e||r%2!==1)){break}v+=y,e=y,"\\"===e?r++:r=0}d(JSON.parse('"'+v+'"'),w,k);break;case"[":j={element:[],index:w.length},w.push(j.element),k.push(j);break;case"{":x={element:{},index:w.length},w.push(x.element),k.push(x);break;default:throw new Error("unexpectedly reached end of input: "+p)}}else{if(1===w.length){return w.pop()}d(w.pop(),w,k)}}}},{}]},{},[3])(3)});