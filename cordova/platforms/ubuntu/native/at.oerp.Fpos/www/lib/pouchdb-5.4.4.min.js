!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(l,e){if(!c[l]){if(!h[l]){var m="function"==typeof require&&require;if(!e&&m){return m(l,!0)}if(d){return d(l,!0)}var k=new Error("Cannot find module '"+l+"'");throw k.code="MODULE_NOT_FOUND",k}var i=c[l]={exports:{}};h[l][0].call(i.exports,function(n){var o=h[l][1][n];return g(o?o:n)},i,i.exports,a,h,c,f)}return c[l].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,m,q,e,n,o;if(this._events||(this._events={}),"error"===p&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(m=this._events[p],g(m)){return !1}if(k(m)){switch(arguments.length){case 1:m.call(this);break;case 2:m.call(this,arguments[1]);break;case 3:m.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1),m.apply(this,e)}}else{if(c(m)){for(e=Array.prototype.slice.call(arguments,1),o=m.slice(),q=o.length,n=0;q>n;n++){o[n].apply(this,e)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(n,i){function e(){this.removeListener(n,e),m||(m=!0,i.apply(this,arguments))}if(!k(i)){throw TypeError("listener must be a function")}var m=!1;return e.listener=i,this.on(n,e),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(c(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(k,p,z){function x(){q&&j&&(q=!1,j.length?d=j.concat(d):m=-1,d.length&&A())}function A(){if(!q){var f=c(x);q=!0;for(var e=d.length;e;){for(j=d,d=[];++m<e;){j&&j[m].run()}m=-1,e=d.length}j=null,q=!1,g(f)}}function v(f,e){this.fun=f,this.array=e}function y(){}var c,g,w=p.exports={};!function(){try{c=setTimeout}catch(e){c=function(){throw new Error("setTimeout is not defined")}}try{g=clearTimeout}catch(e){g=function(){throw new Error("clearTimeout is not defined")}}}();var j,d=[],q=!1,m=-1;w.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}d.push(new v(f,e)),1!==d.length||q||c(A,0)},v.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=y,w.addListener=y,w.once=y,w.off=y,w.removeListener=y,w.removeAllListeners=y,w.emit=y,w.binding=function(e){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(e){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],3:[function(d,c,f){(function(fD,cI){function cP(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function f5(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eA(i){if("function"==typeof i.slice){return i.slice(0)}var g=new ArrayBuffer(i.byteLength),j=new Uint8Array(g),h=new Uint8Array(i);return j.set(h),g}function d3(h){if(h instanceof ArrayBuffer){return eA(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function eC(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&f7.call(i)==cS}function eO(k){var i,h,j;if(!k||"object"!=typeof k){return k}if(Array.isArray(k)){for(i=[],h=0,j=k.length;j>h;h++){i[h]=eO(k[h])}return i}if(k instanceof Date){return k.toISOString()}if(f5(k)){return d3(k)}if(!eC(k)){return k}i={};for(h in k){if(Object.prototype.hasOwnProperty.call(k,h)){var g=eO(k[h]);"undefined"!=typeof g&&(i[h]=g)}}return i}function dZ(h){var g=!1;return da(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function eB(g){return da(function(j){j=eO(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){fD.nextTick(function(){i(n,m)})});var h=new ca(function(o,n){var q;try{var p=dZ(function(r,s){r?n(r):o(s)});j.push(p),q=g.apply(l,j),q&&"function"==typeof q.then&&o(q)}catch(m){n(m)}});return k&&h.then(function(m){k(null,m)},k),h})}function bc(h,g){function i(m,k,o){if(fG.enabled){for(var l=[m._db_name,k],n=0;n<o.length-1;n++){l.push(o[n])}fG.apply(null,l);var j=o[o.length-1];o[o.length-1]=function(r,p){var q=[m._db_name,k];q=q.concat(r?["error",r]:["success",p]),fG.apply(null,q),j(r,p)}}}return eB(da(function(j){if(this._closed){return ca.reject(new Error("database is closed"))}if(this._destroyed){return ca.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new ca(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function ed(l,j){for(var i={},k=0,h=j.length;h>k;k++){var g=j[k];g in l&&(i[g]=l[g])}return i}function dg(g){return g}function dv(g){return[{ok:g}]}function eK(u,h,m){function k(){var w=[];v.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),m(null,{results:w})}function n(){++l===p&&k()}function o(x,w,y){v[x]={id:w,docs:y},n()}function i(){if(!(r>=s.length)){var x=Math.min(r+bv,s.length),w=s.slice(r,x);g(w,r),r+=w.length}}function g(x,w){x.forEach(function(z,D){var B=w+D,y=j[z],A=ed(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(dg);var C=dg;0===A.open_revs.length&&(delete A.open_revs,C=dv),["revs","attachments","binary","ajax"].forEach(function(E){E in h&&(A[E]=h[E])}),u.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),o(B,z,F),i()})})}var q=h.docs,j={};q.forEach(function(w){w.id in j?j[w.id].push(w):j[w.id]=[w]});var p=Object.keys(j).length,l=0,v=new Array(p),s=Object.keys(j),r=0;i()}function bV(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function e4(){return eZ}function eX(g){bV()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):e4()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function aQ(){cx.EventEmitter.call(this),this._listeners={},eX(this)}function dk(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function af(k,i){var h=600000;k=parseInt(k,10)||0,i=parseInt(i,10),i!==i||k>=i?i=(k||1)<<1:i+=1,i>h&&(k=h>>1,i=h);var j=Math.random(),g=i-k;return ~~(g*j+k)}function bB(h){var g=0;return h||(g=2000),af(h,g)}function cU(h,g){dk("info","The above "+h+" is totally normal. "+g)}function dE(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function ch(i,g,j){function h(k){for(var l in i){"function"!=typeof i[l]&&(this[l]=i[l])}void 0!==j&&(this.name=j),void 0!==k&&(this.reason=k)}return h.prototype=dE.prototype,new h(g)}function bq(l){var j,i,k,h,g;return i=l.error===!0&&"string"==typeof l.name?l.name:l.error,g=l.reason,k=dF("name",i,g),l.missing||"missing"===g||"deleted"===g||"not_found"===i?k=cf:"doc_validation"===i?(k=kh,h=g):"bad_request"===i&&k.message!==g&&(k=ea),k||(k=dF("status",l.status,g)||dP),j=ch(k,g,i),h&&(j.message=h),l.id&&(j.id=l.id),l.status&&(j.status=l.status),l.missing&&(j.missing=l.missing),j}function d2(k,i,h){try{return !k(i,h)}catch(j){var g="Filter function threw: "+j.toString();return ch(ea,g)}}function j8(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&d2(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function bs(i){for(var g=[],j=0,h=i.length;h>j;j++){g=g.concat(i[j])}return g}function e0(h){var g;if(h?"string"!=typeof h?g=ch(bA):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=ch(fO)):g=ch(bE),g){throw g}}function eh(h,g){return"listenerCount" in h?h.listenerCount(g):cx.EventEmitter.listenerCount(h,g)}function bP(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function aj(h){var g=bP(h);return g?g.join("/"):null}function cw(i){for(var l=eJ.exec(i),g={},m=14;m--;){var j=aX[m],k=l[m]||"",h=-1!==["user","password"].indexOf(j);g[j]=h?decodeURIComponent(k):k}return g[cD]={},g[aX[12]].replace(fI,function(o,p,n){p&&(g[cD][p]=n)}),g}function aB(h,g,i){return new ca(function(j,k){h.get(g,function(n,l){if(n){if(404!==n.status){return k(n)}l={}}var o=l._rev,m=i(l);return m?(m._id=g,m._rev=o,void j(eY(h,m,i))):j({updated:!1,rev:o})})})}function eY(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return aB(h,g._id,i)})}function aU(g){return 0|Math.random()*g}function aL(i,g){g=g||ck.length;var j="",h=-1;if(i){for(;++h<i;){j+=ck[aU(g)]}return j}for(;++h<36;){switch(h){case 8:case 13:case 18:case 23:j+="-";break;case 19:j+=ck[3&aU(16)|8];break;default:j+=ck[aU(16)]}}return j}function av(r){for(var j,m,k,l,o=r.rev_tree.slice();l=o.pop();){var h=l.ids,p=h[2],i=l.pos;if(p.length){for(var g=0,q=p.length;q>g;g++){o.push({pos:i+1,ids:p[g]})}}else{var n=!!h[1].deleted,s=h[0];j&&!(k!==n?k:m!==i?i>m:s>j)||(j=s,m=i,k=n)}}return m+"-"+j}function b8(i,k){for(var g,m=i.slice();g=m.pop();){for(var o=g.pos,h=g.ids,j=h[2],l=k(0===j.length,o,h[0],g.ctx,h[1]),p=0,n=j.length;n>p;p++){m.push({pos:o+1,ids:j[p],ctx:l})}}}function kc(h,g){return h.pos-g.pos}function aO(i){var g=[];b8(i,function(o,l,n,k,m){o&&g.push({rev:l+"-"+n,pos:l,opts:m})}),g.sort(kc).reverse();for(var j=0,h=g.length;h>j;j++){delete g[j].pos}return g}function fB(i){for(var l=av(i),g=aO(i.rev_tree),m=[],j=0,k=g.length;k>j;j++){var h=g[j];h.rev===l||h.opts.deleted||m.push(h.rev)}return m}function cE(h){var g=[];return b8(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function bd(r){for(var j,m=[],k=r.slice();j=k.pop();){var l=j.pos,o=j.ids,h=o[0],p=o[1],i=o[2],g=0===i.length,q=j.history?j.history.slice():[];q.push({id:h,opts:p}),g&&m.push({pos:l+1-q.length,ids:q});for(var n=0,s=i.length;s>n;n++){k.push({pos:l+1,ids:i[n],history:q})}}return m.reverse()}function eS(h,g){return h.pos-g.pos}function ds(l,j,i){for(var k,h=0,g=l.length;g>h;){k=h+g>>>1,i(l[k],j)<0?h=k+1:g=k}return h}function bC(i,g,j){var h=ds(i,g,j);i.splice(h,0,g)}function ki(g,h){for(var m,i,k=h,l=g.length;l>k;k++){var j=g[k],n=[j.id,j.opts,[]];i?(i[2].push(n),i=n):m=i=n}return m}function dd(h,g){return h[0]<g[0]?-1:1}function aT(i,k){for(var g=[{tree1:i,tree2:k}],m=!1;g.length>0;){var o=g.pop(),h=o.tree1,j=o.tree2;(h[1].status||j[1].status)&&(h[1].status="available"===h[1].status||"available"===j[1].status?"available":"missing");for(var l=0;l<j[2].length;l++){if(h[2][0]){for(var p=!1,n=0;n<h[2].length;n++){h[2][n][0]===j[2][l][0]&&(g.push({tree1:h[2][n],tree2:j[2][l]}),p=!0)}p||(m="new_branch",bC(h[2],j[2][l],dd))}else{m="new_leaf",h[2][0]=j[2][l]}}}return{conflicts:m,tree:i}}function f3(p,u,o){var m,k=[],s=!1,r=!1;if(!p.length){return{tree:[u],conflicts:"new_leaf"}}for(var w=0,j=p.length;j>w;w++){var n=p[w];if(n.pos===u.pos&&n.ids[0]===u.ids[0]){m=aT(n.ids,u.ids),k.push({pos:n.pos,ids:m.tree}),s=s||m.conflicts,r=!0}else{if(o!==!0){var z=n.pos<u.pos?n:u,q=n.pos<u.pos?u:n,A=q.pos-z.pos,v=[],i=[];for(i.push({ids:z.ids,diff:A,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],x=0,y=g.length;y>x;x++){i.push({ids:g[x],diff:h.diff-1,parent:h.ids,parentIdx:x})}}else{h.ids[0]===q.ids[0]&&v.push(h)}}var l=v[0];l?(m=aT(l.ids,q.ids),l.parent[2][l.parentIdx]=m.tree,k.push({pos:z.pos,ids:z.ids}),s=s||m.conflicts,r=!0):k.push(n)}else{k.push(n)}}}return r||k.push(u),k.sort(eS),{tree:k,conflicts:s||"internal_node"}}function cq(r,j){for(var m,k=bd(r),l={},o=0,h=k.length;h>o;o++){for(var p=k[o],i=p.ids,g=Math.max(0,i.length-j),q={pos:p.pos+g,ids:ki(i,g)},n=0;g>n;n++){var s=p.pos+n+"-"+i[n].id;l[s]=!0}m=m?f3(m,q,!0).tree:[q]}return b8(m,function(w,v,u){delete l[v+"-"+u]}),{tree:m,revs:Object.keys(l)}}function eE(k,i,h){var j=f3(k,i),g=cq(j.tree,h);return{tree:g.tree,stemmedRevs:g.revs,conflicts:j.conflicts}}function jY(i,k){for(var g,m=i.slice(),o=k.split("-"),h=parseInt(o[0],10),j=o[1];g=m.pop();){if(g.pos===h&&g.ids[0]===j){return !0}for(var l=g.ids[2],p=0,n=l.length;n>p;p++){m.push({pos:g.pos+1,ids:l[p]})}}return !1}function dy(g){return g.ids}function e8(k,i){i||(i=av(k));for(var h,j=i.substring(i.indexOf("-")+1),g=k.rev_tree.map(dy);h=g.pop();){if(h[0]===j){return !!h[1].deleted}g=g.concat(h[2])}}function fN(g){return/^_local/.test(g)}function cF(g){return dm("return "+g+";",{})}function c3(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function ep(h,g){try{h.emit("change",g)}catch(i){dk("error",'Error in .on("change", function):',i)}}function dY(i,l,g){function m(){j.cancel()}cx.EventEmitter.call(this);var j=this;this.db=i,l=l?eO(l):{};var k=l.complete=dZ(function(o,n){o?eh(j,"error")>0&&j.emit("error",o):j.emit("complete",n),j.removeAllListeners(),i.removeListener("destroyed",m)});g&&(j.on("complete",function(n){g(null,n)}),j.on("error",g)),i.once("destroyed",m),l.onChange=function(n){l.isCancelled||(ep(j,n),j.startSeq&&j.startSeq<=n.seq&&(j.startSeq=!1))};var h=new ca(function(o,n){l.complete=function(p,q){p?n(p):o(q)}});j.once("cancel",function(){i.removeListener("destroyed",m),l.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){k(null,n)},k),i.taskqueue.isReady?j.doChanges(l):i.taskqueue.addTask(function(){j.isCancelled?j.emit("cancel"):j.doChanges(l)})}function aY(k,i,h){var j=[{rev:k._rev}];"all_docs"===h.style&&(j=aO(i.rev_tree).map(function(l){return{rev:l.rev}}));var g={id:i.id,changes:j,doc:k};return e8(i,k._rev)&&(g.deleted=!0),h.conflicts&&(g.doc._conflicts=fB(i),g.doc._conflicts.length||delete g.doc._conflicts),g}function ek(h,g){return g>h?-1:h>g?1:0}function bK(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function fH(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function e5(l){for(var j=0;j<l.length;j++){var i=l[j];if(i._deleted){delete i._attachments}else{if(i._attachments){for(var k=Object.keys(i._attachments),h=0;h<k.length;h++){var g=k[h];i._attachments[g]=ed(i._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function bU(k,i){var h=ek(k._id,i._id);if(0!==h){return h}var j=k._revisions?k._revisions.start:0,g=i._revisions?i._revisions.start:0;return ek(j,g)}function e1(h){var g={},i=[];return b8(h,function(j,n,k,m){var l=n+"-"+k;return j&&(g[l]=0),void 0!==m&&i.push({from:m,to:l}),l}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function ap(k,i,h){var j="limit" in i?i.keys.slice(i.skip,i.limit+i.skip):i.skip>0?i.keys.slice(i.skip):i.keys;if(i.descending&&j.reverse(),!j.length){return k._allDocs({limit:0},h)}var g={offset:i.skip};return ca.all(j.map(function(m){var l=ah.extend({key:m,deleted:"ok"},i);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new ca(function(o,n){k._allDocs(l,function(q,p){return q?n(q):(g.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return g.rows=l,g})}function jZ(i){var g=i._compactionQueue[0],h=g.opts,j=g.callback;i.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(h.last_seq=k.last_seq),i._compact(h,function(l,m){l?j(l):j(null,m),fD.nextTick(function(){i._compactionQueue.shift(),i._compactionQueue.length&&jZ(i)})})})}function dT(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function dC(){cx.EventEmitter.call(this)}function bk(){this.isReady=!1,this.failed=!1,this.queue=[]}function aD(g){g&&cI.debug&&dk("error",g)}function eR(i,l){function g(){k.emit("destroyed",j)}function m(){i.removeListener("destroyed",g),i.emit("destroyed",i)}var j=l.originalName,k=i.constructor,h=k._destructionListeners;i.once("destroyed",g),h.has(j)||h.set(j,[]),h.get(j).push(m)}function t(i,l,g){if(!(this instanceof t)){return new t(i,l,g)}var m=this;if("function"!=typeof l&&"undefined"!=typeof l||(g=l,l={}),i&&"object"==typeof i&&(l=i,i=void 0),"undefined"==typeof g){g=aD}else{var j=g;g=function(){return dk("warn","Using a callback for new PouchDB()is deprecated."),j.apply(null,arguments)}}i=i||l.name,l=eO(l),delete l.name,this.__opts=l;var k=g;m.auto_compaction=l.auto_compaction,m.prefix=t.prefix,dC.call(m),m.taskqueue=new bk;var h=new ca(function(q,o){g=function(r,s){return r?o(r):(delete s.then,void q(s))},l=eO(l);var n,p;return function(){try{if("string"!=typeof i){throw p=new Error("Missing/invalid DB name"),p.code=400,p}var r=(l.prefix||"")+i;if(n=t.parseAdapter(r,l),l.originalName=i,l.name=n.name,l.adapter=l.adapter||n.adapter,m._adapter=l.adapter,c8("pouchdb:adapter")("Picked adapter: "+l.adapter),m._db_name=i,!t.adapters[l.adapter]){throw p=new Error("Adapter is missing"),p.code=404,p}if(!t.adapters[l.adapter].valid()){throw p=new Error("Invalid Adapter"),p.code=404,p}}catch(s){m.taskqueue.fail(s)}}(),p?o(p):(m.adapter=l.adapter,m.replicate={},m.replicate.from=function(r,u,s){return m.constructor.replicate(r,m,u,s)},m.replicate.to=function(r,u,s){return m.constructor.replicate(m,r,u,s)},m.sync=function(r,u,s){return m.constructor.sync(m,r,u,s)},m.replicate.sync=m.sync,void t.adapters[l.adapter].call(m,l,function(r){return r?(m.taskqueue.fail(r),void g(r)):(eR(m,l),m.emit("created",m),t.emit("created",l.originalName),m.taskqueue.ready(m),void g(null,m))}))});h.then(function(n){k(null,n)},k),m.then=h.then.bind(h),m["catch"]=h["catch"].bind(h)}function e3(h){Object.keys(cx.EventEmitter.prototype).forEach(function(i){"function"==typeof cx.EventEmitter.prototype[i]&&(h[i]=f1[i].bind(f1))});var g=h._destructionListeners=new dO.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function bJ(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function cm(i){if(!/^\d+\-./.test(i)){return ch(eH)}var g=i.indexOf("-"),j=i.substring(0,g),h=i.substring(g+1);return{prefix:parseInt(j,10),id:h}}function aR(i,l){for(var g=i.start-i.ids.length+1,m=i.ids,j=[m[0],l,[]],k=1,h=m.length;h>k;k++){j=[m[k],{status:"missing"},[j]]}return[{pos:g,ids:j}]}function eG(i,k){var g,m,o,h={status:"available"};if(i._deleted&&(h.deleted=!0),k){if(i._id||(i._id=aL()),m=aL(32,16).toLowerCase(),i._rev){if(o=cm(i._rev),o.error){return o}i._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[m,h,[]]]]}],g=o.prefix+1}else{i._rev_tree=[{pos:1,ids:[m,h,[]]}],g=1}}else{if(i._revisions&&(i._rev_tree=aR(i._revisions,h),g=i._revisions.start,m=i._revisions.ids[0]),!i._rev_tree){if(o=cm(i._rev),o.error){return o}g=o.prefix,m=o.id,i._rev_tree=[{pos:g,ids:[m,h,[]]}]}}e0(i._id),i._rev=g+"-"+m;var j={metadata:{},data:{}};for(var l in i){if(Object.prototype.hasOwnProperty.call(i,l)){var p="_"===l[0];if(p&&!d6[l]){var n=ch(kh,l);throw n.message=kh.message+": "+l,n}p&&!cA[l]?j.metadata[l.slice(1)]=i[l]:j.data[l]=i[l]}}return j}function e(k){for(var i="",h=new Uint8Array(k),j=h.byteLength,g=0;j>g;g++){i+=String.fromCharCode(h[g])}return i}function d8(g){return e6(e(g))}function c5(l,j){l=l||[],j=j||{};try{return new Blob(l,j)}catch(i){if("TypeError"!==i.name){throw i}for(var k="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,h=new k,g=0;g<l.length;g+=1){h.append(l[g])}return h.getBlob(j.type)}}function c9(k){for(var i=k.length,h=new ArrayBuffer(i),j=new Uint8Array(h),g=0;i>g;g++){j[g]=k.charCodeAt(g)}return h}function aM(h,g){return c5([c9(h)],{type:g})}function cZ(h,g){return aM(cM(h),g)}function eU(i,g){if("undefined"==typeof FileReader){return g(e((new FileReaderSync).readAsArrayBuffer(i)))}var j=new FileReader,h="function"==typeof j.readAsBinaryString;j.onloadend=function(k){var l=k.target.result||"";return h?g(l):void g(e(l))},h?j.readAsBinaryString(i):j.readAsArrayBuffer(i)}function dz(h,g){eU(h,function(i){g(e6(i))})}function fK(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function aE(g){return e6(g)}function jN(i,g,j,h){(j>0||h<g.byteLength)&&(g=new Uint8Array(g,j,Math.min(h,g.byteLength)-j)),i.append(g)}function bS(i,g,j,h){(j>0||h<g.length)&&(g=g.substring(j,h)),i.appendBinary(g)}function jG(i,k){function g(){var q=l*h,u=q+h;if(l++,j>l){n(p,i,q,u),bG(g)}else{n(p,i,q,u);var r=p.end(!0),s=aE(r);k(s),p.destroy()}}var m="string"==typeof i,o=m?i.length:i.byteLength,h=Math.min(df,o),j=Math.ceil(o/h),l=0,p=m?new dJ:new dJ.ArrayBuffer,n=m?bS:jN;g()}function ay(g){return dJ.hash(g)}function jV(g,h,m){function i(o){try{return cM(o)}catch(q){var p=ch(kd,"Attachment is not a valid base64 string");return{error:p}}}function k(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=i(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===h?q.data=aM(o,q.content_type):"base64"===h?q.data=e6(o):q.data=o,jG(o,function(r){q.digest="md5-"+r,p()})}else{fK(q.data,function(r){"binary"===h?q.data=e(r):"base64"===h&&(q.data=d8(r)),jG(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function l(){n++,g.length===n&&(j?m(j):m())}if(!g.length){return m()}var j,n=0;g.forEach(function(r){function p(u){j=u,q++,q===s.length&&l()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return l()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&k(r.data._attachments[o],p)}})}function bH(w,u,l,y,k,p,r,s){if(jY(u.rev_tree,l.metadata.rev)){return y[k]=l,p()}var j=u.winningRev||av(u),m="deleted" in u?u.deleted:e8(u,j),x="deleted" in l.metadata?l.metadata.deleted:e8(l.metadata),n=/^1-/.test(l.metadata.rev);if(m&&!x&&s&&n){var z=l.data;z._rev=j,z._id=l.metadata.id,l=eG(z,s)}var q=eE(u.rev_tree,l.metadata.rev_tree[0],w),i=s&&(m&&x||!m&&"new_leaf"!==q.conflicts||m&&!x&&"new_branch"===q.conflicts);if(i){var h=ch(eP);return y[k]=h,p()}var g=l.metadata.rev;l.metadata.rev_tree=q.tree,l.stemmedRevs=q.stemmedRevs||[],u.rev_map&&(l.metadata.rev_map=u.rev_map);var A,v=av(l.metadata),o=e8(l.metadata,v),B=m===o?0:o>m?-1:1;A=g===v?o:e8(l.metadata,g),r(l,v,o,A,!0,B,k,p)}function jM(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function al(k,v,u,m,o,j,q,g,r){function p(C,B,x){var A=av(C.metadata),D=e8(C.metadata,A);if("was_delete" in g&&D){return j[B]=ch(cf,"deleted"),x()}var w=h&&jM(C);if(w){var z=ch(eP);return j[B]=z,x()}var y=D?0:1;q(C,A,D,D,!1,y,B,x)}function i(){++s===l&&r&&r()}k=k||1000;var h=g.new_edits,n=new dO.Map,s=0,l=v.length;v.forEach(function(y,w){if(y._id&&fN(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void u[x](y,{ctx:o},function(B,A){j[w]=B||A,i()})}var z=y.metadata.id;n.has(z)?(l--,n.get(z).push([y,w])):n.set(z,[[y,w]])}),n.forEach(function(x,z){function y(){++w<x.length?A():i()}function A(){var C=x[w],E=C[0],D=C[1];if(m.has(z)){bH(k,m.get(z),E,j,D,y,q,h)}else{var B=eE([],E.metadata.rev_tree[0],k);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],p(E,D,y)}}var w=0;A()})}function cX(h){try{return JSON.parse(h)}catch(g){return bz.parse(h)}}function bu(g){return g.length<50000?JSON.parse(g):cX(g)}function dj(h){try{return JSON.stringify(h)}catch(g){return bz.stringify(h)}}function j7(k,i,h,j){try{k.apply(i,h)}catch(g){j.emit("error",g)}}function cy(h){if(!bg.running&&bg.queue.length){bg.running=!0;var g=bg.queue.shift();g.action(function(i,j){j7(g.callback,this,[i,j],h),bg.running=!1,fD.nextTick(function(){cy(h)})})}}function bD(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(ch(cu,i,h.type))}}function j1(h,g,i){return{data:dj(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function bM(h){if(!h){return null}var g=bu(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function j0(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function aV(i,g,j,h){j?h(i?"string"!=typeof i?i:cZ(i,g):c5([""],{type:g})):i?"string"!=typeof i?eU(i,function(k){h(e6(k))}):h(i):h("")}function jW(g,h,m,i){function k(){++n===j.length&&i&&i()}function l(s,q){var r=s._attachments[q],p=r.digest,o=m.objectStore(dB).get(p);o.onsuccess=function(u){r.body=u.target.result.body,k()}}var j=Object.keys(g._attachments||{});if(!j.length){return i&&i()}var n=0;j.forEach(function(o){h.attachments&&h.include_docs?l(g,o):(g._attachments[o].stub=!0,k())})}function bl(h,g){return ca.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return ca.all(j.map(function(n){var l=i.doc._attachments[n];if("body" in l){var m=l.body,k=l.content_type;return new ca(function(o){aV(m,k,g,function(p){i.doc._attachments[n]=ah.extend(ed(l,["digest","content_type"]),{data:p}),o()})})}}))}}))}function b1(i,k,g){function m(){n--,n||o()}function o(){h.length&&h.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||l["delete"](q)}})}var h=[],j=g.objectStore(dG),l=g.objectStore(dB),p=g.objectStore(j6),n=i.length;i.forEach(function(s){var r=j.index("_doc_id_rev"),q=k+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return m()}j["delete"](u);var w=p.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];h.push(x),p["delete"](y.primaryKey),y["continue"]()}else{m()}}}})}function db(i,g,j){try{return{txn:i.transaction(g,j)}}catch(h){return{error:h}}}function b5(r,u,x,p,A,G,l){function C(){var P=[ac,dG,dB,f4,j6],O=db(A,P,"readwrite");return O.error?l(O.error):(q=O.txn,q.onabort=bD(l),q.ontimeout=bD(l),q.oncomplete=v,H=q.objectStore(ac),E=q.objectStore(dG),o=q.objectStore(dB),s=q.objectStore(j6),void g(function(Q){return Q?(N=!0,l(Q)):void h()}))}function j(){al(r.revs_limit,F,p,M,q,z,D,x)}function h(){function O(){++Q===F.length&&j()}function T(W){var V=bM(W.target.result);V&&M.set(V.id,V),O()}if(F.length){for(var Q=0,U=0,P=F.length;P>U;U++){var S=F[U];if(S._id&&fN(S._id)){O()}else{var R=H.get(S.metadata.id);R.onsuccess=T}}}}function v(){N||(G.notify(p._meta.name),p._meta.docCount+=B,l(null,z))}function n(P,O){var Q=o.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=ch(cG,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(F.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){n(T,function(U){U&&!P&&(P=U),O()})})}function D(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?k(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ao){var ai=X.stemmedRevs||[];R&&p.auto_compaction&&(ai=ai.concat(cE(X.metadata))),ai&&ai.length&&b1(ai,X.metadata.id,q),T.seq=ao.target.result,delete T.rev;var ae=j1(T,Q,S),an=H.put(ae);an.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=E.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=E.put(V,ar.target.result);ao.onsuccess=W}}function Z(){z[U]={ok:!0,id:T.id,rev:Q},M.set(X.metadata.id,X.metadata),m(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=E.put(V);Y.onsuccess=W,Y.onerror=P}function k(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;I(an,ai,Q)}})}function m(V,S,P){function U(){++R===Q.length&&P()}function O(W){var Y=V.data._attachments[W].digest,X=s.put({seq:S,digestSeq:Y+"::"+S});X.onsuccess=U,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),U()}}var R=0,Q=Object.keys(V.data._attachments||{});if(!Q.length){return P()}for(var T=0;T<Q.length;T++){O(Q[T])}}function I(Q,O,R){var P=o.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=o.put(U);T.onsuccess=R}}for(var q,H,E,o,s,y,F=u.docs,B=0,w=0,J=F.length;J>w;w++){var L=F[w];L._id&&fN(L._id)||(L=F[w]=eG(L,x.new_edits),L.error&&!y&&(y=L))}if(y){return l(y)}var z=new Array(F.length),M=new dO.Map,N=!1,i=p._meta.blobSupport?"blob":"base64";jV(F,i,function(O){return O?l(O):void C()})}function aG(l,j,i,k,h){try{if(l&&j){return h?IDBKeyRange.bound(j,l,!i,!1):IDBKeyRange.bound(l,j,!1,!i)}if(l){return h?IDBKeyRange.upperBound(l):IDBKeyRange.lowerBound(l)}if(j){return h?IDBKeyRange.lowerBound(j,!i):IDBKeyRange.upperBound(j,!i)}if(k){return IDBKeyRange.only(k)}}catch(g){return{error:g}}return null}function dl(i,g,j,h){return"DataError"===j.name&&0===j.code?h(null,{total_rows:i._meta.docCount,offset:g.skip,rows:[]}):void h(ch(cu,j.name,j.message))}function bf(l,j,i,k){function h(E,r){function z(L,O,M){var N=L.id+"::"+M;p.get(N).onsuccess=function(P){O.doc=j0(P.target.result),E.conflicts&&(O.doc._conflicts=fB(L)),jW(O.doc,E,D)}}function v(M,O,N){var L={id:N.id,key:N.id,value:{rev:O}},P=N.deleted;if("ok"===E.deleted){w.push(L),P?(L.value.deleted=!0,L.doc=null):E.include_docs&&z(N,L,O)}else{if(!P&&H--<=0&&(w.push(L),E.include_docs&&z(N,L,O),0===--C)){return}}M["continue"]()}function q(M){K=j._meta.docCount;var O=M.target.result;if(O){var L=bM(O.value),N=L.winningRev;v(O,N,L)}}function F(){r(null,{total_rows:K,offset:E.skip,rows:w})}function A(){E.attachments?bl(w,E.binary).then(F):F()}var J="startkey" in E?E.startkey:!1,I="endkey" in E?E.endkey:!1,B="key" in E?E.key:!1,H=E.skip||0,C="number"==typeof E.limit?E.limit:-1,s=E.inclusive_end!==!1,o="descending" in E&&E.descending?"prev":null,G=aG(J,I,s,B,o);if(G&&G.error){return dl(j,E,G.error,r)}var y=[ac,dG];E.attachments&&y.push(dB);var u=db(i,y,"readonly");if(u.error){return r(u.error)}var D=u.txn,x=D.objectStore(ac),n=D.objectStore(dG),m=o?x.openCursor(G,o):x.openCursor(G),p=n.index("_doc_id_rev"),w=[],K=0;D.oncomplete=A,m.onsuccess=q}function g(m,n){return 0===m.limit?n(null,{total_rows:j._meta.docCount,offset:m.skip,rows:[]}):void h(m,n)}g(l,k)}function bR(g){return new ca(function(h){var i=c5([""]);g.objectStore(aJ).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function eg(h,g){var i=this;bg.queue.push({action:function(j){aq(i,h,j)},callback:g}),cy(i.constructor)}function aq(m,n,s){function g(x){var w=x.createObjectStore(ac,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(dB,{keyPath:"digest"}),x.createObjectStore(cp,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aJ),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(f4,{keyPath:"_id"});var v=x.createObjectStore(j6,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function h(x,w){var v=x.objectStore(ac);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=e8(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function q(v){v.createObjectStore(f4,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function l(w,y){var x=w.objectStore(f4),z=w.objectStore(ac),v=w.objectStore(dG),A=z.openCursor();A.onsuccess=function(H){var E=H.target.result;if(E){var K=E.value,B=K.id,M=fN(B),J=av(K);if(M){var G=B+"::"+J,D=B+"::",I=B+"::~",F=v.index("_doc_id_rev"),C=IDBKeyRange.bound(D,I,!1,!1),L=F.openCursor(C);L.onsuccess=function(N){if(L=N.target.result){var O=L.value;O._doc_id_rev===G&&x.put(O),v["delete"](L.primaryKey),L["continue"]()}else{z["delete"](E.primaryKey),E["continue"]()}}}else{E["continue"]()}}else{y&&y()}}}function i(w){var v=w.createObjectStore(j6,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function j(w,y){var x=w.objectStore(dG),z=w.objectStore(dB),v=w.objectStore(j6),A=z.count();A.onsuccess=function(B){var C=B.target.result;return C?void (x.openCursor().onsuccess=function(D){var J=D.target.result;if(!J){return y()}for(var I=J.value,L=J.primaryKey,F=Object.keys(I._attachments||{}),H={},G=0;G<F.length;G++){var E=I._attachments[F[G]];H[E.digest]=!0}var M=Object.keys(H);for(G=0;G<M.length;G++){var K=M[G];v.put({seq:L,digestSeq:K+"::"+L})}J["continue"]()}):y()}}function o(x){function y(A){return A.data?bM(A):(A.deleted="1"===A.deletedOrLocal,A)}var w=x.objectStore(dG),v=x.objectStore(ac),z=v.openCursor();z.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=w.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=j1(B,B.winningRev,B.deleted),F=v.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=y(E.value);return B.winningRev=B.winningRev||av(B),B.seq?A():void D()}}}var u=n.name,p=null;m._meta=null,m.type=function(){return"idb"},m._id=eB(function(v){v(null,m._meta.instanceId)}),m._bulkDocs=function(v,w,x){b5(n,v,w,m,p,aW,x)},m._get=function(y,C,B){function w(){B(z,{doc:x,metadata:v,ctx:D})}var x,v,z,D=C.ctx;if(!D){var A=db(p,[ac,dG,dB],"readonly");if(A.error){return B(A.error)}D=A.txn}D.objectStore(ac).get(y).onsuccess=function(E){if(v=bM(E.target.result),!v){return z=ch(cf,"missing"),w()}if(e8(v)&&!C.rev){return z=ch(cf,"deleted"),w()}var G=D.objectStore(dG),H=C.rev||v.winningRev,F=v.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return x=I.target.result,x&&(x=j0(x)),x?void w():(z=ch(cf,"missing"),w())}}},m._getAttachment=function(y,C,B,w,x){var v;if(w.ctx){v=w.ctx}else{var z=db(p,[ac,dG,dB],"readonly");if(z.error){return x(z.error)}v=z.txn}var D=B.digest,A=B.content_type;v.objectStore(dB).get(D).onsuccess=function(E){var F=E.target.result.body;aV(F,A,w.binary,function(G){x(null,G)})}},m._info=function(A){if(null===p||!jT.has(u)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,z,B=db(p,[dG],"readonly");if(B.error){return A(B.error)}var w=B.txn,x=w.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,z=m._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:v,idb_attachment_format:m._meta.blobSupport?"binary":"base64"})}},m._allDocs=function(v,w){bf(v,m,p,w)},m._changes=function(B){function x(N){function T(){return S.seq!==O?N["continue"]():(I=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=J.get(U);V.onsuccess=function(W){R(j0(W.target.result))}}function R(V){var W=B.processChange(V,S,B);W.seq=S.seq;var U=G(W);return"object"==typeof U?B.complete(U):(U&&(F++,E&&v.push(W),B.attachments&&B.include_docs?jW(V,B,C,function(){bl([W],B.binary).then(function(){B.onChange(W)})}):B.onChange(W)),void (F!==L&&N["continue"]()))}var P=j0(N.value),O=N.key;if(z&&!z.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (M.get(P._id).onsuccess=function(U){S=bM(U.target.result),y.set(P._id,S),T()})}function H(N){var O=N.target.result;O&&x(O)}function K(){var P=[ac,dG];B.attachments&&P.push(dB);var O=db(p,P,"readonly");if(O.error){return B.complete(O.error)}C=O.txn,C.onabort=bD(B.complete),C.oncomplete=D,w=C.objectStore(dG),M=C.objectStore(ac),J=w.index("_doc_id_rev");var N;N=B.descending?w.openCursor(null,"prev"):w.openCursor(IDBKeyRange.lowerBound(B.since,!0)),N.onsuccess=H}function D(){function N(){B.complete(null,{results:v,last_seq:I})}!B.continuous&&B.attachments?bl(v).then(N):N()}if(B=eO(B),B.continuous){var A=u+":"+aL();return aW.addListener(u,A,m,B),aW.notify(u),{cancel:function(){aW.removeListener(u,A)}}}var z=B.doc_ids&&new dO.Set(B.doc_ids);B.since=B.since||0;var I=B.since,L="limit" in B?B.limit:-1;0===L&&(L=1);var E;E="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var C,w,M,J,v=[],F=0,G=j8(B),y=new dO.Map;K()},m._close=function(v){return null===p?v(ch(cs)):(p.close(),jT["delete"](u),p=null,void v())},m._getRevisionTree=function(x,y){var w=db(p,[ac],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(ac).get(x);z.onsuccess=function(B){var A=bM(B.target.result);A?y(null,A.rev_tree):y(ch(cf))}},m._doCompaction=function(y,A,z){var x=[ac,dG,dB,j6],v=db(p,x,"readwrite");if(v.error){return z(v.error)}var B=v.txn,w=B.objectStore(ac);w.get(y).onsuccess=function(E){var C=bM(E.target.result);b8(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),b1(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(ac).put(j1(C,D,F))},B.onabort=bD(z),B.oncomplete=function(){z()}},m._getLocal=function(x,y){var w=db(p,[f4],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(f4).get(x);z.onerror=bD(y),z.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,y(null,A)):y(ch(cf))}},m._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=db(p,[f4],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=bD(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(f4);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(ch(eP))}}):(y=v.add(E),y.onerror=function(F){x(ch(eP)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},m._removeLocal=function(y,C,B){"function"==typeof C&&(B=C,C={});var w=C.ctx;if(!w){var x=db(p,[f4],"readwrite");if(x.error){return B(x.error)}w=x.txn,w.oncomplete=function(){v&&B(null,v)}}var v,z=y._id,D=w.objectStore(f4),A=D.get(z);A.onerror=bD(B),A.onsuccess=function(F){var E=F.target.result;E&&E._rev===y._rev?(D["delete"](z),v={ok:!0,id:z,rev:"0-0"},C.ctx&&B(null,v)):B(ch(cf))}},m._destroy=function(y,w){aW.removeAllListeners(u);var v=bN.get(u);v&&v.result&&(v.result.close(),jT["delete"](u));var x=indexedDB.deleteDatabase(u);x.onsuccess=function(){bN["delete"](u),e4()&&u in localStorage&&delete localStorage[u],w(null,{ok:!0})},x.onerror=bD(w)};var k=jT.get(u);if(k){return p=k.idb,m._meta=k.global,void fD.nextTick(function(){s(null,m)})}var r;r=n.storage?cO(u,n.storage):indexedDB.open(u,e7),bN.set(u,r),r.onupgradeneeded=function(y){function w(){var B=v[A-1];A++,B&&B(x,w)}var z=y.target.result;if(y.oldVersion<1){return g(z)}var x=y.currentTarget.transaction;y.oldVersion<3&&q(z),y.oldVersion<4&&i(z);var v=[h,l,j,o],A=y.oldVersion;w()},r.onsuccess=function(z){p=z.target.result,p.onversionchange=function(){p.close(),jT["delete"](u)},p.onabort=function(B){dk("error","Database has a global failure",B.target.error),p.close(),jT["delete"](u)};var x=p.transaction([cp,aJ,ac],"readwrite"),v=x.objectStore(cp).get(cp),y=null,w=null,A=null;v.onsuccess=function(D){var B=function(){null!==y&&null!==w&&null!==A&&(m._meta={name:u,instanceId:A,blobSupport:y,docCount:w},jT.set(u,{idb:p,global:m._meta}),s(null,m))},E=D.target.result||{id:cp};u+"_id" in E?(A=E[u+"_id"],B()):(A=aL(),E[u+"_id"]=A,x.objectStore(cp).put(E).onsuccess=function(){B()}),jR||(jR=bR(x)),jR.then(function(F){y=F,B()});var C=x.objectStore(ac).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){w=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";dk("error",v),s(ch(cu,v))}}function cO(h,g){try{return indexedDB.open(h,{version:e7,storage:g})}catch(i){return indexedDB.open(h,e7)}}function aa(g){g.adapter("idb",eg,!0)}function am(g){return decodeURIComponent(escape(g))}function aw(g){return 65>g?g-48:g-55}function fE(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(aw(i.charCodeAt(g++))<<4|aw(i.charCodeAt(g++)))}return h}function dM(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(aw(i.charCodeAt(g+2))<<12|aw(i.charCodeAt(g+3))<<8|aw(i.charCodeAt(g))<<4|aw(i.charCodeAt(g+1))),g+=4}return h}function bh(h,g){return"UTF-8"===g?am(fE(h,0,h.length)):dM(h,0,h.length)}function ag(g){return"'"+g+"'"}function cR(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cH(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aS(g){return delete g._id,delete g._rev,JSON.stringify(g)}function cK(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function cQ(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function dL(k,i,h,j,g){return"SELECT "+k+" FROM "+("string"==typeof i?i:i.join(" JOIN "))+(h?" ON "+h:"")+(j?" WHERE "+("string"==typeof j?j:j.join(" AND ")):"")+(g?" ORDER BY "+g:"")}function b4(i,l,g){function m(){++k===i.length&&j()}function j(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+cg+" WHERE seq IN "+cQ(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+cg+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+cg+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new dO.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+cg+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+cT+" WHERE digest=?",[A]))})})})}})}}if(i.length){var k=0,h=[];i.forEach(function(o){var n="SELECT seq FROM "+dW+" WHERE doc_id=? AND rev=?";g.executeSql(n,[l,o],function(q,p){if(!p.rows.length){return m()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+dW+" WHERE seq=?",[r],m)})})}}function kf(g){return function(h){dk("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(ch(d1,j,i))}}function dX(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function bY(u,B,k,g,i,y,x){function n(){return r?x(r):(y.notify(g._name),g._docCount=-1,void x(null,A))}function q(E,D){var F="SELECT count(*) as cnt FROM "+cT+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=ch(cG,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function v(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){q(I,function(J){J&&!E&&(E=J),D()})})}function s(D,L,G,Q,O,I,N,K){function F(){function Y(ar,at){function a0(){return ++ae===ao.length&&at(),!1}function ai(a1){var a2="INSERT INTO "+cg+" (digest, seq) VALUES (?,?)",a3=[X._attachments[a1].digest,ar];p.executeSql(a2,a3,a0,a0)}var ae=0,ao=Object.keys(X._attachments||{});if(!ao.length){return at()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var X=D.data,S=Q?1:0,V=X._id,Z=X._rev,T=aS(X),U="INSERT INTO "+dW+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",W=[V,Z,T,S];p.executeSql(U,W,function(an,ai){var ae=ai.insertId;Y(ae,function(){E(an,ae)})},function(){var ae=dL("seq",dW,null,"doc_id=? AND rev=?");return p.executeSql(ae,[V,Z],function(ai,an){var ao=an.rows.item(0).seq,ar="UPDATE "+dW+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[T,S,V,Z];ai.executeSql(ar,at,function(a0){Y(ao,function(){E(a0,ao)})})}),!1})}function R(S){P||(S?(P=S,K(P)):J===H.length&&F())}function M(S){J++,R(S)}function E(V,U){var X=D.metadata.id,W=D.stemmedRevs||[];O&&g.auto_compaction&&(W=cE(D.metadata).concat(W)),W.length&&b4(W,X,V),D.metadata.seq=U,delete D.metadata.rev;var Y=O?"UPDATE "+cW+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+dW+" WHERE doc_id="+cW+".id AND rev=?) WHERE id=?":"INSERT INTO "+cW+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",S=dj(D.metadata),T=O?[S,U,L,X]:[X,U,U,S];V.executeSql(Y,T,function(){A[N]={ok:!0,id:D.metadata.id,rev:L},w.set(X,D.metadata),K()})}var P=null,J=0;D.data._id=D.metadata.id,D.data._rev=D.metadata.rev;var H=Object.keys(D.data._attachments||{});Q&&(D.data._deleted=!0),H.forEach(function(U){var S=D.data._attachments[U];if(S.stub){J++,R()}else{var T=S.data;delete S.data,S.revpos=parseInt(L,10);var V=S.digest;C(V,T,M)}}),H.length||F()}function h(){al(u.revs_limit,o,g,w,p,A,s,k)}function m(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&fN(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+cW+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=bu(I.rows.item(0).json);w.set(H,K)}D()})})}function C(F,D,G){var E="SELECT digest FROM "+cT+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+cT+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,cR(D)],function(){G()},function(){return G(),!1}))})}var z=k.new_edits,l=B.docs,o=l.map(function(E){if(E._id&&fN(E._id)){return E}var D=eG(E,z);return D}),j=o.filter(function(D){return D.error});if(j.length){return x(j[0])}var p,r,A=new Array(o.length),w=new dO.Map;jV(o,"binary",function(D){return D?x(D):void i.transaction(function(E){p=E,v(function(F){F?r=F:m(h)})},kf(x),n)})}function fF(g){return g.websql(g.name,g.version,g.description,g.size)}function cB(h){try{return{db:fF(h)}}catch(g){return{error:g}}}function aF(h){var g=dQ.get(h.name);return g||(g=cB(h),dQ.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function jJ(n,h,m,k,l){function g(){++o===j.length&&l&&l()}function i(q,s){var r=q._attachments[s],p={binary:h.binary,ctx:k};m._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=ah.extend(ed(r,["digest","content_type"]),{data:v}),g()})}var j=Object.keys(n._attachments||{});if(!j.length){return l&&l()}var o=0;j.forEach(function(p){h.attachments&&h.include_docs?i(n,p):(n._attachments[p].stub=!0,g())})}function bi(v,g){function C(){e4()&&(window.localStorage["_pouch__websqldb_"+w._name]=!0),g(null,w)}function h(F,E){F.executeSql(j4),F.executeSql("ALTER TABLE "+dW+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(a8),F.executeSql("ALTER TABLE "+cW+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+cW+" (local, id)");var G="SELECT "+cW+".winningseq AS seq, "+cW+".json AS metadata FROM "+dW+" JOIN "+cW+" ON "+dW+".seq = "+cW+".winningseq";F.executeSql(G,[],function(I,M){for(var H=[],K=[],L=0;L<M.rows.length;L++){var N=M.rows.item(L),O=N.seq,J=JSON.parse(N.metadata);e8(J)&&H.push(O),fN(J.id)&&K.push(J.id)}I.executeSql("UPDATE "+cW+"SET local = 1 WHERE id IN "+cQ(K.length),K,function(){I.executeSql("UPDATE "+dW+" SET deleted = 1 WHERE seq IN "+cQ(H.length),H,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+ax+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+cW+".id AS id, "+dW+".json AS data FROM "+dW+" JOIN "+cW+" ON "+dW+".seq = "+cW+".winningseq WHERE local = 1";F.executeSql(H,[],function(I,K){function M(){if(!J.length){return E(I)}var O=J.shift(),N=JSON.parse(O.data)._rev;I.executeSql("INSERT INTO "+ax+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+cW+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+dW+" WHERE seq=?",[O.seq],function(){M()})})})}for(var J=[],L=0;L<K.rows.length;L++){J.push(K.rows.item(L))}M()})})}function m(G,E){function H(J){function I(){if(!J.length){return E(G)}var L=J.shift(),P=bh(L.hex,y),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+dW+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){I()})}I()}var F="ALTER TABLE "+dW+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+dW+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(ak,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+dW;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function B(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+cT;I.executeSql(J,[],function(K,M){function P(){var Q=dL(ej+", "+cW+".id AS id",[cW,dW],aH,null,cW+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,W){function R(at,ar){var ao=Z[at]=Z[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!W.rows.length){return E(ai)}for(var Z={},T=0;T<W.rows.length;T++){for(var V=W.rows.item(T),U=cK(V.data,V.id,V.rev),an=Object.keys(U._attachments||{}),S=0;S<an.length;S++){var X=U._attachments[an[S]];R(X.digest,V.seq)}}var ae=[];if(Object.keys(Z).forEach(function(ar){var ao=Z[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return P()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+cg+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+cg+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(ab,[],function(J){J.executeSql(cv,[],H)})})}function l(F,E){var G="ALTER TABLE "+cT+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+cW+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+cW+" SET max_seq=(SELECT MAX(seq) FROM "+dW+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+cW+" (max_seq)";J.executeSql(K,[],E)})})}function s(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;y=2===H.length?"UTF-8":"UTF-16",E()})}function x(){for(;i.length>0;){var E=i.pop();E(null,o)}}function D(E,M){if(0===M){var J="CREATE TABLE IF NOT EXISTS "+el+" (dbid, db_version INTEGER)",G="CREATE TABLE IF NOT EXISTS "+cT+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",P="CREATE TABLE IF NOT EXISTS "+cg+" (digest, seq INTEGER)",N="CREATE TABLE IF NOT EXISTS "+cW+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",O="CREATE TABLE IF NOT EXISTS "+dW+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",I="CREATE TABLE IF NOT EXISTS "+ax+" (id UNIQUE, rev, json)";E.executeSql(G),E.executeSql(I),E.executeSql(P,[],function(){E.executeSql(cv),E.executeSql(ab)}),E.executeSql(N,[],function(){E.executeSql(j4),E.executeSql(O,[],function(){E.executeSql(a8),E.executeSql(ak),E.executeSql(J,[],function(){var R="INSERT INTO "+el+" (db_version, dbid) VALUES (?,?)";o=aL();var Q=[bj,o];E.executeSql(R,Q,function(){x()})})})})}else{var K=function(){var Q=bj>M;Q&&E.executeSql("UPDATE "+el+" SET db_version = "+bj);var R="SELECT dbid FROM "+el;E.executeSql(R,[],function(T,S){o=S.rows.item(0).dbid,x()})},H=[h,p,m,B,l,r,K],F=M,L=function(Q){H[F-1](Q,L),F++};L(E)}}function k(){u.transaction(function(E){s(E,function(){A(E)})},kf(g),C)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+el;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+el,[],function(J,I){var K=I.rows.item(0).db_version;D(J,K)}):H.executeSql("ALTER TABLE "+el+" ADD COLUMN db_version INTEGER",[],function(){D(H,1)}):D(H,0)})}function n(F,E){if(-1!==w._docCount){return E(w._docCount)}var G=dL("COUNT("+cW+".id) AS 'num'",[cW,dW],aH,dW+".deleted=0");F.executeSql(G,[],function(I,H){w._docCount=H.rows.item(0).num,E(w._docCount)})}var y,w=this,o=null,j=dX(v),i=[];w._docCount=-1,w._name=v.name;var q=ah.extend({},v,{version:dx,description:v.name,size:j}),z=aF(q);if(z.error){return kf(g)(z.error)}var u=z.db;"function"!=typeof u.readTransaction&&(u.readTransaction=u.transaction),k(),w.type=function(){return"websql"},w._id=eB(function(E){E(null,o)}),w._info=function(E){u.readTransaction(function(F){n(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+dW;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:u._sqlitePlugin,websql_encoding:y})})})},kf(E))},w._bulkDocs=function(E,G,F){bY(v,E,G,w,u,jQ,F)},w._get=function(H,I,F){function M(){F(K,{doc:N,metadata:G,ctx:E})}var N,G,K,E=I.ctx;if(!E){return u.readTransaction(function(O){w._get(H,ah.extend({ctx:O},I),F)})}var L,J;I.rev?(L=dL(ej,[cW,dW],cW+".id="+dW+".doc_id",[dW+".doc_id=?",dW+".rev=?"]),J=[H,I.rev]):(L=dL(ej,[cW,dW],aH,cW+".id=?"),J=[H]),E.executeSql(L,J,function(O,P){if(!P.rows.length){return K=ch(cf,"missing"),M()}var Q=P.rows.item(0);return G=bu(Q.metadata),Q.deleted&&!I.rev?(K=ch(cf,"deleted"),M()):(N=cK(Q.data,G.id,Q.rev),void M())})},w._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(cW+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(cW+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(cW+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(cW+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(dW+".deleted = 0"),u.readTransaction(function(S){n(S,function(U){if(P=U,0!==N){var T=dL(ej,[cW,dW],aH,J,cW+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(Z,ao){for(var an=0,W=ao.rows.length;W>an;an++){var Y=ao.rows.item(an),ai=bu(Y.metadata),V=ai.id,X=cK(Y.data,V,Y.rev),ar=X._rev,ae={id:V,key:V,value:{rev:ar}};if(E.include_docs&&(ae.doc=X,ae.doc._rev=ar,E.conflicts&&(ae.doc._conflicts=fB(ai)),jJ(ae.doc,E,w,Z)),Y.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},kf(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},w._changes=function(E){function F(){var S=cW+".json AS metadata, "+cW+".max_seq AS maxSeq, "+dW+".json AS winningDoc, "+dW+".rev AS winningRev ",T=cW+" JOIN "+dW,R=cW+".id="+dW+".doc_id AND "+cW+".winningseq="+dW+".seq",Q=["maxSeq > ?"],O=[E.since];E.doc_ids&&(Q.push(cW+".id IN "+cQ(E.doc_ids.length)),O=O.concat(E.doc_ids));var U="maxSeq "+(J?"DESC":"ASC"),N=dL(S,T,R,Q,U),M=j8(E);E.view||E.filter||(N+=" LIMIT "+G);var P=E.since||0;u.readTransaction(function(V){V.executeSql(N,O,function(ai,an){function Z(a0){return function(){E.onChange(a0)}}for(var at=0,ar=an.rows.length;ar>at;at++){var ao=an.rows.item(at),W=bu(ao.metadata);P=ao.maxSeq;var ae=cK(ao.winningDoc,W.id,ao.winningRev),Y=E.processChange(ae,W,E);Y.seq=ao.maxSeq;var X=M(Y);if("object"==typeof X){return E.complete(X)}if(X&&(I++,L&&K.push(Y),E.attachments&&E.include_docs?jJ(ae,E,w,ai,Z(Y)):Z(Y)()),I===G){break}}})},kf(E.complete),function(){E.continuous||E.complete(null,{results:K,last_seq:P})})}if(E=eO(E),E.continuous){var H=w._name+":"+aL();return jQ.addListener(w._name,H,w,E),jQ.notify(w._name),{cancel:function(){jQ.removeListener(w._name,H)}}}var J=E.descending;E.since=E.since&&!J?E.since:0;var G="limit" in E?E.limit:-1;0===G&&(G=1);var L;L="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var K=[],I=0;F()},w._close=function(E){E()},w._getAttachment=function(H,I,F,M,N){var G,K=M.ctx,E=F.digest,L=F.content_type,J="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+cT+" WHERE digest=?";K.executeSql(J,[E],function(P,O){var Q=O.rows.item(0),R=Q.escaped?cH(Q.body):bh(Q.body,y);G=M.binary?aM(R,L):e6(R),N(null,G)})},w._getRevisionTree=function(F,E){u.readTransaction(function(H){var G="SELECT json AS metadata FROM "+cW+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=bu(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(ch(cf))}})})},w._doCompaction=function(F,E,G){return E.length?void u.transaction(function(H){var I="SELECT json AS metadata FROM "+cW+" WHERE id = ?";H.executeSql(I,[F],function(L,J){var K=bu(J.rows.item(0).metadata);b8(K.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var M="UPDATE "+cW+" SET json = ? WHERE id = ?";L.executeSql(M,[dj(K),F])}),b4(E,F,H)},kf(G),function(){G()}):G()},w._getLocal=function(F,E){u.readTransaction(function(H){var G="SELECT json, rev FROM "+ax+" WHERE id=?";H.executeSql(G,[F],function(L,J){if(J.rows.length){var K=J.rows.item(0),I=cK(K.json,F,K.rev);E(null,I)}else{E(ch(cf))}})})},w._putLocal=function(G,K,E){function L(N){var P,O;F?(P="UPDATE "+ax+" SET rev=?, json=? WHERE id=? AND rev=?",O=[M,J,I,F]):(P="INSERT INTO "+ax+" (id, rev, json) VALUES (?,?,?)",O=[I,M,J]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(H={ok:!0,id:I,rev:M},K.ctx&&E(null,H)):E(ch(eP))},function(){return E(ch(eP)),!1})}"function"==typeof K&&(E=K,K={}),delete G._revisions;var M,F=G._rev,I=G._id;M=F?G._rev="0-"+(parseInt(F.split("-")[1],10)+1):G._rev="0-1";var H,J=aS(G);K.ctx?L(K.ctx):u.transaction(L,kf(E),function(){H&&E(null,H)})},w._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+ax+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(ch(cf))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):u.transaction(G,kf(E),function(){I&&E(null,I)})},w._destroy=function(F,E){jQ.removeAllListeners(w._name),u.transaction(function(H){var G=[cW,dW,cT,el,ax,cg];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},kf(E),function(){e4()&&(delete window.localStorage["_pouch__websqldb_"+w._name],delete window.localStorage[w._name]),E(null,{ok:!0})})}}function b2(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function dA(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=e4(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=b2();return h&&(localStorage[g]=i?"1":"0"),i}function fQ(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:dA()}function du(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=ah.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function aA(i,g){var j=du(i),h=ah.extend({websql:j},i);bi.call(this,h,g)}function eI(g){g.adapter("websql",aA,!0)}function eM(){for(var i={},g=new ca(function(k,l){i.resolve=k,i.reject=l}),j=new Array(arguments.length),h=0;h<j.length;h++){j[h]=arguments[h]}return i.promise=g,ca.resolve().then(function(){return fetch.apply(null,j)}).then(function(k){i.resolve(k)})["catch"](function(k){i.reject(k)}),i}function kk(i,l){var g,m,j,k=new Headers,h={method:i.method,credentials:"include",headers:k};return i.json&&(k.set("Accept","application/json"),k.set("Content-Type",i.headers["Content-Type"]||"application/json")),i.body&&i.body instanceof Blob?fK(i.body,function(n){h.body=n}):i.body&&i.processData&&"string"!=typeof i.body?h.body=JSON.stringify(i.body):"body" in i?h.body=i.body:h.body=null,Object.keys(i.headers).forEach(function(n){i.headers.hasOwnProperty(n)&&k.set(n,i.headers[n])}),g=eM(i.url,h),i.timeout>0&&(m=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+i.url))},i.timeout)),g.promise.then(function(n){return j={statusCode:n.status},i.timeout>0&&clearTimeout(m),j.statusCode>=200&&j.statusCode<300?i.binary?n.blob():n.text():n.json()}).then(function(n){j.statusCode>=200&&j.statusCode<300?l(null,j,n):l(n,j)})["catch"](function(n){l(n,j)}),{abort:g.reject}}function eb(n,h){var m,k,l=!1,g=function(){m.abort()},i=function(){l=!0,m.abort()};m=n.xhr?new n.xhr:new XMLHttpRequest;try{m.open(n.method,n.url)}catch(j){h(j,{statusCode:413})}m.withCredentials="withCredentials" in n?n.withCredentials:!0,"GET"===n.method?delete n.headers["Content-Type"]:n.json&&(n.headers.Accept="application/json",n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.body&&n.processData&&"string"!=typeof n.body&&(n.body=JSON.stringify(n.body))),n.binary&&(m.responseType="arraybuffer"),"body" in n||(n.body=null);for(var o in n.headers){n.headers.hasOwnProperty(o)&&m.setRequestHeader(o,n.headers[o])}return n.timeout>0&&(k=setTimeout(i,n.timeout),m.onprogress=function(){clearTimeout(k),4!==m.readyState&&(k=setTimeout(i,n.timeout))},"undefined"!=typeof m.upload&&(m.upload.onprogress=m.onprogress)),m.onreadystatechange=function(){if(4===m.readyState){var s={statusCode:m.status};if(m.status>=200&&m.status<300){var q;q=n.binary?c5([m.response||""],{type:m.getResponseHeader("Content-Type")}):m.responseText,h(null,s,q)}else{var p={};if(l){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(m.response)}catch(r){}}h(p,s)}}},n.body&&n.body instanceof Blob?fK(n.body,function(p){m.send(p)}):m.send(n.body),{abort:g}}function aC(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function fM(h,g){return b0||h.xhr?eb(h,g):kk(h,g)}function aP(){return""}function ad(k,i){function h(l,o,m){if(!k.binary&&k.json&&"string"==typeof l){try{l=JSON.parse(l)}catch(n){return m(n)}}Array.isArray(l)&&(l=l.map(function(p){return p.error||p.missing?bq(p):p})),k.binary&&a9(l,o),m(null,l,o)}function j(o,m){var q,n;if(o.code&&o.status){var p=new Error(o.message||o.code);return p.status=o.status,m(p)}if(o.message&&"ETIMEDOUT"===o.message){return m(o)}try{q=JSON.parse(o.responseText),n=bq(q)}catch(l){n=bq(o)}m(n)}k=eO(k);var g={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return k=ah.extend(g,k),k.json&&(k.binary||(k.headers.Accept="application/json"),k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json"),k.binary&&(k.encoding=null,k.json=!1),k.processData||(k.json=!1),fM(k,function(o,l,q){if(o){return o.status=l?l.statusCode:400,j(o,i)}var m,r=l.headers&&l.headers["content-type"],p=q||aP();if(!k.binary&&(k.json||!k.processData)&&"object"!=typeof p&&(/json/.test(r)||/^[\s]*\{/.test(p)&&/\}[\s]*$/.test(p))){try{p=JSON.parse(p.toString())}catch(n){}}l.statusCode>=200&&l.statusCode<300?h(p,l,i):(m=bq(p),m.status=l.statusCode,i(m))})}function eL(i,k){var g=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m=-1!==g.indexOf("safari")&&-1===g.indexOf("chrome"),o=-1!==g.indexOf("msie"),h=-1!==g.indexOf("edge"),j=m||(o||h)&&"GET"===i.method,l="cache" in i?i.cache:!0,p=/^blob:/.test(i.url);if(!p&&(j||!l)){var n=-1!==i.url.indexOf("?");i.url+=(n?"&":"?")+"_nonce="+Date.now()}return ad(i,k)}function eV(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=cZ(j.data,j.content_type)})}function bI(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function dH(g){return g._attachments&&Object.keys(g._attachments)?ca.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new ca(function(j){dz(i.data,j)}).then(function(j){i.data=j}):void 0})):ca.resolve()}function em(h){var g=cw(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function cb(h,g){return j3(h,h.db+"/"+g)}function j3(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function fP(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function dU(o,r){function p(A,y,B){var z=A.ajax||{},x=ah.extend(eO(l),z,y);return fA(x.method+" "+x.url),w._ajax(x,B)}function k(x,y){return new ca(function(z,A){p(x,y,function(C,B){return C?A(C):void z(B)})})}function j(x,y){return bc(x,da(function(z){v().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(o.skipSetup||o.skip_setup){return ca.resolve()}if(s){return s}var x={method:"GET",url:n};return s=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(cU(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:n})):ca.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:ca.reject(y)}),s["catch"](function(){s=null}),s}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,m=em;o.getHost&&(m=o.getHost);var u=m(o.name,o),n=cb(u,"");o=eO(o);var l=o.ajax||{};if(w.getUrl=function(){return n},w.getHeaders=function(){return l.headers||{}},o.auth||u.auth){var i=o.auth||u.auth,h=i.username+":"+i.password,g=e6(unescape(encodeURIComponent(h)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var s;setTimeout(function(){r(null,w)}),w.type=function(){return"http"},w.id=j("id",function(x){p({},{method:"GET",url:j3(u,"")},function(y,A){var z=A&&A.uuid?A.uuid+u.db:cb(u,"");x(null,z)})}),w.request=j("request",function(x,y){x.url=cb(u,x.url),p({},x,y)}),w.compact=j("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=eO(x),p(x,{url:cb(u,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),w.bulkGet=bc("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:cb(u,"_bulk_get"+fP(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function J(L){return function(M,N){F[L]=N.results,++K===H&&C(null,{results:bs(F)})}}for(var G=jS,H=Math.ceil(y.docs.length/G),K=0,F=new Array(H),E=0;H>E;E++){var I=ed(y,["revs","attachments"]);I.ajax=l,I.docs=y.docs.slice(E*G,Math.min(y.docs.length,(E+1)*G)),eK(D,I,J(E))}}var D=this,x=j3(u,""),z=bX[x];"boolean"!=typeof z?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(bX[x]=!1,cU(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{bX[x]=!0,C(null,F)}}):z?A(C):B()}),w._info=function(x){v().then(function(){p({},{method:"GET",url:cb(u,"")},function(y,z){return y?x(y):(z.host=cb(u,""),void x(null,z))})})["catch"](x)},w.get=j("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?ca.all(E.map(function(J){var H=G[J],I=bI(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:cb(u,I),binary:!0}).then(function(K){return y.binary?K:new ca(function(L){dz(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?ca.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=eO(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=bI(C);var x={method:"GET",url:cb(u,C+fP(z))};k(y,x).then(function(E){return ca.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),w.remove=j("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:cb(u,bI(C._id))+"?rev="+y},A)}),w.getAttachment=j("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=cb(u,bI(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=j("removeAttachment",function(A,y,z,B){var x=cb(u,bI(A)+"/"+q(y))+"?rev="+z;p({},{method:"DELETE",url:x},B)}),w.putAttachment=j("putAttachment",function(A,E,G,H,y,F){"function"==typeof y&&(F=y,y=H,H=G,G=null);var D=bI(A)+"/"+q(E),C=cb(u,D);if(G&&(C+="?rev="+G),"string"==typeof H){var x;try{x=cM(H)}catch(B){return F(ch(kd,"Attachment is not a valid base64 string"))}H=x?aM(x,y):""}var z={headers:{"Content-Type":y},method:"PUT",url:C,processData:!1,body:H,timeout:l.timeout||60000};p({},z,F)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,v().then(function(){return ca.all(x.docs.map(dH))}).then(function(){p(y,{method:"POST",url:cb(u,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=j("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=eO(C);var A,B={},D="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var x=fP(B);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=jL?x+="&"+z:(D="POST",A={keys:C.keys})}k(C,{method:D,url:cb(u,"_all_docs"+x),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:c7;H=eO(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var F in H.query_params){H.query_params.hasOwnProperty(F)&&(D[F]=H.query_params[F])}}var y,C="GET";if(H.doc_ids){D.filter="_doc_ids";var z=JSON.stringify(H.doc_ids);z.length<jL?D.doc_ids=z:(C="POST",y={doc_ids:H.doc_ids})}var K,x,I=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:C,url:cb(u,"_changes"+fP(D)),timeout:H.timeout,body:y};x=N,H.aborted||v().then(function(){K=p(H,O,M)})["catch"](M)}},G={results:[]},E=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,G.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=j8(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&G.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(x=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,G):setTimeout(function(){I(x,E)},0)}};return I(H.since||0,E),{cancel:function(){H.aborted=!0,K&&K.abort()}}},w.revsDiff=j("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:cb(u,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(x,y){p(x,{url:cb(u,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function jP(g){g.adapter("http",dU,!1),g.adapter("https",dU,!1)}function e2(){this.promise=new ca(function(g){g()})}function jU(g){var h=g.db,m=g.viewName,i=g.map,k=g.reduce,l=g.temporary,j=i.toString()+(k&&k.toString())+"undefined";if(!l&&h._cachedViews){var n=h._cachedViews[j];if(n){return ca.resolve(n)}}return h.info().then(function(p){function o(u){u.views=u.views||{};var r=m;-1===r.indexOf("/")&&(r=m+"/"+m);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(l?"temp":ay(j));return aB(h,"_local/mrviews",o).then(function(){return h.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:h,adapter:h.adapter,mapFun:i,reduceFun:k};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,l||(h._cachedViews=h._cachedViews||{},h._cachedViews[j]=r,r.db.once("destroyed",function(){delete h._cachedViews[j]})),r})})})})}function kb(l,j,i,k,h,g){return dm("return ("+l.replace(/;\s*$/,"")+");",{emit:j,sum:i,log:k,isArray:h,toJSON:g})}function fJ(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function dh(g){return 1===g.length&&/^1-/.test(g[0].rev)}function ka(h,g){try{h.emit("error",g)}catch(i){dk("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),dk("error",g)}}function cV(i,g,j){try{return{output:g.apply(null,j)}}catch(h){return ka(i,h),{error:h}}}function dD(h,g){var i=jO.collate(h.key,g.key);return 0!==i?i:jO.collate(h.value,g.value)}function km(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function f8(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function aI(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=cZ(k.data,k.content_type)})})}function au(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&aI(h),h}}function c1(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new cl(g)}function eF(g){for(var h=0,m=0,i=g.length;i>m;m++){var k=g[m];if("number"!=typeof k){if(!Array.isArray(k)){throw c1("_sum")}h="number"==typeof h?[h]:h;for(var l=0,j=k.length;j>l;l++){var n=k[l];if("number"!=typeof n){throw c1("_sum")}"undefined"==typeof h[l]?h.push(n):h[l]+=n}}else{"number"==typeof h?h+=k:h[0]+=k}}return h}function j2(k,i,h,j){var g=i[k];"undefined"!=typeof g&&(j&&(g=encodeURIComponent(JSON.stringify(g))),h.push(k+"="+g))}function cd(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function c4(g){return g.group_level=cd(g.group_level),g.limit=cd(g.limit),g.skip=cd(g.skip),g}function jI(g){if(g){if("number"!=typeof g){return new ec('Invalid value for integer: "'+g+'"')}if(0>g){return new ec('Invalid value for positive integer: "'+g+'"')}}}function dI(i,g){var j=i.descending?"endkey":"startkey",h=i.descending?"startkey":"endkey";if("undefined"!=typeof i[j]&&"undefined"!=typeof i[h]&&jO.collate(i[j],i[h])>0){throw new ec("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(g.reduce&&i.reduce!==!1){if(i.include_docs){throw new ec("{include_docs:true} is invalid for reduce")}if(i.keys&&i.keys.length>1&&!i.group&&!i.group_level){throw new ec("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=jI(i[k]);if(l){throw l}})}function jF(n,h,m){var k,l=[],g="GET";if(j2("reduce",m,l),j2("include_docs",m,l),j2("attachments",m,l),j2("limit",m,l),j2("descending",m,l),j2("group",m,l),j2("group_level",m,l),j2("skip",m,l),j2("stale",m,l),j2("conflicts",m,l),j2("startkey",m,l,!0),j2("start_key",m,l,!0),j2("endkey",m,l,!0),j2("end_key",m,l,!0),j2("inclusive_end",m,l),j2("key",m,l,!0),l=l.join("&"),l=""===l?"":"?"+l,"undefined"!=typeof m.keys){var i=2000,j="keys="+encodeURIComponent(JSON.stringify(m.keys));j.length+l.length+1<=i?l+=("?"===l[0]?"&":"?")+j:(g="POST","string"==typeof h?k={keys:m.keys}:h.keys=m.keys)}if("string"==typeof h){var o=fJ(h);return n.request({method:g,url:"_design/"+o[0]+"/_view/"+o[1]+l,body:k}).then(au(m))}return k=k||{},Object.keys(h).forEach(function(p){Array.isArray(h[p])?k[p]=h[p]:k[p]=h[p].toString()}),n.request({method:"POST",url:"_temp_view"+l,body:k}).then(au(m))}function cL(h,g,i){return new ca(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function ef(g){return new ca(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function eD(g){return function(h){if(404===h.status){return g}throw h}}function cj(g,k,p){function m(){return dh(q)?ca.resolve(j):k.db.get(h)["catch"](eD(j))}function l(r){return r.keys.length?k.db.allDocs({keys:r.keys,include_docs:!0}):ca.resolve({rows:[]})}function n(v,x){for(var B=[],y={},A=0,r=x.rows.length;r>A;A++){var u=x.rows[A],z=u.doc;if(z&&(B.push(z),y[z._id]=!0,z._deleted=!i[z._id],!z._deleted)){var w=i[z._id];"value" in w&&(z.value=w.value)}}var s=Object.keys(i);return s.forEach(function(C){if(!y[C]){var E={_id:C},D=i[C];"value" in D&&(E.value=D.value),B.push(E)}}),v.keys=bL(s.concat(v.keys)),B.push(v),B}var h="_local/doc_"+g,j={_id:h,keys:[]},o=p[g],i=o.indexableKeysToKeyValues,q=o.changes;return m().then(function(r){return l(r).then(function(s){return n(r,s)})})}function c0(i,g,j){var h="_local/lastSeq";return i.db.get(h)["catch"](eD({_id:h,seq:0})).then(function(k){var l=Object.keys(g);return ca.all(l.map(function(m){return cj(m,i,g)})).then(function(m){var n=bs(m);return k.seq=j,n.push(k),i.db.bulkDocs({docs:n})})})}function bb(h){var g="string"==typeof h?h:h.name,i=cN[g];return i||(i=cN[g]=new e2),i}function cY(g){return f0(bb(g),function(){return dR(g)})()}function dR(n){function h(p,r){var q={id:l._id,key:jO.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=jO.normalizeKey(r)),k.push(q)}function m(q,p){return function(){return c0(n,q,p)}}var k,l,g;if("function"==typeof n.mapFun&&2===n.mapFun.length){var i=n.mapFun;g=function(p){return i(p,h)}}else{g=kb(n.mapFun.toString(),h,eF,bx,Array.isArray,JSON.parse)}var j=n.seq||0,o=new e2;return new ca(function(p,s){function r(){o.finish().then(function(){n.seq=j,p()})}function q(){function u(v){s(v)}n.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:j,limit:jK}).on("complete",function(A){var v=A.results;if(!v.length){return r()}for(var w={},F=0,C=v.length;C>F;F++){var x=v[F];if("_"!==x.doc._id[0]){k=[],l=x.doc,l._deleted||cV(n.sourceDB,g,[l]),k.sort(dD);for(var H,z={},D=0,B=k.length;B>D;D++){var E=k[D],G=[E.key,E.id];0===jO.collate(E.key,H)&&G.push(D);var y=jO.toIndexableString(G);z[y]=E,H=E.key}w[x.doc._id]={indexableKeysToKeyValues:z,changes:x.changes}}j=x.seq}return o.add(m(w,j)),v.length<jK?r():q()}).on("error",u)}q()})}function eq(g,k,p){0===p.group_level&&delete p.group_level;var m,l=p.group||p.group_level;m=f2[g.reduceFun]?f2[g.reduceFun]:kb(g.reduceFun.toString(),null,eF,bx,Array.isArray,JSON.parse);var n=[],h=isNaN(p.group_level)?Number.POSITIVE_INFINITY:p.group_level;k.forEach(function(r){var u=n[n.length-1],s=l?r.key:null;return l&&Array.isArray(s)&&(s=s.slice(0,h)),u&&0===jO.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void n.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),k=[];for(var j=0,o=n.length;o>j;j++){var i=n[j],q=cV(g.sourceDB,m,[i.keys,i.values,!1]);if(q.error&&q.error instanceof cl){throw q.error}k.push({value:q.error?null:q.output,key:i.groupKey})}return{rows:km(k,p.limit,p.skip)}}function cc(h,g){return f0(bb(h),function(){return kg(h,g)})()}function kg(r,j){function m(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return l=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=jO.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function k(u){var w;if(w=o?eq(r,u,j):{total_rows:l,offset:h,rows:u},j.include_docs){var v=bL(u.map(f8));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:j.conflicts,attachments:j.attachments,binary:j.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),u.forEach(function(A){var B=f8(A),z=y["$"+B];z&&(A.doc=z)}),w})}return w}var l,o=r.reduceFun&&j.reduce!==!1,h=j.skip||0;if("undefined"==typeof j.keys||j.keys.length||(j.limit=0,delete j.keys),"undefined"!=typeof j.keys){var p=j.keys,i=p.map(function(v){var u={startkey:jO.toIndexableString([v]),endkey:jO.toIndexableString([v,{}])};return m(u)});return ca.all(i).then(bs).then(k)}var g={descending:j.descending};if(j.start_key&&(j.startkey=j.start_key),j.end_key&&(j.endkey=j.end_key),"undefined"!=typeof j.startkey&&(g.startkey=j.descending?jO.toIndexableString([j.startkey,{}]):jO.toIndexableString([j.startkey])),"undefined"!=typeof j.endkey){var q=j.inclusive_end!==!1;j.descending&&(q=!q),g.endkey=jO.toIndexableString(q?[j.endkey,{}]:[j.endkey])}if("undefined"!=typeof j.key){var n=jO.toIndexableString([j.key]),s=jO.toIndexableString([j.key,{}]);g.descending?(g.endkey=n,g.startkey=s):(g.startkey=n,g.endkey=s)}return o||("number"==typeof j.limit&&(g.limit=j.limit),g.skip=h),m(g).then(k)}function jH(g){return g.request({method:"POST",url:"_view_cleanup"})}function bO(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(m){var k=fJ(m),l="_design/"+k[0],n=k[1];j[l]=j[l]||{},j[l][n]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(m){var n={};m.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){n[v]=n[v]||s})})});var l=Object.keys(n).filter(function(o){return !n[o]}),k=l.map(function(o){return f0(bb(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return ca.all(k).then(function(){return{ok:!0}})})},eD({ok:!0}))}function fC(k,n,g){if("http"===k.type()){return jF(k,n,g)}if("function"==typeof k._query){return cL(k,n,g)}if("string"!=typeof n){dI(g,n);var m={db:k,viewName:"temp_view/temp_view",map:n.map,reduce:n.reduce,temporary:!0};return aN.add(function(){return jU(m).then(function(o){function p(){return o.db.destroy()}return b3(cY(o).then(function(){return cc(o,g)}),p)})}),aN.finish()}var h=n,j=fJ(h),i=j[0],l=j[1];return k.get("_design/"+i).then(function(o){var p=o.views&&o.views[l];if(!p||"string"!=typeof p.map){throw new bm("ddoc "+i+" has no view named "+l)}dI(g,p);var q={db:k,viewName:h,map:p.map,reduce:p.reduce};return jU(q).then(function(r){return"ok"===g.stale||"update_after"===g.stale?("update_after"===g.stale&&fD.nextTick(function(){cY(r)}),cc(r,g)):cY(r).then(function(){return cc(r,g)})})})}function ec(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,ec)}catch(g){}}function bm(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,bm)}catch(g){}}function cl(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,cl)}catch(g){}}function dN(g){return/^1-/.test(g)}function c6(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function j9(h,g){var i=Object.keys(g._attachments);return ca.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function b9(k,i,h){var j="http"===i.type()&&"http"!==k.type(),g=Object.keys(h._attachments);return j?k.get(h._id).then(function(l){return ca.all(g.map(function(m){return c6(l,h,m)?i.getAttachment(h._id,m):k.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return j9(i,h)}):j9(i,h)}function eW(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function f6(p,j,n,l){function o(){var r=eW(n);if(r.docs.length){return p.bulkGet(r).then(function(s){if(l.cancelled){throw new Error("cancelled")}return ca.all(s.results.map(function(u){return ca.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?b9(j,p,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){i=i.concat(bs(u).filter(Boolean))})})}}function g(r){return r._attachments&&Object.keys(r._attachments).length>0}function h(r){return p.allDocs({keys:r,include_docs:!0}).then(function(s){if(l.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&dN(u.value.rev)&&!g(u.doc)&&(i.push(u.doc),delete n[u.id])})})}function m(){var r=Object.keys(n).filter(function(s){var u=n[s].missing;return 1===u.length&&dN(u[0])});return r.length>0?h(r):void 0}function k(){return{ok:q,docs:i}}n=eO(n);var i=[],q=!0;return ca.resolve().then(m).then(o).then(k)}function jX(k,i,h,j,g){return k.get(i)["catch"](function(l){if(404===l.status){return"http"===k.type()&&cU(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:j,_id:i,history:[],replicator:dK,version:az}}throw l}).then(function(l){return g.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==j}),l.history.unshift({last_seq:h,session_id:j}),l.history=l.history.slice(0,bp),l.version=az,l.replicator=dK,l.session_id=j,l.last_seq=h,k.put(l)["catch"](function(m){if(409===m.status){return jX(k,i,h,j,g)}throw m}))})}function eT(i,g,j,h){this.src=i,this.target=g,this.id=j,this.returnValue=h}function b6(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:cC(h.history,g.history)}function cC(g,h){var m=g[0],i=g.slice(1),k=h[0],l=h.slice(1);if(!m||0===h.length){return{last_seq:d7,history:[]}}var j=m.session_id;if(dS(j,h)){return{last_seq:m.last_seq,history:g}}var n=k.session_id;return dS(n,i)?{last_seq:k.last_seq,history:l}:cC(i,l)}function dS(i,g){var j=g[0],h=g.slice(1);return i&&0!==g.length?i===j.session_id?!0:dS(i,h):!1}function kj(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function kl(i,g,j,h){return i.retry===!1?(g.emit("error",j),void g.removeAllListeners()):("function"!=typeof i.back_off_function&&(i.back_off_function=bB),g.emit("requestError",j),"active"!==g.state&&"pending"!==g.state||(g.emit("paused",j),g.state="stopped",g.once("active",function(){i.current_back_off=j5})),i.current_back_off=i.current_back_off||j5,i.current_back_off=i.back_off_function(i.current_back_off),void setTimeout(h,i.current_back_off))}function eN(g){return Object.keys(g).sort(jO.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function fR(i,l,g){var m=g.doc_ids?g.doc_ids.sort(jO.collate):"",j=g.filter?g.filter.toString():"",k="",h="";return g.filter&&g.query_params&&(k=JSON.stringify(eN(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),ca.all([i.id(),l.id()]).then(function(n){var o=n[0]+n[1]+j+h+k+m;return new ca(function(p){jG(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function cJ(J,g,s,n,r){function z(){return F?ca.resolve():fR(J,g,s).then(function(T){Q=T,F=new eT(J,g,Q,n)})}function m(){if(k=[],0!==H.docs.length){var T=H.docs;return g.bulkDocs({docs:T,new_edits:!1}).then(function(Y){if(n.cancelled){throw q(),new Error("cancelled")}var V=[],X={};Y.forEach(function(Z){Z.error&&(r.doc_write_failures++,V.push(Z),X[Z.id]=Z)}),I=I.concat(V),r.docs_written+=H.docs.length-V.length;var W=V.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=X[Z._id];ae?n.emit("denied",eO(ae)):k.push(Z)}),W.length>0){var U=new Error("bulkDocs error");throw U.other_errors=V,A("target.bulkDocs failed to write docs",U),new Error("bulkWrite partial failure")}},function(U){throw r.doc_write_failures+=T.length,U})}}function h(){if(H.error){throw new Error("There was a problem getting docs.")}r.last_seq=y=H.seq;var T=eO(r);return k.length&&(T.docs=k,n.emit("change",T)),C=!0,F.writeCheckpoint(H.seq,K).then(function(){if(C=!1,n.cancelled){throw q(),new Error("cancelled")}H=void 0,v()})["catch"](R)}function M(){var T={};return H.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),g.revsDiff(T).then(function(U){if(n.cancelled){throw q(),new Error("cancelled")}H.diffs=U})}function E(){return f6(J,g,H.diffs,n).then(function(T){H.error=!T.ok,T.docs.forEach(function(U){delete H.diffs[U._id],r.docs_read++,H.docs.push(U)})})}function w(){if(!n.cancelled&&!H){if(0===x.length){return void O(!0)}H=x.shift(),M().then(E).then(m).then(h).then(w)["catch"](function(T){A("batch processing terminated with error",T)})}}function O(T){return 0===p.changes.length?void (0!==x.length||H||((j&&u.live||l)&&(n.state="pending",n.emit("paused")),l&&q())):void ((T||l||p.changes.length>=N)&&(x.push(p),p={seq:0,changes:[],docs:[]},"pending"!==n.state&&"stopped"!==n.state||(n.state="active",n.emit("active")),w()))}function A(U,T){D||(T.message||(T.message=U),r.ok=!1,r.status="aborting",r.errors.push(T),I=I.concat(T),x=[],p={seq:0,changes:[],docs:[]},q())}function q(){if(!(D||n.cancelled&&(r.status="cancelled",C))){r.status=r.status||"complete",r.end_time=new Date,r.last_seq=y,D=!0;var U=I.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=I.pop();I.length>0&&(T.other_errors=I),T.result=r,kl(s,n,T,function(){cJ(J,g,s,n)})}else{r.errors=I,n.emit("complete",r),n.removeAllListeners()}}}function L(U){if(n.cancelled){return q()}var T=j8(s)(U);T&&(p.seq=U.seq,p.changes.push(U),O(0===x.length&&u.live))}function S(U){if(i=!1,n.cancelled){return q()}if(U.results.length>0){u.since=U.last_seq,v(),O(!0)}else{var T=function(){j?(u.live=!0,v()):l=!0,O(!0)};H||0!==U.results.length?T():(C=!0,F.writeCheckpoint(U.last_seq,K).then(function(){C=!1,r.last_seq=y=U.last_seq,T()})["catch"](R))}}function o(T){return i=!1,n.cancelled?q():void A("changes rejected",T)}function v(){function U(){T.cancel()}function V(){n.removeListener("cancel",U)}if(!i&&!l&&x.length<P){i=!0,n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",U);var T=J.changes(u).on("change",L);T.then(V,V),T.then(S)["catch"](o),s.retry&&(n._changes=T,n._abortChanges=U)}}function B(){z().then(function(){return n.cancelled?void q():F.getCheckpoint().then(function(T){y=T,u={since:y,limit:N,batch_size:N,style:"all_docs",doc_ids:G,return_docs:!0},s.filter&&("string"!=typeof s.filter?u.include_docs=!0:u.filter=s.filter),"heartbeat" in s&&(u.heartbeat=s.heartbeat),"timeout" in s&&(u.timeout=s.timeout),s.query_params&&(u.query_params=s.query_params),s.view&&(u.view=s.view),v()})})["catch"](function(T){A("getCheckpoint rejected with ",T)})}function R(T){throw C=!1,A("writeCheckpoint completed with error",T),T}var H,Q,F,x=[],p={seq:0,changes:[],docs:[]},C=!1,l=!1,D=!1,y=0,j=s.continuous||s.live||!1,N=s.batch_size||100,P=s.batches_limit||10,i=!1,G=s.doc_ids,I=[],k=[],K=aL();r=r||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var u={};return n.ready(J,g),n.cancelled?void q():(n._addedListeners||(n.once("cancel",q),"function"==typeof s.complete&&(n.once("error",s.complete),n.once("complete",function(T){s.complete(null,T)})),n._addedListeners=!0),void ("undefined"==typeof s.since?B():z().then(function(){return C=!0,F.writeCheckpoint(s.since,K)}).then(function(){return C=!1,n.cancelled?void q():(y=s.since,void B())})["catch"](R)))}function aZ(){cx.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new ca(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function dq(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function bQ(i,l,g,m){if("function"==typeof g&&(m=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw ch(ea,"`doc_ids` filter parameter is not a list.")}g.complete=m,g=eO(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var j=new aZ(g),k=dq(i,g),h=dq(l,g);return cJ(k,h,g,j),j}function d0(i,g,j,h){return"function"==typeof j&&(h=j,j={}),"undefined"==typeof j&&(j={}),j=eO(j),j.PouchConstructor=j.PouchConstructor||this,i=dq(i,j),g=dq(g,j),new cz(i,g,j,h)}function cz(o,w,x,q){function v(z){m.emit("change",{direction:"pull",change:z})}function l(z){m.emit("change",{direction:"push",change:z})}function u(z){m.emit("denied",{direction:"push",doc:z})}function y(z){m.emit("denied",{direction:"pull",doc:z})}function i(){m.pushPaused=!0,m.pullPaused&&m.emit("paused")}function r(){m.pullPaused=!0,m.pushPaused&&m.emit("paused")}function n(){m.pushPaused=!1,m.pullPaused&&m.emit("active",{direction:"push"})}function k(){m.pullPaused=!1,m.pushPaused&&m.emit("active",{direction:"pull"})}function p(z){return function(D,B){var C="change"===D&&(B===v||B===l),F="denied"===D&&(B===y||B===u),A="paused"===D&&(B===r||B===i),E="active"===D&&(B===k||B===n);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&m.removeAllListeners(D))}}var m=this;this.canceled=!1;var s=x.push?ah.extend({},x,x.push):x,h=x.pull?ah.extend({},x,x.pull):x;this.push=bQ(o,w,s),this.pull=bQ(w,o,h),this.pushPaused=!0,this.pullPaused=!0;var g={};x.live&&(this.push.on("complete",m.pull.cancel.bind(m.pull)),this.pull.on("complete",m.push.cancel.bind(m.push))),this.on("newListener",function(z){"change"===z?(m.pull.on("change",v),m.push.on("change",l)):"denied"===z?(m.pull.on("denied",y),m.push.on("denied",u)):"active"===z?(m.pull.on("active",k),m.push.on("active",n)):"paused"===z&&(m.pull.on("paused",r),m.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(m.pull.removeListener("change",v),m.push.removeListener("change",l)):"denied"===z?(m.pull.removeListener("denied",y),m.push.removeListener("denied",u)):"active"===z?(m.pull.removeListener("active",k),m.push.removeListener("active",n)):"paused"===z&&(m.pull.removeListener("paused",r),m.push.removeListener("paused",i))}),this.pull.on("removeListener",p("pull")),this.push.on("removeListener",p("push"));var j=ca.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return m.emit("complete",z),q&&q(null,z),m.removeAllListeners(),z},function(z){if(m.cancel(),q?q(z):m.emit("error",z),m.removeAllListeners(),q){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function dc(g){g.replicate=bQ,g.sync=d0}var eZ,ah=d(9),c8=cP(d(5)),aK=cP(d(8)),by=cP(d(10)),dO=d(14),da=cP(d(4)),cx=d(1),dm=cP(d(15)),dJ=cP(d(16)),bz=cP(d(17)),jO=d(12),ca="function"==typeof Promise?Promise:by,f7=Function.prototype.toString,cS=f7.call(Object),fG=c8("pouchdb:api"),bv=6;if(bV()){eZ=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),eZ=!!localStorage.getItem("_pouch_check_localstorage")}catch(d4){eZ=!1}}aK(aQ,cx.EventEmitter),aQ.prototype.addListener=function(i,l,g,m){function j(){function n(){h=!1}if(k._listeners[l]){if(h){return void (h="waiting")}h=!0;var o=ed(m,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>m.since&&!m.cancelled&&(m.since=p.seq,m.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){j()},0),h=!1}).on("error",n)}}if(!this._listeners[l]){var k=this,h=!1;this._listeners[l]=j,this.on(i,j)}},aQ.prototype.removeListener=function(h,g){g in this._listeners&&cx.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},aQ.prototype.notifyLocalWindows=function(g){bV()?chrome.storage.local.set({dbName:g}):e4()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},aQ.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},aK(dE,Error),dE.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var d5=new dE({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),bw=new dE({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),cf=new dE({status:404,error:"not_found",reason:"missing"}),eP=new dE({status:409,error:"conflict",reason:"Document update conflict"}),bA=new dE({status:400,error:"invalid_id",reason:"_id field must contain a string"}),bE=new dE({status:412,error:"missing_id",reason:"_id is required for puts"}),fO=new dE({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),cs=new dE({status:412,error:"precondition_failed",reason:"Database not open"}),dP=new dE({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),kd=new dE({status:500,error:"badarg",reason:"Some query argument is invalid"}),dV=new dE({status:400,error:"invalid_request",reason:"Request was invalid"}),e9=new dE({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),kh=new dE({status:500,error:"doc_validation",reason:"Bad special document member"}),ea=new dE({status:400,error:"bad_request",reason:"Something wrong with the request"}),eQ=new dE({status:400,error:"bad_request",reason:"Document must be a JSON object"}),ba=new dE({status:404,error:"not_found",reason:"Database not found"}),cu=new dE({status:500,error:"indexed_db_went_bad",reason:"unknown"}),d1=new dE({status:500,error:"web_sql_went_bad",reason:"unknown"}),c2=new dE({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),f9=new dE({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),eH=new dE({status:400,error:"bad_request",reason:"Invalid rev format"}),bF=new dE({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),cG=new dE({status:412,error:"missing_stub"}),bW=new dE({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),fL=[d5,bw,cf,eP,bA,bE,fO,cs,dP,kd,dV,e9,kh,ea,eQ,ba,d1,c2,f9,eH,bF,cG,cu,bW],dF=function(i,g,j){var h=fL.filter(function(k){return k[i]===g});return j&&h.filter(function(k){return k.message===j})[0]||h[0]},aX=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],cD="queryKey",fI=/(?:^|&)([^&=]*)=?([^&]*)/g,eJ=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ck="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");aK(dY,cx.EventEmitter),dY.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},dY.prototype.doChanges=function(k){var i=this,h=k.complete;if(k=eO(k),"live" in k&&!("continuous" in k)&&(k.continuous=k.live),k.processChange=aY,"latest"===k.since&&(k.since="now"),k.since||(k.since=0),"now"===k.since){return void this.db.info().then(function(l){return i.isCancelled?void h(null,{status:"cancelled"}):(k.since=l.update_seq,void i.doChanges(k))},h)}if(k.continuous&&"now"!==k.since&&this.db.info().then(function(l){i.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),k.view&&!k.filter&&(k.filter="_view"),k.filter&&"string"==typeof k.filter&&("_view"===k.filter?k.view=aj(k.view):k.filter=aj(k.filter),"http"!==this.db.type()&&!k.doc_ids)){return this.filterChanges(k)}"descending" in k||(k.descending=!1),k.limit=0===k.limit?1:k.limit,k.complete=h;var j=this.db._changes(k);if(j&&"function"==typeof j.cancel){var g=i.cancel;i.cancel=da(function(l){j.cancel(),g.apply(this,l)})}},dY.prototype.filterChanges=function(l){var j=this,i=l.complete;if("_view"===l.filter){if(!l.view||"string"!=typeof l.view){var k=ch(ea,"`view` filter parameter not found or invalid.");return i(k)}var h=bP(l.view);this.db.get("_design/"+h[0],function(m,o){if(j.isCancelled){return i(null,{status:"cancelled"})}if(m){return i(bq(m))}var n=o&&o.views&&o.views[h[1]]&&o.views[h[1]].map;return n?(l.filter=c3(n),void j.doChanges(l)):i(ch(cf,o.views?"missing json key: "+h[1]:"missing json key: views"))})}else{var g=bP(l.filter);if(!g){return j.doChanges(l)}this.db.get("_design/"+g[0],function(n,o){if(j.isCancelled){return i(null,{status:"cancelled"})}if(n){return i(bq(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(l.filter=cF(m),void j.doChanges(l)):i(ch(cf,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},aK(dC,cx.EventEmitter),dC.prototype.post=bc("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(ch(eQ)):void this.bulkDocs({docs:[h]},g,fH(i))}),dC.prototype.put=bc("put",da(function(n){function h(){i||(dk("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),i=!0)}var m,k,l,g,i=!1,j=n.shift(),o="_id" in j;if("object"!=typeof j||Array.isArray(j)){return(g=n.pop())(ch(eQ))}for(;;){if(m=n.shift(),k=typeof m,"string"!==k||o?"string"!==k||!o||"_rev" in j?"object"===k?l=m:"function"===k&&(g=m):(h(),j._rev=m):(h(),j._id=m,o=!0),!n.length){break}}return l=l||{},e0(j._id),fN(j._id)&&"function"==typeof this._putLocal?j._deleted?this._removeLocal(j,g):this._putLocal(j,g):void this.bulkDocs({docs:[j]},l,fH(g))})),dC.prototype.putAttachment=bc("putAttachment",function(i,l,g,m,j){function k(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[l]={content_type:j,data:m,revpos:++n},h.put(o)}var h=this;return"function"==typeof j&&(j=m,m=g,g=null),"undefined"==typeof j&&(j=m,m=g,g=null),h.get(i).then(function(n){if(n._rev!==g){throw ch(eP)}return k(n)},function(n){if(n.reason===cf.message){return k({_id:i})}throw n})}),dC.prototype.removeAttachment=bc("removeAttachment",function(k,i,h,j){var g=this;g.get(k,function(m,l){return m?void j(m):l._rev!==h?void j(ch(eP)):l._attachments?(delete l._attachments[i],0===Object.keys(l._attachments).length&&delete l._attachments,void g.put(l,j)):j()})}),dC.prototype.remove=bc("remove",function(l,j,i,k){var h;"string"==typeof j?(h={_id:l,_rev:j},"function"==typeof i&&(k=i,i={})):(h=l,"function"==typeof j?(k=j,i={}):(k=i,i=j)),i=i||{},i.was_delete=!0;var g={_id:h._id,_rev:h._rev||i.rev};return g._deleted=!0,fN(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(h,k):void this.bulkDocs({docs:[g]},i,fH(k))}),dC.prototype.revsDiff=bc("revsDiff",function(g,h,m){function i(o,p){n.has(o)||n.set(o,{missing:[]}),n.get(o).missing.push(p)}function k(q,p){var o=g[q].slice(0);b8(p,function(r,x,w,s,v){var y=x+"-"+w,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==v.status&&i(q,y))}),o.forEach(function(r){i(q,r)})}"function"==typeof h&&(m=h,h={});var l=Object.keys(g);if(!l.length){return m(null,{})}var j=0,n=new dO.Map;l.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){n.set(o,{missing:g[o]})}else{if(q){return m(q)}k(o,p)}if(++j===l.length){var r={};return n.forEach(function(u,s){r[s]=u}),m(null,r)}})},this)}),dC.prototype.bulkGet=bc("bulkGet",function(h,g){eK(this,h,g)}),dC.prototype.compactDocument=bc("compactDocument",function(i,g,j){var h=this;this._getRevisionTree(i,function(l,o){if(l){return j(l)}var m=e1(o),k=[],n=[];Object.keys(m).forEach(function(p){m[p]>g&&k.push(p)}),b8(o,function(s,q,v,r,u){var p=q+"-"+v;"available"===u.status&&-1!==k.indexOf(p)&&n.push(p)}),h._doCompaction(i,n,j)})}),dC.prototype.compact=bc("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&jZ(i)}),dC.prototype._compact=function(i,l){function g(n){h.push(j.compactDocument(n.id,0))}function m(o){var n=o.last_seq;ca.all(h).then(function(){return aB(j,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){l(null,{ok:!0})})["catch"](l)}var j=this,k={return_docs:!1,last_seq:i.last_seq||0},h=[];j.changes(k).on("change",g).on("complete",m).on("error",l)},dC.prototype.get=bc("get",function(g,h,m){function i(){var o=[],p=k.length;return p?void k.forEach(function(q){l.get(g,{rev:q,revs:h.revs,attachments:h.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||m(null,o)})}):m(null,o)}if("function"==typeof h&&(m=h,h={}),"string"!=typeof g){return m(ch(bA))}if(fN(g)&&"function"==typeof this._getLocal){return this._getLocal(g,m)}var k=[],l=this;if(!h.open_revs){return this._get(g,h,function(p,B){if(p){return m(p)}var x=B.doc,C=B.metadata,v=B.ctx;if(h.conflicts){var w=fB(C);w.length&&(x._conflicts=w)}if(e8(C,x._rev)&&(x._deleted=!0),h.revs||h.revs_info){var r=bd(C.rev_tree),A=bK(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(x._rev.split("-")[1])}),y=A.ids.map(function(D){return D.id}).indexOf(x._rev.split("-")[1])+1,u=A.ids.length-y;if(A.ids.splice(y,u),A.ids.reverse(),h.revs&&(x._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),h.revs_info){var o=A.pos+A.ids.length;x._revs_info=A.ids.map(function(D){return o--,{rev:o+"-"+D.id,status:D.opts.status}})}}if(h.attachments&&x._attachments){var q=x._attachments,s=Object.keys(q).length;if(0===s){return m(null,x)}Object.keys(q).forEach(function(D){this._getAttachment(x._id,D,q[D],{rev:x._rev,binary:h.binary,ctx:v},function(F,G){var E=x._attachments[D];E.data=G,delete E.stub,delete E.length,--s||m(null,x)})},l)}else{if(x._attachments){for(var z in x._attachments){x._attachments.hasOwnProperty(z)&&(x._attachments[z].stub=!0)}}m(null,x)}})}if("all"===h.open_revs){this._getRevisionTree(g,function(o,p){return o?m(o):(k=aO(p).map(function(q){return q.rev}),void i())})}else{if(!Array.isArray(h.open_revs)){return m(ch(dP,"function_clause"))}k=h.open_revs;for(var j=0;j<k.length;j++){var n=k[j];if("string"!=typeof n||!/^\d+-/.test(n)){return m(ch(eH))}}i()}}),dC.prototype.getAttachment=bc("getAttachment",function(k,i,h,j){var g=this;h instanceof Function&&(j=h,h={}),this._get(k,h,function(m,l){return m?j(m):l.doc._attachments&&l.doc._attachments[i]?(h.ctx=l.ctx,h.binary=!0,g._getAttachment(k,i,l.doc._attachments[i],h,j),void 0):j(ch(cf))})}),dC.prototype.allDocs=bc("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(ch(e9,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return ap(this,h,g)}}return this._allDocs(h,g)}),dC.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new dY(this,h,g)},dC.prototype.close=bc("close",function(g){return this._closed=!0,this._close(g)}),dC.prototype.info=bc("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),dC.prototype.id=bc("id",function(g){return this._id(g)}),dC.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},dC.prototype.bulkDocs=bc("bulkDocs",function(k,i,h){if("function"==typeof i&&(h=i,i={}),i=i||{},Array.isArray(k)&&(k={docs:k}),!k||!k.docs||!Array.isArray(k.docs)){return h(ch(bw))}for(var j=0;j<k.docs.length;++j){if("object"!=typeof k.docs[j]||Array.isArray(k.docs[j])){return h(ch(eQ))}}var g;return k.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){g=g||dT(m)})}),g?h(ch(ea,g)):("new_edits" in i||("new_edits" in k?i.new_edits=k.new_edits:i.new_edits=!0),i.new_edits||"http"===this.type()||k.docs.sort(bU),e5(k.docs),this._bulkDocs(k,i,function(m,l){return m?h(m):(i.new_edits||(l=l.filter(function(n){return n.error})),void h(null,l))}))}),dC.prototype.registerDependentDatabase=bc("registerDependentDatabase",function(i,g){function j(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[i]?!1:(k.dependentDbs[i]=!0,k)}var h=new this.constructor(i,this.__opts);aB(this,"_local/_pouch_dependentDbs",j).then(function(){g(null,{db:h})})["catch"](g)}),dC.prototype.destroy=bc("destroy",function(k,i){function h(){j._destroy(k,function(l,m){return l?i(l):(j._destroyed=!0,j.emit("destroyed"),void i(null,m||{ok:!0}))})}"function"==typeof k&&(i=k,k={});var j=this,g="use_prefix" in j?j.use_prefix:!0;return"http"===j.type()?h():void j.get("_local/_pouch_dependentDbs",function(m,p){if(m){return 404!==m.status?i(m):h()}var n=p.dependentDbs,l=j.constructor,o=Object.keys(n).map(function(r){var q=g?r.replace(new RegExp("^"+l.prefix),""):r;return new l(q,j.__opts).destroy()});ca.all(o).then(h,i)})}),bk.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},bk.prototype.fail=function(g){this.failed=g,this.execute()},bk.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},bk.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},aK(t,dC),t.debug=c8,t.adapters={},t.preferredAdapters=[],t.prefix="_pouch_";var f1=new cx.EventEmitter;e3(t),t.parseAdapter=function(g,h){var m,i,k=g.match(/([a-z\-]*):\/\/(.*)/);if(k){if(g=/http(s?)/.test(k[1])?k[1]+"://"+k[2]:k[2],m=k[1],!t.adapters[m].valid()){throw"Invalid adapter"}return{name:g,adapter:k[1]}}var l="idb" in t.adapters&&"websql" in t.adapters&&e4()&&localStorage["_pouch__websqldb_"+t.prefix+g];if(h.adapter){i=h.adapter}else{if("undefined"!=typeof h&&h.db){i="leveldb"}else{for(var j=0;j<t.preferredAdapters.length;++j){if(i=t.preferredAdapters[j],i in t.adapters){if(l&&"idb"===i){dk("log",'PouchDB is downgrading "'+g+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}m=t.adapters[i];var n=m&&"use_prefix" in m?m.use_prefix:!0;return{name:n?t.prefix+g:g,adapter:i}},t.adapter=function(h,g,i){g.valid()&&(t.adapters[h]=g,i&&t.preferredAdapters.push(h))},t.plugin=function(g){return"function"==typeof g?g(t):Object.keys(g).forEach(function(h){t.prototype[h]=g[h]}),t},t.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=ah.extend({},h,i),void t.call(this,k,i,j)):new g(k,i,j)}return aK(g,t),g.preferredAdapters=t.preferredAdapters.slice(),Object.keys(t).forEach(function(i){i in g||(g[i]=t[i])}),g};var dw="5.4.4";t.version=dw;var jR,d6=bJ(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cA=bJ(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),cM=function(g){return atob(g)},e6=function(g){return btoa(g)},bG=cI.setImmediate||cI.setTimeout,df=32768,e7=5,ac="document-store",dG="by-sequence",dB="attach-store",j6="attach-seq-store",cp="meta-store",f4="local-store",aJ="detect-blob-support",bg={running:!1,queue:[]},jT=new dO.Map,aW=new aQ,bN=new dO.Map;eg.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var bj=7,cW=ag("document-store"),dW=ag("by-sequence"),cT=ag("attach-store"),ax=ag("local-store"),el=ag("metadata-store"),cg=ag("attach-seq-store"),dQ=new dO.Map,jQ=new aQ,dx=1,a8="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+dW+" (seq, deleted)",ak="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+dW+" (doc_id, rev)",j4="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+cW+" (winningseq)",cv="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+cg+" (seq)",ab="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+cg+" (digest, seq)",aH=dW+".seq = "+cW+".winningseq",ej=dW+".seq AS seq, "+dW+".deleted AS deleted, "+dW+".json AS data, "+dW+".rev AS rev, "+cW+".json AS metadata";aA.valid=fQ,aA.use_prefix=!0;var b0=aC(),a9=function(){},c7=25,jS=50,bX={},jL=1800,fA=c8("pouchdb:http");dU.valid=function(){return !0},e2.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},e2.prototype.finish=function(){return this.promise};var bZ=function(h,g){return g&&h.then(function(i){fD.nextTick(function(){g(null,i)})},function(i){fD.nextTick(function(){g(i)})}),h},bT=function(g){return da(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&bZ(i,j),i})},b3=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},f0=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},bL=function(l){for(var j={},i=0,k=l.length;k>i;i++){j["$"+l[i]]=!0}var h=Object.keys(j),g=new Array(h.length);for(i=0,k=h.length;k>i;i++){g[i]=h[i].substring(1)}return g},cN={},aN=new e2,jK=50,bx=dk.bind(null,"log"),f2={_sum:function(h,g){return eF(g)},_count:function(h,g){return g.length},_stats:function(h,g){function i(n){for(var l=0,k=0,m=n.length;m>k;k++){var j=n[k];l+=j*j}return l}return{sum:eF(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},dp=bT(function(){var g=this;return"http"===g.type()?jH(g):"function"==typeof g._viewCleanup?ef(g):bO(g)}),b7=function(k,i,h){"function"==typeof i&&(h=i,i={}),i=i?c4(i):{},"function"==typeof k&&(k={map:k});var j=this,g=ca.resolve().then(function(){return fC(j,k,i)});return bZ(g,h),g};aK(ec,Error),aK(bm,Error),aK(cl,Error);var ke={query:b7,viewCleanup:dp},az=1,dK="pouchdb",bp=5,d7=0;eT.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},eT.prototype.updateTarget=function(h,g){return jX(this.target,this.id,h,g,this.returnValue)},eT.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?ca.resolve(!0):jX(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(kj(j)){return i.readOnlySource=!0,!0}throw j})};var d9={undefined:function(h,g){return 0===jO.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return b6(g,h).last_seq}};eT.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?ca.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return d7}var j;return j=h.version?h.version.toString():"undefined",j in d9?d9[j](h,i):d7},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:d7}).then(function(){return d7},function(j){return kj(j)?(g.readOnlySource=!0,h.last_seq):d7})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return d7})};var j5=0;aK(aZ,cx.EventEmitter),aZ.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},aZ.prototype.ready=function(k,i){function h(){g.cancel()}function j(){k.removeListener("destroyed",h),i.removeListener("destroyed",h)}var g=this;g._readyCalled||(g._readyCalled=!0,k.once("destroyed",h),i.once("destroyed",h),g.once("complete",j))},aK(cz,cx.EventEmitter),cz.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},t.plugin(aa).plugin(eI).plugin(jP).plugin(ke).plugin(dc),c.exports=t}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var o="color: "+this.color;n=[n[0],o,"color: inherit"].concat(Array.prototype.slice.call(n,1));var p=0,i=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),n.splice(i,0,o),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(j,p,d){function v(){return d.colors[h++%d.colors.length]}function c(n){function f(){}function i(){var o=i,s=+new Date,r=s-(k||s);o.diff=r,o.prev=k,o.curr=s,k=s,null==o.useColors&&(o.useColors=d.useColors()),null==o.color&&o.useColors&&(o.color=v());var u=Array.prototype.slice.call(arguments);u[0]=d.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=d.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof d.formatArgs&&(u=d.formatArgs.apply(o,u));var x=i.log||d.log||console.log.bind(console);x.apply(o,u)}f.enabled=!1,i.enabled=!0;var e=d.enabled(n)?i:f;return e.namespace=n,e}function g(i){d.save(i);for(var n=(i||"").split(/[\s,]+/),f=n.length,e=0;f>e;e++){n[e]&&(i=n[e].replace(/\*/g,".*?"),"-"===i[0]?d.skips.push(new RegExp("^"+i.substr(1)+"$")):d.names.push(new RegExp("^"+i+"$")))}}function l(){d.enable("")}function q(i){var e,f;for(e=0,f=d.skips.length;f>e;e++){if(d.skips[e].test(i)){return !1}}for(e=0,f=d.names.length;f>e;e++){if(d.names[e].test(i)){return !0}}return !1}function m(e){return e instanceof Error?e.stack||e.message:e}d=p.exports=c,d.coerce=m,d.disable=l,d.enable=g,d.enabled=q,d.humanize=j(11),d.names=[],d.skips=[],d.formatters={};var k,h=0},{11:11}],7:[function(d,c,f){(function(p){function h(){m=!0;for(var l,i,n=j.length;n;){for(i=j,j=[],l=-1;++l<n;){i[l]()}n=j.length}m=!1}function w(i){1!==j.push(i)||m||e()}var e,k=p.MutationObserver||p.WebKitMutationObserver;if(k){var q=0,v=new k(h),t=p.document.createTextNode("");v.observe(t,{characterData:!0}),e=function(){t.data=q=++q%2}}else{if(p.setImmediate||"undefined"==typeof p.MessageChannel){e="document" in p&&"onreadystatechange" in p.document.createElement("script")?function(){var i=p.document.createElement("script");i.onreadystatechange=function(){h(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},p.document.documentElement.appendChild(i)}:function(){setTimeout(h,0)}}else{var g=new p.MessageChannel;g.port1.onmessage=h,e=function(){g.port2.postMessage(0)}}}var m,j=[];c.exports=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(w,k,B){function G(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=I,this.queue=[],this.outcome=void 0,e!==G&&g(this,e)}function C(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function J(f,e,h){x(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function F(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(l,h){function f(o){e||(e=!0,d.reject(l,o))}function i(o){e||(e=!0,d.resolve(l,o))}function m(){h(i,f)}var e=!1,n=q(m);"error"===n.status&&f(n.value)}function q(h,e){var i={};try{i.value=h(e),i.status="success"}catch(f){i.status="error",i.value=f}return i}function D(e){return e instanceof this?e:d.resolve(new this(G),e)}function A(f){var e=new this(G);return d.reject(e,f)}function H(h){function n(r,s){function t(u){m[s]=u,++i!==o||e||(e=!0,d.resolve(l,m))}p.resolve(r).then(t,function(u){e||(e=!0,d.reject(l,u))})}var p=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var o=h.length,e=!1;if(!o){return this.resolve([])}for(var m=new Array(o),i=0,f=-1,l=new this(G);++f<o;){n(h[f],f)}return l}function E(l){function h(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(i,p))},function(p){e||(e=!0,d.reject(i,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var m=l.length,e=!1;if(!m){return this.resolve([])}for(var n=-1,i=new this(G);++n<m;){h(l[n])}return i}var x=w(7),d={},c=["REJECTED"],z=["FULFILLED"],I=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(f,e){if("function"!=typeof f&&this.state===z||"function"!=typeof e&&this.state===c){return this}var i=new this.constructor(G);if(this.state!==I){var h=this.state===z?f:e;J(i,h,this.outcome)}else{this.queue.push(new C(i,f,e))}return i},C.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},C.prototype.otherCallFulfilled=function(e){J(this.promise,this.onFulfilled,e)},C.prototype.callRejected=function(e){d.reject(this.promise,e)},C.prototype.otherCallRejected=function(e){J(this.promise,this.onRejected,e)},d.resolve=function(i,f){var m=q(F,f);if("error"===m.status){return d.reject(i,m.value)}var h=m.value;if(h){g(i,h)}else{i.state=z,i.outcome=f;for(var l=-1,e=i.queue.length;++l<e;){i.queue[l].callFulfilled(f)}}return i},d.reject=function(h,e){h.state=c,h.outcome=e;for(var i=-1,f=h.queue.length;++i<f;){h.queue[i].callRejected(e)}return h},j.resolve=D,j.reject=A,j.all=H,j.race=E},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(c,v,d){function y(n){if(null!==n){switch(typeof n){case"boolean":return n?1:0;case"number":return k(n);case"string":return n.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var o=Array.isArray(n),l=o?n:Object.keys(n),f=-1,e=l.length,i="";if(o){for(;++f<e;){i+=d.toIndexableString(l[f])}}else{for(;++f<e;){var h=l[f];i+=d.toIndexableString(h)+d.toIndexableString(n[h])}}return i}}return""}function m(e,l){var r,o=l,p="1"===e[l];if(p){r=0,l++}else{var s="0"===e[l];l++;var h="",n=e.substring(l,l+q),i=parseInt(n,10)+B;for(s&&(i=-i),l+=q;;){var f=e[l];if("\x00"===f){break}h+=f,l++}h=h.split("."),r=1===h.length?parseInt(h,10):parseFloat(h[0]+"."+h[1]),s&&(r-=10),0!==i&&(r=parseFloat(r+"e"+i))}return{num:r,length:l-o}}function j(l,f){var o=l.pop();if(f.length){var i=f[f.length-1];o===i.element&&(f.pop(),i=f[f.length-1]);var e=i.element,n=i.index;if(Array.isArray(e)){e.push(o)}else{if(n===l.length-2){var h=l.pop();e[h]=o}else{l.push(o)}}}}function C(f,l){for(var e=Math.min(f.length,l.length),h=0;e>h;h++){var i=d.collate(f[h],l[h]);if(0!==i){return i}}return f.length===l.length?0:f.length>l.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(n,o){for(var l=Object.keys(n),f=Object.keys(o),e=Math.min(l.length,f.length),i=0;e>i;i++){var h=d.collate(l[i],f[i]);if(0!==h){return h}if(h=d.collate(n[l[i]],o[f[i]]),0!==h){return h}}return l.length===f.length?0:l.length>f.length?1:-1}function g(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function k(l){if(0===l){return"1"}var p=l.toExponential().split(/e\+?/),h=parseInt(p[1],10),e=0>l,f=e?"0":"2",i=(e?-h:h)-B,n=z.padLeft(i.toString(),"0",q);f+=w+n;var r=Math.abs(parseFloat(p[0]));e&&(r=10-r);var o=r.toFixed(20);return o=o.replace(/\.?0+$/,""),f+=w+o}var B=-324,q=3,w="",z=c(13);d.collate=function(h,e){if(h===e){return 0}h=d.normalizeKey(h),e=d.normalizeKey(e);var f=g(h),i=g(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},d.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=d.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=d.normalizeKey(e))}}}}}return l},d.toIndexableString=function(f){var e="\x00";return f=d.normalizeKey(f),g(f)+w+y(f)+e},d.parseIndexableString=function(e){for(var l=[],p=[],o=0;;){var h=e[o++];if("\x00"!==h){switch(h){case"1":l.push(null);break;case"2":l.push("1"===e[o]),o++;break;case"3":var n=m(e,o);l.push(n.num),o+=n.length;break;case"4":for(var i="";;){var f=e[o];if("\x00"===f){break}i+=f,o++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),l.push(i);break;case"5":var s={element:[],index:l.length};l.push(s.element),p.push(s);break;case"6":var r={element:{},index:l.length};l.push(r.element),p.push(r);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+h)}}else{if(1===l.length){return l.pop()}j(l,p)}}}},{13:13}],13:[function(f,c,g){function d(k,i,h){for(var j="",e=h-k.length;j.length<e;){j+=i}return j}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var m,l=j.length,h=p.length;for(m=0;l>m;m++){if(m===h){return 1}var e=j.charAt(m),k=p.charAt(m);if(e!==k){return k>e?-1:1}}return h>l?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(d,h,g){function c(){this.store={}}function f(i){if(this.store=new c,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}g.Map=c,g.Set=f,c.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},c.prototype.unmangle=function(e){return e.substring(1)},c.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},c.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},c.prototype.has=function(i){var e=this.mangle(i);return e in this.store},c.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},c.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},f.prototype.add=function(e){return this.store.set(e,!0)},f.prototype.has=function(e){return this.store.has(e)},f.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(m,l){var k,j,i,h;j=[],h=[];for(k in l){e.call(l,k)&&(i=l[k],"this"!==k&&(j.push(k),h.push(i)))}return Function.apply(null,g.call(j).concat([m])).apply(l["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(I){function w(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function A(m,i,l,n,h,o,g){return w(i&l|~i&n,m,i,h,o,g)}function J(m,i,l,n,h,o,g){return w(i&n|l&~n,m,i,h,o,g)}function x(m,i,l,n,h,o,g){return w(i^l^n,m,i,h,o,g)}function D(m,i,l,n,h,o,g){return w(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=A(n,i,g,m,h[0],7,-680876936),m=A(m,n,i,g,h[1],12,-389564586),g=A(g,m,n,i,h[2],17,606105819),i=A(i,g,m,n,h[3],22,-1044525330),n=A(n,i,g,m,h[4],7,-176418897),m=A(m,n,i,g,h[5],12,1200080426),g=A(g,m,n,i,h[6],17,-1473231341),i=A(i,g,m,n,h[7],22,-45705983),n=A(n,i,g,m,h[8],7,1770035416),m=A(m,n,i,g,h[9],12,-1958414417),g=A(g,m,n,i,h[10],17,-42063),i=A(i,g,m,n,h[11],22,-1990404162),n=A(n,i,g,m,h[12],7,1804603682),m=A(m,n,i,g,h[13],12,-40341101),g=A(g,m,n,i,h[14],17,-1502002290),i=A(i,g,m,n,h[15],22,1236535329),n=J(n,i,g,m,h[1],5,-165796510),m=J(m,n,i,g,h[6],9,-1069501632),g=J(g,m,n,i,h[11],14,643717713),i=J(i,g,m,n,h[0],20,-373897302),n=J(n,i,g,m,h[5],5,-701558691),m=J(m,n,i,g,h[10],9,38016083),g=J(g,m,n,i,h[15],14,-660478335),i=J(i,g,m,n,h[4],20,-405537848),n=J(n,i,g,m,h[9],5,568446438),m=J(m,n,i,g,h[14],9,-1019803690),g=J(g,m,n,i,h[3],14,-187363961),i=J(i,g,m,n,h[8],20,1163531501),n=J(n,i,g,m,h[13],5,-1444681467),m=J(m,n,i,g,h[2],9,-51403784),g=J(g,m,n,i,h[7],14,1735328473),i=J(i,g,m,n,h[12],20,-1926607734),n=x(n,i,g,m,h[5],4,-378558),m=x(m,n,i,g,h[8],11,-2022574463),g=x(g,m,n,i,h[11],16,1839030562),i=x(i,g,m,n,h[14],23,-35309556),n=x(n,i,g,m,h[1],4,-1530992060),m=x(m,n,i,g,h[4],11,1272893353),g=x(g,m,n,i,h[7],16,-155497632),i=x(i,g,m,n,h[10],23,-1094730640),n=x(n,i,g,m,h[13],4,681279174),m=x(m,n,i,g,h[0],11,-358537222),g=x(g,m,n,i,h[3],16,-722521979),i=x(i,g,m,n,h[6],23,76029189),n=x(n,i,g,m,h[9],4,-640364487),m=x(m,n,i,g,h[12],11,-421815835),g=x(g,m,n,i,h[15],16,530742520),i=x(i,g,m,n,h[2],23,-995338651),n=D(n,i,g,m,h[0],6,-198630844),m=D(m,n,i,g,h[7],10,1126891415),g=D(g,m,n,i,h[14],15,-1416354905),i=D(i,g,m,n,h[5],21,-57434055),n=D(n,i,g,m,h[12],6,1700485571),m=D(m,n,i,g,h[3],10,-1894986606),g=D(g,m,n,i,h[10],15,-1051523),i=D(i,g,m,n,h[1],21,-2054922799),n=D(n,i,g,m,h[8],6,1873313359),m=D(m,n,i,g,h[15],10,-30611744),g=D(g,m,n,i,h[6],15,-1560198380),i=D(i,g,m,n,h[13],21,1309151649),n=D(n,i,g,m,h[4],6,-145523070),m=D(m,n,i,g,h[11],10,-1120210379),g=D(g,m,n,i,h[2],15,718787259),i=D(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function H(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function B(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function G(g){var m,o,l,n,p,i,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;h>=m;m+=64){M(r,H(g.substring(m-64,m)))}for(g=g.substring(m-64),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;o>m;m+=1){l[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(l[m>>2]|=128<<(m%4<<3),m>55){for(M(r,l),m=0;16>m;m+=1){l[m]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),i=parseInt(n[1],16)||0,l[14]=p,l[15]=i,M(r,l),r}function q(g){var i,o,l,n,p,m,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;h>=i;i+=64){M(r,B(g.subarray(i-64,i)))}for(g=h>i-64?g.subarray(i-64):new Uint8Array(0),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;o>i;i+=1){l[i>>2]|=g[i]<<(i%4<<3)}if(l[i>>2]|=128<<(i%4<<3),i>55){for(M(r,l),i=0;16>i;i+=1){l[i]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=p,l[15]=m,M(r,l),r}function E(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function z(h){var g;for(g=0;g<h.length;g+=1){h[g]=E(h[g])}return h.join("")}function F(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function C(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==z(G("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(i,o){var s,h,r,n,l=this.byteLength,m=g(i,l),p=l;return o!==I&&(p=g(o,l)),m>p?new ArrayBuffer(0):(s=p-m,h=new ArrayBuffer(s),r=new Uint8Array(h),n=new Uint8Array(this,m,s),r.set(n),h)}}(),C.prototype.append=function(g){return this.appendBinary(F(g)),this},C.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,H(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},C.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},C.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},C.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},C.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},C.hash=function(h,g){return C.hashBinary(F(h),g)},C.hashBinary=function(i,g){var l=G(i),h=z(l);return g?N(h):h},C.ArrayBuffer=function(){this.reset()},C.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,B(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},C.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.ArrayBuffer.prototype.getState=function(){var g=C.prototype.getState.call(this);return g.buff=j(g.buff),g},C.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),C.prototype.setState.call(this,g)},C.ArrayBuffer.prototype.destroy=C.prototype.destroy,C.ArrayBuffer.prototype._finish=C.prototype._finish,C.ArrayBuffer.hash=function(i,g){var l=q(new Uint8Array(i)),h=z(l);return g?N(h):h},C})},{}],17:[function(f,c,g){function d(j,p,m){var l=m[m.length-1];j===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,e=l.index;if(Array.isArray(h)){h.push(j)}else{if(e===p.length-2){var k=p.pop();h[k]=j}else{p.push(j)}}}g.stringify=function(p){var h=[];h.push({obj:p});for(var w,B,v,m,A,q,z,y,x,k,e,j="";w=h.pop();){if(B=w.obj,v=w.prefix||"",m=w.val||"",j+=v,m){j+=m}else{if("object"!=typeof B){j+="undefined"==typeof B?null:JSON.stringify(B)}else{if(null===B){j+="null"}else{if(Array.isArray(B)){for(h.push({val:"]"}),A=B.length-1;A>=0;A--){q=0===A?"":",",h.push({obj:B[A],prefix:q})}h.push({val:"["})}else{z=[];for(y in B){B.hasOwnProperty(y)&&z.push(y)}for(h.push({val:"}"}),A=z.length-1;A>=0;A--){x=z[A],k=B[x],e=A>0?",":"",e+=JSON.stringify(x)+":",h.push({obj:k,prefix:e})}h.push({val:"{"})}}}}}return j},g.parse=function(x){for(var w,m,y,q,v,h,e,p,k,z=[],r=[],j=0;;){if(w=x[j++],"}"!==w&&"]"!==w&&"undefined"!=typeof w){switch(w){case" ":case"	":case"\n":case":":case",":break;case"n":j+=3,d(null,z,r);break;case"t":j+=3,d(!0,z,r);break;case"f":j+=4,d(!1,z,r);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(m="",j--;;){if(y=x[j++],!/[\d\.\-e\+]/.test(y)){j--;break}m+=y}d(parseFloat(m),z,r);break;case'"':for(q="",v=void 0,h=0;;){if(e=x[j++],'"'===e&&("\\"!==v||h%2!==1)){break}q+=e,v=e,"\\"===v?h++:h=0}d(JSON.parse('"'+q+'"'),z,r);break;case"[":p={element:[],index:z.length},z.push(p.element),r.push(p);break;case"{":k={element:{},index:z.length},z.push(k.element),r.push(k);break;default:throw new Error("unexpectedly reached end of input: "+w)}}else{if(1===z.length){return z.pop()}d(z.pop(),z,r)}}}},{}]},{},[3])(3)});