!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(h,f){if(!l[h]){if(!b[h]){var g="function"==typeof require&&require;if(!f&&g){return g(h,!0)}if(k){return k(h,!0)}var j=new Error("Cannot find module '"+h+"'");throw j.code="MODULE_NOT_FOUND",j}var n=l[h]={exports:{}};b[h][0].call(n.exports,function(m){var p=b[h][1][m];return e(p?p:m)},n,n.exports,d,b,l,i)}return l[h].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,h,r,f,l,j;if(this._events||(this._events={}),"error"===g&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(h=this._events[g],m(h)){return !1}if(o(h)){switch(arguments.length){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),h.apply(this,f)}}else{if(p(h)){for(f=Array.prototype.slice.call(arguments,1),j=h.slice(),r=j.length,l=0;r>l;l++){j[l].apply(this,f)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(p(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(n,f,h){function l(){e&&u&&(e=!1,u.length?b=u.concat(b):s=-1,b.length&&r())}function r(){if(!e){var g=B(l);e=!0;for(var j=b.length;j;){for(u=b,b=[];++s<j;){u&&u[s].run()}s=-1,j=b.length}u=null,e=!1,i(g)}}function o(g,j){this.fun=g,this.array=j}function a(){}var B,i,t=f.exports={};!function(){try{B=setTimeout}catch(g){B=function(){throw new Error("setTimeout is not defined")}}try{i=clearTimeout}catch(g){i=function(){throw new Error("clearTimeout is not defined")}}}();var u,b=[],e=!1,s=-1;t.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}b.push(new o(j,k)),1!==b.length||e||B(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=a,t.addListener=a,t.once=a,t.off=a,t.removeListener=a,t.removeAllListeners=a,t.emit=a,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],3:[function(b,e,a){(function(gX,jd){function fi(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function cn(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function gC(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function iS(aa){if(aa instanceof ArrayBuffer){return gC(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function gM(aa){var ab=Object.getPrototypeOf(aa);if(null===ab){return !0}var t=ab.constructor;return"function"==typeof t&&t instanceof t&&ei.call(t)==g1}function g9(ad){var aa,ab,t;if(!ad||"object"!=typeof ad){return ad}if(Array.isArray(ad)){for(aa=[],ab=0,t=ad.length;t>ab;ab++){aa[ab]=g9(ad[ab])}return aa}if(ad instanceof Date){return ad.toISOString()}if(cn(ad)){return iS(ad)}if(!gM(ad)){return ad}aa={};for(ab in ad){if(Object.prototype.hasOwnProperty.call(ad,ab)){var ac=g9(ad[ab]);"undefined"!=typeof ac&&(aa[ab]=ac)}}return aa}function co(aa){var t=!1;return i5(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fy(t){return i5(function(ac){ac=g9(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){gX.nextTick(function(){ad(ag,ah)})});var af=new hw(function(aj,ak){var ag;try{var ah=co(function(ap,am){ap?ak(ap):aj(am)});ac.push(ah),ag=t.apply(aa,ac),ag&&"function"==typeof ag.then&&aj(ag)}catch(al){ak(al)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fc(aa,ab){function t(ag,aj,ad){if(gx.enabled){for(var ah=[ag._db_name,aj],af=0;af<ad.length-1;af++){ah.push(ad[af])}gx.apply(null,ah);var ac=ad[ad.length-1];ad[ad.length-1]=function(ak,am){var al=[ag._db_name,aj];al=al.concat(ak?["error",ak]:["success",am]),gx.apply(null,al),ac(ak,am)}}}return fy(i5(function(ad){if(this._closed){return hw.reject(new Error("database is closed"))}if(this._destroyed){return hw.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new hw(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function er(ad,aa){for(var ab={},t=0,ac=aa.length;ac>t;t++){var af=aa[t];af in ad&&(ab[af]=ad[af])}return ab}function fZ(t){return t}function iC(t){return[{ok:t}]}function fd(ac,aq,af){function am(){var av=[];al.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),af(null,{results:av})}function ah(){++t===au&&am()}function ad(av,aw,ax){al[av]={id:aw,docs:ax},ah()}function ak(){if(!(ap>=aj.length)){var av=Math.min(ap+iq,aj.length),aw=aj.slice(ap,av);aa(aw,ap),ap+=aw.length}}function aa(av,aw){av.forEach(function(aA,ay){var aC=aw+ay,aB=ag[aA],ax=er(aB[0],["atts_since","attachments"]);ax.open_revs=aB.map(function(aD){return aD.rev}),ax.open_revs=ax.open_revs.filter(fZ);var az=fZ;0===ax.open_revs.length&&(delete ax.open_revs,az=iC),["revs","attachments","binary","ajax"].forEach(function(aD){aD in aq&&(ax[aD]=aq[aD])}),ac.get(aA,ax,function(aD,aF){var aE;aE=aD?[{error:aD}]:az(aF),ad(aC,aA,aE),ak()})})}var ab=aq.docs,ag={};ab.forEach(function(av){av.id in ag?ag[av.id].push(av):ag[av.id]=[av]});var au=Object.keys(ag).length,t=0,al=new Array(au),aj=Object.keys(ag),ap=0;ak()}function ex(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gf(){return u}function fU(t){ex()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gf()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ee(){jm.EventEmitter.call(this),this._listeners={},fU(this)}function iO(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function ge(ad,aa){var ab=600000;ad=parseInt(ad,10)||0,aa=parseInt(aa,10),aa!==aa||ad>=aa?aa=(ad||1)<<1:aa+=1,aa>ab&&(ad=ab>>1,aa=ab);var t=Math.random(),ac=aa-ad;return ~~(ac*t+ad)}function fp(aa){var t=0;return aa||(t=2000),ge(aa,t)}function h2(aa,t){iO("info","The above "+aa+" is totally normal. "+t)}function gd(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function jt(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=gd.prototype,new aa(ab)}function gl(ad){var aa,ab,t,ac,af;return ab=ad.error===!0&&"string"==typeof ad.name?ad.name:ad.error,af=ad.reason,t=h3("name",ab,af),ad.missing||"missing"===af||"deleted"===af||"not_found"===ab?t=fV:"doc_validation"===ab?(t=et,ac=af):"bad_request"===ab&&t.message!==af&&(t=ik),t||(t=h3("status",ad.status,af)||hl),aa=jt(t,af,ab),ac&&(aa.message=ac),ad.id&&(aa.id=ad.id),ad.status&&(aa.status=ad.status),ad.missing&&(aa.missing=ad.missing),aa}function hs(ad,aa,ab){try{return !ad(aa,ab)}catch(t){var ac="Filter function threw: "+t.toString();return jt(ik,ac)}}function jB(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&hs(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function H(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function go(aa){var t;if(aa?"string"!=typeof aa?t=jt(hK):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=jt(fz)):t=jt(hy),t){throw t}}function hn(aa,t){return"listenerCount" in aa?aa.listenerCount(t):jm.EventEmitter.listenerCount(aa,t)}function gE(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function iu(aa){var t=gE(aa);return t?t.join("/"):null}function hH(ac){for(var t=de.exec(ac),ag={},ad=14;ad--;){var ab=dn[ad],aa=t[ad]||"",af=-1!==["user","password"].indexOf(ab);ag[ab]=af?decodeURIComponent(aa):aa}return ag[D]={},ag[dn[12]].replace(m,function(aj,ah,ak){ah&&(ag[D][ah]=ak)}),ag}function hE(aa,ab,t){return new hw(function(ad,ac){aa.get(ab,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=t(af);return aj?(aj._id=ab,aj._rev=ag,void ad(bo(aa,aj,t))):ad({updated:!1,rev:ag})})})}function bo(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return hE(aa,ab._id,t)})}function gk(t){return 0|Math.random()*t}function g6(t,ab){ab=ab||q.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=q[gk(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=q[3&gk(16)|8];break;default:ac+=q[gk(16)]}}return ac}function eo(t){for(var ab,am,aa,ap,ak=t.rev_tree.slice();ap=ak.pop();){var ad=ap.ids,aj=ad[2],ac=ap.pos;if(aj.length){for(var af=0,ah=aj.length;ah>af;af++){ak.push({pos:ac+1,ids:aj[af]})}}else{var al=!!ad[1].deleted,ag=ad[0];ab&&!(aa!==al?aa:am!==ac?ac>am:ag>ab)||(ab=ag,am=ac,aa=al)}}return am+"-"+ab}function ga(aa,aj){for(var ad,ag=aa.slice();ad=ag.pop();){for(var af=ad.pos,ac=ad.ids,ak=ac[2],ah=aj(0===ak.length,af,ac[0],ad.ctx,ac[1]),ab=0,t=ak.length;t>ab;ab++){ag.push({pos:af+1,ids:ak[ab],ctx:ah})}}}function im(aa,t){return aa.pos-t.pos}function iW(t){var ab=[];ga(t,function(ag,ad,ah,af,aj){ag&&ab.push({rev:ad+"-"+ah,pos:ad,opts:aj})}),ab.sort(im).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function fS(ac){for(var t=eo(ac),ag=iW(ac.rev_tree),ad=[],ab=0,aa=ag.length;aa>ab;ab++){var af=ag[ab];af.rev===t||af.opts.deleted||ad.push(af.rev)}return ad}function iz(aa){var t=[];return ga(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function iP(t){for(var ab,am=[],aa=t.slice();ab=aa.pop();){var ap=ab.pos,ak=ab.ids,ad=ak[0],aj=ak[1],ac=ak[2],af=0===ac.length,ah=ab.history?ab.history.slice():[];ah.push({id:ad,opts:aj}),af&&am.push({pos:ap+1-ah.length,ids:ah});for(var al=0,ag=ac.length;ag>al;al++){aa.push({pos:ap+1,ids:ac[al],history:ah})}}return am.reverse()}function w(aa,t){return aa.pos-t.pos}function jw(ad,aa,ab){for(var t,ac=0,af=ad.length;af>ac;){t=ac+af>>>1,ab(ad[t],aa)<0?ac=t+1:af=t}return ac}function hr(t,ab,ac){var aa=jw(t,ab,ac);t.splice(aa,0,ab)}function di(ac,aa){for(var af,ah,ag=aa,ab=ac.length;ab>ag;ag++){var ad=ac[ag],t=[ad.id,ad.opts,[]];ah?(ah[2].push(t),ah=t):af=ah=t}return af}function gs(aa,t){return aa[0]<t[0]?-1:1}function L(aa,aj){for(var ad=[{tree1:aa,tree2:aj}],ag=!1;ad.length>0;){var af=ad.pop(),ac=af.tree1,ak=af.tree2;(ac[1].status||ak[1].status)&&(ac[1].status="available"===ac[1].status||"available"===ak[1].status?"available":"missing");for(var ah=0;ah<ak[2].length;ah++){if(ac[2][0]){for(var ab=!1,t=0;t<ac[2].length;t++){ac[2][t][0]===ak[2][ah][0]&&(ad.push({tree1:ac[2][t],tree2:ak[2][ah]}),ab=!0)}ab||(ag="new_branch",hr(ac[2],ak[2][ah],gs))}else{ag="new_leaf",ac[2][0]=ak[2][ah]}}}return{conflicts:ag,tree:aa}}function iv(ad,ac,ag){var al,av=[],t=!1,af=!1;if(!ad.length){return{tree:[ac],conflicts:"new_leaf"}}for(var aa=0,aw=ad.length;aw>aa;aa++){var aj=ad[aa];if(aj.pos===ac.pos&&aj.ids[0]===ac.ids[0]){al=L(aj.ids,ac.ids),av.push({pos:aj.pos,ids:al.tree}),t=t||al.conflicts,af=!0}else{if(ag!==!0){var am=aj.pos<ac.pos?aj:ac,ab=aj.pos<ac.pos?ac:aj,ap=ab.pos-am.pos,aq=[],ax=[];for(ax.push({ids:am.ids,diff:ap,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ah=0,ak=az.length;ak>ah;ah++){ax.push({ids:az[ah],diff:ay.diff-1,parent:ay.ids,parentIdx:ah})}}else{ay.ids[0]===ab.ids[0]&&aq.push(ay)}}var au=aq[0];au?(al=L(au.ids,ab.ids),au.parent[2][au.parentIdx]=al.tree,av.push({pos:am.pos,ids:am.ids}),t=t||al.conflicts,af=!0):av.push(aj)}else{av.push(aj)}}}return af||av.push(ac),av.sort(w),{tree:av,conflicts:t||"internal_node"}}function g0(t,ab){for(var am,aa=iP(t),ap={},ak=0,ad=aa.length;ad>ak;ak++){for(var aj=aa[ak],ac=aj.ids,af=Math.max(0,ac.length-ab),ah={pos:aj.pos+af,ids:di(ac,af)},al=0;af>al;al++){var ag=aj.pos+al+"-"+ac[al].id;ap[ag]=!0}am=am?iv(am,ah,!0).tree:[ah]}return ga(am,function(aq,au,av){delete ap[au+"-"+av]}),{tree:am,revs:Object.keys(ap)}}function jo(ad,aa,ab){var t=iv(ad,aa),ac=g0(t.tree,ab);return{tree:ac.tree,stemmedRevs:ac.revs,conflicts:t.conflicts}}function gO(aa,aj){for(var ad,ag=aa.slice(),af=aj.split("-"),ac=parseInt(af[0],10),ak=af[1];ad=ag.pop();){if(ad.pos===ac&&ad.ids[0]===ak){return !0}for(var ah=ad.ids[2],ab=0,t=ah.length;t>ab;ab++){ag.push({pos:ad.pos+1,ids:ah[ab]})}}return !1}function a3(t){return t.ids}function fu(ad,aa){aa||(aa=eo(ad));for(var ab,t=aa.substring(aa.indexOf("-")+1),ac=ad.rev_tree.map(a3);ab=ac.pop();){if(ab[0]===t){return !!ab[1].deleted}ac=ac.concat(ab[2])}}function iD(t){return/^_local/.test(t)}function gz(t){return gi("return "+t+";",{})}function jg(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function hB(aa,ab){try{aa.emit("change",ab)}catch(t){iO("error",'Error in .on("change", function):',t)}}function hU(ac,t,ag){function ad(){ab.cancel()}jm.EventEmitter.call(this);var ab=this;this.db=ac,t=t?g9(t):{};var aa=t.complete=co(function(aj,ah){aj?hn(ab,"error")>0&&ab.emit("error",aj):ab.emit("complete",ah),ab.removeAllListeners(),ac.removeListener("destroyed",ad)});ag&&(ab.on("complete",function(ah){ag(null,ah)}),ab.on("error",ag)),ac.once("destroyed",ad),t.onChange=function(ah){t.isCancelled||(hB(ab,ah),ab.startSeq&&ab.startSeq<=ah.seq&&(ab.startSeq=!1))};var af=new hw(function(aj,ah){t.complete=function(al,ak){al?ah(al):aj(ak)}});ab.once("cancel",function(){ac.removeListener("destroyed",ad),t.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){aa(null,ah)},aa),ac.taskqueue.isReady?ab.doChanges(t):ac.taskqueue.addTask(function(){ab.isCancelled?ab.emit("cancel"):ab.doChanges(t)})}function h1(ad,aa,ab){var t=[{rev:ad._rev}];"all_docs"===ab.style&&(t=iW(aa.rev_tree).map(function(af){return{rev:af.rev}}));var ac={id:aa.id,changes:t,doc:ad};return fu(aa,ad._rev)&&(ac.deleted=!0),ab.conflicts&&(ac.doc._conflicts=fS(aa),ac.doc._conflicts.length||delete ac.doc._conflicts),ac}function iT(aa,t){return t>aa?-1:aa>t?1:0}function ct(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function V(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function fT(ad){for(var aa=0;aa<ad.length;aa++){var ab=ad[aa];if(ab._deleted){delete ab._attachments}else{if(ab._attachments){for(var t=Object.keys(ab._attachments),ac=0;ac<t.length;ac++){var af=t[ac];ab._attachments[af]=er(ab._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function ar(ad,aa){var ab=iT(ad._id,aa._id);if(0!==ab){return ab}var t=ad._revisions?ad._revisions.start:0,ac=aa._revisions?aa._revisions.start:0;return iT(t,ac)}function hR(aa){var ab={},t=[];return ga(aa,function(af,ag,ad,ah){var ac=ag+"-"+ad;return af&&(ab[ac]=0),void 0!==ah&&t.push({from:ah,to:ac}),ac}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function E(ad,aa,ab){var t="limit" in aa?aa.keys.slice(aa.skip,aa.limit+aa.skip):aa.skip>0?aa.keys.slice(aa.skip):aa.keys;if(aa.descending&&t.reverse(),!t.length){return ad._allDocs({limit:0},ab)}var ac={offset:aa.skip};return hw.all(t.map(function(af){var ag=gD.extend({key:af,deleted:"ok"},aa);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hw(function(aj,ah){ad._allDocs(ag,function(ak,al){return ak?ah(ak):(ac.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ac.rows=af,ac})}function fg(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),gX.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&fg(t)})})})}function ii(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function jl(){jm.EventEmitter.call(this)}function fv(){this.isReady=!1,this.failed=!1,this.queue=[]}function eu(t){t&&jd.debug&&iO("error",t)}function g4(ac,t){function ag(){aa.emit("destroyed",ab)}function ad(){ac.removeListener("destroyed",ag),ac.emit("destroyed",ac)}var ab=t.originalName,aa=ac.constructor,af=aa._destructionListeners;ac.once("destroyed",ag),af.has(ab)||af.set(ab,[]),af.get(ab).push(ad)}function a9(ac,t,ag){if(!(this instanceof a9)){return new a9(ac,t,ag)}var ad=this;if("function"!=typeof t&&"undefined"!=typeof t||(ag=t,t={}),ac&&"object"==typeof ac&&(t=ac,ac=void 0),"undefined"==typeof ag){ag=eu}else{var ab=ag;ag=function(){return iO("warn","Using a callback for new PouchDB()is deprecated."),ab.apply(null,arguments)}}ac=ac||t.name,t=g9(t),delete t.name,this.__opts=t;var aa=ag;ad.auto_compaction=t.auto_compaction,ad.prefix=a9.prefix,jl.call(ad),ad.taskqueue=new fv;var af=new hw(function(al,aj){ag=function(ap,am){return ap?aj(ap):(delete am.then,void al(am))},t=g9(t);var ak,ah;return function(){try{if("string"!=typeof ac){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}var ap=(t.prefix||"")+ac;if(ak=a9.parseAdapter(ap,t),t.originalName=ac,t.name=ak.name,t.adapter=t.adapter||ak.adapter,ad._adapter=t.adapter,i8("pouchdb:adapter")("Picked adapter: "+t.adapter),ad._db_name=ac,!a9.adapters[t.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!a9.adapters[t.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ad.taskqueue.fail(am)}}(),ah?aj(ah):(ad.adapter=t.adapter,ad.replicate={},ad.replicate.from=function(aq,am,ap){return ad.constructor.replicate(aq,ad,am,ap)},ad.replicate.to=function(aq,am,ap){return ad.constructor.replicate(ad,aq,am,ap)},ad.sync=function(aq,am,ap){return ad.constructor.sync(ad,aq,am,ap)},ad.replicate.sync=ad.sync,void a9.adapters[t.adapter].call(ad,t,function(am){return am?(ad.taskqueue.fail(am),void ag(am)):(g4(ad,t),ad.emit("created",ad),a9.emit("created",t.originalName),ad.taskqueue.ready(ad),void ag(null,ad))}))});af.then(function(ah){aa(null,ah)},aa),ad.then=af.then.bind(af),ad["catch"]=af["catch"].bind(af)}function hA(aa){Object.keys(jm.EventEmitter.prototype).forEach(function(ab){"function"==typeof jm.EventEmitter.prototype[ab]&&(aa[ab]=iV[ab].bind(iV))});var t=aa._destructionListeners=new ij.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function fW(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function a7(t){if(!/^\d+\-./.test(t)){return jt(iX)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function ih(ac,t){for(var ag=ac.start-ac.ids.length+1,ad=ac.ids,ab=[ad[0],t,[]],aa=1,af=ad.length;af>aa;aa++){ab=[ad[aa],{status:"missing"},[ab]]}return[{pos:ag,ids:ab}]}function iy(aa,aj){var ad,ag,af,ac={status:"available"};if(aa._deleted&&(ac.deleted=!0),aj){if(aa._id||(aa._id=g6()),ag=g6(32,16).toLowerCase(),aa._rev){if(af=a7(aa._rev),af.error){return af}aa._rev_tree=[{pos:af.prefix,ids:[af.id,{status:"missing"},[[ag,ac,[]]]]}],ad=af.prefix+1}else{aa._rev_tree=[{pos:1,ids:[ag,ac,[]]}],ad=1}}else{if(aa._revisions&&(aa._rev_tree=ih(aa._revisions,ac),ad=aa._revisions.start,ag=aa._revisions.ids[0]),!aa._rev_tree){if(af=a7(aa._rev),af.error){return af}ad=af.prefix,ag=af.id,aa._rev_tree=[{pos:ad,ids:[ag,ac,[]]}]}}go(aa._id),aa._rev=ad+"-"+ag;var ak={metadata:{},data:{}};for(var ah in aa){if(Object.prototype.hasOwnProperty.call(aa,ah)){var ab="_"===ah[0];if(ab&&!iB[ah]){var t=jt(et,ah);throw t.message=et.message+": "+ah,t}ab&&!gt[ah]?ak.metadata[ah.slice(1)]=aa[ah]:ak.data[ah]=aa[ah]}}return ak}function O(ad){for(var aa="",ab=new Uint8Array(ad),t=ab.byteLength,ac=0;t>ac;ac++){aa+=String.fromCharCode(ab[ac])}return aa}function hq(t){return gu(O(t))}function z(ad,aa){ad=ad||[],aa=aa||{};try{return new Blob(ad,aa)}catch(ab){if("TypeError"!==ab.name){throw ab}for(var t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ac=new t,af=0;af<ad.length;af+=1){ac.append(ad[af])}return ac.getBlob(aa.type)}}function R(ad){for(var aa=ad.length,ab=new ArrayBuffer(aa),t=new Uint8Array(ab),ac=0;aa>ac;ac++){t[ac]=ad.charCodeAt(ac)}return ab}function y(aa,t){return z([R(aa)],{type:t})}function g5(aa,t){return y(bt(aa),t)}function I(t,ab){if("undefined"==typeof FileReader){return ab(O((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(O(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function jk(aa,t){I(aa,function(ab){t(gu(ab))})}function dt(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function Y(t){return gu(t)}function ci(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function fh(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function fx(aa,aj){function ad(){var aq=ah*ac,al=aq+ac;if(ah++,ak>ah){t(ab,aa,aq,al),i4(ad)}else{t(ab,aa,aq,al);var ap=ab.end(!0),am=Y(ap);aj(am),ab.destroy()}}var ag="string"==typeof aa,af=ag?aa.length:aa.byteLength,ac=Math.min(iU,af),ak=Math.ceil(af/ac),ah=0,ab=ag?new io:new io.ArrayBuffer,t=ag?fh:ci;ad()}function gh(t){return io.hash(t)}function Z(ac,aa,af){function ah(al){try{return bt(al)}catch(aj){var ak=jt(g3,"Attachment is not a valid base64 string");return{error:ak}}}function ag(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ah(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===aa?aj.data=y(al,aj.content_type):"base64"===aa?aj.data=gu(al):aj.data=al,fx(al,function(am){aj.digest="md5-"+am,ak()})}else{dt(aj.data,function(am){"binary"===aa?aj.data=O(am):"base64"===aa&&(aj.data=hq(am)),fx(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ab(){t++,ac.length===t&&(ad?af(ad):af())}if(!ac.length){return af()}var ad,t=0;ac.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ab()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ab()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ag(ak.data._attachments[ap],am)}})}function hv(ag,af,t,aa,av,aA,ah,ak){if(gO(af.rev_tree,t.metadata.rev)){return aa[av]=t,aA()}var aw=af.winningRev||eo(af),au="deleted" in af?af.deleted:fu(af,aw),ab="deleted" in t.metadata?t.metadata.deleted:fu(t.metadata),aq=/^1-/.test(t.metadata.rev);if(au&&!ab&&ak&&aq){var ac=t.data;ac._rev=aw,ac._id=t.metadata.id,t=iy(ac,ak)}var am=jo(af.rev_tree,t.metadata.rev_tree[0],ag),ax=ak&&(au&&ab||!au&&"new_leaf"!==am.conflicts||au&&!ab&&"new_branch"===am.conflicts);if(ax){var ay=jt(hc);return aa[av]=ay,aA()}var az=t.metadata.rev;t.metadata.rev_tree=am.tree,t.stemmedRevs=am.stemmedRevs||[],af.rev_map&&(t.metadata.rev_map=af.rev_map);var al,ad=eo(t.metadata),ap=fu(t.metadata,ad),aj=au===ap?0:ap>au?-1:1;al=az===ad?ap:fu(t.metadata,az),ah(t,ad,ap,al,!0,aj,av,aA)}function gI(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ja(ah,af,aq,ak,ac,am,ag,aa,ap){function al(aA,aC,aw){var ay=eo(aA.metadata),az=fu(aA.metadata,ay);if("was_delete" in aa&&az){return am[aC]=jt(fV,"deleted"),aw()}var av=ad&&gI(aA);if(av){var ax=jt(hc);return am[aC]=ax,aw()}var aB=az?0:1;ag(aA,ay,az,az,!1,aB,aC,aw)}function au(){++aj===t&&ap&&ap()}ah=ah||1000;var ad=aa.new_edits,ab=new ij.Map,aj=0,t=af.length;af.forEach(function(aw,ay){if(aw._id&&iD(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aq[ax](aw,{ctx:ac},function(aA,az){am[ay]=aA||az,au()})}var av=aw.metadata.id;ab.has(av)?(t--,ab.get(av).push([aw,ay])):ab.set(av,[[aw,ay]])}),ab.forEach(function(ay,aw){function ax(){++az<ay.length?av():au()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(ak.has(aw)){hv(ah,ak.get(aw),aA,am,aB,ax,ag,ad)}else{var aD=jo([],aA.metadata.rev_tree[0],ah);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],al(aA,aB,ax)}}var az=0;av()})}function gn(aa){try{return JSON.parse(aa)}catch(t){return gN.parse(aa)}}function S(t){return t.length<50000?JSON.parse(t):gn(t)}function i3(aa){try{return JSON.stringify(aa)}catch(t){return gN.stringify(aa)}}function bn(ad,aa,ab,t){try{ad.apply(aa,ab)}catch(ac){t.emit("error",ac)}}function hf(aa){if(!ie.running&&ie.queue.length){ie.running=!0;var t=ie.queue.shift();t.action(function(ac,ab){bn(t.callback,this,[ac,ab],aa),ie.running=!1,gX.nextTick(function(){hf(aa)})})}}function fa(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(jt(ew,aa,ab.type))}}function jn(aa,ab,t){return{data:i3(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function jD(aa){if(!aa){return null}var t=S(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function gy(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function h0(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:g5(t,ab):z([""],{type:ab})):t?"string"!=typeof t?I(t,function(ad){aa(gu(ad))}):aa(t):aa("")}function iJ(ac,aa,af,ah){function ag(){++t===ad.length&&ah&&ah()}function ab(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=af.objectStore(gQ).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ag()}}var ad=Object.keys(ac._attachments||{});if(!ad.length){return ah&&ah()}var t=0;ad.forEach(function(aj){aa.attachments&&aa.include_docs?ab(ac,aj):(ac._attachments[aj].stub=!0,ag())})}function i2(aa,t){return hw.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hw.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new hw(function(aj){h0(ah,af,t,function(ak){ac.doc._attachments[ag]=gD.extend(er(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function jq(aa,aj,ad){function ag(){t--,t||af()}function af(){ac.length&&ac.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ah["delete"](am)}})}var ac=[],ak=ad.objectStore(g2),ah=ad.objectStore(gQ),ab=ad.objectStore(gH),t=aa.length;aa.forEach(function(al){var am=ak.index("_doc_id_rev"),ap=aj+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return ag()}ak["delete"](av);var aq=ab.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];ac.push(aw),ab["delete"](ay.primaryKey),ay["continue"]()}else{ag()}}}})}function hL(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function ib(au,ay,aG,aI,aD,az,aj){function am(){var aN=[gv,g2,gQ,ic,gH],aO=hL(aD,aN,"readwrite");return aO.error?aj(aO.error):(ah=aO.txn,ah.onabort=fa(aj),ah.ontimeout=fa(aj),ah.oncomplete=al,aC=ah.objectStore(gv),ag=ah.objectStore(g2),av=ah.objectStore(gQ),aa=ah.objectStore(gH),void aM(function(aP){return aP?(ac=!0,aj(aP)):void aL()}))}function ap(){ja(au.revs_limit,aw,aI,aq,ah,aE,aJ,aG)}function aL(){function aT(){++aR===aw.length&&ap()}function aO(aU){var aV=jD(aU.target.result);aV&&aq.set(aV.id,aV),aT()}if(aw.length){for(var aR=0,aN=0,aS=aw.length;aS>aN;aN++){var aP=aw[aN];if(aP._id&&iD(aP._id)){aT()}else{var aQ=aC.get(aP.metadata.id);aQ.onsuccess=aO}}}}function al(){ac||(az.notify(aI._meta.name),aI._meta.docCount+=aA,aj(null,aE))}function aH(aO,aP){var aN=av.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=jt(ht,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aw.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aH(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aJ(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ax(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bc){var ba=aP.stemmedRevs||[];aV&&aI.auto_compaction&&(ba=ba.concat(iz(aP.metadata))),ba&&ba.length&&jq(ba,aP.metadata.id,ah),aT.seq=bc.target.result,delete aT.rev;var bb=jn(aT,aW,aU),aZ=aC.put(bb);aZ.onsuccess=aN}function aX(aZ){aZ.preventDefault(),aZ.stopPropagation();var ba=ag.index("_doc_id_rev"),bb=ba.getKey(aR._doc_id_rev);bb.onsuccess=function(bc){var bd=ag.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aE[aS]={ok:!0,id:aT.id,rev:aW},aq.set(aP.metadata.id,aP.metadata),aF(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ag.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ax(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(bb){var aZ=aP.data._attachments[bb];if(aZ.stub){aO++,aN()}else{var aY=aZ.data;delete aZ.data,aZ.revpos=parseInt(aW,10);var ba=aZ.digest;aB(ba,aY,aV)}})}function aF(aP,aS,aN){function aQ(){++aT===aU.length&&aN()}function aO(aV){var aW=aP.data._attachments[aV].digest,aX=aa.put({seq:aS,digestSeq:aW+"::"+aS});aX.onsuccess=aQ,aX.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aQ()}}var aT=0,aU=Object.keys(aP.data._attachments||{});if(!aU.length){return aN()}for(var aR=0;aR<aU.length;aR++){aO(aU[aR])}}function aB(aO,aQ,aN){var aP=av.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=av.put(aU);aR.onsuccess=aN}}for(var ah,aC,ag,av,aa,ab,aw=ay.docs,aA=0,t=0,af=aw.length;af>t;t++){var ak=aw[t];ak._id&&iD(ak._id)||(ak=aw[t]=iy(ak,aG.new_edits),ak.error&&!ab&&(ab=ak))}if(ab){return aj(ab)}var aE=new Array(aw.length),aq=new ij.Map,ac=!1,aK=aI._meta.blobSupport?"blob":"base64";Z(aw,aK,function(aN){return aN?aj(aN):void am()})}function jc(ad,aa,ab,t,ac){try{if(ad&&aa){return ac?IDBKeyRange.bound(aa,ad,!ab,!1):IDBKeyRange.bound(ad,aa,!1,!ab)}if(ad){return ac?IDBKeyRange.upperBound(ad):IDBKeyRange.lowerBound(ad)}if(aa){return ac?IDBKeyRange.lowerBound(aa,!ab):IDBKeyRange.upperBound(aa,!ab)}if(t){return IDBKeyRange.only(t)}}catch(af){return{error:af}}return null}function hz(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(jt(ew,ac.name,ac.message))}function ix(ad,aa,ab,t){function ac(ak,aB){function aA(aL,aM,aK){var aN=aL.id+"::"+aK;ap.get(aN).onsuccess=function(aO){aM.doc=gy(aO.target.result),ak.conflicts&&(aM.doc._conflicts=fS(aL)),iJ(aM.doc,ak,au)}}function av(aK,aN,aO){var aL={id:aO.id,key:aO.id,value:{rev:aN}},aM=aO.deleted;if("ok"===ak.deleted){az.push(aL),aM?(aL.value.deleted=!0,aL.doc=null):ak.include_docs&&aA(aO,aL,aN)}else{if(!aM&&aj--<=0&&(az.push(aL),ak.include_docs&&aA(aO,aL,aN),0===--am)){return}}aK["continue"]()}function aD(aK){ag=aa._meta.docCount;var aM=aK.target.result;if(aM){var aL=jD(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function ax(){aB(null,{total_rows:ag,offset:ak.skip,rows:az})}function aq(){ak.attachments?i2(az,ak.binary).then(ax):ax()}var ay="startkey" in ak?ak.startkey:!1,aH="endkey" in ak?ak.endkey:!1,aw="key" in ak?ak.key:!1,aj=ak.skip||0,am="number"==typeof ak.limit?ak.limit:-1,aG=ak.inclusive_end!==!1,aE="descending" in ak&&ak.descending?"prev":null,aC=jc(ay,aH,aG,aw,aE);if(aC&&aC.error){return hz(aa,ak,aC.error,aB)}var al=[gv,g2];ak.attachments&&al.push(gQ);var ah=hL(ab,al,"readonly");if(ah.error){return aB(ah.error)}var au=ah.txn,aJ=au.objectStore(gv),aF=au.objectStore(g2),aI=aE?aJ.openCursor(aC,aE):aJ.openCursor(aC),ap=aF.index("_doc_id_rev"),az=[],ag=0;au.oncomplete=aq,aI.onsuccess=aD}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:aa._meta.docCount,offset:ah.skip,rows:[]}):void ac(ah,ag)}af(ad,t)}function jA(t){return new hw(function(ab){var aa=z([""]);t.objectStore(jx).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function a8(aa,ab){var t=this;ie.queue.push({action:function(ac){hN(t,aa,ac)},callback:ab}),hf(t.constructor)}function hN(ah,ag,ab){function aq(au){var av=au.createObjectStore(gv,{keyPath:"id"});au.createObjectStore(g2,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gQ,{keyPath:"digest"}),au.createObjectStore(ir,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jx),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(ic,{keyPath:"_id"});var aw=au.createObjectStore(gH,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ap(au,av){var aw=au.objectStore(gv);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=fu(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ac(au){au.createObjectStore(ic,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aj(az,ax){var ay=az.objectStore(ic),aw=az.objectStore(gv),av=az.objectStore(g2),au=aw.openCursor();au.onsuccess=function(aF){var aI=aF.target.result;if(aI){var aC=aI.value,aL=aC.id,aA=iD(aL),aD=eo(aC);if(aA){var aG=aL+"::"+aD,aJ=aL+"::",aE=aL+"::~",aH=av.index("_doc_id_rev"),aK=IDBKeyRange.bound(aJ,aE,!1,!1),aB=aH.openCursor(aK);aB.onsuccess=function(aN){if(aB=aN.target.result){var aM=aB.value;aM._doc_id_rev===aG&&ay.put(aM),av["delete"](aB.primaryKey),aB["continue"]()}else{aw["delete"](aI.primaryKey),aI["continue"]()}}}else{aI["continue"]()}}else{ax&&ax()}}}function am(au){var av=au.createObjectStore(gH,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function al(az,ax){var ay=az.objectStore(g2),aw=az.objectStore(gQ),av=az.objectStore(gH),au=aw.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ay.openCursor().onsuccess=function(aF){var aJ=aF.target.result;if(!aJ){return ax()}for(var aK=aJ.value,aH=aJ.primaryKey,aD=Object.keys(aK._attachments||{}),aL={},aC=0;aC<aD.length;aC++){var aE=aK._attachments[aD[aC]];aL[aE.digest]=!0}var aG=Object.keys(aL);for(aC=0;aC<aG.length;aC++){var aI=aG[aC];av.put({seq:aH,digestSeq:aI+"::"+aH})}aJ["continue"]()}):ax()}}function af(ax){function aw(az){return az.data?jD(az):(az.deleted="1"===az.deletedOrLocal,az)}var ay=ax.objectStore(g2),au=ax.objectStore(gv),av=au.openCursor();av.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=ay.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=jn(az,az.winningRev,az.deleted),aF=au.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=aw(aA.value);return az.winningRev=az.winningRev||eo(az),az.seq?aD():void aB()}}}var aa=ag.name,ad=null;ah._meta=null,ah.type=function(){return"idb"},ah._id=fy(function(au){au(null,ah._meta.instanceId)}),ah._bulkDocs=function(aw,av,au){ib(ag,aw,av,ah,ad,a2,au)},ah._get=function(aw,aB,aC){function ay(){aC(av,{doc:ax,metadata:az,ctx:aA})}var ax,az,av,aA=aB.ctx;if(!aA){var au=hL(ad,[gv,g2,gQ],"readonly");if(au.error){return aC(au.error)}aA=au.txn}aA.objectStore(gv).get(aw).onsuccess=function(aG){if(az=jD(aG.target.result),!az){return av=jt(fV,"missing"),ay()}if(fu(az)&&!aB.rev){return av=jt(fV,"deleted"),ay()}var aE=aA.objectStore(g2),aD=aB.rev||az.winningRev,aF=az.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return ax=aH.target.result,ax&&(ax=gy(ax)),ax?void ay():(av=jt(fV,"missing"),ay())}}},ah._getAttachment=function(aw,aB,aC,ay,ax){var az;if(ay.ctx){az=ay.ctx}else{var av=hL(ad,[gv,g2,gQ],"readonly");if(av.error){return ax(av.error)}az=av.txn}var aA=aC.digest,au=aC.content_type;az.objectStore(gQ).get(aA).onsuccess=function(aE){var aD=aE.target.result.body;h0(aD,au,ay.binary,function(aF){ax(null,aF)})}},ah._info=function(av){if(null===ad||!hQ.has(aa)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var ax,aw,az=hL(ad,[g2],"readonly");if(az.error){return av(az.error)}var ay=az.txn,au=ay.objectStore(g2).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,aw=ah._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:ax,idb_attachment_format:ah._meta.blobSupport?"binary":"base64"})}},ah._allDocs=function(av,au){ix(av,ah,ad,au)},ah._changes=function(aB){function aH(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aL=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aG.get(aU);aT.onsuccess=function(aV){aO(gy(aV.target.result))}}function aO(aU){var aT=aB.processChange(aU,aN,aB);aT.seq=aN.seq;var aV=aI(aT);return"object"==typeof aV?aB.complete(aV):(aV&&(ax++,aK&&aw.push(aT),aB.attachments&&aB.include_docs?iJ(aU,aB,aD,function(){i2([aT],aB.binary).then(function(){aB.onChange(aT)})}):aB.onChange(aT)),void (ax!==aJ&&aS["continue"]()))}var aQ=gy(aS.value),aR=aS.key;if(az&&!az.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aF.get(aQ._id).onsuccess=function(aT){aN=jD(aT.target.result),ay.set(aQ._id,aN),aM()})}function aE(aN){var aM=aN.target.result;aM&&aH(aM)}function aA(){var aM=[gv,g2];aB.attachments&&aM.push(gQ);var aN=hL(ad,aM,"readonly");if(aN.error){return aB.complete(aN.error)}aD=aN.txn,aD.onabort=fa(aB.complete),aD.oncomplete=au,av=aD.objectStore(g2),aF=aD.objectStore(gv),aG=av.index("_doc_id_rev");var aO;aO=aB.descending?av.openCursor(null,"prev"):av.openCursor(IDBKeyRange.lowerBound(aB.since,!0)),aO.onsuccess=aE}function au(){function aM(){aB.complete(null,{results:aw,last_seq:aL})}!aB.continuous&&aB.attachments?i2(aw).then(aM):aM()}if(aB=g9(aB),aB.continuous){var aC=aa+":"+g6();return a2.addListener(aa,aC,ah,aB),a2.notify(aa),{cancel:function(){a2.removeListener(aa,aC)}}}var az=aB.doc_ids&&new ij.Set(aB.doc_ids);aB.since=aB.since||0;var aL=aB.since,aJ="limit" in aB?aB.limit:-1;0===aJ&&(aJ=1);var aK;aK="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aD,av,aF,aG,aw=[],ax=0,aI=jB(aB),ay=new ij.Map;aA()},ah._close=function(au){return null===ad?au(jt(hO)):(ad.close(),hQ["delete"](aa),ad=null,void au())},ah._getRevisionTree=function(ax,aw){var ay=hL(ad,[gv],"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,av=au.objectStore(gv).get(ax);av.onsuccess=function(aA){var az=jD(aA.target.result);az?aw(null,az.rev_tree):aw(jt(fV))}},ah._doCompaction=function(aA,av,aw){var au=[gv,g2,gQ,gH],ax=hL(ad,au,"readwrite");if(ax.error){return aw(ax.error)}var az=ax.txn,ay=az.objectStore(gv);ay.get(aA).onsuccess=function(aC){var aE=jD(aC.target.result);ga(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),jq(av,aA,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(gv).put(jn(aE,aD,aB))},az.onabort=fa(aw),az.oncomplete=function(){aw()}},ah._getLocal=function(ax,aw){var ay=hL(ad,[ic],"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,av=au.objectStore(ic).get(ax);av.onerror=fa(aw),av.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,aw(null,az)):aw(jt(fV))}},ah._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hL(ad,[ic],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=fa(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(ic);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(jt(hc))}}):(au=ax.add(ay),au.onerror=function(aE){av(jt(hc)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ah._removeLocal=function(aw,aB,aC){"function"==typeof aB&&(aC=aB,aB={});var ay=aB.ctx;if(!ay){var ax=hL(ad,[ic],"readwrite");if(ax.error){return aC(ax.error)}ay=ax.txn,ay.oncomplete=function(){az&&aC(null,az)}}var az,av=aw._id,aA=ay.objectStore(ic),au=aA.get(av);au.onerror=fa(aC),au.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aw._rev?(aA["delete"](av),az={ok:!0,id:av,rev:"0-0"},aB.ctx&&aC(null,az)):aC(jt(fV))}},ah._destroy=function(aw,au){a2.removeAllListeners(aa);var av=o.get(aa);av&&av.result&&(av.result.close(),hQ["delete"](aa));var ax=indexedDB.deleteDatabase(aa);ax.onsuccess=function(){o["delete"](aa),gf()&&aa in localStorage&&delete localStorage[aa],au(null,{ok:!0})},ax.onerror=fa(au)};var ak=hQ.get(aa);if(ak){return ad=ak.idb,ah._meta=ak.global,void gX.nextTick(function(){ab(null,ah)})}var t;t=ag.storage?ji(aa,ag.storage):indexedDB.open(aa,h8),o.set(aa,t),t.onupgradeneeded=function(ax){function az(){var aA=av[au-1];au++,aA&&aA(ay,az)}var aw=ax.target.result;if(ax.oldVersion<1){return aq(aw)}var ay=ax.currentTarget.transaction;ax.oldVersion<3&&ac(aw),ax.oldVersion<4&&am(aw);var av=[ap,aj,al,af],au=ax.oldVersion;az()},t.onsuccess=function(aw){ad=aw.target.result,ad.onversionchange=function(){ad.close(),hQ["delete"](aa)},ad.onabort=function(aA){iO("error","Database has a global failure",aA.target.error),ad.close(),hQ["delete"](aa)};var ay=ad.transaction([ir,jx,gv],"readwrite"),av=ay.objectStore(ir).get(ir),ax=null,az=null,au=null;av.onsuccess=function(aB){var aD=function(){null!==ax&&null!==az&&null!==au&&(ah._meta={name:aa,instanceId:au,blobSupport:ax,docCount:az},hQ.set(aa,{idb:ad,global:ah._meta}),ab(null,ah))},aA=aB.target.result||{id:ir};aa+"_id" in aA?(au=aA[aa+"_id"],aD()):(au=g6(),aA[aa+"_id"]=au,ay.objectStore(ir).put(aA).onsuccess=function(){aD()}),fm||(fm=jA(ay)),fm.then(function(aE){ax=aE,aD()});var aC=ay.objectStore(gv).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){az=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iO("error",au),ab(jt(ew,au))}}function ji(aa,ab){try{return indexedDB.open(aa,{version:h8,storage:ab})}catch(t){return indexedDB.open(aa,h8)}}function iI(t){t.adapter("idb",a8,!0)}function iw(t){return decodeURIComponent(escape(t))}function js(t){return 65>t?t-48:t-55}function jy(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(js(t.charCodeAt(ab++))<<4|js(t.charCodeAt(ab++)))}return aa}function ig(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(js(t.charCodeAt(ab+2))<<12|js(t.charCodeAt(ab+3))<<8|js(t.charCodeAt(ab))<<4|js(t.charCodeAt(ab+1))),ab+=4}return aa}function id(aa,t){return"UTF-8"===t?iw(jy(aa,0,aa.length)):ig(aa,0,aa.length)}function hX(t){return"'"+t+"'"}function iH(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hT(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jh(t){return delete t._id,delete t._rev,JSON.stringify(t)}function it(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function hD(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function hW(ad,aa,ab,t,ac){return"SELECT "+ad+" FROM "+("string"==typeof aa?aa:aa.join(" JOIN "))+(ab?" ON "+ab:"")+(t?" WHERE "+("string"==typeof t?t:t.join(" AND ")):"")+(ac?" ORDER BY "+ac:"")}function jf(ac,t,ag){function ad(){++aa===ac.length&&ab()}function ab(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+i9+" WHERE seq IN "+hD(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+i9+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+i9+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new ij.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+i9+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+jv+" WHERE digest=?",[az]))})})})}})}}if(ac.length){var aa=0,af=[];ac.forEach(function(aj){var ah="SELECT seq FROM "+T+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[t,aj],function(al,am){if(!am.rows.length){return ad()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+T+" WHERE seq=?",[ak],ad)})})}}function hV(t){return function(ad){iO("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(jt(hM,ab,ac))}}function gj(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function hk(ay,al,az,au,aB,ab,aA){function av(){return ah?aA(ah):(ab.notify(au._name),au._docCount=-1,void aA(null,am))}function aw(aD,aE){var aC="SELECT count(*) as cnt FROM "+jv+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=jt(ht,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ag(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aw(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ad(aF,aM,aC,aH,aJ,aP,aK,aN){function aD(){function aW(bc,bb){function ba(){return ++bd===bf.length&&bb(),!1}function aZ(bi){var bh="INSERT INTO "+i9+" (digest, seq) VALUES (?,?)",bj=[aX._attachments[bi].digest,bc];ap.executeSql(bh,bj,ba,ba)}var bd=0,bf=Object.keys(aX._attachments||{});if(!bf.length){return bb()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aX=aF.data,aU=aH?1:0,aR=aX._id,aV=aX._rev,aT=jh(aX),aS="INSERT INTO "+T+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aY=[aR,aV,aT,aU];ap.executeSql(aS,aY,function(bb,aZ){var ba=aZ.insertId;aW(ba,function(){aE(bb,ba)})},function(){var aZ=hW("seq",T,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aR,aV],function(bc,bb){var bf=bb.rows.item(0).seq,bd="UPDATE "+T+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aT,aU,aR,aV];bc.executeSql(bd,ba,function(bg){aW(bf,function(){aE(bg,bf)})})}),!1})}function aG(aR){aI||(aR?(aI=aR,aN(aI)):aO===aQ.length&&aD())}function aL(aR){aO++,aG(aR)}function aE(aS,aT){var aX=aF.metadata.id,aR=aF.stemmedRevs||[];aJ&&au.auto_compaction&&(aR=iz(aF.metadata).concat(aR)),aR.length&&jf(aR,aX,aS),aF.metadata.seq=aT,delete aF.metadata.rev;var aW=aJ?"UPDATE "+gq+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+T+" WHERE doc_id="+gq+".id AND rev=?) WHERE id=?":"INSERT INTO "+gq+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aV=i3(aF.metadata),aU=aJ?[aV,aT,aM,aX]:[aX,aT,aT,aV];aS.executeSql(aW,aU,function(){am[aK]={ok:!0,id:aF.metadata.id,rev:aM},ac.set(aX,aF.metadata),aN()})}var aI=null,aO=0;aF.data._id=aF.metadata.id,aF.data._rev=aF.metadata.rev;var aQ=Object.keys(aF.data._attachments||{});aH&&(aF.data._deleted=!0),aQ.forEach(function(aU){var aS=aF.data._attachments[aU];if(aS.stub){aO++,aG()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aM,10);var aT=aS.digest;ak(aT,aR,aL)}}),aQ.length||aD()}function t(){ja(ay.revs_limit,aq,au,ac,ap,am,ad,az)}function ax(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&iD(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+gq+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=S(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function ak(aD,aF,aC){var aE="SELECT digest FROM "+jv+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+jv+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iH(aF)],function(){aC()},function(){return aC(),!1}))})}var aa=az.new_edits,aj=al.docs,aq=aj.map(function(aC){if(aC._id&&iD(aC._id)){return aC}var aD=iy(aC,aa);return aD}),af=aq.filter(function(aC){return aC.error});if(af.length){return aA(af[0])}var ap,ah,am=new Array(aq.length),ac=new ij.Map;Z(aq,"binary",function(aC){return aC?aA(aC):void aB.transaction(function(aD){ap=aD,ag(function(aE){aE?ah=aE:ax(t)})},hV(aA),av)})}function ft(t){return t.websql(t.name,t.version,t.description,t.size)}function il(aa){try{return{db:ft(aa)}}catch(t){return{error:t}}}function gr(aa){var t=J.get(aa.name);return t||(t=il(aa),J.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function h6(ad,aa,ag,aj,af){function ac(){++ab===ah.length&&af&&af()}function t(am,ak){var al=am._attachments[ak],ap={binary:aa.binary,ctx:aj};ag._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=gD.extend(er(al,["digest","content_type"]),{data:au}),ac()})}var ah=Object.keys(ad._attachments||{});if(!ah.length){return af&&af()}var ab=0;ah.forEach(function(ak){aa.attachments&&aa.include_docs?t(ad,ak):(ad._attachments[ak].stub=!0,ac())})}function iM(ad,aC){function am(){gf()&&(window.localStorage["_pouch__websqldb_"+ac._name]=!0),aC(null,ac)}function aB(aD,aE){aD.executeSql(B),aD.executeSql("ALTER TABLE "+T+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(gS),aD.executeSql("ALTER TABLE "+gq+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+gq+" (local, id)");var aF="SELECT "+gq+".winningseq AS seq, "+gq+".json AS metadata FROM "+T+" JOIN "+gq+" ON "+T+".seq = "+gq+".winningseq";aD.executeSql(aF,[],function(aI,aM){for(var aJ=[],aG=[],aN=0;aN<aM.rows.length;aN++){var aL=aM.rows.item(aN),aK=aL.seq,aH=JSON.parse(aL.metadata);fu(aH)&&aJ.push(aK),iD(aH.id)&&aG.push(aH.id)}aI.executeSql("UPDATE "+gq+"SET local = 1 WHERE id IN "+hD(aG.length),aG,function(){aI.executeSql("UPDATE "+T+" SET deleted = 1 WHERE seq IN "+hD(aJ.length),aJ,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+f+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+gq+".id AS id, "+T+".json AS data FROM "+T+" JOIN "+gq+" ON "+T+".seq = "+gq+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aI,aL){function aJ(){if(!aH.length){return aF(aI)}var aM=aH.shift(),aN=JSON.parse(aM.data)._rev;aI.executeSql("INSERT INTO "+f+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+gq+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+T+" WHERE seq=?",[aM.seq],function(){aJ()})})})}for(var aH=[],aK=0;aK<aL.rows.length;aK++){aH.push(aL.rows.item(aK))}aJ()})})}function aw(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aJ=aI.shift(),aL=id(aJ.hex,au),aO=aL.lastIndexOf("::"),aK=aL.substring(0,aO),aM=aL.substring(aO+2),aN="UPDATE "+T+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aN,[aK,aM,aL],function(){aH()})}aH()}var aF="ALTER TABLE "+T+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+T+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(iR,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+T;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function aa(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+jv;aH.executeSql(aI,[],function(aK,aO){function aL(){var aP=hW(iY+", "+gq+".id AS id",[gq,T],jr,null,gq+".id ");aP+=" LIMIT "+aN+" OFFSET "+aM,aM+=aN,aK.executeSql(aP,[],function(ba,aZ){function aV(bc,bd){var bf=aX[bc]=aX[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aZ.rows.length){return aG(ba)}for(var aX={},aT=0;aT<aZ.rows.length;aT++){for(var aQ=aZ.rows.item(aT),aS=it(aQ.data,aQ.id,aQ.rev),aW=Object.keys(aS._attachments||{}),aU=0;aU<aW.length;aU++){var aY=aS._attachments[aW[aU]];aV(aY.digest,aQ.seq)}}var aR=[];if(Object.keys(aX).forEach(function(bc){var bd=aX[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aL()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+i9+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aL()})})})}var aJ=aO.rows.item(0).cnt;if(!aJ){return aG(aK)}var aM=0,aN=10;aL()})}var aF="CREATE TABLE IF NOT EXISTS "+i9+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(a6,[],function(aI){aI.executeSql(jp,[],aD)})})}function aj(aE,aF){var aD="ALTER TABLE "+jv+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ak(aE,aF){var aD="ALTER TABLE "+gq+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+gq+" SET max_seq=(SELECT MAX(seq) FROM "+T+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+gq+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ag(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;au=2===aG.length?"UTF-8":"UTF-16",aE()})}function ab(){for(;al.length>0;){var aD=al.pop();aD(null,az)}}function ah(aL,aD){if(0===aD){var aG="CREATE TABLE IF NOT EXISTS "+ff+" (dbid, db_version INTEGER)",aJ="CREATE TABLE IF NOT EXISTS "+jv+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aM="CREATE TABLE IF NOT EXISTS "+i9+" (digest, seq INTEGER)",aO="CREATE TABLE IF NOT EXISTS "+gq+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aN="CREATE TABLE IF NOT EXISTS "+T+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aH="CREATE TABLE IF NOT EXISTS "+f+" (id UNIQUE, rev, json)";aL.executeSql(aJ),aL.executeSql(aH),aL.executeSql(aM,[],function(){aL.executeSql(jp),aL.executeSql(a6)}),aL.executeSql(aO,[],function(){aL.executeSql(B),aL.executeSql(aN,[],function(){aL.executeSql(gS),aL.executeSql(iR),aL.executeSql(aG,[],function(){var aP="INSERT INTO "+ff+" (db_version, dbid) VALUES (?,?)";az=g6();var aQ=[iL,az];aL.executeSql(aP,aQ,function(){ab()})})})})}else{var aF=function(){var aQ=iL>aD;aQ&&aL.executeSql("UPDATE "+ff+" SET db_version = "+iL);var aP="SELECT dbid FROM "+ff;aL.executeSql(aP,[],function(aR,aS){az=aS.rows.item(0).dbid,ab()})},aI=[aB,aq,aw,aa,aj,ak,aF],aK=aD,aE=function(aP){aI[aK-1](aP,aE),aK++};aE(aL)}}function ay(){t.transaction(function(aD){ag(aD,function(){ap(aD)})},hV(aC),am)}function ap(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+ff;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+ff,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;ah(aI,aH)}):aF.executeSql("ALTER TABLE "+ff+" ADD COLUMN db_version INTEGER",[],function(){ah(aF,1)}):ah(aF,0)})}function av(aE,aF){if(-1!==ac._docCount){return aF(ac._docCount)}var aD=hW("COUNT("+gq+".id) AS 'num'",[gq,T],jr,T+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ac._docCount=aH.rows.item(0).num,aF(ac._docCount)})}var au,ac=this,az=null,aA=gj(ad),al=[];ac._docCount=-1,ac._name=ad.name;var af=gD.extend({},ad,{version:p,description:ad.name,size:aA}),ax=gr(af);if(ax.error){return hV(aC)(ax.error)}var t=ax.db;"function"!=typeof t.readTransaction&&(t.readTransaction=t.transaction),ay(),ac.type=function(){return"websql"},ac._id=fy(function(aD){aD(null,az)}),ac._info=function(aD){t.readTransaction(function(aE){av(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+T;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:t._sqlitePlugin,websql_encoding:au})})})},hV(aD))},ac._bulkDocs=function(aF,aD,aE){hk(ad,aF,aD,ac,t,i0,aE)},ac._get=function(aM,aL,aE){function aH(){aE(aJ,{doc:aG,metadata:aD,ctx:aF})}var aG,aD,aJ,aF=aL.ctx;if(!aF){return t.readTransaction(function(aN){ac._get(aM,gD.extend({ctx:aN},aL),aE)})}var aI,aK;aL.rev?(aI=hW(iY,[gq,T],gq+".id="+T+".doc_id",[T+".doc_id=?",T+".rev=?"]),aK=[aM,aL.rev]):(aI=hW(iY,[gq,T],jr,gq+".id=?"),aK=[aM]),aF.executeSql(aI,aK,function(aP,aO){if(!aO.rows.length){return aJ=jt(fV,"missing"),aH()}var aN=aO.rows.item(0);return aD=S(aN.metadata),aN.deleted&&!aL.rev?(aJ=jt(fV,"deleted"),aH()):(aG=it(aN.data,aD.id,aN.rev),void aH())})},ac._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(gq+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(gq+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(gq+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(gq+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(T+".deleted = 0"),t.readTransaction(function(aR){av(aR,function(aT){if(aM=aT,0!==aO){var aS=hW(iY,[gq,T],jr,aE,gq+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(ba,aX){for(var aY=0,aU=aX.rows.length;aU>aY;aY++){var bb=aX.rows.item(aY),aZ=S(bb.metadata),aV=aZ.id,bc=it(bb.data,aV,bb.rev),aW=bc._rev,bd={id:aV,key:aV,value:{rev:aW}};if(aJ.include_docs&&(bd.doc=bc,bd.doc._rev=aW,aJ.conflicts&&(bd.doc._conflicts=fS(aZ)),h6(bd.doc,aJ,ac,ba)),bb.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},hV(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},ac._changes=function(aJ){function aI(){var aN=gq+".json AS metadata, "+gq+".max_seq AS maxSeq, "+T+".json AS winningDoc, "+T+".rev AS winningRev ",aM=gq+" JOIN "+T,aO=gq+".id="+T+".doc_id AND "+gq+".winningseq="+T+".seq",aP=["maxSeq > ?"],aR=[aJ.since];aJ.doc_ids&&(aP.push(gq+".id IN "+hD(aJ.doc_ids.length)),aR=aR.concat(aJ.doc_ids));var aL="maxSeq "+(aE?"DESC":"ASC"),aS=hW(aN,aM,aO,aP,aL),aT=jB(aJ);aJ.view||aJ.filter||(aS+=" LIMIT "+aH);var aQ=aJ.since||0;t.readTransaction(function(aU){aU.executeSql(aS,aR,function(aX,aW){function aY(bg){return function(){aJ.onChange(bg)}}for(var bc=0,bd=aW.rows.length;bd>bc;bc++){var aV=aW.rows.item(bc),aZ=S(aV.metadata);aQ=aV.maxSeq;var bf=it(aV.winningDoc,aZ.id,aV.winningRev),ba=aJ.processChange(bf,aZ,aJ);ba.seq=aV.maxSeq;var bb=aT(ba);if("object"==typeof bb){return aJ.complete(bb)}if(bb&&(aF++,aK&&aD.push(ba),aJ.attachments&&aJ.include_docs?h6(bf,aJ,ac,aX,aY(ba)):aY(ba)()),aF===aH){break}}})},hV(aJ.complete),function(){aJ.continuous||aJ.complete(null,{results:aD,last_seq:aQ})})}if(aJ=g9(aJ),aJ.continuous){var aG=ac._name+":"+g6();return i0.addListener(ac._name,aG,ac,aJ),i0.notify(ac._name),{cancel:function(){i0.removeListener(ac._name,aG)}}}var aE=aJ.descending;aJ.since=aJ.since&&!aE?aJ.since:0;var aH="limit" in aJ?aJ.limit:-1;0===aH&&(aH=1);var aK;aK="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aD=[],aF=0;aI()},ac._close=function(aD){aD()},ac._getAttachment=function(aM,aL,aE,aH,aG){var aD,aJ=aH.ctx,aF=aE.digest,aI=aE.content_type,aK="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+jv+" WHERE digest=?";aJ.executeSql(aK,[aF],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hT(aO.body):id(aO.body,au);aD=aH.binary?y(aN,aI):gu(aN),aG(null,aD)})},ac._getRevisionTree=function(aD,aE){t.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+gq+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=S(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(jt(fV))}})})},ac._doCompaction=function(aE,aF,aD){return aF.length?void t.transaction(function(aH){var aG="SELECT json AS metadata FROM "+gq+" WHERE id = ?";aH.executeSql(aG,[aE],function(aL,aJ){var aI=S(aJ.rows.item(0).metadata);ga(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+gq+" SET json = ? WHERE id = ?";aL.executeSql(aK,[i3(aI),aE])}),jf(aF,aE,aH)},hV(aD),function(){aD()}):aD()},ac._getLocal=function(aD,aE){t.readTransaction(function(aF){var aG="SELECT json, rev FROM "+f+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=it(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(jt(fV))}})})},ac._putLocal=function(aG,aL,aI){function aK(aO){var aM,aN;aH?(aM="UPDATE "+f+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aJ,aD,aE,aH]):(aM="INSERT INTO "+f+" (id, rev, json) VALUES (?,?,?)",aN=[aE,aJ,aD]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aF={ok:!0,id:aE,rev:aJ},aL.ctx&&aI(null,aF)):aI(jt(hc))},function(){return aI(jt(hc)),!1})}"function"==typeof aL&&(aI=aL,aL={}),delete aG._revisions;var aJ,aH=aG._rev,aE=aG._id;aJ=aH?aG._rev="0-"+(parseInt(aH.split("-")[1],10)+1):aG._rev="0-1";var aF,aD=jh(aG);aL.ctx?aK(aL.ctx):t.transaction(aK,hV(aI),function(){aF&&aI(null,aF)})},ac._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+f+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(jt(fV))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):t.transaction(aF,hV(aH),function(){aD&&aH(null,aD)})},ac._destroy=function(aD,aE){i0.removeAllListeners(ac._name),t.transaction(function(aF){var aG=[gq,T,jv,ff,f,i9];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},hV(aE),function(){gf()&&(delete window.localStorage["_pouch__websqldb_"+ac._name],delete window.localStorage[ac._name]),aE(null,{ok:!0})})}}function a0(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function ha(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var aa=gf(),ab="_pouch__websqldb_valid_"+navigator.userAgent;if(aa&&localStorage[ab]){return"1"===localStorage[ab]}var t=a0();return aa&&(localStorage[ab]=t?"1":"0"),t}function gA(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:ha()}function jE(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=gD.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function fq(t,ab){var ac=jE(t),aa=gD.extend({websql:ac},t);iM.call(this,aa,ab)}function an(t){t.adapter("websql",fq,!0)}function ip(){for(var t={},ab=new hw(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,hw.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function P(ac,t){var ag,ad,ab,aa=new Headers,af={method:ac.method,credentials:"include",headers:aa};return ac.json&&(aa.set("Accept","application/json"),aa.set("Content-Type",ac.headers["Content-Type"]||"application/json")),ac.body&&ac.body instanceof Blob?dt(ac.body,function(ah){af.body=ah}):ac.body&&ac.processData&&"string"!=typeof ac.body?af.body=JSON.stringify(ac.body):"body" in ac?af.body=ac.body:af.body=null,Object.keys(ac.headers).forEach(function(ah){ac.headers.hasOwnProperty(ah)&&aa.set(ah,ac.headers[ah])}),ag=ip(ac.url,af),ac.timeout>0&&(ad=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ac.url))},ac.timeout)),ag.promise.then(function(ah){return ab={statusCode:ah.status},ac.timeout>0&&clearTimeout(ad),ab.statusCode>=200&&ab.statusCode<300?ac.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ab.statusCode>=200&&ab.statusCode<300?t(null,ab,ah):t(ah,ab)})["catch"](function(ah){t(ah,ab)}),{abort:ag.reject}}function hF(ad,aa){var ag,aj,af=!1,ac=function(){ag.abort()},t=function(){af=!0,ag.abort()};ag=ad.xhr?new ad.xhr:new XMLHttpRequest;try{ag.open(ad.method,ad.url)}catch(ah){aa(ah,{statusCode:413})}ag.withCredentials="withCredentials" in ad?ad.withCredentials:!0,"GET"===ad.method?delete ad.headers["Content-Type"]:ad.json&&(ad.headers.Accept="application/json",ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json",ad.body&&ad.processData&&"string"!=typeof ad.body&&(ad.body=JSON.stringify(ad.body))),ad.binary&&(ag.responseType="arraybuffer"),"body" in ad||(ad.body=null);for(var ab in ad.headers){ad.headers.hasOwnProperty(ab)&&ag.setRequestHeader(ab,ad.headers[ab])}return ad.timeout>0&&(aj=setTimeout(t,ad.timeout),ag.onprogress=function(){clearTimeout(aj),4!==ag.readyState&&(aj=setTimeout(t,ad.timeout))},"undefined"!=typeof ag.upload&&(ag.upload.onprogress=ag.onprogress)),ag.onreadystatechange=function(){if(4===ag.readyState){var ak={statusCode:ag.status};if(ag.status>=200&&ag.status<300){var am;am=ad.binary?z([ag.response||""],{type:ag.getResponseHeader("Content-Type")}):ag.responseText,aa(null,ak,am)}else{var ap={};if(af){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ag.response)}catch(al){}}aa(ap,ak)}}},ad.body&&ad.body instanceof Blob?dt(ad.body,function(ak){ag.send(ak)}):ag.send(ad.body),{abort:ac}}function a4(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function r(aa,t){return jj||aa.xhr?hF(aa,t):P(aa,t)}function j(){return""}function i1(ad,aa){function ab(af,ag,aj){if(!ad.binary&&ad.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?gl(ak):ak})),ad.binary&&gZ(af,ag),aj(null,af,ag)}function t(ag,aj){var al,ah;if(ag.code&&ag.status){var af=new Error(ag.message||ag.code);return af.status=ag.status,aj(af)}if(ag.message&&"ETIMEDOUT"===ag.message){return aj(ag)}try{al=JSON.parse(ag.responseText),ah=gl(al)}catch(ak){ah=gl(ag)}aj(ah)}ad=g9(ad);var ac={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ad=gD.extend(ac,ad),ad.json&&(ad.binary||(ad.headers.Accept="application/json"),ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json"),ad.binary&&(ad.encoding=null,ad.json=!1),ad.processData||(ad.json=!1),r(ad,function(al,ag,aj){if(al){return al.status=ag?ag.statusCode:400,t(al,aa)}var af,ah=ag.headers&&ag.headers["content-type"],ak=aj||j();if(!ad.binary&&(ad.json||!ad.processData)&&"object"!=typeof ak&&(/json/.test(ah)||/^[\s]*\{/.test(ak)&&/\}[\s]*$/.test(ak))){try{ak=JSON.parse(ak.toString())}catch(am){}}ag.statusCode>=200&&ag.statusCode<300?ab(ak,ag,aa):(af=gl(ak),af.status=ag.statusCode,aa(af))})}function fw(aa,aj){var ad=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ag=-1!==ad.indexOf("safari")&&-1===ad.indexOf("chrome"),af=-1!==ad.indexOf("msie"),ac=-1!==ad.indexOf("edge"),ak=ag||(af||ac)&&"GET"===aa.method,ah="cache" in aa?aa.cache:!0,ab=/^blob:/.test(aa.url);if(!ab&&(ak||!ah)){var t=-1!==aa.url.indexOf("?");aa.url+=(t?"&":"?")+"_nonce="+Date.now()}return i1(aa,aj)}function ey(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=g5(ab.data,ab.content_type)})}function ev(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function g(t){return t._attachments&&Object.keys(t._attachments)?hw.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hw(function(ac){jk(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hw.resolve()}function gY(aa){var ab=hH(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function gV(aa,t){return l(aa,aa.db+"/"+t)}function l(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function hZ(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function gK(aj,ac){function ab(ax,ay,aw){var aA=ax.ajax||{},az=gD.extend(g9(ag),aA,ay);return hb(az.method+" "+az.url),ap._ajax(az,aw)}function ah(ax,aw){return new hw(function(az,ay){ab(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(ax,aw){return fc(ax,i5(function(ay){t().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function t(){if(aj.skipSetup||aj.skip_setup){return hw.resolve()}if(av){return av}var aw={method:"GET",url:ad};return av=ah({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(h2(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:ad})):hw.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hw.reject(ax)}),av["catch"](function(){av=null}),av}function aa(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ap=this,af=gY;aj.getHost&&(af=aj.getHost);var au=af(aj.name,aj),ad=gV(au,"");aj=g9(aj);var ag=aj.ajax||{};if(ap.getUrl=function(){return ad},ap.getHeaders=function(){return ag.headers||{}},aj.auth||au.auth){var ak=aj.auth||au.auth,al=ak.username+":"+ak.password,am=gu(unescape(encodeURIComponent(al)));ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+am}ap._ajax=fw;var av;setTimeout(function(){ac(null,ap)}),ap.type=function(){return"http"},ap.id=aq("id",function(aw){ab({},{method:"GET",url:l(au,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+au.db:gV(au,"");aw(null,ay)})}),ap.request=aq("request",function(ax,aw){ax.url=gV(au,ax.url),ab({},ax,aw)}),ap.compact=aq("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=g9(ax),ab(ax,{url:gV(au,"_compact"),method:"POST"},function(){function ay(){ap.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ap.bulkGet=fc("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ab({},{url:gV(au,"_bulk_get"+hZ(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aE(aK){return function(aM,aL){aI[aK]=aL.results,++aD===aG&&aA(null,{results:H(aI)})}}for(var aH=ce,aG=Math.ceil(aC.docs.length/aH),aD=0,aI=new Array(aG),aJ=0;aG>aJ;aJ++){var aF=er(aC,["revs","attachments"]);aF.ajax=ag,aF.docs=aC.docs.slice(aJ*aH,Math.min(aC.docs.length,(aJ+1)*aH)),fd(ay,aF,aE(aJ))}}var ay=this,aw=l(au,""),az=jb[aw];"boolean"!=typeof az?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(jb[aw]=!1,h2(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{jb[aw]=!0,aA(null,aE)}}):az?aB(aA):ax()}),ap._info=function(aw){t().then(function(){ab({},{method:"GET",url:gV(au,"")},function(ay,ax){return ay?aw(ay):(ax.host=gV(au,""),void aw(null,ax))})})["catch"](aw)},ap.get=aq("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hw.all(aF.map(function(aG){var aI=aD[aG],aH=ev(aE._id)+"/"+aa(aG)+"?rev="+aE._rev;return ah(aC,{method:"GET",url:gV(au,aH),binary:!0}).then(function(aJ){return aC.binary?aJ:new hw(function(aK){jk(aJ,aK)})}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?hw.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=g9(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=ev(aA);var aw={method:"GET",url:gV(au,aA+hZ(az))};ah(aC,aw).then(function(aD){return hw.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ap.remove=aq("remove",function(ax,aB,az,aw){var ay;"string"==typeof aB?(ay={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(ay=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var aA=ay._rev||az.rev;ab(az,{method:"DELETE",url:gV(au,ev(ay._id))+"?rev="+aA},aw)}),ap.getAttachment=aq("getAttachment",function(ax,az,aB,ay){"function"==typeof aB&&(ay=aB,aB={});var aA=aB.rev?"?rev="+aB.rev:"",aw=gV(au,ev(ax))+"/"+aa(az)+aA;ab(aB,{method:"GET",url:aw,binary:!0},ay)}),ap.removeAttachment=aq("removeAttachment",function(ax,ay,aA,aw){var az=gV(au,ev(ax)+"/"+aa(ay))+"?rev="+aA;ab({},{method:"DELETE",url:az},aw)}),ap.putAttachment=aq("putAttachment",function(aF,aB,az,ay,aw,aA){"function"==typeof aw&&(aA=aw,aw=ay,ay=az,az=null);var aC=ev(aF)+"/"+aa(aB),aD=gV(au,aC);if(az&&(aD+="?rev="+az),"string"==typeof ay){var ax;try{ax=bt(ay)}catch(aE){return aA(jt(g3,"Attachment is not a valid base64 string"))}ay=ax?y(ax,aw):""}var aG={headers:{"Content-Type":aw},method:"PUT",url:aD,processData:!1,body:ay,timeout:ag.timeout||60000};ab({},aG,aA)}),ap._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,t().then(function(){return hw.all(aw.docs.map(g))}).then(function(){ab(ay,{method:"POST",url:gV(au,"_bulk_docs"),body:aw},function(aA,az){return aA?ax(aA):(az.forEach(function(aB){aB.ok=!0}),void ax(null,az))})})["catch"](ax)},ap.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=g9(aA);var aB,ax={},ay="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var aw=hZ(ax);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=iG?aw+="&"+az:(ay="POST",aB={keys:aA.keys})}ah(aA,{method:ay,url:gV(au,"_all_docs"+aw),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ey),aC(null,aD)})["catch"](aC)}),ap._changes=function(aH){var az="batch_size" in aH?aH.batch_size:hJ;aH=g9(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ag?ag.timeout:30000;var aB,aw=aH.timeout?{timeout:aH.timeout-5000}:{},aF="undefined"!=typeof aH.limit?aH.limit:!1;aB="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var ay=aF;if(aH.style&&(aw.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aw.include_docs=!0),aH.attachments&&(aw.attachments=!0),aH.continuous&&(aw.feed="longpoll"),aH.conflicts&&(aw.conflicts=!0),aH.descending&&(aw.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aw.heartbeat=aH.heartbeat):aw.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aw.filter=aH.filter),aH.view&&"string"==typeof aH.view&&(aw.filter="_view",aw.view=aH.view),aH.query_params&&"object"==typeof aH.query_params){for(var aD in aH.query_params){aH.query_params.hasOwnProperty(aD)&&(aw[aD]=aH.query_params[aD])}}var aJ,ax="GET";if(aH.doc_ids){aw.filter="_doc_ids";var aA=JSON.stringify(aH.doc_ids);aA.length<iG?aw.doc_ids=aA:(ax="POST",aJ={doc_ids:aH.doc_ids})}var aC,aE,aG=function(aM,aN){if(!aH.aborted){aw.since=aM,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aH.descending?aF&&(aw.limit=ay):aw.limit=!aF||ay>az?az:ay;var aL={method:ax,url:gV(au,"_changes"+hZ(aw)),timeout:aH.timeout,body:aJ};aE=aM,aH.aborted||t().then(function(){aC=ab(aH,aL,aN)})["catch"](aN)}},aI={results:[]},aK=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aI.last_seq=aL.last_seq;var aP={};aP.query=aH.query_params,aL.results=aL.results.filter(function(aR){ay--;var aQ=jB(aH)(aR);return aQ&&(aH.include_docs&&aH.attachments&&aH.binary&&ey(aR),aB&&aI.results.push(aR),aH.onChange(aR)),aQ})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(aE=aL.last_seq);var aO=aF&&0>=ay||aL&&az>aM||aH.descending;(!aH.continuous||aF&&0>=ay)&&aO?aH.complete(null,aI):setTimeout(function(){aG(aE,aK)},0)}};return aG(aH.since||0,aK),{cancel:function(){aH.aborted=!0,aC&&aC.abort()}}},ap.revsDiff=aq("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),ab(ay,{method:"POST",url:gV(au,"_revs_diff"),body:aw},ax)}),ap._close=function(aw){aw()},ap._destroy=function(ax,aw){ab(ax,{url:gV(au,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function v(t){t.adapter("http",gK,!1),t.adapter("https",gK,!1)}function W(){this.promise=new hw(function(t){t()})}function gF(ac){var aa=ac.db,af=ac.viewName,ah=ac.map,ag=ac.reduce,ab=ac.temporary,ad=ah.toString()+(ag&&ag.toString())+"undefined";if(!ab&&aa._cachedViews){var t=aa._cachedViews[ad];if(t){return hw.resolve(t)}}return aa.info().then(function(ak){function al(am){am.views=am.views||{};var aq=af;-1===aq.indexOf("/")&&(aq=af+"/"+af);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ab?"temp":gh(ad));return hE(aa,"_local/mrviews",al).then(function(){return aa.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:aa,adapter:aa.adapter,mapFun:ah,reduceFun:ag};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ab||(aa._cachedViews=aa._cachedViews||{},aa._cachedViews[ad]=aq,aq.db.once("destroyed",function(){delete aa._cachedViews[ad]})),aq})})})})}function g7(ad,aa,ab,t,ac,af){return gi("return ("+ad.replace(/;\s*$/,"")+");",{emit:aa,sum:ab,log:t,isArray:ac,toJSON:af})}function M(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function iN(t){return 1===t.length&&/^1-/.test(t[0].rev)}function fr(aa,ab){try{aa.emit("error",ab)}catch(t){iO("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iO("error",ab)}}function i6(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return fr(t,aa),{error:aa}}}function F(aa,ab){var t=hx.collate(aa.key,ab.key);return 0!==t?t:hx.collate(aa.value,ab.value)}function ae(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function hd(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function n(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=g5(ac.data,ac.content_type)})})}function ao(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&n(aa),aa}}function s(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new a5(t)}function gJ(ac){for(var aa=0,af=0,ah=ac.length;ah>af;af++){var ag=ac[af];if("number"!=typeof ag){if(!Array.isArray(ag)){throw s("_sum")}aa="number"==typeof aa?[aa]:aa;for(var ab=0,ad=ag.length;ad>ab;ab++){var t=ag[ab];if("number"!=typeof t){throw s("_sum")}"undefined"==typeof aa[ab]?aa.push(t):aa[ab]+=t}}else{"number"==typeof aa?aa+=ag:aa[0]+=ag}}return aa}function k(ad,aa,ab,t){var ac=aa[ad];"undefined"!=typeof ac&&(t&&(ac=encodeURIComponent(JSON.stringify(ac))),ab.push(ad+"="+ac))}function br(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function iA(t){return t.group_level=br(t.group_level),t.limit=br(t.limit),t.skip=br(t.skip),t}function h(t){if(t){if("number"!=typeof t){return new g8('Invalid value for integer: "'+t+'"')}if(0>t){return new g8('Invalid value for positive integer: "'+t+'"')}}}function fb(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&hx.collate(t[ac],t[aa])>0){throw new g8("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new g8("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new g8("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=h(t[af]);if(ad){throw ad}})}function es(ad,aa,ag){var aj,af=[],ac="GET";if(k("reduce",ag,af),k("include_docs",ag,af),k("attachments",ag,af),k("limit",ag,af),k("descending",ag,af),k("group",ag,af),k("group_level",ag,af),k("skip",ag,af),k("stale",ag,af),k("conflicts",ag,af),k("startkey",ag,af,!0),k("start_key",ag,af,!0),k("endkey",ag,af,!0),k("end_key",ag,af,!0),k("inclusive_end",ag,af),k("key",ag,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ag.keys){var t=2000,ah="keys="+encodeURIComponent(JSON.stringify(ag.keys));ah.length+af.length+1<=t?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?aj={keys:ag.keys}:aa.keys=ag.keys)}if("string"==typeof aa){var ab=M(aa);return ad.request({method:ac,url:"_design/"+ab[0]+"/_view/"+ab[1]+af,body:aj}).then(ao(ag))}return aj=aj||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?aj[ak]=aa[ak]:aj[ak]=aa[ak].toString()}),ad.request({method:"POST",url:"_temp_view"+af,body:aj}).then(ao(ag))}function X(aa,ab,t){return new hw(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function A(t){return new hw(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function iQ(t){return function(aa){if(404===aa.status){return t}throw aa}}function gG(ah,ac,aj){function al(){return iN(ab)?hw.resolve(ad):ac.db.get(ag)["catch"](iQ(ad))}function aa(am){return am.keys.length?ac.db.allDocs({keys:am.keys,include_docs:!0}):hw.resolve({rows:[]})}function ak(ap,aA){for(var aw=[],az={},ax=0,au=aA.rows.length;au>ax;ax++){var aq=aA.rows[ax],ay=aq.doc;if(ay&&(aw.push(ay),az[ay._id]=!0,ay._deleted=!t[ay._id],!ay._deleted)){var am=t[ay._id];"value" in am&&(ay.value=am.value)}}var av=Object.keys(t);return av.forEach(function(aD){if(!az[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),aw.push(aB)}}),ap.keys=hh(av.concat(ap.keys)),aw.push(ap),aw}var ag="_local/doc_"+ah,ad={_id:ag,keys:[]},af=aj[ah],t=af.indexableKeysToKeyValues,ab=af.changes;return al().then(function(am){return aa(am).then(function(ap){return ak(am,ap)})})}function a1(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](iQ({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return hw.all(ad.map(function(ag){return gG(ag,t,ab)})).then(function(ah){var ag=H(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function fY(aa){var ab="string"==typeof aa?aa:aa.name,t=h9[ab];return t||(t=h9[ab]=new W),t}function iZ(t){return iK(fY(t),function(){return ez(t)})()}function ez(ad){function aa(am,ak){var al={id:af._id,key:hx.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=hx.normalizeKey(ak)),aj.push(al)}function ag(ak,al){return function(){return a1(ad,ak,al)}}var aj,af,ac;if("function"==typeof ad.mapFun&&2===ad.mapFun.length){var t=ad.mapFun;ac=function(ak){return t(ak,aa)}}else{ac=g7(ad.mapFun.toString(),aa,gJ,jz,Array.isArray,JSON.parse)}var ah=ad.seq||0,ab=new W;return new hw(function(ap,ak){function al(){ab.finish().then(function(){ad.seq=ah,ap()})}function am(){function aq(au){ak(au)}ad.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:en}).on("complete",function(aD){var av=aD.results;if(!av.length){return al()}for(var aC={},ax=0,aA=av.length;aA>ax;ax++){var aF=av[ax];if("_"!==aF.doc._id[0]){aj=[],af=aF.doc,af._deleted||i6(ad.sourceDB,ac,[af]),aj.sort(F);for(var au,ay={},aG=0,aB=aj.length;aB>aG;aG++){var az=aj[aG],aw=[az.key,az.id];0===hx.collate(az.key,au)&&aw.push(aG);var aE=hx.toIndexableString(aw);ay[aE]=az,au=az.key}aC[aF.doc._id]={indexableKeysToKeyValues:ay,changes:aF.changes}}ah=aF.seq}return ab.add(ag(aC,ah)),av.length<en?al():am()}).on("error",aq)}am()})}function fe(ah,ac,aj){0===aj.group_level&&delete aj.group_level;var al,aa=aj.group||aj.group_level;al=U[ah.reduceFun]?U[ah.reduceFun]:g7(ah.reduceFun.toString(),null,gJ,jz,Array.isArray,JSON.parse);var ak=[],ag=isNaN(aj.group_level)?Number.POSITIVE_INFINITY:aj.group_level;ac.forEach(function(aq){var am=ak[ak.length-1],ap=aa?aq.key:null;return aa&&Array.isArray(ap)&&(ap=ap.slice(0,ag)),am&&0===hx.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ak.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ac=[];for(var ad=0,af=ak.length;af>ad;ad++){var t=ak[ad],ab=i6(ah.sourceDB,al,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof a5){throw ab.error}ac.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:ae(ac,aj.limit,aj.skip)}}function iE(aa,t){return iK(fY(aa),function(){return gR(aa,t)})()}function gR(t,ab){function am(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ap=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=hx.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function aa(av){var aq;if(aq=ak?fe(t,av,ab):{total_rows:ap,offset:ad,rows:av},ab.include_docs){var au=hh(av.map(hd));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:ab.conflicts,attachments:ab.attachments,binary:ab.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=hd(ay),az=aw["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ap,ak=t.reduceFun&&ab.reduce!==!1,ad=ab.skip||0;if("undefined"==typeof ab.keys||ab.keys.length||(ab.limit=0,delete ab.keys),"undefined"!=typeof ab.keys){var aj=ab.keys,ac=aj.map(function(au){var aq={startkey:hx.toIndexableString([au]),endkey:hx.toIndexableString([au,{}])};return am(aq)});return hw.all(ac).then(H).then(aa)}var af={descending:ab.descending};if(ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"undefined"!=typeof ab.startkey&&(af.startkey=ab.descending?hx.toIndexableString([ab.startkey,{}]):hx.toIndexableString([ab.startkey])),"undefined"!=typeof ab.endkey){var ah=ab.inclusive_end!==!1;ab.descending&&(ah=!ah),af.endkey=hx.toIndexableString(ah?[ab.endkey,{}]:[ab.endkey])}if("undefined"!=typeof ab.key){var al=hx.toIndexableString([ab.key]),ag=hx.toIndexableString([ab.key,{}]);af.descending?(af.endkey=al,af.startkey=ag):(af.startkey=al,af.endkey=ag)}return ak||("number"==typeof ab.limit&&(af.limit=ab.limit),af.skip=ad),am(af).then(aa)}function x(t){return t.request({method:"POST",url:"_view_cleanup"})}function gw(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=M(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return iK(fY(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hw.all(af).then(function(){return{ok:!0}})})},iQ({ok:!0}))}function at(ag,t,ac){if("http"===ag.type()){return es(ag,t,ac)}if("function"==typeof ag._query){return X(ag,t,ac)}if("string"!=typeof t){fb(ac,t);var af={db:ag,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return hp.add(function(){return gF(af).then(function(ak){function aj(){return ak.db.destroy()}return hu(iZ(ak).then(function(){return iE(ak,ac)}),aj)})}),hp.finish()}var aa=t,ad=M(aa),ah=ad[0],ab=ad[1];return ag.get("_design/"+ah).then(function(al){var ak=al.views&&al.views[ab];if(!ak||"string"!=typeof ak.map){throw new gm("ddoc "+ah+" has no view named "+ab)}fb(ac,ak);var aj={db:ag,viewName:aa,map:ak.map,reduce:ak.reduce};return gF(aj).then(function(am){return"ok"===ac.stale||"update_after"===ac.stale?("update_after"===ac.stale&&gX.nextTick(function(){iZ(am)}),iE(am,ac)):iZ(am).then(function(){return iE(am,ac)})})})}function g8(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,g8)}catch(t){}}function gm(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gm)}catch(t){}}function a5(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,a5)}catch(t){}}function i7(t){return/^1-/.test(t)}function Q(aa,ab,t){return !aa._attachments||!aa._attachments[t]||aa._attachments[t].digest!==ab._attachments[t].digest}function ai(aa,ab){var t=Object.keys(ab._attachments);return hw.all(t.map(function(ac){return aa.getAttachment(ab._id,ac,{rev:ab._rev})}))}function N(ad,aa,ab){var t="http"===aa.type()&&"http"!==ad.type(),ac=Object.keys(ab._attachments);return t?ad.get(ab._id).then(function(af){return hw.all(ac.map(function(ag){return Q(af,ab,ag)?aa.getAttachment(ab._id,ag):ad.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return ai(aa,ab)}):ai(aa,ab)}function gb(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function iF(aj,ad,ak,aa){function al(){var am=gb(ak);if(am.docs.length){return aj.bulkGet(am).then(function(ap){if(aa.cancelled){throw new Error("cancelled")}return hw.all(ap.results.map(function(aq){return hw.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?N(ad,aj,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(H(aq).filter(Boolean))})})}}function ah(am){return am._attachments&&Object.keys(am._attachments).length>0}function ag(am){return aj.allDocs({keys:am,include_docs:!0}).then(function(ap){if(aa.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&i7(aq.value.rev)&&!ah(aq.doc)&&(t.push(aq.doc),delete ak[aq.id])})})}function ac(){var am=Object.keys(ak).filter(function(aq){var ap=ak[aq].missing;return 1===ap.length&&i7(ap[0])});return am.length>0?ag(am):void 0}function af(){return{ok:ab,docs:t}}ak=g9(ak);var t=[],ab=!0;return hw.resolve().then(ac).then(al).then(af)}function G(ad,aa,ab,t,ac){return ad.get(aa)["catch"](function(af){if(404===af.status){return"http"===ad.type()&&h2(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:t,_id:aa,history:[],replicator:gU,version:C}}throw af}).then(function(af){return ac.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==t}),af.history.unshift({last_seq:ab,session_id:t}),af.history=af.history.slice(0,fk),af.version=C,af.replicator=gU,af.session_id=t,af.last_seq=ab,ad.put(af)["catch"](function(ag){if(409===ag.status){return G(ad,aa,ab,t,ac)}throw ag}))})}function cr(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function je(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:ho(aa.history,t.history)}function ho(ac,aa){var af=ac[0],ah=ac.slice(1),ag=aa[0],ab=aa.slice(1);if(!af||0===aa.length){return{last_seq:dr,history:[]}}var ad=af.session_id;if(hI(ad,aa)){return{last_seq:af.last_seq,history:ac}}var t=ag.session_id;return hI(t,ah)?{last_seq:ag.last_seq,history:ab}:ho(ah,ab)}function hI(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:hI(t,aa):!1}function gc(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function i(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=fp),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=ia})),t.current_back_off=t.current_back_off||ia,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function h4(t){return Object.keys(t).sort(hx.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function fj(ac,t,ag){var ad=ag.doc_ids?ag.doc_ids.sort(hx.collate):"",ab=ag.filter?ag.filter.toString():"",aa="",af="";return ag.filter&&ag.query_params&&(aa=JSON.stringify(h4(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hw.all([ac.id(),t.id()]).then(function(ah){var aj=ah[0]+ah[1]+ab+af+aa+ad;return new hw(function(ak){fx(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function fs(ax,aj,aN,aa,aO){function aH(){return aB?hw.resolve():fj(ax,aj,aN).then(function(aS){al=aS,aB=new cr(ax,aj,al,aa)})}function ab(){if(ad=[],0!==az.docs.length){var aS=az.docs;return aj.bulkDocs({docs:aS,new_edits:!1}).then(function(aU){if(aa.cancelled){throw aP(),new Error("cancelled")}var aX=[],aV={};aU.forEach(function(aY){aY.error&&(aO.doc_write_failures++,aX.push(aY),aV[aY.id]=aY)}),ay=ay.concat(aX),aO.docs_written+=az.docs.length-aX.length;var aW=aX.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aV[aZ._id];aY?aa.emit("denied",g9(aY)):ad.push(aZ)}),aW.length>0){var aT=new Error("bulkDocs error");throw aT.other_errors=aX,aG("target.bulkDocs failed to write docs",aT),new Error("bulkWrite partial failure")}},function(aT){throw aO.doc_write_failures+=aS.length,aT})}}function ah(){if(az.error){throw new Error("There was a problem getting docs.")}aO.last_seq=aI=az.seq;var aS=g9(aO);return ad.length&&(aS.docs=ad,aa.emit("change",aS)),aE=!0,aB.writeCheckpoint(az.seq,aw).then(function(){if(aE=!1,aa.cancelled){throw aP(),new Error("cancelled")}az=void 0,aL()})["catch"](ak)}function au(){var aS={};return az.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aj.revsDiff(aS).then(function(aT){if(aa.cancelled){throw aP(),new Error("cancelled")}az.diffs=aT})}function aC(){return iF(ax,aj,az.diffs,aa).then(function(aS){az.error=!aS.ok,aS.docs.forEach(function(aT){delete az.diffs[aT._id],aO.docs_read++,az.docs.push(aT)})})}function aK(){if(!aa.cancelled&&!az){if(0===aJ.length){return void ap(!0)}az=aJ.shift(),au().then(aC).then(ab).then(ah).then(aK)["catch"](function(aS){aG("batch processing terminated with error",aS)})}}function ap(aS){return 0===aQ.changes.length?void (0!==aJ.length||az||((af&&aM.live||ac)&&(aa.state="pending",aa.emit("paused")),ac&&aP())):void ((aS||ac||aQ.changes.length>=aq)&&(aJ.push(aQ),aQ={seq:0,changes:[],docs:[]},"pending"!==aa.state&&"stopped"!==aa.state||(aa.state="active",aa.emit("active")),aK()))}function aG(aT,aS){aD||(aS.message||(aS.message=aT),aO.ok=!1,aO.status="aborting",aO.errors.push(aS),ay=ay.concat(aS),aJ=[],aQ={seq:0,changes:[],docs:[]},aP())}function aP(){if(!(aD||aa.cancelled&&(aO.status="cancelled",aE))){aO.status=aO.status||"complete",aO.end_time=new Date,aO.last_seq=aI,aD=!0;var aT=ay.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=ay.pop();ay.length>0&&(aS.other_errors=ay),aS.result=aO,i(aN,aa,aS,function(){fs(ax,aj,aN,aa)})}else{aO.errors=ay,aa.emit("complete",aO),aa.removeAllListeners()}}}function av(aT){if(aa.cancelled){return aP()}var aS=jB(aN)(aT);aS&&(aQ.seq=aT.seq,aQ.changes.push(aT),ap(0===aJ.length&&aM.live))}function t(aT){if(ag=!1,aa.cancelled){return aP()}if(aT.results.length>0){aM.since=aT.last_seq,aL(),ap(!0)}else{var aS=function(){af?(aM.live=!0,aL()):ac=!0,ap(!0)};az||0!==aT.results.length?aS():(aE=!0,aB.writeCheckpoint(aT.last_seq,aw).then(function(){aE=!1,aO.last_seq=aI=aT.last_seq,aS()})["catch"](ak))}}function aR(aS){return ag=!1,aa.cancelled?aP():void aG("changes rejected",aS)}function aL(){function aT(){aU.cancel()}function aS(){aa.removeListener("cancel",aT)}if(!ag&&!ac&&aJ.length<am){ag=!0,aa._changes&&(aa.removeListener("cancel",aa._abortChanges),aa._changes.cancel()),aa.once("cancel",aT);var aU=ax.changes(aM).on("change",av);aU.then(aS,aS),aU.then(t)["catch"](aR),aN.retry&&(aa._changes=aU,aa._abortChanges=aT)}}function aF(){aH().then(function(){return aa.cancelled?void aP():aB.getCheckpoint().then(function(aS){aI=aS,aM={since:aI,limit:aq,batch_size:aq,style:"all_docs",doc_ids:aA,return_docs:!0},aN.filter&&("string"!=typeof aN.filter?aM.include_docs=!0:aM.filter=aN.filter),"heartbeat" in aN&&(aM.heartbeat=aN.heartbeat),"timeout" in aN&&(aM.timeout=aN.timeout),aN.query_params&&(aM.query_params=aN.query_params),aN.view&&(aM.view=aN.view),aL()})})["catch"](function(aS){aG("getCheckpoint rejected with ",aS)})}function ak(aS){throw aE=!1,aG("writeCheckpoint completed with error",aS),aS}var az,al,aB,aJ=[],aQ={seq:0,changes:[],docs:[]},aE=!1,ac=!1,aD=!1,aI=0,af=aN.continuous||aN.live||!1,aq=aN.batch_size||100,am=aN.batches_limit||10,ag=!1,aA=aN.doc_ids,ay=[],ad=[],aw=g6();aO=aO||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aM={};return aa.ready(ax,aj),aa.cancelled?void aP():(aa._addedListeners||(aa.once("cancel",aP),"function"==typeof aN.complete&&(aa.once("error",aN.complete),aa.once("complete",function(aS){aN.complete(null,aS)})),aa._addedListeners=!0),void ("undefined"==typeof aN.since?aF():aH().then(function(){return aE=!0,aB.writeCheckpoint(aN.since,aw)}).then(function(){return aE=!1,aa.cancelled?void aP():(aI=aN.since,void aF())})["catch"](ak)))}function ju(){jm.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hw(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function gg(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function he(ac,t,ag,ad){if("function"==typeof ag&&(ad=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw jt(ik,"`doc_ids` filter parameter is not a list.")}ag.complete=ad,ag=g9(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ab=new ju(ag),aa=gg(ac,ag),af=gg(t,ag);return fs(aa,af,ag,ab),ab}function hS(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=g9(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=gg(t,ac),ab=gg(ab,ac),new gP(t,ab,ac,aa)}function gP(ab,ak,aj,t){function al(ay){ad.emit("change",{direction:"pull",change:ay})}function af(ay){ad.emit("change",{direction:"push",change:ay})}function am(ay){ad.emit("denied",{direction:"push",doc:ay})}function ah(ay){ad.emit("denied",{direction:"pull",doc:ay})}function av(){ad.pushPaused=!0,ad.pullPaused&&ad.emit("paused")}function aq(){ad.pullPaused=!0,ad.pushPaused&&ad.emit("paused")}function ac(){ad.pushPaused=!1,ad.pullPaused&&ad.emit("active",{direction:"push"})}function ag(){ad.pullPaused=!1,ad.pushPaused&&ad.emit("active",{direction:"pull"})}function aa(ay){return function(aC,aE){var aD="change"===aC&&(aE===al||aE===af),aA="denied"===aC&&(aE===ah||aE===am),az="paused"===aC&&(aE===aq||aE===av),aB="active"===aC&&(aE===ag||aE===ac);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ad.removeAllListeners(aC))}}var ad=this;this.canceled=!1;var ap=aj.push?gD.extend({},aj,aj.push):aj,aw=aj.pull?gD.extend({},aj,aj.pull):aj;this.push=he(ab,ak,ap),this.pull=he(ak,ab,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};aj.live&&(this.push.on("complete",ad.pull.cancel.bind(ad.pull)),this.pull.on("complete",ad.push.cancel.bind(ad.push))),this.on("newListener",function(ay){"change"===ay?(ad.pull.on("change",al),ad.push.on("change",af)):"denied"===ay?(ad.pull.on("denied",ah),ad.push.on("denied",am)):"active"===ay?(ad.pull.on("active",ag),ad.push.on("active",ac)):"paused"===ay&&(ad.pull.on("paused",aq),ad.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ad.pull.removeListener("change",al),ad.push.removeListener("change",af)):"denied"===ay?(ad.pull.removeListener("denied",ah),ad.push.removeListener("denied",am)):"active"===ay?(ad.pull.removeListener("active",ag),ad.push.removeListener("active",ac)):"paused"===ay&&(ad.pull.removeListener("paused",aq),ad.push.removeListener("paused",av))}),this.pull.on("removeListener",aa("pull")),this.push.on("removeListener",aa("push"));var au=hw.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ad.emit("complete",az),t&&t(null,az),ad.removeAllListeners(),az},function(ay){if(ad.cancel(),t?t(ay):ad.emit("error",ay),ad.removeAllListeners(),t){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function hi(t){t.replicate=he,t.sync=hS}var u,gD=b(9),i8=fi(b(5)),hg=fi(b(8)),gp=fi(b(10)),ij=b(14),i5=fi(b(4)),jm=b(1),gi=fi(b(15)),io=fi(b(16)),gN=fi(b(17)),hx=b(12),hw="function"==typeof Promise?Promise:gp,ei=Function.prototype.toString,g1=ei.call(Object),gx=i8("pouchdb:api"),iq=6;if(ex()){u=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),u=!!localStorage.getItem("_pouch_check_localstorage")}catch(h5){u=!1}}hg(ee,jm.EventEmitter),ee.prototype.addListener=function(ac,t,ag,ad){function ab(){function ah(){af=!1}if(aa._listeners[t]){if(af){return void (af="waiting")}af=!0;var aj=er(ad,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ad.since&&!ad.cancelled&&(ad.since=ak.seq,ad.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ab()},0),af=!1}).on("error",ah)}}if(!this._listeners[t]){var aa=this,af=!1;this._listeners[t]=ab,this.on(ac,ab)}},ee.prototype.removeListener=function(aa,t){t in this._listeners&&jm.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},ee.prototype.notifyLocalWindows=function(t){ex()?chrome.storage.local.set({dbName:t}):gf()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ee.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hg(gd,Error),gd.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var h7=new gd({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),jC=new gd({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),fV=new gd({status:404,error:"not_found",reason:"missing"}),hc=new gd({status:409,error:"conflict",reason:"Document update conflict"}),hK=new gd({status:400,error:"invalid_id",reason:"_id field must contain a string"}),hy=new gd({status:412,error:"missing_id",reason:"_id is required for puts"}),fz=new gd({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hO=new gd({status:412,error:"precondition_failed",reason:"Database not open"}),hl=new gd({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),g3=new gd({status:500,error:"badarg",reason:"Some query argument is invalid"}),gW=new gd({status:400,error:"invalid_request",reason:"Request was invalid"}),fn=new gd({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),et=new gd({status:500,error:"doc_validation",reason:"Bad special document member"}),ik=new gd({status:400,error:"bad_request",reason:"Something wrong with the request"}),gB=new gd({status:400,error:"bad_request",reason:"Document must be a JSON object"}),hG=new gd({status:404,error:"not_found",reason:"Database not found"}),ew=new gd({status:500,error:"indexed_db_went_bad",reason:"unknown"}),hM=new gd({status:500,error:"web_sql_went_bad",reason:"unknown"}),gL=new gd({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fX=new gd({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iX=new gd({status:400,error:"bad_request",reason:"Invalid rev format"}),gT=new gd({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),ht=new gd({status:412,error:"missing_stub"}),fo=new gd({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[h7,jC,fV,hc,hK,hy,fz,hO,hl,g3,gW,fn,et,ik,gB,hG,hM,gL,fX,iX,gT,ht,ew,fo],h3=function(t,ab,ac){var aa=hY.filter(function(ad){return ad[t]===ab});return ac&&aa.filter(function(ad){return ad.message===ac})[0]||aa[0]},dn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],D="queryKey",m=/(?:^|&)([^&=]*)=?([^&]*)/g,de=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hg(hU,jm.EventEmitter),hU.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},hU.prototype.doChanges=function(ad){var aa=this,ab=ad.complete;if(ad=g9(ad),"live" in ad&&!("continuous" in ad)&&(ad.continuous=ad.live),ad.processChange=h1,"latest"===ad.since&&(ad.since="now"),ad.since||(ad.since=0),"now"===ad.since){return void this.db.info().then(function(af){return aa.isCancelled?void ab(null,{status:"cancelled"}):(ad.since=af.update_seq,void aa.doChanges(ad))},ab)}if(ad.continuous&&"now"!==ad.since&&this.db.info().then(function(af){aa.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ad.view&&!ad.filter&&(ad.filter="_view"),ad.filter&&"string"==typeof ad.filter&&("_view"===ad.filter?ad.view=iu(ad.view):ad.filter=iu(ad.filter),"http"!==this.db.type()&&!ad.doc_ids)){return this.filterChanges(ad)}"descending" in ad||(ad.descending=!1),ad.limit=0===ad.limit?1:ad.limit,ad.complete=ab;var t=this.db._changes(ad);if(t&&"function"==typeof t.cancel){var ac=aa.cancel;aa.cancel=i5(function(af){t.cancel(),ac.apply(this,af)})}},hU.prototype.filterChanges=function(ad){var aa=this,ab=ad.complete;if("_view"===ad.filter){if(!ad.view||"string"!=typeof ad.view){var t=jt(ik,"`view` filter parameter not found or invalid.");return ab(t)}var ac=gE(ad.view);this.db.get("_design/"+ac[0],function(ag,ah){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ag){return ab(gl(ag))}var aj=ah&&ah.views&&ah.views[ac[1]]&&ah.views[ac[1]].map;return aj?(ad.filter=jg(aj),void aa.doChanges(ad)):ab(jt(fV,ah.views?"missing json key: "+ac[1]:"missing json key: views"))})}else{var af=gE(ad.filter);if(!af){return aa.doChanges(ad)}this.db.get("_design/"+af[0],function(aj,ah){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(aj){return ab(gl(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(ad.filter=gz(ag),void aa.doChanges(ad)):ab(jt(fV,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hg(jl,jm.EventEmitter),jl.prototype.post=fc("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(jt(gB)):void this.bulkDocs({docs:[aa]},ab,V(t))}),jl.prototype.put=fc("put",i5(function(ad){function aa(){t||(iO("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),t=!0)}var ag,aj,af,ac,t=!1,ah=ad.shift(),ab="_id" in ah;if("object"!=typeof ah||Array.isArray(ah)){return(ac=ad.pop())(jt(gB))}for(;;){if(ag=ad.shift(),aj=typeof ag,"string"!==aj||ab?"string"!==aj||!ab||"_rev" in ah?"object"===aj?af=ag:"function"===aj&&(ac=ag):(aa(),ah._rev=ag):(aa(),ah._id=ag,ab=!0),!ad.length){break}}return af=af||{},go(ah._id),iD(ah._id)&&"function"==typeof this._putLocal?ah._deleted?this._removeLocal(ah,ac):this._putLocal(ah,ac):void this.bulkDocs({docs:[ah]},af,V(ac))})),jl.prototype.putAttachment=fc("putAttachment",function(ac,t,ag,ad,ab){function aa(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[t]={content_type:ab,data:ad,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof ab&&(ab=ad,ad=ag,ag=null),"undefined"==typeof ab&&(ab=ad,ad=ag,ag=null),af.get(ac).then(function(ah){if(ah._rev!==ag){throw jt(hc)}return aa(ah)},function(ah){if(ah.reason===fV.message){return aa({_id:ac})}throw ah})}),jl.prototype.removeAttachment=fc("removeAttachment",function(ad,aa,ab,t){var ac=this;ac.get(ad,function(af,ag){return af?void t(af):ag._rev!==ab?void t(jt(hc)):ag._attachments?(delete ag._attachments[aa],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ac.put(ag,t)):t()})}),jl.prototype.remove=fc("remove",function(ad,aa,ab,t){var ac;"string"==typeof aa?(ac={_id:ad,_rev:aa},"function"==typeof ab&&(t=ab,ab={})):(ac=ad,"function"==typeof aa?(t=aa,ab={}):(t=ab,ab=aa)),ab=ab||{},ab.was_delete=!0;var af={_id:ac._id,_rev:ac._rev||ab.rev};return af._deleted=!0,iD(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ac,t):void this.bulkDocs({docs:[af]},ab,V(t))}),jl.prototype.revsDiff=fc("revsDiff",function(ac,aa,af){function ah(ak,aj){t.has(ak)||t.set(ak,{missing:[]}),t.get(ak).missing.push(aj)}function ag(aj,ak){var al=ac[aj].slice(0);ga(ak,function(ap,aq,av,am,aw){var au=aq+"-"+av,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==aw.status&&ah(aj,au))}),al.forEach(function(am){ah(aj,am)})}"function"==typeof aa&&(af=aa,aa={});var ab=Object.keys(ac);if(!ab.length){return af(null,{})}var ad=0,t=new ij.Map;ab.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){t.set(aj,{missing:ac[aj]})}else{if(al){return af(al)}ag(aj,am)}if(++ad===ab.length){var ak={};return t.forEach(function(ap,aq){ak[aq]=ap}),af(null,ak)}})},this)}),jl.prototype.bulkGet=fc("bulkGet",function(aa,t){fd(this,aa,t)}),jl.prototype.compactDocument=fc("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ad,ag){if(ad){return ac(ad)}var aj=hR(ag),af=[],ah=[];Object.keys(aj).forEach(function(ak){aj[ak]>ab&&af.push(ak)}),ga(ag,function(au,al,ap,ak,aq){var am=al+"-"+ap;"available"===aq.status&&-1!==af.indexOf(am)&&ah.push(am)}),aa._doCompaction(t,ah,ac)})}),jl.prototype.compact=fc("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&fg(t)}),jl.prototype._compact=function(ac,t){function ag(ah){af.push(ab.compactDocument(ah.id,0))}function ad(aj){var ah=aj.last_seq;hw.all(af).then(function(){return hE(ab,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){t(null,{ok:!0})})["catch"](t)}var ab=this,aa={return_docs:!1,last_seq:ac.last_seq||0},af=[];ab.changes(aa).on("change",ag).on("complete",ad).on("error",t)},jl.prototype.get=fc("get",function(ac,aa,af){function ah(){var ak=[],aj=ag.length;return aj?void ag.forEach(function(al){ab.get(ac,{rev:al,revs:aa.revs,attachments:aa.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||af(null,ak)})}):af(null,ak)}if("function"==typeof aa&&(af=aa,aa={}),"string"!=typeof ac){return af(jt(hK))}if(iD(ac)&&"function"==typeof this._getLocal){return this._getLocal(ac,af)}var ag=[],ab=this;if(!aa.open_revs){return this._get(ac,aa,function(ay,az){if(ay){return af(ay)}var ap=az.doc,aB=az.metadata,al=az.ctx;if(aa.conflicts){var aq=fS(aB);aq.length&&(ap._conflicts=aq)}if(fu(aB,ap._rev)&&(ap._deleted=!0),aa.revs||aa.revs_info){var au=iP(aB.rev_tree),aj=ct(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ap._rev.split("-")[1])}),aA=aj.ids.map(function(aC){return aC.id}).indexOf(ap._rev.split("-")[1])+1,ax=aj.ids.length-aA;if(aj.ids.splice(aA,ax),aj.ids.reverse(),aa.revs&&(ap._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),aa.revs_info){var aw=aj.pos+aj.ids.length;ap._revs_info=aj.ids.map(function(aC){return aw--,{rev:aw+"-"+aC.id,status:aC.opts.status}})}}if(aa.attachments&&ap._attachments){var av=ap._attachments,am=Object.keys(av).length;if(0===am){return af(null,ap)}Object.keys(av).forEach(function(aC){this._getAttachment(ap._id,aC,av[aC],{rev:ap._rev,binary:aa.binary,ctx:al},function(aE,aD){var aF=ap._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--am||af(null,ap)})},ab)}else{if(ap._attachments){for(var ak in ap._attachments){ap._attachments.hasOwnProperty(ak)&&(ap._attachments[ak].stub=!0)}}af(null,ap)}})}if("all"===aa.open_revs){this._getRevisionTree(ac,function(ak,aj){return ak?af(ak):(ag=iW(aj).map(function(al){return al.rev}),void ah())})}else{if(!Array.isArray(aa.open_revs)){return af(jt(hl,"function_clause"))}ag=aa.open_revs;for(var ad=0;ad<ag.length;ad++){var t=ag[ad];if("string"!=typeof t||!/^\d+-/.test(t)){return af(jt(iX))}}ah()}}),jl.prototype.getAttachment=fc("getAttachment",function(ad,aa,ab,t){var ac=this;ab instanceof Function&&(t=ab,ab={}),this._get(ad,ab,function(af,ag){return af?t(af):ag.doc._attachments&&ag.doc._attachments[aa]?(ab.ctx=ag.ctx,ab.binary=!0,ac._getAttachment(ad,aa,ag.doc._attachments[aa],ab,t),void 0):t(jt(fV))})}),jl.prototype.allDocs=fc("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(jt(fn,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return E(this,aa,ab)}}return this._allDocs(aa,ab)}),jl.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new hU(this,aa,t)},jl.prototype.close=fc("close",function(t){return this._closed=!0,this._close(t)}),jl.prototype.info=fc("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),jl.prototype.id=fc("id",function(t){return this._id(t)}),jl.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},jl.prototype.bulkDocs=fc("bulkDocs",function(ad,aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa=aa||{},Array.isArray(ad)&&(ad={docs:ad}),!ad||!ad.docs||!Array.isArray(ad.docs)){return ab(jt(jC))}for(var t=0;t<ad.docs.length;++t){if("object"!=typeof ad.docs[t]||Array.isArray(ad.docs[t])){return ab(jt(gB))}}var ac;return ad.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ac=ac||ii(ag)})}),ac?ab(jt(ik,ac)):("new_edits" in aa||("new_edits" in ad?aa.new_edits=ad.new_edits:aa.new_edits=!0),aa.new_edits||"http"===this.type()||ad.docs.sort(ar),fT(ad.docs),this._bulkDocs(ad,aa,function(af,ag){return af?ab(af):(aa.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ab(null,ag))}))}),jl.prototype.registerDependentDatabase=fc("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);hE(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),jl.prototype.destroy=fc("destroy",function(ad,aa){function ab(){t._destroy(ad,function(ag,af){return ag?aa(ag):(t._destroyed=!0,t.emit("destroyed"),void aa(null,af||{ok:!0}))})}"function"==typeof ad&&(aa=ad,ad={});var t=this,ac="use_prefix" in t?t.use_prefix:!0;return"http"===t.type()?ab():void t.get("_local/_pouch_dependentDbs",function(ak,ag){if(ak){return 404!==ak.status?aa(ak):ab()}var aj=ag.dependentDbs,af=t.constructor,ah=Object.keys(aj).map(function(al){var am=ac?al.replace(new RegExp("^"+af.prefix),""):al;return new af(am,t.__opts).destroy()});hw.all(ah).then(ab,aa)})}),fv.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},fv.prototype.fail=function(t){this.failed=t,this.execute()},fv.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},fv.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hg(a9,jl),a9.debug=i8,a9.adapters={},a9.preferredAdapters=[],a9.prefix="_pouch_";var iV=new jm.EventEmitter;hA(a9),a9.parseAdapter=function(ac,aa){var af,ah,ag=ac.match(/([a-z\-]*):\/\/(.*)/);if(ag){if(ac=/http(s?)/.test(ag[1])?ag[1]+"://"+ag[2]:ag[2],af=ag[1],!a9.adapters[af].valid()){throw"Invalid adapter"}return{name:ac,adapter:ag[1]}}var ab="idb" in a9.adapters&&"websql" in a9.adapters&&gf()&&localStorage["_pouch__websqldb_"+a9.prefix+ac];if(aa.adapter){ah=aa.adapter}else{if("undefined"!=typeof aa&&aa.db){ah="leveldb"}else{for(var ad=0;ad<a9.preferredAdapters.length;++ad){if(ah=a9.preferredAdapters[ad],ah in a9.adapters){if(ab&&"idb"===ah){iO("log",'PouchDB is downgrading "'+ac+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}af=a9.adapters[ah];var t=af&&"use_prefix" in af?af.use_prefix:!0;return{name:t?a9.prefix+ac:ac,adapter:ah}},a9.adapter=function(aa,ab,t){ab.valid()&&(a9.adapters[aa]=ab,t&&a9.preferredAdapters.push(aa))},a9.plugin=function(t){return"function"==typeof t?t(a9):Object.keys(t).forEach(function(aa){a9.prototype[aa]=t[aa]}),a9},a9.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=gD.extend({},aa,ad),void a9.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hg(t,a9),t.preferredAdapters=a9.preferredAdapters.slice(),Object.keys(a9).forEach(function(ab){ab in t||(t[ab]=a9[ab])}),t};var be="5.4.4";a9.version=be;var fm,iB=fW(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=fW(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),bt=function(t){return atob(t)},gu=function(t){return btoa(t)},i4=jd.setImmediate||jd.setTimeout,iU=32768,h8=5,gv="document-store",g2="by-sequence",gQ="attach-store",gH="attach-seq-store",ir="meta-store",ic="local-store",jx="detect-blob-support",ie={running:!1,queue:[]},hQ=new ij.Map,a2=new ee,o=new ij.Map;a8.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var iL=7,gq=hX("document-store"),T=hX("by-sequence"),jv=hX("attach-store"),f=hX("local-store"),ff=hX("metadata-store"),i9=hX("attach-seq-store"),J=new ij.Map,i0=new ee,p=1,gS="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+T+" (seq, deleted)",iR="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+T+" (doc_id, rev)",B="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+gq+" (winningseq)",jp="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+i9+" (seq)",a6="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+i9+" (digest, seq)",jr=T+".seq = "+gq+".winningseq",iY=T+".seq AS seq, "+T+".deleted AS deleted, "+T+".json AS data, "+T+".rev AS rev, "+gq+".json AS metadata";fq.valid=gA,fq.use_prefix=!0;var jj=a4(),gZ=function(){},hJ=25,ce=50,jb={},iG=1800,hb=i8("pouchdb:http");gK.valid=function(){return !0},W.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},W.prototype.finish=function(){return this.promise};var hP=function(aa,t){return t&&aa.then(function(ab){gX.nextTick(function(){t(null,ab)})},function(ab){gX.nextTick(function(){t(ab)})}),aa},hm=function(t){return i5(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hP(ab,aa),ab})},hu=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},iK=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},hh=function(ad){for(var aa={},ab=0,t=ad.length;t>ab;ab++){aa["$"+ad[ab]]=!0}var ac=Object.keys(aa),af=new Array(ac.length);for(ab=0,t=ac.length;t>ab;ab++){af[ab]=ac[ab].substring(1)}return af},h9={},hp=new W,en=50,jz=iO.bind(null,"log"),U={_sum:function(aa,t){return gJ(t)},_count:function(aa,t){return t.length},_stats:function(aa,ab){function t(ag){for(var ac=0,ad=0,ah=ag.length;ah>ad;ad++){var af=ag[ad];ac+=af*af}return ac}return{sum:gJ(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},fl=hm(function(){var t=this;return"http"===t.type()?x(t):"function"==typeof t._viewCleanup?A(t):gw(t)}),K=function(ad,aa,ab){"function"==typeof aa&&(ab=aa,aa={}),aa=aa?iA(aa):{},"function"==typeof ad&&(ad={map:ad});var t=this,ac=hw.resolve().then(function(){return at(t,ad,aa)});return hP(ac,ab),ac};hg(g8,Error),hg(gm,Error),hg(a5,Error);var hj={query:K,viewCleanup:fl},C=1,gU="pouchdb",fk=5,dr=0;cr.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},cr.prototype.updateTarget=function(aa,t){return G(this.target,this.id,aa,t,this.returnValue)},cr.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?hw.resolve(!0):G(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(gc(ac)){return t.readOnlySource=!0,!0}throw ac})};var hC={undefined:function(aa,t){return 0===hx.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return je(t,aa).last_seq}};cr.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hw.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return dr}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hC?hC[ab](aa,ac):dr},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:dr}).then(function(){return dr},function(ac){return gc(ac)?(t.readOnlySource=!0,aa.last_seq):dr})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return dr})};var ia=0;hg(ju,jm.EventEmitter),ju.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},ju.prototype.ready=function(ad,aa){function ab(){ac.cancel()}function t(){ad.removeListener("destroyed",ab),aa.removeListener("destroyed",ab)}var ac=this;ac._readyCalled||(ac._readyCalled=!0,ad.once("destroyed",ab),aa.once("destroyed",ab),ac.once("complete",t))},hg(gP,jm.EventEmitter),gP.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},a9.plugin(iI).plugin(an).plugin(v).plugin(hj).plugin(hi),e.exports=a9}).call(this,b(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var j="color: "+this.color;h=[h[0],j,"color: inherit"].concat(Array.prototype.slice.call(h,1));var g=0,f=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),h.splice(f,0,j),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(f,u,o){function s(){return o.colors[i++%o.colors.length]}function r(j){function g(){}function k(){var w=k,q=+new Date,v=q-(e||q);w.diff=v,w.prev=e,w.curr=q,e=q,null==w.useColors&&(w.useColors=o.useColors()),null==w.color&&w.useColors&&(w.color=s());var m=Array.prototype.slice.call(arguments);m[0]=o.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=o.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof o.formatArgs&&(m=o.formatArgs.apply(w,m));var l=k.log||o.log||console.log.bind(console);l.apply(w,m)}g.enabled=!1,k.enabled=!0;var h=o.enabled(j)?k:g;return h.namespace=j,h}function n(k){o.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?o.skips.push(new RegExp("^"+k.substr(1)+"$")):o.names.push(new RegExp("^"+k+"$")))}}function b(){o.enable("")}function t(g){var j,h;for(j=0,h=o.skips.length;h>j;j++){if(o.skips[j].test(g)){return !1}}for(j=0,h=o.names.length;h>j;j++){if(o.names[j].test(g)){return !0}}return !1}function a(g){return g instanceof Error?g.stack||g.message:g}o=u.exports=r,o.coerce=a,o.disable=b,o.enable=n,o.enabled=t,o.humanize=f(11),o.names=[],o.skips=[],o.formatters={};var e,i=0},{11:11}],7:[function(b,e,a){(function(z){function n(){f=!0;for(var g,h,j=l.length;j;){for(h=l,l=[],g=-1;++g<j;){h[g]()}j=l.length}f=!1}function s(g){1!==l.push(g)||f||r()}var r,i=z.MutationObserver||z.WebKitMutationObserver;if(i){var y=0,u=new i(n),x=z.document.createTextNode("");u.observe(x,{characterData:!0}),r=function(){x.data=y=++y%2}}else{if(z.setImmediate||"undefined"==typeof z.MessageChannel){r="document" in z&&"onreadystatechange" in z.document.createElement("script")?function(){var g=z.document.createElement("script");g.onreadystatechange=function(){n(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},z.document.documentElement.appendChild(g)}:function(){setTimeout(n,0)}}else{var o=new z.MessageChannel;o.port1.onmessage=n,r=function(){o.port2.postMessage(0)}}}var f,l=[];e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(b,e,a){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(o,u,s){function n(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=p,this.queue=[],this.outcome=void 0,g!==n&&y(this,g)}function e(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function m(j,k,g){i(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function b(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=l(j);"error"===z.status&&w(z.value)}function l(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function r(g){return g instanceof this?g:K.resolve(new this(n),g)}function f(g){var j=new this(n);return K.reject(j,g)}function a(j){function w(E,D){function C(F){z[D]=F,++g!==q||k||(k=!0,K.resolve(B,z))}A.resolve(E).then(C,function(F){k||(k=!0,K.reject(B,F))})}var A=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var q=j.length,k=!1;if(!q){return this.resolve([])}for(var z=new Array(q),g=0,x=-1,B=new this(n);++x<q;){w(j[x],x)}return B}function t(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(n);++z<j;){g(k[z])}return q}var i=o(7),K={},L=["REJECTED"],h=["FULFILLED"],p=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===h||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(n);if(this.state!==p){var k=this.state===h?q:g;m(j,k,this.outcome)}else{this.queue.push(new e(j,q,g))}return j},e.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},e.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},e.prototype.callRejected=function(g){K.reject(this.promise,g)},e.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=l(b,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=h,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},v.resolve=r,v.reject=f,v.all=a,v.race=t},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(o,r,l){function b(v){if(null!==v){switch(typeof v){case"boolean":return v?1:0;case"number":return a(v);case"string":return v.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var w=Array.isArray(v),q=w?v:Object.keys(v),j=-1,g=q.length,m="";if(w){for(;++j<g;){m+=l.toIndexableString(q[j])}}else{for(;++j<g;){var k=q[j];m+=l.toIndexableString(k)+l.toIndexableString(v[k])}}return m}}return""}function D(k,y){var q,w=y,v="1"===k[y];if(v){q=0,y++}else{var m="0"===k[y];y++;var g="",x=k.substring(y,y+p),z=parseInt(x,10)+t;for(m&&(z=-z),y+=p;;){var j=k[y];if("\x00"===j){break}g+=j,y++}g=g.split("."),q=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),m&&(q-=10),0!==z&&(q=parseFloat(q+"e"+z))}return{num:q,length:y-w}}function h(q,j){var w=q.pop();if(j.length){var m=j[j.length-1];w===m.element&&(j.pop(),m=j[j.length-1]);var g=m.element,v=m.index;if(Array.isArray(g)){g.push(w)}else{if(v===q.length-2){var k=q.pop();g[k]=w}else{q.push(w)}}}}function s(q,j){for(var g=Math.min(q.length,j.length),m=0;g>m;m++){var k=l.collate(q[m],j[m]);if(0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(v,w){for(var q=Object.keys(v),j=Object.keys(w),g=Math.min(q.length,j.length),m=0;g>m;m++){var k=l.collate(q[m],j[m]);if(0!==k){return k}if(k=l.collate(v[q[m]],w[j[m]]),0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(x){if(0===x){return"1"}var q=x.toExponential().split(/e\+?/),g=parseInt(q[1],10),k=0>x,j=k?"0":"2",y=(k?-g:g)-t,w=n.padLeft(y.toString(),"0",p);j+=f+w;var m=Math.abs(parseFloat(q[0]));k&&(m=10-m);var v=m.toFixed(20);return v=v.replace(/\.?0+$/,""),j+=f+v}var t=-324,p=3,f="",n=o(13);l.collate=function(j,m){if(j===m){return 0}j=l.normalizeKey(j),m=l.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},l.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=l.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=l.normalizeKey(q))}}}}}return g},l.toIndexableString=function(g){var j="\x00";return g=l.normalizeKey(g),i(g)+f+b(g)+j},l.parseIndexableString=function(k){for(var y=[],v=[],w=0;;){var g=k[w++];if("\x00"!==g){switch(g){case"1":y.push(null);break;case"2":y.push("1"===k[w]),w++;break;case"3":var x=D(k,w);y.push(x.num),w+=x.length;break;case"4":for(var z="";;){var j=k[w];if("\x00"===j){break}z+=j,w++}z=z.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),y.push(z);break;case"5":var m={element:[],index:y.length};y.push(m.element),v.push(m);break;case"6":var q={element:{},index:y.length};y.push(q.element),v.push(q);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}}else{if(1===y.length){return y.pop()}h(y,v)}}}},{13:13}],13:[function(h,b,e){function a(g,m,n){for(var l="",f=n-g.length;l.length<f;){l+=m}return l}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var f,g=r.length,o=n.length;for(f=0;g>f;f++){if(f===o){return 1}var i=r.charAt(f),q=n.charAt(f);if(i!==q){return q>i?-1:1}}return o>g?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(b,i,j){function e(){this.store={}}function a(g){if(this.store=new e,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}j.Map=e,j.Set=a,e.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},e.prototype.unmangle=function(f){return f.substring(1)},e.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},e.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},e.prototype.has=function(f){var g=this.mangle(f);return g in this.store},e.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},e.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},a.prototype.add=function(f){return this.store.set(f,!0)},a.prototype.has=function(f){return this.store.has(f)},a.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(q,g){var n,o,p,r;o=[],r=[];for(n in g){h.call(g,n)&&(p=g[n],"this"!==n&&(o.push(n),r.push(p)))}return Function.apply(null,f.call(o).concat([q])).apply(g["this"],r)}}).call(this)},{}],16:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(y){function v(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function o(j,q,k,A,w,z,x){return v(q&k|~q&A,j,q,w,z,x)}function t(j,q,k,A,w,z,x){return v(q&A|k&~A,j,q,w,z,x)}function r(j,q,k,A,w,z,x){return v(q^k^A,j,q,w,z,x)}function O(j,q,k,A,w,z,x){return v(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=o(z,q,x,j,w[0],7,-680876936),j=o(j,z,q,x,w[1],12,-389564586),x=o(x,j,z,q,w[2],17,606105819),q=o(q,x,j,z,w[3],22,-1044525330),z=o(z,q,x,j,w[4],7,-176418897),j=o(j,z,q,x,w[5],12,1200080426),x=o(x,j,z,q,w[6],17,-1473231341),q=o(q,x,j,z,w[7],22,-45705983),z=o(z,q,x,j,w[8],7,1770035416),j=o(j,z,q,x,w[9],12,-1958414417),x=o(x,j,z,q,w[10],17,-42063),q=o(q,x,j,z,w[11],22,-1990404162),z=o(z,q,x,j,w[12],7,1804603682),j=o(j,z,q,x,w[13],12,-40341101),x=o(x,j,z,q,w[14],17,-1502002290),q=o(q,x,j,z,w[15],22,1236535329),z=t(z,q,x,j,w[1],5,-165796510),j=t(j,z,q,x,w[6],9,-1069501632),x=t(x,j,z,q,w[11],14,643717713),q=t(q,x,j,z,w[0],20,-373897302),z=t(z,q,x,j,w[5],5,-701558691),j=t(j,z,q,x,w[10],9,38016083),x=t(x,j,z,q,w[15],14,-660478335),q=t(q,x,j,z,w[4],20,-405537848),z=t(z,q,x,j,w[9],5,568446438),j=t(j,z,q,x,w[14],9,-1019803690),x=t(x,j,z,q,w[3],14,-187363961),q=t(q,x,j,z,w[8],20,1163531501),z=t(z,q,x,j,w[13],5,-1444681467),j=t(j,z,q,x,w[2],9,-51403784),x=t(x,j,z,q,w[7],14,1735328473),q=t(q,x,j,z,w[12],20,-1926607734),z=r(z,q,x,j,w[5],4,-378558),j=r(j,z,q,x,w[8],11,-2022574463),x=r(x,j,z,q,w[11],16,1839030562),q=r(q,x,j,z,w[14],23,-35309556),z=r(z,q,x,j,w[1],4,-1530992060),j=r(j,z,q,x,w[4],11,1272893353),x=r(x,j,z,q,w[7],16,-155497632),q=r(q,x,j,z,w[10],23,-1094730640),z=r(z,q,x,j,w[13],4,681279174),j=r(j,z,q,x,w[0],11,-358537222),x=r(x,j,z,q,w[3],16,-722521979),q=r(q,x,j,z,w[6],23,76029189),z=r(z,q,x,j,w[9],4,-640364487),j=r(j,z,q,x,w[12],11,-421815835),x=r(x,j,z,q,w[15],16,530742520),q=r(q,x,j,z,w[2],23,-995338651),z=O(z,q,x,j,w[0],6,-198630844),j=O(j,z,q,x,w[7],10,1126891415),x=O(x,j,z,q,w[14],15,-1416354905),q=O(q,x,j,z,w[5],21,-57434055),z=O(z,q,x,j,w[12],6,1700485571),j=O(j,z,q,x,w[3],10,-1894986606),x=O(x,j,z,q,w[10],15,-1051523),q=O(q,x,j,z,w[1],21,-2054922799),z=O(z,q,x,j,w[8],6,1873313359),j=O(j,z,q,x,w[15],10,-30611744),x=O(x,j,z,q,w[6],15,-1560198380),q=O(q,x,j,z,w[13],21,1309151649),z=O(z,q,x,j,w[4],6,-145523070),j=O(j,z,q,x,w[11],10,-1120210379),x=O(x,j,z,q,w[2],15,718787259),q=O(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function l(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function P(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function u(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,l(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function s(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,P(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function Q(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function p(j){var k;for(k=0;k<j.length;k+=1){j[k]=Q(j[k])}return j.join("")}function m(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function n(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(u("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(A,B){var z,k,C,D,w=this.byteLength,x=j(A,w),q=w;return B!==y&&(q=j(B,w)),x>q?new ArrayBuffer(0):(z=q-x,k=new ArrayBuffer(z),C=new Uint8Array(k),D=new Uint8Array(this,x,z),C.set(D),k)}}(),n.prototype.append=function(j){return this.appendBinary(m(j)),this},n.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,l(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},n.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},n.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},n.hash=function(j,k){return n.hashBinary(m(j),k)},n.hashBinary=function(k,w){var j=u(k),q=p(j);return w?e(q):q},n.ArrayBuffer=function(){this.reset()},n.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,P(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var j=n.prototype.getState.call(this);return j.buff=S(j.buff),j},n.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),n.prototype.setState.call(this,j)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(k,w){var j=s(new Uint8Array(k)),q=p(j);return w?e(q):q},n})},{}],17:[function(h,b,e){function a(r,n,f){var g=f[f.length-1];r===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,i=g.index;if(Array.isArray(o)){o.push(r)}else{if(i===n.length-2){var q=n.pop();o[q]=r}else{n.push(r)}}}e.stringify=function(u){var f=[];f.push({obj:u});for(var F,i,E,n,D,s,l,C,g,o,t,r="";F=f.pop();){if(i=F.obj,E=F.prefix||"",n=F.val||"",r+=E,n){r+=n}else{if("object"!=typeof i){r+="undefined"==typeof i?null:JSON.stringify(i)}else{if(null===i){r+="null"}else{if(Array.isArray(i)){for(f.push({val:"]"}),D=i.length-1;D>=0;D--){s=0===D?"":",",f.push({obj:i[D],prefix:s})}f.push({val:"["})}else{l=[];for(C in i){i.hasOwnProperty(C)&&l.push(C)}for(f.push({val:"}"}),D=l.length-1;D>=0;D--){g=l[D],o=i[g],t=D>0?",":"",t+=JSON.stringify(g)+":",f.push({obj:o,prefix:t})}f.push({val:"{"})}}}}}return r},e.parse=function(C){for(var n,g,l,D,t,i,A,B,u,f=[],o=[],s=0;;){if(n=C[s++],"}"!==n&&"]"!==n&&"undefined"!=typeof n){switch(n){case" ":case"	":case"\n":case":":case",":break;case"n":s+=3,a(null,f,o);break;case"t":s+=3,a(!0,f,o);break;case"f":s+=4,a(!1,f,o);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(g="",s--;;){if(l=C[s++],!/[\d\.\-e\+]/.test(l)){s--;break}g+=l}a(parseFloat(g),f,o);break;case'"':for(D="",t=void 0,i=0;;){if(A=C[s++],'"'===A&&("\\"!==t||i%2!==1)){break}D+=A,t=A,"\\"===t?i++:i=0}a(JSON.parse('"'+D+'"'),f,o);break;case"[":B={element:[],index:f.length},f.push(B.element),o.push(B);break;case"{":u={element:{},index:f.length},f.push(u.element),o.push(u);break;default:throw new Error("unexpectedly reached end of input: "+n)}}else{if(1===f.length){return f.pop()}a(f.pop(),f,o)}}}},{}]},{},[3])(3)});