!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(i,l){if(!c[i]){if(!h[i]){var k="function"==typeof require&&require;if(!l&&k){return k(i,!0)}if(d){return d(i,!0)}var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var m=c[i]={exports:{}};h[i][0].call(m.exports,function(n){var o=h[i][1][n];return g(o?o:n)},m,m.exports,a,h,c,f)}return c[i].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,n,o,q,e,m;if(this._events||(this._events={}),"error"===p&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[p],g(n)){return !1}if(k(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:q=Array.prototype.slice.call(arguments,1),n.apply(this,q)}}else{if(c(n)){for(q=Array.prototype.slice.call(arguments,1),m=n.slice(),o=m.length,e=0;o>e;e++){m[e].apply(this,q)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(n,i){function e(){this.removeListener(n,e),m||(m=!0,i.apply(this,arguments))}if(!k(i)){throw TypeError("listener must be a function")}var m=!1;return e.listener=i,this.on(n,e),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(c(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(c,g,q){function A(){m&&d&&(m=!1,d.length?v=d.concat(v):j=-1,v.length&&w())}function w(){if(!m){var f=x(A);m=!0;for(var e=v.length;e;){for(d=v,v=[];++j<e;){d&&d[j].run()}j=-1,e=v.length}d=null,m=!1,z(f)}}function y(f,e){this.fun=f,this.array=e}function k(){}var x,z,p=g.exports={};!function(){try{x=setTimeout}catch(e){x=function(){throw new Error("setTimeout is not defined")}}try{z=clearTimeout}catch(e){z=function(){throw new Error("clearTimeout is not defined")}}}();var d,v=[],m=!1,j=-1;p.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}v.push(new y(f,e)),1!==v.length||m||x(w,0)},y.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=k,p.addListener=k,p.once=k,p.off=k,p.removeListener=k,p.removeAllListeners=k,p.emit=k,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],3:[function(d,c,f){(function(fM,eA){function ds(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function eC(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eK(i){if("function"==typeof i.slice){return i.slice(0)}var g=new ArrayBuffer(i.byteLength),j=new Uint8Array(g),h=new Uint8Array(i);return j.set(h),g}function e0(h){if(h instanceof ArrayBuffer){return eK(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function dg(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&eZ.call(i)==c6}function bc(h){var k,j,g;if(!h||"object"!=typeof h){return h}if(Array.isArray(h)){for(k=[],j=0,g=h.length;g>j;j++){k[j]=bc(h[j])}return k}if(h instanceof Date){return h.toISOString()}if(eC(h)){return e0(h)}if(!dg(h)){return h}k={};for(j in h){if(Object.prototype.hasOwnProperty.call(h,j)){var i=bc(h[j]);"undefined"!=typeof i&&(k[j]=i)}}return k}function d3(h){var g=!1;return bz(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function fD(g){return bz(function(j){j=bc(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){fM.nextTick(function(){i(n,m)})});var h=new b2(function(q,p){var n;try{var m=d3(function(r,s){r?p(r):q(s)});j.push(m),n=g.apply(l,j),n&&"function"==typeof n.then&&q(n)}catch(o){p(o)}});return k&&h.then(function(m){k(null,m)},k),h})}function ap(h,g){function i(m,k,o){if(eH.enabled){for(var l=[m._db_name,k],n=0;n<o.length-1;n++){l.push(o[n])}eH.apply(null,l);var j=o[o.length-1];o[o.length-1]=function(r,p){var q=[m._db_name,k];q=q.concat(r?["error",r]:["success",p]),eH.apply(null,q),j(r,p)}}}return fD(bz(function(j){if(this._closed){return b2.reject(new Error("database is closed"))}if(this._destroyed){return b2.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new b2(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function dd(i,l){for(var k={},h=0,j=l.length;j>h;h++){var g=l[h];g in i&&(k[g]=i[g])}return k}function dy(g){return g}function dE(g){return[{ok:g}]}function eh(j,k,u){function m(){var w=[];s.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),u(null,{results:w})}function q(){++n===r&&m()}function g(x,w,y){s[x]={id:w,docs:y},q()}function o(){if(!(p>=v.length)){var x=Math.min(p+aK,v.length),w=v.slice(p,x);l(w,p),p+=w.length}}function l(x,w){x.forEach(function(z,D){var B=w+D,y=h[z],A=dd(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(dy);var C=dy;0===A.open_revs.length&&(delete A.open_revs,C=dE),["revs","attachments","binary","ajax"].forEach(function(E){E in k&&(A[E]=k[E])}),j.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),g(B,z,F),o()})})}var i=k.docs,h={};i.forEach(function(w){w.id in h?h[w.id].push(w):h[w.id]=[w]});var r=Object.keys(h).length,n=0,s=new Array(r),v=Object.keys(h),p=0;o()}function dT(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function eB(){return ka}function e4(g){dT()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):eB()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function f3(){cS.EventEmitter.call(this),this._listeners={},e4(this)}function bJ(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function eX(h,k){var j=600000;h=parseInt(h,10)||0,k=parseInt(k,10),k!==k||h>=k?k=(h||1)<<1:k+=1,k>j&&(h=j>>1,k=j);var g=Math.random(),i=k-h;return ~~(i*g+h)}function dY(h){var g=0;return h||(g=2000),eX(h,g)}function eO(h,g){bJ("info","The above "+h+" is totally normal. "+g)}function fE(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function c9(i,g,j){function h(k){for(var l in i){"function"!=typeof i[l]&&(this[l]=i[l])}void 0!==j&&(this.name=j),void 0!==k&&(this.reason=k)}return h.prototype=fE.prototype,new h(g)}function dk(i){var l,k,h,j,g;return k=i.error===!0&&"string"==typeof i.name?i.name:i.error,g=i.reason,h=dV("name",k,g),i.missing||"missing"===g||"deleted"===g||"not_found"===k?h=eP:"doc_validation"===k?(h=dw,j=g):"bad_request"===k&&h.message!==g&&(h=dJ),h||(h=dV("status",i.status,g)||c2),l=c9(h,g,k),j&&(l.message=j),i.id&&(l.id=i.id),i.status&&(l.status=i.status),i.missing&&(l.missing=i.missing),l}function ch(h,k,j){try{return !h(k,j)}catch(g){var i="Filter function threw: "+g.toString();return c9(dJ,i)}}function aL(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&ch(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function fK(i){for(var g=[],j=0,h=i.length;h>j;j++){g=g.concat(i[j])}return g}function aU(h){var g;if(h?"string"!=typeof h?g=c9(b6):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=c9(eJ)):g=c9(bW),g){throw g}}function e(h,g){return"listenerCount" in h?h.listenerCount(g):cS.EventEmitter.listenerCount(h,g)}function aQ(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function bS(h){var g=aQ(h);return g?g.join("/"):null}function dz(k){for(var i=fC.exec(k),g={},j=14;j--;){var l=eQ[j],m=i[j]||"",h=-1!==["user","password"].indexOf(l);g[l]=h?decodeURIComponent(m):m}return g[bF]={},g[eQ[12]].replace(kh,function(o,p,n){p&&(g[bF][p]=n)}),g}function eU(h,g,i){return new b2(function(j,k){h.get(g,function(n,l){if(n){if(404!==n.status){return k(n)}l={}}var o=l._rev,m=i(l);return m?(m._id=g,m._rev=o,void j(cP(h,m,i))):j({updated:!1,rev:o})})})}function cP(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return eU(h,g._id,i)})}function dC(g){return 0|Math.random()*g}function eM(i,g){g=g||bE.length;var j="",h=-1;if(i){for(;++h<i;){j+=bE[dC(g)]}return j}for(;++h<36;){switch(h){case 8:case 13:case 18:case 23:j+="-";break;case 19:j+=bE[3&dC(16)|8];break;default:j+=bE[dC(16)]}}return j}function dH(r){for(var j,m,k,l,o=r.rev_tree.slice();l=o.pop();){var h=l.ids,p=h[2],i=l.pos;if(p.length){for(var g=0,q=p.length;q>g;g++){o.push({pos:i+1,ids:p[g]})}}else{var n=!!h[1].deleted,s=h[0];j&&!(k!==n?k:m!==i?i>m:s>j)||(j=s,m=i,k=n)}}return m+"-"+j}function ed(m,g){for(var k,i=m.slice();k=i.pop();){for(var j=k.pos,l=k.ids,o=l[2],h=g(0===o.length,j,l[0],k.ctx,l[1]),p=0,n=o.length;n>p;p++){i.push({pos:j+1,ids:o[p],ctx:h})}}}function fP(h,g){return h.pos-g.pos}function e5(i){var g=[];ed(i,function(l,n,k,m,o){l&&g.push({rev:n+"-"+k,pos:n,opts:o})}),g.sort(fP).reverse();for(var j=0,h=g.length;h>j;j++){delete g[j].pos}return g}function dZ(k){for(var i=dH(k),g=e5(k.rev_tree),j=[],l=0,m=g.length;m>l;l++){var h=g[l];h.rev===i||h.opts.deleted||j.push(h.rev)}return j}function cd(h){var g=[];return ed(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function eE(r){for(var j,m=[],k=r.slice();j=k.pop();){var l=j.pos,o=j.ids,h=o[0],p=o[1],i=o[2],g=0===i.length,q=j.history?j.history.slice():[];q.push({id:h,opts:p}),g&&m.push({pos:l+1-q.length,ids:q});for(var n=0,s=i.length;s>n;n++){k.push({pos:l+1,ids:i[n],history:q})}}return m.reverse()}function f0(h,g){return h.pos-g.pos}function bP(i,l,k){for(var h,j=0,g=i.length;g>j;){h=j+g>>>1,k(i[h],l)<0?j=h+1:g=h}return j}function e1(i,g,j){var h=bP(i,g,j);i.splice(h,0,g)}function jQ(m,j){for(var g,l,n=j,i=m.length;i>n;n++){var h=m[n],k=[h.id,h.opts,[]];l?(l[2].push(k),l=k):g=l=k}return g}function fB(h,g){return h[0]<g[0]?-1:1}function f8(m,g){for(var k=[{tree1:m,tree2:g}],i=!1;k.length>0;){var j=k.pop(),l=j.tree1,o=j.tree2;(l[1].status||o[1].status)&&(l[1].status="available"===l[1].status||"available"===o[1].status?"available":"missing");for(var h=0;h<o[2].length;h++){if(l[2][0]){for(var p=!1,n=0;n<l[2].length;n++){l[2][n][0]===o[2][h][0]&&(k.push({tree1:l[2][n],tree2:o[2][h]}),p=!0)}p||(i="new_branch",e1(l[2],o[2][h],fB))}else{i="new_leaf",l[2][0]=o[2][h]}}}return{conflicts:i,tree:m}}function af(v,y,s){var p,k=[],z=!1,w=!1;if(!v.length){return{tree:[y],conflicts:"new_leaf"}}for(var A=0,j=v.length;j>A;A++){var q=v[A];if(q.pos===y.pos&&q.ids[0]===y.ids[0]){p=f8(q.ids,y.ids),k.push({pos:q.pos,ids:p.tree}),z=z||p.conflicts,w=!0}else{if(s!==!0){var o=q.pos<y.pos?q:y,x=q.pos<y.pos?y:q,n=x.pos-o.pos,m=[],i=[];for(i.push({ids:o.ids,diff:n,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],u=0,r=g.length;r>u;u++){i.push({ids:g[u],diff:h.diff-1,parent:h.ids,parentIdx:u})}}else{h.ids[0]===x.ids[0]&&m.push(h)}}var l=m[0];l?(p=f8(l.ids,x.ids),l.parent[2][l.parentIdx]=p.tree,k.push({pos:o.pos,ids:o.ids}),z=z||p.conflicts,w=!0):k.push(q)}else{k.push(q)}}}return w||k.push(y),k.sort(f0),{tree:k,conflicts:z||"internal_node"}}function kc(r,j){for(var m,k=eE(r),l={},o=0,h=k.length;h>o;o++){for(var p=k[o],i=p.ids,g=Math.max(0,i.length-j),q={pos:p.pos+g,ids:jQ(i,g)},n=0;g>n;n++){var s=p.pos+n+"-"+i[n].id;l[s]=!0}m=m?af(m,q,!0).tree:[q]}return ed(m,function(w,v,u){delete l[v+"-"+u]}),{tree:m,revs:Object.keys(l)}}function eY(h,k,j){var g=af(h,k),i=kc(g.tree,j);return{tree:i.tree,stemmedRevs:i.revs,conflicts:g.conflicts}}function aT(m,g){for(var k,i=m.slice(),j=g.split("-"),l=parseInt(j[0],10),o=j[1];k=i.pop();){if(k.pos===l&&k.ids[0]===o){return !0}for(var h=k.ids[2],p=0,n=h.length;n>p;p++){i.push({pos:k.pos+1,ids:h[p]})}}return !1}function f5(g){return g.ids}function dh(h,k){k||(k=dH(h));for(var j,g=k.substring(k.indexOf("-")+1),i=h.rev_tree.map(f5);j=i.pop();){if(j[0]===g){return !!j[1].deleted}i=i.concat(j[2])}}function du(g){return/^_local/.test(g)}function c4(g){return aZ("return "+g+";",{})}function bI(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function aI(h,g){try{h.emit("change",g)}catch(i){bJ("error",'Error in .on("change", function):',i)}}function fH(k,i,g){function j(){l.cancel()}cS.EventEmitter.call(this);var l=this;this.db=k,i=i?bc(i):{};var m=i.complete=d3(function(o,n){o?e(l,"error")>0&&l.emit("error",o):l.emit("complete",n),l.removeAllListeners(),k.removeListener("destroyed",j)});g&&(l.on("complete",function(n){g(null,n)}),l.on("error",g)),k.once("destroyed",j),i.onChange=function(n){i.isCancelled||(aI(l,n),l.startSeq&&l.startSeq<=n.seq&&(l.startSeq=!1))};var h=new b2(function(o,n){i.complete=function(p,q){p?n(p):o(q)}});l.once("cancel",function(){k.removeListener("destroyed",j),i.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){m(null,n)},m),k.taskqueue.isReady?l.doChanges(i):k.taskqueue.addTask(function(){l.isCancelled?l.emit("cancel"):l.doChanges(i)})}function jY(h,k,j){var g=[{rev:h._rev}];"all_docs"===j.style&&(g=e5(k.rev_tree).map(function(l){return{rev:l.rev}}));var i={id:k.id,changes:g,doc:h};return dh(k,h._rev)&&(i.deleted=!0),j.conflicts&&(i.doc._conflicts=dZ(k),i.doc._conflicts.length||delete i.doc._conflicts),i}function cm(h,g){return g>h?-1:h>g?1:0}function a8(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function ep(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function bK(i){for(var l=0;l<i.length;l++){var k=i[l];if(k._deleted){delete k._attachments}else{if(k._attachments){for(var h=Object.keys(k._attachments),j=0;j<h.length;j++){var g=h[j];k._attachments[g]=dd(k._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function jJ(h,k){var j=cm(h._id,k._id);if(0!==j){return j}var g=h._revisions?h._revisions.start:0,i=k._revisions?k._revisions.start:0;return cm(g,i)}function aY(h){var g={},i=[];return ed(h,function(l,k,m,j){var n=k+"-"+m;return l&&(g[n]=0),void 0!==j&&i.push({from:j,to:n}),n}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function ek(h,k,j){var g="limit" in k?k.keys.slice(k.skip,k.limit+k.skip):k.skip>0?k.keys.slice(k.skip):k.keys;if(k.descending&&g.reverse(),!g.length){return h._allDocs({limit:0},j)}var i={offset:k.skip};return b2.all(g.map(function(m){var l=ac.extend({key:m,deleted:"ok"},k);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new b2(function(o,n){h._allDocs(l,function(q,p){return q?n(q):(i.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return i.rows=l,i})}function aA(i){var g=i._compactionQueue[0],h=g.opts,j=g.callback;i.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(h.last_seq=k.last_seq),i._compact(h,function(l,m){l?j(l):j(null,m),fM.nextTick(function(){i._compactionQueue.shift(),i._compactionQueue.length&&aA(i)})})})}function bd(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function c1(){cS.EventEmitter.call(this)}function eG(){this.isReady=!1,this.failed=!1,this.queue=[]}function d2(g){g&&eA.debug&&bJ("error",g)}function bR(k,i){function g(){m.emit("destroyed",l)}function j(){k.removeListener("destroyed",g),k.emit("destroyed",k)}var l=i.originalName,m=k.constructor,h=m._destructionListeners;k.once("destroyed",g),h.has(l)||h.set(l,[]),h.get(l).push(j)}function d8(k,i,g){if(!(this instanceof d8)){return new d8(k,i,g)}var j=this;if("function"!=typeof i&&"undefined"!=typeof i||(g=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),"undefined"==typeof g){g=d2}else{var l=g;g=function(){return bJ("warn","Using a callback for new PouchDB()is deprecated."),l.apply(null,arguments)}}k=k||i.name,i=bc(i),delete i.name,this.__opts=i;var m=g;j.auto_compaction=i.auto_compaction,j.prefix=d8.prefix,c1.call(j),j.taskqueue=new eG;var h=new b2(function(q,o){g=function(r,s){return r?o(r):(delete s.then,void q(s))},i=bc(i);var n,p;return function(){try{if("string"!=typeof k){throw p=new Error("Missing/invalid DB name"),p.code=400,p}var r=(i.prefix||"")+k;if(n=d8.parseAdapter(r,i),i.originalName=k,i.name=n.name,i.adapter=i.adapter||n.adapter,j._adapter=i.adapter,au("pouchdb:adapter")("Picked adapter: "+i.adapter),j._db_name=k,!d8.adapters[i.adapter]){throw p=new Error("Adapter is missing"),p.code=404,p}if(!d8.adapters[i.adapter].valid()){throw p=new Error("Invalid Adapter"),p.code=404,p}}catch(s){j.taskqueue.fail(s)}}(),p?o(p):(j.adapter=i.adapter,j.replicate={},j.replicate.from=function(r,u,s){return j.constructor.replicate(r,j,u,s)},j.replicate.to=function(r,u,s){return j.constructor.replicate(j,r,u,s)},j.sync=function(r,u,s){return j.constructor.sync(j,r,u,s)},j.replicate.sync=j.sync,void d8.adapters[i.adapter].call(j,i,function(r){return r?(j.taskqueue.fail(r),void g(r)):(bR(j,i),j.emit("created",j),d8.emit("created",i.originalName),j.taskqueue.ready(j),void g(null,j))}))});h.then(function(n){m(null,n)},m),j.then=h.then.bind(h),j["catch"]=h["catch"].bind(h)}function av(h){Object.keys(cS.EventEmitter.prototype).forEach(function(i){"function"==typeof cS.EventEmitter.prototype[i]&&(h[i]=ea[i].bind(ea))});var g=h._destructionListeners=new cJ.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function cU(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function db(i){if(!/^\d+\-./.test(i)){return c9(fG)}var g=i.indexOf("-"),j=i.substring(0,g),h=i.substring(g+1);return{prefix:parseInt(j,10),id:h}}function j7(k,i){for(var g=k.start-k.ids.length+1,j=k.ids,l=[j[0],i,[]],m=1,h=j.length;h>m;m++){l=[j[m],{status:"missing"},[l]]}return[{pos:g,ids:l}]}function e3(m,g){var k,i,j,l={status:"available"};if(m._deleted&&(l.deleted=!0),g){if(m._id||(m._id=eM()),i=eM(32,16).toLowerCase(),m._rev){if(j=db(m._rev),j.error){return j}m._rev_tree=[{pos:j.prefix,ids:[j.id,{status:"missing"},[[i,l,[]]]]}],k=j.prefix+1}else{m._rev_tree=[{pos:1,ids:[i,l,[]]}],k=1}}else{if(m._revisions&&(m._rev_tree=j7(m._revisions,l),k=m._revisions.start,i=m._revisions.ids[0]),!m._rev_tree){if(j=db(m._rev),j.error){return j}k=j.prefix,i=j.id,m._rev_tree=[{pos:k,ids:[i,l,[]]}]}}aU(m._id),m._rev=k+"-"+i;var o={metadata:{},data:{}};for(var h in m){if(Object.prototype.hasOwnProperty.call(m,h)){var p="_"===h[0];if(p&&!f1[h]){var n=c9(dw,h);throw n.message=dw.message+": "+h,n}p&&!cG[h]?o.metadata[h.slice(1)]=m[h]:o.data[h]=m[h]}}return o}function j8(h){for(var k="",j=new Uint8Array(h),g=j.byteLength,i=0;g>i;i++){k+=String.fromCharCode(j[i])}return k}function aO(g){return cD(j8(g))}function bq(i,l){i=i||[],l=l||{};try{return new Blob(i,l)}catch(k){if("TypeError"!==k.name){throw k}for(var h="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,j=new h,g=0;g<i.length;g+=1){j.append(i[g])}return j.getBlob(l.type)}}function aa(h){for(var k=h.length,j=new ArrayBuffer(k),g=new Uint8Array(j),i=0;k>i;i++){g[i]=h.charCodeAt(i)}return j}function cO(h,g){return bq([aa(h)],{type:g})}function eR(h,g){return cO(d6(h),g)}function j0(i,g){if("undefined"==typeof FileReader){return g(j8((new FileReaderSync).readAsArrayBuffer(i)))}var j=new FileReader,h="function"==typeof j.readAsBinaryString;j.onloadend=function(k){var l=k.target.result||"";return h?g(l):void g(j8(l))},h?j.readAsBinaryString(i):j.readAsArrayBuffer(i)}function b1(h,g){j0(h,function(i){g(cD(i))})}function bl(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function jW(g){return cD(g)}function jN(i,g,j,h){(j>0||h<g.byteLength)&&(g=new Uint8Array(g,j,Math.min(h,g.byteLength)-j)),i.append(g)}function bH(i,g,j,h){(j>0||h<g.length)&&(g=g.substring(j,h)),i.appendBinary(g)}function jG(m,g){function k(){var q=h*l,u=q+l;if(h++,o>h){n(p,m,q,u),jR(k)}else{n(p,m,q,u);var r=p.end(!0),s=jW(r);g(s),p.destroy()}}var i="string"==typeof m,j=i?m.length:m.byteLength,l=Math.min(bG,j),o=Math.ceil(j/l),h=0,p=i?new d5:new d5.ArrayBuffer,n=i?bH:jN;k()}function jM(g){return d5.hash(g)}function eg(m,j,g){function l(o){try{return d6(o)}catch(q){var p=c9(cs,"Attachment is not a valid base64 string");return{error:p}}}function n(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=l(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===j?q.data=cO(o,q.content_type):"base64"===j?q.data=cD(o):q.data=o,jG(o,function(r){q.digest="md5-"+r,p()})}else{bl(q.data,function(r){"binary"===j?q.data=j8(r):"base64"===j&&(q.data=aO(r)),jG(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function i(){k++,m.length===k&&(h?g(h):g())}if(!m.length){return g()}var h,k=0;m.forEach(function(r){function p(u){h=u,q++,q===s.length&&i()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return i()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&n(r.data._attachments[o],p)}})}function bk(z,y,k,r,j,q,x,w){if(aT(y.rev_tree,k.metadata.rev)){return r[j]=k,q()}var i=y.winningRev||dH(y),m="deleted" in y?y.deleted:dh(y,i),B="deleted" in k.metadata?k.metadata.deleted:dh(k.metadata),n=/^1-/.test(k.metadata.rev);if(m&&!B&&w&&n){var l=k.data;l._rev=i,l._id=k.metadata.id,k=e3(l,w)}var s=eY(y.rev_tree,k.metadata.rev_tree[0],z),h=w&&(m&&B||!m&&"new_leaf"!==s.conflicts||m&&!B&&"new_branch"===s.conflicts);if(h){var g=c9(bm);return r[j]=g,q()}var p=k.metadata.rev;k.metadata.rev_tree=s.tree,k.stemmedRevs=s.stemmedRevs||[],y.rev_map&&(k.metadata.rev_map=y.rev_map);var u,A=dH(k.metadata),o=dh(k.metadata,A),v=m===o?0:o>m?-1:1;u=p===A?o:dh(k.metadata,p),x(k,A,o,u,!0,v,j,q)}function t(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function bs(q,h,k,s,g,m,u,i,p){function r(C,B,x){var A=dH(C.metadata),D=dh(C.metadata,A);if("was_delete" in i&&D){return m[B]=c9(eP,"deleted"),x()}var w=j&&t(C);if(w){var z=c9(bm);return m[B]=z,x()}var y=D?0:1;u(C,A,D,D,!1,y,B,x)}function o(){++v===n&&p&&p()}q=q||1000;var j=i.new_edits,l=new cJ.Map,v=0,n=h.length;h.forEach(function(y,w){if(y._id&&du(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void k[x](y,{ctx:g},function(B,A){m[w]=B||A,o()})}var z=y.metadata.id;l.has(z)?(n--,l.get(z).push([y,w])):l.set(z,[[y,w]])}),l.forEach(function(x,z){function y(){++w<x.length?A():o()}function A(){var C=x[w],E=C[0],D=C[1];if(s.has(z)){bk(q,s.get(z),E,m,D,y,u,j)}else{var B=eY([],E.metadata.rev_tree[0],q);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],r(E,D,y)}}var w=0;A()})}function bY(h){try{return JSON.parse(h)}catch(g){return cY.parse(h)}}function aD(g){return g.length<50000?JSON.parse(g):bY(g)}function dj(h){try{return JSON.stringify(h)}catch(g){return cY.stringify(h)}}function cp(h,k,j,g){try{h.apply(k,j)}catch(i){g.emit("error",i)}}function aE(h){if(!a9.running&&a9.queue.length){a9.running=!0;var g=a9.queue.shift();g.action(function(i,j){cp(g.callback,this,[i,j],h),a9.running=!1,fM.nextTick(function(){aE(h)})})}}function b8(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(c9(d4,i,h.type))}}function j1(h,g,i){return{data:dj(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function c3(h){if(!h){return null}var g=aD(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function fJ(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function dv(i,g,j,h){j?h(i?"string"!=typeof i?i:eR(i,g):bq([""],{type:g})):i?"string"!=typeof i?j0(i,function(k){h(cD(k))}):h(i):h("")}function ay(m,j,g,l){function n(){++k===h.length&&l&&l()}function i(s,q){var r=s._attachments[q],p=r.digest,o=g.objectStore(bL).get(p);o.onsuccess=function(u){r.body=u.target.result.body,n()}}var h=Object.keys(m._attachments||{});if(!h.length){return l&&l()}var k=0;h.forEach(function(o){j.attachments&&j.include_docs?i(m,o):(m._attachments[o].stub=!0,n())})}function cZ(h,g){return b2.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return b2.all(j.map(function(n){var l=i.doc._attachments[n];if("body" in l){var m=l.body,k=l.content_type;return new b2(function(o){dv(m,k,g,function(p){i.doc._attachments[n]=ac.extend(dd(l,["digest","content_type"]),{data:p}),o()})})}}))}}))}function bB(m,g,k){function i(){n--,n||j()}function j(){l.length&&l.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||h["delete"](q)}})}var l=[],o=k.objectStore(dG),h=k.objectStore(bL),p=k.objectStore(cK),n=m.length;m.forEach(function(s){var r=o.index("_doc_id_rev"),q=g+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return i()}o["delete"](u);var w=p.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];l.push(x),p["delete"](y.primaryKey),y["continue"]()}else{i()}}}})}function bu(i,g,j){try{return{txn:i.transaction(g,j)}}catch(h){return{error:h}}}function b4(m,j,p,l,n,x,A){function v(){var P=[e7,dG,bL,jK,cK],O=bu(n,P,"readwrite");return O.error?A(O.error):(q=O.txn,q.onabort=b8(A),q.ontimeout=b8(A),q.oncomplete=u,H=q.objectStore(e7),E=q.objectStore(dG),y=q.objectStore(bL),L=q.objectStore(cK),void g(function(Q){return Q?(F=!0,A(Q)):void h()}))}function r(){bs(m.revs_limit,N,l,w,q,s,G,p)}function h(){function Q(){++S===N.length&&r()}function O(W){var V=c3(W.target.result);V&&w.set(V.id,V),Q()}if(N.length){for(var S=0,P=0,R=N.length;R>P;P++){var U=N[P];if(U._id&&du(U._id)){Q()}else{var T=H.get(U.metadata.id);T.onsuccess=O}}}}function u(){F||(x.notify(l._meta.name),l._meta.docCount+=B,A(null,s))}function D(P,O){var Q=y.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=c9(dP,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(N.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){D(T,function(U){U&&!P&&(P=U),O()})})}function G(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?C(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ao){var ai=X.stemmedRevs||[];R&&l.auto_compaction&&(ai=ai.concat(cd(X.metadata))),ai&&ai.length&&bB(ai,X.metadata.id,q),T.seq=ao.target.result,delete T.rev;var ae=j1(T,Q,S),an=H.put(ae);an.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=E.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=E.put(V,ar.target.result);ao.onsuccess=W}}function Z(){s[U]={ok:!0,id:T.id,rev:Q},w.set(X.metadata.id,X.metadata),k(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=E.put(V);Y.onsuccess=W,Y.onerror=P}function C(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;I(an,ai,Q)}})}function k(V,S,P){function U(){++R===Q.length&&P()}function O(W){var Y=V.data._attachments[W].digest,X=L.put({seq:S,digestSeq:Y+"::"+S});X.onsuccess=U,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),U()}}var R=0,Q=Object.keys(V.data._attachments||{});if(!Q.length){return P()}for(var T=0;T<Q.length;T++){O(Q[T])}}function I(Q,O,R){var P=y.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=y.put(U);T.onsuccess=R}}for(var q,H,E,y,L,z,N=j.docs,B=0,M=0,J=N.length;J>M;M++){var o=N[M];o._id&&du(o._id)||(o=N[M]=e3(o,p.new_edits),o.error&&!z&&(z=o))}if(z){return A(z)}var s=new Array(N.length),w=new cJ.Map,F=!1,i=l._meta.blobSupport?"blob":"base64";eg(N,i,function(O){return O?A(O):void v()})}function aw(i,l,k,h,j){try{if(i&&l){return j?IDBKeyRange.bound(l,i,!k,!1):IDBKeyRange.bound(i,l,!1,!k)}if(i){return j?IDBKeyRange.upperBound(i):IDBKeyRange.lowerBound(i)}if(l){return j?IDBKeyRange.lowerBound(l,!k):IDBKeyRange.upperBound(l,!k)}if(h){return IDBKeyRange.only(h)}}catch(g){return{error:g}}return null}function dX(i,g,j,h){return"DataError"===j.name&&0===j.code?h(null,{total_rows:i._meta.docCount,offset:g.skip,rows:[]}):void h(c9(d4,j.name,j.message))}function bM(i,l,k,h){function j(I,s){function H(L,O,M){var N=L.id+"::"+M;D.get(N).onsuccess=function(P){O.doc=fJ(P.target.result),I.conflicts&&(O.doc._conflicts=dZ(L)),ay(O.doc,I,x)}}function v(P,M,L){var O={id:L.id,key:L.id,value:{rev:M}},N=L.deleted;if("ok"===I.deleted){m.push(O),N?(O.value.deleted=!0,O.doc=null):I.include_docs&&H(L,O,M)}else{if(!N&&r--<=0&&(m.push(O),I.include_docs&&H(L,O,M),0===--q)){return}}P["continue"]()}function E(M){K=l._meta.docCount;var O=M.target.result;if(O){var L=c3(O.value),N=L.winningRev;v(O,N,L)}}function z(){s(null,{total_rows:K,offset:I.skip,rows:m})}function F(){I.attachments?cZ(m,I.binary).then(z):z()}var y="startkey" in I?I.startkey:!1,B="endkey" in I?I.endkey:!1,u="key" in I?I.key:!1,r=I.skip||0,q="number"==typeof I.limit?I.limit:-1,J=I.inclusive_end!==!1,G="descending" in I&&I.descending?"prev":null,C=aw(y,B,J,u,G);if(C&&C.error){return dX(l,I,C.error,s)}var A=[e7,dG];I.attachments&&A.push(bL);var o=bu(k,A,"readonly");if(o.error){return s(o.error)}var x=o.txn,n=x.objectStore(e7),w=x.objectStore(dG),p=G?n.openCursor(C,G):n.openCursor(C),D=w.index("_doc_id_rev"),m=[],K=0;x.oncomplete=F,p.onsuccess=E}function g(m,n){return 0===m.limit?n(null,{total_rows:l._meta.docCount,offset:m.skip,rows:[]}):void j(m,n)}g(i,h)}function aB(g){return new b2(function(h){var i=bq([""]);g.objectStore(aJ).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function jV(h,g){var i=this;a9.queue.push({action:function(j){al(i,h,j)},callback:g}),aE(i.constructor)}function al(j,k,o){function q(x){var w=x.createObjectStore(e7,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(bL,{keyPath:"digest"}),x.createObjectStore(dW,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aJ),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(jK,{keyPath:"_id"});var v=x.createObjectStore(cK,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function s(x,w){var v=x.objectStore(e7);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=dh(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function n(v){v.createObjectStore(jK,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function i(v,x){var w=v.objectStore(jK),y=v.objectStore(e7),z=v.objectStore(dG),A=y.openCursor();A.onsuccess=function(H){var E=H.target.result;if(E){var K=E.value,B=K.id,M=du(B),J=dH(K);if(M){var G=B+"::"+J,D=B+"::",I=B+"::~",F=z.index("_doc_id_rev"),C=IDBKeyRange.bound(D,I,!1,!1),L=F.openCursor(C);L.onsuccess=function(N){if(L=N.target.result){var O=L.value;O._doc_id_rev===G&&w.put(O),z["delete"](L.primaryKey),L["continue"]()}else{y["delete"](E.primaryKey),E["continue"]()}}}else{E["continue"]()}}else{x&&x()}}}function u(w){var v=w.createObjectStore(cK,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function g(v,x){var w=v.objectStore(dG),y=v.objectStore(bL),z=v.objectStore(cK),A=y.count();A.onsuccess=function(B){var C=B.target.result;return C?void (w.openCursor().onsuccess=function(H){var D=H.target.result;if(!D){return x()}for(var M=D.value,F=D.primaryKey,J=Object.keys(M._attachments||{}),L={},K=0;K<J.length;K++){var I=M._attachments[J[K]];L[I.digest]=!0}var G=Object.keys(L);for(K=0;K<G.length;K++){var E=G[K];z.put({seq:F,digestSeq:E+"::"+F})}D["continue"]()}):x()}}function l(w){function x(A){return A.data?c3(A):(A.deleted="1"===A.deletedOrLocal,A)}var v=w.objectStore(dG),z=w.objectStore(e7),y=z.openCursor();y.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=v.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=j1(B,B.winningRev,B.deleted),F=z.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=x(E.value);return B.winningRev=B.winningRev||dH(B),B.seq?A():void D()}}}var p=k.name,m=null;j._meta=null,j.type=function(){return"idb"},j._id=fD(function(v){v(null,j._meta.instanceId)}),j._bulkDocs=function(v,w,x){b4(k,v,w,j,m,cv,x)},j._get=function(B,w,v){function z(){v(C,{doc:A,metadata:y,ctx:x})}var A,y,C,x=w.ctx;if(!x){var D=bu(m,[e7,dG,bL],"readonly");if(D.error){return v(D.error)}x=D.txn}x.objectStore(e7).get(B).onsuccess=function(E){if(y=c3(E.target.result),!y){return C=c9(eP,"missing"),z()}if(dh(y)&&!w.rev){return C=c9(eP,"deleted"),z()}var G=x.objectStore(dG),H=w.rev||y.winningRev,F=y.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return A=I.target.result,A&&(A=fJ(A)),A?void z():(C=c9(eP,"missing"),z())}}},j._getAttachment=function(B,w,v,z,A){var y;if(z.ctx){y=z.ctx}else{var C=bu(m,[e7,dG,bL],"readonly");if(C.error){return A(C.error)}y=C.txn}var x=v.digest,D=v.content_type;y.objectStore(bL).get(x).onsuccess=function(E){var F=E.target.result.body;dv(F,D,z.binary,function(G){A(null,G)})}},j._info=function(A){if(null===m||!cQ.has(p)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,z,B=bu(m,[dG],"readonly");if(B.error){return A(B.error)}var w=B.txn,x=w.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,z=j._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:v,idb_attachment_format:j._meta.blobSupport?"binary":"base64"})}},j._allDocs=function(v,w){bM(v,j,m,w)},j._changes=function(x){function E(N){function T(){return S.seq!==O?N["continue"]():(D=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=F.get(U);V.onsuccess=function(W){R(fJ(W.target.result))}}function R(V){var W=x.processChange(V,S,x);W.seq=S.seq;var U=K(W);return"object"==typeof U?x.complete(U):(U&&(z++,B&&H.push(W),x.attachments&&x.include_docs?ay(V,x,w,function(){cZ([W],x.binary).then(function(){x.onChange(W)})}):x.onChange(W)),void (z!==C&&N["continue"]()))}var P=fJ(N.value),O=N.key;if(J&&!J.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (A.get(P._id).onsuccess=function(U){S=c3(U.target.result),y.set(P._id,S),T()})}function v(N){var O=N.target.result;O&&E(O)}function G(){var P=[e7,dG];x.attachments&&P.push(bL);var O=bu(m,P,"readonly");if(O.error){return x.complete(O.error)}w=O.txn,w.onabort=b8(x.complete),w.oncomplete=I,L=w.objectStore(dG),A=w.objectStore(e7),F=L.index("_doc_id_rev");var N;N=x.descending?L.openCursor(null,"prev"):L.openCursor(IDBKeyRange.lowerBound(x.since,!0)),N.onsuccess=v}function I(){function N(){x.complete(null,{results:H,last_seq:D})}!x.continuous&&x.attachments?cZ(H).then(N):N()}if(x=bc(x),x.continuous){var M=p+":"+eM();return cv.addListener(p,M,j,x),cv.notify(p),{cancel:function(){cv.removeListener(p,M)}}}var J=x.doc_ids&&new cJ.Set(x.doc_ids);x.since=x.since||0;var D=x.since,C="limit" in x?x.limit:-1;0===C&&(C=1);var B;B="return_docs" in x?x.return_docs:"returnDocs" in x?x.returnDocs:!0;var w,L,A,F,H=[],z=0,K=aL(x),y=new cJ.Map;G()},j._close=function(v){return null===m?v(c9(cf)):(m.close(),cQ["delete"](p),m=null,void v())},j._getRevisionTree=function(w,x){var v=bu(m,[e7],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(e7).get(w);y.onsuccess=function(B){var A=c3(B.target.result);A?x(null,A.rev_tree):x(c9(eP))}},j._doCompaction=function(y,A,z){var x=[e7,dG,bL,cK],v=bu(m,x,"readwrite");if(v.error){return z(v.error)}var B=v.txn,w=B.objectStore(e7);w.get(y).onsuccess=function(E){var C=c3(E.target.result);ed(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),bB(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(e7).put(j1(C,D,F))},B.onabort=b8(z),B.oncomplete=function(){z()}},j._getLocal=function(w,x){var v=bu(m,[jK],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(jK).get(w);y.onerror=b8(x),y.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,x(null,A)):x(c9(eP))}},j._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=bu(m,[jK],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=b8(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(jK);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(c9(bm))}}):(y=v.add(E),y.onerror=function(F){x(c9(bm)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},j._removeLocal=function(B,w,v){"function"==typeof w&&(v=w,w={});var z=w.ctx;if(!z){var A=bu(m,[jK],"readwrite");if(A.error){return v(A.error)}z=A.txn,z.oncomplete=function(){y&&v(null,y)}}var y,C=B._id,x=z.objectStore(jK),D=x.get(C);D.onerror=b8(v),D.onsuccess=function(F){var E=F.target.result;E&&E._rev===B._rev?(x["delete"](C),y={ok:!0,id:C,rev:"0-0"},w.ctx&&v(null,y)):v(c9(eP))}},j._destroy=function(y,w){cv.removeAllListeners(p);var v=bT.get(p);v&&v.result&&(v.result.close(),cQ["delete"](p));var x=indexedDB.deleteDatabase(p);x.onsuccess=function(){bT["delete"](p),eB()&&p in localStorage&&delete localStorage[p],w(null,{ok:!0})},x.onerror=b8(w)};var h=cQ.get(p);if(h){return m=h.idb,j._meta=h.global,void fM.nextTick(function(){o(null,j)})}var r;r=k.storage?cR(p,k.storage):indexedDB.open(p,cA),bT.set(p,r),r.onupgradeneeded=function(x){function v(){var B=z[A-1];A++,B&&B(w,v)}var y=x.target.result;if(x.oldVersion<1){return q(y)}var w=x.currentTarget.transaction;x.oldVersion<3&&n(y),x.oldVersion<4&&u(y);var z=[s,i,g,l],A=x.oldVersion;v()},r.onsuccess=function(y){m=y.target.result,m.onversionchange=function(){m.close(),cQ["delete"](p)},m.onabort=function(B){bJ("error","Database has a global failure",B.target.error),m.close(),cQ["delete"](p)};var w=m.transaction([dW,aJ,e7],"readwrite"),z=w.objectStore(dW).get(dW),x=null,v=null,A=null;z.onsuccess=function(D){var B=function(){null!==x&&null!==v&&null!==A&&(j._meta={name:p,instanceId:A,blobSupport:x,docCount:v},cQ.set(p,{idb:m,global:j._meta}),o(null,j))},E=D.target.result||{id:dW};p+"_id" in E?(A=E[p+"_id"],B()):(A=eM(),E[p+"_id"]=A,w.objectStore(dW).put(E).onsuccess=function(){B()}),ck||(ck=aB(w)),ck.then(function(F){x=F,B()});var C=w.objectStore(e7).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){v=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";bJ("error",v),o(c9(d4,v))}}function cR(h,g){try{return indexedDB.open(h,{version:cA,storage:g})}catch(i){return indexedDB.open(h,cA)}}function aq(g){g.adapter("idb",jV,!0)}function am(g){return decodeURIComponent(escape(g))}function bf(g){return 65>g?g-48:g-55}function aG(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(bf(i.charCodeAt(g++))<<4|bf(i.charCodeAt(g++)))}return h}function cw(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(bf(i.charCodeAt(g+2))<<12|bf(i.charCodeAt(g+3))<<8|bf(i.charCodeAt(g))<<4|bf(i.charCodeAt(g+1))),g+=4}return h}function cH(h,g){return"UTF-8"===g?am(aG(h,0,h.length)):cw(h,0,h.length)}function cX(g){return"'"+g+"'"}function aR(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cy(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function b5(g){return delete g._id,delete g._rev,JSON.stringify(g)}function aM(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function dl(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function j6(h,k,j,g,i){return"SELECT "+h+" FROM "+("string"==typeof k?k:k.join(" JOIN "))+(j?" ON "+j:"")+(g?" WHERE "+("string"==typeof g?g:g.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function aS(k,i,g){function j(){++m===k.length&&l()}function l(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+bX+" WHERE seq IN "+dl(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+bX+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+bX+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new cJ.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+bX+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+fF+" WHERE digest=?",[A]))})})})}})}}if(k.length){var m=0,h=[];k.forEach(function(o){var n="SELECT seq FROM "+ab+" WHERE doc_id=? AND rev=?";g.executeSql(n,[i,o],function(q,p){if(!p.rows.length){return j()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+ab+" WHERE seq=?",[r],j)})})}}function jL(g){return function(h){bJ("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(c9(eW,j,i))}}function c5(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function bh(s,B,g,m,n,y,x){function k(){return r?x(r):(y.notify(m._name),m._docCount=-1,void x(null,A))}function q(E,D){var F="SELECT count(*) as cnt FROM "+fF+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=c9(dP,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function v(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){q(I,function(J){J&&!E&&(E=J),D()})})}function j(M,F,P,K,I,R,H,E){function O(){function U(ar,at){function a0(){return ++ae===ao.length&&at(),!1}function ai(a1){var a2="INSERT INTO "+bX+" (digest, seq) VALUES (?,?)",a3=[T._attachments[a1].digest,ar];p.executeSql(a2,a3,a0,a0)}var ae=0,ao=Object.keys(T._attachments||{});if(!ao.length){return at()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var T=M.data,W=K?1:0,Z=T._id,V=T._rev,X=b5(T),Y="INSERT INTO "+ab+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",S=[Z,V,X,W];p.executeSql(Y,S,function(an,ai){var ae=ai.insertId;U(ae,function(){N(an,ae)})},function(){var ae=j6("seq",ab,null,"doc_id=? AND rev=?");return p.executeSql(ae,[Z,V],function(ai,an){var ao=an.rows.item(0).seq,ar="UPDATE "+ab+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[X,W,Z,V];ai.executeSql(ar,at,function(a0){U(ao,function(){N(a0,ao)})})}),!1})}function L(S){J||(S?(J=S,E(J)):D===Q.length&&O())}function G(S){D++,L(S)}function N(U,T){var W=M.metadata.id,V=M.stemmedRevs||[];I&&m.auto_compaction&&(V=cd(M.metadata).concat(V)),V.length&&aS(V,W,U),M.metadata.seq=T,delete M.metadata.rev;var X=I?"UPDATE "+bg+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+ab+" WHERE doc_id="+bg+".id AND rev=?) WHERE id=?":"INSERT INTO "+bg+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Y=dj(M.metadata),S=I?[Y,T,F,W]:[W,T,T,Y];U.executeSql(X,S,function(){A[H]={ok:!0,id:M.metadata.id,rev:F},w.set(W,M.metadata),E()})}var J=null,D=0;M.data._id=M.metadata.id,M.data._rev=M.metadata.rev;var Q=Object.keys(M.data._attachments||{});K&&(M.data._deleted=!0),Q.forEach(function(U){var S=M.data._attachments[U];if(S.stub){D++,L()}else{var T=S.data;delete S.data,S.revpos=parseInt(F,10);var V=S.digest;C(V,T,G)}}),Q.length||O()}function h(){bs(s.revs_limit,o,m,w,p,A,j,g)}function i(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&du(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+bg+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=aD(I.rows.item(0).json);w.set(H,K)}D()})})}function C(F,D,G){var E="SELECT digest FROM "+fF+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+fF+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,aR(D)],function(){G()},function(){return G(),!1}))})}var z=g.new_edits,l=B.docs,o=l.map(function(E){if(E._id&&du(E._id)){return E}var D=e3(E,z);return D}),u=o.filter(function(D){return D.error});if(u.length){return x(u[0])}var p,r,A=new Array(o.length),w=new cJ.Map;eg(o,"binary",function(D){return D?x(D):void n.transaction(function(E){p=E,v(function(F){F?r=F:i(h)})},jL(x),k)})}function dM(g){return g.websql(g.name,g.version,g.description,g.size)}function dL(h){try{return{db:dM(h)}}catch(g){return{error:g}}}function kf(h){var g=ej.get(h.name);return g||(g=dL(h),ej.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function aV(k,m,i,g,h){function j(){++o===n.length&&h&&h()}function l(q,s){var r=q._attachments[s],p={binary:m.binary,ctx:g};i._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=ac.extend(dd(r,["digest","content_type"]),{data:v}),j()})}var n=Object.keys(k._attachments||{});if(!n.length){return h&&h()}var o=0;n.forEach(function(p){m.attachments&&m.include_docs?l(k,p):(k._attachments[p].stub=!0,j())})}function eb(v,m){function C(){eB()&&(window.localStorage["_pouch__websqldb_"+x._name]=!0),m(null,x)}function n(F,E){F.executeSql(cW),F.executeSql("ALTER TABLE "+ab+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(jT),F.executeSql("ALTER TABLE "+bg+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+bg+" (local, id)");var G="SELECT "+bg+".winningseq AS seq, "+bg+".json AS metadata FROM "+ab+" JOIN "+bg+" ON "+ab+".seq = "+bg+".winningseq";F.executeSql(G,[],function(M,I){for(var L=[],O=[],H=0;H<I.rows.length;H++){var J=I.rows.item(H),K=J.seq,N=JSON.parse(J.metadata);dh(N)&&L.push(K),du(N.id)&&O.push(N.id)}M.executeSql("UPDATE "+bg+"SET local = 1 WHERE id IN "+dl(O.length),O,function(){M.executeSql("UPDATE "+ab+" SET deleted = 1 WHERE seq IN "+dl(L.length),L,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+dQ+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+bg+".id AS id, "+ab+".json AS data FROM "+ab+" JOIN "+bg+" ON "+ab+".seq = "+bg+".winningseq WHERE local = 1";F.executeSql(H,[],function(M,J){function L(){if(!I.length){return E(M)}var O=I.shift(),N=JSON.parse(O.data)._rev;M.executeSql("INSERT INTO "+dQ+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+bg+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+ab+" WHERE seq=?",[O.seq],function(){L()})})})}for(var I=[],K=0;K<J.rows.length;K++){I.push(J.rows.item(K))}L()})})}function h(G,E){function H(J){function I(){if(!J.length){return E(G)}var L=J.shift(),P=cH(L.hex,B),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+ab+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){I()})}I()}var F="ALTER TABLE "+ab+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+ab+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(cN,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+ab;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function q(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+fF;I.executeSql(J,[],function(K,M){function P(){var Q=j6(ke+", "+bg+".id AS id",[bg,ab],aH,null,bg+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,an){function U(at,ar){var ao=S[at]=S[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!an.rows.length){return E(ai)}for(var S={},W=0;W<an.rows.length;W++){for(var Z=an.rows.item(W),X=aM(Z.data,Z.id,Z.rev),T=Object.keys(X._attachments||{}),V=0;V<T.length;V++){var R=X._attachments[T[V]];U(R.digest,Z.seq)}}var ae=[];if(Object.keys(S).forEach(function(ar){var ao=S[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return P()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+bX+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+bX+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(f4,[],function(J){J.executeSql(aN,[],H)})})}function D(F,E){var G="ALTER TABLE "+fF+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+bg+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+bg+" SET max_seq=(SELECT MAX(seq) FROM "+ab+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+bg+" (max_seq)";J.executeSql(K,[],E)})})}function w(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;B=2===H.length?"UTF-8":"UTF-16",E()})}function y(){for(;u.length>0;){var E=u.pop();E(null,k)}}function s(E,M){if(0===M){var J="CREATE TABLE IF NOT EXISTS "+aW+" (dbid, db_version INTEGER)",G="CREATE TABLE IF NOT EXISTS "+fF+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",P="CREATE TABLE IF NOT EXISTS "+bX+" (digest, seq INTEGER)",N="CREATE TABLE IF NOT EXISTS "+bg+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",O="CREATE TABLE IF NOT EXISTS "+ab+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",I="CREATE TABLE IF NOT EXISTS "+dQ+" (id UNIQUE, rev, json)";E.executeSql(G),E.executeSql(I),E.executeSql(P,[],function(){E.executeSql(aN),E.executeSql(f4)}),E.executeSql(N,[],function(){E.executeSql(cW),E.executeSql(O,[],function(){E.executeSql(jT),E.executeSql(cN),E.executeSql(J,[],function(){var R="INSERT INTO "+aW+" (db_version, dbid) VALUES (?,?)";k=eM();var Q=[fA,k];E.executeSql(R,Q,function(){y()})})})})}else{var K=function(){var Q=fA>M;Q&&E.executeSql("UPDATE "+aW+" SET db_version = "+fA);var R="SELECT dbid FROM "+aW;E.executeSql(R,[],function(T,S){k=S.rows.item(0).dbid,y()})},H=[n,p,h,q,D,r,K],F=M,L=function(Q){H[F-1](Q,L),F++};L(E)}}function g(){l.transaction(function(E){w(E,function(){A(E)})},jL(m),C)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+aW;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+aW,[],function(J,I){var K=I.rows.item(0).db_version;s(J,K)}):H.executeSql("ALTER TABLE "+aW+" ADD COLUMN db_version INTEGER",[],function(){s(H,1)}):s(H,0)})}function j(F,E){if(-1!==x._docCount){return E(x._docCount)}var G=j6("COUNT("+bg+".id) AS 'num'",[bg,ab],aH,ab+".deleted=0");F.executeSql(G,[],function(I,H){x._docCount=H.rows.item(0).num,E(x._docCount)})}var B,x=this,k=null,o=c5(v),u=[];x._docCount=-1,x._name=v.name;var z=ac.extend({},v,{version:az,description:v.name,size:o}),i=kf(z);if(i.error){return jL(m)(i.error)}var l=i.db;"function"!=typeof l.readTransaction&&(l.readTransaction=l.transaction),g(),x.type=function(){return"websql"},x._id=fD(function(E){E(null,k)}),x._info=function(E){l.readTransaction(function(F){j(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+ab;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:l._sqlitePlugin,websql_encoding:B})})})},jL(E))},x._bulkDocs=function(E,G,F){bh(v,E,G,x,l,el,F)},x._get=function(L,M,J){function G(){J(E,{doc:H,metadata:K,ctx:I})}var H,K,E,I=M.ctx;if(!I){return l.readTransaction(function(O){x._get(L,ac.extend({ctx:O},M),J)})}var F,N;M.rev?(F=j6(ke,[bg,ab],bg+".id="+ab+".doc_id",[ab+".doc_id=?",ab+".rev=?"]),N=[L,M.rev]):(F=j6(ke,[bg,ab],aH,bg+".id=?"),N=[L]),I.executeSql(F,N,function(O,P){if(!P.rows.length){return E=c9(eP,"missing"),G()}var Q=P.rows.item(0);return K=aD(Q.metadata),Q.deleted&&!M.rev?(E=c9(eP,"deleted"),G()):(H=aM(Q.data,K.id,Q.rev),void G())})},x._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(bg+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(bg+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(bg+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(bg+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(ab+".deleted = 0"),l.readTransaction(function(S){j(S,function(U){if(P=U,0!==N){var T=j6(ke,[bg,ab],aH,J,bg+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(ao,W){for(var V=0,Z=W.rows.length;Z>V;V++){var an=W.rows.item(V),ar=aD(an.metadata),Y=ar.id,ai=aM(an.data,Y,an.rev),X=ai._rev,ae={id:Y,key:Y,value:{rev:X}};if(E.include_docs&&(ae.doc=ai,ae.doc._rev=X,E.conflicts&&(ae.doc._conflicts=dZ(ar)),aV(ae.doc,E,x,ao)),an.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},jL(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},x._changes=function(I){function J(){var S=bg+".json AS metadata, "+bg+".max_seq AS maxSeq, "+ab+".json AS winningDoc, "+ab+".rev AS winningRev ",T=bg+" JOIN "+ab,R=bg+".id="+ab+".doc_id AND "+bg+".winningseq="+ab+".seq",Q=["maxSeq > ?"],O=[I.since];I.doc_ids&&(Q.push(bg+".id IN "+dl(I.doc_ids.length)),O=O.concat(I.doc_ids));var U="maxSeq "+(F?"DESC":"ASC"),N=j6(S,T,R,Q,U),M=aL(I);I.view||I.filter||(N+=" LIMIT "+K);var P=I.since||0;l.readTransaction(function(V){V.executeSql(N,O,function(at,X){function ar(a0){return function(){I.onChange(a0)}}for(var ai=0,Z=X.rows.length;Z>ai;ai++){var Y=X.rows.item(ai),W=aD(Y.metadata);P=Y.maxSeq;var ae=aM(Y.winningDoc,W.id,Y.winningRev),ao=I.processChange(ae,W,I);ao.seq=Y.maxSeq;var an=M(ao);if("object"==typeof an){return I.complete(an)}if(an&&(E++,H&&G.push(ao),I.attachments&&I.include_docs?aV(ae,I,x,at,ar(ao)):ar(ao)()),E===K){break}}})},jL(I.complete),function(){I.continuous||I.complete(null,{results:G,last_seq:P})})}if(I=bc(I),I.continuous){var L=x._name+":"+eM();return el.addListener(x._name,L,x,I),el.notify(x._name),{cancel:function(){el.removeListener(x._name,L)}}}var F=I.descending;I.since=I.since&&!F?I.since:0;var K="limit" in I?I.limit:-1;0===K&&(K=1);var H;H="return_docs" in I?I.return_docs:"returnDocs" in I?I.returnDocs:!0;var G=[],E=0;J()},x._close=function(E){E()},x._getAttachment=function(L,M,J,G,H){var K,E=G.ctx,I=J.digest,F=J.content_type,N="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+fF+" WHERE digest=?";E.executeSql(N,[I],function(P,O){var Q=O.rows.item(0),R=Q.escaped?cy(Q.body):cH(Q.body,B);K=G.binary?cO(R,F):cD(R),H(null,K)})},x._getRevisionTree=function(F,E){l.readTransaction(function(H){var G="SELECT json AS metadata FROM "+bg+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=aD(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(c9(eP))}})})},x._doCompaction=function(F,E,G){return E.length?void l.transaction(function(H){var I="SELECT json AS metadata FROM "+bg+" WHERE id = ?";H.executeSql(I,[F],function(L,J){var K=aD(J.rows.item(0).metadata);ed(K.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var M="UPDATE "+bg+" SET json = ? WHERE id = ?";L.executeSql(M,[dj(K),F])}),aS(E,F,H)},jL(G),function(){G()}):G()},x._getLocal=function(F,E){l.readTransaction(function(H){var G="SELECT json, rev FROM "+dQ+" WHERE id=?";H.executeSql(G,[F],function(L,J){if(J.rows.length){var K=J.rows.item(0),I=aM(K.json,F,K.rev);E(null,I)}else{E(c9(eP))}})})},x._putLocal=function(J,E,H){function F(N){var P,O;I?(P="UPDATE "+dQ+" SET rev=?, json=? WHERE id=? AND rev=?",O=[G,M,L,I]):(P="INSERT INTO "+dQ+" (id, rev, json) VALUES (?,?,?)",O=[L,G,M]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(K={ok:!0,id:L,rev:G},E.ctx&&H(null,K)):H(c9(bm))},function(){return H(c9(bm)),!1})}"function"==typeof E&&(H=E,E={}),delete J._revisions;var G,I=J._rev,L=J._id;G=I?J._rev="0-"+(parseInt(I.split("-")[1],10)+1):J._rev="0-1";var K,M=b5(J);E.ctx?F(E.ctx):l.transaction(F,jL(H),function(){K&&H(null,K)})},x._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+dQ+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(c9(eP))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):l.transaction(G,jL(E),function(){I&&E(null,I)})},x._destroy=function(F,E){el.removeAllListeners(x._name),l.transaction(function(H){var G=[bg,ab,fF,aW,dQ,bX];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},jL(E),function(){eB()&&(delete window.localStorage["_pouch__websqldb_"+x._name],delete window.localStorage[x._name]),E(null,{ok:!0})})}}function aj(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function dA(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=eB(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=aj();return h&&(localStorage[g]=i?"1":"0"),i}function cV(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:dA()}function e8(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=ac.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function bC(i,g){var j=e8(i),h=ac.extend({websql:j},i);eb.call(this,h,g)}function kk(g){g.adapter("websql",bC,!0)}function cI(){for(var i={},g=new b2(function(k,l){i.resolve=k,i.reject=l}),j=new Array(arguments.length),h=0;h<j.length;h++){j[h]=arguments[h]}return i.promise=g,b2.resolve().then(function(){return fetch.apply(null,j)}).then(function(k){i.resolve(k)})["catch"](function(k){i.reject(k)}),i}function jZ(k,i){var g,j,l,m=new Headers,h={method:k.method,credentials:"include",headers:m};return k.json&&(m.set("Accept","application/json"),m.set("Content-Type",k.headers["Content-Type"]||"application/json")),k.body&&k.body instanceof Blob?bl(k.body,function(n){h.body=n}):k.body&&k.processData&&"string"!=typeof k.body?h.body=JSON.stringify(k.body):"body" in k?h.body=k.body:h.body=null,Object.keys(k.headers).forEach(function(n){k.headers.hasOwnProperty(n)&&m.set(n,k.headers[n])}),g=cI(k.url,h),k.timeout>0&&(j=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+k.url))},k.timeout)),g.promise.then(function(n){return l={statusCode:n.status},k.timeout>0&&clearTimeout(j),l.statusCode>=200&&l.statusCode<300?k.binary?n.blob():n.text():n.json()}).then(function(n){l.statusCode>=200&&l.statusCode<300?i(null,l,n):i(n,l)})["catch"](function(n){i(n,l)}),{abort:g.reject}}function cE(k,m){var i,g,h=!1,j=function(){i.abort()},l=function(){h=!0,i.abort()};i=k.xhr?new k.xhr:new XMLHttpRequest;try{i.open(k.method,k.url)}catch(n){m(n,{statusCode:413})}i.withCredentials="withCredentials" in k?k.withCredentials:!0,"GET"===k.method?delete k.headers["Content-Type"]:k.json&&(k.headers.Accept="application/json",k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json",k.body&&k.processData&&"string"!=typeof k.body&&(k.body=JSON.stringify(k.body))),k.binary&&(i.responseType="arraybuffer"),"body" in k||(k.body=null);for(var o in k.headers){k.headers.hasOwnProperty(o)&&i.setRequestHeader(o,k.headers[o])}return k.timeout>0&&(g=setTimeout(l,k.timeout),i.onprogress=function(){clearTimeout(g),4!==i.readyState&&(g=setTimeout(l,k.timeout))},"undefined"!=typeof i.upload&&(i.upload.onprogress=i.onprogress)),i.onreadystatechange=function(){if(4===i.readyState){var s={statusCode:i.status};if(i.status>=200&&i.status<300){var q;q=k.binary?bq([i.response||""],{type:i.getResponseHeader("Content-Type")}):i.responseText,m(null,s,q)}else{var p={};if(h){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(i.response)}catch(r){}}m(p,s)}}},k.body&&k.body instanceof Blob?bl(k.body,function(p){i.send(p)}):i.send(k.body),{abort:j}}function bi(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function jF(h,g){return d7||h.xhr?cE(h,g):jZ(h,g)}function ad(){return""}function eI(h,k){function j(l,o,m){if(!h.binary&&h.json&&"string"==typeof l){try{l=JSON.parse(l)}catch(n){return m(n)}}Array.isArray(l)&&(l=l.map(function(p){return p.error||p.missing?dk(p):p})),h.binary&&cT(l,o),m(null,l,o)}function g(o,m){var q,n;if(o.code&&o.status){var p=new Error(o.message||o.code);return p.status=o.status,m(p)}if(o.message&&"ETIMEDOUT"===o.message){return m(o)}try{q=JSON.parse(o.responseText),n=dk(q)}catch(l){n=dk(o)}m(n)}h=bc(h);var i={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return h=ac.extend(i,h),h.json&&(h.binary||(h.headers.Accept="application/json"),h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json"),h.binary&&(h.encoding=null,h.json=!1),h.processData||(h.json=!1),jF(h,function(m,q,o){if(m){return m.status=q?q.statusCode:400,g(m,k)}var r,p=q.headers&&q.headers["content-type"],n=o||ad();if(!h.binary&&(h.json||!h.processData)&&"object"!=typeof n&&(/json/.test(p)||/^[\s]*\{/.test(n)&&/\}[\s]*$/.test(n))){try{n=JSON.parse(n.toString())}catch(l){}}q.statusCode>=200&&q.statusCode<300?j(n,q,k):(r=dk(n),r.status=q.statusCode,k(r))})}function eL(m,g){var k=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i=-1!==k.indexOf("safari")&&-1===k.indexOf("chrome"),j=-1!==k.indexOf("msie"),l=-1!==k.indexOf("edge"),o=i||(j||l)&&"GET"===m.method,h="cache" in m?m.cache:!0,p=/^blob:/.test(m.url);if(!p&&(o||!h)){var n=-1!==m.url.indexOf("?");m.url+=(n?"&":"?")+"_nonce="+Date.now()}return eI(m,g)}function eV(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=eR(j.data,j.content_type)})}function aP(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function cF(g){return g._attachments&&Object.keys(g._attachments)?b2.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new b2(function(j){b1(i.data,j)}).then(function(j){i.data=j}):void 0})):b2.resolve()}function cj(h){var g=dz(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function cb(h,g){return j4(h,h.db+"/"+g)}function j4(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function cq(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function bV(j,o){function p(A,y,B){var z=A.ajax||{},x=ac.extend(bc(l),z,y);return bj(x.method+" "+x.url),w._ajax(x,B)}function k(x,y){return new b2(function(z,A){p(x,y,function(C,B){return C?A(C):void z(B)})})}function h(x,y){return ap(x,bz(function(z){v().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(j.skipSetup||j.skip_setup){return b2.resolve()}if(i){return i}var x={method:"GET",url:u};return i=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(eO(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:u})):b2.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:b2.reject(y)}),i["catch"](function(){i=null}),i}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,s=cj;j.getHost&&(s=j.getHost);var m=s(j.name,j),u=cb(m,"");j=bc(j);var l=j.ajax||{};if(w.getUrl=function(){return u},w.getHeaders=function(){return l.headers||{}},j.auth||m.auth){var r=j.auth||m.auth,n=r.username+":"+r.password,g=cD(unescape(encodeURIComponent(n)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var i;setTimeout(function(){o(null,w)}),w.type=function(){return"http"},w.id=h("id",function(x){p({},{method:"GET",url:j4(m,"")},function(y,A){var z=A&&A.uuid?A.uuid+m.db:cb(m,"");x(null,z)})}),w.request=h("request",function(x,y){x.url=cb(m,x.url),p({},x,y)}),w.compact=h("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=bc(x),p(x,{url:cb(m,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),w.bulkGet=ap("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:cb(m,"_bulk_get"+cq(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function G(L){return function(M,N){J[L]=N.results,++H===E&&C(null,{results:fK(J)})}}for(var K=b3,E=Math.ceil(y.docs.length/K),H=0,J=new Array(E),I=0;E>I;I++){var F=dd(y,["revs","attachments"]);F.ajax=l,F.docs=y.docs.slice(I*K,Math.min(y.docs.length,(I+1)*K)),eh(D,F,G(I))}}var D=this,x=j4(m,""),z=c7[x];"boolean"!=typeof z?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(c7[x]=!1,eO(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{c7[x]=!0,C(null,F)}}):z?A(C):B()}),w._info=function(x){v().then(function(){p({},{method:"GET",url:cb(m,"")},function(y,z){return y?x(y):(z.host=cb(m,""),void x(null,z))})})["catch"](x)},w.get=h("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?b2.all(E.map(function(J){var H=G[J],I=aP(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:cb(m,I),binary:!0}).then(function(K){return y.binary?K:new b2(function(L){b1(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?b2.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=bc(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=aP(C);var x={method:"GET",url:cb(m,C+cq(z))};k(y,x).then(function(E){return b2.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),w.remove=h("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:cb(m,aP(C._id))+"?rev="+y},A)}),w.getAttachment=h("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=cb(m,aP(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=h("removeAttachment",function(A,y,z,B){var x=cb(m,aP(A)+"/"+q(y))+"?rev="+z;p({},{method:"DELETE",url:x},B)}),w.putAttachment=h("putAttachment",function(G,z,B,C,E,A){"function"==typeof E&&(A=E,E=C,C=B,B=null);var y=aP(G)+"/"+q(z),x=cb(m,y);if(B&&(x+="?rev="+B),"string"==typeof C){var D;try{D=d6(C)}catch(H){return A(c9(cs,"Attachment is not a valid base64 string"))}C=D?cO(D,E):""}var F={headers:{"Content-Type":E},method:"PUT",url:x,processData:!1,body:C,timeout:l.timeout||60000};p({},F,A)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,v().then(function(){return b2.all(x.docs.map(cF))}).then(function(){p(y,{method:"POST",url:cb(m,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=h("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=bc(C);var A,B={},D="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var x=cq(B);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=dx?x+="&"+z:(D="POST",A={keys:C.keys})}k(C,{method:D,url:cb(m,"_all_docs"+x),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:cB;H=bc(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var F in H.query_params){H.query_params.hasOwnProperty(F)&&(D[F]=H.query_params[F])}}var y,z="GET";if(H.doc_ids){D.filter="_doc_ids";var K=JSON.stringify(H.doc_ids);K.length<dx?D.doc_ids=K:(z="POST",y={doc_ids:H.doc_ids})}var x,I,G=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:z,url:cb(m,"_changes"+cq(D)),timeout:H.timeout,body:y};I=N,H.aborted||v().then(function(){x=p(H,O,M)})["catch"](M)}},E={results:[]},C=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,E.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=aL(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&E.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(I=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,E):setTimeout(function(){G(I,C)},0)}};return G(H.since||0,C),{cancel:function(){H.aborted=!0,x&&x.abort()}}},w.revsDiff=h("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:cb(m,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(x,y){p(x,{url:cb(m,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function dR(g){g.adapter("http",bV,!1),g.adapter("https",bV,!1)}function fN(){this.promise=new b2(function(g){g()})}function eS(m){var j=m.db,g=m.viewName,l=m.map,n=m.reduce,i=m.temporary,h=l.toString()+(n&&n.toString())+"undefined";if(!i&&j._cachedViews){var k=j._cachedViews[h];if(k){return b2.resolve(k)}}return j.info().then(function(p){function o(u){u.views=u.views||{};var r=g;-1===r.indexOf("/")&&(r=g+"/"+g);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(i?"temp":jM(h));return eU(j,"_local/mrviews",o).then(function(){return j.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:j,adapter:j.adapter,mapFun:l,reduceFun:n};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,i||(j._cachedViews=j._cachedViews||{},j._cachedViews[h]=r,r.db.once("destroyed",function(){delete j._cachedViews[h]})),r})})})})}function em(i,l,k,h,j,g){return aZ("return ("+i.replace(/;\s*$/,"")+");",{emit:l,sum:k,log:h,isArray:j,toJSON:g})}function eN(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function bU(g){return 1===g.length&&/^1-/.test(g[0].rev)}function f7(h,g){try{h.emit("error",g)}catch(i){bJ("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),bJ("error",g)}}function ki(i,g,j){try{return{output:g.apply(null,j)}}catch(h){return f7(i,h),{error:h}}}function dD(h,g){var i=cz.collate(h.key,g.key);return 0!==i?i:cz.collate(h.value,g.value)}function f6(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function ah(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function j3(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=eR(k.data,k.content_type)})})}function eD(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&j3(h),h}}function dI(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new dq(g)}function eq(m){for(var j=0,g=0,l=m.length;l>g;g++){var n=m[g];if("number"!=typeof n){if(!Array.isArray(n)){throw dI("_sum")}j="number"==typeof j?[j]:j;for(var i=0,h=n.length;h>i;i++){var k=n[i];if("number"!=typeof k){throw dI("_sum")}"undefined"==typeof j[i]?j.push(k):j[i]+=k}}else{"number"==typeof j?j+=n:j[0]+=n}}return j}function cc(h,k,j,g){var i=k[h];"undefined"!=typeof i&&(g&&(i=encodeURIComponent(JSON.stringify(i))),j.push(h+"="+i))}function km(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function kl(g){return g.group_level=km(g.group_level),g.limit=km(g.limit),g.skip=km(g.skip),g}function eF(g){if(g){if("number"!=typeof g){return new jU('Invalid value for integer: "'+g+'"')}if(0>g){return new jU('Invalid value for positive integer: "'+g+'"')}}}function jP(i,g){var j=i.descending?"endkey":"startkey",h=i.descending?"startkey":"endkey";if("undefined"!=typeof i[j]&&"undefined"!=typeof i[h]&&cz.collate(i[j],i[h])>0){throw new jU("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(g.reduce&&i.reduce!==!1){if(i.include_docs){throw new jU("{include_docs:true} is invalid for reduce")}if(i.keys&&i.keys.length>1&&!i.group&&!i.group_level){throw new jU("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=eF(i[k]);if(l){throw l}})}function eT(k,m,i){var g,h=[],j="GET";if(cc("reduce",i,h),cc("include_docs",i,h),cc("attachments",i,h),cc("limit",i,h),cc("descending",i,h),cc("group",i,h),cc("group_level",i,h),cc("skip",i,h),cc("stale",i,h),cc("conflicts",i,h),cc("startkey",i,h,!0),cc("start_key",i,h,!0),cc("endkey",i,h,!0),cc("end_key",i,h,!0),cc("inclusive_end",i,h),cc("key",i,h,!0),h=h.join("&"),h=""===h?"":"?"+h,"undefined"!=typeof i.keys){var l=2000,n="keys="+encodeURIComponent(JSON.stringify(i.keys));n.length+h.length+1<=l?h+=("?"===h[0]?"&":"?")+n:(j="POST","string"==typeof m?g={keys:i.keys}:m.keys=i.keys)}if("string"==typeof m){var o=eN(m);return k.request({method:j,url:"_design/"+o[0]+"/_view/"+o[1]+h,body:g}).then(eD(i))}return g=g||{},Object.keys(m).forEach(function(p){Array.isArray(m[p])?g[p]=m[p]:g[p]=m[p].toString()}),k.request({method:"POST",url:"_temp_view"+h,body:g}).then(eD(i))}function b9(h,g,i){return new b2(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function jI(g){return new b2(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function e2(g){return function(h){if(404===h.status){return g}throw h}}function kj(j,n,i){function g(){return bU(q)?b2.resolve(m):n.db.get(k)["catch"](e2(m))}function p(r){return r.keys.length?n.db.allDocs({keys:r.keys,include_docs:!0}):b2.resolve({rows:[]})}function h(x,y){for(var s=[],A={},r=0,v=y.rows.length;v>r;r++){var w=y.rows[r],B=w.doc;if(B&&(s.push(B),A[B._id]=!0,B._deleted=!o[B._id],!B._deleted)){var z=o[B._id];"value" in z&&(B.value=z.value)}}var u=Object.keys(o);return u.forEach(function(C){if(!A[C]){var E={_id:C},D=o[C];"value" in D&&(E.value=D.value),s.push(E)}}),x.keys=f2(u.concat(x.keys)),s.push(x),s}var k="_local/doc_"+j,m={_id:k,keys:[]},l=i[j],o=l.indexableKeysToKeyValues,q=l.changes;return g().then(function(r){return p(r).then(function(s){return h(r,s)})})}function bv(i,g,j){var h="_local/lastSeq";return i.db.get(h)["catch"](e2({_id:h,seq:0})).then(function(k){var l=Object.keys(g);return b2.all(l.map(function(m){return kj(m,i,g)})).then(function(m){var n=fK(m);return k.seq=j,n.push(k),i.db.bulkDocs({docs:n})})})}function kb(h){var g="string"==typeof h?h:h.name,i=ax[g];return i||(i=ax[g]=new fN),i}function ec(g){return b7(kb(g),function(){return fQ(g)})()}function fQ(k){function m(p,r){var q={id:h._id,key:cz.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=cz.normalizeKey(r)),g.push(q)}function i(q,p){return function(){return bv(k,q,p)}}var g,h,j;if("function"==typeof k.mapFun&&2===k.mapFun.length){var l=k.mapFun;j=function(p){return l(p,m)}}else{j=em(k.mapFun.toString(),m,eq,bN,Array.isArray,JSON.parse)}var n=k.seq||0,o=new fN;return new b2(function(p,s){function r(){o.finish().then(function(){k.seq=n,p()})}function q(){function u(v){s(v)}k.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:n,limit:bD}).on("complete",function(C){var x=C.results;if(!x.length){return r()}for(var H={},v=0,F=x.length;F>v;v++){var A=x[v];if("_"!==A.doc._id[0]){g=[],h=A.doc,h._deleted||ki(k.sourceDB,j,[h]),g.sort(dD);for(var D,z={},y=0,E=g.length;E>y;y++){var G=g[y],w=[G.key,G.id];0===cz.collate(G.key,D)&&w.push(y);var B=cz.toIndexableString(w);z[B]=G,D=G.key}H[A.doc._id]={indexableKeysToKeyValues:z,changes:A.changes}}n=A.seq}return o.add(i(H,n)),x.length<bD?r():q()}).on("error",u)}q()})}function kg(j,n,i){0===i.group_level&&delete i.group_level;var g,p=i.group||i.group_level;g=ak[j.reduceFun]?ak[j.reduceFun]:em(j.reduceFun.toString(),null,eq,bN,Array.isArray,JSON.parse);var h=[],k=isNaN(i.group_level)?Number.POSITIVE_INFINITY:i.group_level;n.forEach(function(r){var u=h[h.length-1],s=p?r.key:null;return p&&Array.isArray(s)&&(s=s.slice(0,k)),u&&0===cz.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void h.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),n=[];for(var m=0,l=h.length;l>m;m++){var o=h[m],q=ki(j.sourceDB,g,[o.keys,o.values,!1]);if(q.error&&q.error instanceof dq){throw q.error}n.push({value:q.error?null:q.output,key:o.groupKey})}return{rows:f6(n,i.limit,i.skip)}}function ef(h,g){return b7(kb(h),function(){return jH(h,g)})()}function jH(r,j){function m(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return l=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=cz.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function k(u){var w;if(w=o?kg(r,u,j):{total_rows:l,offset:h,rows:u},j.include_docs){var v=f2(u.map(ah));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:j.conflicts,attachments:j.attachments,binary:j.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),u.forEach(function(A){var B=ah(A),z=y["$"+B];z&&(A.doc=z)}),w})}return w}var l,o=r.reduceFun&&j.reduce!==!1,h=j.skip||0;if("undefined"==typeof j.keys||j.keys.length||(j.limit=0,delete j.keys),"undefined"!=typeof j.keys){var p=j.keys,i=p.map(function(v){var u={startkey:cz.toIndexableString([v]),endkey:cz.toIndexableString([v,{}])};return m(u)});return b2.all(i).then(fK).then(k)}var g={descending:j.descending};if(j.start_key&&(j.startkey=j.start_key),j.end_key&&(j.endkey=j.end_key),"undefined"!=typeof j.startkey&&(g.startkey=j.descending?cz.toIndexableString([j.startkey,{}]):cz.toIndexableString([j.startkey])),"undefined"!=typeof j.endkey){var q=j.inclusive_end!==!1;j.descending&&(q=!q),g.endkey=cz.toIndexableString(q?[j.endkey,{}]:[j.endkey])}if("undefined"!=typeof j.key){var n=cz.toIndexableString([j.key]),s=cz.toIndexableString([j.key,{}]);g.descending?(g.endkey=n,g.startkey=s):(g.startkey=n,g.endkey=s)}return o||("number"==typeof j.limit&&(g.limit=j.limit),g.skip=h),m(g).then(k)}function c0(g){return g.request({method:"POST",url:"_view_cleanup"})}function j2(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(m){var k=eN(m),l="_design/"+k[0],n=k[1];j[l]=j[l]||{},j[l][n]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(m){var n={};m.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){n[v]=n[v]||s})})});var l=Object.keys(n).filter(function(o){return !n[o]}),k=l.map(function(o){return b7(kb(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return b2.all(k).then(function(){return{ok:!0}})})},e2({ok:!0}))}function fO(n,k,m){if("http"===n.type()){return eT(n,k,m)}if("function"==typeof n._query){return b9(n,k,m)}if("string"!=typeof k){jP(m,k);var g={db:n,viewName:"temp_view/temp_view",map:k.map,reduce:k.reduce,temporary:!0};return cg.add(function(){return eS(g).then(function(o){function p(){return o.db.destroy()}return jS(ec(o).then(function(){return ef(o,m)}),p)})}),cg.finish()}var j=k,h=eN(j),l=h[0],i=h[1];return n.get("_design/"+l).then(function(o){var p=o.views&&o.views[i];if(!p||"string"!=typeof p.map){throw new jO("ddoc "+l+" has no view named "+i)}jP(m,p);var q={db:n,viewName:j,map:p.map,reduce:p.reduce};return eS(q).then(function(r){return"ok"===m.stale||"update_after"===m.stale?("update_after"===m.stale&&fM.nextTick(function(){ec(r)}),ef(r,m)):ec(r).then(function(){return ef(r,m)})})})}function jU(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,jU)}catch(g){}}function jO(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,jO)}catch(g){}}function dq(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,dq)}catch(g){}}function jX(g){return/^1-/.test(g)}function da(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function dS(h,g){var i=Object.keys(g._attachments);return b2.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function dm(h,k,j){var g="http"===k.type()&&"http"!==h.type(),i=Object.keys(j._attachments);return g?h.get(j._id).then(function(l){return b2.all(i.map(function(m){return da(l,j,m)?k.getAttachment(j._id,m):h.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return dS(k,j)}):dS(k,j)}function aC(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function j9(i,m,h,p){function g(){var r=aC(h);if(r.docs.length){return i.bulkGet(r).then(function(s){if(p.cancelled){throw new Error("cancelled")}return b2.all(s.results.map(function(u){return b2.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?dm(m,i,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){o=o.concat(fK(u).filter(Boolean))})})}}function j(r){return r._attachments&&Object.keys(r._attachments).length>0}function k(r){return i.allDocs({keys:r,include_docs:!0}).then(function(s){if(p.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&jX(u.value.rev)&&!j(u.doc)&&(o.push(u.doc),delete h[u.id])})})}function n(){var r=Object.keys(h).filter(function(s){var u=h[s].missing;return 1===u.length&&jX(u[0])});return r.length>0?k(r):void 0}function l(){return{ok:q,docs:o}}h=bc(h);var o=[],q=!0;return b2.resolve().then(n).then(g).then(l)}function bb(h,k,j,g,i){return h.get(k)["catch"](function(l){if(404===l.status){return"http"===h.type()&&eO(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:g,_id:k,history:[],replicator:dK,version:b0}}throw l}).then(function(l){return i.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==g}),l.history.unshift({last_seq:j,session_id:g}),l.history=l.history.slice(0,bp),l.version=b0,l.replicator=dK,l.session_id=g,l.last_seq=j,h.put(l)["catch"](function(m){if(409===m.status){return bb(h,k,j,g,i)}throw m}))})}function cl(i,g,j,h){this.src=i,this.target=g,this.id=j,this.returnValue=h}function cC(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:fR(h.history,g.history)}function fR(m,j){var g=m[0],l=m.slice(1),n=j[0],i=j.slice(1);if(!g||0===j.length){return{last_seq:bZ,history:[]}}var h=g.session_id;if(f9(h,j)){return{last_seq:g.last_seq,history:m}}var k=n.session_id;return f9(k,l)?{last_seq:n.last_seq,history:i}:fR(l,i)}function f9(i,g){var j=g[0],h=g.slice(1);return i&&0!==g.length?i===j.session_id?!0:f9(i,h):!1}function bO(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function cx(i,g,j,h){return i.retry===!1?(g.emit("error",j),void g.removeAllListeners()):("function"!=typeof i.back_off_function&&(i.back_off_function=dY),g.emit("requestError",j),"active"!==g.state&&"pending"!==g.state||(g.emit("paused",j),g.state="stopped",g.once("active",function(){i.current_back_off=d9})),i.current_back_off=i.current_back_off||d9,i.current_back_off=i.back_off_function(i.current_back_off),void setTimeout(h,i.current_back_off))}function fL(g){return Object.keys(g).sort(cz.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function dU(k,i,g){var j=g.doc_ids?g.doc_ids.sort(cz.collate):"",l=g.filter?g.filter.toString():"",m="",h="";return g.filter&&g.query_params&&(m=JSON.stringify(fL(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),b2.all([k.id(),i.id()]).then(function(n){var o=n[0]+n[1]+l+h+m+j;return new b2(function(p){jG(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dN(P,m,z,u,y){function F(){return L?b2.resolve():dU(P,m,z).then(function(T){k=T,L=new cl(P,m,k,u)})}function s(){if(q=[],0!==N.docs.length){var T=N.docs;return m.bulkDocs({docs:T,new_edits:!1}).then(function(X){if(u.cancelled){throw x(),new Error("cancelled")}var U=[],W={};X.forEach(function(Z){Z.error&&(y.doc_write_failures++,U.push(Z),W[Z.id]=Z)}),O=O.concat(U),y.docs_written+=N.docs.length-U.length;var V=U.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=W[Z._id];ae?u.emit("denied",bc(ae)):q.push(Z)}),V.length>0){var Y=new Error("bulkDocs error");throw Y.other_errors=U,G("target.bulkDocs failed to write docs",Y),new Error("bulkWrite partial failure")}},function(U){throw y.doc_write_failures+=T.length,U})}}function n(){if(N.error){throw new Error("There was a problem getting docs.")}y.last_seq=E=N.seq;var T=bc(y);return q.length&&(T.docs=q,u.emit("change",T)),I=!0,L.writeCheckpoint(N.seq,Q).then(function(){if(I=!1,u.cancelled){throw x(),new Error("cancelled")}N=void 0,B()})["catch"](l)}function g(){var T={};return N.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),m.revsDiff(T).then(function(U){if(u.cancelled){throw x(),new Error("cancelled")}N.diffs=U})}function K(){return j9(P,m,N.diffs,u).then(function(T){N.error=!T.ok,T.docs.forEach(function(U){delete N.diffs[U._id],y.docs_read++,N.docs.push(U)})})}function C(){if(!u.cancelled&&!N){if(0===D.length){return void i(!0)}N=D.shift(),g().then(K).then(s).then(n).then(C)["catch"](function(T){G("batch processing terminated with error",T)})}}function i(T){return 0===w.changes.length?void (0!==D.length||N||((p&&A.live||r)&&(u.state="pending",u.emit("paused")),r&&x())):void ((T||r||w.changes.length>=h)&&(D.push(w),w={seq:0,changes:[],docs:[]},"pending"!==u.state&&"stopped"!==u.state||(u.state="active",u.emit("active")),C()))}function G(U,T){J||(T.message||(T.message=U),y.ok=!1,y.status="aborting",y.errors.push(T),O=O.concat(T),D=[],w={seq:0,changes:[],docs:[]},x())}function x(){if(!(J||u.cancelled&&(y.status="cancelled",I))){y.status=y.status||"complete",y.end_time=new Date,y.last_seq=E,J=!0;var U=O.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=O.pop();O.length>0&&(T.other_errors=O),T.result=y,cx(z,u,T,function(){dN(P,m,z,u)})}else{y.errors=O,u.emit("complete",y),u.removeAllListeners()}}}function R(U){if(u.cancelled){return x()}var T=aL(z)(U);T&&(w.seq=U.seq,w.changes.push(U),i(0===D.length&&A.live))}function S(U){if(o=!1,u.cancelled){return x()}if(U.results.length>0){A.since=U.last_seq,B(),i(!0)}else{var T=function(){p?(A.live=!0,B()):r=!0,i(!0)};N||0!==U.results.length?T():(I=!0,L.writeCheckpoint(U.last_seq,Q).then(function(){I=!1,y.last_seq=E=U.last_seq,T()})["catch"](l))}}function v(T){return o=!1,u.cancelled?x():void G("changes rejected",T)}function B(){function U(){T.cancel()}function V(){u.removeListener("cancel",U)}if(!o&&!r&&D.length<j){o=!0,u._changes&&(u.removeListener("cancel",u._abortChanges),u._changes.cancel()),u.once("cancel",U);var T=P.changes(A).on("change",R);T.then(V,V),T.then(S)["catch"](v),z.retry&&(u._changes=T,u._abortChanges=U)}}function H(){F().then(function(){return u.cancelled?void x():L.getCheckpoint().then(function(T){E=T,A={since:E,limit:h,batch_size:h,style:"all_docs",doc_ids:M,return_docs:!0},z.filter&&("string"!=typeof z.filter?A.include_docs=!0:A.filter=z.filter),"heartbeat" in z&&(A.heartbeat=z.heartbeat),"timeout" in z&&(A.timeout=z.timeout),z.query_params&&(A.query_params=z.query_params),z.view&&(A.view=z.view),B()})})["catch"](function(T){G("getCheckpoint rejected with ",T)})}function l(T){throw I=!1,G("writeCheckpoint completed with error",T),T}var N,k,L,D=[],w={seq:0,changes:[],docs:[]},I=!1,r=!1,J=!1,E=0,p=z.continuous||z.live||!1,h=z.batch_size||100,j=z.batches_limit||10,o=!1,M=z.doc_ids,O=[],q=[],Q=eM();y=y||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var A={};return u.ready(P,m),u.cancelled?void x():(u._addedListeners||(u.once("cancel",x),"function"==typeof z.complete&&(u.once("error",z.complete),u.once("complete",function(T){z.complete(null,T)})),u._addedListeners=!0),void ("undefined"==typeof z.since?H():F().then(function(){return I=!0,L.writeCheckpoint(z.since,Q)}).then(function(){return I=!1,u.cancelled?void x():(E=z.since,void H())})["catch"](l)))}function dO(){cS.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new b2(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function bQ(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function dc(k,i,g,j){if("function"==typeof g&&(j=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw c9(dJ,"`doc_ids` filter parameter is not a list.")}g.complete=j,g=bc(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var l=new dO(g),m=bQ(k,g),h=bQ(i,g);return dN(m,h,g,l),l}function ca(i,g,j,h){return"function"==typeof j&&(h=j,j={}),"undefined"==typeof j&&(j={}),j=bc(j),j.PouchConstructor=j.PouchConstructor||this,i=bQ(i,j),g=bQ(g,j),new d0(i,g,j,h)}function d0(m,u,v,o){function s(z){k.emit("change",{direction:"pull",change:z})}function y(z){k.emit("change",{direction:"push",change:z})}function r(z){k.emit("denied",{direction:"push",doc:z})}function w(z){k.emit("denied",{direction:"pull",doc:z})}function i(){k.pushPaused=!0,k.pullPaused&&k.emit("paused")}function p(){k.pullPaused=!0,k.pushPaused&&k.emit("paused")}function l(){k.pushPaused=!1,k.pullPaused&&k.emit("active",{direction:"push"})}function x(){k.pullPaused=!1,k.pushPaused&&k.emit("active",{direction:"pull"})}function n(z){return function(D,B){var C="change"===D&&(B===s||B===y),F="denied"===D&&(B===w||B===r),A="paused"===D&&(B===p||B===i),E="active"===D&&(B===x||B===l);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&k.removeAllListeners(D))}}var k=this;this.canceled=!1;var q=v.push?ac.extend({},v,v.push):v,h=v.pull?ac.extend({},v,v.pull):v;this.push=dc(m,u,q),this.pull=dc(u,m,h),this.pushPaused=!0,this.pullPaused=!0;var g={};v.live&&(this.push.on("complete",k.pull.cancel.bind(k.pull)),this.pull.on("complete",k.push.cancel.bind(k.push))),this.on("newListener",function(z){"change"===z?(k.pull.on("change",s),k.push.on("change",y)):"denied"===z?(k.pull.on("denied",w),k.push.on("denied",r)):"active"===z?(k.pull.on("active",x),k.push.on("active",l)):"paused"===z&&(k.pull.on("paused",p),k.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(k.pull.removeListener("change",s),k.push.removeListener("change",y)):"denied"===z?(k.pull.removeListener("denied",w),k.push.removeListener("denied",r)):"active"===z?(k.pull.removeListener("active",x),k.push.removeListener("active",l)):"paused"===z&&(k.pull.removeListener("paused",p),k.push.removeListener("paused",i))}),this.pull.on("removeListener",n("pull")),this.push.on("removeListener",n("push"));var j=b2.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return k.emit("complete",z),o&&o(null,z),k.removeAllListeners(),z},function(z){if(k.cancel(),o?o(z):k.emit("error",z),k.removeAllListeners(),o){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function e9(g){g.replicate=dc,g.sync=ca}var ka,ac=d(9),au=ds(d(5)),c8=ds(d(8)),aX=ds(d(10)),cJ=d(14),bz=ds(d(4)),cS=d(1),aZ=ds(d(15)),d5=ds(d(16)),cY=ds(d(17)),cz=d(12),b2="function"==typeof Promise?Promise:aX,eZ=Function.prototype.toString,c6=eZ.call(Object),eH=au("pouchdb:api"),aK=6;if(dT()){ka=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),ka=!!localStorage.getItem("_pouch_check_localstorage")}catch(dF){ka=!1}}c8(f3,cS.EventEmitter),f3.prototype.addListener=function(k,i,g,j){function l(){function n(){h=!1}if(m._listeners[i]){if(h){return void (h="waiting")}h=!0;var o=dd(j,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>j.since&&!j.cancelled&&(j.since=p.seq,j.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){l()},0),h=!1}).on("error",n)}}if(!this._listeners[i]){var m=this,h=!1;this._listeners[i]=l,this.on(k,l)}},f3.prototype.removeListener=function(h,g){g in this._listeners&&cS.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},f3.prototype.notifyLocalWindows=function(g){dT()?chrome.storage.local.set({dbName:g}):eB()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},f3.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},c8(fE,Error),fE.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var cL=new fE({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),by=new fE({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),eP=new fE({status:404,error:"not_found",reason:"missing"}),bm=new fE({status:409,error:"conflict",reason:"Document update conflict"}),b6=new fE({status:400,error:"invalid_id",reason:"_id field must contain a string"}),bW=new fE({status:412,error:"missing_id",reason:"_id is required for puts"}),eJ=new fE({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),cf=new fE({status:412,error:"precondition_failed",reason:"Database not open"}),c2=new fE({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),cs=new fE({status:500,error:"badarg",reason:"Some query argument is invalid"}),e6=new fE({status:400,error:"invalid_request",reason:"Request was invalid"}),bw=new fE({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),dw=new fE({status:500,error:"doc_validation",reason:"Bad special document member"}),dJ=new fE({status:400,error:"bad_request",reason:"Something wrong with the request"}),kd=new fE({status:400,error:"bad_request",reason:"Document must be a JSON object"}),cM=new fE({status:404,error:"not_found",reason:"Database not found"}),d4=new fE({status:500,error:"indexed_db_went_bad",reason:"unknown"}),eW=new fE({status:500,error:"web_sql_went_bad",reason:"unknown"}),df=new fE({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),ba=new fE({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),fG=new fE({status:400,error:"bad_request",reason:"Invalid rev format"}),d1=new fE({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),dP=new fE({status:412,error:"missing_stub"}),bA=new fE({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cu=[cL,by,eP,bm,b6,bW,eJ,cf,c2,cs,e6,bw,dw,dJ,kd,cM,eW,df,ba,fG,d1,dP,d4,bA],dV=function(i,g,j){var h=cu.filter(function(k){return k[i]===g});return j&&h.filter(function(k){return k.message===j})[0]||h[0]},eQ=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],bF="queryKey",kh=/(?:^|&)([^&=]*)=?([^&]*)/g,fC=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");c8(fH,cS.EventEmitter),fH.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fH.prototype.doChanges=function(h){var k=this,j=h.complete;if(h=bc(h),"live" in h&&!("continuous" in h)&&(h.continuous=h.live),h.processChange=jY,"latest"===h.since&&(h.since="now"),h.since||(h.since=0),"now"===h.since){return void this.db.info().then(function(l){return k.isCancelled?void j(null,{status:"cancelled"}):(h.since=l.update_seq,void k.doChanges(h))},j)}if(h.continuous&&"now"!==h.since&&this.db.info().then(function(l){k.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),h.view&&!h.filter&&(h.filter="_view"),h.filter&&"string"==typeof h.filter&&("_view"===h.filter?h.view=bS(h.view):h.filter=bS(h.filter),"http"!==this.db.type()&&!h.doc_ids)){return this.filterChanges(h)}"descending" in h||(h.descending=!1),h.limit=0===h.limit?1:h.limit,h.complete=j;var g=this.db._changes(h);if(g&&"function"==typeof g.cancel){var i=k.cancel;k.cancel=bz(function(l){g.cancel(),i.apply(this,l)})}},fH.prototype.filterChanges=function(i){var l=this,k=i.complete;if("_view"===i.filter){if(!i.view||"string"!=typeof i.view){var h=c9(dJ,"`view` filter parameter not found or invalid.");return k(h)}var j=aQ(i.view);this.db.get("_design/"+j[0],function(m,o){if(l.isCancelled){return k(null,{status:"cancelled"})}if(m){return k(dk(m))}var n=o&&o.views&&o.views[j[1]]&&o.views[j[1]].map;return n?(i.filter=bI(n),void l.doChanges(i)):k(c9(eP,o.views?"missing json key: "+j[1]:"missing json key: views"))})}else{var g=aQ(i.filter);if(!g){return l.doChanges(i)}this.db.get("_design/"+g[0],function(n,o){if(l.isCancelled){return k(null,{status:"cancelled"})}if(n){return k(dk(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(i.filter=c4(m),void l.doChanges(i)):k(c9(eP,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},c8(c1,cS.EventEmitter),c1.prototype.post=ap("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(c9(kd)):void this.bulkDocs({docs:[h]},g,ep(i))}),c1.prototype.put=ap("put",bz(function(k){function m(){l||(bJ("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),l=!0)}var i,g,h,j,l=!1,n=k.shift(),o="_id" in n;if("object"!=typeof n||Array.isArray(n)){return(j=k.pop())(c9(kd))}for(;;){if(i=k.shift(),g=typeof i,"string"!==g||o?"string"!==g||!o||"_rev" in n?"object"===g?h=i:"function"===g&&(j=i):(m(),n._rev=i):(m(),n._id=i,o=!0),!k.length){break}}return h=h||{},aU(n._id),du(n._id)&&"function"==typeof this._putLocal?n._deleted?this._removeLocal(n,j):this._putLocal(n,j):void this.bulkDocs({docs:[n]},h,ep(j))})),c1.prototype.putAttachment=ap("putAttachment",function(k,i,g,j,l){function m(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[i]={content_type:l,data:j,revpos:++n},h.put(o)}var h=this;return"function"==typeof l&&(l=j,j=g,g=null),"undefined"==typeof l&&(l=j,j=g,g=null),h.get(k).then(function(n){if(n._rev!==g){throw c9(bm)}return m(n)},function(n){if(n.reason===eP.message){return m({_id:k})}throw n})}),c1.prototype.removeAttachment=ap("removeAttachment",function(h,k,j,g){var i=this;i.get(h,function(m,l){return m?void g(m):l._rev!==j?void g(c9(bm)):l._attachments?(delete l._attachments[k],0===Object.keys(l._attachments).length&&delete l._attachments,void i.put(l,g)):g()})}),c1.prototype.remove=ap("remove",function(i,l,k,h){var j;"string"==typeof l?(j={_id:i,_rev:l},"function"==typeof k&&(h=k,k={})):(j=i,"function"==typeof l?(h=l,k={}):(h=k,k=l)),k=k||{},k.was_delete=!0;var g={_id:j._id,_rev:j._rev||k.rev};return g._deleted=!0,du(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(j,h):void this.bulkDocs({docs:[g]},k,ep(h))}),c1.prototype.revsDiff=ap("revsDiff",function(m,j,g){function l(o,p){k.has(o)||k.set(o,{missing:[]}),k.get(o).missing.push(p)}function n(q,p){var o=m[q].slice(0);ed(p,function(s,r,x,v,w){var y=r+"-"+x,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==w.status&&l(q,y))}),o.forEach(function(r){l(q,r)})}"function"==typeof j&&(g=j,j={});var i=Object.keys(m);if(!i.length){return g(null,{})}var h=0,k=new cJ.Map;i.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){k.set(o,{missing:m[o]})}else{if(q){return g(q)}n(o,p)}if(++h===i.length){var r={};return k.forEach(function(u,s){r[s]=u}),g(null,r)}})},this)}),c1.prototype.bulkGet=ap("bulkGet",function(h,g){eh(this,h,g)}),c1.prototype.compactDocument=ap("compactDocument",function(i,g,j){var h=this;this._getRevisionTree(i,function(n,l){if(n){return j(n)}var o=aY(l),m=[],k=[];Object.keys(o).forEach(function(p){o[p]>g&&m.push(p)}),ed(l,function(s,q,v,r,u){var p=q+"-"+v;"available"===u.status&&-1!==m.indexOf(p)&&k.push(p)}),h._doCompaction(i,k,j)})}),c1.prototype.compact=ap("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&aA(i)}),c1.prototype._compact=function(k,i){function g(n){h.push(l.compactDocument(n.id,0))}function j(o){var n=o.last_seq;b2.all(h).then(function(){return eU(l,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){i(null,{ok:!0})})["catch"](i)}var l=this,m={return_docs:!1,last_seq:k.last_seq||0},h=[];l.changes(m).on("change",g).on("complete",j).on("error",i)},c1.prototype.get=ap("get",function(m,j,g){function l(){var o=[],p=n.length;return p?void n.forEach(function(q){i.get(m,{rev:q,revs:j.revs,attachments:j.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||g(null,o)})}):g(null,o)}if("function"==typeof j&&(g=j,j={}),"string"!=typeof m){return g(c9(b6))}if(du(m)&&"function"==typeof this._getLocal){return this._getLocal(m,g)}var n=[],i=this;if(!j.open_revs){return this._get(m,j,function(B,o){if(B){return g(B)}var x=o.doc,u=o.metadata,v=o.ctx;if(j.conflicts){var w=dZ(u);w.length&&(x._conflicts=w)}if(dh(u,x._rev)&&(x._deleted=!0),j.revs||j.revs_info){var r=eE(u.rev_tree),A=a8(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(x._rev.split("-")[1])}),s=A.ids.map(function(D){return D.id}).indexOf(x._rev.split("-")[1])+1,p=A.ids.length-s;if(A.ids.splice(s,p),A.ids.reverse(),j.revs&&(x._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),j.revs_info){var C=A.pos+A.ids.length;x._revs_info=A.ids.map(function(D){return C--,{rev:C+"-"+D.id,status:D.opts.status}})}}if(j.attachments&&x._attachments){var q=x._attachments,y=Object.keys(q).length;if(0===y){return g(null,x)}Object.keys(q).forEach(function(D){this._getAttachment(x._id,D,q[D],{rev:x._rev,binary:j.binary,ctx:v},function(F,G){var E=x._attachments[D];E.data=G,delete E.stub,delete E.length,--y||g(null,x)})},i)}else{if(x._attachments){for(var z in x._attachments){x._attachments.hasOwnProperty(z)&&(x._attachments[z].stub=!0)}}g(null,x)}})}if("all"===j.open_revs){this._getRevisionTree(m,function(o,p){return o?g(o):(n=e5(p).map(function(q){return q.rev}),void l())})}else{if(!Array.isArray(j.open_revs)){return g(c9(c2,"function_clause"))}n=j.open_revs;for(var h=0;h<n.length;h++){var k=n[h];if("string"!=typeof k||!/^\d+-/.test(k)){return g(c9(fG))}}l()}}),c1.prototype.getAttachment=ap("getAttachment",function(h,k,j,g){var i=this;j instanceof Function&&(g=j,j={}),this._get(h,j,function(m,l){return m?g(m):l.doc._attachments&&l.doc._attachments[k]?(j.ctx=l.ctx,j.binary=!0,i._getAttachment(h,k,l.doc._attachments[k],j,g),void 0):g(c9(eP))})}),c1.prototype.allDocs=ap("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(c9(bw,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return ek(this,h,g)}}return this._allDocs(h,g)}),c1.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new fH(this,h,g)},c1.prototype.close=ap("close",function(g){return this._closed=!0,this._close(g)}),c1.prototype.info=ap("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),c1.prototype.id=ap("id",function(g){return this._id(g)}),c1.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},c1.prototype.bulkDocs=ap("bulkDocs",function(h,k,j){if("function"==typeof k&&(j=k,k={}),k=k||{},Array.isArray(h)&&(h={docs:h}),!h||!h.docs||!Array.isArray(h.docs)){return j(c9(by))}for(var g=0;g<h.docs.length;++g){if("object"!=typeof h.docs[g]||Array.isArray(h.docs[g])){return j(c9(kd))}}var i;return h.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){i=i||bd(m)})}),i?j(c9(dJ,i)):("new_edits" in k||("new_edits" in h?k.new_edits=h.new_edits:k.new_edits=!0),k.new_edits||"http"===this.type()||h.docs.sort(jJ),bK(h.docs),this._bulkDocs(h,k,function(m,l){return m?j(m):(k.new_edits||(l=l.filter(function(n){return n.error})),void j(null,l))}))}),c1.prototype.registerDependentDatabase=ap("registerDependentDatabase",function(i,g){function j(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[i]?!1:(k.dependentDbs[i]=!0,k)}var h=new this.constructor(i,this.__opts);eU(this,"_local/_pouch_dependentDbs",j).then(function(){g(null,{db:h})})["catch"](g)}),c1.prototype.destroy=ap("destroy",function(h,k){function j(){g._destroy(h,function(l,m){return l?k(l):(g._destroyed=!0,g.emit("destroyed"),void k(null,m||{ok:!0}))})}"function"==typeof h&&(k=h,h={});var g=this,i="use_prefix" in g?g.use_prefix:!0;return"http"===g.type()?j():void g.get("_local/_pouch_dependentDbs",function(o,m){if(o){return 404!==o.status?k(o):j()}var p=m.dependentDbs,n=g.constructor,l=Object.keys(p).map(function(r){var q=i?r.replace(new RegExp("^"+n.prefix),""):r;return new n(q,g.__opts).destroy()});b2.all(l).then(j,k)})}),eG.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},eG.prototype.fail=function(g){this.failed=g,this.execute()},eG.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},eG.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},c8(d8,c1),d8.debug=au,d8.adapters={},d8.preferredAdapters=[],d8.prefix="_pouch_";var ea=new cS.EventEmitter;av(d8),d8.parseAdapter=function(m,j){var g,l,n=m.match(/([a-z\-]*):\/\/(.*)/);if(n){if(m=/http(s?)/.test(n[1])?n[1]+"://"+n[2]:n[2],g=n[1],!d8.adapters[g].valid()){throw"Invalid adapter"}return{name:m,adapter:n[1]}}var i="idb" in d8.adapters&&"websql" in d8.adapters&&eB()&&localStorage["_pouch__websqldb_"+d8.prefix+m];if(j.adapter){l=j.adapter}else{if("undefined"!=typeof j&&j.db){l="leveldb"}else{for(var h=0;h<d8.preferredAdapters.length;++h){if(l=d8.preferredAdapters[h],l in d8.adapters){if(i&&"idb"===l){bJ("log",'PouchDB is downgrading "'+m+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}g=d8.adapters[l];var k=g&&"use_prefix" in g?g.use_prefix:!0;return{name:k?d8.prefix+m:m,adapter:l}},d8.adapter=function(h,g,i){g.valid()&&(d8.adapters[h]=g,i&&d8.preferredAdapters.push(h))},d8.plugin=function(g){return"function"==typeof g?g(d8):Object.keys(g).forEach(function(h){d8.prototype[h]=g[h]}),d8},d8.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=ac.extend({},h,i),void d8.call(this,k,i,j)):new g(k,i,j)}return c8(g,d8),g.preferredAdapters=d8.preferredAdapters.slice(),Object.keys(d8).forEach(function(i){i in g||(g[i]=d8[i])}),g};var fI="5.4.4";d8.version=fI;var ck,f1=cU(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cG=cU(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),d6=function(g){return atob(g)},cD=function(g){return btoa(g)},jR=eA.setImmediate||eA.setTimeout,bG=32768,cA=5,e7="document-store",dG="by-sequence",bL="attach-store",cK="attach-seq-store",dW="meta-store",jK="local-store",aJ="detect-blob-support",a9={running:!1,queue:[]},cQ=new cJ.Map,cv=new f3,bT=new cJ.Map;jV.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var fA=7,bg=cX("document-store"),ab=cX("by-sequence"),fF=cX("attach-store"),dQ=cX("local-store"),aW=cX("metadata-store"),bX=cX("attach-seq-store"),ej=new cJ.Map,el=new f3,az=1,jT="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+ab+" (seq, deleted)",cN="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+ab+" (doc_id, rev)",cW="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+bg+" (winningseq)",aN="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+bX+" (seq)",f4="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+bX+" (digest, seq)",aH=ab+".seq = "+bg+".winningseq",ke=ab+".seq AS seq, "+ab+".deleted AS deleted, "+ab+".json AS data, "+ab+".rev AS rev, "+bg+".json AS metadata";bC.valid=cV,bC.use_prefix=!0;var d7=bi(),cT=function(){},cB=25,b3=50,c7={},dx=1800,bj=au("pouchdb:http");bV.valid=function(){return !0},fN.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},fN.prototype.finish=function(){return this.promise};var j5=function(h,g){return g&&h.then(function(i){fM.nextTick(function(){g(null,i)})},function(i){fM.nextTick(function(){g(i)})}),h},ag=function(g){return bz(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&j5(i,j),i})},jS=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},b7=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},f2=function(i){for(var l={},k=0,h=i.length;h>k;k++){l["$"+i[k]]=!0}var j=Object.keys(l),g=new Array(j.length);for(k=0,h=j.length;h>k;k++){g[k]=j[k].substring(1)}return g},ax={},cg=new fN,bD=50,bN=bJ.bind(null,"log"),ak={_sum:function(h,g){return eq(g)},_count:function(h,g){return g.length},_stats:function(h,g){function i(k){for(var n=0,m=0,j=k.length;j>m;m++){var l=k[m];n+=l*l}return n}return{sum:eq(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},dB=ag(function(){var g=this;return"http"===g.type()?c0(g):"function"==typeof g._viewCleanup?jI(g):j2(g)}),dp=function(h,k,j){"function"==typeof k&&(j=k,k={}),k=k?kl(k):{},"function"==typeof h&&(h={map:h});var g=this,i=b2.resolve().then(function(){return fO(g,h,k)});return j5(i,j),i};c8(jU,Error),c8(jO,Error),c8(dq,Error);var aF={query:dp,viewCleanup:dB},b0=1,dK="pouchdb",bp=5,bZ=0;cl.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},cl.prototype.updateTarget=function(h,g){return bb(this.target,this.id,h,g,this.returnValue)},cl.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?b2.resolve(!0):bb(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(bO(j)){return i.readOnlySource=!0,!0}throw j})};var bx={undefined:function(h,g){return 0===cz.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return cC(g,h).last_seq}};cl.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?b2.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return bZ}var j;return j=h.version?h.version.toString():"undefined",j in bx?bx[j](h,i):bZ},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:bZ}).then(function(){return bZ},function(j){return bO(j)?(g.readOnlySource=!0,h.last_seq):bZ})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return bZ})};var d9=0;c8(dO,cS.EventEmitter),dO.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},dO.prototype.ready=function(h,k){function j(){i.cancel()}function g(){h.removeListener("destroyed",j),k.removeListener("destroyed",j)}var i=this;i._readyCalled||(i._readyCalled=!0,h.once("destroyed",j),k.once("destroyed",j),i.once("complete",g))},c8(d0,cS.EventEmitter),d0.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},d8.plugin(aq).plugin(kk).plugin(dR).plugin(aF).plugin(e9),c.exports=d8}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var o="color: "+this.color;n=[n[0],o,"color: inherit"].concat(Array.prototype.slice.call(n,1));var p=0,i=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),n.splice(i,0,o),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(g,l,v){function p(){return v.colors[d++%v.colors.length]}function q(n){function f(){}function i(){var o=i,s=+new Date,r=s-(h||s);o.diff=r,o.prev=h,o.curr=s,h=s,null==o.useColors&&(o.useColors=v.useColors()),null==o.color&&o.useColors&&(o.color=p());var u=Array.prototype.slice.call(arguments);u[0]=v.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=v.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof v.formatArgs&&(u=v.formatArgs.apply(o,u));var x=i.log||v.log||console.log.bind(console);x.apply(o,u)}f.enabled=!1,i.enabled=!0;var e=v.enabled(n)?i:f;return e.namespace=n,e}function c(i){v.save(i);for(var n=(i||"").split(/[\s,]+/),f=n.length,e=0;f>e;e++){n[e]&&(i=n[e].replace(/\*/g,".*?"),"-"===i[0]?v.skips.push(new RegExp("^"+i.substr(1)+"$")):v.names.push(new RegExp("^"+i+"$")))}}function j(){v.enable("")}function m(i){var e,f;for(e=0,f=v.skips.length;f>e;e++){if(v.skips[e].test(i)){return !1}}for(e=0,f=v.names.length;f>e;e++){if(v.names[e].test(i)){return !0}}return !1}function k(e){return e instanceof Error?e.stack||e.message:e}v=l.exports=q,v.coerce=k,v.disable=j,v.enable=c,v.enabled=m,v.humanize=g(11),v.names=[],v.skips=[],v.formatters={};var h,d=0},{11:11}],7:[function(d,c,f){(function(k){function e(){j=!0;for(var l,i,n=g.length;n;){for(i=g,g=[],l=-1;++l<n;){i[l]()}n=g.length}j=!1}function t(i){1!==g.push(i)||j||v()}var v,h=k.MutationObserver||k.WebKitMutationObserver;if(h){var m=0,q=new h(e),p=k.document.createTextNode("");q.observe(p,{characterData:!0}),v=function(){p.data=m=++m%2}}else{if(k.setImmediate||"undefined"==typeof k.MessageChannel){v="document" in k&&"onreadystatechange" in k.document.createElement("script")?function(){var i=k.document.createElement("script");i.onreadystatechange=function(){e(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},k.document.documentElement.appendChild(i)}:function(){setTimeout(e,0)}}else{var w=new k.MessageChannel;w.port1.onmessage=e,v=function(){w.port2.postMessage(0)}}}var j,g=[];c.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(G,k,A){function w(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=I,this.queue=[],this.outcome=void 0,e!==w&&g(this,e)}function C(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function J(f,e,h){q(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function F(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(l,h){function f(o){e||(e=!0,d.reject(l,o))}function i(o){e||(e=!0,d.resolve(l,o))}function m(){h(i,f)}var e=!1,n=x(m);"error"===n.status&&f(n.value)}function x(h,e){var i={};try{i.value=h(e),i.status="success"}catch(f){i.status="error",i.value=f}return i}function E(e){return e instanceof this?e:d.resolve(new this(w),e)}function B(f){var e=new this(w);return d.reject(e,f)}function H(o){function l(r,s){function t(u){h[s]=u,++p!==m||n||(n=!0,d.resolve(e,h))}f.resolve(r).then(t,function(u){n||(n=!0,d.reject(e,u))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(o)){return this.reject(new TypeError("must be an array"))}var m=o.length,n=!1;if(!m){return this.resolve([])}for(var h=new Array(m),p=0,i=-1,e=new this(w);++i<m;){l(o[i],i)}return e}function D(l){function h(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(i,p))},function(p){e||(e=!0,d.reject(i,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var m=l.length,e=!1;if(!m){return this.resolve([])}for(var n=-1,i=new this(w);++n<m;){h(l[n])}return i}var q=G(7),d={},c=["REJECTED"],z=["FULFILLED"],I=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(f,e){if("function"!=typeof f&&this.state===z||"function"!=typeof e&&this.state===c){return this}var i=new this.constructor(w);if(this.state!==I){var h=this.state===z?f:e;J(i,h,this.outcome)}else{this.queue.push(new C(i,f,e))}return i},C.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},C.prototype.otherCallFulfilled=function(e){J(this.promise,this.onFulfilled,e)},C.prototype.callRejected=function(e){d.reject(this.promise,e)},C.prototype.otherCallRejected=function(e){J(this.promise,this.onRejected,e)},d.resolve=function(i,f){var m=x(F,f);if("error"===m.status){return d.reject(i,m.value)}var h=m.value;if(h){g(i,h)}else{i.state=z,i.outcome=f;for(var l=-1,e=i.queue.length;++l<e;){i.queue[l].callFulfilled(f)}}return i},d.reject=function(h,e){h.state=c,h.outcome=e;for(var i=-1,f=h.queue.length;++i<f;){h.queue[i].callRejected(e)}return h},j.resolve=E,j.reject=B,j.all=H,j.race=D},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(j,d,m){function y(n){if(null!==n){switch(typeof n){case"boolean":return n?1:0;case"number":return k(n);case"string":return n.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var o=Array.isArray(n),l=o?n:Object.keys(n),f=-1,e=l.length,i="";if(o){for(;++f<e;){i+=m.toIndexableString(l[f])}}else{for(;++f<e;){var h=l[f];i+=m.toIndexableString(h)+m.toIndexableString(n[h])}}return i}}return""}function c(h,o){var e,r=o,s="1"===h[o];if(s){e=0,o++}else{var f="0"===h[o];o++;var l="",p=h.substring(o,o+q),n=parseInt(p,10)+B;for(f&&(n=-n),o+=q;;){var i=h[o];if("\x00"===i){break}l+=i,o++}l=l.split("."),e=1===l.length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),f&&(e-=10),0!==n&&(e=parseFloat(e+"e"+n))}return{num:e,length:o-r}}function v(l,f){var o=l.pop();if(f.length){var i=f[f.length-1];o===i.element&&(f.pop(),i=f[f.length-1]);var e=i.element,n=i.index;if(Array.isArray(e)){e.push(o)}else{if(n===l.length-2){var h=l.pop();e[h]=o}else{l.push(o)}}}}function C(l,h){for(var i=Math.min(l.length,h.length),e=0;i>e;e++){var f=m.collate(l[e],h[e]);if(0!==f){return f}}return l.length===h.length?0:l.length>h.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(n,o){for(var l=Object.keys(n),f=Object.keys(o),e=Math.min(l.length,f.length),i=0;e>i;i++){var h=m.collate(l[i],f[i]);if(0!==h){return h}if(h=m.collate(n[l[i]],o[f[i]]),0!==h){return h}}return l.length===f.length?0:l.length>f.length?1:-1}function g(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function k(f){if(0===f){return"1"}var l=f.toExponential().split(/e\+?/),r=parseInt(l[1],10),o=0>f,p=o?"0":"2",e=(o?-r:r)-B,h=z.padLeft(e.toString(),"0",q);p+=w+h;var n=Math.abs(parseFloat(l[0]));o&&(n=10-n);var i=n.toFixed(20);return i=i.replace(/\.?0+$/,""),p+=w+i}var B=-324,q=3,w="",z=j(13);m.collate=function(h,e){if(h===e){return 0}h=m.normalizeKey(h),e=m.normalizeKey(e);var f=g(h),i=g(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},m.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=m.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=m.normalizeKey(e))}}}}}return l},m.toIndexableString=function(f){var e="\x00";return f=m.normalizeKey(f),g(f)+w+y(f)+e},m.parseIndexableString=function(h){for(var o=[],s=[],r=0;;){var l=h[r++];if("\x00"!==l){switch(l){case"1":o.push(null);break;case"2":o.push("1"===h[r]),r++;break;case"3":var p=c(h,r);o.push(p.num),r+=p.length;break;case"4":for(var n="";;){var i=h[r];if("\x00"===i){break}n+=i,r++}n=n.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),o.push(n);break;case"5":var f={element:[],index:o.length};o.push(f.element),s.push(f);break;case"6":var e={element:{},index:o.length};o.push(e.element),s.push(e);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+l)}}else{if(1===o.length){return o.pop()}v(o,s)}}}},{13:13}],13:[function(f,c,g){function d(i,e,k){for(var h="",j=k-i.length;h.length<j;){h+=e}return h}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var m,l=j.length,h=p.length;for(m=0;l>m;m++){if(m===h){return 1}var e=j.charAt(m),k=p.charAt(m);if(e!==k){return k>e?-1:1}}return h>l?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(c,g,f){function h(){this.store={}}function d(i){if(this.store=new h,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}f.Map=h,f.Set=d,h.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},h.prototype.unmangle=function(e){return e.substring(1)},h.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},h.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},h.prototype.has=function(i){var e=this.mangle(i);return e in this.store},h.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},h.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},d.prototype.add=function(e){return this.store.set(e,!0)},d.prototype.has=function(e){return this.store.has(e)},d.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(j,i){var m,l,k,h;l=[],h=[];for(m in i){e.call(i,m)&&(k=i[m],"this"!==m&&(l.push(m),h.push(k)))}return Function.apply(null,g.call(l).concat([j])).apply(i["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(I){function G(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function B(m,i,l,n,h,o,g){return G(i&l|~i&n,m,i,h,o,g)}function J(m,i,l,n,h,o,g){return G(i&n|l&~n,m,i,h,o,g)}function q(m,i,l,n,h,o,g){return G(i^l^n,m,i,h,o,g)}function E(m,i,l,n,h,o,g){return G(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=B(n,i,g,m,h[0],7,-680876936),m=B(m,n,i,g,h[1],12,-389564586),g=B(g,m,n,i,h[2],17,606105819),i=B(i,g,m,n,h[3],22,-1044525330),n=B(n,i,g,m,h[4],7,-176418897),m=B(m,n,i,g,h[5],12,1200080426),g=B(g,m,n,i,h[6],17,-1473231341),i=B(i,g,m,n,h[7],22,-45705983),n=B(n,i,g,m,h[8],7,1770035416),m=B(m,n,i,g,h[9],12,-1958414417),g=B(g,m,n,i,h[10],17,-42063),i=B(i,g,m,n,h[11],22,-1990404162),n=B(n,i,g,m,h[12],7,1804603682),m=B(m,n,i,g,h[13],12,-40341101),g=B(g,m,n,i,h[14],17,-1502002290),i=B(i,g,m,n,h[15],22,1236535329),n=J(n,i,g,m,h[1],5,-165796510),m=J(m,n,i,g,h[6],9,-1069501632),g=J(g,m,n,i,h[11],14,643717713),i=J(i,g,m,n,h[0],20,-373897302),n=J(n,i,g,m,h[5],5,-701558691),m=J(m,n,i,g,h[10],9,38016083),g=J(g,m,n,i,h[15],14,-660478335),i=J(i,g,m,n,h[4],20,-405537848),n=J(n,i,g,m,h[9],5,568446438),m=J(m,n,i,g,h[14],9,-1019803690),g=J(g,m,n,i,h[3],14,-187363961),i=J(i,g,m,n,h[8],20,1163531501),n=J(n,i,g,m,h[13],5,-1444681467),m=J(m,n,i,g,h[2],9,-51403784),g=J(g,m,n,i,h[7],14,1735328473),i=J(i,g,m,n,h[12],20,-1926607734),n=q(n,i,g,m,h[5],4,-378558),m=q(m,n,i,g,h[8],11,-2022574463),g=q(g,m,n,i,h[11],16,1839030562),i=q(i,g,m,n,h[14],23,-35309556),n=q(n,i,g,m,h[1],4,-1530992060),m=q(m,n,i,g,h[4],11,1272893353),g=q(g,m,n,i,h[7],16,-155497632),i=q(i,g,m,n,h[10],23,-1094730640),n=q(n,i,g,m,h[13],4,681279174),m=q(m,n,i,g,h[0],11,-358537222),g=q(g,m,n,i,h[3],16,-722521979),i=q(i,g,m,n,h[6],23,76029189),n=q(n,i,g,m,h[9],4,-640364487),m=q(m,n,i,g,h[12],11,-421815835),g=q(g,m,n,i,h[15],16,530742520),i=q(i,g,m,n,h[2],23,-995338651),n=E(n,i,g,m,h[0],6,-198630844),m=E(m,n,i,g,h[7],10,1126891415),g=E(g,m,n,i,h[14],15,-1416354905),i=E(i,g,m,n,h[5],21,-57434055),n=E(n,i,g,m,h[12],6,1700485571),m=E(m,n,i,g,h[3],10,-1894986606),g=E(g,m,n,i,h[10],15,-1051523),i=E(i,g,m,n,h[1],21,-2054922799),n=E(n,i,g,m,h[8],6,1873313359),m=E(m,n,i,g,h[15],10,-30611744),g=E(g,m,n,i,h[6],15,-1560198380),i=E(i,g,m,n,h[13],21,1309151649),n=E(n,i,g,m,h[4],6,-145523070),m=E(m,n,i,g,h[11],10,-1120210379),g=E(g,m,n,i,h[2],15,718787259),i=E(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function H(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function A(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function w(g){var m,o,l,n,p,i,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;h>=m;m+=64){M(r,H(g.substring(m-64,m)))}for(g=g.substring(m-64),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;o>m;m+=1){l[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(l[m>>2]|=128<<(m%4<<3),m>55){for(M(r,l),m=0;16>m;m+=1){l[m]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),i=parseInt(n[1],16)||0,l[14]=p,l[15]=i,M(r,l),r}function x(g){var i,o,l,n,p,m,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;h>=i;i+=64){M(r,A(g.subarray(i-64,i)))}for(g=h>i-64?g.subarray(i-64):new Uint8Array(0),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;o>i;i+=1){l[i>>2]|=g[i]<<(i%4<<3)}if(l[i>>2]|=128<<(i%4<<3),i>55){for(M(r,l),i=0;16>i;i+=1){l[i]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=p,l[15]=m,M(r,l),r}function D(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function z(h){var g;for(g=0;g<h.length;g+=1){h[g]=D(h[g])}return h.join("")}function F(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function C(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==z(w("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(l,i){var m,h,r,s,o=this.byteLength,n=g(l,o),p=o;return i!==I&&(p=g(i,o)),n>p?new ArrayBuffer(0):(m=p-n,h=new ArrayBuffer(m),r=new Uint8Array(h),s=new Uint8Array(this,n,m),r.set(s),h)}}(),C.prototype.append=function(g){return this.appendBinary(F(g)),this},C.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,H(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},C.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},C.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},C.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},C.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},C.hash=function(h,g){return C.hashBinary(F(h),g)},C.hashBinary=function(i,g){var l=w(i),h=z(l);return g?N(h):h},C.ArrayBuffer=function(){this.reset()},C.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,A(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},C.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.ArrayBuffer.prototype.getState=function(){var g=C.prototype.getState.call(this);return g.buff=j(g.buff),g},C.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),C.prototype.setState.call(this,g)},C.ArrayBuffer.prototype.destroy=C.prototype.destroy,C.ArrayBuffer.prototype._finish=C.prototype._finish,C.ArrayBuffer.hash=function(i,g){var l=x(new Uint8Array(i)),h=z(l);return g?N(h):h},C})},{}],17:[function(f,c,g){function d(j,p,m){var l=m[m.length-1];j===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,e=l.index;if(Array.isArray(h)){h.push(j)}else{if(e===p.length-2){var k=p.pop();h[k]=j}else{p.push(j)}}}g.stringify=function(q){var v=[];v.push({obj:q});for(var A,w,p,m,h,B,z,y,x,k,e,j="";A=v.pop();){if(w=A.obj,p=A.prefix||"",m=A.val||"",j+=p,m){j+=m}else{if("object"!=typeof w){j+="undefined"==typeof w?null:JSON.stringify(w)}else{if(null===w){j+="null"}else{if(Array.isArray(w)){for(v.push({val:"]"}),h=w.length-1;h>=0;h--){B=0===h?"":",",v.push({obj:w[h],prefix:B})}v.push({val:"["})}else{z=[];for(y in w){w.hasOwnProperty(y)&&z.push(y)}for(v.push({val:"}"}),h=z.length-1;h>=0;h--){x=z[h],k=w[x],e=h>0?",":"",e+=JSON.stringify(x)+":",v.push({obj:k,prefix:e})}v.push({val:"{"})}}}}}return j},g.parse=function(r){for(var j,v,q,e,y,k,m,z,h,p=[],x=[],w=0;;){if(j=r[w++],"}"!==j&&"]"!==j&&"undefined"!=typeof j){switch(j){case" ":case"	":case"\n":case":":case",":break;case"n":w+=3,d(null,p,x);break;case"t":w+=3,d(!0,p,x);break;case"f":w+=4,d(!1,p,x);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(v="",w--;;){if(q=r[w++],!/[\d\.\-e\+]/.test(q)){w--;break}v+=q}d(parseFloat(v),p,x);break;case'"':for(e="",y=void 0,k=0;;){if(m=r[w++],'"'===m&&("\\"!==y||k%2!==1)){break}e+=m,y=m,"\\"===y?k++:k=0}d(JSON.parse('"'+e+'"'),p,x);break;case"[":z={element:[],index:p.length},p.push(z.element),x.push(z);break;case"{":h={element:{},index:p.length},p.push(h.element),x.push(h);break;default:throw new Error("unexpectedly reached end of input: "+j)}}else{if(1===p.length){return p.pop()}d(p.pop(),p,x)}}}},{}]},{},[3])(3)});