!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(h,f){if(!b[h]){if(!i[h]){var g="function"==typeof require&&require;if(!f&&g){return g(h,!0)}if(a){return a(h,!0)}var j=new Error("Cannot find module '"+h+"'");throw j.code="MODULE_NOT_FOUND",j}var n=b[h]={exports:{}};i[h][0].call(n.exports,function(m){var p=i[h][1][m];return k(p?p:m)},n,n.exports,d,i,b,l)}return b[h].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,h,r,f,l,j;if(this._events||(this._events={}),"error"===g&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(h=this._events[g],i(h)){return !1}if(o(h)){switch(arguments.length){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),h.apply(this,f)}}else{if(m(h)){for(f=Array.prototype.slice.call(arguments,1),j=h.slice(),r=j.length,l=0;r>l;l++){j[l].apply(this,f)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(f,h){function j(){this.removeListener(f,j),g||(g=!0,h.apply(this,arguments))}if(!o(h)){throw TypeError("listener must be a function")}var g=!1;return j.listener=h,this.on(f,j),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(m(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(r,o,f){function s(){i&&B&&(i=!1,B.length?e=B.concat(e):n=-1,e.length&&b())}function b(){if(!i){var g=a(s);i=!0;for(var j=e.length;j;){for(B=e,e=[];++n<j;){B&&B[n].run()}n=-1,j=e.length}B=null,i=!1,t(g)}}function u(g,j){this.fun=g,this.array=j}function l(){}var a,t,h=o.exports={};!function(){try{a=setTimeout}catch(g){a=function(){throw new Error("setTimeout is not defined")}}try{t=clearTimeout}catch(g){t=function(){throw new Error("clearTimeout is not defined")}}}();var B,e=[],i=!1,n=-1;h.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}e.push(new u(j,k)),1!==e.length||i||a(b,0)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.binding=function(g){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(g){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],3:[function(a,b,e){(function(w,gE){function ga(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fc(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fZ(ab){if("function"==typeof ab.slice){return ab.slice(0)}var t=new ArrayBuffer(ab.byteLength),aa=new Uint8Array(t),ac=new Uint8Array(ab);return aa.set(ac),t}function g5(ab){if(ab instanceof ArrayBuffer){return fZ(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function ge(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&et.call(aa)==hK}function ii(ad){var aa,ab,t;if(!ad||"object"!=typeof ad){return ad}if(Array.isArray(ad)){for(aa=[],ab=0,t=ad.length;t>ab;ab++){aa[ab]=ii(ad[ab])}return aa}if(ad instanceof Date){return ad.toISOString()}if(fc(ad)){return g5(ad)}if(!ge(ad)){return ad}aa={};for(ab in ad){if(Object.prototype.hasOwnProperty.call(ad,ab)){var ac=ii(ad[ab]);"undefined"!=typeof ac&&(aa[ab]=ac)}}return aa}function gO(aa){var t=!1;return hw(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function ee(t){return hw(function(ac){ac=ii(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){w.nextTick(function(){ad(ag,ah)})});var af=new hi(function(aj,ak){var ag;try{var ah=gO(function(ap,am){ap?ak(ap):aj(am)});ac.push(ah),ag=t.apply(aa,ac),ag&&"function"==typeof ag.then&&aj(ag)}catch(al){ak(al)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function jw(ab,t){function aa(ad,ag,aj){if(gB.enabled){for(var af=[ad._db_name,ag],ac=0;ac<aj.length-1;ac++){af.push(aj[ac])}gB.apply(null,af);var ah=aj[aj.length-1];aj[aj.length-1]=function(ak,am){var al=[ad._db_name,ag];al=al.concat(ak?["error",ak]:["success",am]),gB.apply(null,al),ah(ak,am)}}}return ee(hw(function(ad){if(this._closed){return hi.reject(new Error("database is closed"))}if(this._destroyed){return hi.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new hi(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function gf(ad,aa){for(var ab={},t=0,ac=aa.length;ac>t;t++){var af=aa[t];af in ad&&(ab[af]=ad[af])}return ab}function fy(t){return t}function fv(t){return[{ok:t}]}function fh(ap,am,ac){function ak(){var av=[];t.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),ac(null,{results:av})}function af(){++aj===ad&&ak()}function aa(aw,ax,av){t[aw]={id:ax,docs:av},af()}function ah(){if(!(ag>=ab.length)){var av=Math.min(ag+je,ab.length),aw=ab.slice(ag,av);al(aw,ag),ag+=aw.length}}function al(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=au[aC],aB=gf(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(fy);var ax=fy;0===aB.open_revs.length&&(delete aB.open_revs,ax=fv),["revs","attachments","binary","ajax"].forEach(function(aD){aD in am&&(aB[aD]=am[aD])}),ap.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),aa(ay,aC,aE),ah()})})}var aq=am.docs,au={};aq.forEach(function(av){av.id in au?au[av.id].push(av):au[av.id]=[av]});var ad=Object.keys(au).length,aj=0,t=new Array(ad),ab=Object.keys(au),ag=0;ah()}function fq(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fd(){return be}function er(t){fq()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function co(){gp.EventEmitter.call(this),this._listeners={},er(this)}function iS(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function fU(ad,aa){var ab=600000;ad=parseInt(ad,10)||0,aa=parseInt(aa,10),aa!==aa||ad>=aa?aa=(ad||1)<<1:aa+=1,aa>ab&&(ad=ab>>1,aa=ab);var t=Math.random(),ac=aa-ad;return ~~(ac*t+ad)}function h2(aa){var t=0;return aa||(t=2000),fU(aa,t)}function g9(aa,t){iS("info","The above "+aa+" is totally normal. "+t)}function dt(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gh(ab,t,aa){function ac(af){for(var ad in ab){"function"!=typeof ab[ad]&&(this[ad]=ab[ad])}void 0!==aa&&(this.name=aa),void 0!==af&&(this.reason=af)}return ac.prototype=dt.prototype,new ac(t)}function hE(ad){var aa,ab,t,ac,af;return ab=ad.error===!0&&"string"==typeof ad.name?ad.name:ad.error,af=ad.reason,t=h3("name",ab,af),ad.missing||"missing"===af||"deleted"===af||"not_found"===ab?t=ew:"doc_validation"===ab?(t=fz,ac=af):"bad_request"===ab&&t.message!==af&&(t=h7),t||(t=h3("status",ad.status,af)||hM),aa=gh(t,af,ab),ac&&(aa.message=ac),ad.id&&(aa.id=ad.id),ad.status&&(aa.status=ad.status),ad.missing&&(aa.missing=ad.missing),aa}function iC(ad,aa,ab){try{return !ad(aa,ab)}catch(t){var ac="Filter function threw: "+t.toString();return gh(h7,ac)}}function jd(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&iC(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function y(ab){for(var t=[],aa=0,ac=ab.length;ac>aa;aa++){t=t.concat(ab[aa])}return t}function iu(aa){var t;if(aa?"string"!=typeof aa?t=gh(hg):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=gh(ez)):t=gh(hl),t){throw t}}function a9(aa,t){return"listenerCount" in aa?aa.listenerCount(t):gp.EventEmitter.listenerCount(aa,t)}function iy(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function iO(aa){var t=iy(aa);return t?t.join("/"):null}function fx(ac){for(var t=ei.exec(ac),ag={},ad=14;ad--;){var ab=fX[ad],aa=t[ad]||"",af=-1!==["user","password"].indexOf(ab);ag[ab]=af?decodeURIComponent(aa):aa}return ag[ht]={},ag[fX[12]].replace(at,function(ak,aj,ah){aj&&(ag[ht][aj]=ah)}),ag}function eu(ab,t,aa){return new hi(function(ad,ac){ab.get(t,function(af,ah){if(af){if(404!==af.status){return ac(af)}ah={}}var aj=ah._rev,ag=aa(ah);return ag?(ag._id=t,ag._rev=aj,void ad(hR(ab,ag,aa))):ad({updated:!1,rev:aj})})})}function hR(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return eu(ab,t._id,aa)})}function gX(t){return 0|Math.random()*t}function ex(ab,t){t=t||iV.length;var aa="",ac=-1;if(ab){for(;++ac<ab;){aa+=iV[gX(t)]}return aa}for(;++ac<36;){switch(ac){case 8:case 13:case 18:case 23:aa+="-";break;case 19:aa+=iV[3&gX(16)|8];break;default:aa+=iV[gX(16)]}}return aa}function fu(t){for(var al,ah,ak,aj,af=t.rev_tree.slice();aj=af.pop();){var ap=aj.ids,ad=ap[2],am=aj.pos;if(ad.length){for(var aa=0,ac=ad.length;ac>aa;aa++){af.push({pos:am+1,ids:ad[aa]})}}else{var ag=!!ap[1].deleted,ab=ap[0];al&&!(ak!==ag?ak:ah!==am?am>ah:ab>al)||(al=ab,ah=am,ak=ag)}}return ah+"-"+al}function fi(ad,aa){for(var ag,aj=ad.slice();ag=aj.pop();){for(var ah=ag.pos,af=ag.ids,ac=af[2],ak=aa(0===ac.length,ah,af[0],ag.ctx,af[1]),ab=0,t=ac.length;t>ab;ab++){aj.push({pos:ah+1,ids:ac[ab],ctx:ak})}}}function ct(aa,t){return aa.pos-t.pos}function fS(ab){var t=[];fi(ab,function(ag,ad,ah,af,aj){ag&&t.push({rev:ad+"-"+ah,pos:ad,opts:aj})}),t.sort(ct).reverse();for(var aa=0,ac=t.length;ac>aa;aa++){delete t[aa].pos}return t}function h1(ac){for(var t=fu(ac),ag=fS(ac.rev_tree),ad=[],ab=0,aa=ag.length;aa>ab;ab++){var af=ag[ab];af.rev===t||af.opts.deleted||ad.push(af.rev)}return ad}function iD(aa){var t=[];return fi(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function gC(t){for(var al,ah=[],ak=t.slice();al=ak.pop();){var aj=al.pos,af=al.ids,ap=af[0],ad=af[1],am=af[2],aa=0===am.length,ac=al.history?al.history.slice():[];ac.push({id:ap,opts:ad}),aa&&ah.push({pos:aj+1-ac.length,ids:ac});for(var ag=0,ab=am.length;ab>ag;ag++){ak.push({pos:aj+1,ids:am[ag],history:ac})}}return ah.reverse()}function r(aa,t){return aa.pos-t.pos}function iP(ad,aa,ab){for(var t,ac=0,af=ad.length;af>ac;){t=ac+af>>>1,ab(ad[t],aa)<0?ac=t+1:af=t}return ac}function fT(ab,t,aa){var ac=iP(ab,t,aa);ab.splice(ac,0,t)}function V(ab,t){for(var ah,ac,aa=t,af=ab.length;af>aa;aa++){var ag=ab[aa],ad=[ag.id,ag.opts,[]];ac?(ac[2].push(ad),ac=ad):ah=ac=ad}return ah}function g0(aa,t){return aa[0]<t[0]?-1:1}function l(ad,aa){for(var ag=[{tree1:ad,tree2:aa}],aj=!1;ag.length>0;){var ah=ag.pop(),af=ah.tree1,ac=ah.tree2;(af[1].status||ac[1].status)&&(af[1].status="available"===af[1].status||"available"===ac[1].status?"available":"missing");for(var ak=0;ak<ac[2].length;ak++){if(af[2][0]){for(var ab=!1,t=0;t<af[2].length;t++){af[2][t][0]===ac[2][ak][0]&&(ag.push({tree1:af[2][t],tree2:ac[2][ak]}),ab=!0)}ab||(aj="new_branch",fT(af[2],ac[2][ak],g0))}else{aj="new_leaf",af[2][0]=ac[2][ak]}}}return{conflicts:aj,tree:ad}}function a3(ag,ac,aj){var am,av=[],ab=!1,af=!1;if(!ag.length){return{tree:[ac],conflicts:"new_leaf"}}for(var aa=0,aw=ag.length;aw>aa;aa++){var al=ag[aa];if(al.pos===ac.pos&&al.ids[0]===ac.ids[0]){am=l(al.ids,ac.ids),av.push({pos:al.pos,ids:am.tree}),ab=ab||am.conflicts,af=!0}else{if(aj!==!0){var ap=al.pos<ac.pos?al:ac,ad=al.pos<ac.pos?ac:al,aq=ad.pos-ap.pos,t=[],ax=[];for(ax.push({ids:ap.ids,diff:aq,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ah=0,ak=az.length;ak>ah;ah++){ax.push({ids:az[ah],diff:ay.diff-1,parent:ay.ids,parentIdx:ah})}}else{ay.ids[0]===ad.ids[0]&&t.push(ay)}}var au=t[0];au?(am=l(au.ids,ad.ids),au.parent[2][au.parentIdx]=am.tree,av.push({pos:ap.pos,ids:ap.ids}),ab=ab||am.conflicts,af=!0):av.push(al)}else{av.push(al)}}}return af||av.push(ac),av.sort(r),{tree:av,conflicts:ab||"internal_node"}}function E(t,al){for(var ah,ak=gC(t),aj={},af=0,ap=ak.length;ap>af;af++){for(var ad=ak[af],am=ad.ids,aa=Math.max(0,am.length-al),ac={pos:ad.pos+aa,ids:V(am,aa)},ag=0;aa>ag;ag++){var ab=ad.pos+ag+"-"+am[ag].id;aj[ab]=!0}ah=ah?a3(ah,ac,!0).tree:[ac]}return fi(ah,function(au,av,aq){delete aj[av+"-"+aq]}),{tree:ah,revs:Object.keys(aj)}}function g6(ad,aa,ab){var t=a3(ad,aa),ac=E(t.tree,ab);return{tree:ac.tree,stemmedRevs:ac.revs,conflicts:t.conflicts}}function iv(ad,aa){for(var ag,aj=ad.slice(),ah=aa.split("-"),af=parseInt(ah[0],10),ac=ah[1];ag=aj.pop();){if(ag.pos===af&&ag.ids[0]===ac){return !0}for(var ak=ag.ids[2],ab=0,t=ak.length;t>ab;ab++){aj.push({pos:ag.pos+1,ids:ak[ab]})}}return !1}function cn(t){return t.ids}function hF(ad,aa){aa||(aa=fu(ad));for(var ab,t=aa.substring(aa.indexOf("-")+1),ac=ad.rev_tree.map(cn);ab=ac.pop();){if(ab[0]===t){return !!ab[1].deleted}ac=ac.concat(ab[2])}}function hB(t){return/^_local/.test(t)}function gk(t){return io("return "+t+";",{})}function iT(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jg(ab,t){try{ab.emit("change",t)}catch(aa){iS("error",'Error in .on("change", function):',aa)}}function di(ac,t,ag){function ad(){ab.cancel()}gp.EventEmitter.call(this);var ab=this;this.db=ac,t=t?ii(t):{};var aa=t.complete=gO(function(aj,ah){aj?a9(ab,"error")>0&&ab.emit("error",aj):ab.emit("complete",ah),ab.removeAllListeners(),ac.removeListener("destroyed",ad)});ag&&(ab.on("complete",function(ah){ag(null,ah)}),ab.on("error",ag)),ac.once("destroyed",ad),t.onChange=function(ah){t.isCancelled||(jg(ab,ah),ab.startSeq&&ab.startSeq<=ah.seq&&(ab.startSeq=!1))};var af=new hi(function(aj,ah){t.complete=function(al,ak){al?ah(al):aj(ak)}});ab.once("cancel",function(){ac.removeListener("destroyed",ad),t.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){aa(null,ah)},aa),ac.taskqueue.isReady?ab.doChanges(t):ac.taskqueue.addTask(function(){ab.isCancelled?ab.emit("cancel"):ab.doChanges(t)})}function bo(ad,aa,ab){var t=[{rev:ad._rev}];"all_docs"===ab.style&&(t=fS(aa.rev_tree).map(function(af){return{rev:af.rev}}));var ac={id:aa.id,changes:t,doc:ad};return hF(aa,ad._rev)&&(ac.deleted=!0),ab.conflicts&&(ac.doc._conflicts=h1(aa),ac.doc._conflicts.length||delete ac.doc._conflicts),ac}function gz(aa,t){return t>aa?-1:aa>t?1:0}function im(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function gF(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function hr(ad){for(var aa=0;aa<ad.length;aa++){var ab=ad[aa];if(ab._deleted){delete ab._attachments}else{if(ab._attachments){for(var t=Object.keys(ab._attachments),ac=0;ac<t.length;ac++){var af=t[ac];ab._attachments[af]=gf(ab._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function g(ad,aa){var ab=gz(ad._id,aa._id);if(0!==ab){return ab}var t=ad._revisions?ad._revisions.start:0,ac=aa._revisions?aa._revisions.start:0;return gz(t,ac)}function ip(ab){var t={},aa=[];return fi(ab,function(af,ag,ad,ah){var ac=ag+"-"+ad;return af&&(t[ac]=0),void 0!==ah&&aa.push({from:ah,to:ac}),ac}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function fg(ad,aa,ab){var t="limit" in aa?aa.keys.slice(aa.skip,aa.limit+aa.skip):aa.skip>0?aa.keys.slice(aa.skip):aa.keys;if(aa.descending&&t.reverse(),!t.length){return ad._allDocs({limit:0},ab)}var ac={offset:aa.skip};return hi.all(t.map(function(af){var ag=a5.extend({key:af,deleted:"ok"},aa);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hi(function(aj,ah){ad._allDocs(ag,function(ak,al){return ak?ah(ak):(ac.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ac.rows=af,ac})}function jo(ab){var t=ab._compactionQueue[0],ac=t.opts,aa=t.callback;ab.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ac.last_seq=ad.last_seq),ab._compact(ac,function(ag,af){ag?aa(ag):aa(null,af),w.nextTick(function(){ab._compactionQueue.shift(),ab._compactionQueue.length&&jo(ab)})})})}function ih(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function gl(){gp.EventEmitter.call(this)}function fa(){this.isReady=!1,this.failed=!1,this.queue=[]}function h0(t){t&&gE.debug&&iS("error",t)}function hn(ac,t){function ag(){aa.emit("destroyed",ab)}function ad(){ac.removeListener("destroyed",ag),ac.emit("destroyed",ac)}var ab=t.originalName,aa=ac.constructor,af=aa._destructionListeners;ac.once("destroyed",ag),af.has(ab)||af.set(ab,[]),af.get(ab).push(ad)}function gM(ac,t,ag){if(!(this instanceof gM)){return new gM(ac,t,ag)}var ad=this;if("function"!=typeof t&&"undefined"!=typeof t||(ag=t,t={}),ac&&"object"==typeof ac&&(t=ac,ac=void 0),"undefined"==typeof ag){ag=h0}else{var ab=ag;ag=function(){return iS("warn","Using a callback for new PouchDB()is deprecated."),ab.apply(null,arguments)}}ac=ac||t.name,t=ii(t),delete t.name,this.__opts=t;var aa=ag;ad.auto_compaction=t.auto_compaction,ad.prefix=gM.prefix,gl.call(ad),ad.taskqueue=new fa;var af=new hi(function(aj,al){ag=function(ap,am){return ap?al(ap):(delete am.then,void aj(am))},t=ii(t);var ah,ak;return function(){try{if("string"!=typeof ac){throw ak=new Error("Missing/invalid DB name"),ak.code=400,ak}var ap=(t.prefix||"")+ac;if(ah=gM.parseAdapter(ap,t),t.originalName=ac,t.name=ah.name,t.adapter=t.adapter||ah.adapter,ad._adapter=t.adapter,ju("pouchdb:adapter")("Picked adapter: "+t.adapter),ad._db_name=ac,!gM.adapters[t.adapter]){throw ak=new Error("Adapter is missing"),ak.code=404,ak}if(!gM.adapters[t.adapter].valid()){throw ak=new Error("Invalid Adapter"),ak.code=404,ak}}catch(am){ad.taskqueue.fail(am)}}(),ak?al(ak):(ad.adapter=t.adapter,ad.replicate={},ad.replicate.from=function(aq,am,ap){return ad.constructor.replicate(aq,ad,am,ap)},ad.replicate.to=function(aq,am,ap){return ad.constructor.replicate(ad,aq,am,ap)},ad.sync=function(aq,am,ap){return ad.constructor.sync(ad,aq,am,ap)},ad.replicate.sync=ad.sync,void gM.adapters[t.adapter].call(ad,t,function(am){return am?(ad.taskqueue.fail(am),void ag(am)):(hn(ad,t),ad.emit("created",ad),gM.emit("created",t.originalName),ad.taskqueue.ready(ad),void ag(null,ad))}))});af.then(function(ah){aa(null,ah)},aa),ad.then=af.then.bind(af),ad["catch"]=af["catch"].bind(af)}function jt(aa){Object.keys(gp.EventEmitter.prototype).forEach(function(ab){"function"==typeof gp.EventEmitter.prototype[ab]&&(aa[ab]=gL[ab].bind(gL))});var t=aa._destructionListeners=new i5.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function go(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hH(ab){if(!/^\d+\-./.test(ab)){return gh(dn)}var t=ab.indexOf("-"),aa=ab.substring(0,t),ac=ab.substring(t+1);return{prefix:parseInt(aa,10),id:ac}}function I(ac,t){for(var ag=ac.start-ac.ids.length+1,ad=ac.ids,ab=[ad[0],t,[]],aa=1,af=ad.length;af>aa;aa++){ab=[ad[aa],{status:"missing"},[ab]]}return[{pos:ag,ids:ab}]}function g4(ad,aa){var ag,aj,ah,af={status:"available"};if(ad._deleted&&(af.deleted=!0),aa){if(ad._id||(ad._id=ex()),aj=ex(32,16).toLowerCase(),ad._rev){if(ah=hH(ad._rev),ah.error){return ah}ad._rev_tree=[{pos:ah.prefix,ids:[ah.id,{status:"missing"},[[aj,af,[]]]]}],ag=ah.prefix+1}else{ad._rev_tree=[{pos:1,ids:[aj,af,[]]}],ag=1}}else{if(ad._revisions&&(ad._rev_tree=I(ad._revisions,af),ag=ad._revisions.start,aj=ad._revisions.ids[0]),!ad._rev_tree){if(ah=hH(ad._rev),ah.error){return ah}ag=ah.prefix,aj=ah.id,ad._rev_tree=[{pos:ag,ids:[aj,af,[]]}]}}iu(ad._id),ad._rev=ag+"-"+aj;var ac={metadata:{},data:{}};for(var ak in ad){if(Object.prototype.hasOwnProperty.call(ad,ak)){var ab="_"===ak[0];if(ab&&!q[ak]){var t=gh(fz,ak);throw t.message=fz.message+": "+ak,t}ab&&!gt[ak]?ac.metadata[ak.slice(1)]=ad[ak]:ac.data[ak]=ad[ak]}}return ac}function H(ad){for(var aa="",ab=new Uint8Array(ad),t=ab.byteLength,ac=0;t>ac;ac++){aa+=String.fromCharCode(ab[ac])}return aa}function ja(t){return gu(H(t))}function jB(ad,aa){ad=ad||[],aa=aa||{};try{return new Blob(ad,aa)}catch(ab){if("TypeError"!==ab.name){throw ab}for(var t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ac=new t,af=0;af<ad.length;af+=1){ac.append(ad[af])}return ac.getBlob(aa.type)}}function a7(ad){for(var aa=ad.length,ab=new ArrayBuffer(aa),t=new Uint8Array(ab),ac=0;aa>ac;ac++){t[ac]=ad.charCodeAt(ac)}return ab}function i3(aa,t){return jB([a7(aa)],{type:t})}function fW(aa,t){return i3(fm(aa),t)}function bn(ab,t){if("undefined"==typeof FileReader){return t(H((new FileReaderSync).readAsArrayBuffer(ab)))}var aa=new FileReader,ac="function"==typeof aa.readAsBinaryString;aa.onloadend=function(af){var ad=af.target.result||"";return ac?t(ad):void t(H(ad))},ac?aa.readAsBinaryString(ab):aa.readAsArrayBuffer(ab)}function iJ(aa,t){bn(aa,function(ab){t(gu(ab))})}function ib(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function R(t){return gu(t)}function Y(ab,t,aa,ac){(aa>0||ac<t.byteLength)&&(t=new Uint8Array(t,aa,Math.min(ac,t.byteLength)-aa)),ab.append(t)}function hs(ab,t,aa,ac){(aa>0||ac<t.length)&&(t=t.substring(aa,ac)),ab.appendBinary(t)}function ci(ad,aa){function ag(){var aq=ak*af,al=aq+af;if(ak++,ac>ak){t(ab,ad,aq,al),bt(ag)}else{t(ab,ad,aq,al);var ap=ab.end(!0),am=R(ap);aa(am),ab.destroy()}}var aj="string"==typeof ad,ah=aj?ad.length:ad.byteLength,af=Math.min(iU,ah),ac=Math.ceil(ah/af),ak=0,ab=aj?new gN:new gN.ArrayBuffer,t=aj?hs:Y;ag()}function Z(t){return gN.hash(t)}function gI(ab,t,ah){function ac(al){try{return fm(al)}catch(aj){var ak=gh(gx,"Attachment is not a valid base64 string");return{error:ak}}}function aa(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ac(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===t?aj.data=i3(al,aj.content_type):"base64"===t?aj.data=gu(al):aj.data=al,ci(al,function(am){aj.digest="md5-"+am,ak()})}else{ib(aj.data,function(am){"binary"===t?aj.data=H(am):"base64"===t&&(aj.data=ja(am)),ci(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function af(){ad++,ab.length===ad&&(ag?ah(ag):ah())}if(!ab.length){return ah()}var ag,ad=0;ab.forEach(function(ak){function am(aq){ag=aq,al++,al===aj.length&&af()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return af()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&aa(ak.data._attachments[ap],am)}})}function jD(ac,ad,av,al,aw,am,af,ag){if(iv(ad.rev_tree,av.metadata.rev)){return al[aw]=av,am()}var ax=ad.winningRev||fu(ad),au="deleted" in ad?ad.deleted:hF(ad,ax),aa="deleted" in av.metadata?av.metadata.deleted:hF(av.metadata),aq=/^1-/.test(av.metadata.rev);if(au&&!aa&&ag&&aq){var t=av.data;t._rev=ax,t._id=av.metadata.id,av=g4(t,ag)}var ak=g6(ad.rev_tree,av.metadata.rev_tree[0],ac),ay=ag&&(au&&aa||!au&&"new_leaf"!==ak.conflicts||au&&!aa&&"new_branch"===ak.conflicts);if(ay){var az=gh(jC);return al[aw]=az,am()}var aA=av.metadata.rev;av.metadata.rev_tree=ak.tree,av.stemmedRevs=ak.stemmedRevs||[],ad.rev_map&&(av.metadata.rev_map=ad.rev_map);var aj,ab=fu(av.metadata),ap=hF(av.metadata,ab),ah=au===ap?0:ap>au?-1:1;aj=aA===ab?ap:hF(av.metadata,aA),af(av,ab,ap,aj,!0,ah,aw,am)}function a8(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jA(af,au,am,ac,aa,ak,t,aq,ag){function ad(aw,aA,aC){var ax=fu(aw.metadata),av=hF(aw.metadata,ax);if("was_delete" in aq&&av){return ak[aA]=gh(ew,"deleted"),aC()}var az=ap&&a8(aw);if(az){var ay=gh(jC);return ak[aA]=ay,aC()}var aB=av?0:1;t(aw,ax,av,av,!1,aB,aA,aC)}function ah(){++ab===aj&&ag&&ag()}af=af||1000;var ap=aq.new_edits,al=new i5.Map,ab=0,aj=au.length;au.forEach(function(aw,ay){if(aw._id&&hB(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void am[ax](aw,{ctx:aa},function(aA,az){ak[ay]=aA||az,ah()})}var av=aw.metadata.id;al.has(av)?(aj--,al.get(av).push([aw,ay])):al.set(av,[[aw,ay]])}),al.forEach(function(ay,aw){function ax(){++az<ay.length?av():ah()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(ac.has(aw)){jD(af,ac.get(aw),aA,ak,aB,ax,t,ap)}else{var aD=g6([],aA.metadata.rev_tree[0],af);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ad(aA,aB,ax)}}var az=0;av()})}function hk(aa){try{return JSON.parse(aa)}catch(t){return hO.parse(aa)}}function jl(t){return t.length<50000?JSON.parse(t):hk(t)}function gd(aa){try{return JSON.stringify(aa)}catch(t){return hO.stringify(aa)}}function gy(ad,aa,ab,t){try{ad.apply(aa,ab)}catch(ac){t.emit("error",ac)}}function jk(aa){if(!il.running&&il.queue.length){il.running=!0;var t=il.queue.shift();t.action(function(ac,ab){gy(t.callback,this,[ac,ab],aa),il.running=!1,w.nextTick(function(){jk(aa)})})}}function hf(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gh(fn,aa,ab.type))}}function O(ab,t,aa){return{data:gd(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function hL(aa){if(!aa){return null}var t=jl(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function z(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function hA(ab,t,aa,ac){aa?ac(ab?"string"!=typeof ab?ab:fW(ab,t):jB([""],{type:t})):ab?"string"!=typeof ab?bn(ab,function(ad){ac(gu(ad))}):ac(ab):ac("")}function jq(ab,t,ah,ac){function aa(){++ad===ag.length&&ac&&ac()}function af(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ah.objectStore(iR).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,aa()}}var ag=Object.keys(ab._attachments||{});if(!ag.length){return ac&&ac()}var ad=0;ag.forEach(function(aj){t.attachments&&t.include_docs?af(ab,aj):(ab._attachments[aj].stub=!0,aa())})}function hN(aa,t){return hi.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hi.all(ab.map(function(ad){var ag=ac.doc._attachments[ad];if("body" in ag){var af=ag.body,ah=ag.content_type;return new hi(function(aj){hA(af,ah,t,function(ak){ac.doc._attachments[ad]=a5.extend(gf(ag,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function hv(ad,aa,ag){function aj(){t--,t||ah()}function ah(){af.length&&af.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ak["delete"](am)}})}var af=[],ac=ag.objectStore(h8),ak=ag.objectStore(iR),ab=ag.objectStore(gr),t=ad.length;ad.forEach(function(al){var am=ac.index("_doc_id_rev"),ap=aa+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return aj()}ac["delete"](aq);var au=ab.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];af.push(ay),ab["delete"](ax.primaryKey),ax["continue"]()}else{aj()}}}})}function hz(ab,t,aa){try{return{txn:ab.transaction(t,aa)}}catch(ac){return{error:ac}}}function iI(aI,az,aH,aJ,ax,aD,aB){function au(){var aN=[g2,h8,iR,f,gr],aO=hz(ax,aN,"readwrite");return aO.error?aB(aO.error):(av=aO.txn,av.onabort=hf(aB),av.ontimeout=hf(aB),av.oncomplete=aF,ah=av.objectStore(g2),al=av.objectStore(h8),aC=av.objectStore(iR),ac=av.objectStore(gr),void aM(function(aP){return aP?(ak=!0,aB(aP)):void aL()}))}function aG(){jA(aI.revs_limit,aa,aJ,aE,av,t,aj,aH)}function aL(){function aQ(){++aO===aa.length&&aG()}function aS(aU){var aV=hL(aU.target.result);aV&&aE.set(aV.id,aV),aQ()}if(aa.length){for(var aO=0,aR=0,aP=aa.length;aP>aR;aR++){var aT=aa[aR];if(aT._id&&hB(aT._id)){aQ()}else{var aN=ah.get(aT.metadata.id);aN.onsuccess=aS}}}}function aF(){ak||(aD.notify(aJ._meta.name),aJ._meta.docCount+=aA,aB(null,t))}function am(aO,aP){var aN=aC.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=gh(gT,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aa.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){am(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aj(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ap(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(ba){var bc=aP.stemmedRevs||[];aV&&aJ.auto_compaction&&(bc=bc.concat(iD(aP.metadata))),bc&&bc.length&&hv(bc,aP.metadata.id,av),aT.seq=ba.target.result,delete aT.rev;var aZ=O(aT,aW,aU),bb=ah.put(aZ);bb.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=al.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=al.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){t[aS]={ok:!0,id:aT.id,rev:aW},aE.set(aP.metadata.id,aP.metadata),ay(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=al.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ap(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;ag(ba,bb,aV)}})}function ay(aT,aO,aR){function aU(){++aP===aQ.length&&aR()}function aS(aX){var aV=aT.data._attachments[aX].digest,aW=ac.put({seq:aO,digestSeq:aV+"::"+aO});aW.onsuccess=aU,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aU()}}var aP=0,aQ=Object.keys(aT.data._attachments||{});if(!aQ.length){return aR()}for(var aN=0;aN<aQ.length;aN++){aS(aQ[aN])}}function ag(aO,aQ,aN){var aP=aC.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=aC.put(aU);aR.onsuccess=aN}}for(var av,ah,al,aC,ac,aq,aa=az.docs,aA=0,ab=0,af=aa.length;af>ab;ab++){var aw=aa[ab];aw._id&&hB(aw._id)||(aw=aa[ab]=g4(aw,aH.new_edits),aw.error&&!aq&&(aq=aw))}if(aq){return aB(aq)}var t=new Array(aa.length),aE=new i5.Map,ak=!1,aK=aJ._meta.blobSupport?"blob":"base64";gI(aa,aK,function(aN){return aN?aB(aN):void au()})}function js(ad,aa,ab,t,ac){try{if(ad&&aa){return ac?IDBKeyRange.bound(aa,ad,!ab,!1):IDBKeyRange.bound(ad,aa,!1,!ab)}if(ad){return ac?IDBKeyRange.upperBound(ad):IDBKeyRange.lowerBound(ad)}if(aa){return ac?IDBKeyRange.lowerBound(aa,!ab):IDBKeyRange.upperBound(aa,!ab)}if(t){return IDBKeyRange.only(t)}}catch(af){return{error:af}}return null}function gQ(ab,t,aa,ac){return"DataError"===aa.name&&0===aa.code?ac(null,{total_rows:ab._meta.docCount,offset:t.skip,rows:[]}):void ac(gh(fn,aa.name,aa.message))}function hq(ad,aa,ab,t){function ac(aj,aw){function ak(aN,aK,aM){var aL=aN.id+"::"+aM;ap.get(aL).onsuccess=function(aO){aK.doc=z(aO.target.result),aj.conflicts&&(aK.doc._conflicts=h1(aN)),jq(aK.doc,aj,au)}}function av(aK,aN,aO){var aL={id:aO.id,key:aO.id,value:{rev:aN}},aM=aO.deleted;if("ok"===aj.deleted){az.push(aL),aM?(aL.value.deleted=!0,aL.doc=null):aj.include_docs&&ak(aO,aL,aN)}else{if(!aM&&aH--<=0&&(az.push(aL),aj.include_docs&&ak(aO,aL,aN),0===--ax)){return}}aK["continue"]()}function aA(aM){ag=aa._meta.docCount;var aK=aM.target.result;if(aK){var aN=hL(aK.value),aL=aN.winningRev;av(aK,aL,aN)}}function aD(){aw(null,{total_rows:ag,offset:aj.skip,rows:az})}function am(){aj.attachments?hN(az,aj.binary).then(aD):aD()}var aE="startkey" in aj?aj.startkey:!1,aB="endkey" in aj?aj.endkey:!1,aG="key" in aj?aj.key:!1,aH=aj.skip||0,ax="number"==typeof aj.limit?aj.limit:-1,ah=aj.inclusive_end!==!1,al="descending" in aj&&aj.descending?"prev":null,aq=js(aE,aB,ah,aG,al);if(aq&&aq.error){return gQ(aa,aj,aq.error,aw)}var aC=[g2,h8];aj.attachments&&aC.push(iR);var ay=hz(ab,aC,"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,aJ=au.objectStore(g2),aF=au.objectStore(h8),aI=al?aJ.openCursor(aq,al):aJ.openCursor(aq),ap=aF.index("_doc_id_rev"),az=[],ag=0;au.oncomplete=am,aI.onsuccess=aA}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:aa._meta.docCount,offset:ah.skip,rows:[]}):void ac(ah,ag)}af(ad,t)}function jn(t){return new hi(function(ab){var aa=jB([""]);t.objectStore(jf).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function S(ab,t){var aa=this;il.queue.push({action:function(ac){jy(aa,ab,ac)},callback:t}),jk(aa.constructor)}function jy(am,al,ag){function ad(au){var av=au.createObjectStore(g2,{keyPath:"id"});au.createObjectStore(h8,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(iR,{keyPath:"digest"}),au.createObjectStore(fp,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jf),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(f,{keyPath:"_id"});var aw=au.createObjectStore(gr,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ac(au,av){var aw=au.objectStore(g2);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=hF(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ah(au){au.createObjectStore(f,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ap(az,ax){var ay=az.objectStore(f),aw=az.objectStore(g2),av=az.objectStore(h8),au=aw.openCursor();au.onsuccess=function(aD){var aG=aD.target.result;if(aG){var aA=aG.value,aJ=aA.id,aK=hB(aJ),aB=fu(aA);if(aK){var aE=aJ+"::"+aB,aH=aJ+"::",aC=aJ+"::~",aF=av.index("_doc_id_rev"),aI=IDBKeyRange.bound(aH,aC,!1,!1),aL=aF.openCursor(aI);aL.onsuccess=function(aN){if(aL=aN.target.result){var aM=aL.value;aM._doc_id_rev===aE&&ay.put(aM),av["delete"](aL.primaryKey),aL["continue"]()}else{aw["delete"](aG.primaryKey),aG["continue"]()}}}else{aG["continue"]()}}else{ax&&ax()}}}function ab(au){var av=au.createObjectStore(gr,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function aa(az,ax){var ay=az.objectStore(h8),aw=az.objectStore(iR),av=az.objectStore(gr),au=aw.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ay.openCursor().onsuccess=function(aF){var aJ=aF.target.result;if(!aJ){return ax()}for(var aK=aJ.value,aH=aJ.primaryKey,aD=Object.keys(aK._attachments||{}),aL={},aC=0;aC<aD.length;aC++){var aE=aK._attachments[aD[aC]];aL[aE.digest]=!0}var aG=Object.keys(aL);for(aC=0;aC<aG.length;aC++){var aI=aG[aC];av.put({seq:aH,digestSeq:aI+"::"+aH})}aJ["continue"]()}):ax()}}function ak(ax){function aw(az){return az.data?hL(az):(az.deleted="1"===az.deletedOrLocal,az)}var ay=ax.objectStore(h8),au=ax.objectStore(g2),av=au.openCursor();av.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=ay.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=O(az,az.winningRev,az.deleted),aF=au.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=aw(aA.value);return az.winningRev=az.winningRev||fu(az),az.seq?aD():void aB()}}}var af=al.name,aj=null;am._meta=null,am.type=function(){return"idb"},am._id=ee(function(au){au(null,am._meta.instanceId)}),am._bulkDocs=function(aw,av,au){iI(al,aw,av,am,aj,i9,au)},am._get=function(aA,aw,ax){function aC(){ax(az,{doc:aB,metadata:au,ctx:av})}var aB,au,az,av=aw.ctx;if(!av){var ay=hz(aj,[g2,h8,iR],"readonly");if(ay.error){return ax(ay.error)}av=ay.txn}av.objectStore(g2).get(aA).onsuccess=function(aG){if(au=hL(aG.target.result),!au){return az=gh(ew,"missing"),aC()}if(hF(au)&&!aw.rev){return az=gh(ew,"deleted"),aC()}var aE=av.objectStore(h8),aD=aw.rev||au.winningRev,aF=au.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aB=aH.target.result,aB&&(aB=z(aB)),aB?void aC():(az=gh(ew,"missing"),aC())}}},am._getAttachment=function(aA,aw,ax,aC,aB){var au;if(aC.ctx){au=aC.ctx}else{var az=hz(aj,[g2,h8,iR],"readonly");if(az.error){return aB(az.error)}au=az.txn}var av=ax.digest,ay=ax.content_type;au.objectStore(iR).get(av).onsuccess=function(aE){var aD=aE.target.result.body;hA(aD,ay,aC.binary,function(aF){aB(null,aF)})}},am._info=function(av){if(null===aj||!hQ.has(af)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,aw,au=hz(aj,[h8],"readonly");if(au.error){return av(au.error)}var ay=au.txn,ax=ay.objectStore(h8).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,aw=am._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:az,idb_attachment_format:am._meta.blobSupport?"binary":"base64"})}},am._allDocs=function(av,au){hq(av,am,aj,au)},am._changes=function(az){function aG(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aw=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=av.get(aU);aT.onsuccess=function(aV){aO(z(aV.target.result))}}function aO(aU){var aT=az.processChange(aU,aN,az);aT.seq=aN.seq;var aV=aC(aT);return"object"==typeof aV?az.complete(aV):(aV&&(aJ++,ax&&au.push(aT),az.attachments&&az.include_docs?jq(aU,az,aK,function(){hN([aT],az.binary).then(function(){az.onChange(aT)})}):az.onChange(aT)),void (aJ!==aH&&aS["continue"]()))}var aQ=z(aS.value),aR=aS.key;if(aD&&!aD.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aI.get(aQ._id).onsuccess=function(aT){aN=hL(aT.target.result),ay.set(aQ._id,aN),aM()})}function aL(aN){var aM=aN.target.result;aM&&aG(aM)}function aF(){var aM=[g2,h8];az.attachments&&aM.push(iR);var aN=hz(aj,aM,"readonly");if(aN.error){return az.complete(aN.error)}aK=aN.txn,aK.onabort=hf(az.complete),aK.oncomplete=aE,aB=aK.objectStore(h8),aI=aK.objectStore(g2),av=aB.index("_doc_id_rev");var aO;aO=az.descending?aB.openCursor(null,"prev"):aB.openCursor(IDBKeyRange.lowerBound(az.since,!0)),aO.onsuccess=aL}function aE(){function aM(){az.complete(null,{results:au,last_seq:aw})}!az.continuous&&az.attachments?hN(au).then(aM):aM()}if(az=ii(az),az.continuous){var aA=af+":"+ex();return i9.addListener(af,aA,am,az),i9.notify(af),{cancel:function(){i9.removeListener(af,aA)}}}var aD=az.doc_ids&&new i5.Set(az.doc_ids);az.since=az.since||0;var aw=az.since,aH="limit" in az?az.limit:-1;0===aH&&(aH=1);var ax;ax="return_docs" in az?az.return_docs:"returnDocs" in az?az.returnDocs:!0;var aK,aB,aI,av,au=[],aJ=0,aC=jd(az),ay=new i5.Map;aF()},am._close=function(au){return null===aj?au(gh(hc)):(aj.close(),hQ["delete"](af),aj=null,void au())},am._getRevisionTree=function(ax,aw){var ay=hz(aj,[g2],"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,av=au.objectStore(g2).get(ax);av.onsuccess=function(aA){var az=hL(aA.target.result);az?aw(null,az.rev_tree):aw(gh(ew))}},am._doCompaction=function(aA,av,aw){var ax=[g2,h8,iR,gr],az=hz(aj,ax,"readwrite");if(az.error){return aw(az.error)}var au=az.txn,ay=au.objectStore(g2);ay.get(aA).onsuccess=function(aC){var aE=hL(aC.target.result);fi(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),hv(av,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(g2).put(O(aE,aD,aB))},au.onabort=hf(aw),au.oncomplete=function(){aw()}},am._getLocal=function(ax,aw){var ay=hz(aj,[f],"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,av=au.objectStore(f).get(ax);av.onerror=hf(aw),av.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,aw(null,az)):aw(gh(ew))}},am._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hz(aj,[f],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=hf(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(f);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(gh(jC))}}):(au=ax.add(ay),au.onerror=function(aE){av(gh(jC)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},am._removeLocal=function(aA,aw,ax){"function"==typeof aw&&(ax=aw,aw={});var aC=aw.ctx;if(!aC){var aB=hz(aj,[f],"readwrite");if(aB.error){return ax(aB.error)}aC=aB.txn,aC.oncomplete=function(){au&&ax(null,au)}}var au,az=aA._id,av=aC.objectStore(f),ay=av.get(az);ay.onerror=hf(ax),ay.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aA._rev?(av["delete"](az),au={ok:!0,id:az,rev:"0-0"},aw.ctx&&ax(null,au)):ax(gh(ew))}},am._destroy=function(au,aw){i9.removeAllListeners(af);var ax=hm.get(af);ax&&ax.result&&(ax.result.close(),hQ["delete"](af));var av=indexedDB.deleteDatabase(af);av.onsuccess=function(){hm["delete"](af),fd()&&af in localStorage&&delete localStorage[af],aw(null,{ok:!0})},av.onerror=hf(aw)};var aq=hQ.get(af);if(aq){return aj=aq.idb,am._meta=aq.global,void w.nextTick(function(){ag(null,am)})}var t;t=al.storage?i2(af,al.storage):indexedDB.open(af,gv),hm.set(af,t),t.onupgradeneeded=function(ax){function az(){var aA=av[au-1];au++,aA&&aA(ay,az)}var aw=ax.target.result;if(ax.oldVersion<1){return ad(aw)}var ay=ax.currentTarget.transaction;ax.oldVersion<3&&ah(aw),ax.oldVersion<4&&ab(aw);var av=[ac,ap,aa,ak],au=ax.oldVersion;az()},t.onsuccess=function(aw){aj=aw.target.result,aj.onversionchange=function(){aj.close(),hQ["delete"](af)},aj.onabort=function(aA){iS("error","Database has a global failure",aA.target.error),aj.close(),hQ["delete"](af)};var ay=aj.transaction([fp,jf,g2],"readwrite"),av=ay.objectStore(fp).get(fp),ax=null,az=null,au=null;av.onsuccess=function(aB){var aD=function(){null!==ax&&null!==az&&null!==au&&(am._meta={name:af,instanceId:au,blobSupport:ax,docCount:az},hQ.set(af,{idb:aj,global:am._meta}),ag(null,am))},aA=aB.target.result||{id:fp};af+"_id" in aA?(au=aA[af+"_id"],aD()):(au=ex(),aA[af+"_id"]=au,ay.objectStore(fp).put(aA).onsuccess=function(){aD()}),iB||(iB=jn(ay)),iB.then(function(aE){ax=aE,aD()});var aC=ay.objectStore(g2).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){az=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iS("error",au),ag(gh(fn,au))}}function i2(ab,t){try{return indexedDB.open(ab,{version:gv,storage:t})}catch(aa){return indexedDB.open(ab,gv)}}function jv(t){t.adapter("idb",S,!0)}function jx(t){return decodeURIComponent(escape(t))}function ig(t){return 65>t?t-48:t-55}function ji(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(ig(ab.charCodeAt(t++))<<4|ig(ab.charCodeAt(t++)))}return ac}function hX(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(ig(ab.charCodeAt(t+2))<<12|ig(ab.charCodeAt(t+3))<<8|ig(ab.charCodeAt(t))<<4|ig(ab.charCodeAt(t+1))),t+=4}return ac}function hT(aa,t){return"UTF-8"===t?jx(ji(aa,0,aa.length)):hX(aa,0,aa.length)}function gn(t){return"'"+t+"'"}function ix(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hW(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function iH(t){return delete t._id,delete t._rev,JSON.stringify(t)}function jc(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function hD(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function J(ad,aa,ab,t,ac){return"SELECT "+ad+" FROM "+("string"==typeof aa?aa:aa.join(" JOIN "))+(ab?" ON "+ab:"")+(t?" WHERE "+("string"==typeof t?t:t.join(" AND ")):"")+(ac?" ORDER BY "+ac:"")}function iw(ac,t,ag){function ad(){++aa===ac.length&&ab()}function ab(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+iL+" WHERE seq IN "+hD(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+iL+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+iL+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new i5.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+iL+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+dr+" WHERE digest=?",[az]))})})})}})}}if(ac.length){var aa=0,af=[];ac.forEach(function(aj){var ah="SELECT seq FROM "+a6+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[t,aj],function(al,am){if(!am.rows.length){return ad()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+a6+" WHERE seq=?",[ak],ad)})})}}function ce(t){return function(ad){iS("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gh(fV,ab,ac))}}function gj(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function id(al,ab,az,au,aB,af,ag){function av(){return am?ag(am):(af.notify(au._name),au._docCount=-1,void ag(null,ac))}function aA(aD,aE){var aC="SELECT count(*) as cnt FROM "+dr+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gh(gT,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aj(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aA(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aw(aP,aH,aM,aC,aE,aK,aF,aI){function aN(){function aY(bc,bb){function ba(){return ++bg===bd.length&&bb(),!1}function aZ(bj){var bi="INSERT INTO "+iL+" (digest, seq) VALUES (?,?)",bh=[aR._attachments[bj].digest,bc];ap.executeSql(bi,bh,ba,ba)}var bg=0,bd=Object.keys(aR._attachments||{});if(!bd.length){return bb()}for(var bf=0;bf<bd.length;bf++){aZ(bd[bf])}}var aR=aP.data,aW=aC?1:0,aT=aR._id,aX=aR._rev,aV=iH(aR),aU="INSERT INTO "+a6+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aS=[aT,aX,aV,aW];ap.executeSql(aU,aS,function(ba,bb){var aZ=bb.insertId;aY(aZ,function(){aO(ba,aZ)})},function(){var aZ=J("seq",a6,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aT,aX],function(bf,bd){var bc=bd.rows.item(0).seq,bb="UPDATE "+a6+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aV,aW,aT,aX];bf.executeSql(bb,ba,function(bg){aY(bc,function(){aO(bg,bc)})})}),!1})}function aQ(aR){aD||(aR?(aD=aR,aI(aD)):aJ===aL.length&&aN())}function aG(aR){aJ++,aQ(aR)}function aO(aX,aR){var aV=aP.metadata.id,aW=aP.stemmedRevs||[];aE&&au.auto_compaction&&(aW=iD(aP.metadata).concat(aW)),aW.length&&iw(aW,aV,aX),aP.metadata.seq=aR,delete aP.metadata.rev;var aU=aE?"UPDATE "+ie+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+a6+" WHERE doc_id="+ie+".id AND rev=?) WHERE id=?":"INSERT INTO "+ie+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=gd(aP.metadata),aS=aE?[aT,aR,aH,aV]:[aV,aR,aR,aT];aX.executeSql(aU,aS,function(){ac[aF]={ok:!0,id:aP.metadata.id,rev:aH},ah.set(aV,aP.metadata),aI()})}var aD=null,aJ=0;aP.data._id=aP.metadata.id,aP.data._rev=aP.metadata.rev;var aL=Object.keys(aP.data._attachments||{});aC&&(aP.data._deleted=!0),aL.forEach(function(aU){var aS=aP.data._attachments[aU];if(aS.stub){aJ++,aQ()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aH,10);var aT=aS.digest;aa(aT,aR,aG)}}),aL.length||aN()}function ay(){jA(al.revs_limit,aq,au,ah,ap,ac,aw,az)}function ax(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&hB(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+ie+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=jl(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function aa(aD,aF,aC){var aE="SELECT digest FROM "+dr+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+dr+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,ix(aF)],function(){aC()},function(){return aC(),!1}))})}var ad=az.new_edits,t=ab.docs,aq=t.map(function(aC){if(aC._id&&hB(aC._id)){return aC}var aD=g4(aC,ad);return aD}),ak=aq.filter(function(aC){return aC.error});if(ak.length){return ag(ak[0])}var ap,am,ac=new Array(aq.length),ah=new i5.Map;gI(aq,"binary",function(aC){return aC?ag(aC):void aB.transaction(function(aD){ap=aD,aj(function(aE){aE?am=aE:ax(ay)})},ce(ag),av)})}function h6(t){return t.websql(t.name,t.version,t.description,t.size)}function ft(aa){try{return{db:h6(aa)}}catch(t){return{error:t}}}function B(aa){var t=gH.get(aa.name);return t||(t=ft(aa),gH.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function it(af,ac,ah,aa,aj){function ag(){++ab===t.length&&aj&&aj()}function ad(am,ak){var al=am._attachments[ak],ap={binary:ac.binary,ctx:aa};ah._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=a5.extend(gf(al,["digest","content_type"]),{data:au}),ag()})}var t=Object.keys(af._attachments||{});if(!t.length){return aj&&aj()}var ab=0;t.forEach(function(ak){ac.attachments&&ac.include_docs?ad(af,ak):(af._attachments[ak].stub=!0,ag())})}function gK(ak,au){function ab(){fd()&&(window.localStorage["_pouch__websqldb_"+ah._name]=!0),au(null,ah)}function aC(aD,aE){aD.executeSql(i0),aD.executeSql("ALTER TABLE "+a6+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(T),aD.executeSql("ALTER TABLE "+ie+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+ie+" (local, id)");var aF="SELECT "+ie+".winningseq AS seq, "+ie+".json AS metadata FROM "+a6+" JOIN "+ie+" ON "+a6+".seq = "+ie+".winningseq";aD.executeSql(aF,[],function(aK,aG){for(var aL=[],aI=[],aH=0;aH<aG.rows.length;aH++){var aN=aG.rows.item(aH),aM=aN.seq,aJ=JSON.parse(aN.metadata);hF(aJ)&&aL.push(aM),hB(aJ.id)&&aI.push(aJ.id)}aK.executeSql("UPDATE "+ie+"SET local = 1 WHERE id IN "+hD(aI.length),aI,function(){aK.executeSql("UPDATE "+a6+" SET deleted = 1 WHERE seq IN "+hD(aL.length),aL,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+gS+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+ie+".id AS id, "+a6+".json AS data FROM "+a6+" JOIN "+ie+" ON "+a6+".seq = "+ie+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aI,aL){function aJ(){if(!aH.length){return aF(aI)}var aM=aH.shift(),aN=JSON.parse(aM.data)._rev;aI.executeSql("INSERT INTO "+gS+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+ie+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+a6+" WHERE seq=?",[aM.seq],function(){aJ()})})})}for(var aH=[],aK=0;aK<aL.rows.length;aK++){aH.push(aL.rows.item(aK))}aJ()})})}function ay(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aN=aI.shift(),aJ=hT(aN.hex,ac),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+a6+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aH()})}aH()}var aF="ALTER TABLE "+a6+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+a6+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(gq,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+a6;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function aA(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+dr;aH.executeSql(aI,[],function(aO,aM){function aJ(){var aP=J(C+", "+ie+".id AS id",[ie,a6],jh,null,ie+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aQ){function aW(bc,bd){var bf=aY[bc]=aY[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aQ.rows.length){return aG(ba)}for(var aY={},aU=0;aU<aQ.rows.length;aU++){for(var aS=aQ.rows.item(aU),aT=jc(aS.data,aS.id,aS.rev),aX=Object.keys(aT._attachments||{}),aV=0;aV<aX.length;aV++){var aZ=aT._attachments[aX[aV]];aW(aZ.digest,aS.seq)}}var aR=[];if(Object.keys(aY).forEach(function(bc){var bd=aY[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aJ()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+iL+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+iL+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(o,[],function(aI){aI.executeSql(jb,[],aD)})})}function aa(aE,aF){var aD="ALTER TABLE "+dr+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+ie+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+ie+" SET max_seq=(SELECT MAX(seq) FROM "+a6+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+ie+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aj(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ac=2===aG.length?"UTF-8":"UTF-16",aE()})}function ag(){for(;al.length>0;){var aD=al.pop();aD(null,av)}}function am(aJ,aN){if(0===aN){var aE="CREATE TABLE IF NOT EXISTS "+ir+" (dbid, db_version INTEGER)",aH="CREATE TABLE IF NOT EXISTS "+dr+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aK="CREATE TABLE IF NOT EXISTS "+iL+" (digest, seq INTEGER)",aM="CREATE TABLE IF NOT EXISTS "+ie+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aL="CREATE TABLE IF NOT EXISTS "+a6+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aF="CREATE TABLE IF NOT EXISTS "+gS+" (id UNIQUE, rev, json)";aJ.executeSql(aH),aJ.executeSql(aF),aJ.executeSql(aK,[],function(){aJ.executeSql(jb),aJ.executeSql(o)}),aJ.executeSql(aM,[],function(){aJ.executeSql(i0),aJ.executeSql(aL,[],function(){aJ.executeSql(T),aJ.executeSql(gq),aJ.executeSql(aE,[],function(){var aP="INSERT INTO "+ir+" (db_version, dbid) VALUES (?,?)";av=ex();var aQ=[en,av];aJ.executeSql(aP,aQ,function(){ag()})})})})}else{var aD=function(){var aQ=en>aN;aQ&&aJ.executeSql("UPDATE "+ir+" SET db_version = "+en);var aP="SELECT dbid FROM "+ir;aJ.executeSql(aP,[],function(aR,aS){av=aS.rows.item(0).dbid,ag()})},aG=[aC,aq,ay,aA,aa,ap,aD],aI=aN,aO=function(aP){aG[aI-1](aP,aO),aI++};aO(aJ)}}function az(){t.transaction(function(aD){aj(aD,function(){ad(aD)})},ce(au),ab)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+ir;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+ir,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;am(aJ,aI)}):aF.executeSql("ALTER TABLE "+ir+" ADD COLUMN db_version INTEGER",[],function(){am(aF,1)}):am(aF,0)})}function aw(aE,aF){if(-1!==ah._docCount){return aF(ah._docCount)}var aD=J("COUNT("+ie+".id) AS 'num'",[ie,a6],jh,a6+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ah._docCount=aH.rows.item(0).num,aF(ah._docCount)})}var ac,ah=this,av=null,aB=gj(ak),al=[];ah._docCount=-1,ah._name=ak.name;var af=a5.extend({},ak,{version:jp,description:ak.name,size:aB}),ax=B(af);if(ax.error){return ce(au)(ax.error)}var t=ax.db;"function"!=typeof t.readTransaction&&(t.readTransaction=t.transaction),az(),ah.type=function(){return"websql"},ah._id=ee(function(aD){aD(null,av)}),ah._info=function(aD){t.readTransaction(function(aE){aw(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+a6;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:t._sqlitePlugin,websql_encoding:ac})})})},ce(aD))},ah._bulkDocs=function(aF,aD,aE){id(ak,aF,aD,ah,t,ff,aE)},ah._get=function(aM,aL,aE){function aH(){aE(aJ,{doc:aG,metadata:aD,ctx:aF})}var aG,aD,aJ,aF=aL.ctx;if(!aF){return t.readTransaction(function(aN){ah._get(aM,a5.extend({ctx:aN},aL),aE)})}var aI,aK;aL.rev?(aI=J(C,[ie,a6],ie+".id="+a6+".doc_id",[a6+".doc_id=?",a6+".rev=?"]),aK=[aM,aL.rev]):(aI=J(C,[ie,a6],jh,ie+".id=?"),aK=[aM]),aF.executeSql(aI,aK,function(aP,aO){if(!aO.rows.length){return aJ=gh(ew,"missing"),aH()}var aN=aO.rows.item(0);return aD=jl(aN.metadata),aN.deleted&&!aL.rev?(aJ=gh(ew,"deleted"),aH()):(aG=jc(aN.data,aD.id,aN.rev),void aH())})},ah._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(ie+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(ie+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(ie+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(ie+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(a6+".deleted = 0"),t.readTransaction(function(aR){aw(aR,function(aT){if(aM=aT,0!==aO){var aS=J(C,[ie,a6],jh,aE,ie+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(bb,aY){for(var aZ=0,aV=aY.rows.length;aV>aZ;aZ++){var bc=aY.rows.item(aZ),ba=jl(bc.metadata),aW=ba.id,aU=jc(bc.data,aW,bc.rev),aX=aU._rev,bd={id:aW,key:aW,value:{rev:aX}};if(aJ.include_docs&&(bd.doc=aU,bd.doc._rev=aX,aJ.conflicts&&(bd.doc._conflicts=h1(ba)),it(bd.doc,aJ,ah,bb)),bc.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},ce(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},ah._changes=function(aD){function aK(){var aN=ie+".json AS metadata, "+ie+".max_seq AS maxSeq, "+a6+".json AS winningDoc, "+a6+".rev AS winningRev ",aM=ie+" JOIN "+a6,aO=ie+".id="+a6+".doc_id AND "+ie+".winningseq="+a6+".seq",aP=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aP.push(ie+".id IN "+hD(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aL="maxSeq "+(aG?"DESC":"ASC"),aS=J(aN,aM,aO,aP,aL),aT=jd(aD);aD.view||aD.filter||(aS+=" LIMIT "+aJ);var aQ=aD.since||0;t.readTransaction(function(aU){aU.executeSql(aS,aR,function(ba,aY){function bb(bg){return function(){aD.onChange(bg)}}for(var aV=0,aW=aY.rows.length;aW>aV;aV++){var aX=aY.rows.item(aV),aZ=jl(aX.metadata);aQ=aX.maxSeq;var bf=jc(aX.winningDoc,aZ.id,aX.winningRev),bc=aD.processChange(bf,aZ,aD);bc.seq=aX.maxSeq;var bd=aT(bc);if("object"==typeof bd){return aD.complete(bd)}if(bd&&(aH++,aE&&aF.push(bc),aD.attachments&&aD.include_docs?it(bf,aD,ah,ba,bb(bc)):bb(bc)()),aH===aJ){break}}})},ce(aD.complete),function(){aD.continuous||aD.complete(null,{results:aF,last_seq:aQ})})}if(aD=ii(aD),aD.continuous){var aI=ah._name+":"+ex();return ff.addListener(ah._name,aI,ah,aD),ff.notify(ah._name),{cancel:function(){ff.removeListener(ah._name,aI)}}}var aG=aD.descending;aD.since=aD.since&&!aG?aD.since:0;var aJ="limit" in aD?aD.limit:-1;0===aJ&&(aJ=1);var aE;aE="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aF=[],aH=0;aK()},ah._close=function(aD){aD()},ah._getAttachment=function(aM,aL,aE,aH,aG){var aD,aJ=aH.ctx,aF=aE.digest,aI=aE.content_type,aK="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+dr+" WHERE digest=?";aJ.executeSql(aK,[aF],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hW(aO.body):hT(aO.body,ac);aD=aH.binary?i3(aN,aI):gu(aN),aG(null,aD)})},ah._getRevisionTree=function(aD,aE){t.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+ie+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=jl(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(gh(ew))}})})},ah._doCompaction=function(aE,aF,aD){return aF.length?void t.transaction(function(aH){var aG="SELECT json AS metadata FROM "+ie+" WHERE id = ?";aH.executeSql(aG,[aE],function(aJ,aL){var aK=jl(aL.rows.item(0).metadata);fi(aK.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aI="UPDATE "+ie+" SET json = ? WHERE id = ?";aJ.executeSql(aI,[gd(aK),aE])}),iw(aF,aE,aH)},ce(aD),function(){aD()}):aD()},ah._getLocal=function(aD,aE){t.readTransaction(function(aF){var aG="SELECT json, rev FROM "+gS+" WHERE id=?";aF.executeSql(aG,[aD],function(aI,aK){if(aK.rows.length){var aJ=aK.rows.item(0),aH=jc(aJ.json,aD,aJ.rev);aE(null,aH)}else{aE(gh(ew))}})})},ah._putLocal=function(aE,aJ,aG){function aI(aO){var aM,aN;aF?(aM="UPDATE "+gS+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aH,aK,aL,aF]):(aM="INSERT INTO "+gS+" (id, rev, json) VALUES (?,?,?)",aN=[aL,aH,aK]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aD={ok:!0,id:aL,rev:aH},aJ.ctx&&aG(null,aD)):aG(gh(jC))},function(){return aG(gh(jC)),!1})}"function"==typeof aJ&&(aG=aJ,aJ={}),delete aE._revisions;var aH,aF=aE._rev,aL=aE._id;aH=aF?aE._rev="0-"+(parseInt(aF.split("-")[1],10)+1):aE._rev="0-1";var aD,aK=iH(aE);aJ.ctx?aI(aJ.ctx):t.transaction(aI,ce(aG),function(){aD&&aG(null,aD)})},ah._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+gS+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(gh(ew))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):t.transaction(aF,ce(aH),function(){aD&&aH(null,aD)})},ah._destroy=function(aD,aE){ff.removeAllListeners(ah._name),t.transaction(function(aF){var aG=[ie,a6,dr,ir,gS,iL];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},ce(aE),function(){fd()&&(delete window.localStorage["_pouch__websqldb_"+ah._name],delete window.localStorage[ah._name]),aE(null,{ok:!0})})}}function a0(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gY(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=fd(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=a0();return ab&&(localStorage[t]=aa?"1":"0"),aa}function i1(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gY()}function eo(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=a5.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function iW(ab,t){var aa=eo(ab),ac=a5.extend({websql:aa},ab);gK.call(this,ac,t)}function an(t){t.adapter("websql",iW,!0)}function gs(){for(var ab={},t=new hi(function(af,ad){ab.resolve=af,ab.reject=ad}),aa=new Array(arguments.length),ac=0;ac<aa.length;ac++){aa[ac]=arguments[ac]}return ab.promise=t,hi.resolve().then(function(){return fetch.apply(null,aa)}).then(function(ad){ab.resolve(ad)})["catch"](function(ad){ab.reject(ad)}),ab}function P(ac,t){var ag,ad,ab,aa=new Headers,af={method:ac.method,credentials:"include",headers:aa};return ac.json&&(aa.set("Accept","application/json"),aa.set("Content-Type",ac.headers["Content-Type"]||"application/json")),ac.body&&ac.body instanceof Blob?ib(ac.body,function(ah){af.body=ah}):ac.body&&ac.processData&&"string"!=typeof ac.body?af.body=JSON.stringify(ac.body):"body" in ac?af.body=ac.body:af.body=null,Object.keys(ac.headers).forEach(function(ah){ac.headers.hasOwnProperty(ah)&&aa.set(ah,ac.headers[ah])}),ag=gs(ac.url,af),ac.timeout>0&&(ad=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ac.url))},ac.timeout)),ag.promise.then(function(ah){return ab={statusCode:ah.status},ac.timeout>0&&clearTimeout(ad),ab.statusCode>=200&&ab.statusCode<300?ac.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ab.statusCode>=200&&ab.statusCode<300?t(null,ab,ah):t(ah,ab)})["catch"](function(ah){t(ah,ab)}),{abort:ag.reject}}function i6(af,ac){var ah,aa,aj=!1,ag=function(){ah.abort()},ad=function(){aj=!0,ah.abort()};ah=af.xhr?new af.xhr:new XMLHttpRequest;try{ah.open(af.method,af.url)}catch(t){ac(t,{statusCode:413})}ah.withCredentials="withCredentials" in af?af.withCredentials:!0,"GET"===af.method?delete af.headers["Content-Type"]:af.json&&(af.headers.Accept="application/json",af.headers["Content-Type"]=af.headers["Content-Type"]||"application/json",af.body&&af.processData&&"string"!=typeof af.body&&(af.body=JSON.stringify(af.body))),af.binary&&(ah.responseType="arraybuffer"),"body" in af||(af.body=null);for(var ab in af.headers){af.headers.hasOwnProperty(ab)&&ah.setRequestHeader(ab,af.headers[ab])}return af.timeout>0&&(aa=setTimeout(ad,af.timeout),ah.onprogress=function(){clearTimeout(aa),4!==ah.readyState&&(aa=setTimeout(ad,af.timeout))},"undefined"!=typeof ah.upload&&(ah.upload.onprogress=ah.onprogress)),ah.onreadystatechange=function(){if(4===ah.readyState){var ak={statusCode:ah.status};if(ah.status>=200&&ah.status<300){var am;am=af.binary?jB([ah.response||""],{type:ah.getResponseHeader("Content-Type")}):ah.responseText,ac(null,ak,am)}else{var ap={};if(aj){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ah.response)}catch(al){}}ac(ap,ak)}}},af.body&&af.body instanceof Blob?ib(af.body,function(ak){ah.send(ak)}):ah.send(af.body),{abort:ag}}function jE(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function j(aa,t){return fl||aa.xhr?i6(aa,t):P(aa,t)}function a4(){return""}function gA(ad,aa){function ab(ah,aj,ag){if(!ad.binary&&ad.json&&"string"==typeof ah){try{ah=JSON.parse(ah)}catch(af){return ag(af)}}Array.isArray(ah)&&(ah=ah.map(function(ak){return ak.error||ak.missing?hE(ak):ak})),ad.binary&&hP(ah,aj),ag(null,ah,aj)}function t(al,ag){var aj,af;if(al.code&&al.status){var ak=new Error(al.message||al.code);return ak.status=al.status,ag(ak)}if(al.message&&"ETIMEDOUT"===al.message){return ag(al)}try{aj=JSON.parse(al.responseText),af=hE(aj)}catch(ah){af=hE(al)}ag(af)}ad=ii(ad);var ac={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ad=a5.extend(ac,ad),ad.json&&(ad.binary||(ad.headers.Accept="application/json"),ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json"),ad.binary&&(ad.encoding=null,ad.json=!1),ad.processData||(ad.json=!1),j(ad,function(ag,ak,am){if(ag){return ag.status=ak?ak.statusCode:400,t(ag,aa)}var aj,al=ak.headers&&ak.headers["content-type"],af=am||a4();if(!ad.binary&&(ad.json||!ad.processData)&&"object"!=typeof af&&(/json/.test(al)||/^[\s]*\{/.test(af)&&/\}[\s]*$/.test(af))){try{af=JSON.parse(af.toString())}catch(ah){}}ak.statusCode>=200&&ak.statusCode<300?ab(af,ak,aa):(aj=hE(af),aj.status=ak.statusCode,aa(aj))})}function ey(ad,aa){var ag=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aj=-1!==ag.indexOf("safari")&&-1===ag.indexOf("chrome"),ah=-1!==ag.indexOf("msie"),af=-1!==ag.indexOf("edge"),ac=aj||(ah||af)&&"GET"===ad.method,ak="cache" in ad?ad.cache:!0,ab=/^blob:/.test(ad.url);if(!ab&&(ac||!ak)){var t=-1!==ad.url.indexOf("?");ad.url+=(t?"&":"?")+"_nonce="+Date.now()}return gA(ad,aa)}function g7(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=fW(ab.data,ab.content_type)})}function iz(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function hU(t){return t._attachments&&Object.keys(t._attachments)?hi.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hi(function(ac){iJ(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hi.resolve()}function ha(ab){var t=fx(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function hd(aa,t){return L(aa,aa.db+"/"+t)}function L(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function hZ(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function iM(aq,aj){function ah(ax,ay,aw){var aA=ax.ajax||{},az=a5.extend(ii(am),aA,ay);return ic(az.method+" "+az.url),ab._ajax(az,aw)}function ap(ax,aw){return new hi(function(az,ay){ah(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function av(ax,aw){return jw(ax,hw(function(ay){ac().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ac(){if(aq.skipSetup||aq.skip_setup){return hi.resolve()}if(au){return au}var aw={method:"GET",url:t};return au=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(g9(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:t})):hi.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hi.reject(ax)}),au["catch"](function(){au=null}),au}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,ad=ha;aq.getHost&&(ad=aq.getHost);var al=ad(aq.name,aq),t=hd(al,"");aq=ii(aq);var am=aq.ajax||{};if(ab.getUrl=function(){return t},ab.getHeaders=function(){return am.headers||{}},aq.auth||al.auth){var af=aq.auth||al.auth,ak=af.username+":"+af.password,aa=gu(unescape(encodeURIComponent(ak)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=ey;var au;setTimeout(function(){aj(null,ab)}),ab.type=function(){return"http"},ab.id=av("id",function(aw){ah({},{method:"GET",url:L(al,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+al.db:hd(al,"");aw(null,ay)})}),ab.request=av("request",function(ax,aw){ax.url=hd(al,ax.url),ah({},ax,aw)}),ab.compact=av("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=ii(ax),ah(ax,{url:hd(al,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ab.bulkGet=jw("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:hd(al,"_bulk_get"+hZ(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aF(aK){return function(aM,aL){aJ[aK]=aL.results,++aE===aH&&aA(null,{results:y(aJ)})}}for(var aI=hh,aH=Math.ceil(aC.docs.length/aI),aE=0,aJ=new Array(aH),aD=0;aH>aD;aD++){var aG=gf(aC,["revs","attachments"]);aG.ajax=am,aG.docs=aC.docs.slice(aD*aI,Math.min(aC.docs.length,(aD+1)*aI)),fh(aw,aG,aF(aD))}}var aw=this,az=L(al,""),ay=hJ[az];"boolean"!=typeof ay?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(hJ[az]=!1,g9(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{hJ[az]=!0,aA(null,aE)}}):ay?aB(aA):ax()}),ab._info=function(aw){ac().then(function(){ah({},{method:"GET",url:hd(al,"")},function(ay,ax){return ay?aw(ay):(ax.host=hd(al,""),void aw(null,ax))})})["catch"](aw)},ab.get=av("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hi.all(aF.map(function(aI){var aH=aD[aI],aG=iz(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(aC,{method:"GET",url:hd(al,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:new hi(function(aK){iJ(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?hi.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=ii(aC);var ay={};aC.revs&&(ay.revs=!0),aC.revs_info&&(ay.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),ay.open_revs=aC.open_revs),aC.rev&&(ay.rev=aC.rev),aC.conflicts&&(ay.conflicts=aC.conflicts),aA=iz(aA);var az={method:"GET",url:hd(al,aA+hZ(ay))};ap(aC,az).then(function(aD){return hi.resolve().then(function(){return aC.attachments?aw(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ab.remove=av("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:hd(al,iz(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=av("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=hd(al,iz(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=av("removeAttachment",function(ax,ay,aA,aw){var az=hd(al,iz(ax)+"/"+ag(ay))+"?rev="+aA;ah({},{method:"DELETE",url:az},aw)}),ab.putAttachment=av("putAttachment",function(az,aG,aE,aD,aB,aF){"function"==typeof aB&&(aF=aB,aB=aD,aD=aE,aE=null);var aw=iz(az)+"/"+ag(aG),ax=hd(al,aw);if(aE&&(ax+="?rev="+aE),"string"==typeof aD){var aC;try{aC=fm(aD)}catch(ay){return aF(gh(gx,"Attachment is not a valid base64 string"))}aD=aC?i3(aC,aB):""}var aA={headers:{"Content-Type":aB},method:"PUT",url:ax,processData:!1,body:aD,timeout:am.timeout||60000};ah({},aA,aF)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,ac().then(function(){return hi.all(ay.docs.map(hU))}).then(function(){ah(ax,{method:"POST",url:hd(al,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=av("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=ii(aA);var aB,ax={},aw="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var az=hZ(ax);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=gZ?az+="&"+ay:(aw="POST",aB={keys:aA.keys})}ap(aA,{method:aw,url:hd(al,"_all_docs"+az),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(g7),aC(null,aD)})["catch"](aC)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:hV;aB=ii(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aF=aB.timeout?{timeout:aB.timeout-5000}:{},az="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=az;if(aB.style&&(aF.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aF.include_docs=!0),aB.attachments&&(aF.attachments=!0),aB.continuous&&(aF.feed="longpoll"),aB.conflicts&&(aF.conflicts=!0),aB.descending&&(aF.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aF.heartbeat=aB.heartbeat):aF.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aF.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aF.filter="_view",aF.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var aD in aB.query_params){aB.query_params.hasOwnProperty(aD)&&(aF[aD]=aB.query_params[aD])}}var aJ,aI="GET";if(aB.doc_ids){aF.filter="_doc_ids";var aK=JSON.stringify(aB.doc_ids);aK.length<gZ?aF.doc_ids=aK:(aI="POST",aJ={doc_ids:aB.doc_ids})}var ax,aA,aC=function(aM,aN){if(!aB.aborted){aF.since=aM,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aB.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aw?aw:aH;var aL={method:aI,url:hd(al,"_changes"+hZ(aF)),timeout:aB.timeout,body:aJ};aA=aM,aB.aborted||ac().then(function(){ax=ah(aB,aL,aN)})["catch"](aN)}},aE={results:[]},aG=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aE.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=jd(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&g7(aR),ay&&aE.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aA=aL.last_seq);var aO=az&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||az&&0>=aH)&&aO?aB.complete(null,aE):setTimeout(function(){aC(aA,aG)},0)}};return aC(aB.since||0,aG),{cancel:function(){aB.aborted=!0,ax&&ax.abort()}}},ab.revsDiff=av("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:hd(al,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(ax,aw){ah(ax,{url:hd(al,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function fr(t){t.adapter("http",iM,!1),t.adapter("https",iM,!1)}function v(){this.promise=new hi(function(t){t()})}function ev(ab){var t=ab.db,ah=ab.viewName,ac=ab.map,aa=ab.reduce,af=ab.temporary,ag=ac.toString()+(aa&&aa.toString())+"undefined";if(!af&&t._cachedViews){var ad=t._cachedViews[ag];if(ad){return hi.resolve(ad)}}return t.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ah;-1===aq.indexOf("/")&&(aq=ah+"/"+ah);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(af?"temp":Z(ag));return eu(t,"_local/mrviews",al).then(function(){return t.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:t,adapter:t.adapter,mapFun:ac,reduceFun:aa};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,af||(t._cachedViews=t._cachedViews||{},t._cachedViews[ag]=aq,aq.db.once("destroyed",function(){delete t._cachedViews[ag]})),aq})})})})}function gG(ad,aa,ab,t,ac,af){return io("return ("+ad.replace(/;\s*$/,"")+");",{emit:aa,sum:ab,log:t,isArray:ac,toJSON:af})}function fY(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function iN(t){return 1===t.length&&/^1-/.test(t[0].rev)}function m(ab,t){try{ab.emit("error",t)}catch(aa){iS("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iS("error",t)}}function ar(ab,t,aa){try{return{output:t.apply(null,aa)}}catch(ac){return m(ab,ac),{error:ac}}}function fw(ab,t){var aa=i8.collate(ab.key,t.key);return 0!==aa?aa:i8.collate(ab.value,t.value)}function n(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function a1(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function M(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=fW(ac.data,ac.content_type)})})}function gD(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&M(aa),aa}}function gV(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new gb(t)}function fe(ab){for(var t=0,ah=0,ac=ab.length;ac>ah;ah++){var aa=ab[ah];if("number"!=typeof aa){if(!Array.isArray(aa)){throw gV("_sum")}t="number"==typeof t?[t]:t;for(var af=0,ag=aa.length;ag>af;af++){var ad=aa[af];if("number"!=typeof ad){throw gV("_sum")}"undefined"==typeof t[af]?t.push(ad):t[af]+=ad}}else{"number"==typeof t?t+=aa:t[0]+=aa}}return t}function iE(ad,aa,ab,t){var ac=aa[ad];"undefined"!=typeof ac&&(t&&(ac=encodeURIComponent(JSON.stringify(ac))),ab.push(ad+"="+ac))}function ae(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function ai(t){return t.group_level=ae(t.group_level),t.limit=ae(t.limit),t.skip=ae(t.skip),t}function fb(t){if(t){if("number"!=typeof t){return new br('Invalid value for integer: "'+t+'"')}if(0>t){return new br('Invalid value for positive integer: "'+t+'"')}}}function W(ab,t){var aa=ab.descending?"endkey":"startkey",ac=ab.descending?"startkey":"endkey";if("undefined"!=typeof ab[aa]&&"undefined"!=typeof ab[ac]&&i8.collate(ab[aa],ab[ac])>0){throw new br("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(t.reduce&&ab.reduce!==!1){if(ab.include_docs){throw new br("{include_docs:true} is invalid for reduce")}if(ab.keys&&ab.keys.length>1&&!ab.group&&!ab.group_level){throw new br("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=fb(ab[af]);if(ad){throw ad}})}function g8(af,ac,ah){var aa,aj=[],ag="GET";if(iE("reduce",ah,aj),iE("include_docs",ah,aj),iE("attachments",ah,aj),iE("limit",ah,aj),iE("descending",ah,aj),iE("group",ah,aj),iE("group_level",ah,aj),iE("skip",ah,aj),iE("stale",ah,aj),iE("conflicts",ah,aj),iE("startkey",ah,aj,!0),iE("start_key",ah,aj,!0),iE("endkey",ah,aj,!0),iE("end_key",ah,aj,!0),iE("inclusive_end",ah,aj),iE("key",ah,aj,!0),aj=aj.join("&"),aj=""===aj?"":"?"+aj,"undefined"!=typeof ah.keys){var ad=2000,t="keys="+encodeURIComponent(JSON.stringify(ah.keys));t.length+aj.length+1<=ad?aj+=("?"===aj[0]?"&":"?")+t:(ag="POST","string"==typeof ac?aa={keys:ah.keys}:ac.keys=ah.keys)}if("string"==typeof ac){var ab=fY(ac);return af.request({method:ag,url:"_design/"+ab[0]+"/_view/"+ab[1]+aj,body:aa}).then(gD(ah))}return aa=aa||{},Object.keys(ac).forEach(function(ak){Array.isArray(ac[ak])?aa[ak]=ac[ak]:aa[ak]=ac[ak].toString()}),af.request({method:"POST",url:"_temp_view"+aj,body:aa}).then(gD(ah))}function iF(ab,t,aa){return new hi(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function h(t){return new hi(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function es(t){return function(aa){if(404===aa.status){return t}throw aa}}function ao(aj,ad,ak){function aa(){return iN(ab)?hi.resolve(af):ad.db.get(ah)["catch"](es(af))}function ac(am){return am.keys.length?ad.db.allDocs({keys:am.keys,include_docs:!0}):hi.resolve({rows:[]})}function al(ap,aA){for(var aw=[],az={},ax=0,au=aA.rows.length;au>ax;ax++){var aq=aA.rows[ax],ay=aq.doc;if(ay&&(aw.push(ay),az[ay._id]=!0,ay._deleted=!t[ay._id],!ay._deleted)){var am=t[ay._id];"value" in am&&(ay.value=am.value)}}var av=Object.keys(t);return av.forEach(function(aD){if(!az[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),aw.push(aB)}}),ap.keys=p(av.concat(ap.keys)),aw.push(ap),aw}var ah="_local/doc_"+aj,af={_id:ah,keys:[]},ag=ak[aj],t=ag.indexableKeysToKeyValues,ab=ag.changes;return aa().then(function(am){return ac(am).then(function(ap){return al(am,ap)})})}function iZ(ab,t,aa){var ac="_local/lastSeq";return ab.db.get(ac)["catch"](es({_id:ac,seq:0})).then(function(af){var ad=Object.keys(t);return hi.all(ad.map(function(ag){return ao(ag,ab,t)})).then(function(ah){var ag=y(ah);return af.seq=aa,ag.push(af),ab.db.bulkDocs({docs:ag})})})}function F(ab){var t="string"==typeof ab?ab:ab.name,aa=jr[t];return aa||(aa=jr[t]=new v),aa}function fj(t){return iG(F(t),function(){return s(t)})()}function s(af){function ac(am,ak){var al={id:aj._id,key:i8.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=i8.normalizeKey(ak)),aa.push(al)}function ah(ak,al){return function(){return iZ(af,ak,al)}}var aa,aj,ag;if("function"==typeof af.mapFun&&2===af.mapFun.length){var ad=af.mapFun;ag=function(ak){return ad(ak,ac)}}else{ag=gG(af.mapFun.toString(),ac,fe,hp,Array.isArray,JSON.parse)}var t=af.seq||0,ab=new v;return new hi(function(ap,ak){function al(){ab.finish().then(function(){af.seq=t,ap()})}function am(){function aq(au){ak(au)}af.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:t,limit:hu}).on("complete",function(aD){var av=aD.results;if(!av.length){return al()}for(var ay={},ax=0,aA=av.length;aA>ax;ax++){var aF=av[ax];if("_"!==aF.doc._id[0]){aa=[],aj=aF.doc,aj._deleted||ar(af.sourceDB,ag,[aj]),aa.sort(fw);for(var aC,au={},aG=0,aB=aa.length;aB>aG;aG++){var az=aa[aG],aw=[az.key,az.id];0===i8.collate(az.key,aC)&&aw.push(aG);var aE=i8.toIndexableString(aw);au[aE]=az,aC=az.key}ay[aF.doc._id]={indexableKeysToKeyValues:au,changes:aF.changes}}t=aF.seq}return ab.add(ah(ay,t)),av.length<hu?al():am()}).on("error",aq)}am()})}function A(aj,ad,ak){0===ak.group_level&&delete ak.group_level;var aa,ac=ak.group||ak.group_level;aa=jz[aj.reduceFun]?jz[aj.reduceFun]:gG(aj.reduceFun.toString(),null,fe,hp,Array.isArray,JSON.parse);var al=[],ah=isNaN(ak.group_level)?Number.POSITIVE_INFINITY:ak.group_level;ad.forEach(function(aq){var am=al[al.length-1],ap=ac?aq.key:null;return ac&&Array.isArray(ap)&&(ap=ap.slice(0,ah)),am&&0===i8.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void al.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ad=[];for(var af=0,ag=al.length;ag>af;af++){var t=al[af],ab=ar(aj.sourceDB,aa,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof gb){throw ab.error}ad.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:n(ad,ak.limit,ak.skip)}}function gJ(aa,t){return iG(F(aa),function(){return i(aa,t)})()}function i(t,al){function ah(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return aj=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=i8.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function ak(aq){var au;if(au=af?A(t,aq,al):{total_rows:aj,offset:ap,rows:aq},al.include_docs){var av=p(aq.map(a1));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:al.conflicts,attachments:al.attachments,binary:al.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=a1(ay),az=aw["$"+aA];az&&(ay.doc=az)}),au})}return au}var aj,af=t.reduceFun&&al.reduce!==!1,ap=al.skip||0;if("undefined"==typeof al.keys||al.keys.length||(al.limit=0,delete al.keys),"undefined"!=typeof al.keys){var ad=al.keys,am=ad.map(function(au){var aq={startkey:i8.toIndexableString([au]),endkey:i8.toIndexableString([au,{}])};return ah(aq)});return hi.all(am).then(y).then(ak)}var aa={descending:al.descending};if(al.start_key&&(al.startkey=al.start_key),al.end_key&&(al.endkey=al.end_key),"undefined"!=typeof al.startkey&&(aa.startkey=al.descending?i8.toIndexableString([al.startkey,{}]):i8.toIndexableString([al.startkey])),"undefined"!=typeof al.endkey){var ac=al.inclusive_end!==!1;al.descending&&(ac=!ac),aa.endkey=i8.toIndexableString(ac?[al.endkey,{}]:[al.endkey])}if("undefined"!=typeof al.key){var ag=i8.toIndexableString([al.key]),ab=i8.toIndexableString([al.key,{}]);aa.descending?(aa.endkey=ag,aa.startkey=ab):(aa.startkey=ag,aa.endkey=ab)}return af||("number"==typeof al.limit&&(aa.limit=al.limit),aa.skip=ap),ah(aa).then(ak)}function gm(t){return t.request({method:"POST",url:"_view_cleanup"})}function N(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(af){var ah=fY(af),ag="_design/"+ah[0],ad=ah[1];aa[ag]=aa[ag]||{},aa[ag][ad]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(af){var ad={};af.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ad[au]=ad[au]||am})})});var ag=Object.keys(ad).filter(function(aj){return !ad[aj]}),ah=ag.map(function(aj){return iG(F(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hi.all(ah).then(function(){return{ok:!0}})})},es({ok:!0}))}function u(aa,ad,ab){if("http"===aa.type()){return g8(aa,ad,ab)}if("function"==typeof aa._query){return iF(aa,ad,ab)}if("string"!=typeof ad){W(ab,ad);var ah={db:aa,viewName:"temp_view/temp_view",map:ad.map,reduce:ad.reduce,temporary:!0};return hb.add(function(){return ev(ah).then(function(ak){function aj(){return ak.db.destroy()}return U(fj(ak).then(function(){return gJ(ak,ab)}),aj)})}),hb.finish()}var t=ad,ag=fY(t),ac=ag[0],af=ag[1];return aa.get("_design/"+ac).then(function(al){var ak=al.views&&al.views[af];if(!ak||"string"!=typeof ak.map){throw new X("ddoc "+ac+" has no view named "+af)}W(ab,ak);var aj={db:aa,viewName:t,map:ak.map,reduce:ak.reduce};return ev(aj).then(function(am){return"ok"===ab.stale||"update_after"===ab.stale?("update_after"===ab.stale&&w.nextTick(function(){fj(am)}),gJ(am,ab)):fj(am).then(function(){return gJ(am,ab)})})})}function br(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,br)}catch(t){}}function X(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,X)}catch(t){}}function gb(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gb)}catch(t){}}function Q(t){return/^1-/.test(t)}function hI(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function h4(ab,t){var aa=Object.keys(t._attachments);return hi.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function gc(ad,aa,ab){var t="http"===aa.type()&&"http"!==ad.type(),ac=Object.keys(ab._attachments);return t?ad.get(ab._id).then(function(af){return hi.all(ac.map(function(ag){return hI(af,ab,ag)?aa.getAttachment(ab._id,ag):ad.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return h4(aa,ab)}):h4(aa,ab)}function jm(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function G(ak,af,al,ac){function aa(){var am=jm(al);if(am.docs.length){return ak.bulkGet(am).then(function(ap){if(ac.cancelled){throw new Error("cancelled")}return hi.all(ap.results.map(function(aq){return hi.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?gc(af,ak,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(y(aq).filter(Boolean))})})}}function aj(am){return am._attachments&&Object.keys(am._attachments).length>0}function ah(am){return ak.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ac.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&Q(aq.value.rev)&&!aj(aq.doc)&&(t.push(aq.doc),delete al[aq.id])})})}function ad(){var am=Object.keys(al).filter(function(aq){var ap=al[aq].missing;return 1===ap.length&&Q(ap[0])});return am.length>0?ah(am):void 0}function ag(){return{ok:ab,docs:t}}al=ii(al);var t=[],ab=!0;return hi.resolve().then(ad).then(aa).then(ag)}function ij(ad,aa,ab,t,ac){return ad.get(aa)["catch"](function(af){if(404===af.status){return"http"===ad.type()&&g9(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:t,_id:aa,history:[],replicator:gU,version:hj}}throw af}).then(function(af){return ac.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==t}),af.history.unshift({last_seq:ab,session_id:t}),af.history=af.history.slice(0,ia),af.version=hj,af.replicator=gU,af.session_id=t,af.last_seq=ab,ad.put(af)["catch"](function(ag){if(409===ag.status){return ij(ad,aa,ab,t,ac)}throw ag}))})}function iA(ab,t,aa,ac){this.src=ab,this.target=t,this.id=aa,this.returnValue=ac}function i7(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:cr(aa.history,t.history)}function cr(ab,t){var ah=ab[0],ac=ab.slice(1),aa=t[0],af=t.slice(1);if(!ah||0===t.length){return{last_seq:iK,history:[]}}var ag=ah.session_id;if(k(ag,t)){return{last_seq:ah.last_seq,history:ab}}var ad=aa.session_id;return k(ad,ac)?{last_seq:aa.last_seq,history:af}:cr(ac,af)}function k(ab,t){var aa=t[0],ac=t.slice(1);return ab&&0!==t.length?ab===aa.session_id?!0:k(ab,ac):!1}function iQ(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function gw(ab,t,aa,ac){return ab.retry===!1?(t.emit("error",aa),void t.removeAllListeners()):("function"!=typeof ab.back_off_function&&(ab.back_off_function=h2),t.emit("requestError",aa),"active"!==t.state&&"pending"!==t.state||(t.emit("paused",aa),t.state="stopped",t.once("active",function(){ab.current_back_off=fk})),ab.current_back_off=ab.current_back_off||fk,ab.current_back_off=ab.back_off_function(ab.current_back_off),void setTimeout(ac,ab.current_back_off))}function x(t){return Object.keys(t).sort(i8.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function gR(ac,t,ag){var ad=ag.doc_ids?ag.doc_ids.sort(i8.collate):"",ab=ag.filter?ag.filter.toString():"",aa="",af="";return ag.filter&&ag.query_params&&(aa=JSON.stringify(x(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hi.all([ac.id(),t.id()]).then(function(ah){var aj=ah[0]+ah[1]+ab+af+aa+ad;return new hi(function(ak){ci(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function fs(aC,aq,aa,ag,ab){function aM(){return aG?hi.resolve():gR(aC,aq,aa).then(function(aS){av=aS,aG=new iA(aC,aq,av,ag)})}function ah(){if(ak=[],0!==aE.docs.length){var aS=aE.docs;return aq.bulkDocs({docs:aS,new_edits:!1}).then(function(aU){if(ag.cancelled){throw ac(),new Error("cancelled")}var aX=[],aV={};aU.forEach(function(aY){aY.error&&(ab.doc_write_failures++,aX.push(aY),aV[aY.id]=aY)}),aD=aD.concat(aX),ab.docs_written+=aE.docs.length-aX.length;var aW=aX.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aV[aZ._id];aY?ag.emit("denied",ii(aY)):ak.push(aZ)}),aW.length>0){var aT=new Error("bulkDocs error");throw aT.other_errors=aX,aL("target.bulkDocs failed to write docs",aT),new Error("bulkWrite partial failure")}},function(aT){throw ab.doc_write_failures+=aS.length,aT})}}function ap(){if(aE.error){throw new Error("There was a problem getting docs.")}ab.last_seq=aN=aE.seq;var aS=ii(ab);return ak.length&&(aS.docs=ak,ag.emit("change",aS)),aJ=!0,aG.writeCheckpoint(aE.seq,aB).then(function(){if(aJ=!1,ag.cancelled){throw ac(),new Error("cancelled")}aE=void 0,aQ()})["catch"](au)}function az(){var aS={};return aE.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aq.revsDiff(aS).then(function(aT){if(ag.cancelled){throw ac(),new Error("cancelled")}aE.diffs=aT})}function aH(){return G(aC,aq,aE.diffs,ag).then(function(aS){aE.error=!aS.ok,aS.docs.forEach(function(aT){delete aE.diffs[aT._id],ab.docs_read++,aE.docs.push(aT)})})}function aP(){if(!ag.cancelled&&!aE){if(0===aO.length){return void ax(!0)}aE=aO.shift(),az().then(aH).then(ah).then(ap).then(aP)["catch"](function(aS){aL("batch processing terminated with error",aS)})}}function ax(aS){return 0===ad.changes.length?void (0!==aO.length||aE||((al&&aR.live||aj)&&(ag.state="pending",ag.emit("paused")),aj&&ac())):void ((aS||aj||ad.changes.length>=ay)&&(aO.push(ad),ad={seq:0,changes:[],docs:[]},"pending"!==ag.state&&"stopped"!==ag.state||(ag.state="active",ag.emit("active")),aP()))}function aL(aT,aS){aI||(aS.message||(aS.message=aT),ab.ok=!1,ab.status="aborting",ab.errors.push(aS),aD=aD.concat(aS),aO=[],ad={seq:0,changes:[],docs:[]},ac())}function ac(){if(!(aI||ag.cancelled&&(ab.status="cancelled",aJ))){ab.status=ab.status||"complete",ab.end_time=new Date,ab.last_seq=aN,aI=!0;var aT=aD.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aD.pop();aD.length>0&&(aS.other_errors=aD),aS.result=ab,gw(aa,ag,aS,function(){fs(aC,aq,aa,ag)})}else{ab.errors=aD,ag.emit("complete",ab),ag.removeAllListeners()}}}function aA(aT){if(ag.cancelled){return ac()}var aS=jd(aa)(aT);aS&&(ad.seq=aT.seq,ad.changes.push(aT),ax(0===aO.length&&aR.live))}function t(aT){if(am=!1,ag.cancelled){return ac()}if(aT.results.length>0){aR.since=aT.last_seq,aQ(),ax(!0)}else{var aS=function(){al?(aR.live=!0,aQ()):aj=!0,ax(!0)};aE||0!==aT.results.length?aS():(aJ=!0,aG.writeCheckpoint(aT.last_seq,aB).then(function(){aJ=!1,ab.last_seq=aN=aT.last_seq,aS()})["catch"](au))}}function af(aS){return am=!1,ag.cancelled?ac():void aL("changes rejected",aS)}function aQ(){function aU(){aS.cancel()}function aT(){ag.removeListener("cancel",aU)}if(!am&&!aj&&aO.length<aw){am=!0,ag._changes&&(ag.removeListener("cancel",ag._abortChanges),ag._changes.cancel()),ag.once("cancel",aU);var aS=aC.changes(aR).on("change",aA);aS.then(aT,aT),aS.then(t)["catch"](af),aa.retry&&(ag._changes=aS,ag._abortChanges=aU)}}function aK(){aM().then(function(){return ag.cancelled?void ac():aG.getCheckpoint().then(function(aS){aN=aS,aR={since:aN,limit:ay,batch_size:ay,style:"all_docs",doc_ids:aF,return_docs:!0},aa.filter&&("string"!=typeof aa.filter?aR.include_docs=!0:aR.filter=aa.filter),"heartbeat" in aa&&(aR.heartbeat=aa.heartbeat),"timeout" in aa&&(aR.timeout=aa.timeout),aa.query_params&&(aR.query_params=aa.query_params),aa.view&&(aR.view=aa.view),aQ()})})["catch"](function(aS){aL("getCheckpoint rejected with ",aS)})}function au(aS){throw aJ=!1,aL("writeCheckpoint completed with error",aS),aS}var aE,av,aG,aO=[],ad={seq:0,changes:[],docs:[]},aJ=!1,aj=!1,aI=!1,aN=0,al=aa.continuous||aa.live||!1,ay=aa.batch_size||100,aw=aa.batches_limit||10,am=!1,aF=aa.doc_ids,aD=[],ak=[],aB=ex();ab=ab||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aR={};return ag.ready(aC,aq),ag.cancelled?void ac():(ag._addedListeners||(ag.once("cancel",ac),"function"==typeof aa.complete&&(ag.once("error",aa.complete),ag.once("complete",function(aS){aa.complete(null,aS)})),ag._addedListeners=!0),void ("undefined"==typeof aa.since?aK():aM().then(function(){return aJ=!0,aG.writeCheckpoint(aa.since,aB)}).then(function(){return aJ=!1,ag.cancelled?void ac():(aN=aa.since,void aK())})["catch"](au)))}function h5(){gp.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hi(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function ho(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function gg(ac,t,ag,ad){if("function"==typeof ag&&(ad=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gh(h7,"`doc_ids` filter parameter is not a list.")}ag.complete=ad,ag=ii(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ab=new h5(ag),aa=ho(ac,ag),af=ho(t,ag);return fs(aa,af,ag,ab),ab}function he(ab,t,aa,ac){return"function"==typeof aa&&(ac=aa,aa={}),"undefined"==typeof aa&&(aa={}),aa=ii(aa),aa.PouchConstructor=aa.PouchConstructor||this,ab=ho(ab,aa),t=ho(t,aa),new gP(ab,t,aa,ac)}function gP(ap,af,ad,al){function ag(ay){t.emit("change",{direction:"pull",change:ay})}function aa(ay){t.emit("change",{direction:"push",change:ay})}function ah(ay){t.emit("denied",{direction:"push",doc:ay})}function ac(ay){t.emit("denied",{direction:"pull",doc:ay})}function av(){t.pushPaused=!0,t.pullPaused&&t.emit("paused")}function ak(){t.pullPaused=!0,t.pushPaused&&t.emit("paused")}function aq(){t.pushPaused=!1,t.pullPaused&&t.emit("active",{direction:"push"})}function ab(){t.pullPaused=!1,t.pushPaused&&t.emit("active",{direction:"pull"})}function am(ay){return function(aC,aD){var az="change"===aC&&(aD===ag||aD===aa),aA="denied"===aC&&(aD===ac||aD===ah),aE="paused"===aC&&(aD===ak||aD===av),aB="active"===aC&&(aD===ab||aD===aq);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&t.removeAllListeners(aC))}}var t=this;this.canceled=!1;var aj=ad.push?a5.extend({},ad,ad.push):ad,aw=ad.pull?a5.extend({},ad,ad.pull):ad;this.push=gg(ap,af,aj),this.pull=gg(af,ap,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ad.live&&(this.push.on("complete",t.pull.cancel.bind(t.pull)),this.pull.on("complete",t.push.cancel.bind(t.push))),this.on("newListener",function(ay){"change"===ay?(t.pull.on("change",ag),t.push.on("change",aa)):"denied"===ay?(t.pull.on("denied",ac),t.push.on("denied",ah)):"active"===ay?(t.pull.on("active",ab),t.push.on("active",aq)):"paused"===ay&&(t.pull.on("paused",ak),t.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(t.pull.removeListener("change",ag),t.push.removeListener("change",aa)):"denied"===ay?(t.pull.removeListener("denied",ac),t.push.removeListener("denied",ah)):"active"===ay?(t.pull.removeListener("active",ab),t.push.removeListener("active",aq)):"paused"===ay&&(t.pull.removeListener("paused",ak),t.push.removeListener("paused",av))}),this.pull.on("removeListener",am("pull")),this.push.on("removeListener",am("push"));var au=hi.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return t.emit("complete",az),al&&al(null,az),t.removeAllListeners(),az},function(ay){if(t.cancel(),al?al(ay):t.emit("error",ay),t.removeAllListeners(),al){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function g1(t){t.replicate=gg,t.sync=he}var be,a5=a(9),ju=ga(a(5)),gi=ga(a(8)),iq=ga(a(10)),i5=a(14),hw=ga(a(4)),gp=a(1),io=ga(a(15)),gN=ga(a(16)),hO=ga(a(17)),i8=a(12),hi="function"==typeof Promise?Promise:iq,et=Function.prototype.toString,hK=et.call(Object),gB=ju("pouchdb:api"),je=6;if(fq()){be=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),be=!!localStorage.getItem("_pouch_check_localstorage")}catch(gW){be=!1}}gi(co,gp.EventEmitter),co.prototype.addListener=function(ac,t,ag,ad){function ab(){function ah(){af=!1}if(aa._listeners[t]){if(af){return void (af="waiting")}af=!0;var aj=gf(ad,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ad.since&&!ad.cancelled&&(ad.since=ak.seq,ad.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ab()},0),af=!1}).on("error",ah)}}if(!this._listeners[t]){var aa=this,af=!1;this._listeners[t]=ab,this.on(ac,ab)}},co.prototype.removeListener=function(aa,t){t in this._listeners&&gp.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},co.prototype.notifyLocalWindows=function(t){fq()?chrome.storage.local.set({dbName:t}):fd()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},co.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},gi(dt,Error),dt.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hS=new dt({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hx=new dt({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ew=new dt({status:404,error:"not_found",reason:"missing"}),jC=new dt({status:409,error:"conflict",reason:"Document update conflict"}),hg=new dt({status:400,error:"invalid_id",reason:"_id field must contain a string"}),hl=new dt({status:412,error:"missing_id",reason:"_id is required for puts"}),ez=new dt({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hc=new dt({status:412,error:"precondition_failed",reason:"Database not open"}),hM=new dt({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),gx=new dt({status:500,error:"badarg",reason:"Some query argument is invalid"}),g3=new dt({status:400,error:"invalid_request",reason:"Request was invalid"}),hy=new dt({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),fz=new dt({status:500,error:"doc_validation",reason:"Bad special document member"}),h7=new dt({status:400,error:"bad_request",reason:"Something wrong with the request"}),D=new dt({status:400,error:"bad_request",reason:"Document must be a JSON object"}),i4=new dt({status:404,error:"not_found",reason:"Database not found"}),fn=new dt({status:500,error:"indexed_db_went_bad",reason:"unknown"}),fV=new dt({status:500,error:"web_sql_went_bad",reason:"unknown"}),hG=new dt({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),ik=new dt({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),dn=new dt({status:400,error:"bad_request",reason:"Invalid rev format"}),fo=new dt({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),gT=new dt({status:412,error:"missing_stub"}),iX=new dt({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[hS,hx,ew,jC,hg,hl,ez,hc,hM,gx,g3,hy,fz,h7,D,i4,fV,hG,ik,dn,fo,gT,fn,iX],h3=function(ab,t,aa){var ac=hY.filter(function(ad){return ad[ab]===t});return aa&&ac.filter(function(ad){return ad.message===aa})[0]||ac[0]},fX=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ht="queryKey",at=/(?:^|&)([^&=]*)=?([^&]*)/g,ei=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,iV="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");gi(di,gp.EventEmitter),di.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},di.prototype.doChanges=function(ad){var aa=this,ab=ad.complete;if(ad=ii(ad),"live" in ad&&!("continuous" in ad)&&(ad.continuous=ad.live),ad.processChange=bo,"latest"===ad.since&&(ad.since="now"),ad.since||(ad.since=0),"now"===ad.since){return void this.db.info().then(function(af){return aa.isCancelled?void ab(null,{status:"cancelled"}):(ad.since=af.update_seq,void aa.doChanges(ad))},ab)}if(ad.continuous&&"now"!==ad.since&&this.db.info().then(function(af){aa.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ad.view&&!ad.filter&&(ad.filter="_view"),ad.filter&&"string"==typeof ad.filter&&("_view"===ad.filter?ad.view=iO(ad.view):ad.filter=iO(ad.filter),"http"!==this.db.type()&&!ad.doc_ids)){return this.filterChanges(ad)}"descending" in ad||(ad.descending=!1),ad.limit=0===ad.limit?1:ad.limit,ad.complete=ab;var t=this.db._changes(ad);if(t&&"function"==typeof t.cancel){var ac=aa.cancel;aa.cancel=hw(function(af){t.cancel(),ac.apply(this,af)})}},di.prototype.filterChanges=function(ad){var aa=this,ab=ad.complete;if("_view"===ad.filter){if(!ad.view||"string"!=typeof ad.view){var t=gh(h7,"`view` filter parameter not found or invalid.");return ab(t)}var ac=iy(ad.view);this.db.get("_design/"+ac[0],function(ah,aj){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ah){return ab(hE(ah))}var ag=aj&&aj.views&&aj.views[ac[1]]&&aj.views[ac[1]].map;return ag?(ad.filter=iT(ag),void aa.doChanges(ad)):ab(gh(ew,aj.views?"missing json key: "+ac[1]:"missing json key: views"))})}else{var af=iy(ad.filter);if(!af){return aa.doChanges(ad)}this.db.get("_design/"+af[0],function(ag,aj){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ag){return ab(hE(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ad.filter=gk(ah),void aa.doChanges(ad)):ab(gh(ew,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},gi(gl,gp.EventEmitter),gl.prototype.post=jw("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(gh(D)):void this.bulkDocs({docs:[ab]},t,gF(aa))}),gl.prototype.put=jw("put",hw(function(af){function ac(){ad||(iS("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ad=!0)}var ah,aa,aj,ag,ad=!1,t=af.shift(),ab="_id" in t;if("object"!=typeof t||Array.isArray(t)){return(ag=af.pop())(gh(D))}for(;;){if(ah=af.shift(),aa=typeof ah,"string"!==aa||ab?"string"!==aa||!ab||"_rev" in t?"object"===aa?aj=ah:"function"===aa&&(ag=ah):(ac(),t._rev=ah):(ac(),t._id=ah,ab=!0),!af.length){break}}return aj=aj||{},iu(t._id),hB(t._id)&&"function"==typeof this._putLocal?t._deleted?this._removeLocal(t,ag):this._putLocal(t,ag):void this.bulkDocs({docs:[t]},aj,gF(ag))})),gl.prototype.putAttachment=jw("putAttachment",function(ac,t,ag,ad,ab){function aa(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[t]={content_type:ab,data:ad,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof ab&&(ab=ad,ad=ag,ag=null),"undefined"==typeof ab&&(ab=ad,ad=ag,ag=null),af.get(ac).then(function(ah){if(ah._rev!==ag){throw gh(jC)}return aa(ah)},function(ah){if(ah.reason===ew.message){return aa({_id:ac})}throw ah})}),gl.prototype.removeAttachment=jw("removeAttachment",function(ad,aa,ab,t){var ac=this;ac.get(ad,function(af,ag){return af?void t(af):ag._rev!==ab?void t(gh(jC)):ag._attachments?(delete ag._attachments[aa],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ac.put(ag,t)):t()})}),gl.prototype.remove=jw("remove",function(ad,aa,ab,t){var ac;"string"==typeof aa?(ac={_id:ad,_rev:aa},"function"==typeof ab&&(t=ab,ab={})):(ac=ad,"function"==typeof aa?(t=aa,ab={}):(t=ab,ab=aa)),ab=ab||{},ab.was_delete=!0;var af={_id:ac._id,_rev:ac._rev||ab.rev};return af._deleted=!0,hB(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ac,t):void this.bulkDocs({docs:[af]},ab,gF(t))}),gl.prototype.revsDiff=jw("revsDiff",function(ab,t,ah){function ac(ak,aj){ad.has(ak)||ad.set(ak,{missing:[]}),ad.get(ak).missing.push(aj)}function aa(aj,ak){var al=ab[aj].slice(0);fi(ak,function(ap,aq,av,am,aw){var au=aq+"-"+av,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==aw.status&&ac(aj,au))}),al.forEach(function(am){ac(aj,am)})}"function"==typeof t&&(ah=t,t={});var af=Object.keys(ab);if(!af.length){return ah(null,{})}var ag=0,ad=new i5.Map;af.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ad.set(aj,{missing:ab[aj]})}else{if(al){return ah(al)}aa(aj,am)}if(++ag===af.length){var ak={};return ad.forEach(function(ap,aq){ak[aq]=ap}),ah(null,ak)}})},this)}),gl.prototype.bulkGet=jw("bulkGet",function(aa,t){fh(this,aa,t)}),gl.prototype.compactDocument=jw("compactDocument",function(ab,t,aa){var ac=this;this._getRevisionTree(ab,function(ad,ag){if(ad){return aa(ad)}var aj=ip(ag),af=[],ah=[];Object.keys(aj).forEach(function(ak){aj[ak]>t&&af.push(ak)}),fi(ag,function(al,ap,au,am,ak){var aq=ap+"-"+au;"available"===ak.status&&-1!==af.indexOf(aq)&&ah.push(aq)}),ac._doCompaction(ab,ah,aa)})}),gl.prototype.compact=jw("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&jo(aa)}),gl.prototype._compact=function(ac,t){function ag(ah){af.push(ab.compactDocument(ah.id,0))}function ad(aj){var ah=aj.last_seq;hi.all(af).then(function(){return eu(ab,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){t(null,{ok:!0})})["catch"](t)}var ab=this,aa={return_docs:!1,last_seq:ac.last_seq||0},af=[];ab.changes(aa).on("change",ag).on("complete",ad).on("error",t)},gl.prototype.get=jw("get",function(ab,t,ah){function ac(){var ak=[],aj=aa.length;return aj?void aa.forEach(function(al){af.get(ab,{rev:al,revs:t.revs,attachments:t.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ah(null,ak)})}):ah(null,ak)}if("function"==typeof t&&(ah=t,t={}),"string"!=typeof ab){return ah(gh(hg))}if(hB(ab)&&"function"==typeof this._getLocal){return this._getLocal(ab,ah)}var aa=[],af=this;if(!t.open_revs){return this._get(ab,t,function(az,ax){if(az){return ah(az)}var am=ax.doc,aB=ax.metadata,ap=ax.ctx;if(t.conflicts){var aA=h1(aB);aA.length&&(am._conflicts=aA)}if(hF(aB,am._rev)&&(am._deleted=!0),t.revs||t.revs_info){var au=gC(aB.rev_tree),aj=im(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(am._rev.split("-")[1])}),aq=aj.ids.map(function(aC){return aC.id}).indexOf(am._rev.split("-")[1])+1,aw=aj.ids.length-aq;if(aj.ids.splice(aq,aw),aj.ids.reverse(),t.revs&&(am._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),t.revs_info){var ay=aj.pos+aj.ids.length;am._revs_info=aj.ids.map(function(aC){return ay--,{rev:ay+"-"+aC.id,status:aC.opts.status}})}}if(t.attachments&&am._attachments){var av=am._attachments,al=Object.keys(av).length;if(0===al){return ah(null,am)}Object.keys(av).forEach(function(aC){this._getAttachment(am._id,aC,av[aC],{rev:am._rev,binary:t.binary,ctx:ap},function(aE,aD){var aF=am._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--al||ah(null,am)})},af)}else{if(am._attachments){for(var ak in am._attachments){am._attachments.hasOwnProperty(ak)&&(am._attachments[ak].stub=!0)}}ah(null,am)}})}if("all"===t.open_revs){this._getRevisionTree(ab,function(ak,aj){return ak?ah(ak):(aa=fS(aj).map(function(al){return al.rev}),void ac())})}else{if(!Array.isArray(t.open_revs)){return ah(gh(hM,"function_clause"))}aa=t.open_revs;for(var ag=0;ag<aa.length;ag++){var ad=aa[ag];if("string"!=typeof ad||!/^\d+-/.test(ad)){return ah(gh(dn))}}ac()}}),gl.prototype.getAttachment=jw("getAttachment",function(ad,aa,ab,t){var ac=this;ab instanceof Function&&(t=ab,ab={}),this._get(ad,ab,function(af,ag){return af?t(af):ag.doc._attachments&&ag.doc._attachments[aa]?(ab.ctx=ag.ctx,ab.binary=!0,ac._getAttachment(ad,aa,ag.doc._attachments[aa],ab,t),void 0):t(gh(ew))})}),gl.prototype.allDocs=jw("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(gh(hy,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return fg(this,ab,t)}}return this._allDocs(ab,t)}),gl.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new di(this,aa,t)},gl.prototype.close=jw("close",function(t){return this._closed=!0,this._close(t)}),gl.prototype.info=jw("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),gl.prototype.id=jw("id",function(t){return this._id(t)}),gl.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},gl.prototype.bulkDocs=jw("bulkDocs",function(ad,aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa=aa||{},Array.isArray(ad)&&(ad={docs:ad}),!ad||!ad.docs||!Array.isArray(ad.docs)){return ab(gh(hx))}for(var t=0;t<ad.docs.length;++t){if("object"!=typeof ad.docs[t]||Array.isArray(ad.docs[t])){return ab(gh(D))}}var ac;return ad.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ac=ac||ih(ag)})}),ac?ab(gh(h7,ac)):("new_edits" in aa||("new_edits" in ad?aa.new_edits=ad.new_edits:aa.new_edits=!0),aa.new_edits||"http"===this.type()||ad.docs.sort(g),hr(ad.docs),this._bulkDocs(ad,aa,function(af,ag){return af?ab(af):(aa.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ab(null,ag))}))}),gl.prototype.registerDependentDatabase=jw("registerDependentDatabase",function(ab,t){function aa(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ab]?!1:(ad.dependentDbs[ab]=!0,ad)}var ac=new this.constructor(ab,this.__opts);eu(this,"_local/_pouch_dependentDbs",aa).then(function(){t(null,{db:ac})})["catch"](t)}),gl.prototype.destroy=jw("destroy",function(ad,aa){function ab(){t._destroy(ad,function(ag,af){return ag?aa(ag):(t._destroyed=!0,t.emit("destroyed"),void aa(null,af||{ok:!0}))})}"function"==typeof ad&&(aa=ad,ad={});var t=this,ac="use_prefix" in t?t.use_prefix:!0;return"http"===t.type()?ab():void t.get("_local/_pouch_dependentDbs",function(ak,ag){if(ak){return 404!==ak.status?aa(ak):ab()}var aj=ag.dependentDbs,af=t.constructor,ah=Object.keys(aj).map(function(al){var am=ac?al.replace(new RegExp("^"+af.prefix),""):al;return new af(am,t.__opts).destroy()});hi.all(ah).then(ab,aa)})}),fa.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},fa.prototype.fail=function(t){this.failed=t,this.execute()},fa.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},fa.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},gi(gM,gl),gM.debug=ju,gM.adapters={},gM.preferredAdapters=[],gM.prefix="_pouch_";var gL=new gp.EventEmitter;jt(gM),gM.parseAdapter=function(ab,t){var ah,ac,aa=ab.match(/([a-z\-]*):\/\/(.*)/);if(aa){if(ab=/http(s?)/.test(aa[1])?aa[1]+"://"+aa[2]:aa[2],ah=aa[1],!gM.adapters[ah].valid()){throw"Invalid adapter"}return{name:ab,adapter:aa[1]}}var af="idb" in gM.adapters&&"websql" in gM.adapters&&fd()&&localStorage["_pouch__websqldb_"+gM.prefix+ab];if(t.adapter){ac=t.adapter}else{if("undefined"!=typeof t&&t.db){ac="leveldb"}else{for(var ag=0;ag<gM.preferredAdapters.length;++ag){if(ac=gM.preferredAdapters[ag],ac in gM.adapters){if(af&&"idb"===ac){iS("log",'PouchDB is downgrading "'+ab+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ah=gM.adapters[ac];var ad=ah&&"use_prefix" in ah?ah.use_prefix:!0;return{name:ad?gM.prefix+ab:ab,adapter:ac}},gM.adapter=function(ab,t,aa){t.valid()&&(gM.adapters[ab]=t,aa&&gM.preferredAdapters.push(ab))},gM.plugin=function(t){return"function"==typeof t?t(gM):Object.keys(t).forEach(function(aa){gM.prototype[aa]=t[aa]}),gM},gM.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=a5.extend({},aa,ad),void gM.call(this,ab,ad,ac)):new t(ab,ad,ac)}return gi(t,gM),t.preferredAdapters=gM.preferredAdapters.slice(),Object.keys(gM).forEach(function(ab){ab in t||(t[ab]=gM[ab])}),t};var de="5.4.4";gM.version=de;var iB,q=go(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=go(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),fm=function(t){return atob(t)},gu=function(t){return btoa(t)},bt=gE.setImmediate||gE.setTimeout,iU=32768,gv=5,g2="document-store",h8="by-sequence",iR="attach-store",gr="attach-seq-store",fp="meta-store",f="local-store",jf="detect-blob-support",il={running:!1,queue:[]},hQ=new i5.Map,i9=new co,hm=new i5.Map;S.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var en=7,ie=gn("document-store"),a6=gn("by-sequence"),dr=gn("attach-store"),gS=gn("local-store"),ir=gn("metadata-store"),iL=gn("attach-seq-store"),gH=new i5.Map,ff=new co,jp=1,T="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+a6+" (seq, deleted)",gq="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+a6+" (doc_id, rev)",i0="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+ie+" (winningseq)",jb="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+iL+" (seq)",o="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+iL+" (digest, seq)",jh=a6+".seq = "+ie+".winningseq",C=a6+".seq AS seq, "+a6+".deleted AS deleted, "+a6+".json AS data, "+a6+".rev AS rev, "+ie+".json AS metadata";iW.valid=i1,iW.use_prefix=!0;var fl=jE(),hP=function(){},hV=25,hh=50,hJ={},gZ=1800,ic=ju("pouchdb:http");iM.valid=function(){return !0},v.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},v.prototype.finish=function(){return this.promise};var K=function(aa,t){return t&&aa.then(function(ab){w.nextTick(function(){t(null,ab)})},function(ab){w.nextTick(function(){t(ab)})}),aa},a2=function(t){return hw(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&K(ab,aa),ab})},U=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},iG=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},p=function(ad){for(var aa={},ab=0,t=ad.length;t>ab;ab++){aa["$"+ad[ab]]=!0}var ac=Object.keys(aa),af=new Array(ac.length);for(ab=0,t=ac.length;t>ab;ab++){af[ab]=ac[ab].substring(1)}return af},jr={},hb=new v,hu=50,hp=iS.bind(null,"log"),jz={_sum:function(aa,t){return fe(t)},_count:function(aa,t){return t.length},_stats:function(ab,t){function aa(ag){for(var ac=0,ad=0,ah=ag.length;ah>ad;ad++){var af=ag[ad];ac+=af*af}return ac}return{sum:fe(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},h9=a2(function(){var t=this;return"http"===t.type()?gm(t):"function"==typeof t._viewCleanup?h(t):N(t)}),hC=function(ad,aa,ab){"function"==typeof aa&&(ab=aa,aa={}),aa=aa?ai(aa):{},"function"==typeof ad&&(ad={map:ad});var t=this,ac=hi.resolve().then(function(){return u(t,ad,aa)});return K(ac,ab),ac};gi(br,Error),gi(X,Error),gi(gb,Error);var jj={query:hC,viewCleanup:h9},hj=1,gU="pouchdb",ia=5,iK=0;iA.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},iA.prototype.updateTarget=function(aa,t){return ij(this.target,this.id,aa,t,this.returnValue)},iA.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?hi.resolve(!0):ij(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(iQ(ac)){return aa.readOnlySource=!0,!0}throw ac})};var iY={undefined:function(aa,t){return 0===i8.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return i7(t,aa).last_seq}};iA.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hi.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return iK}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in iY?iY[ab](aa,ac):iK},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:iK}).then(function(){return iK},function(ac){return iQ(ac)?(t.readOnlySource=!0,aa.last_seq):iK})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return iK})};var fk=0;gi(h5,gp.EventEmitter),h5.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},h5.prototype.ready=function(ad,aa){function ab(){ac.cancel()}function t(){ad.removeListener("destroyed",ab),aa.removeListener("destroyed",ab)}var ac=this;ac._readyCalled||(ac._readyCalled=!0,ad.once("destroyed",ab),aa.once("destroyed",ab),ac.once("complete",t))},gi(gP,gp.EventEmitter),gP.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},gM.plugin(jv).plugin(an).plugin(fr).plugin(jj).plugin(g1),b.exports=gM}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var g="color: "+this.color;h=[h[0],g,"color: inherit"].concat(Array.prototype.slice.call(h,1));var f=0,j=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),h.splice(j,0,g),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(n,b,s){function u(){return s.colors[o++%s.colors.length]}function t(g){function j(){}function h(){var m=h,w=+new Date,l=w-(i||w);m.diff=l,m.prev=i,m.curr=w,i=w,null==m.useColors&&(m.useColors=s.useColors()),null==m.color&&m.useColors&&(m.color=u());var q=Array.prototype.slice.call(arguments);q[0]=s.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=s.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof s.formatArgs&&(q=s.formatArgs.apply(m,q));var p=h.log||s.log||console.log.bind(console);p.apply(m,q)}j.enabled=!1,h.enabled=!0;var k=s.enabled(g)?h:j;return k.namespace=g,k}function r(h){s.save(h);for(var g=(h||"").split(/[\s,]+/),j=g.length,k=0;j>k;k++){g[k]&&(h=g[k].replace(/\*/g,".*?"),"-"===h[0]?s.skips.push(new RegExp("^"+h.substr(1)+"$")):s.names.push(new RegExp("^"+h+"$")))}}function f(){s.enable("")}function a(g){var j,h;for(j=0,h=s.skips.length;h>j;j++){if(s.skips[j].test(g)){return !1}}for(j=0,h=s.names.length;h>j;j++){if(s.names[j].test(g)){return !0}}return !1}function e(g){return g instanceof Error?g.stack||g.message:g}s=b.exports=t,s.coerce=e,s.disable=f,s.enable=r,s.enabled=a,s.humanize=n(11),s.names=[],s.skips=[],s.formatters={};var i,o=0},{11:11}],7:[function(a,b,e){(function(i){function r(){l=!0;for(var h,j,g=o.length;g;){for(j=o,o=[],h=-1;++h<g;){j[h]()}g=o.length}l=!1}function x(g){1!==o.push(g)||l||u()}var u,n=i.MutationObserver||i.WebKitMutationObserver;if(n){var f=0,y=new n(r),z=i.document.createTextNode("");y.observe(z,{characterData:!0}),u=function(){z.data=f=++f%2}}else{if(i.setImmediate||"undefined"==typeof i.MessageChannel){u="document" in i&&"onreadystatechange" in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){r(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(r,0)}}else{var s=new i.MessageChannel;s.port1.onmessage=r,u=function(){s.port2.postMessage(0)}}}var l,o=[];b.exports=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(f,u,o){function s(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=b,this.queue=[],this.outcome=void 0,g!==s&&y(this,g)}function m(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function a(j,k,g){t(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function h(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(g,k){function w(A){x||(x=!0,K.reject(g,A))}function j(A){x||(x=!0,K.resolve(g,A))}function q(){k(j,w)}var x=!1,z=r(q);"error"===z.status&&w(z.value)}function r(g,k){var q={};try{q.value=g(k),q.status="success"}catch(j){q.status="error",q.value=j}return q}function i(g){return g instanceof this?g:K.resolve(new this(s),g)}function n(g){var j=new this(s);return K.reject(j,g)}function e(x){function j(E,D){function C(F){A[D]=F,++w!==g||z||(z=!0,K.resolve(q,A))}B.resolve(E).then(C,function(F){z||(z=!0,K.reject(q,F))})}var B=this;if("[object Array]"!==Object.prototype.toString.call(x)){return this.reject(new TypeError("must be an array"))}var g=x.length,z=!1;if(!g){return this.resolve([])}for(var A=new Array(g),w=0,k=-1,q=new this(s);++k<g;){j(x[k],k)}return q}function l(g){function k(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(j,B))},function(B){x||(x=!0,K.reject(j,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var q=g.length,x=!1;if(!q){return this.resolve([])}for(var z=-1,j=new this(s);++z<q;){k(g[z])}return j}var t=f(7),K={},L=["REJECTED"],p=["FULFILLED"],b=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(j,k){if("function"!=typeof j&&this.state===p||"function"!=typeof k&&this.state===L){return this}var q=new this.constructor(s);if(this.state!==b){var g=this.state===p?j:k;a(q,g,this.outcome)}else{this.queue.push(new m(q,j,k))}return q},m.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},m.prototype.otherCallFulfilled=function(g){a(this.promise,this.onFulfilled,g)},m.prototype.callRejected=function(g){K.reject(this.promise,g)},m.prototype.otherCallRejected=function(g){a(this.promise,this.onRejected,g)},K.resolve=function(j,w){var q=r(h,w);if("error"===q.status){return K.reject(j,q.value)}var k=q.value;if(k){y(j,k)}else{j.state=p,j.outcome=w;for(var g=-1,x=j.queue.length;++g<x;){j.queue[g].callFulfilled(w)}}return j},K.reject=function(g,k){g.state=L,g.outcome=k;for(var q=-1,j=g.queue.length;++q<j;){g.queue[q].callRejected(k)}return g},v.resolve=i,v.reject=n,v.all=e,v.race=l},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(o,r,l){function b(g){if(null!==g){switch(typeof g){case"boolean":return g?1:0;case"number":return n(g);case"string":return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var q=Array.isArray(g),j=q?g:Object.keys(g),w=-1,m=j.length,v="";if(q){for(;++w<m;){v+=l.toIndexableString(j[w])}}else{for(;++w<m;){var k=j[w];v+=l.toIndexableString(k)+l.toIndexableString(g[k])}}return v}}return""}function D(k,y){var q,w=y,v="1"===k[y];if(v){q=0,y++}else{var m="0"===k[y];y++;var g="",x=k.substring(y,y+i),z=parseInt(x,10)+t;for(m&&(z=-z),y+=i;;){var j=k[y];if("\x00"===j){break}g+=j,y++}g=g.split("."),q=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),m&&(q-=10),0!==z&&(q=parseFloat(q+"e"+z))}return{num:q,length:y-w}}function h(j,w){var q=j.pop();if(w.length){var v=w[w.length-1];q===v.element&&(w.pop(),v=w[w.length-1]);var m=v.element,g=v.index;if(Array.isArray(m)){m.push(q)}else{if(g===j.length-2){var k=j.pop();m[k]=q}else{j.push(q)}}}}function s(q,j){for(var g=Math.min(q.length,j.length),m=0;g>m;m++){var k=l.collate(q[m],j[m]);if(0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(g,q){for(var j=Object.keys(g),w=Object.keys(q),m=Math.min(j.length,w.length),v=0;m>v;v++){var k=l.collate(j[v],w[v]);if(0!==k){return k}if(k=l.collate(g[j[v]],q[w[v]]),0!==k){return k}}return j.length===w.length?0:j.length>w.length?1:-1}function p(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function n(m){if(0===m){return"1"}var g=m.toExponential().split(/e\+?/),v=parseInt(g[1],10),x=0>m,w=x?"0":"2",q=(x?-v:v)-t,k=a.padLeft(q.toString(),"0",i);w+=f+k;var y=Math.abs(parseFloat(g[0]));x&&(y=10-y);var j=y.toFixed(20);return j=j.replace(/\.?0+$/,""),w+=f+j}var t=-324,i=3,f="",a=o(13);l.collate=function(j,m){if(j===m){return 0}j=l.normalizeKey(j),m=l.normalizeKey(m);var k=p(j),g=p(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},l.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=l.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=l.normalizeKey(m))}}}}}return g},l.toIndexableString=function(g){var j="\x00";return g=l.normalizeKey(g),p(g)+f+b(g)+j},l.parseIndexableString=function(k){for(var y=[],v=[],w=0;;){var g=k[w++];if("\x00"!==g){switch(g){case"1":y.push(null);break;case"2":y.push("1"===k[w]),w++;break;case"3":var x=D(k,w);y.push(x.num),w+=x.length;break;case"4":for(var z="";;){var j=k[w];if("\x00"===j){break}z+=j,w++}z=z.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),y.push(z);break;case"5":var m={element:[],index:y.length};y.push(m.element),v.push(m);break;case"6":var q={element:{},index:y.length};y.push(q.element),v.push(q);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}}else{if(1===y.length){return y.pop()}h(y,v)}}}},{13:13}],13:[function(h,b,e){function a(g,m,n){for(var l="",f=n-g.length;l.length<f;){l+=m}return l}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var o,f=r.length,g=n.length;for(o=0;f>o;o++){if(o===g){return 1}var i=r.charAt(o),q=n.charAt(o);if(i!==q){return q>i?-1:1}}return g>f?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(b,i,j){function e(){this.store={}}function a(g){if(this.store=new e,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}j.Map=e,j.Set=a,e.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},e.prototype.unmangle=function(f){return f.substring(1)},e.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},e.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},e.prototype.has=function(f){var g=this.mangle(f);return g in this.store},e.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},e.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},a.prototype.add=function(f){return this.store.set(f,!0)},a.prototype.has=function(f){return this.store.has(f)},a.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(q,g){var n,o,p,r;o=[],r=[];for(n in g){h.call(g,n)&&(p=g[n],"this"!==n&&(o.push(n),r.push(p)))}return Function.apply(null,f.call(o).concat([q])).apply(g["this"],r)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(m){function o(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function u(j,w,k,q,A,z,x){return o(w&k|~w&q,j,w,A,z,x)}function l(j,w,k,q,A,z,x){return o(w&q|k&~q,j,w,A,z,x)}function Q(j,w,k,q,A,z,x){return o(w^k^q,j,w,A,z,x)}function r(j,w,k,q,A,z,x){return o(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=u(z,k,x,q,w[0],7,-680876936),q=u(q,z,k,x,w[1],12,-389564586),x=u(x,q,z,k,w[2],17,606105819),k=u(k,x,q,z,w[3],22,-1044525330),z=u(z,k,x,q,w[4],7,-176418897),q=u(q,z,k,x,w[5],12,1200080426),x=u(x,q,z,k,w[6],17,-1473231341),k=u(k,x,q,z,w[7],22,-45705983),z=u(z,k,x,q,w[8],7,1770035416),q=u(q,z,k,x,w[9],12,-1958414417),x=u(x,q,z,k,w[10],17,-42063),k=u(k,x,q,z,w[11],22,-1990404162),z=u(z,k,x,q,w[12],7,1804603682),q=u(q,z,k,x,w[13],12,-40341101),x=u(x,q,z,k,w[14],17,-1502002290),k=u(k,x,q,z,w[15],22,1236535329),z=l(z,k,x,q,w[1],5,-165796510),q=l(q,z,k,x,w[6],9,-1069501632),x=l(x,q,z,k,w[11],14,643717713),k=l(k,x,q,z,w[0],20,-373897302),z=l(z,k,x,q,w[5],5,-701558691),q=l(q,z,k,x,w[10],9,38016083),x=l(x,q,z,k,w[15],14,-660478335),k=l(k,x,q,z,w[4],20,-405537848),z=l(z,k,x,q,w[9],5,568446438),q=l(q,z,k,x,w[14],9,-1019803690),x=l(x,q,z,k,w[3],14,-187363961),k=l(k,x,q,z,w[8],20,1163531501),z=l(z,k,x,q,w[13],5,-1444681467),q=l(q,z,k,x,w[2],9,-51403784),x=l(x,q,z,k,w[7],14,1735328473),k=l(k,x,q,z,w[12],20,-1926607734),z=Q(z,k,x,q,w[5],4,-378558),q=Q(q,z,k,x,w[8],11,-2022574463),x=Q(x,q,z,k,w[11],16,1839030562),k=Q(k,x,q,z,w[14],23,-35309556),z=Q(z,k,x,q,w[1],4,-1530992060),q=Q(q,z,k,x,w[4],11,1272893353),x=Q(x,q,z,k,w[7],16,-155497632),k=Q(k,x,q,z,w[10],23,-1094730640),z=Q(z,k,x,q,w[13],4,681279174),q=Q(q,z,k,x,w[0],11,-358537222),x=Q(x,q,z,k,w[3],16,-722521979),k=Q(k,x,q,z,w[6],23,76029189),z=Q(z,k,x,q,w[9],4,-640364487),q=Q(q,z,k,x,w[12],11,-421815835),x=Q(x,q,z,k,w[15],16,530742520),k=Q(k,x,q,z,w[2],23,-995338651),z=r(z,k,x,q,w[0],6,-198630844),q=r(q,z,k,x,w[7],10,1126891415),x=r(x,q,z,k,w[14],15,-1416354905),k=r(k,x,q,z,w[5],21,-57434055),z=r(z,k,x,q,w[12],6,1700485571),q=r(q,z,k,x,w[3],10,-1894986606),x=r(x,q,z,k,w[10],15,-1051523),k=r(k,x,q,z,w[1],21,-2054922799),z=r(z,k,x,q,w[8],6,1873313359),q=r(q,z,k,x,w[15],10,-30611744),x=r(x,q,z,k,w[6],15,-1560198380),k=r(k,x,q,z,w[13],21,1309151649),z=r(z,k,x,q,w[4],6,-145523070),q=r(q,z,k,x,w[11],10,-1120210379),x=r(x,q,z,k,w[2],15,718787259),k=r(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function n(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function v(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function P(C){var k,z,A,j,x,B,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;q>=k;k+=64){g(w,n(C.substring(k-64,k)))}for(C=C.substring(k-64),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;z>k;k+=1){A[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(A[k>>2]|=128<<(k%4<<3),k>55){for(g(w,A),k=0;16>k;k+=1){A[k]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),B=parseInt(j[1],16)||0,A[14]=x,A[15]=B,g(w,A),w}function O(C){var B,z,A,j,x,k,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(B=64;q>=B;B+=64){g(w,v(C.subarray(B-64,B)))}for(C=q>B-64?C.subarray(B-64):new Uint8Array(0),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=0;z>B;B+=1){A[B>>2]|=C[B]<<(B%4<<3)}if(A[B>>2]|=128<<(B%4<<3),B>55){for(g(w,A),B=0;16>B;B+=1){A[B]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,A[14]=x,A[15]=k,g(w,A),w}function s(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function y(j){var k;for(k=0;k<j.length;k+=1){j[k]=s(j[k])}return j.join("")}function p(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function t(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==y(P("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(q,C){var B,D,x,w,k=this.byteLength,A=j(q,k),z=k;return C!==m&&(z=j(C,k)),A>z?new ArrayBuffer(0):(B=z-A,D=new ArrayBuffer(B),x=new Uint8Array(D),w=new Uint8Array(this,A,B),x.set(w),D)}}(),t.prototype.append=function(j){return this.appendBinary(p(j)),this},t.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,n(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},t.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},t.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},t.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},t.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},t.hash=function(j,k){return t.hashBinary(p(j),k)},t.hashBinary=function(j,w){var q=P(j),k=y(q);return w?e(k):k},t.ArrayBuffer=function(){this.reset()},t.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,v(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},t.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.ArrayBuffer.prototype.getState=function(){var j=t.prototype.getState.call(this);return j.buff=S(j.buff),j},t.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),t.prototype.setState.call(this,j)},t.ArrayBuffer.prototype.destroy=t.prototype.destroy,t.ArrayBuffer.prototype._finish=t.prototype._finish,t.ArrayBuffer.hash=function(j,w){var q=O(new Uint8Array(j)),k=y(q);return w?e(k):k},t})},{}],17:[function(h,b,e){function a(r,n,o){var f=o[o.length-1];r===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,i=f.index;if(Array.isArray(g)){g.push(r)}else{if(i===n.length-2){var q=n.pop();g[q]=r}else{n.push(r)}}}e.stringify=function(i){var g=[];g.push({obj:i});for(var E,f,l,n,D,s,F,t,u,o,r,C="";E=g.pop();){if(f=E.obj,l=E.prefix||"",n=E.val||"",C+=l,n){C+=n}else{if("object"!=typeof f){C+="undefined"==typeof f?null:JSON.stringify(f)}else{if(null===f){C+="null"}else{if(Array.isArray(f)){for(g.push({val:"]"}),D=f.length-1;D>=0;D--){s=0===D?"":",",g.push({obj:f[D],prefix:s})}g.push({val:"["})}else{F=[];for(t in f){f.hasOwnProperty(t)&&F.push(t)}for(g.push({val:"}"}),D=F.length-1;D>=0;D--){u=F[D],o=f[u],r=D>0?",":"",r+=JSON.stringify(u)+":",g.push({obj:o,prefix:r})}g.push({val:"{"})}}}}}return C},e.parse=function(i){for(var B,g,l,D,t,o,A,s,C,n=[],u=[],f=0;;){if(B=i[f++],"}"!==B&&"]"!==B&&"undefined"!=typeof B){switch(B){case" ":case"	":case"\n":case":":case",":break;case"n":f+=3,a(null,n,u);break;case"t":f+=3,a(!0,n,u);break;case"f":f+=4,a(!1,n,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(g="",f--;;){if(l=i[f++],!/[\d\.\-e\+]/.test(l)){f--;break}g+=l}a(parseFloat(g),n,u);break;case'"':for(D="",t=void 0,o=0;;){if(A=i[f++],'"'===A&&("\\"!==t||o%2!==1)){break}D+=A,t=A,"\\"===t?o++:o=0}a(JSON.parse('"'+D+'"'),n,u);break;case"[":s={element:[],index:n.length},n.push(s.element),u.push(s);break;case"{":C={element:{},index:n.length},n.push(C.element),u.push(C);break;default:throw new Error("unexpectedly reached end of input: "+B)}}else{if(1===n.length){return n.pop()}a(n.pop(),n,u)}}}},{}]},{},[3])(3)});