!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(f,h,c){function d(i,l){if(!h[i]){if(!f[i]){var k="function"==typeof require&&require;if(!l&&k){return k(i,!0)}if(j){return j(i,!0)}var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var m=h[i]={exports:{}};f[i][0].call(m.exports,function(n){var o=f[i][1][n];return d(o?o:n)},m,m.exports,a,f,h,c)}return h[i].exports}for(var j="function"==typeof require&&require,g=0;g<c.length;g++){d(c[g])}return d}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function c(e){return"number"==typeof e}function g(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!c(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,n,o,q,e,m;if(this._events||(this._events={}),"error"===p&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[p],h(n)){return !1}if(k(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:q=Array.prototype.slice.call(arguments,1),n.apply(this,q)}}else{if(g(n)){for(q=Array.prototype.slice.call(arguments,1),m=n.slice(),o=m.length,e=0;o>e;e++){m[e].apply(this,q)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?g(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,g(this._events[m])&&!this._events[m].warned&&(e=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(i,n){function m(){this.removeListener(i,m),e||(e=!0,n.apply(this,arguments))}if(!k(n)){throw TypeError("listener must be a function")}var e=!1;return m.listener=n,this.on(i,m),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(g(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(w,y,g){function c(){z&&q&&(z=!1,q.length?m=q.concat(m):x=-1,m.length&&d())}function d(){if(!z){var f=k(c);z=!0;for(var e=m.length;e;){for(q=m,m=[];++x<e;){q&&q[x].run()}x=-1,e=m.length}q=null,z=!1,p(f)}}function j(f,e){this.fun=f,this.array=e}function v(){}var k,p,A=y.exports={};!function(){try{k=setTimeout}catch(e){k=function(){throw new Error("setTimeout is not defined")}}try{p=clearTimeout}catch(e){p=function(){throw new Error("clearTimeout is not defined")}}}();var q,m=[],z=!1,x=-1;A.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}m.push(new j(f,e)),1!==m.length||z||k(d,0)},j.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={},A.on=v,A.addListener=v,A.once=v,A.off=v,A.removeListener=v,A.removeAllListeners=v,A.emit=v,A.binding=function(e){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(e){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},{}],3:[function(f,d,c){(function(ed,dZ){function e4(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function dg(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function bd(g){if("function"==typeof g.slice){return g.slice(0)}var i=new ArrayBuffer(g.byteLength),h=new Uint8Array(i),j=new Uint8Array(g);return h.set(j),i}function eC(g){if(g instanceof ArrayBuffer){return bd(g)}var i=g.size,h=g.type;return"function"==typeof g.slice?g.slice(0,i,h):g.webkitSlice(0,i,h)}function eX(g){var i=Object.getPrototypeOf(g);if(null===i){return !0}var h=i.constructor;return"function"==typeof h&&h instanceof h&&dw.call(h)==b6}function cm(h){var k,j,g;if(!h||"object"!=typeof h){return h}if(Array.isArray(h)){for(k=[],j=0,g=h.length;g>j;j++){k[j]=cm(h[j])}return k}if(h instanceof Date){return h.toISOString()}if(dg(h)){return eC(h)}if(!eX(h)){return h}k={};for(j in h){if(Object.prototype.hasOwnProperty.call(h,j)){var i=cm(h[j]);"undefined"!=typeof i&&(k[j]=i)}}return k}function aT(h){var g=!1;return dm(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function eK(g){return dm(function(j){j=cm(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){ed.nextTick(function(){i(n,m)})});var h=new e9(function(q,p){var n;try{var m=aT(function(r,s){r?p(r):q(s)});j.push(m),n=g.apply(l,j),n&&"function"==typeof n.then&&q(n)}catch(o){p(o)}});return k&&h.then(function(m){k(null,m)},k),h})}function c1(g,i){function h(o,m,k){if(kd.enabled){for(var n=[o._db_name,m],j=0;j<k.length-1;j++){n.push(k[j])}kd.apply(null,n);var l=k[k.length-1];k[k.length-1]=function(r,p){var q=[o._db_name,m];q=q.concat(r?["error",r]:["success",p]),kd.apply(null,q),l(r,p)}}}return eK(dm(function(j){if(this._closed){return e9.reject(new Error("database is closed"))}if(this._destroyed){return e9.reject(new Error("database is destroyed"))}var k=this;return h(k,g,j),this.taskqueue.isReady?i.apply(this,j):new e9(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[g].apply(k,j))})})}))}function eB(i,l){for(var k={},h=0,j=l.length;j>h;h++){var g=l[h];g in i&&(k[g]=i[g])}return k}function e5(g){return g}function eG(g){return[{ok:g}]}function fD(m,p,g){function s(){var w=[];n.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),g(null,{results:w})}function u(){++v===j&&s()}function i(w,y,x){n[w]={id:y,docs:x},u()}function q(){if(!(h>=l.length)){var x=Math.min(h+cl,l.length),w=l.slice(h,x);o(w,h),h+=w.length}}function o(x,w){x.forEach(function(B,z){var D=w+z,C=r[B],y=eB(C[0],["atts_since","attachments"]);y.open_revs=C.map(function(E){return E.rev}),y.open_revs=y.open_revs.filter(e5);var A=e5;0===y.open_revs.length&&(delete y.open_revs,A=eG),["revs","attachments","binary","ajax"].forEach(function(E){E in p&&(y[E]=p[E])}),m.get(B,y,function(G,E){var F;F=G?[{error:G}]:A(E),i(D,B,F),q()})})}var k=p.docs,r={};k.forEach(function(w){w.id in r?r[w.id].push(w):r[w.id]=[w]});var j=Object.keys(r).length,v=0,n=new Array(j),l=Object.keys(r),h=0;q()}function jJ(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ds(){return fI}function eE(g){jJ()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):ds()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function bq(){b9.EventEmitter.call(this),this._listeners={},eE(this)}function e0(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function bP(h,k){var j=600000;h=parseInt(h,10)||0,k=parseInt(k,10),k!==k||h>=k?k=(h||1)<<1:k+=1,k>j&&(h=j>>1,k=j);var g=Math.random(),i=k-h;return ~~(i*g+h)}function db(h){var g=0;return h||(g=2000),bP(h,g)}function bJ(h,g){e0("info","The above "+h+" is totally normal. "+g)}function d8(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function eO(g,i,h){function j(k){for(var l in g){"function"!=typeof g[l]&&(this[l]=g[l])}void 0!==h&&(this.name=h),void 0!==k&&(this.reason=k)}return j.prototype=d8.prototype,new j(i)}function eU(i){var l,k,h,j,g;return k=i.error===!0&&"string"==typeof i.name?i.name:i.error,g=i.reason,h=cu("name",k,g),i.missing||"missing"===g||"deleted"===g||"not_found"===k?h=cS:"doc_validation"===k?(h=eJ,j=g):"bad_request"===k&&h.message!==g&&(h=jR),h||(h=cu("status",i.status,g)||fG),l=eO(h,g,k),j&&(l.message=j),i.id&&(l.id=i.id),i.status&&(l.status=i.status),i.missing&&(l.missing=i.missing),l}function dE(h,k,j){try{return !h(k,j)}catch(g){var i="Filter function threw: "+g.toString();return eO(jR,i)}}function fK(g){var i={},h=g.filter&&"function"==typeof g.filter;return i.query=g.query_params,function(k){k.doc||(k.doc={});var l=h&&dE(g.filter,k.doc,i);if("object"==typeof l){return l}if(l){return !1}if(g.include_docs){if(!g.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function cO(g){for(var i=[],h=0,j=g.length;j>h;h++){i=i.concat(g[h])}return i}function bS(h){var g;if(h?"string"!=typeof h?g=eO(c2):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=eO(f7)):g=eO(cM),g){throw g}}function e3(h,g){return"listenerCount" in h?h.listenerCount(g):b9.EventEmitter.listenerCount(h,g)}function dC(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function a8(h){var g=dC(h);return g?g.join("/"):null}function bH(k){for(var i=eZ.exec(k),g={},j=14;j--;){var l=c8[j],m=i[j]||"",h=-1!==["user","password"].indexOf(l);g[l]=h?decodeURIComponent(m):m}return g[cG]={},g[c8[12]].replace(fO,function(n,o,p){o&&(g[cG][o]=p)}),g}function cZ(g,i,h){return new e9(function(j,k){g.get(i,function(l,n){if(l){if(404!==l.status){return k(l)}n={}}var m=n._rev,o=h(n);return o?(o._id=i,o._rev=m,void j(cI(g,o,h))):j({updated:!1,rev:m})})})}function cI(g,i,h){return g.put(i).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return cZ(g,i._id,h)})}function av(g){return 0|Math.random()*g}function bc(g,i){i=i||ea.length;var h="",j=-1;if(g){for(;++j<g;){h+=ea[av(i)]}return h}for(;++j<36;){switch(j){case 8:case 13:case 18:case 23:h+="-";break;case 19:h+=ea[3&av(16)|8];break;default:h+=ea[av(16)]}}return h}function dY(r){for(var n,q,o,p,g=r.rev_tree.slice();p=g.pop();){var l=p.ids,h=l[2],m=p.pos;if(h.length){for(var k=0,i=h.length;i>k;k++){g.push({pos:m+1,ids:h[k]})}}else{var s=!!l[1].deleted,j=l[0];n&&!(o!==s?o:q!==m?m>q:j>n)||(n=j,q=m,o=s)}}return q+"-"+n}function ay(k,m){for(var i,g=k.slice();i=g.pop();){for(var h=i.pos,j=i.ids,l=j[2],o=m(0===l.length,h,j[0],i.ctx,j[1]),p=0,n=l.length;n>p;p++){g.push({pos:h+1,ids:l[p],ctx:o})}}}function dT(h,g){return h.pos-g.pos}function bl(g){var i=[];ay(g,function(l,n,k,m,o){l&&i.push({rev:n+"-"+k,pos:n,opts:o})}),i.sort(dT).reverse();for(var h=0,j=i.length;j>h;h++){delete i[h].pos}return i}function jY(k){for(var i=dY(k),g=bl(k.rev_tree),j=[],l=0,m=g.length;m>l;l++){var h=g[l];h.rev===i||h.opts.deleted||j.push(h.rev)}return j}function du(h){var g=[];return ay(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function c4(r){for(var n,q=[],o=r.slice();n=o.pop();){var p=n.pos,g=n.ids,l=g[0],h=g[1],m=g[2],k=0===m.length,i=n.history?n.history.slice():[];i.push({id:l,opts:h}),k&&q.push({pos:p+1-i.length,ids:i});for(var s=0,j=m.length;j>s;s++){o.push({pos:p+1,ids:m[s],history:i})}}return q.reverse()}function ad(h,g){return h.pos-g.pos}function dd(i,l,k){for(var h,j=0,g=i.length;g>j;){h=j+g>>>1,k(i[h],l)<0?j=h+1:g=h}return j}function bK(g,i,h){var j=dd(g,i,h);g.splice(j,0,i)}function eS(i,k){for(var l,m,j=k,g=i.length;g>j;j++){var n=i[j],h=[n.id,n.opts,[]];m?(m[2].push(h),m=h):l=m=h}return l}function dy(h,g){return h[0]<g[0]?-1:1}function ap(k,m){for(var i=[{tree1:k,tree2:m}],g=!1;i.length>0;){var h=i.pop(),j=h.tree1,l=h.tree2;(j[1].status||l[1].status)&&(j[1].status="available"===j[1].status||"available"===l[1].status?"available":"missing");for(var o=0;o<l[2].length;o++){if(j[2][0]){for(var p=!1,n=0;n<j[2].length;n++){j[2][n][0]===l[2][o][0]&&(i.push({tree1:j[2][n],tree2:l[2][o]}),p=!0)}p||(g="new_branch",bK(j[2],l[2][o],dy))}else{g="new_leaf",j[2][0]=l[2][o]}}}return{conflicts:g,tree:k}}function f5(s,y,q){var o,k=[],x=!1,w=!1;if(!s.length){return{tree:[y],conflicts:"new_leaf"}}for(var A=0,j=s.length;j>A;A++){var p=s[A];if(p.pos===y.pos&&p.ids[0]===y.ids[0]){o=ap(p.ids,y.ids),k.push({pos:p.pos,ids:o.tree}),x=x||o.conflicts,w=!0}else{if(q!==!0){var n=p.pos<y.pos?p:y,v=p.pos<y.pos?y:p,u=v.pos-n.pos,z=[],i=[];for(i.push({ids:n.ids,diff:u,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],m=0,r=g.length;r>m;m++){i.push({ids:g[m],diff:h.diff-1,parent:h.ids,parentIdx:m})}}else{h.ids[0]===v.ids[0]&&z.push(h)}}var l=z[0];l?(o=ap(l.ids,v.ids),l.parent[2][l.parentIdx]=o.tree,k.push({pos:n.pos,ids:n.ids}),x=x||o.conflicts,w=!0):k.push(p)}else{k.push(p)}}}return w||k.push(y),k.sort(ad),{tree:k,conflicts:x||"internal_node"}}function kk(r,n){for(var q,o=c4(r),p={},g=0,l=o.length;l>g;g++){for(var h=o[g],m=h.ids,k=Math.max(0,m.length-n),i={pos:h.pos+k,ids:eS(m,k)},s=0;k>s;s++){var j=h.pos+s+"-"+m[s].id;p[j]=!0}q=q?f5(q,i,!0).tree:[i]}return ay(q,function(v,u,w){delete p[u+"-"+w]}),{tree:q,revs:Object.keys(p)}}function eM(h,k,j){var g=f5(h,k),i=kk(g.tree,j);return{tree:i.tree,stemmedRevs:i.revs,conflicts:g.conflicts}}function af(k,m){for(var i,g=k.slice(),h=m.split("-"),j=parseInt(h[0],10),l=h[1];i=g.pop();){if(i.pos===j&&i.ids[0]===l){return !0}for(var o=i.ids[2],p=0,n=o.length;n>p;p++){g.push({pos:i.pos+1,ids:o[p]})}}return !1}function f3(g){return g.ids}function cE(h,k){k||(k=dY(h));for(var j,g=k.substring(k.indexOf("-")+1),i=h.rev_tree.map(f3);j=i.pop();){if(j[0]===g){return !!j[1].deleted}i=i.concat(j[2])}}function bV(g){return/^_local/.test(g)}function ep(g){return d5("return "+g+";",{})}function aD(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jF(g,i){try{g.emit("change",i)}catch(h){e0("error",'Error in .on("change", function):',h)}}function ch(k,i,g){function j(){l.cancel()}b9.EventEmitter.call(this);var l=this;this.db=k,i=i?cm(i):{};var m=i.complete=aT(function(o,n){o?e3(l,"error")>0&&l.emit("error",o):l.emit("complete",n),l.removeAllListeners(),k.removeListener("destroyed",j)});g&&(l.on("complete",function(n){g(null,n)}),l.on("error",g)),k.once("destroyed",j),i.onChange=function(n){i.isCancelled||(jF(l,n),l.startSeq&&l.startSeq<=n.seq&&(l.startSeq=!1))};var h=new e9(function(o,n){i.complete=function(p,q){p?n(p):o(q)}});l.once("cancel",function(){k.removeListener("destroyed",j),i.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){m(null,n)},m),k.taskqueue.isReady?l.doChanges(i):k.taskqueue.addTask(function(){l.isCancelled?l.emit("cancel"):l.doChanges(i)})}function cp(h,k,j){var g=[{rev:h._rev}];"all_docs"===j.style&&(g=bl(k.rev_tree).map(function(l){return{rev:l.rev}}));var i={id:k.id,changes:g,doc:h};return cE(k,h._rev)&&(i.deleted=!0),j.conflicts&&(i.doc._conflicts=jY(k),i.doc._conflicts.length||delete i.doc._conflicts),i}function bC(h,g){return g>h?-1:h>g?1:0}function aY(g,i){for(var h=0;h<g.length;h++){if(i(g[h],h)===!0){return g[h]}}}function fM(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function e1(i){for(var l=0;l<i.length;l++){var k=i[l];if(k._deleted){delete k._attachments}else{if(k._attachments){for(var h=Object.keys(k._attachments),j=0;j<h.length;j++){var g=h[j];k._attachments[g]=eB(k._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function cF(h,k){var j=bC(h._id,k._id);if(0!==j){return j}var g=h._revisions?h._revisions.start:0,i=k._revisions?k._revisions.start:0;return bC(g,i)}function fP(g){var i={},h=[];return ay(g,function(l,k,m,j){var n=k+"-"+m;return l&&(i[n]=0),void 0!==j&&h.push({from:j,to:n}),n}),h.reverse(),h.forEach(function(j){void 0===i[j.from]?i[j.from]=1+i[j.to]:i[j.from]=Math.min(i[j.from],1+i[j.to])}),i}function aA(h,k,j){var g="limit" in k?k.keys.slice(k.skip,k.limit+k.skip):k.skip>0?k.keys.slice(k.skip):k.keys;if(k.descending&&g.reverse(),!g.length){return h._allDocs({limit:0},j)}var i={offset:k.skip};return e9.all(g.map(function(m){var l=cc.extend({key:m,deleted:"ok"},k);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new e9(function(o,n){h._allDocs(l,function(q,p){return q?n(q):(i.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return i.rows=l,i})}function aj(g){var i=g._compactionQueue[0],j=i.opts,h=i.callback;g.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(j.last_seq=k.last_seq),g._compact(j,function(l,m){l?h(l):h(null,m),ed.nextTick(function(){g._compactionQueue.shift(),g._compactionQueue.length&&aj(g)})})})}function d3(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function dX(){b9.EventEmitter.call(this)}function b8(){this.isReady=!1,this.failed=!1,this.queue=[]}function dv(g){g&&dZ.debug&&e0("error",g)}function e(k,i){function g(){m.emit("destroyed",l)}function j(){k.removeListener("destroyed",g),k.emit("destroyed",k)}var l=i.originalName,m=k.constructor,h=m._destructionListeners;k.once("destroyed",g),h.has(l)||h.set(l,[]),h.get(l).push(j)}function eh(k,i,g){if(!(this instanceof eh)){return new eh(k,i,g)}var j=this;if("function"!=typeof i&&"undefined"!=typeof i||(g=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),"undefined"==typeof g){g=dv}else{var l=g;g=function(){return e0("warn","Using a callback for new PouchDB()is deprecated."),l.apply(null,arguments)}}k=k||i.name,i=cm(i),delete i.name,this.__opts=i;var m=g;j.auto_compaction=i.auto_compaction,j.prefix=eh.prefix,dX.call(j),j.taskqueue=new b8;var h=new e9(function(o,q){g=function(r,s){return r?q(r):(delete s.then,void o(s))},i=cm(i);var p,n;return function(){try{if("string"!=typeof k){throw n=new Error("Missing/invalid DB name"),n.code=400,n}var r=(i.prefix||"")+k;if(p=eh.parseAdapter(r,i),i.originalName=k,i.name=p.name,i.adapter=i.adapter||p.adapter,j._adapter=i.adapter,dO("pouchdb:adapter")("Picked adapter: "+i.adapter),j._db_name=k,!eh.adapters[i.adapter]){throw n=new Error("Adapter is missing"),n.code=404,n}if(!eh.adapters[i.adapter].valid()){throw n=new Error("Invalid Adapter"),n.code=404,n}}catch(s){j.taskqueue.fail(s)}}(),n?q(n):(j.adapter=i.adapter,j.replicate={},j.replicate.from=function(r,u,s){return j.constructor.replicate(r,j,u,s)},j.replicate.to=function(r,u,s){return j.constructor.replicate(j,r,u,s)},j.sync=function(r,u,s){return j.constructor.sync(j,r,u,s)},j.replicate.sync=j.sync,void eh.adapters[i.adapter].call(j,i,function(r){return r?(j.taskqueue.fail(r),void g(r)):(e(j,i),j.emit("created",j),eh.emit("created",i.originalName),j.taskqueue.ready(j),void g(null,j))}))});h.then(function(n){m(null,n)},m),j.then=h.then.bind(h),j["catch"]=h["catch"].bind(h)}function c9(h){Object.keys(b9.EventEmitter.prototype).forEach(function(i){"function"==typeof b9.EventEmitter.prototype[i]&&(h[i]=df[i].bind(df))});var g=h._destructionListeners=new bz.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function aU(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function dk(g){if(!/^\d+\-./.test(g)){return eO(eQ)}var i=g.indexOf("-"),h=g.substring(0,i),j=g.substring(i+1);return{prefix:parseInt(h,10),id:j}}function bs(k,i){for(var g=k.start-k.ids.length+1,j=k.ids,l=[j[0],i,[]],m=1,h=j.length;h>m;m++){l=[j[m],{status:"missing"},[l]]}return[{pos:g,ids:l}]}function eg(k,m){var i,g,h,j={status:"available"};if(k._deleted&&(j.deleted=!0),m){if(k._id||(k._id=bc()),g=bc(32,16).toLowerCase(),k._rev){if(h=dk(k._rev),h.error){return h}k._rev_tree=[{pos:h.prefix,ids:[h.id,{status:"missing"},[[g,j,[]]]]}],i=h.prefix+1}else{k._rev_tree=[{pos:1,ids:[g,j,[]]}],i=1}}else{if(k._revisions&&(k._rev_tree=bs(k._revisions,j),i=k._revisions.start,g=k._revisions.ids[0]),!k._rev_tree){if(h=dk(k._rev),h.error){return h}i=h.prefix,g=h.id,k._rev_tree=[{pos:i,ids:[g,j,[]]}]}}bS(k._id),k._rev=i+"-"+g;var l={metadata:{},data:{}};for(var o in k){if(Object.prototype.hasOwnProperty.call(k,o)){var p="_"===o[0];if(p&&!bE[o]){var n=eO(eJ,o);throw n.message=eJ.message+": "+o,n}p&&!e7[o]?l.metadata[o.slice(1)]=k[o]:l.data[o]=k[o]}}return l}function eA(h){for(var k="",j=new Uint8Array(h),g=j.byteLength,i=0;g>i;i++){k+=String.fromCharCode(j[i])}return k}function aQ(g){return cD(eA(g))}function aM(i,l){i=i||[],l=l||{};try{return new Blob(i,l)}catch(k){if("TypeError"!==k.name){throw k}for(var h="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,j=new h,g=0;g<i.length;g+=1){j.append(i[g])}return j.getBlob(l.type)}}function d2(h){for(var k=h.length,j=new ArrayBuffer(k),g=new Uint8Array(j),i=0;k>i;i++){g[i]=h.charCodeAt(i)}return j}function bf(h,g){return aM([d2(h)],{type:g})}function aO(h,g){return bf(ck(h),g)}function eR(g,i){if("undefined"==typeof FileReader){return i(eA((new FileReaderSync).readAsArrayBuffer(g)))}var h=new FileReader,j="function"==typeof h.readAsBinaryString;h.onloadend=function(k){var l=k.target.result||"";return j?i(l):void i(eA(l))},j?h.readAsBinaryString(g):h.readAsArrayBuffer(g)}function jG(h,g){eR(h,function(i){g(cD(i))})}function cR(g,i){if("undefined"==typeof FileReader){return i((new FileReaderSync).readAsArrayBuffer(g))}var h=new FileReader;h.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);i(k)},h.readAsArrayBuffer(g)}function bB(g){return cD(g)}function jW(g,i,h,j){(h>0||j<i.byteLength)&&(i=new Uint8Array(i,h,Math.min(j,i.byteLength)-h)),g.append(i)}function aL(g,i,h,j){(h>0||j<i.length)&&(i=i.substring(h,j)),g.appendBinary(i)}function jN(k,m){function i(){var q=o*j,u=q+j;if(o++,l>o){n(p,k,q,u),bG(i)}else{n(p,k,q,u);var r=p.end(!0),s=bB(r);m(s),p.destroy()}}var g="string"==typeof k,h=g?k.length:k.byteLength,j=Math.min(d6,h),l=Math.ceil(h/j),o=0,p=g?new e6:new e6.ArrayBuffer,n=g?aL:jW;i()}function c3(g){return e6.hash(g)}function t(i,k,l){function m(o){try{return ck(o)}catch(q){var p=eO(d1,"Attachment is not a valid base64 string");return{error:p}}}function j(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=m(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===k?q.data=bf(o,q.content_type):"base64"===k?q.data=cD(o):q.data=o,jN(o,function(r){q.digest="md5-"+r,p()})}else{cR(q.data,function(r){"binary"===k?q.data=eA(r):"base64"===k&&(q.data=aQ(r)),jN(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function g(){h++,i.length===h&&(n?l(n):l())}if(!i.length){return l()}var n,h=0;i.forEach(function(r){function p(u){n=u,q++,q===s.length&&g()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return g()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&j(r.data._attachments[o],p)}})}function bR(l,A,j,u,i,s,y,z){if(af(A.rev_tree,j.metadata.rev)){return u[i]=j,s()}var h=A.winningRev||dY(A),m="deleted" in A?A.deleted:cE(A,h),r="deleted" in j.metadata?j.metadata.deleted:cE(j.metadata),n=/^1-/.test(j.metadata.rev);if(m&&!r&&z&&n){var k=j.data;k._rev=h,k._id=j.metadata.id,j=eg(k,z)}var w=eM(A.rev_tree,j.metadata.rev_tree[0],l),g=z&&(m&&r||!m&&"new_leaf"!==w.conflicts||m&&!r&&"new_branch"===w.conflicts);if(g){var p=eO(by);return u[i]=p,s()}var q=j.metadata.rev;j.metadata.rev_tree=w.tree,j.stemmedRevs=w.stemmedRevs||[],A.rev_map&&(j.metadata.rev_map=A.rev_map);var v,B=dY(j.metadata),o=cE(j.metadata,B),x=m===o?0:o>m?-1:1;v=q===B?o:cE(j.metadata,q),y(j,B,o,v,!0,x,i,s)}function jV(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function aB(u,n,m,g,i,r,k,o,h){function j(x,C,B){var z=dY(x.metadata),w=cE(x.metadata,z);if("was_delete" in o&&w){return r[C]=eO(cS,"deleted"),B()}var D=p&&jV(x);if(D){var A=eO(by);return r[C]=A,B()}var y=w?0:1;k(x,z,w,w,!1,y,C,B)}function q(){++l===v&&h&&h()}u=u||1000;var p=o.new_edits,s=new bz.Map,l=0,v=n.length;n.forEach(function(y,w){if(y._id&&bV(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void m[x](y,{ctx:i},function(B,A){r[w]=B||A,q()})}var z=y.metadata.id;s.has(z)?(v--,s.get(z).push([y,w])):s.set(z,[[y,w]])}),s.forEach(function(x,z){function y(){++w<x.length?A():q()}function A(){var C=x[w],E=C[0],D=C[1];if(g.has(z)){bR(u,g.get(z),E,r,D,y,k,p)}else{var B=eM([],E.metadata.rev_tree[0],u);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],j(E,D,y)}}var w=0;A()})}function bh(h){try{return JSON.parse(h)}catch(g){return cf.parse(h)}}function b1(g){return g.length<50000?JSON.parse(g):bh(g)}function fE(h){try{return JSON.stringify(h)}catch(g){return cf.stringify(h)}}function fJ(h,k,j,g){try{h.apply(k,j)}catch(i){g.emit("error",i)}}function aV(h){if(!dL.running&&dL.queue.length){dL.running=!0;var g=dL.queue.shift();g.action(function(i,j){fJ(g.callback,this,[i,j],h),dL.running=!1,ed.nextTick(function(){aV(h)})})}}function b4(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(eO(dV,i,h.type))}}function j8(g,i,h){return{data:fE(g),winningRev:i,deletedOrLocal:h?"1":"0",seq:g.seq,id:g.id}}function aG(h){if(!h){return null}var g=b1(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function j7(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function aw(g,i,h,j){h?j(g?"string"!=typeof g?g:aO(g,i):aM([""],{type:i})):g?"string"!=typeof g?eR(g,function(k){j(cD(k))}):j(g):j("")}function aa(i,k,l,m){function j(){++h===n.length&&m&&m()}function g(s,q){var r=s._attachments[q],p=r.digest,o=l.objectStore(dx).get(p);o.onsuccess=function(u){r.body=u.target.result.body,j()}}var n=Object.keys(i._attachments||{});if(!n.length){return m&&m()}var h=0;n.forEach(function(o){k.attachments&&k.include_docs?g(i,o):(i._attachments[o].stub=!0,j())})}function aR(h,g){return e9.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return e9.all(j.map(function(l){var n=i.doc._attachments[l];if("body" in n){var k=n.body,m=n.content_type;return new e9(function(o){aw(k,m,g,function(p){i.doc._attachments[l]=cc.extend(eB(n,["digest","content_type"]),{data:p}),o()})})}}))}}))}function bk(k,m,i){function g(){n--,n||h()}function h(){j.length&&j.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||o["delete"](q)}})}var j=[],l=i.objectStore(cA),o=i.objectStore(dx),p=i.objectStore(kf),n=k.length;k.forEach(function(s){var r=l.index("_doc_id_rev"),q=m+"::"+s;r.getKey(q).onsuccess=function(u){var w=u.target.result;if("number"!=typeof w){return g()}l["delete"](w);var v=p.index("seq").openCursor(IDBKeyRange.only(w));v.onsuccess=function(x){var z=x.target.result;if(z){var y=z.value.digestSeq.split("::")[0];j.push(y),p["delete"](z.primaryKey),z["continue"]()}else{g()}}}})}function dz(g,i,h){try{return{txn:g.transaction(i,h)}}catch(j){return{error:j}}}function aq(l,C,D,G,I,n,x){function m(){var P=[bW,cA,dx,ag,kf],O=dz(I,P,"readwrite");return O.error?x(O.error):(y=O.txn,y.onabort=b4(x),y.ontimeout=b4(x),y.oncomplete=k,q=y.objectStore(bW),A=y.objectStore(cA),F=y.objectStore(dx),w=y.objectStore(kf),void g(function(Q){return Q?(o=!0,x(Q)):void h()}))}function p(){aB(l.revs_limit,L,G,s,y,M,u,D)}function h(){function T(){++O===L.length&&p()}function R(W){var V=aG(W.target.result);V&&s.set(V.id,V),T()}if(L.length){for(var O=0,S=0,U=L.length;U>S;S++){var Q=L[S];if(Q._id&&bV(Q._id)){T()}else{var P=q.get(Q.metadata.id);P.onsuccess=R}}}}function k(){o||(n.notify(G._meta.name),G._meta.docCount+=B,x(null,M))}function v(P,O){var Q=F.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=eO(eH,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(L.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){v(T,function(U){U&&!P&&(P=U),O()})})}function u(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?r(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ai){var ao=X.stemmedRevs||[];R&&G.auto_compaction&&(ao=ao.concat(du(X.metadata))),ao&&ao.length&&bk(ao,X.metadata.id,y),T.seq=ai.target.result,delete T.rev;var an=j8(T,Q,S),ae=q.put(an);ae.onsuccess=Z}function P(an){an.preventDefault(),an.stopPropagation();var ai=A.index("_doc_id_rev"),ae=ai.getKey(V._doc_id_rev);ae.onsuccess=function(ar){var ao=A.put(V,ar.target.result);ao.onsuccess=W}}function Z(){M[U]={ok:!0,id:T.id,rev:Q},s.set(X.metadata.id,X.metadata),j(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=A.put(V);Y.onsuccess=W,Y.onerror=P}function r(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(ae){var ai=W.data._attachments[ae];if(ai.stub){X++,Y()}else{var Z=ai.data;delete ai.data,ai.revpos=parseInt(P,10);var an=ai.digest;E(an,Z,Q)}})}function j(R,O,T){function Q(){++V===U.length&&T()}function S(X){var W=R.data._attachments[X].digest,Y=w.put({seq:O,digestSeq:W+"::"+O});Y.onsuccess=Q,Y.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),Q()}}var V=0,U=Object.keys(R.data._attachments||{});if(!U.length){return T()}for(var P=0;P<U.length;P++){S(U[P])}}function E(Q,O,R){var P=F.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=F.put(U);T.onsuccess=R}}for(var y,q,A,F,w,H,L=C.docs,B=0,z=0,J=L.length;J>z;z++){var N=L[z];N._id&&bV(N._id)||(N=L[z]=eg(N,D.new_edits),N.error&&!H&&(H=N))}if(H){return x(H)}var M=new Array(L.length),s=new bz.Map,o=!1,i=G._meta.blobSupport?"blob":"base64";t(L,i,function(O){return O?x(O):void m()})}function b3(i,l,k,h,j){try{if(i&&l){return j?IDBKeyRange.bound(l,i,!k,!1):IDBKeyRange.bound(i,l,!1,!k)}if(i){return j?IDBKeyRange.upperBound(i):IDBKeyRange.lowerBound(i)}if(l){return j?IDBKeyRange.lowerBound(l,!k):IDBKeyRange.upperBound(l,!k)}if(h){return IDBKeyRange.only(h)}}catch(g){return{error:g}}return null}function dW(g,i,h,j){return"DataError"===h.name&&0===h.code?j(null,{total_rows:g._meta.docCount,offset:i.skip,rows:[]}):void j(eO(dV,h.name,h.message))}function cU(i,l,k,h){function j(r,u){function I(N,M,O){var L=N.id+"::"+O;D.get(L).onsuccess=function(P){M.doc=j7(P.target.result),r.conflicts&&(M.doc._conflicts=jY(N)),aa(M.doc,r,n)}}function v(P,M,L){var O={id:L.id,key:L.id,value:{rev:M}},N=L.deleted;if("ok"===r.deleted){m.push(O),N?(O.value.deleted=!0,O.doc=null):r.include_docs&&I(L,O,M)}else{if(!N&&B--<=0&&(m.push(O),r.include_docs&&I(L,O,M),0===--z)){return}}P["continue"]()}function H(O){K=l._meta.docCount;var M=O.target.result;if(M){var N=aG(M.value),L=N.winningRev;v(M,L,N)}}function E(){u(null,{total_rows:K,offset:r.skip,rows:m})}function q(){r.attachments?aR(m,r.binary).then(E):E()}var G="startkey" in r?r.startkey:!1,s="endkey" in r?r.endkey:!1,J="key" in r?r.key:!1,B=r.skip||0,z="number"==typeof r.limit?r.limit:-1,o=r.inclusive_end!==!1,A="descending" in r&&r.descending?"prev":null,F=b3(G,s,o,J,A);if(F&&F.error){return dW(l,r,F.error,u)}var C=[bW,cA];r.attachments&&C.push(dx);var y=dz(k,C,"readonly");if(y.error){return u(y.error)}var n=y.txn,x=n.objectStore(bW),w=n.objectStore(cA),p=A?x.openCursor(F,A):x.openCursor(F),D=w.index("_doc_id_rev"),m=[],K=0;n.oncomplete=q,p.onsuccess=H}function g(m,n){return 0===m.limit?n(null,{total_rows:l._meta.docCount,offset:m.skip,rows:[]}):void j(m,n)}g(i,h)}function aE(g){return new e9(function(h){var i=aM([""]);g.objectStore(aS).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function jM(g,i){var h=this;dL.queue.push({action:function(j){aH(h,g,j)},callback:i}),aV(h.constructor)}function aH(u,g,k){function m(x){var w=x.createObjectStore(bW,{keyPath:"id"});x.createObjectStore(cA,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(dx,{keyPath:"digest"}),x.createObjectStore(jZ,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aS),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(ag,{keyPath:"_id"});var v=x.createObjectStore(kf,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function n(x,w){var v=x.objectStore(bW);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=cE(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function j(v){v.createObjectStore(ag,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function s(v,x){var w=v.objectStore(ag),y=v.objectStore(bW),z=v.objectStore(cA),A=y.openCursor();A.onsuccess=function(J){var G=J.target.result;if(G){var M=G.value,D=M.id,C=bV(D),L=dY(M);if(C){var I=D+"::"+L,F=D+"::",K=D+"::~",H=z.index("_doc_id_rev"),E=IDBKeyRange.bound(F,K,!1,!1),B=H.openCursor(E);B.onsuccess=function(N){if(B=N.target.result){var O=B.value;O._doc_id_rev===I&&w.put(O),z["delete"](B.primaryKey),B["continue"]()}else{y["delete"](G.primaryKey),G["continue"]()}}}else{G["continue"]()}}else{x&&x()}}}function o(w){var v=w.createObjectStore(kf,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function p(v,x){var w=v.objectStore(cA),y=v.objectStore(dx),z=v.objectStore(kf),A=y.count();A.onsuccess=function(B){var C=B.target.result;return C?void (w.openCursor().onsuccess=function(H){var D=H.target.result;if(!D){return x()}for(var M=D.value,F=D.primaryKey,J=Object.keys(M._attachments||{}),L={},K=0;K<J.length;K++){var I=M._attachments[J[K]];L[I.digest]=!0}var G=Object.keys(L);for(K=0;K<G.length;K++){var E=G[K];z.put({seq:F,digestSeq:E+"::"+F})}D["continue"]()}):x()}}function h(w){function x(A){return A.data?aG(A):(A.deleted="1"===A.deletedOrLocal,A)}var v=w.objectStore(cA),z=w.objectStore(bW),y=z.openCursor();y.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=v.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=j8(B,B.winningRev,B.deleted),F=z.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=x(E.value);return B.winningRev=B.winningRev||dY(B),B.seq?A():void D()}}}var l=g.name,i=null;u._meta=null,u.type=function(){return"idb"},u._id=eK(function(v){v(null,u._meta.instanceId)}),u._bulkDocs=function(v,w,x){aq(g,v,w,u,i,cK,x)},u._get=function(x,B,A){function v(){A(y,{doc:w,metadata:D,ctx:C})}var w,D,y,C=B.ctx;if(!C){var z=dz(i,[bW,cA,dx],"readonly");if(z.error){return A(z.error)}C=z.txn}C.objectStore(bW).get(x).onsuccess=function(E){if(D=aG(E.target.result),!D){return y=eO(cS,"missing"),v()}if(cE(D)&&!B.rev){return y=eO(cS,"deleted"),v()}var G=C.objectStore(cA),H=B.rev||D.winningRev,F=D.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return w=I.target.result,w&&(w=j7(w)),w?void v():(y=eO(cS,"missing"),v())}}},u._getAttachment=function(x,B,A,v,w){var D;if(v.ctx){D=v.ctx}else{var y=dz(i,[bW,cA,dx],"readonly");if(y.error){return w(y.error)}D=y.txn}var C=A.digest,z=A.content_type;D.objectStore(dx).get(C).onsuccess=function(E){var F=E.target.result.body;aw(F,z,v.binary,function(G){w(null,G)})}},u._info=function(A){if(null===i||!f4.has(l)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var B,z,x=dz(i,[cA],"readonly");if(x.error){return A(x.error)}var w=x.txn,v=w.objectStore(cA).openCursor(null,"prev");v.onsuccess=function(D){var C=D.target.result;B=C?C.key:0,z=u._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:B,idb_attachment_format:u._meta.blobSupport?"binary":"base64"})}},u._allDocs=function(v,w){cU(v,u,i,w)},u._changes=function(J){function F(N){function T(){return S.seq!==O?N["continue"]():(H=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=L.get(U);V.onsuccess=function(W){R(j7(W.target.result))}}function R(V){var W=J.processChange(V,S,J);W.seq=S.seq;var U=M(W);return"object"==typeof U?J.complete(U):(U&&(C++,z&&I.push(W),J.attachments&&J.include_docs?aa(V,J,B,function(){aR([W],J.binary).then(function(){J.onChange(W)})}):J.onChange(W)),void (C!==E&&N["continue"]()))}var P=j7(N.value),O=N.key;if(w&&!w.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (K.get(P._id).onsuccess=function(U){S=aG(U.target.result),y.set(P._id,S),T()})}function D(N){var O=N.target.result;O&&F(O)}function A(){var P=[bW,cA];J.attachments&&P.push(dx);var O=dz(i,P,"readonly");if(O.error){return J.complete(O.error)}B=O.txn,B.onabort=b4(J.complete),B.oncomplete=v,x=B.objectStore(cA),K=B.objectStore(bW),L=x.index("_doc_id_rev");var N;N=J.descending?x.openCursor(null,"prev"):x.openCursor(IDBKeyRange.lowerBound(J.since,!0)),N.onsuccess=D}function v(){function N(){J.complete(null,{results:I,last_seq:H})}!J.continuous&&J.attachments?aR(I).then(N):N()}if(J=cm(J),J.continuous){var G=l+":"+bc();return cK.addListener(l,G,u,J),cK.notify(l),{cancel:function(){cK.removeListener(l,G)}}}var w=J.doc_ids&&new bz.Set(J.doc_ids);J.since=J.since||0;var H=J.since,E="limit" in J?J.limit:-1;0===E&&(E=1);var z;z="return_docs" in J?J.return_docs:"returnDocs" in J?J.returnDocs:!0;var B,x,K,L,I=[],C=0,M=fK(J),y=new bz.Map;A()},u._close=function(v){return null===i?v(eO(eW)):(i.close(),f4["delete"](l),i=null,void v())},u._getRevisionTree=function(w,x){var v=dz(i,[bW],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(bW).get(w);y.onsuccess=function(B){var A=aG(B.target.result);A?x(null,A.rev_tree):x(eO(cS))}},u._doCompaction=function(y,A,z){var v=[bW,cA,dx,kf],B=dz(i,v,"readwrite");if(B.error){return z(B.error)}var x=B.txn,w=x.objectStore(bW);w.get(y).onsuccess=function(E){var C=aG(E.target.result);ay(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),bk(A,y,x);var D=C.winningRev,F=C.deleted;x.objectStore(bW).put(j8(C,D,F))},x.onabort=b4(z),x.oncomplete=function(){z()}},u._getLocal=function(w,x){var v=dz(i,[ag],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(ag).get(w);y.onerror=b4(x),y.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,x(null,A)):x(eO(cS))}},u._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=dz(i,[ag],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=b4(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(ag);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(eO(by))}}):(y=v.add(E),y.onerror=function(F){x(eO(by)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},u._removeLocal=function(x,B,A){"function"==typeof B&&(A=B,B={});var v=B.ctx;if(!v){var w=dz(i,[ag],"readwrite");if(w.error){return A(w.error)}v=w.txn,v.oncomplete=function(){D&&A(null,D)}}var D,y=x._id,C=v.objectStore(ag),z=C.get(y);z.onerror=b4(A),z.onsuccess=function(F){var E=F.target.result;E&&E._rev===x._rev?(C["delete"](y),D={ok:!0,id:y,rev:"0-0"},B.ctx&&A(null,D)):A(eO(cS))}},u._destroy=function(w,y){cK.removeAllListeners(l);var x=aN.get(l);x&&x.result&&(x.result.close(),f4["delete"](l));var v=indexedDB.deleteDatabase(l);v.onsuccess=function(){aN["delete"](l),ds()&&l in localStorage&&delete localStorage[l],y(null,{ok:!0})},v.onerror=b4(y)};var q=f4.get(l);if(q){return i=q.idb,u._meta=q.global,void ed.nextTick(function(){k(null,u)})}var r;r=g.storage?dj(l,g.storage):indexedDB.open(l,dG),aN.set(l,r),r.onupgradeneeded=function(x){function v(){var B=z[A-1];A++,B&&B(w,v)}var y=x.target.result;if(x.oldVersion<1){return m(y)}var w=x.currentTarget.transaction;x.oldVersion<3&&j(y),x.oldVersion<4&&o(y);var z=[n,s,p,h],A=x.oldVersion;v()},r.onsuccess=function(y){i=y.target.result,i.onversionchange=function(){i.close(),f4["delete"](l)},i.onabort=function(B){e0("error","Database has a global failure",B.target.error),i.close(),f4["delete"](l)};var w=i.transaction([jZ,aS,bW],"readwrite"),z=w.objectStore(jZ).get(jZ),x=null,v=null,A=null;z.onsuccess=function(D){var B=function(){null!==x&&null!==v&&null!==A&&(u._meta={name:l,instanceId:A,blobSupport:x,docCount:v},f4.set(l,{idb:i,global:u._meta}),k(null,u))},E=D.target.result||{id:jZ};l+"_id" in E?(A=E[l+"_id"],B()):(A=bc(),E[l+"_id"]=A,w.objectStore(jZ).put(E).onsuccess=function(){B()}),f1||(f1=aE(w)),f1.then(function(F){x=F,B()});var C=w.objectStore(bW).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){v=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";e0("error",v),k(eO(dV,v))}}function dj(g,i){try{return indexedDB.open(g,{version:dG,storage:i})}catch(h){return indexedDB.open(g,dG)}}function bu(g){g.adapter("idb",jM,!0)}function aJ(g){return decodeURIComponent(escape(g))}function cw(g){return 65>g?g-48:g-55}function j1(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(cw(g.charCodeAt(i++))<<4|cw(g.charCodeAt(i++)))}return j}function cX(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(cw(g.charCodeAt(i+2))<<12|cw(g.charCodeAt(i+3))<<8|cw(g.charCodeAt(i))<<4|cw(g.charCodeAt(i+1))),i+=4}return j}function cy(h,g){return"UTF-8"===g?aJ(j1(h,0,h.length)):cX(h,0,h.length)}function bY(g){return"'"+g+"'"}function bM(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function c5(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function al(g){return delete g._id,delete g._rev,JSON.stringify(g)}function dl(g,i,h){return g=JSON.parse(g),g._id=i,g._rev=h,g}function dM(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function ej(h,k,j,g,i){return"SELECT "+h+" FROM "+("string"==typeof k?k:k.join(" JOIN "))+(j?" ON "+j:"")+(g?" WHERE "+("string"==typeof g?g:g.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function am(k,i,g){function j(){++m===k.length&&l()}function l(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+fA+" WHERE seq IN "+dM(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+fA+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+fA+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new bz.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+fA+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+bx+" WHERE digest=?",[A]))})})})}})}}if(k.length){var m=0,h=[];k.forEach(function(o){var n="SELECT seq FROM "+cQ+" WHERE doc_id=? AND rev=?";g.executeSql(n,[i,o],function(q,p){if(!p.rows.length){return j()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+cQ+" WHERE seq=?",[r],j)})})}}function el(g){return function(h){e0("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(eO(eP,j,i))}}function bX(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function cH(C,y,g,m,n,v,u){function k(){return A?u(A):(v.notify(m._name),m._docCount=-1,void u(null,w))}function x(E,D){var F="SELECT count(*) as cnt FROM "+bx+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=eO(eH,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function l(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){x(I,function(J){J&&!E&&(E=J),D()})})}function B(R,K,F,P,N,H,M,J){function E(){function S(ar,at){function a0(){return ++an===ae.length&&at(),!1}function ai(a3){var a1="INSERT INTO "+fA+" (digest, seq) VALUES (?,?)",a2=[Z._attachments[a3].digest,ar];p.executeSql(a1,a2,a0,a0)}var an=0,ae=Object.keys(Z._attachments||{});if(!ae.length){return at()}for(var ao=0;ao<ae.length;ao++){ai(ae[ao])}}var Z=R.data,U=P?1:0,X=Z._id,T=Z._rev,V=al(Z),W="INSERT INTO "+cQ+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",Y=[X,T,V,U];p.executeSql(W,Y,function(ae,an){var ai=an.insertId;S(ai,function(){D(ae,ai)})},function(){var ae=ej("seq",cQ,null,"doc_id=? AND rev=?");return p.executeSql(ae,[X,T],function(ao,ar){var ai=ar.rows.item(0).seq,an="UPDATE "+cQ+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[V,U,X,T];ao.executeSql(an,at,function(a0){S(ai,function(){D(a0,ai)})})}),!1})}function Q(S){O||(S?(O=S,J(O)):I===G.length&&E())}function L(S){I++,Q(S)}function D(W,V){var Y=R.metadata.id,X=R.stemmedRevs||[];N&&m.auto_compaction&&(X=du(R.metadata).concat(X)),X.length&&am(X,Y,W),R.metadata.seq=V,delete R.metadata.rev;var S=N?"UPDATE "+aW+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+cQ+" WHERE doc_id="+aW+".id AND rev=?) WHERE id=?":"INSERT INTO "+aW+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",T=fE(R.metadata),U=N?[T,V,K,Y]:[Y,V,V,T];W.executeSql(S,U,function(){w[M]={ok:!0,id:R.metadata.id,rev:K},r.set(Y,R.metadata),J()})}var O=null,I=0;R.data._id=R.metadata.id,R.data._rev=R.metadata.rev;var G=Object.keys(R.data._attachments||{});P&&(R.data._deleted=!0),G.forEach(function(U){var S=R.data._attachments[U];if(S.stub){I++,Q()}else{var T=S.data;delete S.data,S.revpos=parseInt(K,10);var V=S.digest;z(V,T,L)}}),G.length||E()}function s(){aB(C.revs_limit,o,m,r,p,w,B,g)}function i(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&bV(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+aW+" WHERE id = ?",[H],function(I,K){if(K.rows.length){var J=b1(K.rows.item(0).json);r.set(H,J)}D()})})}function z(F,D,G){var E="SELECT digest FROM "+bx+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+bx+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,bM(D)],function(){G()},function(){return G(),!1}))})}var j=g.new_edits,h=y.docs,o=h.map(function(E){if(E._id&&bV(E._id)){return E}var D=eg(E,j);return D}),q=o.filter(function(D){return D.error});if(q.length){return u(q[0])}var p,A,w=new Array(o.length),r=new bz.Map;t(o,"binary",function(D){return D?u(D):void n.transaction(function(E){p=E,l(function(F){F?A=F:i(s)})},el(u),k)})}function j6(g){return g.websql(g.name,g.version,g.description,g.size)}function dQ(h){try{return{db:j6(h)}}catch(g){return{error:g}}}function b0(h){var g=ab.get(h.name);return g||(g=dQ(h),ab.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function jQ(h,j,n,m,g){function i(){++o===l.length&&g&&g()}function k(q,s){var r=q._attachments[s],p={binary:j.binary,ctx:m};n._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=cc.extend(eB(r,["digest","content_type"]),{data:v}),i()})}var l=Object.keys(h._attachments||{});if(!l.length){return g&&g()}var o=0;l.forEach(function(p){j.attachments&&j.include_docs?k(h,p):(h._attachments[p].stub=!0,i())})}function dh(r,k){function B(){ds()&&(window.localStorage["_pouch__websqldb_"+s._name]=!0),k(null,s)}function m(F,E){F.executeSql(kc),F.executeSql("ALTER TABLE "+cQ+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(j4),F.executeSql("ALTER TABLE "+aW+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+aW+" (local, id)");var G="SELECT "+aW+".winningseq AS seq, "+aW+".json AS metadata FROM "+cQ+" JOIN "+aW+" ON "+cQ+".seq = "+aW+".winningseq";F.executeSql(G,[],function(K,O){for(var J=[],M=[],N=0;N<O.rows.length;N++){var H=O.rows.item(N),I=H.seq,L=JSON.parse(H.metadata);cE(L)&&J.push(I),bV(L.id)&&M.push(L.id)}K.executeSql("UPDATE "+aW+"SET local = 1 WHERE id IN "+dM(M.length),M,function(){K.executeSql("UPDATE "+cQ+" SET deleted = 1 WHERE seq IN "+dM(J.length),J,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+cT+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+aW+".id AS id, "+cQ+".json AS data FROM "+cQ+" JOIN "+aW+" ON "+cQ+".seq = "+aW+".winningseq WHERE local = 1";F.executeSql(H,[],function(M,J){function L(){if(!I.length){return E(M)}var O=I.shift(),N=JSON.parse(O.data)._rev;M.executeSql("INSERT INTO "+cT+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+aW+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+cQ+" WHERE seq=?",[O.seq],function(){L()})})})}for(var I=[],K=0;K<J.rows.length;K++){I.push(J.rows.item(K))}L()})})}function g(G,E){function H(J){function I(){if(!J.length){return E(G)}var N=J.shift(),L=cy(N.hex,x),O=L.lastIndexOf("::"),M=L.substring(0,O),K=L.substring(O+2),P="UPDATE "+cQ+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(P,[M,K,L],function(){I()})}I()}var F="ALTER TABLE "+cQ+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+cQ+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(bg,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+cQ;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function y(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+bx;I.executeSql(J,[],function(M,O){function L(){var Q=ej(cW+", "+aW+".id AS id",[aW,cQ],b5,null,aW+".id ");Q+=" LIMIT "+P+" OFFSET "+K,K+=P,M.executeSql(Q,[],function(ai,Z){function T(at,ar){var ao=R[at]=R[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!Z.rows.length){return E(ai)}for(var R={},V=0;V<Z.rows.length;V++){for(var X=Z.rows.item(V),W=dl(X.data,X.id,X.rev),S=Object.keys(W._attachments||{}),U=0;U<S.length;U++){var an=W._attachments[S[U]];T(an.digest,X.seq)}}var ae=[];if(Object.keys(R).forEach(function(ar){var ao=R[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return L()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+fA+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&L()})})})}var N=O.rows.item(0).cnt;if(!N){return E(M)}var K=0,P=10;L()})}var F="CREATE TABLE IF NOT EXISTS "+fA+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(bT,[],function(J){J.executeSql(c7,[],H)})})}function q(F,E){var G="ALTER TABLE "+bx+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function A(F,E){var G="ALTER TABLE "+aW+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+aW+" SET max_seq=(SELECT MAX(seq) FROM "+cQ+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+aW+" (max_seq)";J.executeSql(K,[],E)})})}function D(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;x=2===H.length?"UTF-8":"UTF-16",E()})}function w(){for(;u.length>0;){var E=u.pop();E(null,j)}}function C(G,O){if(0===O){var L="CREATE TABLE IF NOT EXISTS "+bL+" (dbid, db_version INTEGER)",I="CREATE TABLE IF NOT EXISTS "+bx+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",F="CREATE TABLE IF NOT EXISTS "+fA+" (digest, seq INTEGER)",P="CREATE TABLE IF NOT EXISTS "+aW+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",E="CREATE TABLE IF NOT EXISTS "+cQ+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",K="CREATE TABLE IF NOT EXISTS "+cT+" (id UNIQUE, rev, json)";G.executeSql(I),G.executeSql(K),G.executeSql(F,[],function(){G.executeSql(c7),G.executeSql(bT)}),G.executeSql(P,[],function(){G.executeSql(kc),G.executeSql(E,[],function(){G.executeSql(j4),G.executeSql(bg),G.executeSql(L,[],function(){var R="INSERT INTO "+bL+" (db_version, dbid) VALUES (?,?)";j=bc();var Q=[bD,j];G.executeSql(R,Q,function(){w()})})})})}else{var M=function(){var Q=bD>O;Q&&G.executeSql("UPDATE "+bL+" SET db_version = "+bD);var R="SELECT dbid FROM "+bL;G.executeSql(R,[],function(T,S){j=S.rows.item(0).dbid,w()})},J=[m,p,g,y,q,A,M],H=O,N=function(Q){J[H-1](Q,N),H++};N(G)}}function o(){l.transaction(function(E){D(E,function(){v(E)})},el(k),B)}function v(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+bL;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+bL,[],function(I,K){var J=K.rows.item(0).db_version;C(I,J)}):H.executeSql("ALTER TABLE "+bL+" ADD COLUMN db_version INTEGER",[],function(){C(H,1)}):C(H,0)})}function h(F,E){if(-1!==s._docCount){return E(s._docCount)}var G=ej("COUNT("+aW+".id) AS 'num'",[aW,cQ],b5,cQ+".deleted=0");F.executeSql(G,[],function(I,H){s._docCount=H.rows.item(0).num,E(s._docCount)})}var x,s=this,j=null,n=bX(r),u=[];s._docCount=-1,s._name=r.name;var z=cc.extend({},r,{version:fF,description:r.name,size:n}),i=b0(z);if(i.error){return el(k)(i.error)}var l=i.db;"function"!=typeof l.readTransaction&&(l.readTransaction=l.transaction),o(),s.type=function(){return"websql"},s._id=eK(function(E){E(null,j)}),s._info=function(E){l.readTransaction(function(F){h(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+cQ;F.executeSql(G,[],function(K,I){var J=I.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:J,sqlite_plugin:l._sqlitePlugin,websql_encoding:x})})})},el(E))},s._bulkDocs=function(E,G,F){cH(r,E,G,s,l,f0,F)},s._get=function(L,M,J){function G(){J(E,{doc:H,metadata:K,ctx:I})}var H,K,E,I=M.ctx;if(!I){return l.readTransaction(function(O){s._get(L,cc.extend({ctx:O},M),J)})}var F,N;M.rev?(F=ej(cW,[aW,cQ],aW+".id="+cQ+".doc_id",[cQ+".doc_id=?",cQ+".rev=?"]),N=[L,M.rev]):(F=ej(cW,[aW,cQ],b5,aW+".id=?"),N=[L]),I.executeSql(F,N,function(O,P){if(!P.rows.length){return E=eO(cS,"missing"),G()}var Q=P.rows.item(0);return K=b1(Q.metadata),Q.deleted&&!M.rev?(E=eO(cS,"deleted"),G()):(H=dl(Q.data,K.id,Q.rev),void G())})},s._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(aW+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(aW+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(aW+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(aW+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(cQ+".deleted = 0"),l.readTransaction(function(S){h(S,function(U){if(P=U,0!==N){var T=ej(cW,[aW,cQ],b5,J,aW+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(an,V){for(var ar=0,Y=V.rows.length;Y>ar;ar++){var ai=V.rows.item(ar),ao=b1(ai.metadata),X=ao.id,Z=dl(ai.data,X,ai.rev),W=Z._rev,ae={id:X,key:X,value:{rev:W}};if(E.include_docs&&(ae.doc=Z,ae.doc._rev=W,E.conflicts&&(ae.doc._conflicts=jY(ao)),jQ(ae.doc,E,s,an)),ai.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},el(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},s._changes=function(G){function H(){var S=aW+".json AS metadata, "+aW+".max_seq AS maxSeq, "+cQ+".json AS winningDoc, "+cQ+".rev AS winningRev ",T=aW+" JOIN "+cQ,R=aW+".id="+cQ+".doc_id AND "+aW+".winningseq="+cQ+".seq",Q=["maxSeq > ?"],O=[G.since];G.doc_ids&&(Q.push(aW+".id IN "+dM(G.doc_ids.length)),O=O.concat(G.doc_ids));var U="maxSeq "+(L?"DESC":"ASC"),N=ej(S,T,R,Q,U),M=fK(G);G.view||G.filter||(N+=" LIMIT "+I);var P=G.since||0;l.readTransaction(function(V){V.executeSql(N,O,function(ao,ar){function an(a0){return function(){G.onChange(a0)}}for(var Y=0,X=ar.rows.length;X>Y;Y++){var at=ar.rows.item(Y),W=b1(at.metadata);P=at.maxSeq;var ae=dl(at.winningDoc,W.id,at.winningRev),ai=G.processChange(ae,W,G);ai.seq=at.maxSeq;var Z=M(ai);if("object"==typeof Z){return G.complete(Z)}if(Z&&(K++,F&&E.push(ai),G.attachments&&G.include_docs?jQ(ae,G,s,ao,an(ai)):an(ai)()),K===I){break}}})},el(G.complete),function(){G.continuous||G.complete(null,{results:E,last_seq:P})})}if(G=cm(G),G.continuous){var J=s._name+":"+bc();return f0.addListener(s._name,J,s,G),f0.notify(s._name),{cancel:function(){f0.removeListener(s._name,J)}}}var L=G.descending;G.since=G.since&&!L?G.since:0;var I="limit" in G?G.limit:-1;0===I&&(I=1);var F;F="return_docs" in G?G.return_docs:"returnDocs" in G?G.returnDocs:!0;var E=[],K=0;H()},s._close=function(E){E()},s._getAttachment=function(L,M,J,G,H){var K,E=G.ctx,I=J.digest,F=J.content_type,N="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+bx+" WHERE digest=?";E.executeSql(N,[I],function(P,O){var Q=O.rows.item(0),R=Q.escaped?c5(Q.body):cy(Q.body,x);K=G.binary?bf(R,F):cD(R),H(null,K)})},s._getRevisionTree=function(F,E){l.readTransaction(function(H){var G="SELECT json AS metadata FROM "+aW+" WHERE id = ?";H.executeSql(G,[F],function(I,J){if(J.rows.length){var K=b1(J.rows.item(0).metadata);E(null,K.rev_tree)}else{E(eO(cS))}})})},s._doCompaction=function(F,E,G){return E.length?void l.transaction(function(H){var I="SELECT json AS metadata FROM "+aW+" WHERE id = ?";H.executeSql(I,[F],function(J,L){var M=b1(L.rows.item(0).metadata);ay(M.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var K="UPDATE "+aW+" SET json = ? WHERE id = ?";J.executeSql(K,[fE(M),F])}),am(E,F,H)},el(G),function(){G()}):G()},s._getLocal=function(F,E){l.readTransaction(function(H){var G="SELECT json, rev FROM "+cT+" WHERE id=?";H.executeSql(G,[F],function(J,L){if(L.rows.length){var I=L.rows.item(0),K=dl(I.json,F,I.rev);E(null,K)}else{E(eO(cS))}})})},s._putLocal=function(L,G,J){function H(N){var P,O;K?(P="UPDATE "+cT+" SET rev=?, json=? WHERE id=? AND rev=?",O=[I,F,E,K]):(P="INSERT INTO "+cT+" (id, rev, json) VALUES (?,?,?)",O=[E,I,F]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(M={ok:!0,id:E,rev:I},G.ctx&&J(null,M)):J(eO(by))},function(){return J(eO(by)),!1})}"function"==typeof G&&(J=G,G={}),delete L._revisions;var I,K=L._rev,E=L._id;I=K?L._rev="0-"+(parseInt(K.split("-")[1],10)+1):L._rev="0-1";var M,F=al(L);G.ctx?H(G.ctx):l.transaction(H,el(J),function(){M&&J(null,M)})},s._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+cT+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(eO(cS))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):l.transaction(G,el(E),function(){I&&E(null,I)})},s._destroy=function(F,E){f0.removeAllListeners(s._name),l.transaction(function(H){var G=[aW,cQ,bx,bL,cT,fA];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},el(E),function(){ds()&&(delete window.localStorage["_pouch__websqldb_"+s._name],delete window.localStorage[s._name]),E(null,{ok:!0})})}}function bm(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cj(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var g=ds(),i="_pouch__websqldb_valid_"+navigator.userAgent;if(g&&localStorage[i]){return"1"===localStorage[i]}var h=bm();return g&&(localStorage[i]=h?"1":"0"),h}function f9(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cj()}function dH(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=cc.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function cP(g,i){var h=dH(g),j=cc.extend({websql:h},g);dh.call(this,j,i)}function eI(g){g.adapter("websql",cP,!0)}function fB(){for(var g={},i=new e9(function(k,l){g.resolve=k,g.reject=l}),h=new Array(arguments.length),j=0;j<h.length;j++){h[j]=arguments[j]}return g.promise=i,e9.resolve().then(function(){return fetch.apply(null,h)}).then(function(k){g.resolve(k)})["catch"](function(k){g.reject(k)}),g}function j0(k,i){var g,j,l,m=new Headers,h={method:k.method,credentials:"include",headers:m};return k.json&&(m.set("Accept","application/json"),m.set("Content-Type",k.headers["Content-Type"]||"application/json")),k.body&&k.body instanceof Blob?cR(k.body,function(n){h.body=n}):k.body&&k.processData&&"string"!=typeof k.body?h.body=JSON.stringify(k.body):"body" in k?h.body=k.body:h.body=null,Object.keys(k.headers).forEach(function(n){k.headers.hasOwnProperty(n)&&m.set(n,k.headers[n])}),g=fB(k.url,h),k.timeout>0&&(j=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+k.url))},k.timeout)),g.promise.then(function(n){return l={statusCode:n.status},k.timeout>0&&clearTimeout(j),l.statusCode>=200&&l.statusCode<300?k.binary?n.blob():n.text():n.json()}).then(function(n){l.statusCode>=200&&l.statusCode<300?i(null,l,n):i(n,l)})["catch"](function(n){i(n,l)}),{abort:g.reject}}function ki(h,j){var n,m,g=!1,i=function(){n.abort()},k=function(){g=!0,n.abort()};n=h.xhr?new h.xhr:new XMLHttpRequest;try{n.open(h.method,h.url)}catch(l){j(l,{statusCode:413})}n.withCredentials="withCredentials" in h?h.withCredentials:!0,"GET"===h.method?delete h.headers["Content-Type"]:h.json&&(h.headers.Accept="application/json",h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json",h.body&&h.processData&&"string"!=typeof h.body&&(h.body=JSON.stringify(h.body))),h.binary&&(n.responseType="arraybuffer"),"body" in h||(h.body=null);for(var o in h.headers){h.headers.hasOwnProperty(o)&&n.setRequestHeader(o,h.headers[o])}return h.timeout>0&&(m=setTimeout(k,h.timeout),n.onprogress=function(){clearTimeout(m),4!==n.readyState&&(m=setTimeout(k,h.timeout))},"undefined"!=typeof n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var s={statusCode:n.status};if(n.status>=200&&n.status<300){var q;q=h.binary?aM([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,j(null,s,q)}else{var p={};if(g){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(n.response)}catch(r){}}j(p,s)}}},h.body&&h.body instanceof Blob?cR(h.body,function(p){n.send(p)}):n.send(h.body),{abort:i}}function c6(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function bI(h,g){return dB||h.xhr?ki(h,g):j0(h,g)}function bi(){return""}function cV(h,k){function j(n,m,o){if(!h.binary&&h.json&&"string"==typeof n){try{n=JSON.parse(n)}catch(l){return o(l)}}Array.isArray(n)&&(n=n.map(function(p){return p.error||p.missing?eU(p):p})),h.binary&&j5(n,m),o(null,n,m)}function g(q,o){var m,p;if(q.code&&q.status){var l=new Error(q.message||q.code);return l.status=q.status,o(l)}if(q.message&&"ETIMEDOUT"===q.message){return o(q)}try{m=JSON.parse(q.responseText),p=eU(m)}catch(n){p=eU(q)}o(p)}h=cm(h);var i={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return h=cc.extend(i,h),h.json&&(h.binary||(h.headers.Accept="application/json"),h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json"),h.binary&&(h.encoding=null,h.json=!1),h.processData||(h.json=!1),bI(h,function(q,n,l){if(q){return q.status=n?n.statusCode:400,g(q,k)}var o,m=n.headers&&n.headers["content-type"],r=l||bi();if(!h.binary&&(h.json||!h.processData)&&"object"!=typeof r&&(/json/.test(m)||/^[\s]*\{/.test(r)&&/\}[\s]*$/.test(r))){try{r=JSON.parse(r.toString())}catch(p){}}n.statusCode>=200&&n.statusCode<300?j(r,n,k):(o=eU(r),o.status=n.statusCode,k(o))})}function eV(k,m){var i=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",g=-1!==i.indexOf("safari")&&-1===i.indexOf("chrome"),h=-1!==i.indexOf("msie"),j=-1!==i.indexOf("edge"),l=g||(h||j)&&"GET"===k.method,o="cache" in k?k.cache:!0,p=/^blob:/.test(k.url);if(!p&&(l||!o)){var n=-1!==k.url.indexOf("?");k.url+=(n?"&":"?")+"_nonce="+Date.now()}return cV(k,m)}function dD(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=aO(j.data,j.content_type)})}function cd(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function fH(g){return g._attachments&&Object.keys(g._attachments)?e9.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new e9(function(j){jG(i.data,j)}).then(function(j){i.data=j}):void 0})):e9.resolve()}function bO(g){var i=bH(g);(i.user||i.password)&&(i.auth={username:i.user,password:i.password});var h=i.path.replace(/(^\/|\/$)/g,"").split("/");return i.db=h.pop(),-1===i.db.indexOf("%")&&(i.db=encodeURIComponent(i.db)),i.path=h.join("/"),i}function dI(h,g){return kb(h,h.db+"/"+g)}function kb(g,i){var h=g.path?"/":"";return g.protocol+"://"+g.host+(g.port?":"+g.port:"")+"/"+g.path+h+i}function f8(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function c0(i,j){function k(A,y,B){var z=A.ajax||{},x=cc.extend(cm(g),z,y);return jK(x.method+" "+x.url),p._ajax(x,B)}function w(x,y){return new e9(function(z,A){k(x,y,function(C,B){return C?A(C):void z(B)})})}function v(x,y){return c1(x,dm(function(z){o().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function o(){if(i.skipSetup||i.skip_setup){return e9.resolve()}if(m){return m}var x={method:"GET",url:h};return m=w({},x)["catch"](function(y){return y&&y.status&&404===y.status?(bJ(404,"PouchDB is just detecting if the remote exists."),w({},{method:"PUT",url:h})):e9.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:e9.reject(y)}),m["catch"](function(){m=null}),m}function l(x){return x.split("/").map(encodeURIComponent).join("/")}var p=this,u=bO;i.getHost&&(u=i.getHost);var n=u(i.name,i),h=dI(n,"");i=cm(i);var g=i.ajax||{};if(p.getUrl=function(){return h},p.getHeaders=function(){return g.headers||{}},i.auth||n.auth){var s=i.auth||n.auth,r=s.username+":"+s.password,q=cD(unescape(encodeURIComponent(r)));g.headers=g.headers||{},g.headers.Authorization="Basic "+q}p._ajax=eV;var m;setTimeout(function(){j(null,p)}),p.type=function(){return"http"},p.id=v("id",function(x){k({},{method:"GET",url:kb(n,"")},function(y,A){var z=A&&A.uuid?A.uuid+n.db:dI(n,"");x(null,z)})}),p.request=v("request",function(x,y){x.url=dI(n,x.url),k({},x,y)}),p.compact=v("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=cm(x),k(x,{url:dI(n,"_compact"),method:"POST"},function(){function z(){p.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),p.bulkGet=c1("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),k({},{url:dI(n,"_bulk_get"+f8(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function F(L){return function(M,N){I[L]=N.results,++G===K&&C(null,{results:cO(I)})}}for(var J=f2,K=Math.ceil(y.docs.length/J),G=0,I=new Array(K),H=0;K>H;H++){var E=eB(y,["revs","attachments"]);E.ajax=g,E.docs=y.docs.slice(H*J,Math.min(y.docs.length,(H+1)*J)),fD(x,E,F(H))}}var x=this,z=kb(n,""),D=cB[z];"boolean"!=typeof D?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(cB[z]=!1,bJ(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{cB[z]=!0,C(null,F)}}):D?A(C):B()}),p._info=function(x){o().then(function(){k({},{method:"GET",url:dI(n,"")},function(y,z){return y?x(y):(z.host=dI(n,""),void x(null,z))})})["catch"](x)},p.get=v("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?e9.all(E.map(function(H){var I=G[H],J=cd(F._id)+"/"+l(H)+"?rev="+F._rev;return w(y,{method:"GET",url:dI(n,J),binary:!0}).then(function(K){return y.binary?K:new e9(function(L){jG(K,L)})}).then(function(K){delete I.stub,delete I.length,I.data=K})})):void 0}function x(E){return Array.isArray(E)?e9.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=cm(y);var D={};y.revs&&(D.revs=!0),y.revs_info&&(D.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),D.open_revs=y.open_revs),y.rev&&(D.rev=y.rev),y.conflicts&&(D.conflicts=y.conflicts),C=cd(C);var z={method:"GET",url:dI(n,C+f8(D))};w(y,z).then(function(E){return e9.resolve().then(function(){return y.attachments?x(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),p.remove=v("remove",function(z,x,B,y){var A;"string"==typeof x?(A={_id:z,_rev:x},"function"==typeof B&&(y=B,B={})):(A=z,"function"==typeof x?(y=x,B={}):(y=B,B=x));var C=A._rev||B.rev;k(B,{method:"DELETE",url:dI(n,cd(A._id))+"?rev="+C},y)}),p.getAttachment=v("getAttachment",function(z,B,x,A){"function"==typeof x&&(A=x,x={});var C=x.rev?"?rev="+x.rev:"",y=dI(n,cd(z))+"/"+l(B)+C;k(x,{method:"GET",url:y,binary:!0},A)}),p.removeAttachment=v("removeAttachment",function(A,y,z,B){var x=dI(n,cd(A)+"/"+l(y))+"?rev="+z;k({},{method:"DELETE",url:x},B)}),p.putAttachment=v("putAttachment",function(B,F,H,x,z,G){"function"==typeof z&&(G=z,z=x,x=H,H=null);var E=cd(B)+"/"+l(F),D=dI(n,E);if(H&&(D+="?rev="+H),"string"==typeof x){var y;try{y=ck(x)}catch(C){return G(eO(d1,"Attachment is not a valid base64 string"))}x=y?bf(y,z):""}var A={headers:{"Content-Type":z},method:"PUT",url:D,processData:!1,body:x,timeout:g.timeout||60000};k({},A,G)}),p._bulkDocs=function(y,z,x){y.new_edits=z.new_edits,o().then(function(){return e9.all(y.docs.map(fH))}).then(function(){k(z,{method:"POST",url:dI(n,"_bulk_docs"),body:y},function(B,A){return B?x(B):(A.forEach(function(C){C.ok=!0}),void x(null,A))})})["catch"](x)},p.allDocs=v("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=cm(C);var A,B={},x="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var z=f8(B);if("undefined"!=typeof C.keys){var D="keys="+encodeURIComponent(JSON.stringify(C.keys));D.length+z.length+1<=jT?z+="&"+D:(x="POST",A={keys:C.keys})}w(C,{method:x,url:dI(n,"_all_docs"+z),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(dD),y(null,E)})["catch"](y)}),p._changes=function(L){var D="batch_size" in L?L.batch_size:jL;L=cm(L),L.timeout="timeout" in L?L.timeout:"timeout" in g?g.timeout:30000;var B,J=L.timeout?{timeout:L.timeout-5000}:{},A="undefined"!=typeof L.limit?L.limit:!1;B="return_docs" in L?L.return_docs:"returnDocs" in L?L.returnDocs:!0;var H=A;if(L.style&&(J.style=L.style),(L.include_docs||L.filter&&"function"==typeof L.filter)&&(J.include_docs=!0),L.attachments&&(J.attachments=!0),L.continuous&&(J.feed="longpoll"),L.conflicts&&(J.conflicts=!0),L.descending&&(J.descending=!0),"heartbeat" in L?L.heartbeat&&(J.heartbeat=L.heartbeat):J.heartbeat=10000,L.filter&&"string"==typeof L.filter&&(J.filter=L.filter),L.view&&"string"==typeof L.view&&(J.filter="_view",J.view=L.view),L.query_params&&"object"==typeof L.query_params){for(var F in L.query_params){L.query_params.hasOwnProperty(F)&&(J[F]=L.query_params[F])}}var y,E="GET";if(L.doc_ids){J.filter="_doc_ids";var C=JSON.stringify(L.doc_ids);C.length<jT?J.doc_ids=C:(E="POST",y={doc_ids:L.doc_ids})}var z,K,x=function(N,M){if(!L.aborted){J.since=N,"object"==typeof J.since&&(J.since=JSON.stringify(J.since)),L.descending?A&&(J.limit=H):J.limit=!A||H>D?D:H;var O={method:E,url:dI(n,"_changes"+f8(J)),timeout:L.timeout,body:y};K=N,L.aborted||o().then(function(){z=k(L,O,M)})["catch"](M)}},I={results:[]},G=function(O,Q){if(!L.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,I.last_seq=Q.last_seq;var M={};M.query=L.query_params,Q.results=Q.results.filter(function(R){H--;var S=fK(L)(R);return S&&(L.include_docs&&L.attachments&&L.binary&&dD(R),B&&I.results.push(R),L.onChange(R)),S})}else{if(O){return L.aborted=!0,void L.complete(O)}}Q&&Q.last_seq&&(K=Q.last_seq);var N=A&&0>=H||Q&&D>P||L.descending;(!L.continuous||A&&0>=H)&&N?L.complete(null,I):setTimeout(function(){x(K,G)},0)}};return x(L.since||0,G),{cancel:function(){L.aborted=!0,z&&z.abort()}}},p.revsDiff=v("revsDiff",function(y,z,x){"function"==typeof z&&(x=z,z={}),k(z,{method:"POST",url:dI(n,"_revs_diff"),body:y},x)}),p._close=function(x){x()},p._destroy=function(x,y){k(x,{url:dI(n,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function fQ(g){g.adapter("http",c0,!1),g.adapter("https",c0,!1)}function jU(){this.promise=new e9(function(g){g()})}function f6(i){var k=i.db,l=i.viewName,m=i.map,j=i.reduce,g=i.temporary,n=m.toString()+(j&&j.toString())+"undefined";if(!g&&k._cachedViews){var h=k._cachedViews[n];if(h){return e9.resolve(h)}}return k.info().then(function(p){function o(u){u.views=u.views||{};var r=l;-1===r.indexOf("/")&&(r=l+"/"+l);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(g?"temp":c3(n));return cZ(k,"_local/mrviews",o).then(function(){return k.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:k,adapter:k.adapter,mapFun:m,reduceFun:j};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,g||(k._cachedViews=k._cachedViews||{},k._cachedViews[n]=r,r.db.once("destroyed",function(){delete k._cachedViews[n]})),r})})})})}function kj(i,l,k,h,j,g){return d5("return ("+i.replace(/;\s*$/,"")+");",{emit:l,sum:k,log:h,isArray:j,toJSON:g})}function cq(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function eb(g){return 1===g.length&&/^1-/.test(g[0].rev)}function kh(g,i){try{g.emit("error",i)}catch(h){e0("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),e0("error",i)}}function bU(g,i,h){try{return{output:i.apply(null,h)}}catch(j){return kh(g,j),{error:j}}}function eL(g,i){var h=jX.collate(g.key,i.key);return 0!==h?h:jX.collate(g.value,i.value)}function j3(g,i,h){return h=h||0,"number"==typeof i?g.slice(h,i+h):h>0?g.slice(h):g}function ek(g){var i=g.value,h=i&&"object"==typeof i&&i._id||g.id;return h}function aP(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=aO(k.data,k.content_type)})})}function cJ(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&aP(h),h}}function eY(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new cx(g)}function dR(i){for(var k=0,l=0,m=i.length;m>l;l++){var j=i[l];if("number"!=typeof j){if(!Array.isArray(j)){throw eY("_sum")}k="number"==typeof k?[k]:k;for(var g=0,n=j.length;n>g;g++){var h=j[g];if("number"!=typeof h){throw eY("_sum")}"undefined"==typeof k[g]?k.push(h):k[g]+=h}}else{"number"==typeof k?k+=j:k[0]+=j}}return k}function j9(h,k,j,g){var i=k[h];"undefined"!=typeof i&&(g&&(i=encodeURIComponent(JSON.stringify(i))),j.push(h+"="+i))}function e8(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function aI(g){return g.group_level=e8(g.group_level),g.limit=e8(g.limit),g.skip=e8(g.skip),g}function jP(g){if(g){if("number"!=typeof g){return new km('Invalid value for integer: "'+g+'"')}if(0>g){return new km('Invalid value for positive integer: "'+g+'"')}}}function cb(g,i){var h=g.descending?"endkey":"startkey",j=g.descending?"startkey":"endkey";if("undefined"!=typeof g[h]&&"undefined"!=typeof g[j]&&jX.collate(g[h],g[j])>0){throw new km("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(i.reduce&&g.reduce!==!1){if(g.include_docs){throw new km("{include_docs:true} is invalid for reduce")}if(g.keys&&g.keys.length>1&&!g.group&&!g.group_level){throw new km("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=jP(g[k]);if(l){throw l}})}function fN(h,j,n){var m,g=[],i="GET";if(j9("reduce",n,g),j9("include_docs",n,g),j9("attachments",n,g),j9("limit",n,g),j9("descending",n,g),j9("group",n,g),j9("group_level",n,g),j9("skip",n,g),j9("stale",n,g),j9("conflicts",n,g),j9("startkey",n,g,!0),j9("start_key",n,g,!0),j9("endkey",n,g,!0),j9("end_key",n,g,!0),j9("inclusive_end",n,g),j9("key",n,g,!0),g=g.join("&"),g=""===g?"":"?"+g,"undefined"!=typeof n.keys){var k=2000,l="keys="+encodeURIComponent(JSON.stringify(n.keys));l.length+g.length+1<=k?g+=("?"===g[0]?"&":"?")+l:(i="POST","string"==typeof j?m={keys:n.keys}:j.keys=n.keys)}if("string"==typeof j){var o=cq(j);return h.request({method:i,url:"_design/"+o[0]+"/_view/"+o[1]+g,body:m}).then(cJ(n))}return m=m||{},Object.keys(j).forEach(function(p){Array.isArray(j[p])?m[p]=j[p]:m[p]=j[p].toString()}),h.request({method:"POST",url:"_temp_view"+g,body:m}).then(cJ(n))}function b2(g,i,h){return new e9(function(j,k){g._query(i,h,function(m,l){return m?k(m):void j(l)})})}function kg(g){return new e9(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function ec(g){return function(h){if(404===h.status){return g}throw h}}function dA(i,m,h){function p(){return eb(q)?e9.resolve(l):m.db.get(j)["catch"](ec(l))}function n(r){return r.keys.length?m.db.allDocs({keys:r.keys,include_docs:!0}):e9.resolve({rows:[]})}function g(x,y){for(var s=[],A={},r=0,v=y.rows.length;v>r;r++){var w=y.rows[r],B=w.doc;if(B&&(s.push(B),A[B._id]=!0,B._deleted=!k[B._id],!B._deleted)){var z=k[B._id];"value" in z&&(B.value=z.value)}}var u=Object.keys(k);return u.forEach(function(C){if(!A[C]){var E={_id:C},D=k[C];"value" in D&&(E.value=D.value),s.push(E)}}),x.keys=az(u.concat(x.keys)),s.push(x),s}var j="_local/doc_"+i,l={_id:j,keys:[]},o=h[i],k=o.indexableKeysToKeyValues,q=o.changes;return p().then(function(r){return n(r).then(function(s){return g(r,s)})})}function eT(g,i,h){var j="_local/lastSeq";return g.db.get(j)["catch"](ec({_id:j,seq:0})).then(function(k){var l=Object.keys(i);return e9.all(l.map(function(m){return dA(m,g,i)})).then(function(m){var n=cO(m);return k.seq=h,n.push(k),g.db.bulkDocs({docs:n})})})}function em(g){var i="string"==typeof g?g:g.name,h=a9[i];return h||(h=a9[i]=new jU),h}function aC(g){return cN(em(g),function(){return ah(g)})()}function ah(h){function j(p,r){var q={id:g._id,key:jX.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=jX.normalizeKey(r)),m.push(q)}function n(q,p){return function(){return eT(h,q,p)}}var m,g,i;if("function"==typeof h.mapFun&&2===h.mapFun.length){var k=h.mapFun;i=function(p){return k(p,j)}}else{i=kj(h.mapFun.toString(),j,dR,aF,Array.isArray,JSON.parse)}var l=h.seq||0,o=new jU;return new e9(function(p,s){function r(){o.finish().then(function(){h.seq=l,p()})}function q(){function u(v){s(v)}h.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:l,limit:jS}).on("complete",function(C){var x=C.results;if(!x.length){return r()}for(var z={},v=0,F=x.length;F>v;v++){var A=x[v];if("_"!==A.doc._id[0]){m=[],g=A.doc,g._deleted||bU(h.sourceDB,i,[g]),m.sort(eL);for(var y,D={},H=0,E=m.length;E>H;H++){var G=m[H],w=[G.key,G.id];0===jX.collate(G.key,y)&&w.push(H);var B=jX.toIndexableString(w);D[B]=G,y=G.key}z[A.doc._id]={indexableKeysToKeyValues:D,changes:A.changes}}l=A.seq}return o.add(n(z,l)),x.length<jS?r():q()}).on("error",u)}q()})}function jI(i,m,h){0===h.group_level&&delete h.group_level;var p,n=h.group||h.group_level;p=bN[i.reduceFun]?bN[i.reduceFun]:kj(i.reduceFun.toString(),null,dR,aF,Array.isArray,JSON.parse);var g=[],j=isNaN(h.group_level)?Number.POSITIVE_INFINITY:h.group_level;m.forEach(function(r){var u=g[g.length-1],s=n?r.key:null;return n&&Array.isArray(s)&&(s=s.slice(0,j)),u&&0===jX.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void g.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),m=[];for(var l=0,o=g.length;o>l;l++){var k=g[l],q=bU(i.sourceDB,p,[k.keys,k.values,!1]);if(q.error&&q.error instanceof cx){throw q.error}m.push({value:q.error?null:q.output,key:k.groupKey})}return{rows:j3(m,h.limit,h.skip)}}function eq(h,g){return cN(em(h),function(){return eF(h,g)})()}function eF(r,n){function q(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return p=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=jX.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function o(w){var v;if(v=g?jI(r,w,n):{total_rows:p,offset:l,rows:w},n.include_docs){var u=az(w.map(ek));return r.sourceDB.allDocs({keys:u,include_docs:!0,conflicts:n.conflicts,attachments:n.attachments,binary:n.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),w.forEach(function(A){var B=ek(A),z=y["$"+B];z&&(A.doc=z)}),v})}return v}var p,g=r.reduceFun&&n.reduce!==!1,l=n.skip||0;if("undefined"==typeof n.keys||n.keys.length||(n.limit=0,delete n.keys),"undefined"!=typeof n.keys){var h=n.keys,m=h.map(function(v){var u={startkey:jX.toIndexableString([v]),endkey:jX.toIndexableString([v,{}])};return q(u)});return e9.all(m).then(cO).then(o)}var k={descending:n.descending};if(n.start_key&&(n.startkey=n.start_key),n.end_key&&(n.endkey=n.end_key),"undefined"!=typeof n.startkey&&(k.startkey=n.descending?jX.toIndexableString([n.startkey,{}]):jX.toIndexableString([n.startkey])),"undefined"!=typeof n.endkey){var i=n.inclusive_end!==!1;n.descending&&(i=!i),k.endkey=jX.toIndexableString(i?[n.endkey,{}]:[n.endkey])}if("undefined"!=typeof n.key){var s=jX.toIndexableString([n.key]),j=jX.toIndexableString([n.key,{}]);k.descending?(k.endkey=s,k.startkey=j):(k.startkey=s,k.endkey=j)}return g||("number"==typeof n.limit&&(k.limit=n.limit),k.skip=l),q(k).then(o)}function jO(g){return g.request({method:"POST",url:"_view_cleanup"})}function cC(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(k){var m=cq(k),n="_design/"+m[0],l=m[1];j[n]=j[n]||{},j[n][l]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(k){var l={};k.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){l[v]=l[v]||s})})});var n=Object.keys(l).filter(function(o){return !l[o]}),m=n.map(function(o){return cN(em(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return e9.all(m).then(function(){return{ok:!0}})})},ec({ok:!0}))}function ka(j,h,i){if("http"===j.type()){return fN(j,h,i)}if("function"==typeof j._query){return b2(j,h,i)}if("string"!=typeof h){cb(i,h);var l={db:j,viewName:"temp_view/temp_view",map:h.map,reduce:h.reduce,temporary:!0};return bj.add(function(){return f6(l).then(function(o){function p(){return o.db.destroy()}return ak(aC(o).then(function(){return eq(o,i)}),p)})}),bj.finish()}var k=h,n=cq(k),m=n[0],g=n[1];return j.get("_design/"+m).then(function(o){var p=o.views&&o.views[g];if(!p||"string"!=typeof p.map){throw new aX("ddoc "+m+" has no view named "+g)}cb(i,p);var q={db:j,viewName:k,map:p.map,reduce:p.reduce};return f6(q).then(function(r){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&ed.nextTick(function(){aC(r)}),eq(r,i)):aC(r).then(function(){return eq(r,i)})})})}function km(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,km)}catch(g){}}function aX(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,aX)}catch(g){}}function cx(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,cx)}catch(g){}}function da(g){return/^1-/.test(g)}function cz(g,i,h){return !g._attachments||!g._attachments[h]||g._attachments[h].digest!==i._attachments[h].digest}function fL(g,i){var h=Object.keys(i._attachments);return e9.all(h.map(function(j){return g.getAttachment(i._id,j,{rev:i._rev})}))}function dS(h,k,j){var g="http"===k.type()&&"http"!==h.type(),i=Object.keys(j._attachments);return g?h.get(j._id).then(function(l){return e9.all(i.map(function(m){return cz(l,j,m)?k.getAttachment(j._id,m):h.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return fL(k,j)}):fL(k,j)}function d4(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function eN(h,l,g,n){function p(){var r=d4(g);if(r.docs.length){return h.bulkGet(r).then(function(s){if(n.cancelled){throw new Error("cancelled")}return e9.all(s.results.map(function(u){return e9.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?dS(l,h,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){k=k.concat(cO(u).filter(Boolean))})})}}function i(r){return r._attachments&&Object.keys(r._attachments).length>0}function j(r){return h.allDocs({keys:r,include_docs:!0}).then(function(s){if(n.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&da(u.value.rev)&&!i(u.doc)&&(k.push(u.doc),delete g[u.id])})})}function o(){var r=Object.keys(g).filter(function(s){var u=g[s].missing;return 1===u.length&&da(u[0])});return r.length>0?j(r):void 0}function m(){return{ok:q,docs:k}}g=cm(g);var k=[],q=!0;return e9.resolve().then(o).then(p).then(m)}function ac(h,k,j,g,i){return h.get(k)["catch"](function(l){if(404===l.status){return"http"===h.type()&&bJ(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:g,_id:k,history:[],replicator:dK,version:cg}}throw l}).then(function(l){return i.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==g}),l.history.unshift({last_seq:j,session_id:g}),l.history=l.history.slice(0,d9),l.version=cg,l.replicator=dK,l.session_id=g,l.last_seq=j,h.put(l)["catch"](function(m){if(409===m.status){return ac(h,k,j,g,i)}throw m}))})}function kl(g,i,h,j){this.src=g,this.target=i,this.id=h,this.returnValue=j}function au(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:d0(h.history,g.history)}function d0(i,k){var l=i[0],m=i.slice(1),j=k[0],g=k.slice(1);if(!l||0===k.length){return{last_seq:b7,history:[]}}var n=l.session_id;if(dq(n,k)){return{last_seq:l.last_seq,history:i}}var h=j.session_id;return dq(h,m)?{last_seq:j.last_seq,history:g}:d0(m,g)}function dq(g,i){var h=i[0],j=i.slice(1);return g&&0!==i.length?g===h.session_id?!0:dq(g,j):!1}function e2(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function j2(g,i,h,j){return g.retry===!1?(i.emit("error",h),void i.removeAllListeners()):("function"!=typeof g.back_off_function&&(g.back_off_function=db),i.emit("requestError",h),"active"!==i.state&&"pending"!==i.state||(i.emit("paused",h),i.state="stopped",i.once("active",function(){g.current_back_off=ke})),g.current_back_off=g.current_back_off||ke,g.current_back_off=g.back_off_function(g.current_back_off),void setTimeout(j,g.current_back_off))}function eD(g){return Object.keys(g).sort(jX.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function jH(k,i,g){var j=g.doc_ids?g.doc_ids.sort(jX.collate):"",l=g.filter?g.filter.toString():"",m="",h="";return g.filter&&g.query_params&&(m=JSON.stringify(eD(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),e9.all([k.id(),i.id()]).then(function(n){var o=n[0]+n[1]+l+h+m+j;return new e9(function(p){jN(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function cY(K,h,u,o,s){function A(){return G?e9.resolve():jH(K,h,u).then(function(T){R=T,G=new kl(K,h,R,o)})}function n(){if(l=[],0!==I.docs.length){var T=I.docs;return h.bulkDocs({docs:T,new_edits:!1}).then(function(X){if(o.cancelled){throw r(),new Error("cancelled")}var U=[],W={};X.forEach(function(Z){Z.error&&(s.doc_write_failures++,U.push(Z),W[Z.id]=Z)}),J=J.concat(U),s.docs_written+=I.docs.length-U.length;var V=U.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=W[Z._id];ae?o.emit("denied",cm(ae)):l.push(Z)}),V.length>0){var Y=new Error("bulkDocs error");throw Y.other_errors=U,B("target.bulkDocs failed to write docs",Y),new Error("bulkWrite partial failure")}},function(U){throw s.doc_write_failures+=T.length,U})}}function i(){if(I.error){throw new Error("There was a problem getting docs.")}s.last_seq=z=I.seq;var T=cm(s);return l.length&&(T.docs=l,o.emit("change",T)),D=!0,G.writeCheckpoint(I.seq,L).then(function(){if(D=!1,o.cancelled){throw r(),new Error("cancelled")}I=void 0,w()})["catch"](g)}function N(){var T={};return I.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),h.revsDiff(T).then(function(U){if(o.cancelled){throw r(),new Error("cancelled")}I.diffs=U})}function F(){return eN(K,h,I.diffs,o).then(function(T){I.error=!T.ok,T.docs.forEach(function(U){delete I.diffs[U._id],s.docs_read++,I.docs.push(U)})})}function x(){if(!o.cancelled&&!I){if(0===y.length){return void P(!0)}I=y.shift(),N().then(F).then(n).then(i).then(x)["catch"](function(T){B("batch processing terminated with error",T)})}}function P(T){return 0===q.changes.length?void (0!==y.length||I||((k&&v.live||m)&&(o.state="pending",o.emit("paused")),m&&r())):void ((T||m||q.changes.length>=O)&&(y.push(q),q={seq:0,changes:[],docs:[]},"pending"!==o.state&&"stopped"!==o.state||(o.state="active",o.emit("active")),x()))}function B(U,T){E||(T.message||(T.message=U),s.ok=!1,s.status="aborting",s.errors.push(T),J=J.concat(T),y=[],q={seq:0,changes:[],docs:[]},r())}function r(){if(!(E||o.cancelled&&(s.status="cancelled",D))){s.status=s.status||"complete",s.end_time=new Date,s.last_seq=z,E=!0;var U=J.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=J.pop();J.length>0&&(T.other_errors=J),T.result=s,j2(u,o,T,function(){cY(K,h,u,o)})}else{s.errors=J,o.emit("complete",s),o.removeAllListeners()}}}function M(U){if(o.cancelled){return r()}var T=fK(u)(U);T&&(q.seq=U.seq,q.changes.push(U),P(0===y.length&&v.live))}function S(U){if(j=!1,o.cancelled){return r()}if(U.results.length>0){v.since=U.last_seq,w(),P(!0)}else{var T=function(){k?(v.live=!0,w()):m=!0,P(!0)};I||0!==U.results.length?T():(D=!0,G.writeCheckpoint(U.last_seq,L).then(function(){D=!1,s.last_seq=z=U.last_seq,T()})["catch"](g))}}function p(T){return j=!1,o.cancelled?r():void B("changes rejected",T)}function w(){function T(){V.cancel()}function U(){o.removeListener("cancel",T)}if(!j&&!m&&y.length<Q){j=!0,o._changes&&(o.removeListener("cancel",o._abortChanges),o._changes.cancel()),o.once("cancel",T);var V=K.changes(v).on("change",M);V.then(U,U),V.then(S)["catch"](p),u.retry&&(o._changes=V,o._abortChanges=T)}}function C(){A().then(function(){return o.cancelled?void r():G.getCheckpoint().then(function(T){z=T,v={since:z,limit:O,batch_size:O,style:"all_docs",doc_ids:H,return_docs:!0},u.filter&&("string"!=typeof u.filter?v.include_docs=!0:v.filter=u.filter),"heartbeat" in u&&(v.heartbeat=u.heartbeat),"timeout" in u&&(v.timeout=u.timeout),u.query_params&&(v.query_params=u.query_params),u.view&&(v.view=u.view),w()})})["catch"](function(T){B("getCheckpoint rejected with ",T)})}function g(T){throw D=!1,B("writeCheckpoint completed with error",T),T}var I,R,G,y=[],q={seq:0,changes:[],docs:[]},D=!1,m=!1,E=!1,z=0,k=u.continuous||u.live||!1,O=u.batch_size||100,Q=u.batches_limit||10,j=!1,H=u.doc_ids,J=[],l=[],L=bc();s=s||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var v={};return o.ready(K,h),o.cancelled?void r():(o._addedListeners||(o.once("cancel",r),"function"==typeof u.complete&&(o.once("error",u.complete),o.once("complete",function(T){u.complete(null,T)})),o._addedListeners=!0),void ("undefined"==typeof u.since?C():A().then(function(){return D=!0,G.writeCheckpoint(u.since,L)}).then(function(){return D=!1,o.cancelled?void r():(z=u.since,void C())})["catch"](g)))}function cL(){b9.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new e9(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function fR(g,i){var h=i.PouchConstructor;return"string"==typeof g?new h(g,i):g}function dU(k,i,g,j){if("function"==typeof g&&(j=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw eO(jR,"`doc_ids` filter parameter is not a list.")}g.complete=j,g=cm(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var l=new cL(g),m=fR(k,g),h=fR(i,g);return cY(m,h,g,l),l}function dc(g,i,h,j){return"function"==typeof h&&(j=h,h={}),"undefined"==typeof h&&(h={}),h=cm(h),h.PouchConstructor=h.PouchConstructor||this,g=fR(g,h),i=fR(i,h),new bb(g,i,h,j)}function bb(q,y,k,s){function x(z){o.emit("change",{direction:"pull",change:z})}function n(z){o.emit("change",{direction:"push",change:z})}function w(z){o.emit("denied",{direction:"push",doc:z})}function l(z){o.emit("denied",{direction:"pull",doc:z})}function i(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function u(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function p(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function m(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}function r(z){return function(D,C){var A="change"===D&&(C===x||C===n),F="denied"===D&&(C===l||C===w),B="paused"===D&&(C===u||C===i),E="active"===D&&(C===m||C===p);(A||F||B||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&o.removeAllListeners(D))}}var o=this;this.canceled=!1;var v=k.push?cc.extend({},k,k.push):k,h=k.pull?cc.extend({},k,k.pull):k;this.push=dU(q,y,v),this.pull=dU(y,q,h),this.pushPaused=!0,this.pullPaused=!0;var g={};k.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(z){"change"===z?(o.pull.on("change",x),o.push.on("change",n)):"denied"===z?(o.pull.on("denied",l),o.push.on("denied",w)):"active"===z?(o.pull.on("active",m),o.push.on("active",p)):"paused"===z&&(o.pull.on("paused",u),o.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(o.pull.removeListener("change",x),o.push.removeListener("change",n)):"denied"===z?(o.pull.removeListener("denied",l),o.push.removeListener("denied",w)):"active"===z?(o.pull.removeListener("active",m),o.push.removeListener("active",p)):"paused"===z&&(o.pull.removeListener("paused",u),o.push.removeListener("paused",i))}),this.pull.on("removeListener",r("pull")),this.push.on("removeListener",r("push"));var j=e9.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return o.emit("complete",z),s&&s(null,z),o.removeAllListeners(),z},function(z){if(o.cancel(),s?s(z):o.emit("error",z),o.removeAllListeners(),s){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function dN(g){g.replicate=dU,g.sync=dc}var fI,cc=f(9),dO=e4(f(5)),aZ=e4(f(8)),aK=e4(f(10)),bz=f(14),dm=e4(f(4)),b9=f(1),d5=e4(f(15)),e6=e4(f(16)),cf=e4(f(17)),jX=f(12),e9="function"==typeof Promise?Promise:aK,dw=Function.prototype.toString,b6=dw.call(Object),kd=dO("pouchdb:api"),cl=6;if(jJ()){fI=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),fI=!!localStorage.getItem("_pouch_check_localstorage")}catch(bQ){fI=!1}}aZ(bq,b9.EventEmitter),bq.prototype.addListener=function(k,i,g,j){function l(){function n(){h=!1}if(m._listeners[i]){if(h){return void (h="waiting")}h=!0;var o=eB(j,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>j.since&&!j.cancelled&&(j.since=p.seq,j.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){l()},0),h=!1}).on("error",n)}}if(!this._listeners[i]){var m=this,h=!1;this._listeners[i]=l,this.on(k,l)}},bq.prototype.removeListener=function(h,g){g in this._listeners&&b9.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},bq.prototype.notifyLocalWindows=function(g){jJ()?chrome.storage.local.set({dbName:g}):ds()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},bq.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},aZ(d8,Error),d8.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ca=new d8({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),ba=new d8({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),cS=new d8({status:404,error:"not_found",reason:"missing"}),by=new d8({status:409,error:"conflict",reason:"Document update conflict"}),c2=new d8({status:400,error:"invalid_id",reason:"_id field must contain a string"}),cM=new d8({status:412,error:"missing_id",reason:"_id is required for puts"}),f7=new d8({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),eW=new d8({status:412,error:"precondition_failed",reason:"Database not open"}),fG=new d8({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),d1=new d8({status:500,error:"badarg",reason:"Some query argument is invalid"}),cs=new d8({status:400,error:"invalid_request",reason:"Request was invalid"}),bv=new d8({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),eJ=new d8({status:500,error:"doc_validation",reason:"Bad special document member"}),jR=new d8({status:400,error:"bad_request",reason:"Something wrong with the request"}),bF=new d8({status:400,error:"bad_request",reason:"Document must be a JSON object"}),dF=new d8({status:404,error:"not_found",reason:"Database not found"}),dV=new d8({status:500,error:"indexed_db_went_bad",reason:"unknown"}),eP=new d8({status:500,error:"web_sql_went_bad",reason:"unknown"}),dP=new d8({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),ef=new d8({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),eQ=new d8({status:400,error:"bad_request",reason:"Invalid rev format"}),bA=new d8({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),eH=new d8({status:412,error:"missing_stub"}),dJ=new d8({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),bw=[ca,ba,cS,by,c2,cM,f7,eW,fG,d1,cs,bv,eJ,jR,bF,dF,eP,dP,ef,eQ,bA,eH,dV,dJ],cu=function(g,i,h){var j=bw.filter(function(k){return k[g]===i});return h&&j.filter(function(k){return k.message===h})[0]||j[0]},c8=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],cG="queryKey",fO=/(?:^|&)([^&=]*)=?([^&]*)/g,eZ=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ea="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");aZ(ch,b9.EventEmitter),ch.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},ch.prototype.doChanges=function(h){var k=this,j=h.complete;if(h=cm(h),"live" in h&&!("continuous" in h)&&(h.continuous=h.live),h.processChange=cp,"latest"===h.since&&(h.since="now"),h.since||(h.since=0),"now"===h.since){return void this.db.info().then(function(l){return k.isCancelled?void j(null,{status:"cancelled"}):(h.since=l.update_seq,void k.doChanges(h))},j)}if(h.continuous&&"now"!==h.since&&this.db.info().then(function(l){k.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),h.view&&!h.filter&&(h.filter="_view"),h.filter&&"string"==typeof h.filter&&("_view"===h.filter?h.view=a8(h.view):h.filter=a8(h.filter),"http"!==this.db.type()&&!h.doc_ids)){return this.filterChanges(h)}"descending" in h||(h.descending=!1),h.limit=0===h.limit?1:h.limit,h.complete=j;var g=this.db._changes(h);if(g&&"function"==typeof g.cancel){var i=k.cancel;k.cancel=dm(function(l){g.cancel(),i.apply(this,l)})}},ch.prototype.filterChanges=function(i){var l=this,k=i.complete;if("_view"===i.filter){if(!i.view||"string"!=typeof i.view){var h=eO(jR,"`view` filter parameter not found or invalid.");return k(h)}var j=dC(i.view);this.db.get("_design/"+j[0],function(o,n){if(l.isCancelled){return k(null,{status:"cancelled"})}if(o){return k(eU(o))}var m=n&&n.views&&n.views[j[1]]&&n.views[j[1]].map;return m?(i.filter=aD(m),void l.doChanges(i)):k(eO(cS,n.views?"missing json key: "+j[1]:"missing json key: views"))})}else{var g=dC(i.filter);if(!g){return l.doChanges(i)}this.db.get("_design/"+g[0],function(m,n){if(l.isCancelled){return k(null,{status:"cancelled"})}if(m){return k(eU(m))}var o=n&&n.filters&&n.filters[g[1]];return o?(i.filter=ep(o),void l.doChanges(i)):k(eO(cS,n&&n.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},aZ(dX,b9.EventEmitter),dX.prototype.post=c1("post",function(g,i,h){return"function"==typeof i&&(h=i,i={}),"object"!=typeof g||Array.isArray(g)?h(eO(bF)):void this.bulkDocs({docs:[g]},i,fM(h))}),dX.prototype.put=c1("put",dm(function(h){function j(){k||(e0("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),k=!0)}var n,m,g,i,k=!1,l=h.shift(),o="_id" in l;if("object"!=typeof l||Array.isArray(l)){return(i=h.pop())(eO(bF))}for(;;){if(n=h.shift(),m=typeof n,"string"!==m||o?"string"!==m||!o||"_rev" in l?"object"===m?g=n:"function"===m&&(i=n):(j(),l._rev=n):(j(),l._id=n,o=!0),!h.length){break}}return g=g||{},bS(l._id),bV(l._id)&&"function"==typeof this._putLocal?l._deleted?this._removeLocal(l,i):this._putLocal(l,i):void this.bulkDocs({docs:[l]},g,fM(i))})),dX.prototype.putAttachment=c1("putAttachment",function(k,i,g,j,l){function m(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[i]={content_type:l,data:j,revpos:++n},h.put(o)}var h=this;return"function"==typeof l&&(l=j,j=g,g=null),"undefined"==typeof l&&(l=j,j=g,g=null),h.get(k).then(function(n){if(n._rev!==g){throw eO(by)}return m(n)},function(n){if(n.reason===cS.message){return m({_id:k})}throw n})}),dX.prototype.removeAttachment=c1("removeAttachment",function(h,k,j,g){var i=this;i.get(h,function(m,l){return m?void g(m):l._rev!==j?void g(eO(by)):l._attachments?(delete l._attachments[k],0===Object.keys(l._attachments).length&&delete l._attachments,void i.put(l,g)):g()})}),dX.prototype.remove=c1("remove",function(i,l,k,h){var j;"string"==typeof l?(j={_id:i,_rev:l},"function"==typeof k&&(h=k,k={})):(j=i,"function"==typeof l?(h=l,k={}):(h=k,k=l)),k=k||{},k.was_delete=!0;var g={_id:j._id,_rev:j._rev||k.rev};return g._deleted=!0,bV(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(j,h):void this.bulkDocs({docs:[g]},k,fM(h))}),dX.prototype.revsDiff=c1("revsDiff",function(i,k,l){function m(o,p){h.has(o)||h.set(o,{missing:[]}),h.get(o).missing.push(p)}function j(q,p){var o=i[q].slice(0);ay(p,function(s,r,x,v,w){var y=r+"-"+x,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==w.status&&m(q,y))}),o.forEach(function(r){m(q,r)})}"function"==typeof k&&(l=k,k={});var g=Object.keys(i);if(!g.length){return l(null,{})}var n=0,h=new bz.Map;g.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){h.set(o,{missing:i[o]})}else{if(q){return l(q)}j(o,p)}if(++n===g.length){var r={};return h.forEach(function(u,s){r[s]=u}),l(null,r)}})},this)}),dX.prototype.bulkGet=c1("bulkGet",function(h,g){fD(this,h,g)}),dX.prototype.compactDocument=c1("compactDocument",function(g,i,h){var j=this;this._getRevisionTree(g,function(n,l){if(n){return h(n)}var o=fP(l),m=[],k=[];Object.keys(o).forEach(function(p){o[p]>i&&m.push(p)}),ay(l,function(q,v,s,p,r){var u=v+"-"+s;"available"===r.status&&-1!==m.indexOf(u)&&k.push(u)}),j._doCompaction(g,k,h)})}),dX.prototype.compact=c1("compact",function(g,i){"function"==typeof g&&(i=g,g={});var h=this;g=g||{},h._compactionQueue=h._compactionQueue||[],h._compactionQueue.push({opts:g,callback:i}),1===h._compactionQueue.length&&aj(h)}),dX.prototype._compact=function(k,i){function g(n){h.push(l.compactDocument(n.id,0))}function j(o){var n=o.last_seq;e9.all(h).then(function(){return cZ(l,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){i(null,{ok:!0})})["catch"](i)}var l=this,m={return_docs:!1,last_seq:k.last_seq||0},h=[];l.changes(m).on("change",g).on("complete",j).on("error",i)},dX.prototype.get=c1("get",function(i,k,l){function m(){var o=[],p=j.length;return p?void j.forEach(function(q){g.get(i,{rev:q,revs:k.revs,attachments:k.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||l(null,o)})}):l(null,o)}if("function"==typeof k&&(l=k,k={}),"string"!=typeof i){return l(eO(c2))}if(bV(i)&&"function"==typeof this._getLocal){return this._getLocal(i,l)}var j=[],g=this;if(!k.open_revs){return this._get(i,k,function(B,o){if(B){return l(B)}var s=o.doc,p=o.metadata,v=o.ctx;if(k.conflicts){var y=jY(p);y.length&&(s._conflicts=y)}if(cE(p,s._rev)&&(s._deleted=!0),k.revs||k.revs_info){var r=c4(p.rev_tree),A=aY(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(s._rev.split("-")[1])}),x=A.ids.map(function(D){return D.id}).indexOf(s._rev.split("-")[1])+1,C=A.ids.length-x;if(A.ids.splice(x,C),A.ids.reverse(),k.revs&&(s._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),k.revs_info){var u=A.pos+A.ids.length;s._revs_info=A.ids.map(function(D){return u--,{rev:u+"-"+D.id,status:D.opts.status}})}}if(k.attachments&&s._attachments){var q=s._attachments,w=Object.keys(q).length;if(0===w){return l(null,s)}Object.keys(q).forEach(function(D){this._getAttachment(s._id,D,q[D],{rev:s._rev,binary:k.binary,ctx:v},function(F,G){var E=s._attachments[D];E.data=G,delete E.stub,delete E.length,--w||l(null,s)})},g)}else{if(s._attachments){for(var z in s._attachments){s._attachments.hasOwnProperty(z)&&(s._attachments[z].stub=!0)}}l(null,s)}})}if("all"===k.open_revs){this._getRevisionTree(i,function(o,p){return o?l(o):(j=bl(p).map(function(q){return q.rev}),void m())})}else{if(!Array.isArray(k.open_revs)){return l(eO(fG,"function_clause"))}j=k.open_revs;for(var n=0;n<j.length;n++){var h=j[n];if("string"!=typeof h||!/^\d+-/.test(h)){return l(eO(eQ))}}m()}}),dX.prototype.getAttachment=c1("getAttachment",function(h,k,j,g){var i=this;j instanceof Function&&(g=j,j={}),this._get(h,j,function(m,l){return m?g(m):l.doc._attachments&&l.doc._attachments[k]?(j.ctx=l.ctx,j.binary=!0,i._getAttachment(h,k,l.doc._attachments[k],j,g),void 0):g(eO(cS))})}),dX.prototype.allDocs=c1("allDocs",function(g,i){if("function"==typeof g&&(i=g,g={}),g.skip="undefined"!=typeof g.skip?g.skip:0,g.start_key&&(g.startkey=g.start_key),g.end_key&&(g.endkey=g.end_key),"keys" in g){if(!Array.isArray(g.keys)){return i(new TypeError("options.keys must be an array"))}var h=["startkey","endkey","key"].filter(function(j){return j in g})[0];if(h){return void i(eO(bv,"Query parameter `"+h+"` is not compatible with multi-get"))}if("http"!==this.type()){return aA(this,g,i)}}return this._allDocs(g,i)}),dX.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new ch(this,h,g)},dX.prototype.close=c1("close",function(g){return this._closed=!0,this._close(g)}),dX.prototype.info=c1("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),dX.prototype.id=c1("id",function(g){return this._id(g)}),dX.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},dX.prototype.bulkDocs=c1("bulkDocs",function(h,k,j){if("function"==typeof k&&(j=k,k={}),k=k||{},Array.isArray(h)&&(h={docs:h}),!h||!h.docs||!Array.isArray(h.docs)){return j(eO(ba))}for(var g=0;g<h.docs.length;++g){if("object"!=typeof h.docs[g]||Array.isArray(h.docs[g])){return j(eO(bF))}}var i;return h.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){i=i||d3(m)})}),i?j(eO(jR,i)):("new_edits" in k||("new_edits" in h?k.new_edits=h.new_edits:k.new_edits=!0),k.new_edits||"http"===this.type()||h.docs.sort(cF),e1(h.docs),this._bulkDocs(h,k,function(m,l){return m?j(m):(k.new_edits||(l=l.filter(function(n){return n.error})),void j(null,l))}))}),dX.prototype.registerDependentDatabase=c1("registerDependentDatabase",function(g,i){function h(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[g]?!1:(k.dependentDbs[g]=!0,k)}var j=new this.constructor(g,this.__opts);cZ(this,"_local/_pouch_dependentDbs",h).then(function(){i(null,{db:j})})["catch"](i)}),dX.prototype.destroy=c1("destroy",function(h,k){function j(){g._destroy(h,function(l,m){return l?k(l):(g._destroyed=!0,g.emit("destroyed"),void k(null,m||{ok:!0}))})}"function"==typeof h&&(k=h,h={});var g=this,i="use_prefix" in g?g.use_prefix:!0;return"http"===g.type()?j():void g.get("_local/_pouch_dependentDbs",function(o,m){if(o){return 404!==o.status?k(o):j()}var p=m.dependentDbs,n=g.constructor,l=Object.keys(p).map(function(r){var q=i?r.replace(new RegExp("^"+n.prefix),""):r;return new n(q,g.__opts).destroy()});e9.all(l).then(j,k)})}),b8.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},b8.prototype.fail=function(g){this.failed=g,this.execute()},b8.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},b8.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},aZ(eh,dX),eh.debug=dO,eh.adapters={},eh.preferredAdapters=[],eh.prefix="_pouch_";var df=new b9.EventEmitter;c9(eh),eh.parseAdapter=function(i,k){var l,m,j=i.match(/([a-z\-]*):\/\/(.*)/);if(j){if(i=/http(s?)/.test(j[1])?j[1]+"://"+j[2]:j[2],l=j[1],!eh.adapters[l].valid()){throw"Invalid adapter"}return{name:i,adapter:j[1]}}var g="idb" in eh.adapters&&"websql" in eh.adapters&&ds()&&localStorage["_pouch__websqldb_"+eh.prefix+i];if(k.adapter){m=k.adapter}else{if("undefined"!=typeof k&&k.db){m="leveldb"}else{for(var n=0;n<eh.preferredAdapters.length;++n){if(m=eh.preferredAdapters[n],m in eh.adapters){if(g&&"idb"===m){e0("log",'PouchDB is downgrading "'+i+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}l=eh.adapters[m];var h=l&&"use_prefix" in l?l.use_prefix:!0;return{name:h?eh.prefix+i:i,adapter:m}},eh.adapter=function(g,i,h){i.valid()&&(eh.adapters[g]=i,h&&eh.preferredAdapters.push(g))},eh.plugin=function(g){return"function"==typeof g?g(eh):Object.keys(g).forEach(function(h){eh.prototype[h]=g[h]}),eh},eh.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=cc.extend({},h,i),void eh.call(this,k,i,j)):new g(k,i,j)}return aZ(g,eh),g.preferredAdapters=eh.preferredAdapters.slice(),Object.keys(eh).forEach(function(i){i in g||(g[i]=eh[i])}),g};var fC="5.4.4";eh.version=fC;var f1,bE=aU(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),e7=aU(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),ck=function(g){return atob(g)},cD=function(g){return btoa(g)},bG=dZ.setImmediate||dZ.setTimeout,d6=32768,dG=5,bW="document-store",cA="by-sequence",dx="attach-store",kf="attach-seq-store",jZ="meta-store",ag="local-store",aS="detect-blob-support",dL={running:!1,queue:[]},f4=new bz.Map,cK=new bq,aN=new bz.Map;jM.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var bD=7,aW=bY("document-store"),cQ=bY("by-sequence"),bx=bY("attach-store"),cT=bY("local-store"),bL=bY("metadata-store"),fA=bY("attach-seq-store"),ab=new bz.Map,f0=new bq,fF=1,j4="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+cQ+" (seq, deleted)",bg="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+cQ+" (doc_id, rev)",kc="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+aW+" (winningseq)",c7="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+fA+" (seq)",bT="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+fA+" (digest, seq)",b5=cQ+".seq = "+aW+".winningseq",cW=cQ+".seq AS seq, "+cQ+".deleted AS deleted, "+cQ+".json AS data, "+cQ+".rev AS rev, "+aW+".json AS metadata";cP.valid=f9,cP.use_prefix=!0;var dB=c6(),j5=function(){},jL=25,f2=50,cB={},jT=1800,jK=dO("pouchdb:http");c0.valid=function(){return !0},jU.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},jU.prototype.finish=function(){return this.promise};var dp=function(h,g){return g&&h.then(function(i){ed.nextTick(function(){g(null,i)})},function(i){ed.nextTick(function(){g(i)})}),h},cv=function(g){return dm(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&dp(i,j),i})},ak=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},cN=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},az=function(i){for(var l={},k=0,h=i.length;h>k;k++){l["$"+i[k]]=!0}var j=Object.keys(l),g=new Array(j.length);for(k=0,h=j.length;h>k;k++){g[k]=j[k].substring(1)}return g},a9={},bj=new jU,jS=50,aF=e0.bind(null,"log"),bN={_sum:function(h,g){return dR(g)},_count:function(h,g){return g.length},_stats:function(g,i){function h(k){for(var n=0,m=0,j=k.length;j>m;m++){var l=k[m];n+=l*l}return n}return{sum:dR(i),min:Math.min.apply(null,i),max:Math.max.apply(null,i),count:i.length,sumsqr:h(i)}}},bZ=cv(function(){var g=this;return"http"===g.type()?jO(g):"function"==typeof g._viewCleanup?kg(g):cC(g)}),ax=function(h,k,j){"function"==typeof k&&(j=k,k={}),k=k?aI(k):{},"function"==typeof h&&(h={map:h});var g=this,i=e9.resolve().then(function(){return ka(g,h,k)});return dp(i,j),i};aZ(km,Error),aZ(aX,Error),aZ(cx,Error);var d7={query:ax,viewCleanup:bZ},cg=1,dK="pouchdb",d9=5,b7=0;kl.prototype.writeCheckpoint=function(g,i){var h=this;return this.updateTarget(g,i).then(function(){return h.updateSource(g,i)})},kl.prototype.updateTarget=function(h,g){return ac(this.target,this.id,h,g,this.returnValue)},kl.prototype.updateSource=function(g,i){var h=this;return this.readOnlySource?e9.resolve(!0):ac(this.src,this.id,g,i,this.returnValue)["catch"](function(j){if(e2(j)){return h.readOnlySource=!0,!0}throw j})};var bp={undefined:function(h,g){return 0===jX.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return au(g,h).last_seq}};kl.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?e9.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return b7}var j;return j=h.version?h.version.toString():"undefined",j in bp?bp[j](h,i):b7},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:b7}).then(function(){return b7},function(j){return e2(j)?(g.readOnlySource=!0,h.last_seq):b7})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return b7})};var ke=0;aZ(cL,b9.EventEmitter),cL.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},cL.prototype.ready=function(h,k){function j(){i.cancel()}function g(){h.removeListener("destroyed",j),k.removeListener("destroyed",j)}var i=this;i._readyCalled||(i._readyCalled=!0,h.once("destroyed",j),k.once("destroyed",j),i.once("complete",g))},aZ(bb,b9.EventEmitter),bb.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},eh.plugin(bu).plugin(eI).plugin(fQ).plugin(d7).plugin(dN),d.exports=eh}).call(this,f(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var p="color: "+this.color;n=[n[0],p,"color: inherit"].concat(Array.prototype.slice.call(n,1));var i=0,o=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(i++,"%c"===q&&(o=i))}),n.splice(o,0,p),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(c,j,p){function l(){return p.colors[v++%p.colors.length]}function m(f){function n(){}function e(){var u=e,o=+new Date,x=o-(d||o);u.diff=x,u.prev=d,u.curr=o,d=o,null==u.useColors&&(u.useColors=p.useColors()),null==u.color&&u.useColors&&(u.color=l());var s=Array.prototype.slice.call(arguments);s[0]=p.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var r=0;s[0]=s[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}r++;var w=p.formatters[B];if("function"==typeof w){var C=s[r];D=w.call(u,C),s.splice(r,1),r--}return D}),"function"==typeof p.formatArgs&&(s=p.formatArgs.apply(u,s));var t=e.log||p.log||console.log.bind(console);t.apply(u,s)}n.enabled=!1,e.enabled=!0;var i=p.enabled(f)?e:n;return i.namespace=f,i}function q(e){p.save(e);for(var f=(e||"").split(/[\s,]+/),n=f.length,i=0;n>i;i++){f[i]&&(e=f[i].replace(/\*/g,".*?"),"-"===e[0]?p.skips.push(new RegExp("^"+e.substr(1)+"$")):p.names.push(new RegExp("^"+e+"$")))}}function g(){p.enable("")}function k(i){var e,f;for(e=0,f=p.skips.length;f>e;e++){if(p.skips[e].test(i)){return !1}}for(e=0,f=p.names.length;f>e;e++){if(p.names[e].test(i)){return !0}}return !1}function h(e){return e instanceof Error?e.stack||e.message:e}p=j.exports=m,p.coerce=h,p.disable=g,p.enable=q,p.enabled=k,p.humanize=c(11),p.names=[],p.skips=[],p.formatters={};var d,v=0},{11:11}],7:[function(f,d,c){(function(h){function v(){g=!0;for(var i,n,l=w.length;l;){for(n=w,w=[],i=-1;++i<l;){n[i]()}l=w.length}g=!1}function p(i){1!==w.push(i)||g||q()}var q,e=h.MutationObserver||h.WebKitMutationObserver;if(e){var j=0,m=new e(v),k=h.document.createTextNode("");m.observe(k,{characterData:!0}),q=function(){k.data=j=++j%2}}else{if(h.setImmediate||"undefined"==typeof h.MessageChannel){q="document" in h&&"onreadystatechange" in h.document.createElement("script")?function(){var i=h.document.createElement("script");i.onreadystatechange=function(){v(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},h.document.documentElement.appendChild(i)}:function(){setTimeout(v,0)}}else{var t=new h.MessageChannel;t.port1.onmessage=v,q=function(){t.port2.postMessage(0)}}}var g,w=[];d.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(f,d,c){"function"==typeof Object.create?d.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:d.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(f,d,c){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(B,k,G){function A(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=F,this.queue=[],this.outcome=void 0,e!==A&&g(this,e)}function J(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function H(f,e,h){D(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function z(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(h,l){function f(o){e||(e=!0,d.reject(h,o))}function m(o){e||(e=!0,d.resolve(h,o))}function i(){l(m,f)}var e=!1,n=E(i);"error"===n.status&&f(n.value)}function E(e,h){var f={};try{f.value=e(h),f.status="success"}catch(i){f.status="error",f.value=i}return f}function q(e){return e instanceof this?e:d.resolve(new this(A),e)}function w(f){var e=new this(A);return d.reject(e,f)}function C(i){function o(r,s){function t(u){f[s]=u,++l!==p||h||(h=!0,d.resolve(m,f))}e.resolve(r).then(t,function(u){h||(h=!0,d.reject(m,u))})}var e=this;if("[object Array]"!==Object.prototype.toString.call(i)){return this.reject(new TypeError("must be an array"))}var p=i.length,h=!1;if(!p){return this.resolve([])}for(var f=new Array(p),l=0,n=-1,m=new this(A);++n<p;){o(i[n],n)}return m}function x(h){function l(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(m,p))},function(p){e||(e=!0,d.reject(m,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var i=h.length,e=!1;if(!i){return this.resolve([])}for(var n=-1,m=new this(A);++n<i;){l(h[n])}return m}var D=B(7),d={},c=["REJECTED"],I=["FULFILLED"],F=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(i,h){if("function"!=typeof i&&this.state===I||"function"!=typeof h&&this.state===c){return this}var f=new this.constructor(A);if(this.state!==F){var e=this.state===I?i:h;H(f,e,this.outcome)}else{this.queue.push(new J(f,i,h))}return f},J.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},J.prototype.otherCallFulfilled=function(e){H(this.promise,this.onFulfilled,e)},J.prototype.callRejected=function(e){d.reject(this.promise,e)},J.prototype.otherCallRejected=function(e){H(this.promise,this.onRejected,e)},d.resolve=function(m,f){var i=E(z,f);if("error"===i.status){return d.reject(m,i.value)}var l=i.value;if(l){g(m,l)}else{m.state=I,m.outcome=f;for(var h=-1,e=m.queue.length;++h<e;){m.queue[h].callFulfilled(f)}}return m},d.reject=function(e,h){e.state=c,e.outcome=h;for(var f=-1,i=e.queue.length;++f<i;){e.queue[f].callRejected(h)}return e},j.resolve=q,j.reject=w,j.all=C,j.race=x},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(j,d,m){function y(e){if(null!==e){switch(typeof e){case"boolean":return e?1:0;case"number":return z(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var l=Array.isArray(e),f=l?e:Object.keys(e),o=-1,i=f.length,n="";if(l){for(;++o<i;){n+=m.toIndexableString(f[o])}}else{for(;++o<i;){var h=f[o];n+=m.toIndexableString(h)+m.toIndexableString(e[h])}}return n}}return""}function c(h,o){var e,r=o,s="1"===h[o];if(s){e=0,o++}else{var f="0"===h[o];o++;var l="",p=h.substring(o,o+g),n=parseInt(p,10)+B;for(f&&(n=-n),o+=g;;){var i=h[o];if("\x00"===i){break}l+=i,o++}l=l.split("."),e=1===l.length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),f&&(e-=10),0!==n&&(e=parseFloat(e+"e"+n))}return{num:e,length:o-r}}function v(f,o){var l=f.pop();if(o.length){var n=o[o.length-1];l===n.element&&(o.pop(),n=o[o.length-1]);var i=n.element,e=n.index;if(Array.isArray(i)){i.push(l)}else{if(e===f.length-2){var h=f.pop();i[h]=l}else{f.push(l)}}}}function C(l,h){for(var i=Math.min(l.length,h.length),e=0;i>e;e++){var f=m.collate(l[e],h[e]);if(0!==f){return f}}return l.length===h.length?0:l.length>h.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(e,l){for(var f=Object.keys(e),o=Object.keys(l),i=Math.min(f.length,o.length),n=0;i>n;n++){var h=m.collate(f[n],o[n]);if(0!==h){return h}if(h=m.collate(e[f[n]],l[o[n]]),0!==h){return h}}return f.length===o.length?0:f.length>o.length?1:-1}function q(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function z(n){if(0===n){return"1"}var r=n.toExponential().split(/e\+?/),i=parseInt(r[1],10),f=0>n,h=f?"0":"2",l=(f?-i:i)-B,o=k.padLeft(l.toString(),"0",g);h+=w+o;var e=Math.abs(parseFloat(r[0]));f&&(e=10-e);var p=e.toFixed(20);return p=p.replace(/\.?0+$/,""),h+=w+p}var B=-324,g=3,w="",k=j(13);m.collate=function(h,e){if(h===e){return 0}h=m.normalizeKey(h),e=m.normalizeKey(e);var f=q(h),i=q(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},m.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var e=0;i>e;e++){l[e]=m.normalizeKey(h[e])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var n in h){if(h.hasOwnProperty(n)){var f=h[n];"undefined"!=typeof f&&(l[n]=m.normalizeKey(f))}}}}}return l},m.toIndexableString=function(f){var e="\x00";return f=m.normalizeKey(f),q(f)+w+y(f)+e},m.parseIndexableString=function(h){for(var o=[],s=[],r=0;;){var l=h[r++];if("\x00"!==l){switch(l){case"1":o.push(null);break;case"2":o.push("1"===h[r]),r++;break;case"3":var p=c(h,r);o.push(p.num),r+=p.length;break;case"4":for(var n="";;){var i=h[r];if("\x00"===i){break}n+=i,r++}n=n.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),o.push(n);break;case"5":var f={element:[],index:o.length};o.push(f.element),s.push(f);break;case"6":var e={element:{},index:o.length};o.push(e.element),s.push(e);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+l)}}else{if(1===o.length){return o.pop()}v(o,s)}}}},{13:13}],13:[function(f,c,g){function d(i,e,k){for(var h="",j=k-i.length;h.length<j;){h+=e}return h}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var h,m=j.length,l=p.length;for(h=0;m>h;h++){if(h===l){return 1}var e=j.charAt(h),k=p.charAt(h);if(e!==k){return k>e?-1:1}}return l>m?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(c,g,f){function h(){this.store={}}function d(i){if(this.store=new h,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}f.Map=h,f.Set=d,h.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},h.prototype.unmangle=function(e){return e.substring(1)},h.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},h.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},h.prototype.has=function(i){var e=this.mangle(i);return e in this.store},h.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},h.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},d.prototype.add=function(e){return this.store.set(e,!0)},d.prototype.has=function(e){return this.store.has(e)},d.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(f,d,c){(function(){var e={}.hasOwnProperty,g=[].slice;d.exports=function(j,i){var m,l,k,h;l=[],h=[];for(m in i){e.call(i,m)&&(k=i[m],"this"!==m&&(l.push(m),h.push(k)))}return Function.apply(null,g.call(l).concat([j])).apply(i["this"],h)}}).call(this)},{}],16:[function(d,c,e){!function(g){if("object"==typeof e){c.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(F){function B(m,h,n,l,i,g){return h=K(K(h,m),K(l,g)),K(h<<i|h>>>32-i,n)}function w(m,h,l,i,n,o,g){return B(h&l|~h&i,m,h,n,o,g)}function H(m,h,l,i,n,o,g){return B(h&i|l&~i,m,h,n,o,g)}function D(m,h,l,i,n,o,g){return B(h^l^i,m,h,n,o,g)}function q(m,h,l,i,n,o,g){return B(l^(h|~i),m,h,n,o,g)}function M(m,h){var n=m[0],l=m[1],g=m[2],i=m[3];n=w(n,l,g,i,h[0],7,-680876936),i=w(i,n,l,g,h[1],12,-389564586),g=w(g,i,n,l,h[2],17,606105819),l=w(l,g,i,n,h[3],22,-1044525330),n=w(n,l,g,i,h[4],7,-176418897),i=w(i,n,l,g,h[5],12,1200080426),g=w(g,i,n,l,h[6],17,-1473231341),l=w(l,g,i,n,h[7],22,-45705983),n=w(n,l,g,i,h[8],7,1770035416),i=w(i,n,l,g,h[9],12,-1958414417),g=w(g,i,n,l,h[10],17,-42063),l=w(l,g,i,n,h[11],22,-1990404162),n=w(n,l,g,i,h[12],7,1804603682),i=w(i,n,l,g,h[13],12,-40341101),g=w(g,i,n,l,h[14],17,-1502002290),l=w(l,g,i,n,h[15],22,1236535329),n=H(n,l,g,i,h[1],5,-165796510),i=H(i,n,l,g,h[6],9,-1069501632),g=H(g,i,n,l,h[11],14,643717713),l=H(l,g,i,n,h[0],20,-373897302),n=H(n,l,g,i,h[5],5,-701558691),i=H(i,n,l,g,h[10],9,38016083),g=H(g,i,n,l,h[15],14,-660478335),l=H(l,g,i,n,h[4],20,-405537848),n=H(n,l,g,i,h[9],5,568446438),i=H(i,n,l,g,h[14],9,-1019803690),g=H(g,i,n,l,h[3],14,-187363961),l=H(l,g,i,n,h[8],20,1163531501),n=H(n,l,g,i,h[13],5,-1444681467),i=H(i,n,l,g,h[2],9,-51403784),g=H(g,i,n,l,h[7],14,1735328473),l=H(l,g,i,n,h[12],20,-1926607734),n=D(n,l,g,i,h[5],4,-378558),i=D(i,n,l,g,h[8],11,-2022574463),g=D(g,i,n,l,h[11],16,1839030562),l=D(l,g,i,n,h[14],23,-35309556),n=D(n,l,g,i,h[1],4,-1530992060),i=D(i,n,l,g,h[4],11,1272893353),g=D(g,i,n,l,h[7],16,-155497632),l=D(l,g,i,n,h[10],23,-1094730640),n=D(n,l,g,i,h[13],4,681279174),i=D(i,n,l,g,h[0],11,-358537222),g=D(g,i,n,l,h[3],16,-722521979),l=D(l,g,i,n,h[6],23,76029189),n=D(n,l,g,i,h[9],4,-640364487),i=D(i,n,l,g,h[12],11,-421815835),g=D(g,i,n,l,h[15],16,530742520),l=D(l,g,i,n,h[2],23,-995338651),n=q(n,l,g,i,h[0],6,-198630844),i=q(i,n,l,g,h[7],10,1126891415),g=q(g,i,n,l,h[14],15,-1416354905),l=q(l,g,i,n,h[5],21,-57434055),n=q(n,l,g,i,h[12],6,1700485571),i=q(i,n,l,g,h[3],10,-1894986606),g=q(g,i,n,l,h[10],15,-1051523),l=q(l,g,i,n,h[1],21,-2054922799),n=q(n,l,g,i,h[8],6,1873313359),i=q(i,n,l,g,h[15],10,-30611744),g=q(g,i,n,l,h[6],15,-1560198380),l=q(l,g,i,n,h[13],21,1309151649),n=q(n,l,g,i,h[4],6,-145523070),i=q(i,n,l,g,h[11],10,-1120210379),g=q(g,i,n,l,h[2],15,718787259),l=q(l,g,i,n,h[9],21,-343485551),m[0]=K(n,m[0]),m[1]=K(l,m[1]),m[2]=K(g,m[2]),m[3]=K(i,m[3])}function C(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i.charCodeAt(h)+(i.charCodeAt(h+1)<<8)+(i.charCodeAt(h+2)<<16)+(i.charCodeAt(h+3)<<24)}return g}function G(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i[h]+(i[h+1]<<8)+(i[h+2]<<16)+(i[h+3]<<24)}return g}function A(g){var m,i,h,n,p,o,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;l>=m;m+=64){M(r,C(g.substring(m-64,m)))}for(g=g.substring(m-64),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;i>m;m+=1){h[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(h[m>>2]|=128<<(m%4<<3),m>55){for(M(r,h),m=0;16>m;m+=1){h[m]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),o=parseInt(n[1],16)||0,h[14]=p,h[15]=o,M(r,h),r}function E(g){var o,i,h,n,p,m,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(o=64;l>=o;o+=64){M(r,G(g.subarray(o-64,o)))}for(g=l>o-64?g.subarray(o-64):new Uint8Array(0),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;i>o;o+=1){h[o>>2]|=g[o]<<(o%4<<3)}if(h[o>>2]|=128<<(o%4<<3),o>55){for(M(r,h),o=0;16>o;o+=1){h[o]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,h[14]=p,h[15]=m,M(r,h),r}function x(i){var h,g="";for(h=0;4>h;h+=1){g+=L[i>>8*h+4&15]+L[i>>8*h&15]}return g}function I(h){var g;for(g=0;g<h.length;g+=1){h[g]=x(h[g])}return h.join("")}function z(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(m,h){var n,l=m.length,i=new ArrayBuffer(l),g=new Uint8Array(i);for(n=0;l>n;n+=1){g[n]=m.charCodeAt(n)}return h?g:i}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(l,g,h){var i=new Uint8Array(l.byteLength+g.byteLength);return i.set(new Uint8Array(l)),i.set(new Uint8Array(g),l.byteLength),h?i:i.buffer}function N(l){var g,h=[],i=l.length;for(g=0;i-1>g;g+=2){h.push(parseInt(l.substr(g,2),16))}return String.fromCharCode.apply(String,h)}function J(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==I(A("hello"))&&(K=function(l,g){var h=(65535&l)+(65535&g),i=(l>>16)+(g>>16)+(h>>16);return i<<16|65535&h}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(p,h){var i,n,s,o,r=this.byteLength,l=g(p,r),m=r;return h!==F&&(m=g(h,r)),l>m?new ArrayBuffer(0):(i=m-l,n=new ArrayBuffer(i),s=new Uint8Array(n),o=new Uint8Array(this,l,i),s.set(o),n)}}(),J.prototype.append=function(g){return this.appendBinary(z(g)),this},J.prototype.appendBinary=function(i){this._buff+=i,this._length+=i.length;var h,g=this._buff.length;for(h=64;g>=h;h+=64){M(this._hash,C(this._buff.substring(h-64,h)))}return this._buff=this._buff.substring(h-64),this},J.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l.charCodeAt(h)<<(h%4<<3)}return this._finish(g,i),n=I(this._hash),m&&(n=N(n)),this.reset(),n},J.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},J.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},J.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},J.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},J.prototype._finish=function(m,h){var n,l,i,g=h;if(m[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,m),g=0;16>g;g+=1){m[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(n[2],16),i=parseInt(n[1],16)||0,m[14]=l,m[15]=i,M(this._hash,m)},J.hash=function(h,g){return J.hashBinary(z(h),g)},J.hashBinary=function(l,g){var h=A(l),i=I(h);return g?N(i):i},J.ArrayBuffer=function(){this.reset()},J.ArrayBuffer.prototype.append=function(l){var g,h=f(this._buff.buffer,l,!0),i=h.length;for(this._length+=l.byteLength,g=64;i>=g;g+=64){M(this._hash,G(h.subarray(g-64,g)))}return this._buff=i>g-64?new Uint8Array(h.buffer.slice(g-64)):new Uint8Array(0),this},J.ArrayBuffer.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l[h]<<(h%4<<3)}return this._finish(g,i),n=I(this._hash),m&&(n=N(n)),this.reset(),n},J.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},J.ArrayBuffer.prototype.getState=function(){var g=J.prototype.getState.call(this);return g.buff=j(g.buff),g},J.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),J.prototype.setState.call(this,g)},J.ArrayBuffer.prototype.destroy=J.prototype.destroy,J.ArrayBuffer.prototype._finish=J.prototype._finish,J.ArrayBuffer.hash=function(l,g){var h=E(new Uint8Array(l)),i=I(h);return g?N(i):i},J})},{}],17:[function(f,c,g){function d(j,p,h){var m=h[h.length-1];j===m.element&&(h.pop(),m=h[h.length-1]);var l=m.element,e=m.index;if(Array.isArray(l)){l.push(j)}else{if(e===p.length-2){var k=p.pop();l[k]=j}else{p.push(j)}}}g.stringify=function(w){var v=[];v.push({obj:w});for(var p,z,x,m,q,B,h,e,A,k,j,y="";p=v.pop();){if(z=p.obj,x=p.prefix||"",m=p.val||"",y+=x,m){y+=m}else{if("object"!=typeof z){y+="undefined"==typeof z?null:JSON.stringify(z)}else{if(null===z){y+="null"}else{if(Array.isArray(z)){for(v.push({val:"]"}),q=z.length-1;q>=0;q--){B=0===q?"":",",v.push({obj:z[q],prefix:B})}v.push({val:"["})}else{h=[];for(e in z){z.hasOwnProperty(e)&&h.push(e)}for(v.push({val:"}"}),q=h.length-1;q>=0;q--){A=h[q],k=z[A],j=q>0?",":"",j+=JSON.stringify(A)+":",v.push({obj:k,prefix:j})}v.push({val:"{"})}}}}}return y},g.parse=function(k){for(var z,v,q,e,y,x,m,w,r,j=[],h=[],p=0;;){if(z=k[p++],"}"!==z&&"]"!==z&&"undefined"!=typeof z){switch(z){case" ":case"	":case"\n":case":":case",":break;case"n":p+=3,d(null,j,h);break;case"t":p+=3,d(!0,j,h);break;case"f":p+=4,d(!1,j,h);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(v="",p--;;){if(q=k[p++],!/[\d\.\-e\+]/.test(q)){p--;break}v+=q}d(parseFloat(v),j,h);break;case'"':for(e="",y=void 0,x=0;;){if(m=k[p++],'"'===m&&("\\"!==y||x%2!==1)){break}e+=m,y=m,"\\"===y?x++:x=0}d(JSON.parse('"'+e+'"'),j,h);break;case"[":w={element:[],index:j.length},j.push(w.element),h.push(w);break;case"{":r={element:{},index:j.length},j.push(r.element),h.push(r);break;default:throw new Error("unexpectedly reached end of input: "+z)}}else{if(1===j.length){return j.pop()}d(j.pop(),j,h)}}}},{}]},{},[3])(3)});