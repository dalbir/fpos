!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(a,i,b){function l(f,j){if(!i[f]){if(!a[f]){var n="function"==typeof require&&require;if(!j&&n){return n(f,!0)}if(e){return e(f,!0)}var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var h=i[f]={exports:{}};a[f][0].call(h.exports,function(m){var p=a[f][1][m];return l(p?p:m)},h,h.exports,d,a,i,b)}return i[f].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){l(b[k])}return l}({1:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var j=arguments,f=this.useColors;if(j[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+j[0]+(f?"%c ":" ")+"+"+p.humanize(this.diff),!f){return j}var k="color: "+this.color;j=[j[0],k,"color: inherit"].concat(Array.prototype.slice.call(j,1));var h=0,g=0;return j[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(h++,"%c"===l&&(g=h))}),j.splice(g,0,k),j}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(n,b,s){function u(){return s.colors[o++%s.colors.length]}function t(j){function g(){}function k(){var q=k,m=+new Date,p=m-(i||m);q.diff=p,q.prev=i,q.curr=m,i=m,null==q.useColors&&(q.useColors=s.useColors()),null==q.color&&q.useColors&&(q.color=u());var l=Array.prototype.slice.call(arguments);l[0]=s.coerce(l[0]),"string"!=typeof l[0]&&(l=["%o"].concat(l));var w=0;l[0]=l[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}w++;var x=s.formatters[A];if("function"==typeof x){var z=l[w];y=x.call(q,z),l.splice(w,1),w--}return y}),"function"==typeof s.formatArgs&&(l=s.formatArgs.apply(q,l));var v=k.log||s.log||console.log.bind(console);v.apply(q,l)}g.enabled=!1,k.enabled=!0;var h=s.enabled(j)?k:g;return h.namespace=j,h}function r(k){s.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?s.skips.push(new RegExp("^"+k.substr(1)+"$")):s.names.push(new RegExp("^"+k+"$")))}}function f(){s.enable("")}function a(g){var j,h;for(j=0,h=s.skips.length;h>j;j++){if(s.skips[j].test(g)){return !1}}for(j=0,h=s.names.length;h>j;j++){if(s.names[j].test(g)){return !0}}return !1}function e(g){return g instanceof Error?g.stack||g.message:g}s=b.exports=t,s.coerce=e,s.disable=f,s.enable=r,s.enabled=a,s.humanize=n(9),s.names=[],s.skips=[],s.formatters={};var i,o=0},{9:9}],4:[function(e,a,n){function m(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function b(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}a.exports=m,m.EventEmitter=m,m.prototype._events=void 0,m.prototype._maxListeners=void 0,m.defaultMaxListeners=10,m.prototype.setMaxListeners=function(f){if(!b(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},m.prototype.emit=function(f){var k,j,g,l,h,r;if(this._events||(this._events={}),"error"===f&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(j=this._events[f],p(j)){return !1}if(o(j)){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),j.apply(this,l)}}else{if(i(j)){for(l=Array.prototype.slice.call(arguments,1),r=j.slice(),g=r.length,h=0;g>h;h++){r[h].apply(this,l)}}}return !0},m.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?m.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},m.prototype.on=m.prototype.addListener,m.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},m.prototype.removeListener=function(l,j){var k,f,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[l]){return this}if(k=this._events[l],h=k.length,f=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,j)}else{if(i(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){f=g;break}}if(0>f){return this}1===k.length?(k.length=0,delete this._events[l]):k.splice(f,1),this._events.removeListener&&this.emit("removeListener",l,j)}}return this},m.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},m.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},m.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},m.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(e,a,b){(function(i){function r(){l=!0;for(var j,g,h=o.length;h;){for(g=o,o=[],j=-1;++j<h;){g[j]()}h=o.length}l=!1}function x(g){1!==o.push(g)||l||u()}var u,n=i.MutationObserver||i.WebKitMutationObserver;if(n){var f=0,y=new n(r),z=i.document.createTextNode("");y.observe(z,{characterData:!0}),u=function(){z.data=f=++f%2}}else{if(i.setImmediate||"undefined"==typeof i.MessageChannel){u="document" in i&&"onreadystatechange" in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){r(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(r,0)}}else{var s=new i.MessageChannel;s.port1.onmessage=r,u=function(){s.port2.postMessage(0)}}}var l,o=[];a.exports=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(e,a,b){(function(f){f("object"==typeof b?b:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(n){if(n){for(var i in n){"object"==typeof n[i]&&h[i]?k.call(h,h[i],n[i]):h[i]=n[i]}}}),h};j.extend=k})},{}],8:[function(o,u,s){function n(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=h,this.queue=[],this.outcome=void 0,g!==n&&y(this,g)}function a(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function e(j,k,g){i(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function p(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=l(j);"error"===z.status&&w(z.value)}function l(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function r(g){return g instanceof this?g:K.resolve(new this(n),g)}function f(g){var j=new this(n);return K.reject(j,g)}function m(B){function A(E,D){function C(F){w[D]=F,++z!==k||g||(g=!0,K.resolve(x,w))}j.resolve(E).then(C,function(F){g||(g=!0,K.reject(x,F))})}var j=this;if("[object Array]"!==Object.prototype.toString.call(B)){return this.reject(new TypeError("must be an array"))}var k=B.length,g=!1;if(!k){return this.resolve([])}for(var w=new Array(k),z=0,q=-1,x=new this(n);++q<k;){A(B[q],q)}return x}function t(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(n);++z<j;){g(k[z])}return q}var i=o(5),K={},L=["REJECTED"],b=["FULFILLED"],h=["PENDING"];u.exports=s=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===b||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(n);if(this.state!==h){var k=this.state===b?q:g;e(j,k,this.outcome)}else{this.queue.push(new a(j,q,g))}return j},a.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){e(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){K.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){e(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=l(p,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=b,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},s.resolve=r,s.reject=f,s.all=m,s.race=t},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(p,s,h){function n(m){if(null!==m){switch(typeof m){case"boolean":return m?1:0;case"number":return a(m);case"string":return m.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var j=Array.isArray(m),w=j?m:Object.keys(m),q=-1,v=w.length,k="";if(j){for(;++q<v;){k+=h.toIndexableString(w[q])}}else{for(;++q<v;){var g=w[q];k+=h.toIndexableString(g)+h.toIndexableString(m[g])}}return k}}return""}function i(q,g){var w,y=g,x="1"===q[g];if(x){w=0,g++}else{var v="0"===q[g];g++;var k="",z=q.substring(g,g+o),j=parseInt(z,10)+t;for(v&&(j=-j),g+=o;;){var m=q[g];if("\x00"===m){break}k+=m,g++}k=k.split("."),w=1===k.length?parseInt(k,10):parseFloat(k[0]+"."+k[1]),v&&(w-=10),0!==j&&(w=parseFloat(w+"e"+j))}return{num:w,length:g-y}}function r(w,q){var j=w.pop();if(q.length){var g=q[q.length-1];j===g.element&&(q.pop(),g=q[q.length-1]);var v=g.element,k=g.index;if(Array.isArray(v)){v.push(j)}else{if(k===w.length-2){var m=w.pop();v[m]=j}else{w.push(j)}}}}function D(k,q){for(var m=Math.min(k.length,q.length),j=0;m>j;j++){var g=h.collate(k[j],q[j]);if(0!==g){return g}}return k.length===q.length?0:k.length>q.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(m,j){for(var w=Object.keys(m),q=Object.keys(j),v=Math.min(w.length,q.length),k=0;v>k;k++){var g=h.collate(w[k],q[k]);if(0!==g){return g}if(g=h.collate(m[w[k]],j[q[k]]),0!==g){return g}}return w.length===q.length?0:w.length>q.length?1:-1}function b(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(v){if(0===v){return"1"}var k=v.toExponential().split(/e\+?/),x=parseInt(k[1],10),g=0>v,y=g?"0":"2",w=(g?-x:x)-t,q=l.padLeft(w.toString(),"0",o);y+=f+q;var j=Math.abs(parseFloat(k[0]));g&&(j=10-j);var m=j.toFixed(20);return m=m.replace(/\.?0+$/,""),y+=f+m}var t=-324,o=3,f="",l=p(11);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=b(j),g=b(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?D(j,m):u(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=h.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=h.normalizeKey(v))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),b(g)+f+n(g)+j},h.parseIndexableString=function(q){for(var g=[],x=[],y=0;;){var k=q[y++];if("\x00"!==k){switch(k){case"1":g.push(null);break;case"2":g.push("1"===q[y]),y++;break;case"3":var z=i(q,y);g.push(z.num),y+=z.length;break;case"4":for(var j="";;){var m=q[y];if("\x00"===m){break}j+=m,y++}j=j.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),g.push(j);break;case"5":var v={element:[],index:g.length};g.push(v.element),x.push(v);break;case"6":var w={element:{},index:g.length};g.push(w.element),x.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+k)}}else{if(1===g.length){return g.pop()}r(g,x)}}}},{11:11}],11:[function(h,b,e){function a(n,g,l){for(var f="",m=l-n.length;f.length<m;){f+=g}return f}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(g,r){var i,n=g.length,o=r.length;for(i=0;n>i;i++){if(i===o){return 1}var q=g.charAt(i),f=r.charAt(i);if(q!==f){return f>q?-1:1}}return o>n?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(a,e,i){function b(){this.store={}}function j(g){if(this.store=new b,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}i.Map=b,i.Set=j,b.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},b.prototype.unmangle=function(f){return f.substring(1)},b.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},b.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},b.prototype.has=function(f){var g=this.mangle(f);return g in this.store},b.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},b.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},j.prototype.add=function(f){return this.store.set(f,!0)},j.prototype.has=function(f){return this.store.has(f)},j.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(s,p){var q,g,o,r;g=[],r=[];for(q in p){h.call(p,q)&&(o=p[q],"this"!==q&&(g.push(q),r.push(o)))}return Function.apply(null,f.call(g).concat([s])).apply(p["this"],r)}}).call(this)},{}],15:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(p){function v(q,w,z,j,k,x){return w=u(u(w,q),u(j,x)),u(w<<k|w>>>32-k,z)}function o(j,A,k,w,x,z,q){return v(A&k|~A&w,j,A,x,z,q)}function n(j,A,k,w,x,z,q){return v(A&w|k&~w,j,A,x,z,q)}function r(j,A,k,w,x,z,q){return v(A^k^w,j,A,x,z,q)}function O(j,A,k,w,x,z,q){return v(k^(A|~w),j,A,x,z,q)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=o(z,j,x,k,w[0],7,-680876936),k=o(k,z,j,x,w[1],12,-389564586),x=o(x,k,z,j,w[2],17,606105819),j=o(j,x,k,z,w[3],22,-1044525330),z=o(z,j,x,k,w[4],7,-176418897),k=o(k,z,j,x,w[5],12,1200080426),x=o(x,k,z,j,w[6],17,-1473231341),j=o(j,x,k,z,w[7],22,-45705983),z=o(z,j,x,k,w[8],7,1770035416),k=o(k,z,j,x,w[9],12,-1958414417),x=o(x,k,z,j,w[10],17,-42063),j=o(j,x,k,z,w[11],22,-1990404162),z=o(z,j,x,k,w[12],7,1804603682),k=o(k,z,j,x,w[13],12,-40341101),x=o(x,k,z,j,w[14],17,-1502002290),j=o(j,x,k,z,w[15],22,1236535329),z=n(z,j,x,k,w[1],5,-165796510),k=n(k,z,j,x,w[6],9,-1069501632),x=n(x,k,z,j,w[11],14,643717713),j=n(j,x,k,z,w[0],20,-373897302),z=n(z,j,x,k,w[5],5,-701558691),k=n(k,z,j,x,w[10],9,38016083),x=n(x,k,z,j,w[15],14,-660478335),j=n(j,x,k,z,w[4],20,-405537848),z=n(z,j,x,k,w[9],5,568446438),k=n(k,z,j,x,w[14],9,-1019803690),x=n(x,k,z,j,w[3],14,-187363961),j=n(j,x,k,z,w[8],20,1163531501),z=n(z,j,x,k,w[13],5,-1444681467),k=n(k,z,j,x,w[2],9,-51403784),x=n(x,k,z,j,w[7],14,1735328473),j=n(j,x,k,z,w[12],20,-1926607734),z=r(z,j,x,k,w[5],4,-378558),k=r(k,z,j,x,w[8],11,-2022574463),x=r(x,k,z,j,w[11],16,1839030562),j=r(j,x,k,z,w[14],23,-35309556),z=r(z,j,x,k,w[1],4,-1530992060),k=r(k,z,j,x,w[4],11,1272893353),x=r(x,k,z,j,w[7],16,-155497632),j=r(j,x,k,z,w[10],23,-1094730640),z=r(z,j,x,k,w[13],4,681279174),k=r(k,z,j,x,w[0],11,-358537222),x=r(x,k,z,j,w[3],16,-722521979),j=r(j,x,k,z,w[6],23,76029189),z=r(z,j,x,k,w[9],4,-640364487),k=r(k,z,j,x,w[12],11,-421815835),x=r(x,k,z,j,w[15],16,530742520),j=r(j,x,k,z,w[2],23,-995338651),z=O(z,j,x,k,w[0],6,-198630844),k=O(k,z,j,x,w[7],10,1126891415),x=O(x,k,z,j,w[14],15,-1416354905),j=O(j,x,k,z,w[5],21,-57434055),z=O(z,j,x,k,w[12],6,1700485571),k=O(k,z,j,x,w[3],10,-1894986606),x=O(x,k,z,j,w[10],15,-1051523),j=O(j,x,k,z,w[1],21,-2054922799),z=O(z,j,x,k,w[8],6,1873313359),k=O(k,z,j,x,w[15],10,-30611744),x=O(x,k,z,j,w[6],15,-1560198380),j=O(j,x,k,z,w[13],21,1309151649),z=O(z,j,x,k,w[4],6,-145523070),k=O(k,z,j,x,w[11],10,-1120210379),x=O(x,k,z,j,w[2],15,718787259),j=O(j,x,k,z,w[9],21,-343485551),q[0]=u(z,q[0]),q[1]=u(j,q[1]),q[2]=u(x,q[2]),q[3]=u(k,q[3])}function t(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function P(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function l(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,t(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function s(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,P(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function Q(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function m(j){var k;for(k=0;k<j.length;k+=1){j[k]=Q(j[k])}return j.join("")}function y(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function i(){this.reset()}var u=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(l("hello"))&&(u=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(D,x){var k,A,B,q,z=this.byteLength,C=j(D,z),w=z;return x!==p&&(w=j(x,z)),C>w?new ArrayBuffer(0):(k=w-C,A=new ArrayBuffer(k),B=new Uint8Array(A),q=new Uint8Array(this,C,k),B.set(q),A)}}(),i.prototype.append=function(j){return this.appendBinary(y(j)),this},i.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,t(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},i.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},i.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},i.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},i.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},i.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},i.hash=function(j,k){return i.hashBinary(y(j),k)},i.hashBinary=function(q,w){var k=l(q),j=m(k);return w?e(j):j},i.ArrayBuffer=function(){this.reset()},i.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,P(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},i.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},i.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.ArrayBuffer.prototype.getState=function(){var j=i.prototype.getState.call(this);return j.buff=S(j.buff),j},i.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),i.prototype.setState.call(this,j)},i.ArrayBuffer.prototype.destroy=i.prototype.destroy,i.ArrayBuffer.prototype._finish=i.prototype._finish,i.ArrayBuffer.hash=function(q,w){var k=s(new Uint8Array(q)),j=m(k);return w?e(j):j},i})},{}],16:[function(h,b,e){function a(g,r,i){var n=i[i.length-1];g===n.element&&(i.pop(),n=i[i.length-1]);var o=n.element,q=n.index;if(Array.isArray(o)){o.push(g)}else{if(q===r.length-2){var f=r.pop();o[f]=g}else{r.push(g)}}}e.stringify=function(C){var i=[];i.push({obj:C});for(var t,u,g,n,s,f,r,D,E,o,l,F="";t=i.pop();){if(u=t.obj,g=t.prefix||"",n=t.val||"",F+=g,n){F+=n}else{if("object"!=typeof u){F+="undefined"==typeof u?null:JSON.stringify(u)}else{if(null===u){F+="null"}else{if(Array.isArray(u)){for(i.push({val:"]"}),s=u.length-1;s>=0;s--){f=0===s?"":",",i.push({obj:u[s],prefix:f})}i.push({val:"["})}else{r=[];for(D in u){u.hasOwnProperty(D)&&r.push(D)}for(i.push({val:"}"}),s=r.length-1;s>=0;s--){E=r[s],o=u[E],l=s>0?",":"",l+=JSON.stringify(E)+":",i.push({obj:o,prefix:l})}i.push({val:"{"})}}}}}return F},e.parse=function(C){for(var n,u,B,l,s,i,D,t,f,o=[],A=[],g=0;;){if(n=C[g++],"}"!==n&&"]"!==n&&"undefined"!=typeof n){switch(n){case" ":case"	":case"\n":case":":case",":break;case"n":g+=3,a(null,o,A);break;case"t":g+=3,a(!0,o,A);break;case"f":g+=4,a(!1,o,A);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(u="",g--;;){if(B=C[g++],!/[\d\.\-e\+]/.test(B)){g--;break}u+=B}a(parseFloat(u),o,A);break;case'"':for(l="",s=void 0,i=0;;){if(D=C[g++],'"'===D&&("\\"!==s||i%2!==1)){break}l+=D,s=D,"\\"===s?i++:i=0}a(JSON.parse('"'+l+'"'),o,A);break;case"[":t={element:[],index:o.length},o.push(t.element),A.push(t);break;case"{":f={element:{},index:o.length},o.push(f.element),A.push(f);break;default:throw new Error("unexpectedly reached end of input: "+n)}}else{if(1===o.length){return o.pop()}a(o.pop(),o,A)}}}},{}],17:[function(e,a,b){(function(fc,gb){function ft(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function hE(aa,ac){for(var ad={},ab=0,t=ac.length;t>ab;ab++){var af=ac[ab];af in aa&&(ad[af]=aa[af])}return ad}function ct(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function X(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function x(t){if(t instanceof ArrayBuffer){return X(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function eq(aa){var ac,ad,ab;if(!aa||"object"!=typeof aa){return aa}if(Array.isArray(aa)){for(ac=[],ad=0,ab=aa.length;ab>ad;ad++){ac[ad]=eq(aa[ad])}return ac}if(aa instanceof Date){return aa.toISOString()}if(ct(aa)){return x(aa)}ac={};for(ad in aa){if(Object.prototype.hasOwnProperty.call(aa,ad)){var t=eq(aa[ad]);"undefined"!=typeof t&&(ac[ad]=t)}}return ac}function fZ(aa){var t=!1;return ji(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function ei(t){return ji(function(ac){ac=eq(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){fc.nextTick(function(){ad(ag,ah)})});var af=new a9(function(al,ag){var aj;try{var ak=fZ(function(ap,am){ap?ag(ap):al(am)});ac.push(ak),aj=t.apply(aa,ac),aj&&"function"==typeof aj.then&&al(aj)}catch(ah){ag(ah)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fl(t,aa){function ab(aj,ad,ag){if(hp.enabled){for(var ac=[aj._db_name,ad],ah=0;ah<ag.length-1;ah++){ac.push(ag[ah])}hp.apply(null,ac);var af=ag[ag.length-1];ag[ag.length-1]=function(ak,am){var al=[aj._db_name,ad];al=al.concat(ak?["error",ak]:["success",am]),hp.apply(null,al),af(ak,am)}}}return ei(ji(function(ad){if(this._closed){return a9.reject(new Error("database is closed"))}if(this._destroyed){return a9.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new a9(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function de(t,aa,ab){return new a9(function(ad,ac){t.get(aa,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=ab(af);return aj?(aj._id=aa,aj._rev=ag,void ad(fr(t,aj,ab))):ad({updated:!1,rev:ag})})})}function fr(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return de(t,aa._id,ab)})}function y(t){for(var ag,ac,af,ad,aa=t.rev_tree.slice();ad=aa.pop();){var aj=ad.ids,ap=aj[2],ah=ad.pos;if(ap.length){for(var ak=0,am=ap.length;am>ak;ak++){aa.push({pos:ah+1,ids:ap[ak]})}}else{var ab=!!aj[1].deleted,al=aj[0];ag&&!(af!==ab?af:ac!==ah?ah>ac:al>ag)||(ag=al,ac=ah,af=ab)}}return ac+"-"+ag}function I(t){return t.ids}function cn(aa,ac){ac||(ac=y(aa));for(var ad,ab=ac.substring(ac.indexOf("-")+1),t=aa.rev_tree.map(I);ad=t.pop();){if(ad[0]===ab){return !!ad[1].deleted}t=t.concat(ad[2])}}function gG(t){return gJ("return "+t+";",{})}function a5(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function gv(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function B(aa){var t=gv(aa);return t?t.join("/"):null}function be(aa,aj){for(var ad,ag=aa.slice();ad=ag.pop();){for(var af=ad.pos,ac=ad.ids,ak=ac[2],ah=aj(0===ak.length,af,ac[0],ad.ctx,ac[1]),ab=0,t=ak.length;t>ab;ab++){ag.push({pos:af+1,ids:ak[ab],ctx:ah})}}}function V(aa,t){return aa.pos-t.pos}function g5(t){var ab=[];be(t,function(aj,ag,ad,ah,af){aj&&ab.push({rev:ag+"-"+ad,pos:ag,opts:af})}),ab.sort(V).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function fU(t){for(var ab=y(t),ag=g5(t.rev_tree),aa=[],ad=0,ac=ag.length;ac>ad;ad++){var af=ag[ad];af.rev===ab||af.opts.deleted||aa.push(af.rev)}return aa}function G(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function D(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=G.prototype,new aa(ab)}function hI(aa){var ac,ad,ab,t,af;return ad=aa.error===!0&&"string"==typeof aa.name?aa.name:aa.error,af=aa.reason,ab=M("name",ad,af),aa.missing||"missing"===af||"deleted"===af||"not_found"===ad?ab=ja:"doc_validation"===ad?(ab=iH,t=af):"bad_request"===ad&&ab.message!==af&&(ab=iy),ab||(ab=M("status",aa.status,af)||hm),ac=D(ab,af,ad),t&&(ac.message=t),aa.id&&(ac.id=aa.id),aa.status&&(ac.status=aa.status),aa.missing&&(ac.missing=aa.missing),ac}function q(t,ab,ag){function aa(){ad.cancel()}jv.EventEmitter.call(this);var ad=this;this.db=t,ab=ab?eq(ab):{};var ac=ab.complete=fZ(function(aj,ah){aj?ad.emit("error",aj):ad.emit("complete",ah),ad.removeAllListeners(),t.removeListener("destroyed",aa)});ag&&(ad.on("complete",function(ah){ag(null,ah)}),ad.on("error",ag)),t.once("destroyed",aa),ab.onChange=function(ah){ab.isCancelled||(ad.emit("change",ah),ad.startSeq&&ad.startSeq<=ah.seq&&(ad.startSeq=!1))};var af=new a9(function(aj,ah){ab.complete=function(al,ak){al?ah(al):aj(ak)}});ad.once("cancel",function(){t.removeListener("destroyed",aa),ab.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ac(null,ah)},ac),t.taskqueue.isReady?ad.doChanges(ab):t.taskqueue.addTask(function(){ad.isCancelled?ad.emit("cancel"):ad.doChanges(ab)})}function gC(aa,ac,ad){var ab=[{rev:aa._rev}];"all_docs"===ad.style&&(ab=g5(ac.rev_tree).map(function(af){return{rev:af.rev}}));var t={id:ac.id,changes:ab,doc:aa};return cn(ac,aa._rev)&&(t.deleted=!0),ad.conflicts&&(t.doc._conflicts=fU(ac),t.doc._conflicts.length||delete t.doc._conflicts),t}function fb(t,aj,ad){function ag(){var am=[];ac.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ad(null,{results:am})}function af(){++ab===al&&ag()}function aa(aq,am,ap){ac[aq]={id:am,docs:ap},af()}var ah=Array.isArray(aj)?aj:aj.docs,ak={};ah.forEach(function(am){am.id in ak?ak[am.id].push(am):ak[am.id]=[am]});var al=Object.keys(ak).length,ab=0,ac=new Array(al);Object.keys(ak).forEach(function(aq,av){var ap=ak[aq],au=hE(ap[0],["atts_since","attachments"]);au.open_revs=ap.map(function(aw){return aw.rev}),au.open_revs=au.open_revs.filter(function(aw){return aw});var am=function(aw){return aw};0===au.open_revs.length&&(delete au.open_revs,am=function(aw){return[{ok:aw}]}),["revs","attachments","binary","ajax"].forEach(function(aw){aw in aj&&(au[aw]=aj[aw])}),t.get(aq,au,function(ax,aw){aa(av,aq,ax?[{error:ax}]:am(aw))})})}function ar(t){return/^_local/.test(t)}function a7(t){for(var ag,ac=[],af=t.slice();ag=af.pop();){var ad=ag.pos,aa=ag.ids,aj=aa[0],ap=aa[1],ah=aa[2],ak=0===ah.length,am=ag.history?ag.history.slice():[];am.push({id:aj,opts:ap}),ak&&ac.push({pos:ad+1-am.length,ids:am});for(var ab=0,al=ah.length;al>ab;ab++){af.push({pos:ad+1,ids:ah[ab],history:am})}}return ac.reverse()}function U(t){return 0|Math.random()*t}function ao(t,ab){ab=ab||gh.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=gh[U(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=gh[3&U(16)|8];break;default:ac+=gh[U(16)]}}return ac}function p(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function J(aa){var t;if(aa?"string"!=typeof aa?t=D(Y):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=D(gU)):t=D(he),t){throw t}}function n(t){if(!/^\d+\-./.test(t)){return D(a6)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function bo(t,ab){for(var ag=t.start-t.ids.length+1,aa=t.ids,ad=[aa[0],ab,[]],ac=1,af=aa.length;af>ac;ac++){ad=[aa[ac],{status:"missing"},[ad]]}return[{pos:ag,ids:ad}]}function h0(aa,aj){var ad,ag,af,ac={status:"available"};if(aa._deleted&&(ac.deleted=!0),aj){if(aa._id||(aa._id=ao()),ag=ao(32,16).toLowerCase(),aa._rev){if(af=n(aa._rev),af.error){return af}aa._rev_tree=[{pos:af.prefix,ids:[af.id,{status:"missing"},[[ag,ac,[]]]]}],ad=af.prefix+1}else{aa._rev_tree=[{pos:1,ids:[ag,ac,[]]}],ad=1}}else{if(aa._revisions&&(aa._rev_tree=bo(aa._revisions,ac),ad=aa._revisions.start,ag=aa._revisions.ids[0]),!aa._rev_tree){if(af=n(aa._rev),af.error){return af}ad=af.prefix,ag=af.id,aa._rev_tree=[{pos:ad,ids:[ag,ac,[]]}]}}J(aa._id),aa._rev=ad+"-"+ag;var ak={metadata:{},data:{}};for(var ah in aa){if(Object.prototype.hasOwnProperty.call(aa,ah)){var ab="_"===ah[0];if(ab&&!ii[ah]){var t=D(iH,ah);throw t.message=iH.message+": "+ah,t}ab&&!gR[ah]?ak.metadata[ah.slice(1)]=aa[ah]:ak.data[ah]=aa[ah]}}return ak}function Q(aa,t){return t>aa?-1:aa>t?1:0}function ai(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function a3(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function fT(aa){for(var ac=0;ac<aa.length;ac++){var ad=aa[ac];if(ad._deleted){delete ad._attachments}else{if(ad._attachments){for(var ab=Object.keys(ad._attachments),t=0;t<ab.length;t++){var af=ab[t];ad._attachments[af]=hE(ad._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function a2(aa,ac){var ad=Q(aa._id,ac._id);if(0!==ad){return ad}var ab=aa._revisions?aa._revisions.start:0,t=ac._revisions?ac._revisions.start:0;return Q(ab,t)}function gH(t){var aa={},ab=[];return be(t,function(ah,ac,ag,ad){var af=ac+"-"+ag;return ah&&(aa[af]=0),void 0!==ad&&ab.push({from:ad,to:af}),af}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function fm(aa,ac,ad){var ab="limit" in ac?ac.keys.slice(ac.skip,ac.limit+ac.skip):ac.skip>0?ac.keys.slice(ac.skip):ac.keys;if(ac.descending&&ab.reverse(),!ab.length){return aa._allDocs({limit:0},ad)}var t={offset:ac.skip};return a9.all(ab.map(function(af){var ag=g4.extend({key:af,deleted:"ok"},ac);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new a9(function(aj,ah){aa._allDocs(ag,function(ak,al){return ak?ah(ak):(t.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return t.rows=af,t})}function fY(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),fc.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&fY(t)})})})}function i(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function T(aa,ac,ad,ab){ac.seq=ac.seq||0;var t={doc_ids:["_design/"+ad],limit:1,since:ac.seq};aa.changes(t).then(function(ag){var af=ag.results&&ag.results.length&&ag.results[0].seq;af&&af>ac.seq&&(ac.seq=af,delete ac.promise),ab()})["catch"](ab)}function z(t,ab,ac){t._ddocCache=t._ddocCache||{},t._ddocCache[ab]=t._ddocCache[ab]||{};var aa=t._ddocCache[ab];T(t,aa,ab,function(ad){return ad?ac(ad):(aa.promise||(aa.promise=new a9(function(af,ag){t._get("_design/"+ab,{},function(ah,aj){if(ah){return ag(ah)}var ak={};["views","filters"].forEach(function(al){ak[al]=aj.doc[al]}),af(ak)})})),void aa.promise.then(function(af){ac(null,af)})["catch"](ac))})}function a4(aa,ac,ad,ab,t){z(aa,ac,function(ag,ah){if(ag){return t(ag)}var af=ah[ad]&&ah[ad][ab];return af?void t(null,af):t(D(ja))})}function co(){jv.EventEmitter.call(this)}function h9(){this.isReady=!1,this.failed=!1,this.queue=[]}function P(t){t&&gb.debug&&console.error(t)}function iu(t,ab){function ag(){ac.emit("destroyed",ad)}function aa(){t.removeListener("destroyed",ag),t.emit("destroyed",t)}var ad=ab.originalName,ac=t.constructor,af=ac._destructionListeners;t.once("destroyed",ag),af.has(ad)||af.set(ad,[]),af.get(ad).push(aa)}function iS(aa,ac,ad){if(!(this instanceof iS)){return new iS(aa,ac,ad)}var ab=this;"function"!=typeof ac&&"undefined"!=typeof ac||(ad=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ad&&(ad=P),aa=aa||ac.name,ac=eq(ac),delete ac.name,this.__opts=ac;var t=ad;ab.auto_compaction=ac.auto_compaction,ab.prefix=iS.prefix,co.call(ab),ab.taskqueue=new h9;var af=new a9(function(al,ah){ad=function(ap,am){return ap?ah(ap):(delete am.then,void al(am))},ac=eq(ac);var ak,ag,aj=ac.name||aa;return function(){try{if("string"!=typeof aj){throw ag=new Error("Missing/invalid DB name"),ag.code=400,ag}if(ak=iS.parseAdapter(aj,ac),ac.originalName=aj,ac.name=ak.name,ac.prefix&&"http"!==ak.adapter&&"https"!==ak.adapter&&(ac.name=ac.prefix+ac.name),ac.adapter=ac.adapter||ak.adapter,ab._adapter=ac.adapter,ix("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aj,!iS.adapters[ac.adapter]){throw ag=new Error("Adapter is missing"),ag.code=404,ag}if(!iS.adapters[ac.adapter].valid()){throw ag=new Error("Invalid Adapter"),ag.code=404,ag}}catch(am){ab.taskqueue.fail(am)}}(),ag?ah(ag):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void iS.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ad(am)):(iu(ab,ac),ab.emit("created",ab),iS.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ad(null,ab))}))});af.then(function(ag){t(null,ag)},t),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function ey(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function bn(){return gT}function C(aa){Object.keys(jv.EventEmitter.prototype).forEach(function(ab){"function"==typeof jv.EventEmitter.prototype[ab]&&(aa[ab]=u[ab].bind(u))});var t=aa._destructionListeners=new gz.Map;aa.on("destroyed",function(ab){t.has(ab)&&(t.get(ab).forEach(function(ac){ac()}),t["delete"](ab))})}function io(aa,ac){aa=aa||[],ac=ac||{};try{return new Blob(aa,ac)}catch(ad){if("TypeError"!==ad.name){throw ad}for(var ab="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,t=new ab,af=0;af<aa.length;af+=1){t.append(aa[af])}return t.getBlob(ac.type)}}function jp(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function fy(){for(var t={},ab=new a9(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,a9.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function iB(t,ab){var ag,aa,ad,ac=new Headers,af={method:t.method,credentials:"include",headers:ac};return t.json&&(ac.set("Accept","application/json"),ac.set("Content-Type",t.headers["Content-Type"]||"application/json")),t.body&&t.body instanceof Blob?jp(t.body,function(ah){af.body=ah}):t.body&&t.processData&&"string"!=typeof t.body?af.body=JSON.stringify(t.body):"body" in t?af.body=t.body:af.body=null,Object.keys(t.headers).forEach(function(ah){t.headers.hasOwnProperty(ah)&&ac.set(ah,t.headers[ah])}),ag=fy(t.url,af),t.timeout>0&&(aa=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+t.url))},t.timeout)),ag.promise.then(function(ah){return ad={statusCode:ah.status},t.timeout>0&&clearTimeout(aa),ad.statusCode>=200&&ad.statusCode<300?t.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ad.statusCode>=200&&ad.statusCode<300?ab(null,ad,ah):ab(ah,ad)})["catch"](function(ah){ab(ah,ad)}),{abort:ag.reject}}function hf(ab,aa){var ad,ag,af=!1,ac=function(){ad.abort()},t=function(){af=!0,ad.abort()};ad=ab.xhr?new ab.xhr:new XMLHttpRequest;try{ad.open(ab.method,ab.url)}catch(ah){aa(ah,{statusCode:413})}ad.withCredentials="withCredentials" in ab?ab.withCredentials:!0,"GET"===ab.method?delete ab.headers["Content-Type"]:ab.json&&(ab.headers.Accept="application/json",ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json",ab.body&&ab.processData&&"string"!=typeof ab.body&&(ab.body=JSON.stringify(ab.body))),ab.binary&&(ad.responseType="arraybuffer"),"body" in ab||(ab.body=null);for(var aj in ab.headers){ab.headers.hasOwnProperty(aj)&&ad.setRequestHeader(aj,ab.headers[aj])}return ab.timeout>0&&(ag=setTimeout(t,ab.timeout),ad.onprogress=function(){clearTimeout(ag),4!==ad.readyState&&(ag=setTimeout(t,ab.timeout))},"undefined"!=typeof ad.upload&&(ad.upload.onprogress=ad.onprogress)),ad.onreadystatechange=function(){if(4===ad.readyState){var ak={statusCode:ad.status};if(ad.status>=200&&ad.status<300){var am;am=ab.binary?io([ad.response||""],{type:ad.getResponseHeader("Content-Type")}):ad.responseText,aa(null,ak,am)}else{var ap={};if(af){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ad.response)}catch(al){}}aa(ap,ak)}}},ab.body&&ab.body instanceof Blob?jp(ab.body,function(ak){ad.send(ak)}):ad.send(ab.body),{abort:ac}}function iN(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function en(aa,t){return h1||aa.xhr?hf(aa,t):iB(aa,t)}function jC(){return""}function ih(aa,ac){function ad(af,ag,aj){if(!aa.binary&&aa.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?hI(ak):ak})),aa.binary&&gY(af,ag),aj(null,af,ag)}function ab(aj,al){var ag,ak;if(aj.code&&aj.status){var ah=new Error(aj.message||aj.code);return ah.status=aj.status,al(ah)}if(aj.message&&"ETIMEDOUT"===aj.message){return al(aj)}try{ag=JSON.parse(aj.responseText),ak=hI(ag)}catch(af){ak=hI(aj)}al(ak)}aa=eq(aa);var t={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return aa=g4.extend(t,aa),aa.json&&(aa.binary||(aa.headers.Accept="application/json"),aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json"),aa.binary&&(aa.encoding=null,aa.json=!1),aa.processData||(aa.json=!1),en(aa,function(ah,al,af){if(ah){return ah.status=al?al.statusCode:400,ab(ah,ac)}var ak,am=al.headers&&al.headers["content-type"],ag=af||jC();if(!aa.binary&&(aa.json||!aa.processData)&&"object"!=typeof ag&&(/json/.test(am)||/^[\s]*\{/.test(ag)&&/\}[\s]*$/.test(ag))){try{ag=JSON.parse(ag.toString())}catch(aj){}}al.statusCode>=200&&al.statusCode<300?ad(ag,al,ac):(ak=hI(ag),ak.status=al.statusCode,ac(ak))})}function br(aa,aj){var ad=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ag=-1!==ad.indexOf("safari")&&-1===ad.indexOf("chrome"),af=-1!==ad.indexOf("msie"),ac=-1!==ad.indexOf("edge"),ak=ag||(af||ac)&&"GET"===aa.method,ah="cache" in aa?aa.cache:!0,ab=/^blob:/.test(aa.url);if(!ab&&(ak||!ah)){var t=-1!==aa.url.indexOf("?");aa.url+=(t?"&":"?")+"_nonce="+Date.now()}return ih(aa,aj)}function jm(t){for(var ab=g3.exec(t),ag={},aa=14;aa--;){var ad=jo[aa],ac=ab[aa]||"",af=-1!==["user","password"].indexOf(ad);ag[ad]=af?decodeURIComponent(ac):ac}return ag[gc]={},ag[jo[12]].replace(jg,function(ah,ak,aj){ak&&(ag[gc][ak]=aj)}),ag}function hT(aa){for(var ac=aa.length,ad=new ArrayBuffer(ac),ab=new Uint8Array(ad),t=0;ac>t;t++){ab[t]=aa.charCodeAt(t)}return ad}function hq(aa,t){return io([hT(aa)],{type:t})}function fj(aa,ac,ad){try{return !aa(ac,ad)}catch(ab){var t="Filter function threw: "+ab.toString();return D(iy,t)}}function g7(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&fj(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function iJ(aa,t){"console" in gb&&"info" in console&&console.info("The above "+aa+" is totally normal. "+t)}function iT(aa,ac,ad,ab,t){return aa.get(ac)["catch"](function(af){if(404===af.status){return"http"===aa.type()&&iJ(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ab,_id:ac,history:[],replicator:gk,version:ew}}throw af}).then(function(af){return t.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ab}),af.history.unshift({last_seq:ad,session_id:ab}),af.history=af.history.slice(0,i8),af.version=ew,af.replicator=gk,af.session_id=ab,af.last_seq=ad,aa.put(af)["catch"](function(ag){if(409===ag.status){return iT(aa,ac,ad,ab,t)}throw ag}))})}function jk(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function gS(t,ab){if(t.session_id===ab.session_id){return{last_seq:t.last_seq,history:t.history||[]}}var ac=t.history||[],aa=ab.history||[];return iI(ac,aa)}function iI(ac,aa){var af=ac[0],ah=ac.slice(1),ag=aa[0],ab=aa.slice(1);if(!af||0===aa.length){return{last_seq:ju,history:[]}}var ad=af.session_id;if(im(ad,aa)){return{last_seq:af.last_seq,history:ac}}var t=ag.session_id;return im(t,ah)?{last_seq:ag.last_seq,history:ab}:iI(ah,ab)}function im(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:im(t,aa):!1}function hK(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function gy(t,ab){t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1;var ac=Math.random(),aa=ab-t;return ~~(aa*ac+t)}function fw(aa){var t=0;return aa||(t=2000),gy(aa,t)}function hL(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=fw),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=iL})),t.current_back_off=t.current_back_off||iL,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function w(t){return di(t)}function a8(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function jf(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function jB(t){return Object.keys(t).sort(iQ.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function hn(t,ab,ag){var aa=ag.doc_ids?ag.doc_ids.sort(iQ.collate):"",ad=ag.filter?ag.filter.toString():"",ac="",af="";return ag.filter&&ag.query_params&&(ac=JSON.stringify(jB(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),a9.all([t.id(),ab.id()]).then(function(ah){var aj=ah[0]+ah[1]+ad+af+ac+aa;return fh(aj)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gF(t){return/^1-/.test(t)}function iq(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function je(t,aj,ad){function ag(){var al=iq(aj);if(al.docs.length){return t.bulkGet(al).then(function(am){if(ad.cancelled){throw new Error("cancelled")}am.results.forEach(function(ap){ap.docs.forEach(function(aq){aq.ok?aa.push(aq.ok):void 0!==aq.error&&(ab=!1)})})})}}function af(al){return al._attachments&&Object.keys(al._attachments).length>0}function ac(al){return t.allDocs({keys:al,include_docs:!0}).then(function(am){if(ad.cancelled){throw new Error("cancelled")}am.rows.forEach(function(ap){!ap.deleted&&ap.doc&&gF(ap.value.rev)&&!af(ap.doc)&&(aa.push(ap.doc),delete aj[ap.id])})})}function ak(){var al=Object.keys(aj).filter(function(ap){var am=aj[ap].missing;return 1===am.length&&gF(am[0])});return al.length>0?ac(al):void 0}function ah(){return{ok:ab,docs:aa}}aj=eq(aj);var aa=[],ab=!0;return a9.resolve().then(ak).then(ag).then(ah)}function ig(aN,aF,ap,ax,aq){function ag(){return ac?a9.resolve():hn(aN,aF,ap).then(function(aS){aC=aS,ac=new jk(aN,aF,aC,ax)})}function ay(){if(aA=[],0!==aP.docs.length){var aS=aP.docs;return aF.bulkDocs({docs:aS,new_edits:!1}).then(function(aT){if(ax.cancelled){throw au(),new Error("cancelled")}var aW=[],aU={};aT.forEach(function(aY){aY.error&&(aq.doc_write_failures++,aW.push(aY),aU[aY.id]=aY)}),aO=aO.concat(aW),aq.docs_written+=aP.docs.length-aW.length;var aV=aW.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aU[aZ._id];aY?ax.emit("denied",eq(aY)):aA.push(aZ)}),aV.length>0){var aX=new Error("bulkDocs error");throw aX.other_errors=aW,af("target.bulkDocs failed to write docs",aX),new Error("bulkWrite partial failure")}},function(aT){throw aq.doc_write_failures+=aS.length,aT})}}function aE(){if(aP.error){throw new Error("There was a problem getting docs.")}aq.last_seq=aQ=aP.seq;var aS=eq(aq);return aA.length&&(aS.docs=aA,ax.emit("change",aS)),ab=!0,ac.writeCheckpoint(aP.seq,aM).then(function(){if(ab=!1,ax.cancelled){throw au(),new Error("cancelled")}aP=void 0,al()})["catch"](function(aT){throw ab=!1,af("writeCheckpoint completed with error",aT),aT})}function aK(){var aS={};return aP.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aF.revsDiff(aS).then(function(aT){if(ax.cancelled){throw au(),new Error("cancelled")}aP.diffs=aT})}function aa(){return je(aN,aP.diffs,ax).then(function(aS){aP.error=!aS.ok,aS.docs.forEach(function(aT){delete aP.diffs[aT._id],aq.docs_read++,aP.docs.push(aT)})})}function ak(){if(!ax.cancelled&&!aP){if(0===aj.length){return void aJ(!0)}aP=aj.shift(),aK().then(aa).then(ay).then(aE).then(ak)["catch"](function(aS){af("batch processing terminated with error",aS)})}}function aJ(aS){return 0===av.changes.length?void (0!==aj.length||aP||((ah&&aD.live||az)&&(ax.state="pending",ax.emit("paused")),az&&au())):void ((aS||az||av.changes.length>=aB)&&(aj.push(av),av={seq:0,changes:[],docs:[]},"pending"!==ax.state&&"stopped"!==ax.state||(ax.state="active",ax.emit("active")),ak()))}function af(aT,aS){am||(aS.message||(aS.message=aT),aq.ok=!1,aq.status="aborting",aq.errors.push(aS),aO=aO.concat(aS),aj=[],av={seq:0,changes:[],docs:[]},au())}function au(){if(!(am||ax.cancelled&&(aq.status="cancelled",ab))){aq.status=aq.status||"complete",aq.end_time=new Date,aq.last_seq=aQ,am=!0;var aT=aO.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aO.pop();aO.length>0&&(aS.other_errors=aO),aS.result=aq,hL(ap,ax,aS,function(){ig(aN,aF,ap,ax)})}else{aq.errors=aO,ax.emit("complete",aq),ax.removeAllListeners()}}}function aL(aT){if(ax.cancelled){return au()}var aS=g7(ap)(aT);aS&&(av.seq=aT.seq,av.changes.push(aT),aJ(aD.live))}function t(aS){return aI=!1,ax.cancelled?au():(aS.results.length>0?(aD.since=aS.last_seq,al()):ah?(aD.live=!0,al()):az=!0,void aJ(!0))}function aw(aS){return aI=!1,ax.cancelled?au():void af("changes rejected",aS)}function al(){function aS(){aT.cancel()}function aU(){ax.removeListener("cancel",aS)}if(!aI&&!az&&aj.length<aH){aI=!0,ax._changes&&(ax.removeListener("cancel",ax._abortChanges),ax._changes.cancel()),ax.once("cancel",aS);var aT=aN.changes(aD).on("change",aL);aT.then(aU,aU),aT.then(t)["catch"](aw),ap.retry&&(ax._changes=aT,ax._abortChanges=aS)}}function ad(){ag().then(function(){return ax.cancelled?void au():ac.getCheckpoint().then(function(aS){aQ=aS,aD={since:aQ,limit:aB,batch_size:aB,style:"all_docs",doc_ids:aR,return_docs:!0},ap.filter&&("string"!=typeof ap.filter?aD.include_docs=!0:aD.filter=ap.filter),"heartbeat" in ap&&(aD.heartbeat=ap.heartbeat),"timeout" in ap&&(aD.timeout=ap.timeout),ap.query_params&&(aD.query_params=ap.query_params),ap.view&&(aD.view=ap.view),al()})})["catch"](function(aS){af("getCheckpoint rejected with ",aS)})}function aG(aS){throw ab=!1,af("writeCheckpoint completed with error",aS),aS}var aP,aC,ac,aj=[],av={seq:0,changes:[],docs:[]},ab=!1,az=!1,am=!1,aQ=0,ah=ap.continuous||ap.live||!1,aB=ap.batch_size||100,aH=ap.batches_limit||10,aI=!1,aR=ap.doc_ids,aO=[],aA=[],aM=ao();aq=aq||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aD={};return ax.ready(aN,aF),ax.cancelled?void au():(ax._addedListeners||(ax.once("cancel",au),"function"==typeof ap.complete&&(ax.once("error",ap.complete),ax.once("complete",function(aS){ap.complete(null,aS)})),ax._addedListeners=!0),void ("undefined"==typeof ap.since?ad():ag().then(function(){return ab=!0,ac.writeCheckpoint(ap.since,aM)}).then(function(){return ab=!1,ax.cancelled?void au():(aQ=ap.since,void ad())})["catch"](aG)))}function fW(){jv.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new a9(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function v(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function m(t,ab,ag,aa){if("function"==typeof ag&&(aa=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw D(iy,"`doc_ids` filter parameter is not a list.")}ag.complete=aa,ag=eq(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ad=new fW(ag),ac=v(t,ag),af=v(ab,ag);return ig(ac,af,ag,ad),ad}function jA(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=eq(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=gf.toPouch(t,ac),ab=gf.toPouch(ab,ac),new hj(t,ab,ac,aa)}function hj(ag,aq,ap,ad){function au(ay){aj.emit("change",{direction:"pull",change:ay})}function ak(ay){aj.emit("change",{direction:"push",change:ay})}function aa(ay){aj.emit("denied",{direction:"push",doc:ay})}function am(ay){aj.emit("denied",{direction:"pull",doc:ay})}function av(){aj.pushPaused=!0,aj.pullPaused&&aj.emit("paused")}function ac(){aj.pullPaused=!0,aj.pushPaused&&aj.emit("paused")}function ah(){aj.pushPaused=!1,aj.pullPaused&&aj.emit("active",{direction:"push"})}function al(){aj.pullPaused=!1,aj.pushPaused&&aj.emit("active",{direction:"pull"})}function af(ay){return function(aC,az){var aE="change"===aC&&(az===au||az===ak),aA="denied"===aC&&(az===am||az===aa),aD="paused"===aC&&(az===ac||az===av),aB="active"===aC&&(az===al||az===ah);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aj.removeAllListeners(aC))}}var aj=this;this.canceled=!1;var ab=ap.push?g4.extend({},ap,ap.push):ap,aw=ap.pull?g4.extend({},ap,ap.pull):ap;this.push=iD(ag,aq,ab),this.pull=iD(aq,ag,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ap.live&&(this.push.on("complete",aj.pull.cancel.bind(aj.pull)),this.pull.on("complete",aj.push.cancel.bind(aj.push))),this.on("newListener",function(ay){"change"===ay?(aj.pull.on("change",au),aj.push.on("change",ak)):"denied"===ay?(aj.pull.on("denied",am),aj.push.on("denied",aa)):"active"===ay?(aj.pull.on("active",al),aj.push.on("active",ah)):"paused"===ay&&(aj.pull.on("paused",ac),aj.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aj.pull.removeListener("change",au),aj.push.removeListener("change",ak)):"denied"===ay?(aj.pull.removeListener("denied",am),aj.push.removeListener("denied",aa)):"active"===ay?(aj.pull.removeListener("active",al),aj.push.removeListener("active",ah)):"paused"===ay&&(aj.pull.removeListener("paused",ac),aj.push.removeListener("paused",av))}),this.pull.on("removeListener",af("pull")),this.push.on("removeListener",af("push"));var t=a9.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aj.emit("complete",az),ad&&ad(null,az),aj.removeAllListeners(),az},function(ay){if(aj.cancel(),ad?ad(ay):aj.emit("error",ay),aj.removeAllListeners(),ad){throw ay}});this.then=function(ay,az){return t.then(ay,az)},this["catch"]=function(ay){return t["catch"](ay)}}function gL(aa,t){return hq(hU(aa),t)}function dt(aa){for(var ac="",ad=new Uint8Array(aa),ab=ad.byteLength,t=0;ab>t;t++){ac+=String.fromCharCode(ad[t])}return ac}function jh(t,ab){if("undefined"==typeof FileReader){return ab(dt((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(dt(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function k(t){return new a9(function(aa){jh(t,function(ab){aa(di(ab))})})}function fn(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function a1(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=gL(ab.data,ab.content_type)})}function iK(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function iC(t){return t._attachments&&Object.keys(t._attachments)?a9.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?k(aa.data).then(function(ac){aa.data=ac}):void 0})):a9.resolve()}function fX(t){var aa=jm(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function fd(aa,t){return gI(aa,aa.db+"/"+t)}function gI(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function jj(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function jx(av,aj){function t(aA,ax,az){var aw=aA.ajax||{},ay=g4.extend(eq(ab),aw,ax);return iZ(ay.method+" "+ay.url),hO.ajax(ay,az)}function ac(ax,aw){return new a9(function(ay,az){t(ax,aw,function(aA,aB){return aA?az(aA):void ay(aB)})})}function aa(ax,aw){return fl(ax,ji(function(ay){ap().then(function(){return aw.apply(this,ay)})["catch"](function(aA){var az=ay.pop();az(aA)})}))}function ap(){if(av.skipSetup||av.skip_setup){return a9.resolve()}if(am){return am}var aw={method:"GET",url:af};return am=ac({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(iJ(404,"PouchDB is just detecting if the remote exists."),ac({},{method:"PUT",url:af})):a9.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:a9.reject(ax)}),am["catch"](function(){am=null}),am}function ah(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ak=this,ad=fX;av.getHost&&(ad=av.getHost);var ag=ad(av.name,av),af=fd(ag,"");av=eq(av);var ab=av.ajax||{};if(ak.getUrl=function(){return af},ak.getHeaders=function(){return ab.headers||{}},av.auth||ag.auth){var al=av.auth||ag.auth,aq=al.username+":"+al.password,au=di(unescape(encodeURIComponent(aq)));ab.headers=ab.headers||{},ab.headers.Authorization="Basic "+au}var am;setTimeout(function(){aj(null,ak)}),ak.type=function(){return"http"},ak.id=aa("id",function(aw){t({},{method:"GET",url:gI(ag,"")},function(ay,az){var ax=az&&az.uuid?az.uuid+ag.db:fd(ag,"");aw(null,ax)})}),ak.request=aa("request",function(ax,aw){ax.url=fd(ag,ax.url),t({},ax,aw)}),ak.compact=aa("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=eq(ax),t(ax,{url:fd(ag,"_compact"),method:"POST"},function(){function ay(){ak.info(function(aA,az){az&&!az.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ak.bulkGet=fl("bulkGet",function(ax,ay){function aA(aE){var aD={};ax.revs&&(aD.revs=!0),ax.attachments&&(aD.attachments=!0),t({},{url:fd(ag,"_bulk_get"+jj(aD)),method:"POST",body:{docs:ax.docs}},aE)}function aC(){function aJ(aK){return function(aL,aM){aI[aK]=aM.results,++aH===aE&&ay(null,{results:fn(aI)})}}for(var aG=i6,aE=Math.ceil(ax.docs.length/aG),aH=0,aI=new Array(aE),aD=0;aE>aD;aD++){var aF=hE(ax,["revs","attachments"]);aF.ajax=ab,aF.docs=ax.docs.slice(aD*aG,Math.min(ax.docs.length,(aD+1)*aG)),fb(aw,aF,aJ(aD))}}var aw=this,az=gI(ag,""),aB=iz[az];"boolean"!=typeof aB?aA(function(aE,aD){if(aE){var aF=Math.floor(aE.status/100);4===aF||5===aF?(iz[az]=!1,iJ(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aC()):ay(aE)}else{iz[az]=!0,ay(null,aD)}}):aB?aA(ay):aC()}),ak._info=function(aw){ap().then(function(){t({},{method:"GET",url:fd(ag,"")},function(ay,ax){return ay?aw(ay):(ax.host=fd(ag,""),void aw(null,ax))})})["catch"](aw)},ak.get=aa("get",function(ax,aC,aA){function az(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?a9.all(aF.map(function(aH){var aI=aD[aH],aG=iK(aE._id)+"/"+ah(aH)+"?rev="+aE._rev;return ac(aC,{method:"GET",url:fd(ag,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:k(aJ)}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?a9.all(aD.map(function(aE){return aE.ok?az(aE.ok):void 0})):az(aD)}"function"==typeof aC&&(aA=aC,aC={}),aC=eq(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),ax=iK(ax);var aB={method:"GET",url:fd(ag,ax+jj(aw))};ac(aC,aB).then(function(aD){return a9.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){aA(null,aD)})})["catch"](aA)}),ak.remove=aa("remove",function(aB,az,ay,ax){var aw;"string"==typeof az?(aw={_id:aB,_rev:az},"function"==typeof ay&&(ax=ay,ay={})):(aw=aB,"function"==typeof az?(ax=az,ay={}):(ax=ay,ay=az));var aA=aw._rev||ay.rev;t(ay,{method:"DELETE",url:fd(ag,iK(aw._id))+"?rev="+aA},ax)}),ak.getAttachment=aa("getAttachment",function(aB,az,ay,ax){"function"==typeof ay&&(ax=ay,ay={});var aw=ay.rev?"?rev="+ay.rev:"",aA=fd(ag,iK(aB))+"/"+ah(az)+aw;t(ay,{method:"GET",url:aA,binary:!0},ax)}),ak.removeAttachment=aa("removeAttachment",function(ax,ay,aA,aw){var az=fd(ag,iK(ax)+"/"+ah(ay))+"?rev="+aA;t({},{method:"DELETE",url:az},aw)}),ak.putAttachment=aa("putAttachment",function(az,aF,aE,aD,aC,ax){"function"==typeof aC&&(ax=aC,aC=aD,aD=aE,aE=null);var aw=iK(az)+"/"+ah(aF),ay=fd(ag,aw);if(aE&&(ay+="?rev="+aE),"string"==typeof aD){var aA;try{aA=hU(aD)}catch(aG){return ax(D(hZ,"Attachment is not a valid base64 string"))}aD=aA?hq(aA,aC):""}var aB={headers:{"Content-Type":aC},method:"PUT",url:ay,processData:!1,body:aD,timeout:ab.timeout||60000};t({},aB,ax)}),ak._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,ap().then(function(){return a9.all(ax.docs.map(iC))}).then(function(){t(aw,{method:"POST",url:fd(ag,"_bulk_docs"),body:ax},function(az,aA){return az?ay(az):(aA.forEach(function(aB){aB.ok=!0}),void ay(null,aA))})})["catch"](ay)},ak.allDocs=aa("allDocs",function(ax,ay){"function"==typeof ax&&(ay=ax,ax={}),ax=eq(ax);var aA,aC={},az="GET";ax.conflicts&&(aC.conflicts=!0),ax.descending&&(aC.descending=!0),ax.include_docs&&(aC.include_docs=!0),ax.attachments&&(aC.attachments=!0),ax.key&&(aC.key=JSON.stringify(ax.key)),ax.start_key&&(ax.startkey=ax.start_key),ax.startkey&&(aC.startkey=JSON.stringify(ax.startkey)),ax.end_key&&(ax.endkey=ax.end_key),ax.endkey&&(aC.endkey=JSON.stringify(ax.endkey)),"undefined"!=typeof ax.inclusive_end&&(aC.inclusive_end=!!ax.inclusive_end),"undefined"!=typeof ax.limit&&(aC.limit=ax.limit),"undefined"!=typeof ax.skip&&(aC.skip=ax.skip);var aB=jj(aC);if("undefined"!=typeof ax.keys){var aw="keys="+encodeURIComponent(JSON.stringify(ax.keys));aw.length+aB.length+1<=gi?aB+="&"+aw:(az="POST",aA={keys:ax.keys})}ac(ax,{method:az,url:fd(ag,"_all_docs"+aB),body:aA}).then(function(aD){ax.include_docs&&ax.attachments&&ax.binary&&aD.rows.forEach(a1),ay(null,aD)})["catch"](ay)}),ak._changes=function(ax){var aG="batch_size" in ax?ax.batch_size:gB;ax=eq(ax),ax.timeout="timeout" in ax?ax.timeout:"timeout" in ab?ab.timeout:30000;var aB,aC=ax.timeout?{timeout:ax.timeout-5000}:{},aD="undefined"!=typeof ax.limit?ax.limit:!1;aB="return_docs" in ax?ax.return_docs:"returnDocs" in ax?ax.returnDocs:!0;var aF=aD;if(ax.style&&(aC.style=ax.style),(ax.include_docs||ax.filter&&"function"==typeof ax.filter)&&(aC.include_docs=!0),ax.attachments&&(aC.attachments=!0),ax.continuous&&(aC.feed="longpoll"),ax.conflicts&&(aC.conflicts=!0),ax.descending&&(aC.descending=!0),"heartbeat" in ax?ax.heartbeat&&(aC.heartbeat=ax.heartbeat):aC.heartbeat=10000,ax.filter&&"string"==typeof ax.filter&&(aC.filter=ax.filter,"_view"===ax.filter&&ax.view&&"string"==typeof ax.view&&(aC.view=ax.view)),ax.query_params&&"object"==typeof ax.query_params){for(var aH in ax.query_params){ax.query_params.hasOwnProperty(aH)&&(aC[aH]=ax.query_params[aH])}}var ay,aw="GET";if(ax.doc_ids){aC.filter="_doc_ids";var aE=JSON.stringify(ax.doc_ids);aE.length<gi?aC.doc_ids=aE:(aw="POST",ay={doc_ids:ax.doc_ids})}var aI,aK,aJ=function(aL,aM){if(!ax.aborted){aC.since=aL,"object"==typeof aC.since&&(aC.since=JSON.stringify(aC.since)),ax.descending?aD&&(aC.limit=aF):aC.limit=!aD||aF>aG?aG:aF;var aN={method:aw,url:fd(ag,"_changes"+jj(aC)),timeout:ax.timeout,body:ay};aK=aL,ax.aborted||ap().then(function(){aI=t(ax,aN,aM)})["catch"](aM)}},az={results:[]},aA=function(aM,aP){if(!ax.aborted){var aO=0;if(aP&&aP.results){aO=aP.results.length,az.last_seq=aP.last_seq;var aL={};aL.query=ax.query_params,aP.results=aP.results.filter(function(aR){aF--;var aQ=g7(ax)(aR);return aQ&&(ax.include_docs&&ax.attachments&&ax.binary&&a1(aR),aB&&az.results.push(aR),ax.onChange(aR)),aQ})}else{if(aM){return ax.aborted=!0,void ax.complete(aM)}}aP&&aP.last_seq&&(aK=aP.last_seq);var aN=aD&&0>=aF||aP&&aG>aO||ax.descending;(!ax.continuous||aD&&0>=aF)&&aN?ax.complete(null,az):setTimeout(function(){aJ(aK,aA)},0)}};return aJ(ax.since||0,aA),{cancel:function(){ax.aborted=!0,aI&&aI.abort()}}},ak.revsDiff=aa("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),t(aw,{method:"POST",url:fd(ag,"_revs_diff"),body:ax},ay)}),ak._close=function(aw){aw()},ak._destroy=function(aw,ax){t(aw,{url:fd(ag,""),method:"DELETE"},function(ay,az){return ay&&ay.status&&404!==ay.status?ax(ay):(ak.emit("destroyed"),ak.constructor.emit("destroyed",av.name),void ax(null,az))})}}function es(){this.promise=new a9(function(t){t()})}function iR(t){return jy.hash(t)}function gq(ac){var aa=ac.db,af=ac.viewName,ah=ac.map,ag=ac.reduce,ab=ac.temporary,ad=ah.toString()+(ag&&ag.toString())+"undefined";if(!ab&&aa._cachedViews){var t=aa._cachedViews[ad];if(t){return a9.resolve(t)}}return aa.info().then(function(ak){function al(am){am.views=am.views||{};var aq=af;-1===aq.indexOf("/")&&(aq=af+"/"+af);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ab?"temp":iR(ad));return de(aa,"_local/mrviews",al).then(function(){return aa.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:aa,adapter:aa.adapter,mapFun:ah,reduceFun:ag};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ab||(aa._cachedViews=aa._cachedViews||{},aa._cachedViews[ad]=aq,aq.db.once("destroyed",function(){delete aa._cachedViews[ad]})),aq})})})})}function jz(aa,ac,ad,ab,t,af){return gJ("return ("+aa.replace(/;\s*$/,"")+");",{emit:ac,sum:ad,log:ab,isArray:t,toJSON:af})}function s(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function ci(t){return 1===t.length&&/^1-/.test(t[0].rev)}function hD(t,aa){try{t.emit("error",aa)}catch(ab){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(aa)}}function ae(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return hD(t,aa),{error:aa}}}function fi(t,aa){var ab=ip(t.key,aa.key);return 0!==ab?ab:ip(t.value,aa.value)}function jc(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function iG(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function Z(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gL(ac.data,ac.content_type)})})}function ht(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&Z(aa),aa}}function gd(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new hb(t)}function gl(ac){for(var aa=0,af=0,ah=ac.length;ah>af;af++){var ag=ac[af];if("number"!=typeof ag){if(!Array.isArray(ag)){throw gd("_sum")}aa="number"==typeof aa?[aa]:aa;for(var ab=0,ad=ag.length;ad>ab;ab++){var t=ag[ab];if("number"!=typeof t){throw gd("_sum")}"undefined"==typeof aa[ab]?aa.push(t):aa[ab]+=t}}else{"number"==typeof aa?aa+=ag:aa[0]+=ag}}return aa}function h6(aa,ac,ad,ab){var t=ac[aa];"undefined"!=typeof t&&(ab&&(t=encodeURIComponent(JSON.stringify(t))),ad.push(aa+"="+t))}function h3(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function g1(t){return t.group_level=h3(t.group_level),t.limit=h3(t.limit),t.skip=h3(t.skip),t}function il(t){if(t){if("number"!=typeof t){return new ge('Invalid value for integer: "'+t+'"')}if(0>t){return new ge('Invalid value for positive integer: "'+t+'"')}}}function iP(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&ip(t[ac],t[aa])>0){throw new ge("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new ge("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new ge("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=il(t[af]);if(ad){throw ad}})}function iE(ab,aa,ad){var ag,af=[],ac="GET";if(h6("reduce",ad,af),h6("include_docs",ad,af),h6("attachments",ad,af),h6("limit",ad,af),h6("descending",ad,af),h6("group",ad,af),h6("group_level",ad,af),h6("skip",ad,af),h6("stale",ad,af),h6("conflicts",ad,af),h6("startkey",ad,af,!0),h6("start_key",ad,af,!0),h6("endkey",ad,af,!0),h6("end_key",ad,af,!0),h6("inclusive_end",ad,af),h6("key",ad,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ad.keys){var t=2000,ah="keys="+encodeURIComponent(JSON.stringify(ad.keys));ah.length+af.length+1<=t?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?ag={keys:ad.keys}:aa.keys=ad.keys)}if("string"==typeof aa){var aj=s(aa);return ab.request({method:ac,url:"_design/"+aj[0]+"/_view/"+aj[1]+af,body:ag}).then(ht(ad))}return ag=ag||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?ag[ak]=aa[ak]:ag[ak]=aa[ak].toString()}),ab.request({method:"POST",url:"_temp_view"+af,body:ag}).then(ht(ad))}function gp(t,aa,ab){return new a9(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function id(t){return new a9(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function hG(t){return function(aa){if(404===aa.status){return t}throw aa}}function ce(t,aj,ad){function ag(){return ci(ab)?a9.resolve(ah):aj.db.get(aa)["catch"](hG(ah))}function af(am){return am.keys.length?aj.db.allDocs({keys:am.keys,include_docs:!0}):a9.resolve({rows:[]})}function ac(au,ap){for(var ay=[],aA={},az=0,ax=ap.rows.length;ax>az;az++){var av=ap.rows[az],am=av.doc;if(am&&(ay.push(am),aA[am._id]=!0,am._deleted=!al[am._id],!am._deleted)){var aq=al[am._id];"value" in aq&&(am.value=aq.value)}}var aw=Object.keys(al);return aw.forEach(function(aD){if(!aA[aD]){var aB={_id:aD},aC=al[aD];"value" in aC&&(aB.value=aC.value),ay.push(aB)}}),au.keys=h2(aw.concat(au.keys)),ay.push(au),ay}var aa="_local/doc_"+t,ah={_id:aa,keys:[]},ak=ad[t],al=ak.indexableKeysToKeyValues,ab=ak.changes;return ag().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function i7(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](hG({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return a9.all(ad.map(function(ag){return ce(ag,t,ab)})).then(function(ah){var ag=fn(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function go(t){var aa="string"==typeof t?t:t.name,ab=gZ[aa];return ab||(ab=gZ[aa]=new es),ab}function o(t){return g(go(t),function(){return i2(t)})()}function i2(ab){function aa(am,ak){var al={id:af._id,key:hi(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=hi(ak)),ag.push(al)}function ad(ak,al){return function(){return i7(ab,ak,al)}}var ag,af,ac;if("function"==typeof ab.mapFun&&2===ab.mapFun.length){var t=ab.mapFun;ac=function(ak){return t(ak,aa)}}else{ac=jz(ab.mapFun.toString(),aa,gl,gN,Array.isArray,JSON.parse)}var ah=ab.seq||0,aj=new es;return new a9(function(ap,ak){function al(){aj.finish().then(function(){ab.seq=ah,ap()})}function am(){function aq(au){ak(au)}ab.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:gr}).on("complete",function(aF){var ax=aF.results;if(!ax.length){return al()}for(var aC={},aA=0,aD=ax.length;aD>aA;aA++){var aw=ax[aA];if("_"!==aw.doc._id[0]){ag=[],af=aw.doc,af._deleted||ae(ab.sourceDB,ac,[af]),ag.sort(fi);for(var aG,ay={},au=0,aE=ag.length;aE>au;au++){var aB=ag[au],az=[aB.key,aB.id];0===ip(aB.key,aG)&&az.push(au);var av=gs(az);ay[av]=aB,aG=aB.key}aC[aw.doc._id]={indexableKeysToKeyValues:ay,changes:aw.changes}}ah=aw.seq}return aj.add(ad(aC,ah)),ax.length<gr?al():am()}).on("error",aq)}am()})}function jb(t,aj,ad){0===ad.group_level&&delete ad.group_level;var ag,af=ad.group||ad.group_level;ag=L[t.reduceFun]?L[t.reduceFun]:jz(t.reduceFun.toString(),null,gl,gN,Array.isArray,JSON.parse);var ac=[],aa=isNaN(ad.group_level)?Number.POSITIVE_INFINITY:ad.group_level;aj.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&(ap=ap.slice(0,aa)),am&&0===ip(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ac.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aj=[];for(var ah=0,ak=ac.length;ak>ah;ah++){var al=ac[ah],ab=ae(t.sourceDB,ag,[al.keys,al.values,!1]);if(ab.error&&ab.error instanceof hb){throw ab.error}aj.push({value:ab.error?null:ab.output,key:al.groupKey})}return{rows:jc(aj,ad.limit,ad.skip)}}function ic(aa,t){return g(go(aa),function(){return gV(aa,t)})()}function gV(t,ag){function ac(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ad=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=gx(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function af(au){var av;if(av=aa?jb(t,au,ag):{total_rows:ad,offset:aj,rows:au},ag.include_docs){var aq=h2(au.map(iG));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ag.conflicts,attachments:ag.attachments,binary:ag.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=iG(ay),az=aw["$"+aA];az&&(ay.doc=az)}),av})}return av}var ad,aa=t.reduceFun&&ag.reduce!==!1,aj=ag.skip||0;if("undefined"==typeof ag.keys||ag.keys.length||(ag.limit=0,delete ag.keys),"undefined"!=typeof ag.keys){var ap=ag.keys,ah=ap.map(function(au){var aq={startkey:gs([au]),endkey:gs([au,{}])};return ac(aq)});return a9.all(ah).then(fn).then(af)}var ak={descending:ag.descending};if(ag.start_key&&(ag.startkey=ag.start_key),ag.end_key&&(ag.endkey=ag.end_key),"undefined"!=typeof ag.startkey&&(ak.startkey=gs(ag.descending?[ag.startkey,{}]:[ag.startkey])),"undefined"!=typeof ag.endkey){var am=ag.inclusive_end!==!1;ag.descending&&(am=!am),ak.endkey=gs(am?[ag.endkey,{}]:[ag.endkey])}if("undefined"!=typeof ag.key){var ab=gs([ag.key]),al=gs([ag.key,{}]);ak.descending?(ak.endkey=ab,ak.startkey=al):(ak.startkey=ab,ak.endkey=al)}return aa||("number"==typeof ag.limit&&(ak.limit=ag.limit),ak.skip=aj),ac(ak).then(af)}function N(t){return t.request({method:"POST",url:"_view_cleanup"})}function gO(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=s(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return g(go(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return a9.all(af).then(function(){return{ok:!0}})})},hG({ok:!0}))}function iv(ag,t,ac){if("http"===ag.type()){return iE(ag,t,ac)}if("function"==typeof ag._query){return gp(ag,t,ac)}if("string"!=typeof t){iP(ac,t);var af={db:ag,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return h8.add(function(){return gq(af).then(function(ak){function aj(){return ak.db.destroy()}return at(o(ak).then(function(){return ic(ak,ac)}),aj)})}),h8.finish()}var aa=t,ad=s(aa),ah=ad[0],ab=ad[1];return ag.getView(ah,ab).then(function(aj){iP(ac,aj);var ak={db:ag,viewName:aa,map:aj.map,reduce:aj.reduce};return gq(ak).then(function(al){return"ok"===ac.stale||"update_after"===ac.stale?("update_after"===ac.stale&&fc.nextTick(function(){o(al)}),ic(al,ac)):o(al).then(function(){return ic(al,ac)})})})}function ge(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,ge)}catch(t){}}function hb(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,hb)}catch(t){}}function j(t){return di(dt(t))}function A(ac,aa,af){function ah(al){try{return hU(al)}catch(aj){var ak=D(hZ,"Attachment is not a valid base64 string");return{error:ak}}}function ag(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ah(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===aa?aj.data=hq(al,aj.content_type):"base64"===aa?aj.data=di(al):aj.data=al,fh(al).then(function(am){aj.digest="md5-"+am,ak()})}else{jp(aj.data,function(am){"binary"===aa?aj.data=dt(am):"base64"===aa&&(aj.data=j(am)),fh(am).then(function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ab(){t++,ac.length===t&&(ad?af(ad):af())}if(!ac.length){return af()}var ad,t=0;ac.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ab()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ab()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ag(ak.data._attachments[ap],am)}})}function h4(aa,t){return aa.pos-t.pos}function et(aa,ac,ad){for(var ab,t=0,af=aa.length;af>t;){ab=t+af>>>1,ad(aa[ab],ac)<0?t=ab+1:af=ab}return t}function jq(t,ab,ac){var aa=et(t,ab,ac);t.splice(aa,0,ab)}function an(ac,aa){for(var af,ah,ag=aa,ab=ac.length;ab>ag;ag++){var ad=ac[ag],t=[ad.id,ad.opts,[]];ah?(ah[2].push(t),ah=t):af=ah=t}return af}function jn(aa,t){return aa[0]<t[0]?-1:1}function R(aa,aj){for(var ad=[{tree1:aa,tree2:aj}],ag=!1;ad.length>0;){var af=ad.pop(),ac=af.tree1,ak=af.tree2;(ac[1].status||ak[1].status)&&(ac[1].status="available"===ac[1].status||"available"===ak[1].status?"available":"missing");for(var ah=0;ah<ak[2].length;ah++){if(ac[2][0]){for(var ab=!1,t=0;t<ac[2].length;t++){ac[2][t][0]===ak[2][ah][0]&&(ad.push({tree1:ac[2][t],tree2:ak[2][ah]}),ab=!0)}ab||(ag="new_branch",jq(ac[2],ak[2][ah],jn))}else{ag="new_leaf",ac[2][0]=ak[2][ah]}}}return{conflicts:ag,tree:aa}}function hW(ac,ah,aq){var ab,av=[],al=!1,ak=!1;if(!ac.length){return{tree:[ah],conflicts:"new_leaf"}}for(var af=0,aw=ac.length;aw>af;af++){var t=ac[af];if(t.pos===ah.pos&&t.ids[0]===ah.ids[0]){ab=R(t.ids,ah.ids),av.push({pos:t.pos,ids:ab.tree}),al=al||ab.conflicts,ak=!0}else{if(aq!==!0){var ad=t.pos<ah.pos?t:ah,am=t.pos<ah.pos?ah:t,aa=am.pos-ad.pos,aj=[],ax=[];for(ax.push({ids:ad.ids,diff:aa,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],au=0,ap=az.length;ap>au;au++){ax.push({ids:az[au],diff:ay.diff-1,parent:ay.ids,parentIdx:au})}}else{ay.ids[0]===am.ids[0]&&aj.push(ay)}}var ag=aj[0];ag?(ab=R(ag.ids,am.ids),ag.parent[2][ag.parentIdx]=ab.tree,av.push({pos:ad.pos,ids:ad.ids}),al=al||ab.conflicts,ak=!0):av.push(t)}else{av.push(t)}}}return ak||av.push(ah),av.sort(h4),{tree:av,conflicts:al||"internal_node"}}function gD(t,ag){for(var ac,af=a7(t),ad={},aa=0,aj=af.length;aj>aa;aa++){for(var ap=af[aa],ah=ap.ids,ak=Math.max(0,ah.length-ag),am={pos:ap.pos+ak,ids:an(ah,ak)},ab=0;ak>ab;ab++){var al=ap.pos+ab+"-"+ah[ab].id;ad[al]=!0}ac=ac?hW(ac,am,!0).tree:[am]}return be(ac,function(av,aq,au){delete ad[aq+"-"+au]}),{tree:ac,revs:Object.keys(ad)}}function hA(aa,ac,ad){var ab=hW(aa,ac),t=gD(ab.tree,ad);return{tree:t.tree,stemmedRevs:t.revs,conflicts:ab.conflicts}}function hY(aa,aj){for(var ad,ag=aa.slice(),af=aj.split("-"),ac=parseInt(af[0],10),ak=af[1];ad=ag.pop();){if(ad.pos===ac&&ad.ids[0]===ak){return !0}for(var ah=ad.ids[2],ab=0,t=ah.length;t>ab;ab++){ag.push({pos:ad.pos+1,ids:ah[ab]})}}return !1}function ho(aa,ag,au,az,aw,ah,av,ac){if(hY(ag.rev_tree,au.metadata.rev)){return az[aw]=au,ah()}var ay=ag.winningRev||y(ag),al="deleted" in ag?ag.deleted:cn(ag,ay),ab="deleted" in au.metadata?au.metadata.deleted:cn(au.metadata),am=/^1-/.test(au.metadata.rev);if(al&&!ab&&ac&&am){var t=au.data;t._rev=ay,t._id=au.metadata.id,au=h0(t,ac)}var af=hA(ag.rev_tree,au.metadata.rev_tree[0],aa),ax=ac&&(al&&ab||!al&&"new_leaf"!==af.conflicts||al&&!ab&&"new_branch"===af.conflicts);if(ax){var ap=D(iF);return az[aw]=ap,ah()}var aq=au.metadata.rev;au.metadata.rev_tree=af.tree,au.stemmedRevs=af.stemmedRevs||[],ag.rev_map&&(au.metadata.rev_map=ag.rev_map);var ad,ak=y(au.metadata),aA=cn(au.metadata,ak),aj=al===aA?0:aA>al?-1:1;ad=aq===ak?aA:cn(au.metadata,aq),av(au,ak,aA,ad,!0,aj,aw,ah)}function eu(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function hy(ag,aq,aa,ad,ab,ak,au,al,ap){function t(aC,aw,aA){var ay=y(aC.metadata),az=cn(aC.metadata,ay);if("was_delete" in al&&az){return ak[aw]=D(ja,"deleted"),aA()}var av=am&&eu(aC);if(av){var aB=D(iF);return ak[aw]=aB,aA()}var ax=az?0:1;au(aC,ay,az,az,!1,ax,aw,aA)}function ah(){++aj===ac&&ap&&ap()}ag=ag||1000;var am=al.new_edits,af=new gz.Map,aj=0,ac=aq.length;aq.forEach(function(aw,ay){if(aw._id&&ar(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aa[ax](aw,{ctx:ab},function(aA,az){ak[ay]=aA||az,ah()})}var av=aw.metadata.id;af.has(av)?(ac--,af.get(av).push([aw,ay])):af.set(av,[[aw,ay]])}),af.forEach(function(ay,aw){function ax(){++az<ay.length?av():ah()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(ad.has(aw)){ho(ag,ad.get(aw),aA,ak,aB,ax,au,am)}else{var aD=hA([],aA.metadata.rev_tree[0],ag);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],t(aA,aB,ax)}}var az=0;av()})}function g8(aa){var t=[];return be(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function js(aa){try{return JSON.parse(aa)}catch(t){return W.parse(aa)}}function l(t){return t.length<50000?JSON.parse(t):js(t)}function h5(aa){try{return JSON.stringify(aa)}catch(t){return W.stringify(aa)}}function jt(aa,ac,ad,ab){try{aa.apply(ac,ad)}catch(t){ab.emit("error",t)}}function ff(aa){if(!i0.running&&i0.queue.length){i0.running=!0;var t=i0.queue.shift();t.action(function(ac,ab){jt(t.callback,this,[ac,ab],aa),i0.running=!1,fc.nextTick(function(){ff(aa)})})}}function fV(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(D(gE,aa,ab.type))}}function ir(t,aa,ab){return{data:h5(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function O(aa){if(!aa){return null}var t=l(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function dn(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function i3(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:gL(t,ab):io([""],{type:ab})):t?"string"!=typeof t?jh(t,function(ad){aa(di(ad))}):aa(t):aa("")}function iw(ac,aa,af,ah){function ag(){++t===ad.length&&ah&&ah()}function ab(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=af.objectStore(hJ).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ag()}}var ad=Object.keys(ac._attachments||{});if(!ad.length){return ah&&ah()}var t=0;ad.forEach(function(aj){aa.attachments&&aa.include_docs?ab(ac,aj):(ac._attachments[aj].stub=!0,ag())})}function hw(aa,t){return a9.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return a9.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new a9(function(aj){i3(ah,af,t,function(ak){ac.doc._attachments[ag]=g4.extend(hE(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function iO(aa,aj,ad){function ag(){t--,t||af()}function af(){ac.length&&ac.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ah["delete"](am)}})}var ac=[],ak=ad.objectStore(iW),ah=ad.objectStore(hJ),ab=ad.objectStore(hs),t=aa.length;aa.forEach(function(al){var am=ak.index("_doc_id_rev"),ap=aj+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ag()}ak["delete"](au);var av=ab.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ac.push(ax),ab["delete"](aw.primaryKey),aw["continue"]()}else{ag()}}}})}function gA(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function g0(aM,aq,aK,ac,t,af,ay){function ag(){var aO=[F,iW,hJ,fx,hs],aP=gA(t,aO,"readwrite");return aP.error?ay(aP.error):(am=aP.txn,am.onabort=fV(ay),am.ontimeout=fV(ay),am.oncomplete=aN,aI=am.objectStore(F),aB=am.objectStore(iW),av=am.objectStore(hJ),aA=am.objectStore(hs),void aL(function(aQ){return aQ?(aj=!0,ay(aQ)):void ah()}))}function aC(){hy(aM.revs_limit,ab,ac,az,am,ad,ak,aK)}function ah(){function aR(){++aP===ab.length&&aC()}function aT(aW){var aV=O(aW.target.result);aV&&az.set(aV.id,aV),aR()}if(ab.length){for(var aP=0,aS=0,aQ=ab.length;aQ>aS;aS++){var aU=ab[aS];if(aU._id&&ar(aU._id)){aR()}else{var aO=aI.get(aU.metadata.id);aO.onsuccess=aT}}}}function aN(){aj||(af.notify(ac._meta.name),ac._meta.docCount+=aG,ay(null,ad))}function aF(aP,aQ){var aO=av.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=D(ha,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aL(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(ab.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){aF(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function ak(aR,aX,aT,aV,aU,aS,aP,aW){aG+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?aJ(aR,aX,aT,aU,aP,aW):void ax(aR,aX,aT,aU,aP,aW)}function aa(aO){var aP=g8(aO.metadata);iO(aP,aO.metadata.id,am)}function ax(aP,aW,aT,aU,aR,aY){function aV(ba){aU&&ac.auto_compaction?aa(aP):aP.stemmedRevs.length&&iO(aP.stemmedRevs,aP.metadata.id,am),aS.seq=ba.target.result,delete aS.rev;var bb=ir(aS,aW,aT),bc=aI.put(bb);bc.onsuccess=aZ}function aX(bb){bb.preventDefault(),bb.stopPropagation();var bc=aB.index("_doc_id_rev"),ba=bc.getKey(aQ._doc_id_rev);ba.onsuccess=function(bd){var bf=aB.put(aQ,bd.target.result);bf.onsuccess=aV}}function aZ(){ad[aR]={ok:!0,id:aS.id,rev:aW},az.set(aP.metadata.id,aP.metadata),aw(aP,aS.seq,aY)}var aQ=aP.data,aS=aP.metadata;aQ._doc_id_rev=aS.id+"::"+aS.rev,delete aQ._id,delete aQ._rev;var aO=aB.put(aQ);aO.onsuccess=aV,aO.onerror=aX}function aJ(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&ax(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(bc){var ba=aQ.data._attachments[bc];if(ba.stub){aP++,aO()}else{var aZ=ba.data;delete ba.data,ba.revpos=parseInt(aX,10);var bb=ba.digest;aH(bb,aZ,aW)}})}function aw(aR,aU,aP){function aS(){++aV===aO.length&&aP()}function aQ(aW){var aX=aR.data._attachments[aW].digest,aY=aA.put({seq:aU,digestSeq:aX+"::"+aU});aY.onsuccess=aS,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aS()}}var aV=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function aH(aP,aR,aO){var aQ=av.count(aP);aQ.onsuccess=function(aV){var aU=aV.target.result;if(aU){return aO()}var aS={digest:aP,body:aR},aT=av.put(aS);aT.onsuccess=aO}}for(var am,aI,aB,av,aA,aE,ab=aq.docs,aG=0,ap=0,aD=ab.length;aD>ap;ap++){var au=ab[ap];au._id&&ar(au._id)||(au=ab[ap]=h0(au,aK.new_edits),au.error&&!aE&&(aE=au))}if(aE){return ay(aE)}var ad=new Array(ab.length),az=new gz.Map,aj=!1,al=ac._meta.blobSupport?"blob":"base64";A(ab,al,function(aO){return aO?ay(aO):void ag()})}function r(aa,ac,ad,ab,t){try{if(aa&&ac){return t?IDBKeyRange.bound(ac,aa,!ad,!1):IDBKeyRange.bound(aa,ac,!1,!ad)}if(aa){return t?IDBKeyRange.upperBound(aa):IDBKeyRange.lowerBound(aa)}if(ac){return t?IDBKeyRange.lowerBound(ac,!ad):IDBKeyRange.upperBound(ac,!ad)}if(ab){return IDBKeyRange.only(ab)}}catch(af){return{error:af}}return null}function hN(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(D(gE,ac.name,ac.message))}function hB(aa,ac,ad,ab){function t(aw,aG){function aA(aM,aL,aK){var aN=aM.id+"::"+aK;aI.get(aN).onsuccess=function(aO){aL.doc=dn(aO.target.result),aw.conflicts&&(aL.doc._conflicts=fU(aM)),iw(aL.doc,aw,aE)}}function av(aN,aL,aM){var aO={id:aM.id,key:aM.id,value:{rev:aL}},aK=aM.deleted;if("ok"===aw.deleted){aB.push(aO),aK?(aO.value.deleted=!0,aO.doc=null):aw.include_docs&&aA(aM,aO,aL)}else{if(!aK&&au--<=0&&(aB.push(aO),aw.include_docs&&aA(aM,aO,aL),0===--am)){return}}aN["continue"]()}function ak(aK){aF=ac._meta.docCount;var aL=aK.target.result;if(aL){var aM=O(aL.value),aN=aM.winningRev;av(aL,aN,aM)}}function ah(){aG(null,{total_rows:aF,offset:aw.skip,rows:aB})}function aq(){aw.attachments?hw(aB,aw.binary).then(ah):ah()}var ap="startkey" in aw?aw.startkey:!1,ay="endkey" in aw?aw.endkey:!1,aH="key" in aw?aw.key:!1,au=aw.skip||0,am="number"==typeof aw.limit?aw.limit:-1,aC=aw.inclusive_end!==!1,ax="descending" in aw&&aw.descending?"prev":null,az=r(ap,ay,aC,aH,ax);if(az&&az.error){return hN(ac,aw,az.error,aG)}var ag=[F,iW];aw.attachments&&ag.push(hJ);var aJ=gA(ad,ag,"readonly");if(aJ.error){return aG(aJ.error)}var aE=aJ.txn,al=aE.objectStore(F),aD=aE.objectStore(iW),aj=ax?al.openCursor(az,ax):al.openCursor(az),aI=aD.index("_doc_id_rev"),aB=[],aF=0;aE.oncomplete=aq,aj.onsuccess=ak}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ac._meta.docCount,offset:ah.skip,rows:[]}):void t(ah,ag)}af(aa,ab)}function hz(t){return new a9(function(ab){var aa=io([""]);t.objectStore(i5).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function ie(t){ey()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):bn()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ia(){jv.EventEmitter.call(this),this._listeners={},ie(this)}function hr(t,aa){var ab=this;i0.queue.push({action:function(ac){iX(ab,t,ac)},callback:aa}),ff(ab.constructor)}function iX(ak,ap,ag){function ad(av){var aw=av.createObjectStore(F,{keyPath:"id"});av.createObjectStore(iW,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(hJ,{keyPath:"digest"}),av.createObjectStore(hV,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(i5),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(fx,{keyPath:"_id"});var au=av.createObjectStore(hs,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ab(av,aw){var au=av.objectStore(F);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(aA){var ay=aA.target.result;if(ay){var ax=ay.value,az=cn(ax);ax.deletedOrLocal=az?"1":"0",au.put(ax),ay["continue"]()}else{aw()}}}function aa(au){au.createObjectStore(fx,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aq(av,au){var ax=av.objectStore(fx),aw=av.objectStore(F),ay=av.objectStore(iW),az=aw.openCursor();az.onsuccess=function(aB){var aE=aB.target.result;if(aE){var aJ=aE.value,aH=aJ.id,aI=ar(aH),aL=y(aJ);if(aI){var aC=aH+"::"+aL,aF=aH+"::",aA=aH+"::~",aD=ay.index("_doc_id_rev"),aG=IDBKeyRange.bound(aF,aA,!1,!1),aK=aD.openCursor(aG);aK.onsuccess=function(aN){if(aK=aN.target.result){var aM=aK.value;aM._doc_id_rev===aC&&ax.put(aM),ay["delete"](aK.primaryKey),aK["continue"]()}else{aw["delete"](aE.primaryKey),aE["continue"]()}}}else{aE["continue"]()}}else{au&&au()}}}function t(au){var av=au.createObjectStore(hs,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function al(av,au){var ax=av.objectStore(iW),aw=av.objectStore(hJ),ay=av.objectStore(hs),az=aw.count();az.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ax.openCursor().onsuccess=function(aJ){var aD=aJ.target.result;if(!aD){return au()}for(var aE=aD.value,aL=aD.primaryKey,aH=Object.keys(aE._attachments||{}),aF={},aG=0;aG<aH.length;aG++){var aI=aE._attachments[aH[aG]];aF[aI.digest]=!0}var aK=Object.keys(aF);for(aG=0;aG<aK.length;aG++){var aC=aK[aG];ay.put({seq:aL,digestSeq:aC+"::"+aL})}aD["continue"]()}):au()}}function aj(ax){function av(az){return az.data?O(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ax.objectStore(iW),ay=ax.objectStore(F),aw=ay.openCursor();aw.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=ir(az,az.winningRev,az.deleted),aF=ay.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=av(aA.value);return az.winningRev=az.winningRev||y(az),az.seq?aD():void aB()}}}var am=ap.name,af=null;ak._meta=null,ak.type=function(){return"idb"},ak._id=ei(function(au){au(null,ak._meta.instanceId)}),ak._bulkDocs=function(au,aw,av){g0(ap,au,aw,ak,af,hc,av)},ak._get=function(ay,av,az){function aB(){az(ax,{doc:aA,metadata:aC,ctx:au})}var aA,aC,ax,au=av.ctx;if(!au){var aw=gA(af,[F,iW,hJ],"readonly");if(aw.error){return az(aw.error)}au=aw.txn}au.objectStore(F).get(ay).onsuccess=function(aG){if(aC=O(aG.target.result),!aC){return ax=D(ja,"missing"),aB()}if(cn(aC)&&!av.rev){return ax=D(ja,"deleted"),aB()}var aE=au.objectStore(iW),aD=av.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=dn(aA)),aA?void aB():(ax=D(ja,"missing"),aB())}}},ak._getAttachment=function(av,ax,aw){var aA;if(ax.ctx){aA=ax.ctx}else{var au=gA(af,[F,iW,hJ],"readonly");if(au.error){return aw(au.error)}aA=au.txn}var az=av.digest,ay=av.content_type;aA.objectStore(hJ).get(az).onsuccess=function(aC){var aB=aC.target.result.body;i3(aB,ay,ax.binary,function(aD){aw(null,aD)})}},ak._info=function(ax){if(null===af||!dr.has(am)){var aA=new Error("db isn't open");return aA.id="idbNull",ax(aA)}var av,aw,az=gA(af,[iW],"readonly");if(az.error){return ax(az.error)}var ay=az.txn,au=ay.objectStore(iW).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,aw=ak._meta.docCount},ay.oncomplete=function(){ax(null,{doc_count:aw,update_seq:av,idb_attachment_format:ak._meta.blobSupport?"binary":"base64"})}},ak._allDocs=function(av,au){hB(av,ak,af,au)},ak._changes=function(aJ){function ay(aS){function aN(){return aO.seq!==aM?aS["continue"]():(aL=aM,aO.winningRev===aR._rev?aP(aR):void aQ())}function aQ(){var aU=aR._id+"::"+aO.winningRev,aT=aD.get(aU);aT.onsuccess=function(aV){aP(dn(aV.target.result))}}function aP(aU){var aT=aJ.processChange(aU,aO,aJ);aT.seq=aO.seq;var aV=aI(aT);return"object"==typeof aV?aJ.complete(aV):(aV&&(aB++,av&&aw.push(aT),aJ.attachments&&aJ.include_docs?iw(aU,aJ,aK,function(){hw([aT],aJ.binary).then(function(){aJ.onChange(aT)})}):aJ.onChange(aT)),void (aB!==az&&aS["continue"]()))}var aR=dn(aS.value),aM=aS.key;if(aH&&!aH.has(aR._id)){return aS["continue"]()}var aO;return(aO=aC.get(aR._id))?aN():void (aF.get(aR._id).onsuccess=function(aT){aO=O(aT.target.result),aC.set(aR._id,aO),aN()})}function aE(aM){var aN=aM.target.result;aN&&ay(aN)}function aA(){var aN=[F,iW];aJ.attachments&&aN.push(hJ);var aO=gA(af,aN,"readonly");if(aO.error){return aJ.complete(aO.error)}aK=aO.txn,aK.onabort=fV(aJ.complete),aK.oncomplete=au,ax=aK.objectStore(iW),aF=aK.objectStore(F),aD=ax.index("_doc_id_rev");var aM;aM=aJ.descending?ax.openCursor(null,"prev"):ax.openCursor(IDBKeyRange.lowerBound(aJ.since,!0)),aM.onsuccess=aE}function au(){function aM(){aJ.complete(null,{results:aw,last_seq:aL})}!aJ.continuous&&aJ.attachments?hw(aw).then(aM):aM()}if(aJ=eq(aJ),aJ.continuous){var aG=am+":"+ao();return hc.addListener(am,aG,ak,aJ),hc.notify(am),{cancel:function(){hc.removeListener(am,aG)}}}var aH=aJ.doc_ids&&new gz.Set(aJ.doc_ids);aJ.since=aJ.since||0;var aL=aJ.since,az="limit" in aJ?aJ.limit:-1;0===az&&(az=1);var av;av="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aK,ax,aF,aD,aw=[],aB=0,aI=g7(aJ),aC=new gz.Map;aA()},ak._close=function(au){return null===af?au(D(er)):(af.close(),dr["delete"](am),af=null,void au())},ak._getRevisionTree=function(ax,av){var au=gA(af,[F],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(F).get(ax);aw.onsuccess=function(aA){var az=O(aA.target.result);az?av(null,az.rev_tree):av(D(ja))}},ak._doCompaction=function(av,ax,aw){var aA=[F,iW,hJ,hs],au=gA(af,aA,"readwrite");if(au.error){return aw(au.error)}var az=au.txn,ay=az.objectStore(F);ay.get(av).onsuccess=function(aC){var aE=O(aC.target.result);be(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==ax.indexOf(aF)&&(aK.status="missing")}),iO(ax,av,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(F).put(ir(aE,aD,aB))},az.onabort=fV(aw),az.oncomplete=function(){aw()}},ak._getLocal=function(ax,av){var au=gA(af,[fx],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(fx).get(ax);aw.onerror=fV(av),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,av(null,az)):av(D(ja))}},ak._putLocal=function(ay,au,az){"function"==typeof au&&(az=au,au={}),delete ay._revisions;var aB=ay._rev,aA=ay._id;aB?ay._rev="0-"+(parseInt(aB.split("-")[1],10)+1):ay._rev="0-1";var aC,aw=au.ctx;if(!aw){var aD=gA(af,[fx],"readwrite");if(aD.error){return az(aD.error)}aw=aD.txn,aw.onerror=fV(az),aw.oncomplete=function(){aC&&az(null,aC)}}var av,ax=aw.objectStore(fx);aB?(av=ax.get(aA),av.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aB){var aG=ax.put(ay);aG.onsuccess=function(){aC={ok:!0,id:ay._id,rev:ay._rev},au.ctx&&az(null,aC)}}else{az(D(iF))}}):(av=ax.add(ay),av.onerror=function(aE){az(D(iF)),aE.preventDefault(),aE.stopPropagation()},av.onsuccess=function(){aC={ok:!0,id:ay._id,rev:ay._rev},au.ctx&&az(null,aC)})},ak._removeLocal=function(ay,av,az){"function"==typeof av&&(az=av,av={});var aB=av.ctx;if(!aB){var aA=gA(af,[fx],"readwrite");if(aA.error){return az(aA.error)}aB=aA.txn,aB.oncomplete=function(){aC&&az(null,aC)}}var aC,ax=ay._id,au=aB.objectStore(fx),aw=au.get(ax);aw.onerror=fV(az),aw.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ay._rev?(au["delete"](ax),aC={ok:!0,id:ax,rev:"0-0"},av.ctx&&az(null,aC)):az(D(ja))}},ak._destroy=function(ax,av){hc.removeAllListeners(am);var aw=hh.get(am);aw&&aw.result&&(aw.result.close(),dr["delete"](am));var au=indexedDB.deleteDatabase(am);au.onsuccess=function(){hh["delete"](am),bn()&&am in localStorage&&delete localStorage[am],av(null,{ok:!0})},au.onerror=fV(av)};var ah=dr.get(am);if(ah){return af=ah.idb,ak._meta=ah.global,void fc.nextTick(function(){ag(null,ak)})}var ac;ac=ap.storage?gm(am,ap.storage):indexedDB.open(am,gu),hh.set(am,ac),ac.onupgradeneeded=function(ax){function ay(){var aA=aw[az-1];az++,aA&&aA(au,ay)}var av=ax.target.result;if(ax.oldVersion<1){return ad(av)}var au=ax.currentTarget.transaction;ax.oldVersion<3&&aa(av),ax.oldVersion<4&&t(av);var aw=[ab,aq,al,aj],az=ax.oldVersion;ay()},ac.onsuccess=function(aw){af=aw.target.result,af.onversionchange=function(){af.close(),dr["delete"](am)},af.onabort=function(aA){console.error("Database has a global failure",aA.target.error),af.close(),dr["delete"](am)};var ax=af.transaction([hV,i5,F],"readwrite"),ay=ax.objectStore(hV).get(hV),av=null,az=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==az&&null!==au&&(ak._meta={name:am,instanceId:au,blobSupport:av,docCount:az},dr.set(am,{idb:af,global:ak._meta}),ag(null,ak))},aA=aB.target.result||{id:hV};am+"_id" in aA?(au=aA[am+"_id"],aD()):(au=ao(),aA[am+"_id"]=au,ax.objectStore(hV).put(aA).onsuccess=function(){aD()}),fS||(fS=hz(ax)),fS.then(function(aE){av=aE,aD()});var aC=ax.objectStore(F).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){az=aE.target.result,aD()}}},ac.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";console.error(au),ag(D(gE,au))}}function gm(t,aa){try{return indexedDB.open(t,{version:gu,storage:aa})}catch(ab){return indexedDB.open(t,gu)}}function fe(t){return decodeURIComponent(window.escape(t))}function f(t){return 65>t?t-48:t-55}function hQ(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(f(t.charCodeAt(ab++))<<4|f(t.charCodeAt(ab++)))}return aa}function fo(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(f(t.charCodeAt(ab+2))<<12|f(t.charCodeAt(ab+3))<<8|f(t.charCodeAt(ab))<<4|f(t.charCodeAt(ab+1))),ab+=4}return aa}function it(aa,t){return"UTF-8"===t?fe(hQ(aa,0,aa.length)):fo(aa,0,aa.length)}function gX(t){return"'"+t+"'"}function h7(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function hC(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function K(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hd(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function i9(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hg(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function hl(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function E(aa,ac,ad,ab,t){return"SELECT "+aa+" FROM "+("string"==typeof ac?ac:ac.join(" JOIN "))+(ad?" ON "+ad:"")+(ab?" WHERE "+("string"==typeof ab?ab:ab.join(" AND ")):"")+(t?" ORDER BY "+t:"")}function iU(t,ab,ag){function aa(){++ac===t.length&&ad()}function ad(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+H+" WHERE seq IN "+hl(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+H+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+H+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new gz.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+H+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+hk+" WHERE digest=?",[az]))})})})}})}}if(t.length){var ac=0,af=[];t.forEach(function(aj){var ah="SELECT seq FROM "+hX+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ab,aj],function(al,am){if(!am.rows.length){return aa()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+hX+" WHERE seq=?",[ak],aa)})})}}function g9(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(D(bt,ab,ac))}}function a0(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function gW(t,aa){try{return{db:t(aa)}}catch(ab){return{error:ab}}}function fs(t){var aa=hx.get(t.name);if(!aa){var ab=h7();aa=gW(ab,t),hx.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return aa}function g6(aa,ac,av,az,ax,aj,ah){function aB(){return ad?ah(ad):(aj.notify(az._name),az._docCount=-1,void ah(null,ak))}function ag(aD,aE){var aC="SELECT count(*) as cnt FROM "+hk+" WHERE digest=?";au.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=D(ha,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ap(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ag(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ab(aE,aL,aQ,aG,aI,aO,aJ,aM){function aC(){function aW(bg,bc){function bb(){return ++ba===aZ.length&&bc(),!1}function bf(bh){var bj="INSERT INTO "+H+" (digest, seq) VALUES (?,?)",bi=[aX._attachments[bh].digest,bg];au.executeSql(bj,bi,bb,bb)}var ba=0,aZ=Object.keys(aX._attachments||{});if(!aZ.length){return bc()}for(var bd=0;bd<aZ.length;bd++){bf(aZ[bd])}}var aX=aE.data,aU=aG?1:0,aR=aX._id,aV=aX._rev,aT=i9(aX),aS="INSERT INTO "+hX+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aY=[aR,aV,aT,aU];au.executeSql(aS,aY,function(aZ,ba){var bb=ba.insertId;aW(bb,function(){aD(aZ,bb)})},function(){var aZ=E("seq",hX,null,"doc_id=? AND rev=?");return au.executeSql(aZ,[aR,aV],function(bc,bb){var ba=bb.rows.item(0).seq,bd="UPDATE "+hX+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bf=[aT,aU,aR,aV];bc.executeSql(bd,bf,function(bg){aW(ba,function(){aD(bg,ba)})})}),!1})}function aF(aR){aH||(aR?(aH=aR,aM(aH)):aN===aP.length&&aC())}function aK(aR){aN++,aF(aR)}function aD(aT,aV){var aS=aE.metadata.id;aI&&az.auto_compaction?iU(g8(aE.metadata),aS,aT):aE.stemmedRevs.length&&iU(aE.stemmedRevs,aS,aT),aE.metadata.seq=aV,delete aE.metadata.rev;var aU=aI?"UPDATE "+eo+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+hX+" WHERE doc_id="+eo+".id AND rev=?) WHERE id=?":"INSERT INTO "+eo+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aR=h5(aE.metadata),aW=aI?[aR,aV,aL,aS]:[aS,aV,aV,aR];aT.executeSql(aU,aW,function(){ak[aJ]={ok:!0,id:aE.metadata.id,rev:aL},am.set(aS,aE.metadata),aM()})}var aH=null,aN=0;aE.data._id=aE.metadata.id,aE.data._rev=aE.metadata.rev;var aP=Object.keys(aE.data._attachments||{});aG&&(aE.data._deleted=!0),aP.forEach(function(aU){var aS=aE.data._attachments[aU];if(aS.stub){aN++,aF()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aL,10);var aT=aS.digest;af(aT,aR,aK)}}),aP.length||aC()}function al(){hy(aa.revs_limit,aq,az,am,au,ak,ab,av)}function t(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&ar(aG._id)){return aE()}var aF=aG.metadata.id;au.executeSql("SELECT json FROM "+eo+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=l(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function af(aD,aF,aC){var aE="SELECT digest FROM "+hk+" WHERE digest=?";au.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+hk+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,K(aF)],function(){aC()},function(){return aC(),!1}))})}var ay=av.new_edits,aA=ac.docs,aq=aA.map(function(aC){if(aC._id&&ar(aC._id)){return aC}var aD=h0(aC,ay);return aD}),aw=aq.filter(function(aC){return aC.error});if(aw.length){return ah(aw[0])}var au,ad,ak=new Array(aq.length),am=new gz.Map;A(aq,"binary",function(aC){return aC?ah(aC):void ax.transaction(function(aD){au=aD,ap(function(aE){aE?ad=aE:t(al)})},g9(ah),aB)})}function iY(ad,aj,af,ah,ag){function ab(){++ac===t.length&&ag&&ag()}function aa(al,ak){var am=al._attachments[ak],ap={binary:aj.binary,ctx:ah};af._getAttachment(am,ap,function(aq,au){al._attachments[ak]=g4.extend(hE(am,["digest","content_type"]),{data:au}),ab()})}var t=Object.keys(ad._attachments||{});if(!t.length){return ag&&ag()}var ac=0;t.forEach(function(ak){aj.attachments&&aj.include_docs?aa(ad,ak):(ad._attachments[ak].stub=!0,ab())})}function fu(am,az){function ah(){bn()&&(window.localStorage["_pouch__websqldb_"+t._name]=!0),az(null,t)}function aw(aD,aE){aD.executeSql(gw),aD.executeSql("ALTER TABLE "+hX+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(hR),aD.executeSql("ALTER TABLE "+eo+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+eo+" (local, id)");var aF="SELECT "+eo+".winningseq AS seq, "+eo+".json AS metadata FROM "+hX+" JOIN "+eo+" ON "+hX+".seq = "+eo+".winningseq";aD.executeSql(aF,[],function(aK,aG){for(var aL=[],aI=[],aH=0;aH<aG.rows.length;aH++){var aN=aG.rows.item(aH),aM=aN.seq,aJ=JSON.parse(aN.metadata);cn(aJ)&&aL.push(aM),ar(aJ.id)&&aI.push(aJ.id)}aK.executeSql("UPDATE "+eo+"SET local = 1 WHERE id IN "+hl(aI.length),aI,function(){aK.executeSql("UPDATE "+hX+" SET deleted = 1 WHERE seq IN "+hl(aL.length),aL,aE)})})})})}function ak(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+gg+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+eo+".id AS id, "+hX+".json AS data FROM "+hX+" JOIN "+eo+" ON "+hX+".seq = "+eo+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aI,aL){function aJ(){if(!aH.length){return aF(aI)}var aM=aH.shift(),aN=JSON.parse(aM.data)._rev;aI.executeSql("INSERT INTO "+gg+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+eo+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+hX+" WHERE seq=?",[aM.seq],function(){aJ()})})})}for(var aH=[],aK=0;aK<aL.rows.length;aK++){aH.push(aL.rows.item(aK))}aJ()})})}function ab(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aM=aH.shift(),aO=it(aM.hex,af),aK=aO.lastIndexOf("::"),aN=aO.substring(0,aK),aJ=aO.substring(aK+2),aL="UPDATE "+hX+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aN,aJ,aO],function(){aI()})}aI()}var aF="ALTER TABLE "+hX+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+hX+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(fv,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+hX;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ax(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+hk;aI.executeSql(aH,[],function(aN,aL){function aO(){var aP=E(cr+", "+eo+".id AS id",[eo,hX],ij,null,eo+".id ");aP+=" LIMIT "+aK+" OFFSET "+aJ,aJ+=aK,aN.executeSql(aP,[],function(ba,aV){function bb(bc,bd){var bf=aT[bc]=aT[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aV.rows.length){return aG(ba)}for(var aT={},aY=0;aY<aV.rows.length;aY++){for(var aW=aV.rows.item(aY),aX=hg(aW.data,aW.id,aW.rev),aQ=Object.keys(aX._attachments||{}),aR=0;aR<aQ.length;aR++){var aU=aX._attachments[aQ[aR]];bb(aU.digest,aW.seq)}}var aZ=[];if(Object.keys(aT).forEach(function(bc){var bd=aT[bc];bd.forEach(function(bf){aZ.push([bc,bf])})}),!aZ.length){return aO()}var aS=0;aZ.forEach(function(bd){var bc="INSERT INTO "+H+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aS===aZ.length&&aO()})})})}var aM=aL.rows.item(0).cnt;if(!aM){return aG(aN)}var aJ=0,aK=10;aO()})}var aF="CREATE TABLE IF NOT EXISTS "+H+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(hP,[],function(aI){aI.executeSql(g2,[],aD)})})}function ay(aE,aF){var aD="ALTER TABLE "+hk+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function aA(aE,aF){var aD="ALTER TABLE "+eo+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aH){var aG="UPDATE "+eo+" SET max_seq=(SELECT MAX(seq) FROM "+hX+" WHERE doc_id=id)";aH.executeSql(aG,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+eo+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ap(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aG,aF){var aH=aF.rows.item(0).hex;af=2===aH.length?"UTF-8":"UTF-16",aE()})}function aj(){for(;au.length>0;){var aD=au.pop();aD(null,ag)}}function aa(aG,aK){if(0===aK){var aO="CREATE TABLE IF NOT EXISTS "+gQ+" (dbid, db_version INTEGER)",aF="CREATE TABLE IF NOT EXISTS "+hk+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aH="CREATE TABLE IF NOT EXISTS "+H+" (digest, seq INTEGER)",aJ="CREATE TABLE IF NOT EXISTS "+eo+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aI="CREATE TABLE IF NOT EXISTS "+hX+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aD="CREATE TABLE IF NOT EXISTS "+gg+" (id UNIQUE, rev, json)";aG.executeSql(aF),aG.executeSql(aD),aG.executeSql(aH,[],function(){aG.executeSql(g2),aG.executeSql(hP)}),aG.executeSql(aJ,[],function(){aG.executeSql(gw),aG.executeSql(aI,[],function(){aG.executeSql(hR),aG.executeSql(fv),aG.executeSql(aO,[],function(){var aQ="INSERT INTO "+gQ+" (db_version, dbid) VALUES (?,?)";ag=ao();var aP=[iM,ag];aG.executeSql(aQ,aP,function(){aj()})})})})}else{var aM=function(){var aP=iM>aK;aP&&aG.executeSql("UPDATE "+gQ+" SET db_version = "+iM);var aQ="SELECT dbid FROM "+gQ;aG.executeSql(aQ,[],function(aR,aS){ag=aS.rows.item(0).dbid,aj()})},aE=[aw,ak,ab,ax,ay,aA,aM],aN=aK,aL=function(aP){aE[aN-1](aP,aL),aN++};aL(aG)}}function aq(){av.transaction(function(aD){ap(aD,function(){aB(aD)})},g9(az),ah)}function aB(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+gQ;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+gQ,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;aa(aI,aH)}):aF.executeSql("ALTER TABLE "+gQ+" ADD COLUMN db_version INTEGER",[],function(){aa(aF,1)}):aa(aF,0)})}function aC(aE,aF){if(-1!==t._docCount){return aF(t._docCount)}var aD=E("COUNT("+eo+".id) AS 'num'",[eo,hX],ij,hX+".deleted=0");aE.executeSql(aD,[],function(aH,aG){t._docCount=aG.rows.item(0).num,aF(t._docCount)})}var af,t=this,ag=null,al=a0(am),au=[];t._docCount=-1,t._name=am.name;var ad=g4.extend({},am,{size:al,version:gK}),ac=fs(ad);if(ac.error){return g9(az)(ac.error)}var av=ac.db;"function"!=typeof av.readTransaction&&(av.readTransaction=av.transaction),aq(),t.type=function(){return"websql"},t._id=ei(function(aD){aD(null,ag)}),t._info=function(aD){av.readTransaction(function(aE){aC(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+hX;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:av._sqlitePlugin,websql_encoding:af})})})},g9(aD))},t._bulkDocs=function(aF,aD,aE){g6(am,aF,aD,t,av,jr,aE)},t._get=function(aG,aM,aI){function aL(){aI(aE,{doc:aK,metadata:aH,ctx:aJ})}var aK,aH,aE,aJ=aM.ctx;if(!aJ){return av.readTransaction(function(aN){t._get(aG,g4.extend({ctx:aN},aM),aI)})}var aD,aF;aM.rev?(aD=E(cr,[eo,hX],eo+".id="+hX+".doc_id",[hX+".doc_id=?",hX+".rev=?"]),aF=[aG,aM.rev]):(aD=E(cr,[eo,hX],ij,eo+".id=?"),aF=[aG]),aJ.executeSql(aD,aF,function(aP,aO){if(!aO.rows.length){return aE=D(ja,"missing"),aL()}var aN=aO.rows.item(0);return aH=l(aN.metadata),aN.deleted&&!aM.rev?(aE=D(ja,"deleted"),aL()):(aK=hg(aN.data,aH.id,aN.rev),void aL())})},t._allDocs=function(aG,aM){var aP,aF=[],aD="startkey" in aG?aG.startkey:!1,aJ="endkey" in aG?aG.endkey:!1,aO="key" in aG?aG.key:!1,aL="descending" in aG?aG.descending:!1,aN="limit" in aG?aG.limit:-1,aQ="skip" in aG?aG.skip:0,aH=aG.inclusive_end!==!1,aK=[],aE=[];if(aO!==!1){aE.push(eo+".id = ?"),aK.push(aO)}else{if(aD!==!1||aJ!==!1){if(aD!==!1&&(aE.push(eo+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aJ!==!1){var aI=aL?">":"<";aH&&(aI+="="),aE.push(eo+".id "+aI+" ?"),aK.push(aJ)}aO!==!1&&(aE.push(eo+".id = ?"),aK.push(aO))}}"ok"!==aG.deleted&&aE.push(hX+".deleted = 0"),av.readTransaction(function(aR){aC(aR,function(aT){if(aP=aT,0!==aN){var aS=E(cr,[eo,hX],ij,aE,eo+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aN+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aV,bc){for(var bd=0,aZ=bc.rows.length;aZ>bd;bd++){var aW=bc.rows.item(bd),aU=l(aW.metadata),ba=aU.id,aX=hg(aW.data,ba,aW.rev),aY=aX._rev,bb={id:ba,key:ba,value:{rev:aY}};if(aG.include_docs&&(bb.doc=aX,bb.doc._rev=aY,aG.conflicts&&(bb.doc._conflicts=fU(aU)),iY(bb.doc,aG,t,aV)),aW.deleted){if("ok"!==aG.deleted){continue}bb.value.deleted=!0,bb.doc=null}aF.push(bb)}})}})},g9(aM),function(){aM(null,{total_rows:aP,offset:aG.skip,rows:aF})})},t._changes=function(aK){function aJ(){var aN=eo+".json AS metadata, "+eo+".max_seq AS maxSeq, "+hX+".json AS winningDoc, "+hX+".rev AS winningRev ",aM=eo+" JOIN "+hX,aO=eo+".id="+hX+".doc_id AND "+eo+".winningseq="+hX+".seq",aP=["maxSeq > ?"],aS=[aK.since];aK.doc_ids&&(aP.push(eo+".id IN "+hl(aK.doc_ids.length)),aS=aS.concat(aK.doc_ids));var aL="maxSeq "+(aF?"DESC":"ASC"),aR=E(aN,aM,aO,aP,aL),aT=g7(aK);aK.view||aK.filter||(aR+=" LIMIT "+aI);var aQ=aK.since||0;av.readTransaction(function(aU){aU.executeSql(aR,aS,function(aX,aW){function aY(bg){return function(){aK.onChange(bg)}}for(var aZ=0,bc=aW.rows.length;bc>aZ;aZ++){var bd=aW.rows.item(aZ),aV=l(bd.metadata);aQ=bd.maxSeq;var bf=hg(bd.winningDoc,aV.id,bd.winningRev),ba=aK.processChange(bf,aV,aK);ba.seq=bd.maxSeq;var bb=aT(ba);if("object"==typeof bb){return aK.complete(bb)}if(bb&&(aG++,aD&&aE.push(ba),aK.attachments&&aK.include_docs?iY(bf,aK,t,aX,aY(ba)):aY(ba)()),aG===aI){break}}})},g9(aK.complete),function(){aK.continuous||aK.complete(null,{results:aE,last_seq:aQ})})}if(aK=eq(aK),aK.continuous){var aH=t._name+":"+ao();return jr.addListener(t._name,aH,t,aK),jr.notify(t._name),{cancel:function(){jr.removeListener(t._name,aH)}}}var aF=aK.descending;aK.since=aK.since&&!aF?aK.since:0;var aI="limit" in aK?aK.limit:-1;0===aI&&(aI=1);var aD;aD="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aE=[],aG=0;aJ()},t._close=function(aD){aD()},t._getAttachment=function(aK,aJ,aH){var aF,aI=aJ.ctx,aD=aK.digest,aE=aK.content_type,aG="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+hk+" WHERE digest=?";aI.executeSql(aG,[aD],function(aL,aO){var aN=aO.rows.item(0),aM=aN.escaped?hd(aN.body):it(aN.body,af);aF=aJ.binary?hq(aM,aE):di(aM),aH(null,aF)})},t._getRevisionTree=function(aD,aE){av.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+eo+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=l(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(D(ja))}})})},t._doCompaction=function(aE,aF,aD){return aF.length?void av.transaction(function(aG){var aH="SELECT json AS metadata FROM "+eo+" WHERE id = ?";aG.executeSql(aH,[aE],function(aL,aJ){var aI=l(aJ.rows.item(0).metadata);be(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+eo+" SET json = ? WHERE id = ?";aL.executeSql(aK,[h5(aI),aE])}),iU(aF,aE,aG)},g9(aD),function(){aD()}):aD()},t._getLocal=function(aD,aE){av.readTransaction(function(aF){var aG="SELECT json, rev FROM "+gg+" WHERE id=?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=aJ.rows.item(0),aK=hg(aI.json,aD,aI.rev);aE(null,aK)}else{aE(D(ja))}})})},t._putLocal=function(aF,aL,aH){function aJ(aO){var aM,aN;aG?(aM="UPDATE "+gg+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aI,aD,aE,aG]):(aM="INSERT INTO "+gg+" (id, rev, json) VALUES (?,?,?)",aN=[aE,aI,aD]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aK={ok:!0,id:aE,rev:aI},aL.ctx&&aH(null,aK)):aH(D(iF))},function(){return aH(D(iF)),!1})}"function"==typeof aL&&(aH=aL,aL={}),delete aF._revisions;var aI,aG=aF._rev,aE=aF._id;aI=aG?aF._rev="0-"+(parseInt(aG.split("-")[1],10)+1):aF._rev="0-1";var aK,aD=i9(aF);aL.ctx?aJ(aL.ctx):av.transaction(aJ,g9(aH),function(){aK&&aH(null,aK)})},t._removeLocal=function(aF,aH,aD){function aG(aI){var aJ="DELETE FROM "+gg+" WHERE id=? AND rev=?",aK=[aF._id,aF._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aE={ok:!0,id:aF._id,rev:"0-0"},void (aH.ctx&&aD(null,aE))):aD(D(ja))})}"function"==typeof aH&&(aD=aH,aH={});var aE;aH.ctx?aG(aH.ctx):av.transaction(aG,g9(aD),function(){aE&&aD(null,aE)})},t._destroy=function(aD,aE){jr.removeAllListeners(t._name),av.transaction(function(aF){var aG=[eo,hX,hk,gQ,gg,H];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},g9(aE),function(){bn()&&(delete window.localStorage["_pouch__websqldb_"+t._name],delete window.localStorage[t._name]),aE(null,{ok:!0})})}}var g4=e(7),iV=ft(g4),ix=ft(e(2)),fz=ft(e(6)),ez=ft(e(8)),gz=e(12),ji=ft(e(1)),jv=e(4),gJ=ft(e(14)),iQ=e(10),gn=ft(iQ),jy=ft(e(15)),W=ft(e(16)),a9="function"==typeof Promise?Promise:ez,hp=ix("pouchdb:api");fz(G,Error),G.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var fg=new G({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),ev=new G({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ja=new G({status:404,error:"not_found",reason:"missing"}),iF=new G({status:409,error:"conflict",reason:"Document update conflict"}),Y=new G({status:400,error:"invalid_id",reason:"_id field must contain a string"}),he=new G({status:412,error:"missing_id",reason:"_id is required for puts"}),gU=new G({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),er=new G({status:412,error:"precondition_failed",reason:"Database not open"}),hm=new G({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),hZ=new G({status:500,error:"badarg",reason:"Some query argument is invalid"}),hM=new G({status:400,error:"invalid_request",reason:"Request was invalid"}),ga=new G({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),iH=new G({status:500,error:"doc_validation",reason:"Bad special document member"}),iy=new G({status:400,error:"bad_request",reason:"Something wrong with the request"}),gt=new G({status:400,error:"bad_request",reason:"Document must be a JSON object"}),fk=new G({status:404,error:"not_found",reason:"Database not found"}),gE=new G({status:500,error:"indexed_db_went_bad",reason:"unknown"}),bt=new G({status:500,error:"web_sql_went_bad",reason:"unknown"}),i4=new G({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),gj=new G({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),a6=new G({status:400,error:"bad_request",reason:"Invalid rev format"}),i1=new G({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),ha=new G({status:412,error:"missing_stub"}),ib=new G({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gP={UNAUTHORIZED:fg,MISSING_BULK_DOCS:ev,MISSING_DOC:ja,REV_CONFLICT:iF,INVALID_ID:Y,MISSING_ID:he,RESERVED_ID:gU,NOT_OPEN:er,UNKNOWN_ERROR:hm,BAD_ARG:hZ,INVALID_REQUEST:hM,QUERY_PARSE_ERROR:ga,DOC_VALIDATION:iH,BAD_REQUEST:iy,NOT_AN_OBJECT:gt,DB_MISSING:fk,WSQ_ERROR:bt,LDB_ERROR:i4,FORBIDDEN:gj,INVALID_REV:a6,FILE_EXISTS:i1,MISSING_STUB:ha,IDB_ERROR:gE,INVALID_URL:ib},M=function(aa,ac,ad){var ab=Object.keys(gP).filter(function(af){var ag=gP[af];return"function"!=typeof ag&&ag[aa]===ac}),t=ad&&ab.filter(function(af){var ag=gP[af];return ag.message===ad})[0]||ab[0];return t?gP[t]:null};fz(q,jv.EventEmitter),q.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},q.prototype.doChanges=function(aa){var ac=this,ad=aa.complete;if(aa=eq(aa),"live" in aa&&!("continuous" in aa)&&(aa.continuous=aa.live),aa.processChange=gC,"latest"===aa.since&&(aa.since="now"),aa.since||(aa.since=0),"now"===aa.since){return void this.db.info().then(function(af){return ac.isCancelled?void ad(null,{status:"cancelled"}):(aa.since=af.update_seq,void ac.doChanges(aa))},ad)}if(aa.continuous&&"now"!==aa.since&&this.db.info().then(function(af){ac.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),aa.filter&&"string"==typeof aa.filter&&("_view"===aa.filter?aa.view=B(aa.view):aa.filter=B(aa.filter),"http"!==this.db.type()&&!aa.doc_ids)){return this.filterChanges(aa)}"descending" in aa||(aa.descending=!1),aa.limit=0===aa.limit?1:aa.limit,aa.complete=ad;var ab=this.db._changes(aa);if(ab&&"function"==typeof ab.cancel){var t=ac.cancel;ac.cancel=ji(function(af){ab.cancel(),t.apply(this,af)})}},q.prototype.filterChanges=function(aa){var ac=this,ad=aa.complete;if("_view"===aa.filter){if(!aa.view||"string"!=typeof aa.view){var ab=D(iy,"`view` filter parameter not found or invalid.");return ad(ab)}var t=gv(aa.view);this.db.getView(t[0],t[1],function(ah,ag){return ac.isCancelled?ad(null,{status:"cancelled"}):ah?ad(hI(ah)):ag.map?(aa.filter=a5(ag.map),void ac.doChanges(aa)):ad(D(ja))})}else{var af=gv(aa.filter);if(!af){return ac.doChanges(aa)}this.db.getFilter(af[0],af[1],function(ah,ag){return ac.isCancelled?ad(null,{status:"cancelled"}):ah?ad(hI(ah)):(aa.filter=gG(ag),void ac.doChanges(aa))})}};var gh="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),ii=p(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gR=p(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);fz(co,jv.EventEmitter),co.prototype.post=fl("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(D(gt)):void this.bulkDocs({docs:[t]},aa,a3(ab))}),co.prototype.put=fl("put",ji(function(t){var ab,ag,aa,ad,ac=t.shift(),af="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(ad=t.pop())(D(gt))}for(;;){if(ab=t.shift(),ag=typeof ab,"string"!==ag||af?"string"!==ag||!af||"_rev" in ac?"object"===ag?aa=ab:"function"===ag&&(ad=ab):ac._rev=ab:(ac._id=ab,af=!0),!t.length){break}}return aa=aa||{},J(ac._id),ar(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,ad):this._putLocal(ac,ad):void this.bulkDocs({docs:[ac]},aa,a3(ad))})),co.prototype.putAttachment=fl("putAttachment",function(t,ab,ag,aa,ad){function ac(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ab]={content_type:ad,data:aa,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof ad&&(ad=aa,aa=ag,ag=null),"undefined"==typeof ad&&(ad=aa,aa=ag,ag=null),af.get(t).then(function(ah){if(ah._rev!==ag){throw D(iF)}return ac(ah)},function(ah){if(ah.reason===ja.message){return ac({_id:t})}throw ah})}),co.prototype.removeAttachment=fl("removeAttachment",function(aa,ac,ad,ab){var t=this;t.get(aa,function(af,ag){return af?void ab(af):ag._rev!==ad?void ab(D(iF)):ag._attachments?(delete ag._attachments[ac],0===Object.keys(ag._attachments).length&&delete ag._attachments,void t.put(ag,ab)):ab()})}),co.prototype.remove=fl("remove",function(aa,ac,ad,ab){var t;"string"==typeof ac?(t={_id:aa,_rev:ac},"function"==typeof ad&&(ab=ad,ad={})):(t=aa,"function"==typeof ac?(ab=ac,ad={}):(ab=ad,ad=ac)),ad=ad||{},ad.was_delete=!0;var af={_id:t._id,_rev:t._rev||ad.rev};return af._deleted=!0,ar(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(t,ab):void this.bulkDocs({docs:[af]},ad,a3(ab))}),co.prototype.revsDiff=fl("revsDiff",function(ac,aa,af){function ah(ak,aj){t.has(ak)||t.set(ak,{missing:[]}),t.get(ak).missing.push(aj)}function ag(aj,ak){var al=ac[aj].slice(0);be(ak,function(aq,av,aw,ap,au){var ax=av+"-"+aw,am=al.indexOf(ax);-1!==am&&(al.splice(am,1),"available"!==au.status&&ah(aj,ax))}),al.forEach(function(am){ah(aj,am)})}"function"==typeof aa&&(af=aa,aa={});var ab=Object.keys(ac);if(!ab.length){return af(null,{})}var ad=0,t=new gz.Map;ab.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){t.set(aj,{missing:ac[aj]})}else{if(al){return af(al)}ag(aj,am)}if(++ad===ab.length){var ak={};return t.forEach(function(ap,aq){ak[aq]=ap}),af(null,ak)}})},this)}),co.prototype.bulkGet=fl("bulkGet",function(aa,t){fb(this,aa,t)}),co.prototype.compactDocument=fl("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ag,aj){if(ag){return ac(ag)}var af=gH(aj),ah=[],ad=[];Object.keys(af).forEach(function(ak){af[ak]>ab&&ah.push(ak)}),be(aj,function(ap,au,al,aq,am){var ak=au+"-"+al;"available"===am.status&&-1!==ah.indexOf(ak)&&ad.push(ak)}),aa._doCompaction(t,ad,ac)})}),co.prototype.compact=fl("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&fY(ab)}),co.prototype._compact=function(t,ab){function ag(ah){af.push(ad.compactDocument(ah.id,0))}function aa(aj){var ah=aj.last_seq;a9.all(af).then(function(){return de(ad,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ab(null,{ok:!0})})["catch"](ab)}var ad=this,ac={return_docs:!1,last_seq:t.last_seq||0},af=[];ad.changes(ac).on("change",ag).on("complete",aa).on("error",ab)},co.prototype.get=fl("get",function(ac,aa,af){function ah(){var ak=[],aj=ag.length;return aj?void ag.forEach(function(al){ab.get(ac,{rev:al,revs:aa.revs,attachments:aa.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||af(null,ak)})}):af(null,ak)}if("function"==typeof aa&&(af=aa,aa={}),"string"!=typeof ac){return af(D(Y))}if(ar(ac)&&"function"==typeof this._getLocal){return this._getLocal(ac,af)}var ag=[],ab=this;if(!aa.open_revs){return this._get(ac,aa,function(aw,aB){if(aw){return af(aw)}var aq=aB.doc,ay=aB.metadata,ap=aB.ctx;if(aa.conflicts){var al=fU(ay);al.length&&(aq._conflicts=al)}if(cn(ay,aq._rev)&&(aq._deleted=!0),aa.revs||aa.revs_info){var au=a7(ay.rev_tree),ax=ai(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aq._rev.split("-")[1])}),ak=ax.ids.map(function(aC){return aC.id}).indexOf(aq._rev.split("-")[1])+1,av=ax.ids.length-ak;if(ax.ids.splice(ak,av),ax.ids.reverse(),aa.revs&&(aq._revisions={start:ax.pos+ax.ids.length-1,ids:ax.ids.map(function(aC){return aC.id})}),aa.revs_info){var aj=ax.pos+ax.ids.length;aq._revs_info=ax.ids.map(function(aC){return aj--,{rev:aj+"-"+aC.id,status:aC.opts.status}})}}if(aa.attachments&&aq._attachments){var az=aq._attachments,am=Object.keys(az).length;if(0===am){return af(null,aq)}Object.keys(az).forEach(function(aC){this._getAttachment(az[aC],{binary:aa.binary,ctx:ap},function(aE,aD){var aF=aq._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--am||af(null,aq)})},ab)}else{if(aq._attachments){for(var aA in aq._attachments){aq._attachments.hasOwnProperty(aA)&&(aq._attachments[aA].stub=!0)}}af(null,aq)}})}if("all"===aa.open_revs){this._getRevisionTree(ac,function(ak,aj){return ak?af(ak):(ag=g5(aj).map(function(al){return al.rev}),void ah())})}else{if(!Array.isArray(aa.open_revs)){return af(D(hm,"function_clause"))}ag=aa.open_revs;for(var ad=0;ad<ag.length;ad++){var t=ag[ad];if("string"!=typeof t||!/^\d+-/.test(t)){return af(D(a6))}}ah()}}),co.prototype.getView=fl("getView",function(t,aa,ab){a4(this,t,"views",aa,ab)}),co.prototype.getFilter=fl("getFilter",function(t,aa,ab){a4(this,t,"filters",aa,ab)}),co.prototype.getAttachment=fl("getAttachment",function(aa,ac,ad,ab){var t=this;ad instanceof Function&&(ab=ad,ad={}),this._get(aa,ad,function(af,ag){return af?ab(af):ag.doc._attachments&&ag.doc._attachments[ac]?(ad.ctx=ag.ctx,ad.binary=!0,t._getAttachment(ag.doc._attachments[ac],ad,ab),void 0):ab(D(ja))})}),co.prototype.allDocs=fl("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(D(ga,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return fm(this,t,aa)}}return this._allDocs(t,aa)}),co.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new q(this,aa,t)},co.prototype.close=fl("close",function(t){return this._closed=!0,this._close(t)}),co.prototype.info=fl("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),co.prototype.id=fl("id",function(t){return this._id(t)}),co.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},co.prototype.bulkDocs=fl("bulkDocs",function(aa,ac,ad){if("function"==typeof ac&&(ad=ac,ac={}),ac=ac||{},Array.isArray(aa)&&(aa={docs:aa}),!aa||!aa.docs||!Array.isArray(aa.docs)){return ad(D(ev))}for(var ab=0;ab<aa.docs.length;++ab){if("object"!=typeof aa.docs[ab]||Array.isArray(aa.docs[ab])){return ad(D(gt))}}var t;return aa.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){t=t||i(ag)})}),t?ad(D(iy,t)):("new_edits" in ac||("new_edits" in aa?ac.new_edits=aa.new_edits:ac.new_edits=!0),ac.new_edits||"http"===this.type()||aa.docs.sort(a2),fT(aa.docs),this._bulkDocs(aa,ac,function(af,ag){return af?ad(af):(ac.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ad(null,ag))}))}),co.prototype.registerDependentDatabase=fl("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);de(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),co.prototype.destroy=fl("destroy",function(aa,ac){function ad(){ab._destroy(aa,function(ag,af){return ag?ac(ag):(ab._destroyed=!0,ab.emit("destroyed"),void ac(null,af||{ok:!0}))})}"function"==typeof aa&&(ac=aa,aa={});var ab=this,t="use_prefix" in ab?ab.use_prefix:!0;return"http"===ab.type()?ad():void ab.get("_local/_pouch_dependentDbs",function(ag,aj){if(ag){return 404!==ag.status?ac(ag):ad()}var af=aj.dependentDbs,ah=ab.constructor,ak=Object.keys(af).map(function(al){var am=t?al.replace(new RegExp("^"+ah.prefix),""):al;return new ah(am,ab.__opts).destroy()});a9.all(ak).then(ad,ac)})}),h9.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},h9.prototype.fail=function(t){this.failed=t,this.execute()},h9.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},h9.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},fz(iS,co),iS.debug=ix;var gT;if(ey()){gT=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),gT=!!localStorage.getItem("_pouch_check_localstorage")}catch(h){gT=!1}}iS.adapters={},iS.preferredAdapters=[],iS.prefix="_pouch_";var u=new jv.EventEmitter;C(iS),iS.parseAdapter=function(ac,aa){var af,ah,ag=ac.match(/([a-z\-]*):\/\/(.*)/);if(ag){if(ac=/http(s?)/.test(ag[1])?ag[1]+"://"+ag[2]:ag[2],af=ag[1],!iS.adapters[af].valid()){throw"Invalid adapter"}return{name:ac,adapter:ag[1]}}var ab="idb" in iS.adapters&&"websql" in iS.adapters&&bn()&&localStorage["_pouch__websqldb_"+iS.prefix+ac];if(aa.adapter){ah=aa.adapter}else{if("undefined"!=typeof aa&&aa.db){ah="leveldb"}else{for(var ad=0;ad<iS.preferredAdapters.length;++ad){if(ah=iS.preferredAdapters[ad],ah in iS.adapters){if(ab&&"idb"===ah){console.log('PouchDB is downgrading "'+ac+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}af=iS.adapters[ah];var t=af&&"use_prefix" in af?af.use_prefix:!0;return{name:t?iS.prefix+ac:ac,adapter:ah}},iS.adapter=function(t,aa,ab){aa.valid()&&(iS.adapters[t]=aa,ab&&iS.preferredAdapters.push(t))},iS.plugin=function(t){return Object.keys(t).forEach(function(aa){iS.prototype[aa]=t[aa]}),iS},iS.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=g4.extend({},aa,ad),void iS.call(this,ab,ad,ac)):new t(ab,ad,ac)}return fz(t,iS),C(t),t.preferredAdapters=iS.preferredAdapters.slice(),Object.keys(iS).forEach(function(ab){ab in t||(t[ab]=iS[ab])}),t};var h1=iN(),gY=function(){},jo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gc="queryKey",jg=/(?:^|&)([^&=]*)=?([^&]*)/g,g3=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hU=function(t){return atob(t)},di=function(t){return btoa(t)},hu=iV.extend,hO={ajax:br,parseUri:jm,uuid:ao,Promise:a9,atob:hU,btoa:di,binaryStringToBlobOrBuffer:hq,clone:eq,extend:hu,createError:D},fq=gn.collate,ew=1,gk="pouchdb",i8=5,ju=0;jk.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},jk.prototype.updateTarget=function(aa,t){return iT(this.target,this.id,aa,t,this.returnValue)},jk.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?a9.resolve(!0):iT(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(hK(ac)){return ab.readOnlySource=!0,!0}throw ac})};var ex={undefined:function(aa,t){return 0===fq(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return gS(t,aa).last_seq}};jk.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?a9.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ju}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in ex?ex[ab](aa,ac):ju},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ju}).then(function(){return ju},function(ac){return hK(ac)?(t.readOnlySource=!0,aa.last_seq):ju})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ju})};var iL=0,gM=gb.setImmediate||gb.setTimeout,jw=32768,fh=ei(function(aa,aj){function ad(){var aq=ah*ac,al=aq+ac;if(ah++,ak>ah){t(ab,aa,aq,al),gM(ad)}else{t(ab,aa,aq,al);var ap=ab.end(!0),am=w(ap);aj(null,am),ab.destroy()}}var ag="string"==typeof aa,af=ag?aa.length:aa.byteLength,ac=Math.min(jw,af),ak=Math.ceil(af/ac),ah=0,ab=ag?new jy:new jy.ArrayBuffer,t=ag?jf:a8;ad()});fz(fW,jv.EventEmitter),fW.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},fW.prototype.ready=function(aa,ac){function ad(){t.cancel()}function ab(){aa.removeListener("destroyed",ad),ac.removeListener("destroyed",ad)}var t=this;t._readyCalled||(t._readyCalled=!0,aa.once("destroyed",ad),ac.once("destroyed",ad),t.once("complete",ab))};var gf={replicate:m,toPouch:v},iD=gf.replicate;fz(hj,jv.EventEmitter),hj.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var gB=25,i6=50,iz={},gi=1800,iZ=ix("pouchdb:http");jx.valid=function(){return !0},es.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},es.prototype.finish=function(){return this.promise};var gN,ee=function(aa,t){return t&&aa.then(function(ab){fc.nextTick(function(){t(null,ab)})},function(ab){fc.nextTick(function(){t(ab)})}),aa},S=function(t){return ji(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&ee(ab,aa),ab})},hS=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},hH=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},fa=function(aa){for(var ac={},ad=0,ab=aa.length;ab>ad;ad++){ac["$"+aa[ad]]=!0}var t=Object.keys(ac),af=new Array(t.length);for(ad=0,ab=t.length;ab>ad;ad++){af[ad]=t[ad].substring(1)}return af},ik={uniq:fa,sequentialize:hH,fin:hS,callbackify:S,promisedCallback:ee},ip=gn.collate,gs=gn.toIndexableString,hi=gn.normalizeKey,gx=gn.parseIndexableString;gN="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var fp=ik.callbackify,g=ik.sequentialize,h2=ik.uniq,at=ik.fin,iA=ik.promisedCallback,gZ={},h8=new es,gr=50,L={_sum:function(aa,t){return gl(t)},_count:function(aa,t){return t.length},_stats:function(t,aa){function ab(ac){for(var af=0,ag=0,ad=ac.length;ad>ag;ag++){var ah=ac[ag];af+=ah*ah}return af}return{sum:gl(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},hF=fp(function(){var t=this;return t._ddocCache&&delete t._ddocCache,"http"===t.type()?N(t):"function"==typeof t._viewCleanup?id(t):gO(t)}),jd=function(aa,ac,ad){"function"==typeof ac&&(ad=ac,ac={}),ac=ac?g1(ac):{},"function"==typeof aa&&(aa={map:aa});var ab=this,t=a9.resolve().then(function(){return iv(ab,aa,ac)});return iA(t,ad),t};fz(ge,Error),fz(hb,Error);var hv={query:jd,viewCleanup:hF},gu=5,F="document-store",iW="by-sequence",hJ="attach-store",hs="attach-seq-store",hV="meta-store",fx="local-store",i5="detect-blob-support",i0={running:!1,queue:[]};fz(ia,jv.EventEmitter),ia.prototype.addListener=function(aa,af,ad,ab){function t(){function aj(){ac=!1}if(ag._listeners[af]){if(ac){return void (ac="waiting")}ac=!0;var ah=hE(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ad.changes(ah).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===ac&&setTimeout(function(){t()},0),ac=!1}).on("error",aj)}}if(!this._listeners[af]){var ag=this,ac=!1;this._listeners[af]=t,this.on(aa,t)}},ia.prototype.removeListener=function(aa,t){t in this._listeners&&jv.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},ia.prototype.notifyLocalWindows=function(t){ey()?chrome.storage.local.set({dbName:t}):bn()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ia.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var fS,dr=new gz.Map,hc=new ia,hh=new gz.Map;hr.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var iM=7,eo=gX("document-store"),hX=gX("by-sequence"),hk=gX("attach-store"),gg=gX("local-store"),gQ=gX("metadata-store"),H=gX("attach-seq-store"),hx=new gz.Map,jr=new ia,gK=1,hR="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+hX+" (seq, deleted)",fv="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+hX+" (doc_id, rev)",gw="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+eo+" (winningseq)",g2="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+H+" (seq)",hP="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+H+" (digest, seq)",ij=hX+".seq = "+eo+".winningseq",cr=hX+".seq AS seq, "+hX+".deleted AS deleted, "+hX+".json AS data, "+hX+".rev AS rev, "+eo+".json AS metadata";fu.use_prefix=!("undefined"!=typeof fc&&!fc.browser),fu.valid=hC;var jl={idb:hr,websql:fu};iS.ajax=br,iS.utils=hO,iS.Errors=gP,iS.replicate=gf.replicate,iS.sync=jA,iS.version="5.3.2",iS.adapter("http",jx),iS.adapter("https",jx),iS.plugin(hv),Object.keys(jl).forEach(function(t){iS.adapter(t,jl[t],!0)}),a.exports=iS}).call(this,e(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});