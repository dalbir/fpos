!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(f,h,c){function d(i,l){if(!h[i]){if(!f[i]){var k="function"==typeof require&&require;if(!l&&k){return k(i,!0)}if(j){return j(i,!0)}var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var m=h[i]={exports:{}};f[i][0].call(m.exports,function(n){var o=f[i][1][n];return d(o?o:n)},m,m.exports,a,f,h,c)}return h[i].exports}for(var j="function"==typeof require&&require,g=0;g<c.length;g++){d(c[g])}return d}({1:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],2:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var p="color: "+this.color;n=[n[0],p,"color: inherit"].concat(Array.prototype.slice.call(n,1));var i=0,o=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(i++,"%c"===q&&(o=i))}),n.splice(o,0,p),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(3),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{3:3}],3:[function(c,j,p){function l(){return p.colors[v++%p.colors.length]}function m(f){function n(){}function e(){var u=e,o=+new Date,x=o-(d||o);u.diff=x,u.prev=d,u.curr=o,d=o,null==u.useColors&&(u.useColors=p.useColors()),null==u.color&&u.useColors&&(u.color=l());var s=Array.prototype.slice.call(arguments);s[0]=p.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var r=0;s[0]=s[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}r++;var w=p.formatters[B];if("function"==typeof w){var C=s[r];D=w.call(u,C),s.splice(r,1),r--}return D}),"function"==typeof p.formatArgs&&(s=p.formatArgs.apply(u,s));var t=e.log||p.log||console.log.bind(console);t.apply(u,s)}n.enabled=!1,e.enabled=!0;var i=p.enabled(f)?e:n;return i.namespace=f,i}function q(e){p.save(e);for(var f=(e||"").split(/[\s,]+/),n=f.length,i=0;n>i;i++){f[i]&&(e=f[i].replace(/\*/g,".*?"),"-"===e[0]?p.skips.push(new RegExp("^"+e.substr(1)+"$")):p.names.push(new RegExp("^"+e+"$")))}}function g(){p.enable("")}function k(i){var e,f;for(e=0,f=p.skips.length;f>e;e++){if(p.skips[e].test(i)){return !1}}for(e=0,f=p.names.length;f>e;e++){if(p.names[e].test(i)){return !0}}return !1}function h(e){return e instanceof Error?e.stack||e.message:e}p=j.exports=m,p.coerce=h,p.disable=g,p.enable=q,p.enabled=k,p.humanize=c(9),p.names=[],p.skips=[],p.formatters={};var d,v=0},{9:9}],4:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function c(e){return"number"==typeof e}function g(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!c(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,n,o,q,e,m;if(this._events||(this._events={}),"error"===p&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[p],h(n)){return !1}if(k(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:q=Array.prototype.slice.call(arguments,1),n.apply(this,q)}}else{if(g(n)){for(q=Array.prototype.slice.call(arguments,1),m=n.slice(),o=m.length,e=0;o>e;e++){m[e].apply(this,q)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?g(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,g(this._events[m])&&!this._events[m].warned&&(e=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(i,n){function m(){this.removeListener(i,m),e||(e=!0,n.apply(this,arguments))}if(!k(n)){throw TypeError("listener must be a function")}var e=!1;return m.listener=n,this.on(i,m),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(g(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],5:[function(f,d,c){(function(h){function v(){g=!0;for(var i,n,l=w.length;l;){for(n=w,w=[],i=-1;++i<l;){n[i]()}l=w.length}g=!1}function p(i){1!==w.push(i)||g||q()}var q,e=h.MutationObserver||h.WebKitMutationObserver;if(e){var j=0,m=new e(v),k=h.document.createTextNode("");m.observe(k,{characterData:!0}),q=function(){k.data=j=++j%2}}else{if(h.setImmediate||"undefined"==typeof h.MessageChannel){q="document" in h&&"onreadystatechange" in h.document.createElement("script")?function(){var i=h.document.createElement("script");i.onreadystatechange=function(){v(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},h.document.documentElement.appendChild(i)}:function(){setTimeout(v,0)}}else{var t=new h.MessageChannel;t.port1.onmessage=v,q=function(){t.port2.postMessage(0)}}}var g,w=[];d.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(f,d,c){"function"==typeof Object.create?d.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:d.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],7:[function(f,d,c){(function(e){e("object"==typeof c?c:this)}).call(this,function(h){var e=Array.prototype.slice,i=Array.prototype.forEach,g=function(j){if("object"!=typeof j){throw j+" is not an object"}var k=e.call(arguments,1);return i.call(k,function(m){if(m){for(var l in m){"object"==typeof m[l]&&j[l]?g.call(j,j[l],m[l]):j[l]=m[l]}}}),j};h.extend=g})},{}],8:[function(B,k,G){function A(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=F,this.queue=[],this.outcome=void 0,e!==A&&g(this,e)}function J(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function H(f,e,h){D(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function z(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(h,l){function f(o){e||(e=!0,d.reject(h,o))}function m(o){e||(e=!0,d.resolve(h,o))}function i(){l(m,f)}var e=!1,n=E(i);"error"===n.status&&f(n.value)}function E(e,h){var f={};try{f.value=e(h),f.status="success"}catch(i){f.status="error",f.value=i}return f}function q(e){return e instanceof this?e:d.resolve(new this(A),e)}function w(f){var e=new this(A);return d.reject(e,f)}function C(i){function o(r,s){function t(u){f[s]=u,++l!==p||h||(h=!0,d.resolve(m,f))}e.resolve(r).then(t,function(u){h||(h=!0,d.reject(m,u))})}var e=this;if("[object Array]"!==Object.prototype.toString.call(i)){return this.reject(new TypeError("must be an array"))}var p=i.length,h=!1;if(!p){return this.resolve([])}for(var f=new Array(p),l=0,n=-1,m=new this(A);++n<p;){o(i[n],n)}return m}function x(h){function l(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(m,p))},function(p){e||(e=!0,d.reject(m,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var i=h.length,e=!1;if(!i){return this.resolve([])}for(var n=-1,m=new this(A);++n<i;){l(h[n])}return m}var D=B(5),d={},c=["REJECTED"],I=["FULFILLED"],F=["PENDING"];k.exports=G=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(i,h){if("function"!=typeof i&&this.state===I||"function"!=typeof h&&this.state===c){return this}var f=new this.constructor(A);if(this.state!==F){var e=this.state===I?i:h;H(f,e,this.outcome)}else{this.queue.push(new J(f,i,h))}return f},J.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},J.prototype.otherCallFulfilled=function(e){H(this.promise,this.onFulfilled,e)},J.prototype.callRejected=function(e){d.reject(this.promise,e)},J.prototype.otherCallRejected=function(e){H(this.promise,this.onRejected,e)},d.resolve=function(m,f){var i=E(z,f);if("error"===i.status){return d.reject(m,i.value)}var l=i.value;if(l){g(m,l)}else{m.state=I,m.outcome=f;for(var h=-1,e=m.queue.length;++h<e;){m.queue[h].callFulfilled(f)}}return m},d.reject=function(e,h){e.state=c,e.outcome=h;for(var f=-1,i=e.queue.length;++f<i;){e.queue[f].callRejected(h)}return e},G.resolve=q,G.reject=w,G.all=C,G.race=x},{5:5}],9:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],10:[function(j,d,m){function y(e){if(null!==e){switch(typeof e){case"boolean":return e?1:0;case"number":return z(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var l=Array.isArray(e),f=l?e:Object.keys(e),o=-1,i=f.length,n="";if(l){for(;++o<i;){n+=m.toIndexableString(f[o])}}else{for(;++o<i;){var h=f[o];n+=m.toIndexableString(h)+m.toIndexableString(e[h])}}return n}}return""}function c(h,o){var e,r=o,s="1"===h[o];if(s){e=0,o++}else{var f="0"===h[o];o++;var l="",p=h.substring(o,o+g),n=parseInt(p,10)+B;for(f&&(n=-n),o+=g;;){var i=h[o];if("\x00"===i){break}l+=i,o++}l=l.split("."),e=1===l.length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),f&&(e-=10),0!==n&&(e=parseFloat(e+"e"+n))}return{num:e,length:o-r}}function v(f,o){var l=f.pop();if(o.length){var n=o[o.length-1];l===n.element&&(o.pop(),n=o[o.length-1]);var i=n.element,e=n.index;if(Array.isArray(i)){i.push(l)}else{if(e===f.length-2){var h=f.pop();i[h]=l}else{f.push(l)}}}}function C(l,h){for(var i=Math.min(l.length,h.length),e=0;i>e;e++){var f=m.collate(l[e],h[e]);if(0!==f){return f}}return l.length===h.length?0:l.length>h.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(e,l){for(var f=Object.keys(e),o=Object.keys(l),i=Math.min(f.length,o.length),n=0;i>n;n++){var h=m.collate(f[n],o[n]);if(0!==h){return h}if(h=m.collate(e[f[n]],l[o[n]]),0!==h){return h}}return f.length===o.length?0:f.length>o.length?1:-1}function q(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function z(n){if(0===n){return"1"}var r=n.toExponential().split(/e\+?/),i=parseInt(r[1],10),f=0>n,h=f?"0":"2",l=(f?-i:i)-B,o=k.padLeft(l.toString(),"0",g);h+=w+o;var e=Math.abs(parseFloat(r[0]));f&&(e=10-e);var p=e.toFixed(20);return p=p.replace(/\.?0+$/,""),h+=w+p}var B=-324,g=3,w="",k=j(11);m.collate=function(h,e){if(h===e){return 0}h=m.normalizeKey(h),e=m.normalizeKey(e);var f=q(h),i=q(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},m.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var e=0;i>e;e++){l[e]=m.normalizeKey(h[e])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var n in h){if(h.hasOwnProperty(n)){var f=h[n];"undefined"!=typeof f&&(l[n]=m.normalizeKey(f))}}}}}return l},m.toIndexableString=function(f){var e="\x00";return f=m.normalizeKey(f),q(f)+w+y(f)+e},m.parseIndexableString=function(h){for(var o=[],s=[],r=0;;){var l=h[r++];if("\x00"!==l){switch(l){case"1":o.push(null);break;case"2":o.push("1"===h[r]),r++;break;case"3":var p=c(h,r);o.push(p.num),r+=p.length;break;case"4":for(var n="";;){var i=h[r];if("\x00"===i){break}n+=i,r++}n=n.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),o.push(n);break;case"5":var f={element:[],index:o.length};o.push(f.element),s.push(f);break;case"6":var e={element:{},index:o.length};o.push(e.element),s.push(e);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+l)}}else{if(1===o.length){return o.pop()}v(o,s)}}}},{11:11}],11:[function(f,c,g){function d(i,e,k){for(var h="",j=k-i.length;h.length<j;){h+=e}return h}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var h,m=j.length,l=p.length;for(h=0;m>h;h++){if(h===l){return 1}var e=j.charAt(h),k=p.charAt(h);if(e!==k){return k>e?-1:1}}return l>m?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],12:[function(c,g,f){function h(){this.store={}}function d(i){if(this.store=new h,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}f.Map=h,f.Set=d,h.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},h.prototype.unmangle=function(e){return e.substring(1)},h.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},h.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},h.prototype.has=function(i){var e=this.mangle(i);return e in this.store},h.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},h.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},d.prototype.add=function(e){return this.store.set(e,!0)},d.prototype.has=function(e){return this.store.has(e)},d.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],13:[function(p,x,h){function d(){m=!1,c.length?q=c.concat(q):j=-1,q.length&&g()}function g(){if(!m){var f=setTimeout(d);m=!0;for(var e=q.length;e;){for(c=q,q=[];++j<e;){c&&c[j].run()}j=-1,e=q.length}c=null,m=!1,clearTimeout(f)}}function k(f,e){this.fun=f,this.array=e}function v(){}var c,w=x.exports={},q=[],m=!1,j=-1;w.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i]}}q.push(new k(f,e)),1!==q.length||m||setTimeout(g,0)},k.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=v,w.addListener=v,w.once=v,w.off=v,w.removeListener=v,w.removeAllListeners=v,w.emit=v,w.binding=function(e){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(e){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],14:[function(f,d,c){(function(){var e={}.hasOwnProperty,g=[].slice;d.exports=function(j,i){var m,l,k,h;l=[],h=[];for(m in i){e.call(i,m)&&(k=i[m],"this"!==m&&(l.push(m),h.push(k)))}return Function.apply(null,g.call(l).concat([j])).apply(i["this"],h)}}).call(this)},{}],15:[function(d,c,e){!function(g){if("object"==typeof e){c.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(F){function B(m,h,n,l,i,g){return h=K(K(h,m),K(l,g)),K(h<<i|h>>>32-i,n)}function w(m,h,l,i,n,o,g){return B(h&l|~h&i,m,h,n,o,g)}function H(m,h,l,i,n,o,g){return B(h&i|l&~i,m,h,n,o,g)}function D(m,h,l,i,n,o,g){return B(h^l^i,m,h,n,o,g)}function q(m,h,l,i,n,o,g){return B(l^(h|~i),m,h,n,o,g)}function M(m,h){var n=m[0],l=m[1],g=m[2],i=m[3];n=w(n,l,g,i,h[0],7,-680876936),i=w(i,n,l,g,h[1],12,-389564586),g=w(g,i,n,l,h[2],17,606105819),l=w(l,g,i,n,h[3],22,-1044525330),n=w(n,l,g,i,h[4],7,-176418897),i=w(i,n,l,g,h[5],12,1200080426),g=w(g,i,n,l,h[6],17,-1473231341),l=w(l,g,i,n,h[7],22,-45705983),n=w(n,l,g,i,h[8],7,1770035416),i=w(i,n,l,g,h[9],12,-1958414417),g=w(g,i,n,l,h[10],17,-42063),l=w(l,g,i,n,h[11],22,-1990404162),n=w(n,l,g,i,h[12],7,1804603682),i=w(i,n,l,g,h[13],12,-40341101),g=w(g,i,n,l,h[14],17,-1502002290),l=w(l,g,i,n,h[15],22,1236535329),n=H(n,l,g,i,h[1],5,-165796510),i=H(i,n,l,g,h[6],9,-1069501632),g=H(g,i,n,l,h[11],14,643717713),l=H(l,g,i,n,h[0],20,-373897302),n=H(n,l,g,i,h[5],5,-701558691),i=H(i,n,l,g,h[10],9,38016083),g=H(g,i,n,l,h[15],14,-660478335),l=H(l,g,i,n,h[4],20,-405537848),n=H(n,l,g,i,h[9],5,568446438),i=H(i,n,l,g,h[14],9,-1019803690),g=H(g,i,n,l,h[3],14,-187363961),l=H(l,g,i,n,h[8],20,1163531501),n=H(n,l,g,i,h[13],5,-1444681467),i=H(i,n,l,g,h[2],9,-51403784),g=H(g,i,n,l,h[7],14,1735328473),l=H(l,g,i,n,h[12],20,-1926607734),n=D(n,l,g,i,h[5],4,-378558),i=D(i,n,l,g,h[8],11,-2022574463),g=D(g,i,n,l,h[11],16,1839030562),l=D(l,g,i,n,h[14],23,-35309556),n=D(n,l,g,i,h[1],4,-1530992060),i=D(i,n,l,g,h[4],11,1272893353),g=D(g,i,n,l,h[7],16,-155497632),l=D(l,g,i,n,h[10],23,-1094730640),n=D(n,l,g,i,h[13],4,681279174),i=D(i,n,l,g,h[0],11,-358537222),g=D(g,i,n,l,h[3],16,-722521979),l=D(l,g,i,n,h[6],23,76029189),n=D(n,l,g,i,h[9],4,-640364487),i=D(i,n,l,g,h[12],11,-421815835),g=D(g,i,n,l,h[15],16,530742520),l=D(l,g,i,n,h[2],23,-995338651),n=q(n,l,g,i,h[0],6,-198630844),i=q(i,n,l,g,h[7],10,1126891415),g=q(g,i,n,l,h[14],15,-1416354905),l=q(l,g,i,n,h[5],21,-57434055),n=q(n,l,g,i,h[12],6,1700485571),i=q(i,n,l,g,h[3],10,-1894986606),g=q(g,i,n,l,h[10],15,-1051523),l=q(l,g,i,n,h[1],21,-2054922799),n=q(n,l,g,i,h[8],6,1873313359),i=q(i,n,l,g,h[15],10,-30611744),g=q(g,i,n,l,h[6],15,-1560198380),l=q(l,g,i,n,h[13],21,1309151649),n=q(n,l,g,i,h[4],6,-145523070),i=q(i,n,l,g,h[11],10,-1120210379),g=q(g,i,n,l,h[2],15,718787259),l=q(l,g,i,n,h[9],21,-343485551),m[0]=K(n,m[0]),m[1]=K(l,m[1]),m[2]=K(g,m[2]),m[3]=K(i,m[3])}function C(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i.charCodeAt(h)+(i.charCodeAt(h+1)<<8)+(i.charCodeAt(h+2)<<16)+(i.charCodeAt(h+3)<<24)}return g}function G(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i[h]+(i[h+1]<<8)+(i[h+2]<<16)+(i[h+3]<<24)}return g}function A(g){var m,i,h,n,p,o,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;l>=m;m+=64){M(r,C(g.substring(m-64,m)))}for(g=g.substring(m-64),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;i>m;m+=1){h[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(h[m>>2]|=128<<(m%4<<3),m>55){for(M(r,h),m=0;16>m;m+=1){h[m]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),o=parseInt(n[1],16)||0,h[14]=p,h[15]=o,M(r,h),r}function E(g){var o,i,h,n,p,m,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(o=64;l>=o;o+=64){M(r,G(g.subarray(o-64,o)))}for(g=l>o-64?g.subarray(o-64):new Uint8Array(0),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;i>o;o+=1){h[o>>2]|=g[o]<<(o%4<<3)}if(h[o>>2]|=128<<(o%4<<3),o>55){for(M(r,h),o=0;16>o;o+=1){h[o]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,h[14]=p,h[15]=m,M(r,h),r}function x(i){var h,g="";for(h=0;4>h;h+=1){g+=L[i>>8*h+4&15]+L[i>>8*h&15]}return g}function I(h){var g;for(g=0;g<h.length;g+=1){h[g]=x(h[g])}return h.join("")}function z(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(m,h){var n,l=m.length,i=new ArrayBuffer(l),g=new Uint8Array(i);for(n=0;l>n;n+=1){g[n]=m.charCodeAt(n)}return h?g:i}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(l,g,h){var i=new Uint8Array(l.byteLength+g.byteLength);return i.set(new Uint8Array(l)),i.set(new Uint8Array(g),l.byteLength),h?i:i.buffer}function N(l){var g,h=[],i=l.length;for(g=0;i-1>g;g+=2){h.push(parseInt(l.substr(g,2),16))}return String.fromCharCode.apply(String,h)}function J(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==I(A("hello"))&&(K=function(l,g){var h=(65535&l)+(65535&g),i=(l>>16)+(g>>16)+(h>>16);return i<<16|65535&h}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(p,h){var i,n,s,o,r=this.byteLength,l=g(p,r),m=r;return h!==F&&(m=g(h,r)),l>m?new ArrayBuffer(0):(i=m-l,n=new ArrayBuffer(i),s=new Uint8Array(n),o=new Uint8Array(this,l,i),s.set(o),n)}}(),J.prototype.append=function(g){return this.appendBinary(z(g)),this},J.prototype.appendBinary=function(i){this._buff+=i,this._length+=i.length;var h,g=this._buff.length;for(h=64;g>=h;h+=64){M(this._hash,C(this._buff.substring(h-64,h)))}return this._buff=this._buff.substring(h-64),this},J.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l.charCodeAt(h)<<(h%4<<3)}return this._finish(g,i),n=I(this._hash),m&&(n=N(n)),this.reset(),n},J.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},J.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},J.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},J.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},J.prototype._finish=function(m,h){var n,l,i,g=h;if(m[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,m),g=0;16>g;g+=1){m[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(n[2],16),i=parseInt(n[1],16)||0,m[14]=l,m[15]=i,M(this._hash,m)},J.hash=function(h,g){return J.hashBinary(z(h),g)},J.hashBinary=function(l,g){var h=A(l),i=I(h);return g?N(i):i},J.ArrayBuffer=function(){this.reset()},J.ArrayBuffer.prototype.append=function(l){var g,h=f(this._buff.buffer,l,!0),i=h.length;for(this._length+=l.byteLength,g=64;i>=g;g+=64){M(this._hash,G(h.subarray(g-64,g)))}return this._buff=i>g-64?new Uint8Array(h.buffer.slice(g-64)):new Uint8Array(0),this},J.ArrayBuffer.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l[h]<<(h%4<<3)}return this._finish(g,i),n=I(this._hash),m&&(n=N(n)),this.reset(),n},J.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},J.ArrayBuffer.prototype.getState=function(){var g=J.prototype.getState.call(this);return g.buff=j(g.buff),g},J.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),J.prototype.setState.call(this,g)},J.ArrayBuffer.prototype.destroy=J.prototype.destroy,J.ArrayBuffer.prototype._finish=J.prototype._finish,J.ArrayBuffer.hash=function(l,g){var h=E(new Uint8Array(l)),i=I(h);return g?N(i):i},J})},{}],16:[function(f,c,g){function d(j,p,h){var m=h[h.length-1];j===m.element&&(h.pop(),m=h[h.length-1]);var l=m.element,e=m.index;if(Array.isArray(l)){l.push(j)}else{if(e===p.length-2){var k=p.pop();l[k]=j}else{p.push(j)}}}g.stringify=function(w){var v=[];v.push({obj:w});for(var p,z,x,m,q,B,h,e,A,k,j,y="";p=v.pop();){if(z=p.obj,x=p.prefix||"",m=p.val||"",y+=x,m){y+=m}else{if("object"!=typeof z){y+="undefined"==typeof z?null:JSON.stringify(z)}else{if(null===z){y+="null"}else{if(Array.isArray(z)){for(v.push({val:"]"}),q=z.length-1;q>=0;q--){B=0===q?"":",",v.push({obj:z[q],prefix:B})}v.push({val:"["})}else{h=[];for(e in z){z.hasOwnProperty(e)&&h.push(e)}for(v.push({val:"}"}),q=h.length-1;q>=0;q--){A=h[q],k=z[A],j=q>0?",":"",j+=JSON.stringify(A)+":",v.push({obj:k,prefix:j})}v.push({val:"{"})}}}}}return y},g.parse=function(k){for(var z,v,q,e,y,x,m,w,r,j=[],h=[],p=0;;){if(z=k[p++],"}"!==z&&"]"!==z&&"undefined"!=typeof z){switch(z){case" ":case"	":case"\n":case":":case",":break;case"n":p+=3,d(null,j,h);break;case"t":p+=3,d(!0,j,h);break;case"f":p+=4,d(!1,j,h);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(v="",p--;;){if(q=k[p++],!/[\d\.\-e\+]/.test(q)){p--;break}v+=q}d(parseFloat(v),j,h);break;case'"':for(e="",y=void 0,x=0;;){if(m=k[p++],'"'===m&&("\\"!==y||x%2!==1)){break}e+=m,y=m,"\\"===y?x++:x=0}d(JSON.parse('"'+e+'"'),j,h);break;case"[":w={element:[],index:j.length},j.push(w.element),h.push(w);break;case"{":r={element:{},index:j.length},j.push(r.element),h.push(r);break;default:throw new Error("unexpectedly reached end of input: "+z)}}else{if(1===j.length){return j.pop()}d(j.pop(),j,h)}}}},{}],17:[function(f,d,c){(function(cI,c0){function di(i,l){i=i||[],l=l||{};try{return new Blob(i,l)}catch(k){if("TypeError"!==k.name){throw k}for(var h="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,j=new h,g=0;g<i.length;g+=1){j.append(i[g])}return j.getBlob(l.type)}}function c6(g,i){if("undefined"==typeof FileReader){return i((new FileReaderSync).readAsArrayBuffer(g))}var h=new FileReader;h.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);i(k)},h.readAsArrayBuffer(g)}function bl(){for(var g={},i=new eD(function(k,l){g.resolve=k,g.reject=l}),h=new Array(arguments.length),j=0;j<h.length;j++){h[j]=arguments[j]}return g.promise=i,eD.resolve().then(function(){return fetch.apply(null,h)}).then(function(k){g.resolve(k)})["catch"](function(k){g.reject(k)}),g}function b0(j,h){var l,i,k,m=new Headers,g={method:j.method,credentials:"include",headers:m};return j.json&&(m.set("Accept","application/json"),m.set("Content-Type",j.headers["Content-Type"]||"application/json")),j.body&&j.body instanceof Blob?c6(j.body,function(n){g.body=n}):j.body&&j.processData&&"string"!=typeof j.body?g.body=JSON.stringify(j.body):"body" in j?g.body=j.body:g.body=null,Object.keys(j.headers).forEach(function(n){j.headers.hasOwnProperty(n)&&m.set(n,j.headers[n])}),l=bl(j.url,g),j.timeout>0&&(i=setTimeout(function(){l.reject(new Error("Load timeout for resource: "+j.url))},j.timeout)),l.promise.then(function(n){return k={statusCode:n.status},j.timeout>0&&clearTimeout(i),k.statusCode>=200&&k.statusCode<300?j.binary?n.blob():n.text():n.json()}).then(function(n){k.statusCode>=200&&k.statusCode<300?h(null,k,n):h(n,k)})["catch"](function(n){h(n,k)}),{abort:l.reject}}function cT(k,m){var l,j,g=function(){l.abort()};l=k.xhr?new k.xhr:new XMLHttpRequest;try{l.open(k.method,k.url)}catch(i){m(i,{statusCode:413})}l.withCredentials="withCredentials" in k?k.withCredentials:!0,"GET"===k.method?delete k.headers["Content-Type"]:k.json&&(k.headers.Accept="application/json",k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json",k.body&&k.processData&&"string"!=typeof k.body&&(k.body=JSON.stringify(k.body))),k.binary&&(l.responseType="arraybuffer"),"body" in k||(k.body=null);for(var h in k.headers){k.headers.hasOwnProperty(h)&&l.setRequestHeader(h,k.headers[h])}return k.timeout>0&&(j=setTimeout(g,k.timeout),l.onprogress=function(){clearTimeout(j),j=setTimeout(g,k.timeout)},"undefined"!=typeof l.upload&&(l.upload.onprogress=l.onprogress)),l.onreadystatechange=function(){if(4===l.readyState){var o={statusCode:l.status};if(l.status>=200&&l.status<300){var q;q=k.binary?di([l.response||""],{type:l.getResponseHeader("Content-Type")}):l.responseText,m(null,o,q)}else{var p={};try{p=JSON.parse(l.response)}catch(n){}m(p,o)}}},k.body&&k.body instanceof Blob?c6(k.body,function(n){l.send(n)}):l.send(k.body),{abort:g}}function jG(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function eg(h,g){return eE||h.xhr?cT(h,g):b0(h,g)}function ba(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function eP(g,i,h){function j(k){for(var l in g){"function"!=typeof g[l]&&(this[l]=g[l])}void 0!==h&&(this.name=h),void 0!==k&&(this.reason=k)}return j.prototype=ba.prototype,new j(i)}function ea(i){var l,k,h,j,g;return k=i.error===!0&&"string"==typeof i.name?i.name:i.error,g=i.reason,h=cz("name",k,g),i.missing||"missing"===g||"deleted"===g||"not_found"===k?h=bZ:"doc_validation"===k?(h=cH,j=g):"bad_request"===k&&h.message!==g&&(h=fL),h||(h=cz("status",i.status,g)||dM),l=eP(h,g,k),j&&(l.message=j),i.id&&(l.id=i.id),i.status&&(l.status=i.status),i.missing&&(l.missing=i.missing),l}function eY(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function dF(g){if("function"==typeof g.slice){return g.slice(0)}var i=new ArrayBuffer(g.byteLength),h=new Uint8Array(i),j=new Uint8Array(g);return h.set(j),i}function eU(g){if(g instanceof ArrayBuffer){return dF(g)}var i=g.size,h=g.type;return"function"==typeof g.slice?g.slice(0,i,h):g.webkitSlice(0,i,h)}function aO(h){var k,j,g;if(!h||"object"!=typeof h){return h}if(Array.isArray(h)){for(k=[],j=0,g=h.length;g>j;j++){k[j]=aO(h[j])}return k}if(h instanceof Date){return h.toISOString()}if(eY(h)){return eU(h)}k={};for(j in h){if(Object.prototype.hasOwnProperty.call(h,j)){var i=aO(h[j]);"undefined"!=typeof i&&(k[j]=i)}}return k}function dR(){return""}function bP(h,k){function j(n,m,o){if(!h.binary&&h.json&&"string"==typeof n){try{n=JSON.parse(n)}catch(l){return o(l)}}Array.isArray(n)&&(n=n.map(function(p){return p.error||p.missing?ea(p):p})),h.binary&&aS(n,m),o(null,n,m)}function g(q,o){var m,p;if(q.code&&q.status){var l=new Error(q.message||q.code);return l.status=q.status,o(l)}try{m=JSON.parse(q.responseText),p=ea(m)}catch(n){p=ea(q)}o(p)}h=aO(h);var i={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return h=ca.extend(i,h),h.json&&(h.binary||(h.headers.Accept="application/json"),h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json"),h.binary&&(h.encoding=null,h.json=!1),h.processData||(h.json=!1),eg(h,function(q,n,l){if(q){return q.status=n?n.statusCode:400,g(q,k)}var o,m=n.headers&&n.headers["content-type"],r=l||dR();if(!h.binary&&(h.json||!h.processData)&&"object"!=typeof r&&(/json/.test(m)||/^[\s]*\{/.test(r)&&/\}[\s]*$/.test(r))){try{r=JSON.parse(r.toString())}catch(p){}}n.statusCode>=200&&n.statusCode<300?j(r,n,k):(o=ea(r),o.status=n.statusCode,k(o))})}function ch(i,k){var l=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m=-1!==l.indexOf("safari")&&-1===l.indexOf("chrome"),j=-1!==l.indexOf("msie"),g=m&&"POST"===i.method||j&&"GET"===i.method,n="cache" in i?i.cache:!0;if(g||!n){var h=-1!==i.url.indexOf("?");i.url+=(h?"&":"?")+"_nonce="+Date.now()}return bP(i,k)}function jn(h){var g=!1;return j1(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function fD(g){return j1(function(j){j=aO(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){cI.nextTick(function(){i(n,m)})});var h=new eD(function(q,p){var n;try{var m=jn(function(r,s){r?p(r):q(s)});j.push(m),n=g.apply(l,j),n&&"function"==typeof n.then&&q(n)}catch(o){p(o)}});return k&&h.then(function(m){k(null,m)},k),h})}function d6(g,i){function h(o,m,k){if(jx.enabled){for(var n=[o._db_name,m],j=0;j<k.length-1;j++){n.push(k[j])}jx.apply(null,n);var l=k[k.length-1];k[k.length-1]=function(r,p){var q=[o._db_name,m];q=q.concat(r?["error",r]:["success",p]),jx.apply(null,q),l(r,p)}}}return fD(j1(function(j){if(this._closed){return eD.reject(new Error("database is closed"))}var k=this;return h(k,g,j),this.taskqueue.isReady?i.apply(this,j):new eD(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[g].apply(k,j))})})}))}function jm(i,l){for(var k={},h=0,j=l.length;j>h;h++){var g=l[h];g in i&&(k[g]=i[g])}return k}function e(g,i,h){return new eD(function(j,k){g.get(i,function(l,n){if(l){if(404!==l.status){return k(l)}n={}}var m=n._rev,o=h(n);return o?(o._id=i,o._rev=m,void j(jI(g,o,h))):j({updated:!1,rev:m})})})}function jI(g,i,h){return g.put(i).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return e(g,i._id,h)})}function jD(r){for(var n,q,o,p,g=r.rev_tree.slice();p=g.pop();){var l=p.ids,h=l[2],m=p.pos;if(h.length){for(var k=0,i=h.length;i>k;k++){g.push({pos:m+1,ids:h[k]})}}else{var s=!!l[1].deleted,j=l[0];(!n||(o!==s?o:q!==m?m>q:j>n))&&(n=j,q=m,o=s)}}return q+"-"+n}function bj(g){return g.ids}function cW(h,k){k||(k=jD(h));for(var j,g=k.substring(k.indexOf("-")+1),i=h.rev_tree.map(bj);j=i.pop();){if(j[0]===g){return !!j[1].deleted}i=i.concat(j[2])}}function cG(g){return cC("return "+g+";",{})}function al(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jo(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function jR(h){var g=jo(h);return g?g.join("/"):null}function jz(k,m){for(var i,g=k.slice();i=g.pop();){for(var h=i.pos,j=i.ids,l=j[2],o=m(0===l.length,h,j[0],i.ctx,j[1]),p=0,n=l.length;n>p;p++){g.push({pos:h+1,ids:l[p],ctx:o})}}}function ef(h,g){return h.pos-g.pos}function dY(g){var i=[];jz(g,function(l,n,k,m,o){l&&i.push({rev:n+"-"+k,pos:n,opts:o})}),i.sort(ef).reverse();for(var h=0,j=i.length;j>h;h++){delete i[h].pos}return i}function jC(k){for(var i=jD(k),g=dY(k.rev_tree),j=[],l=0,m=g.length;m>l;l++){var h=g[l];h.rev===i||h.opts.deleted||j.push(h.rev)}return j}function jW(k,i,g){function j(){l.cancel()}bL.EventEmitter.call(this);var l=this;this.db=k,i=i?aO(i):{};var m=i.complete=jn(function(o,n){o?l.emit("error",o):l.emit("complete",n),l.removeAllListeners(),k.removeListener("destroyed",j)});g&&(l.on("complete",function(n){g(null,n)}),l.on("error",g)),k.once("destroyed",j),i.onChange=function(n){i.isCancelled||(l.emit("change",n),l.startSeq&&l.startSeq<=n.seq&&(l.startSeq=!1))};var h=new eD(function(o,n){i.complete=function(p,q){p?n(p):o(q)}});l.once("cancel",function(){k.removeListener("destroyed",j),i.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){m(null,n)},m),k.taskqueue.isReady?l.doChanges(i):k.taskqueue.addTask(function(){l.isCancelled?l.emit("cancel"):l.doChanges(i)})}function cE(h,k,j){var g=[{rev:h._rev}];"all_docs"===j.style&&(g=dY(k.rev_tree).map(function(l){return{rev:l.rev}}));var i={id:k.id,changes:g,doc:h};return cW(k,h._rev)&&(i.deleted=!0),j.conflicts&&(i.doc._conflicts=jC(k),i.doc._conflicts.length||delete i.doc._conflicts),i}function bk(i,m,h){function p(){var r=[];q.forEach(function(s){s.docs.forEach(function(u){r.push({id:s.id,docs:[u]})})}),h(null,{results:r})}function n(){++k===o&&p()}function g(r,u,s){q[r]={id:u,docs:s},n()}var j=Array.isArray(m)?m:m.docs,l={};j.forEach(function(r){r.id in l?l[r.id].push(r):l[r.id]=[r]});var o=Object.keys(l).length,k=0,q=new Array(o);Object.keys(l).forEach(function(s,u){var v=l[s],r=jm(v[0],["atts_since","attachments"]);r.open_revs=v.map(function(x){return x.rev}),r.open_revs=r.open_revs.filter(function(x){return x});var w=function(x){return x};0===r.open_revs.length&&(delete r.open_revs,w=function(x){return[{ok:x}]}),["revs","attachments","binary"].forEach(function(x){x in m&&(r[x]=m[x])}),i.get(s,r,function(x,y){g(u,s,x?[{error:x}]:w(y))})})}function c4(g){return/^_local/.test(g)}function jS(r){for(var n,q=[],o=r.slice();n=o.pop();){var p=n.pos,g=n.ids,l=g[0],h=g[1],m=g[2],k=0===m.length,i=n.history?n.history.slice():[];i.push({id:l,opts:h}),k&&q.push({pos:p+1-i.length,ids:i});for(var s=0,j=m.length;j>s;s++){o.push({pos:p+1,ids:m[s],history:i})}}return q.reverse()}function ds(g){return 0|Math.random()*g}function jr(g,i){i=i||ac.length;var h="",j=-1;if(g){for(;++j<g;){h+=ac[ds(i)]}return h}for(;++j<36;){switch(j){case 8:case 13:case 18:case 23:h+="-";break;case 19:h+=ac[3&ds(16)|8];break;default:h+=ac[ds(16)]}}return h}function jB(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function jU(h){var g;if(h?"string"!=typeof h?g=eP(fN):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=eP(ec)):g=eP(ab),g){throw g}}function bW(g){if(!/^\d+\-./.test(g)){return eP(cy)}var i=g.indexOf("-"),h=g.substring(0,i),j=g.substring(i+1);return{prefix:parseInt(h,10),id:j}}function jJ(k,i){for(var g=k.start-k.ids.length+1,j=k.ids,l=[j[0],i,[]],m=1,h=j.length;h>m;m++){l=[j[m],{status:"missing"},[l]]}return[{pos:g,ids:l}]}function bh(k,m){var i,g,h,j={status:"available"};if(k._deleted&&(j.deleted=!0),m){if(k._id||(k._id=jr()),g=jr(32,16).toLowerCase(),k._rev){if(h=bW(k._rev),h.error){return h}k._rev_tree=[{pos:h.prefix,ids:[h.id,{status:"missing"},[[g,j,[]]]]}],i=h.prefix+1}else{k._rev_tree=[{pos:1,ids:[g,j,[]]}],i=1}}else{if(k._revisions&&(k._rev_tree=jJ(k._revisions,j),i=k._revisions.start,g=k._revisions.ids[0]),!k._rev_tree){if(h=bW(k._rev),h.error){return h}i=h.prefix,g=h.id,k._rev_tree=[{pos:i,ids:[g,j,[]]}]}}jU(k._id),k._rev=i+"-"+g;var l={metadata:{},data:{}};for(var o in k){if(Object.prototype.hasOwnProperty.call(k,o)){var p="_"===o[0];if(p&&!eA[o]){var n=eP(cH,o);throw n.message=cH.message+": "+o,n}p&&!cN[o]?l.metadata[o.slice(1)]=k[o]:l.data[o]=k[o]}}return l}function eV(h,g){return g>h?-1:h>g?1:0}function dj(g,i){for(var h=0;h<g.length;h++){if(i(g[h],h)===!0){return g[h]}}}function cB(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function aL(i){for(var l=0;l<i.length;l++){var k=i[l];if(k._deleted){delete k._attachments}else{if(k._attachments){for(var h=Object.keys(k._attachments),j=0;j<h.length;j++){var g=h[j];k._attachments[g]=jm(k._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function d4(h,k){var j=eV(h._id,k._id);if(0!==j){return j}var g=h._revisions?h._revisions.start:0,i=k._revisions?k._revisions.start:0;return eV(g,i)}function e8(g){var i={},h=[];return jz(g,function(l,k,m,j){var n=k+"-"+m;return l&&(i[n]=0),void 0!==j&&h.push({from:j,to:n}),n}),h.reverse(),h.forEach(function(j){void 0===i[j.from]?i[j.from]=1+i[j.to]:i[j.from]=Math.min(i[j.from],1+i[j.to])}),i}function bT(h,k,j){var g="limit" in k?k.keys.slice(k.skip,k.limit+k.skip):k.skip>0?k.keys.slice(k.skip):k.keys;if(k.descending&&g.reverse(),!g.length){return h._allDocs({limit:0},j)}var i={offset:k.skip};return eD.all(g.map(function(m){var l=ca.extend({key:m,deleted:"ok"},k);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new eD(function(o,n){h._allDocs(l,function(q,p){return q?n(q):(i.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return i.rows=l,i})}function d0(g){var i=g._compactionQueue[0],j=i.opts,h=i.callback;g.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(j.last_seq=k.last_seq),g._compact(j,function(l,m){l?h(l):h(null,m),cI.nextTick(function(){g._compactionQueue.shift(),g._compactionQueue.length&&d0(g)})})})}function bw(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function eS(){bL.EventEmitter.call(this)}function jP(){this.isReady=!1,this.failed=!1,this.queue=[]}function aU(g){g&&c0.debug&&console.error(g)}function eh(k,i){function g(){m.emit("destroyed",l),m.emit(l,"destroyed")}function j(){k.removeListener("destroyed",g),k.emit("destroyed",k)}var l=i.originalName,m=k.constructor,h=m._destructionListeners;k.once("destroyed",g),h.has(l)||h.set(l,[]),h.get(l).push(j)}function aR(i,l,k){if(!(this instanceof aR)){return new aR(i,l,k)}var h=this;("function"==typeof l||"undefined"==typeof l)&&(k=l,l={}),i&&"object"==typeof i&&(l=i,i=void 0),"undefined"==typeof k&&(k=aU),i=i||l.name,l=aO(l),delete l.name,this.__opts=l;var j=k;h.auto_compaction=l.auto_compaction,h.prefix=aR.prefix,eS.call(h),h.taskqueue=new jP;var g=new eD(function(q,o){k=function(r,s){return r?o(r):(delete s.then,void q(s))},l=aO(l);var m,p,n=l.name||i;return function(){try{if("string"!=typeof n){throw p=new Error("Missing/invalid DB name"),p.code=400,p}if(m=aR.parseAdapter(n,l),l.originalName=n,l.name=m.name,l.prefix&&"http"!==m.adapter&&"https"!==m.adapter&&(l.name=l.prefix+l.name),l.adapter=l.adapter||m.adapter,h._adapter=l.adapter,bd("pouchdb:adapter")("Picked adapter: "+l.adapter),h._db_name=n,!aR.adapters[l.adapter]){throw p=new Error("Adapter is missing"),p.code=404,p}if(!aR.adapters[l.adapter].valid()){throw p=new Error("Invalid Adapter"),p.code=404,p}}catch(r){h.taskqueue.fail(r)}}(),p?o(p):(h.adapter=l.adapter,h.replicate={},h.replicate.from=function(r,u,s){return h.constructor.replicate(r,h,u,s)},h.replicate.to=function(r,u,s){return h.constructor.replicate(h,r,u,s)},h.sync=function(r,u,s){return h.constructor.sync(h,r,u,s)},h.replicate.sync=h.sync,void aR.adapters[l.adapter].call(h,l,function(r){return r?(h.taskqueue.fail(r),void k(r)):(eh(h,l),h.emit("created",h),aR.emit("created",l.originalName),h.taskqueue.ready(h),void k(null,h))}))});g.then(function(m){j(null,m)},j),h.then=g.then.bind(g),h["catch"]=g["catch"].bind(g)}function jF(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function aa(){return e9}function d9(h){Object.keys(bL.EventEmitter.prototype).forEach(function(i){"function"==typeof bL.EventEmitter.prototype[i]&&(h[i]=cu[i].bind(cu))});var g=h._destructionListeners=new ak.Map;h.on("destroyed",function(i){g.has(i)&&(g.get(i).forEach(function(j){j()}),g["delete"](i))})}function dH(h){for(var k=h.length,j=new ArrayBuffer(k),g=new Uint8Array(j),i=0;k>i;i++){g[i]=h.charCodeAt(i)}return j}function jE(h,g){return di([dH(h)],{type:g})}function dK(k){for(var i=a9.exec(k),g={},j=14;j--;){var l=bM[j],m=i[j]||"",h=-1!==["user","password"].indexOf(l);g[l]=h?decodeURIComponent(m):m}return g[eK]={},g[bM[12]].replace(ej,function(n,o,p){o&&(g[eK][o]=p)}),g}function b6(h,k,j){try{return !h(k,j)}catch(g){var i="Filter function threw: "+g.toString();return eP(fL,i)}}function jQ(g){var i={},h=g.filter&&"function"==typeof g.filter;return i.query=g.query_params,function(k){k.doc||(k.doc={});var l=h&&b6(g.filter,k.doc,i);if("object"==typeof l){return l}if(l){return !1}if(g.include_docs){if(!g.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function bI(h,g){"console" in c0&&"info" in console&&console.info("The above "+h+" is totally normal. "+g)}function dO(h,k,j,g,i){return h.get(k)["catch"](function(l){if(404===l.status){return"http"===h.type()&&bI(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:g,_id:k,history:[],replicator:av,version:bu}}throw l}).then(function(l){return i.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==g}),l.history.unshift({last_seq:j,session_id:g}),l.history=l.history.slice(0,bU),l.version=bu,l.replicator=av,l.session_id=g,l.last_seq=j,h.put(l)["catch"](function(m){if(409===m.status){return dO(h,k,j,g,i)}throw m}))})}function jV(g,i,h,j){this.src=g,this.target=i,this.id=h,this.returnValue=j}function dy(g,i){if(g.session_id===i.session_id){return{last_seq:g.last_seq,history:g.history||[]}}var h=g.history||[],j=i.history||[];return cj(h,j)}function cj(i,k){var l=i[0],m=i.slice(1),j=k[0],g=k.slice(1);if(!l||0===k.length){return{last_seq:dU,history:[]}}var n=l.session_id;if(dq(n,k)){return{last_seq:l.last_seq,history:i}}var h=j.session_id;return dq(h,m)?{last_seq:j.last_seq,history:g}:cj(m,g)}function dq(g,i){var h=i[0],j=i.slice(1);return g&&0!==i.length?g===h.session_id?!0:dq(g,j):!1}function jH(g,i){g=parseInt(g,10)||0,i=parseInt(i,10),i!==i||g>=i?i=(g||1)<<1:i+=1;var h=Math.random(),j=i-g;return ~~(j*h+g)}function bR(h){var g=0;return h||(g=2000),jH(h,g)}function bH(g,i,h,j){return g.retry===!1?(i.emit("error",h),void i.removeAllListeners()):("function"!=typeof g.back_off_function&&(g.back_off_function=bR),i.emit("requestError",h),("active"===i.state||"pending"===i.state)&&(i.emit("paused",h),i.state="stopped",i.once("active",function(){g.current_back_off=dg})),g.current_back_off=g.current_back_off||dg,g.current_back_off=g.back_off_function(g.current_back_off),void setTimeout(j,g.current_back_off))}function aY(g){return ax(g)}function d5(g,i,h,j){(h>0||j<i.byteLength)&&(i=new Uint8Array(i,h,Math.min(j,i.byteLength)-h)),g.append(i)}function cS(g,i,h,j){(h>0||j<i.length)&&(i=i.substring(h,j)),g.appendBinary(i)}function dc(g){return Object.keys(g).sort(dQ.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function aB(k,i,g){var j=g.doc_ids?g.doc_ids.sort(dQ.collate):"",l=g.filter?g.filter.toString():"",m="",h="";return g.filter&&g.query_params&&(m=JSON.stringify(dc(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),eD.all([k.id(),i.id()]).then(function(n){var o=n[0]+n[1]+l+h+m+j;return cD(o)}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function ek(g){return/^1-/.test(g)}function ci(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0,attachments:!0,binary:!0}}function aP(h,j,n){function m(){var p=ci(j);if(p.docs.length){return h.bulkGet(p).then(function(q){if(n.cancelled){throw new Error("cancelled")}q.results.forEach(function(r){r.docs.forEach(function(s){s.ok&&o.push(s.ok)})})})}}function g(p){return p._attachments&&Object.keys(p._attachments).length>0}function i(p){return h.allDocs({keys:p,include_docs:!0}).then(function(q){if(n.cancelled){throw new Error("cancelled")}q.rows.forEach(function(r){!r.deleted&&r.doc&&ek(r.value.rev)&&!g(r.doc)&&(o.push(r.doc),delete j[r.id])})})}function k(){var p=Object.keys(j).filter(function(q){var r=j[q].missing;return 1===r.length&&ek(r[0])});return p.length>0?i(p):void 0}function l(){return o}j=aO(j);var o=[];return eD.resolve().then(k).then(m).then(l)}function c5(Q,R,w,o,v){function C(){return F?eD.resolve():aB(Q,R,w).then(function(T){i=T,F=new jV(Q,R,i,o)})}function r(){if(K=[],0!==H.docs.length){var T=H.docs;return R.bulkDocs({docs:T,new_edits:!1}).then(function(X){if(o.cancelled){throw D(),new Error("cancelled")}var U=[],W={};X.forEach(function(Z){Z.error&&(v.doc_write_failures++,U.push(Z),W[Z.id]=Z)}),j=j.concat(U),v.docs_written+=H.docs.length-U.length;var V=U.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=W[Z._id];ae?o.emit("denied",aO(ae)):K.push(Z)}),V.length>0){var Y=new Error("bulkDocs error");throw Y.other_errors=U,n("target.bulkDocs failed to write docs",Y),new Error("bulkWrite partial failure")}},function(U){throw v.doc_write_failures+=T.length,U})}}function h(){v.last_seq=I=H.seq;var T=aO(v);return K.length&&(T.docs=K,o.emit("change",T)),E=!0,F.writeCheckpoint(H.seq,l).then(function(){if(E=!1,o.cancelled){throw D(),new Error("cancelled")}H=void 0,y()})["catch"](function(U){throw E=!1,n("writeCheckpoint completed with error",U),U})}function N(){var T={};return H.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),R.revsDiff(T).then(function(U){if(o.cancelled){throw D(),new Error("cancelled")}H.diffs=U})}function p(){return aP(Q,H.diffs,o).then(function(T){T.forEach(function(U){delete H.diffs[U._id],v.docs_read++,H.docs.push(U)})})}function O(){if(!o.cancelled&&!H){if(0===A.length){return void z(!0)}H=A.shift(),N().then(p).then(r).then(h).then(O)["catch"](function(T){n("batch processing terminated with error",T)})}}function z(T){return 0===s.changes.length?void (0!==A.length||H||((B&&g.live||m)&&(o.state="pending",o.emit("paused")),m&&D())):void ((T||m||s.changes.length>=k)&&(A.push(s),s={seq:0,changes:[],docs:[]},("pending"===o.state||"stopped"===o.state)&&(o.state="active",o.emit("active")),O()))}function n(U,T){x||(T.message||(T.message=U),v.ok=!1,v.status="aborting",v.errors.push(T),j=j.concat(T),A=[],s={seq:0,changes:[],docs:[]},D())}function D(){if(!(x||o.cancelled&&(v.status="cancelled",E))){v.status=v.status||"complete",v.end_time=new Date,v.last_seq=I,x=!0;var U=j.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=j.pop();j.length>0&&(T.other_errors=j),T.result=v,bH(w,o,T,function(){c5(Q,R,w,o)})}else{v.errors=j,o.emit("complete",v),o.removeAllListeners()}}}function u(U){if(o.cancelled){return D()}var T=jQ(w)(U);T&&(s.seq=U.seq,s.changes.push(U),z(0===A.length))}function M(T){return P=!1,o.cancelled?D():(T.results.length>0?(g.since=T.last_seq,y()):B?(g.live=!0,y()):m=!0,void z(!0))}function S(T){return P=!1,o.cancelled?D():void n("changes rejected",T)}function y(){function T(){V.cancel()}function U(){o.removeListener("cancel",T)}if(!P&&!m&&A.length<L){P=!0,o._changes&&(o.removeListener("cancel",o._abortChanges),o._changes.cancel()),o.once("cancel",T);var V=Q.changes(g).on("change",u);V.then(U,U),V.then(M)["catch"](S),w.retry&&(o._changes=V,o._abortChanges=T)}}function J(){C().then(function(){return o.cancelled?void D():F.getCheckpoint().then(function(T){I=T,g={since:I,limit:k,batch_size:k,style:"all_docs",doc_ids:G,return_docs:!0},w.filter&&("string"!=typeof w.filter?g.include_docs=!0:g.filter=w.filter),"heartbeat" in w&&(g.heartbeat=w.heartbeat),"timeout" in w&&(g.timeout=w.timeout),w.query_params&&(g.query_params=w.query_params),w.view&&(g.view=w.view),y()})})["catch"](function(T){n("getCheckpoint rejected with ",T)})}function q(T){throw E=!1,n("writeCheckpoint completed with error",T),T}var H,i,F,A=[],s={seq:0,changes:[],docs:[]},E=!1,m=!1,x=!1,I=0,B=w.continuous||w.live||!1,k=w.batch_size||100,L=w.batches_limit||10,P=!1,G=w.doc_ids,j=[],K=[],l=jr();v=v||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var g={};return o.ready(Q,R),o.cancelled?void D():(o._addedListeners||(o.once("cancel",D),"function"==typeof w.complete&&(o.once("error",w.complete),o.once("complete",function(T){w.complete(null,T)})),o._addedListeners=!0),void ("undefined"==typeof w.since?J():C().then(function(){return E=!0,F.writeCheckpoint(w.since,l)}).then(function(){return E=!1,o.cancelled?void D():(I=w.since,void J())})["catch"](q)))}function e6(){bL.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new eD(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function aX(g,i){var h=i.PouchConstructor;return"string"==typeof g?new h(g,i):g}function c8(k,i,g,j){if("function"==typeof g&&(j=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw eP(fL,"`doc_ids` filter parameter is not a list.")}g.complete=j,g=aO(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var l=new e6(g),m=aX(k,g),h=aX(i,g);return c5(m,h,g,l),l}function cK(g,i,h,j){return"function"==typeof h&&(j=h,h={}),"undefined"==typeof h&&(h={}),h=aO(h),h.PouchConstructor=h.PouchConstructor||this,g=eB.toPouch(g,h),i=eB.toPouch(i,h),new ag(g,i,h,j)}function ag(q,y,k,s){function x(z){o.emit("change",{direction:"pull",change:z})}function n(z){o.emit("change",{direction:"push",change:z})}function w(z){o.emit("denied",{direction:"push",doc:z})}function l(z){o.emit("denied",{direction:"pull",doc:z})}function i(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function u(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function p(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function m(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}function r(z){return function(D,C){var A="change"===D&&(C===x||C===n),F="denied"===D&&(C===l||C===w),B="paused"===D&&(C===u||C===i),E="active"===D&&(C===m||C===p);(A||F||B||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&o.removeAllListeners(D))}}var o=this;this.canceled=!1;var v=k.push?ca.extend({},k,k.push):k,h=k.pull?ca.extend({},k,k.pull):k;this.push=dm(q,y,v),this.pull=dm(y,q,h),this.pushPaused=!0,this.pullPaused=!0;var g={};k.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(z){"change"===z?(o.pull.on("change",x),o.push.on("change",n)):"denied"===z?(o.pull.on("denied",l),o.push.on("denied",w)):"active"===z?(o.pull.on("active",m),o.push.on("active",p)):"paused"===z&&(o.pull.on("paused",u),o.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(o.pull.removeListener("change",x),o.push.removeListener("change",n)):"denied"===z?(o.pull.removeListener("denied",l),o.push.removeListener("denied",w)):"active"===z?(o.pull.removeListener("active",m),o.push.removeListener("active",p)):"paused"===z&&(o.pull.removeListener("paused",u),o.push.removeListener("paused",i))}),this.pull.on("removeListener",r("pull")),this.push.on("removeListener",r("push"));var j=eD.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return o.emit("complete",z),s&&s(null,z),o.removeAllListeners(),z},function(z){if(o.cancel(),s?s(z):o.emit("error",z),o.removeAllListeners(),s){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function by(h,g){return jE(b1(h),g)}function bC(h){for(var k="",j=new Uint8Array(h),g=j.byteLength,i=0;g>i;i++){k+=String.fromCharCode(j[i])}return k}function jY(g,i){if("undefined"==typeof FileReader){return i(bC((new FileReaderSync).readAsArrayBuffer(g)))}var h=new FileReader,j="function"==typeof h.readAsBinaryString;h.onloadend=function(k){var l=k.target.result||"";return j?i(l):void i(bC(l))},j?h.readAsBinaryString(g):h.readAsArrayBuffer(g)}function dA(g){return new eD(function(h){jY(g,function(i){h(ax(i))})})}function jy(g){for(var i=[],h=0,j=g.length;j>h;h++){i=i.concat(g[h])}return i}function fH(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=by(j.data,j.content_type)})}function bz(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function cs(g){return g._attachments&&Object.keys(g._attachments)?eD.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?dA(i.data).then(function(j){i.data=j}):void 0})):eD.resolve()}function bX(g){var i=dK(g);(i.user||i.password)&&(i.auth={username:i.user,password:i.password});var h=i.path.replace(/(^\/|\/$)/g,"").split("/");return i.db=h.pop(),-1===i.db.indexOf("%")&&(i.db=encodeURIComponent(i.db)),i.path=h.join("/"),i}function ed(h,g){return dk(h,h.db+"/"+g)}function dk(g,i){var h=g.path?"/":"";return g.protocol+"://"+g.host+(g.port?":"+g.port:"")+"/"+g.path+h+i}function b3(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function b9(u,o){function m(z,x,w){var A=z.ajax||{},y=ca.extend(aO(h),A,x);return dI(y.method+" "+y.url),jX.ajax(y,w)}function g(x,w){return new eD(function(z,y){m(x,w,function(A,B){return A?y(A):void z(B)})})}function i(x,w){return d6(x,j1(function(y){q().then(function(z){return w.apply(this,y)})["catch"](function(z){var A=y.pop();A(z)})}))}function q(){if(u.skipSetup||u.skip_setup){return eD.resolve()}if(l){return l}var w={method:"GET",url:r};return l=g({},w)["catch"](function(x){return x&&x.status&&404===x.status?(bI(404,"PouchDB is just detecting if the remote exists."),g({},{method:"PUT",url:r})):eD.reject(x)})["catch"](function(x){return x&&x.status&&412===x.status?!0:eD.reject(x)}),l["catch"](function(){l=null}),l}function n(w){return w.split("/").map(encodeURIComponent).join("/")}var s=this,k=bX;u.getHost&&(k=u.getHost);var j=k(u.name,u),r=ed(j,"");u=aO(u);var h=u.ajax||{};if(s.getUrl=function(){return r},s.getHeaders=function(){return h.headers||{}},u.auth||j.auth){var p=u.auth||j.auth,v=ax(p.username+":"+p.password);h.headers=h.headers||{},h.headers.Authorization="Basic "+v}var l;setTimeout(function(){o(null,s)}),s.type=function(){return"http"},s.id=i("id",function(w){m({},{method:"GET",url:dk(j,"")},function(x,z){var y=z&&z.uuid?z.uuid+j.db:ed(j,"");w(null,y)})}),s.request=i("request",function(x,w){x.url=ed(j,x.url),m({},x,w)}),s.compact=i("compact",function(x,w){"function"==typeof x&&(w=x,x={}),x=aO(x),m(x,{url:ed(j,"_compact"),method:"POST"},function(){function y(){s.info(function(z,A){A&&!A.compact_running?w(null,{ok:!0}):setTimeout(y,x.interval||200)})}y()})}),s.bulkGet=d6("bulkGet",function(y,A){function B(E){var D={};y.revs&&(D.revs=!0),y.attachments&&(D.attachments=!0),m({},{url:ed(j,"_bulk_get"+b3(D)),method:"POST",body:{docs:y.docs}},E)}function z(){function D(K){return function(M,L){G[K]=L.results,++E===I&&A(null,{results:jy(G)})}}for(var H=d2,I=Math.ceil(y.docs.length/H),E=0,G=new Array(I),F=0;I>F;F++){var J=jm(y,["revs","attachments"]);J.docs=y.docs.slice(F*H,Math.min(y.docs.length,(F+1)*H)),bk(w,J,D(F))}}var w=this,C=dk(j,""),x=aK[C];"boolean"!=typeof x?B(function(D,E){if(D){var F=Math.floor(D.status/100);4===F||5===F?(aK[C]=!1,bI(D.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),z()):A(D)}else{aK[C]=!0,A(null,E)}}):x?B(A):z()}),s._info=function(w){q().then(function(){m({},{method:"GET",url:ed(j,"")},function(y,x){return y?w(y):(x.host=ed(j,""),void w(null,x))})})["catch"](w)},s.get=i("get",function(y,A,B){function z(E){var F=E._attachments,D=F&&Object.keys(F);return F&&D.length?eD.all(D.map(function(I){var G=F[I],H=bz(E._id)+"/"+n(I)+"?rev="+E._rev;return g(A,{method:"GET",url:ed(j,H),binary:!0}).then(function(J){return A.binary?J:dA(J)}).then(function(J){delete G.stub,delete G.length,G.data=J})})):void 0}function w(D){return Array.isArray(D)?eD.all(D.map(function(E){return E.ok?z(E.ok):void 0})):z(D)}"function"==typeof A&&(B=A,A={}),A=aO(A);var x={};A.revs&&(x.revs=!0),A.revs_info&&(x.revs_info=!0),A.open_revs&&("all"!==A.open_revs&&(A.open_revs=JSON.stringify(A.open_revs)),x.open_revs=A.open_revs),A.rev&&(x.rev=A.rev),A.conflicts&&(x.conflicts=A.conflicts),y=bz(y);var C={method:"GET",url:ed(j,y+b3(x))};g(A,C).then(function(D){return eD.resolve().then(function(){return A.attachments?w(D):void 0}).then(function(){B(null,D)})})["catch"](B)}),s.remove=i("remove",function(A,x,z,B){var y;"string"==typeof x?(y={_id:A,_rev:x},"function"==typeof z&&(B=z,z={})):(y=A,"function"==typeof x?(B=x,z={}):(B=z,z=x));var w=y._rev||z.rev;m(z,{method:"DELETE",url:ed(j,bz(y._id))+"?rev="+w},B)}),s.getAttachment=i("getAttachment",function(A,z,B,x){"function"==typeof B&&(x=B,B={});var y=B.rev?"?rev="+B.rev:"",w=ed(j,bz(A))+"/"+n(z)+y;m(B,{method:"GET",url:w,binary:!0},x)}),s.removeAttachment=i("removeAttachment",function(z,x,y,w){var A=ed(j,bz(z)+"/"+n(x))+"?rev="+y;m({},{method:"DELETE",url:A},w)}),s.putAttachment=i("putAttachment",function(E,w,y,A,B,x){"function"==typeof B&&(x=B,B=A,A=y,y=null);var G=bz(E)+"/"+n(w),D=ed(j,G);if(y&&(D+="?rev="+y),"string"==typeof A){var C;try{C=b1(A)}catch(z){return x(eP(bS,"Attachment is not a valid base64 string"))}A=C?jE(C,B):""}var F={headers:{"Content-Type":B},method:"PUT",url:D,processData:!1,body:A,timeout:h.timeout||60000};m({},F,x)}),s._bulkDocs=function(w,x,y){w.new_edits=x.new_edits,q().then(function(){return eD.all(w.docs.map(cs))}).then(function(){m(x,{method:"POST",url:ed(j,"_bulk_docs"),body:w},function(A,z){return A?y(A):(z.forEach(function(B){B.ok=!0}),void y(null,z))})})["catch"](y)},s.allDocs=i("allDocs",function(y,B){"function"==typeof y&&(B=y,y={}),y=aO(y);var A,z={},w="GET";y.conflicts&&(z.conflicts=!0),y.descending&&(z.descending=!0),y.include_docs&&(z.include_docs=!0),y.attachments&&(z.attachments=!0),y.key&&(z.key=JSON.stringify(y.key)),y.start_key&&(y.startkey=y.start_key),y.startkey&&(z.startkey=JSON.stringify(y.startkey)),y.end_key&&(y.endkey=y.end_key),y.endkey&&(z.endkey=JSON.stringify(y.endkey)),"undefined"!=typeof y.inclusive_end&&(z.inclusive_end=!!y.inclusive_end),"undefined"!=typeof y.limit&&(z.limit=y.limit),"undefined"!=typeof y.skip&&(z.skip=y.skip);var C=b3(z);if("undefined"!=typeof y.keys){var x="keys="+encodeURIComponent(JSON.stringify(y.keys));x.length+C.length+1<=jt?C+="&"+x:(w="POST",A={keys:y.keys})}g(y,{method:w,url:ed(j,"_all_docs"+C),body:A}).then(function(D){y.include_docs&&y.attachments&&y.binary&&D.rows.forEach(fH),B(null,D)})["catch"](B)}),s._changes=function(C){var F="batch_size" in C?C.batch_size:bq;C=aO(C),C.timeout="timeout" in C?C.timeout:"timeout" in h?h.timeout:30000;var x,J=C.timeout?{timeout:C.timeout-5000}:{},B="undefined"!=typeof C.limit?C.limit:!1;x="return_docs" in C?C.return_docs:"returnDocs" in C?C.returnDocs:!0;var G=B;if(C.style&&(J.style=C.style),(C.include_docs||C.filter&&"function"==typeof C.filter)&&(J.include_docs=!0),C.attachments&&(J.attachments=!0),C.continuous&&(J.feed="longpoll"),C.conflicts&&(J.conflicts=!0),C.descending&&(J.descending=!0),"heartbeat" in C?C.heartbeat&&(J.heartbeat=C.heartbeat):J.heartbeat=10000,C.filter&&"string"==typeof C.filter&&(J.filter=C.filter,"_view"===C.filter&&C.view&&"string"==typeof C.view&&(J.view=C.view)),C.query_params&&"object"==typeof C.query_params){for(var H in C.query_params){C.query_params.hasOwnProperty(H)&&(J[H]=C.query_params[H])}}var z,y="GET";if(C.doc_ids){J.filter="_doc_ids";var D=JSON.stringify(C.doc_ids);D.length<jt?J.doc_ids=D:(y="POST",z={doc_ids:C.doc_ids})}var A,I,w=function(L,N){if(!C.aborted){J.since=L,"object"==typeof J.since&&(J.since=JSON.stringify(J.since)),C.descending?B&&(J.limit=G):J.limit=!B||G>F?F:G;var M={method:y,url:ed(j,"_changes"+b3(J)),timeout:C.timeout,body:z};I=L,C.aborted||q().then(function(){A=m(C,M,N)})["catch"](N)}},K={results:[]},E=function(M,O){if(!C.aborted){var N=0;if(O&&O.results){N=O.results.length,K.last_seq=O.last_seq;var P={};P.query=C.query_params,O.results=O.results.filter(function(Q){G--;var R=jQ(C)(Q);return R&&(C.include_docs&&C.attachments&&C.binary&&fH(Q),x&&K.results.push(Q),C.onChange(Q)),R})}else{if(M){return C.aborted=!0,void C.complete(M)}}O&&O.last_seq&&(I=O.last_seq);var L=B&&0>=G||O&&F>N||C.descending;(!C.continuous||B&&0>=G)&&L?C.complete(null,K):setTimeout(function(){w(I,E)},0)}};return w(C.since||0,E),{cancel:function(){C.aborted=!0,A&&A.abort()}}},s.revsDiff=i("revsDiff",function(w,x,y){"function"==typeof x&&(y=x,x={}),m(x,{method:"POST",url:ed(j,"_revs_diff"),body:w},y)}),s._close=function(w){w()},s._destroy=function(w,x){m(w,{url:ed(j,""),method:"DELETE"},function(z,y){return z&&z.status&&404!==z.status?x(z):(s.emit("destroyed"),s.constructor.emit("destroyed",u.name),void x(null,y))})}}function dL(){this.promise=new eD(function(g){g()})}function bv(g){return fJ.hash(g)}function aH(i){var k=i.db,l=i.viewName,m=i.map,j=i.reduce,g=i.temporary,n=m.toString()+(j&&j.toString())+"undefined";if(!g&&k._cachedViews){var h=k._cachedViews[n];if(h){return eD.resolve(h)}}return k.info().then(function(p){function o(u){u.views=u.views||{};var r=l;-1===r.indexOf("/")&&(r=l+"/"+l);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(g?"temp":bv(n));return e(k,"_local/mrviews",o).then(function(){return k.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:k,adapter:k.adapter,mapFun:m,reduceFun:j};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,g||(k._cachedViews=k._cachedViews||{},k._cachedViews[n]=r,r.db.once("destroyed",function(){delete k._cachedViews[n]})),r})})})})}function aw(i,l,k,h,j,g){return cC("return ("+i.replace(/;\s*$/,"")+");",{emit:l,sum:k,log:h,isArray:j,toJSON:g})}function dP(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function cg(g){return 1===g.length&&/^1-/.test(g[0].rev)}function cY(g,i){try{g.emit("error",i)}catch(h){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(i)}}function aC(g,i,h){try{return{output:i.apply(null,h)}}catch(j){return cY(g,j),{error:j}}}function dG(g,i){var h=b2(g.key,i.key);return 0!==h?h:b2(g.value,i.value)}function au(g,i,h){return h=h||0,"number"==typeof i?g.slice(h,i+h):h>0?g.slice(h):g}function bV(g){var i=g.value,h=i&&"object"==typeof i&&i._id||g.id;return h}function dZ(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=by(k.data,k.content_type)})})}function cc(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&dZ(h),h}}function bc(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new el(g)}function cP(i){for(var k=0,l=0,m=i.length;m>l;l++){var j=i[l];if("number"!=typeof j){if(!Array.isArray(j)){throw bc("_sum")}k="number"==typeof k?[k]:k;for(var g=0,n=j.length;n>g;g++){var h=j[g];if("number"!=typeof h){throw bc("_sum")}"undefined"==typeof k[g]?k.push(h):k[g]+=h}}else{"number"==typeof k?k+=j:k[0]+=j}}return k}function b5(h,k,j,g){var i=k[h];"undefined"!=typeof i&&(g&&(i=encodeURIComponent(JSON.stringify(i))),j.push(h+"="+i))}function dE(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function cq(g){return g.group_level=dE(g.group_level),g.limit=dE(g.limit),g.skip=dE(g.skip),g}function dT(g){if(g){if("number"!=typeof g){return new aM('Invalid value for integer: "'+g+'"')}if(0>g){return new aM('Invalid value for positive integer: "'+g+'"')}}}function b8(g,i){var h=g.descending?"endkey":"startkey",j=g.descending?"startkey":"endkey";if("undefined"!=typeof g[h]&&"undefined"!=typeof g[j]&&b2(g[h],g[j])>0){throw new aM("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(i.reduce&&g.reduce!==!1){if(g.include_docs){throw new aM("{include_docs:true} is invalid for reduce")}if(g.keys&&g.keys.length>1&&!g.group&&!g.group_level){throw new aM("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=dT(g[k]);if(l){throw l}})}function cf(h,j,n){var m,g=[],i="GET";if(b5("reduce",n,g),b5("include_docs",n,g),b5("attachments",n,g),b5("limit",n,g),b5("descending",n,g),b5("group",n,g),b5("group_level",n,g),b5("skip",n,g),b5("stale",n,g),b5("conflicts",n,g),b5("startkey",n,g,!0),b5("start_key",n,g,!0),b5("endkey",n,g,!0),b5("end_key",n,g,!0),b5("inclusive_end",n,g),b5("key",n,g,!0),g=g.join("&"),g=""===g?"":"?"+g,"undefined"!=typeof n.keys){var k=2000,l="keys="+encodeURIComponent(JSON.stringify(n.keys));l.length+g.length+1<=k?g+=("?"===g[0]?"&":"?")+l:(i="POST","string"==typeof j?m={keys:n.keys}:j.keys=n.keys)}if("string"==typeof j){var o=dP(j);return h.request({method:i,url:"_design/"+o[0]+"/_view/"+o[1]+g,body:m}).then(cc(n))}return m=m||{},Object.keys(j).forEach(function(p){Array.isArray(j[p])?m[p]=j[p]:m[p]=j[p].toString()}),h.request({method:"POST",url:"_temp_view"+g,body:m}).then(cc(n))}function fK(g,i,h){return new eD(function(j,k){g._query(i,h,function(m,l){return m?k(m):void j(l)})})}function eJ(g){return new eD(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function am(g){return function(h){if(404===h.status){return g}throw h}}function cO(i,m,h){function p(){return cg(q)?eD.resolve(l):m.db.get(j)["catch"](am(l))}function n(r){return r.keys.length?m.db.allDocs({keys:r.keys,include_docs:!0}):eD.resolve({rows:[]})}function g(x,y){for(var s=[],A={},r=0,v=y.rows.length;v>r;r++){var w=y.rows[r],B=w.doc;if(B&&(s.push(B),A[B._id]=!0,B._deleted=!k[B._id],!B._deleted)){var z=k[B._id];"value" in z&&(B.value=z.value)}}var u=Object.keys(k);return u.forEach(function(C){if(!A[C]){var E={_id:C},D=k[C];"value" in D&&(E.value=D.value),s.push(E)}}),x.keys=e4(u.concat(x.keys)),s.push(x),s}var j="_local/doc_"+i,l={_id:j,keys:[]},o=h[i],k=o.indexableKeysToKeyValues,q=o.changes;return p().then(function(r){return n(r).then(function(s){return g(r,s)})})}function e1(g,i,h){var j="_local/lastSeq";return g.db.get(j)["catch"](am({_id:j,seq:0})).then(function(k){var l=Object.keys(i);return eD.all(l.map(function(m){return cO(m,g,i)})).then(function(m){var n=jy(m);return k.seq=h,n.push(k),g.db.bulkDocs({docs:n})})})}function cv(g){var i="string"==typeof g?g:g.name,h=eO[i];return h||(h=eO[i]=new dL),h}function bB(g){return d3(cv(g),function(){return bO(g)})()}function bO(h){function j(p,r){var q={id:g._id,key:eL(p)};"undefined"!=typeof r&&null!==r&&(q.value=eL(r)),m.push(q)}function n(q,p){return function(){return e1(h,q,p)}}var m,g,i;if("function"==typeof h.mapFun&&2===h.mapFun.length){var k=h.mapFun;i=function(p){return k(p,j)}}else{i=aw(h.mapFun.toString(),j,cP,cx,Array.isArray,JSON.parse)}var l=h.seq||0,o=new dL;return new eD(function(p,s){function r(){o.finish().then(function(){h.seq=l,p()})}function q(){function u(v){s(v)}h.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:l,limit:aN}).on("complete",function(C){var x=C.results;if(!x.length){return r()}for(var z={},v=0,F=x.length;F>v;v++){var A=x[v];if("_"!==A.doc._id[0]){m=[],g=A.doc,g._deleted||aC(h.sourceDB,i,[g]),m.sort(dG);for(var y,D={},H=0,E=m.length;E>H;H++){var G=m[H],w=[G.key,G.id];0===b2(G.key,y)&&w.push(H);var B=bK(w);D[B]=G,y=G.key}z[A.doc._id]={indexableKeysToKeyValues:D,changes:A.changes}}l=A.seq}return o.add(n(z,l)),x.length<aN?r():q()}).on("error",u)}q()})}function bJ(i,m,h){0===h.group_level&&delete h.group_level;var p,n=h.group||h.group_level;p=bx[i.reduceFun]?bx[i.reduceFun]:aw(i.reduceFun.toString(),null,cP,cx,Array.isArray,JSON.parse);var g=[],j=h.group_level;m.forEach(function(r){var u=g[g.length-1],s=n?r.key:null;return n&&Array.isArray(s)&&"number"==typeof j&&(s=s.length>j?s.slice(0,j):s),u&&0===b2(u.key[0][0],s)?(u.key.push([s,r.id]),void u.value.push(r.value)):void g.push({key:[[s,r.id]],value:[r.value]})});for(var l=0,o=g.length;o>l;l++){var k=g[l],q=aC(i.sourceDB,p,[k.key,k.value,!1]);if(q.error&&q.error instanceof el){throw q.error}k.value=q.error?null:q.output,k.key=k.key[0][0]}return{rows:au(g,h.limit,h.skip)}}function fA(h,g){return d3(cv(h),function(){return bf(h,g)})()}function bf(r,n){function q(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return p=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=cl(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function o(w){var v;if(v=g?bJ(r,w,n):{total_rows:p,offset:l,rows:w},n.include_docs){var u=e4(w.map(bV));return r.sourceDB.allDocs({keys:u,include_docs:!0,conflicts:n.conflicts,attachments:n.attachments,binary:n.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),w.forEach(function(A){var B=bV(A),z=y["$"+B];z&&(A.doc=z)}),v})}return v}var p,g=r.reduceFun&&n.reduce!==!1,l=n.skip||0;if("undefined"==typeof n.keys||n.keys.length||(n.limit=0,delete n.keys),"undefined"!=typeof n.keys){var h=n.keys,m=h.map(function(v){var u={startkey:bK([v]),endkey:bK([v,{}])};return q(u)});return eD.all(m).then(jy).then(o)}var k={descending:n.descending};if(n.start_key&&(n.startkey=n.start_key),n.end_key&&(n.endkey=n.end_key),"undefined"!=typeof n.startkey&&(k.startkey=bK(n.descending?[n.startkey,{}]:[n.startkey])),"undefined"!=typeof n.endkey){var i=n.inclusive_end!==!1;n.descending&&(i=!i),k.endkey=bK(i?[n.endkey,{}]:[n.endkey])}if("undefined"!=typeof n.key){var s=bK([n.key]),j=bK([n.key,{}]);k.descending?(k.endkey=s,k.startkey=j):(k.startkey=s,k.endkey=j)}return g||("number"==typeof n.limit&&(k.limit=n.limit),k.skip=l),q(k).then(o)}function cU(g){return g.request({method:"POST",url:"_view_cleanup"})}function e0(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(k){var m=dP(k),n="_design/"+m[0],l=m[1];j[n]=j[n]||{},j[n][l]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(k){var l={};k.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){l[v]=l[v]||s})})});var n=Object.keys(l).filter(function(o){return !l[o]}),m=n.map(function(o){return d3(cv(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return eD.all(m).then(function(){return{ok:!0}})})},am({ok:!0}))}function ad(j,h,i){if("http"===j.type()){return cf(j,h,i)}if("function"==typeof j._query){return fK(j,h,i)}if("string"!=typeof h){b8(i,h);var l={db:j,viewName:"temp_view/temp_view",map:h.map,reduce:h.reduce,temporary:!0};return jw.add(function(){return aH(l).then(function(o){function p(){return o.db.destroy()}return aF(bB(o).then(function(){return fA(o,i)}),p)})}),jw.finish()}var k=h,n=dP(k),m=n[0],g=n[1];return j.get("_design/"+m).then(function(o){var p=o.views&&o.views[g];if(!p||"string"!=typeof p.map){throw new aj("ddoc "+m+" has no view named "+g)}b8(i,p);var q={db:j,viewName:k,map:p.map,reduce:p.reduce};return aH(q).then(function(r){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&cI.nextTick(function(){bB(r)}),fA(r,i)):bB(r).then(function(){return fA(r,i)})})})}function aM(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,aM)}catch(g){}}function aj(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,aj)}catch(g){}}function el(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,el)}catch(g){}}function cV(g){return"'"+g+"'"}function b7(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cm(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jN(g){return delete g._id,delete g._rev,JSON.stringify(g)}function eQ(g,i,h){return g=JSON.parse(g),g._id=i,g._rev=h,g}function fI(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function b4(h,k,j,g,i){return"SELECT "+h+" FROM "+("string"==typeof k?k:k.join(" JOIN "))+(j?" ON "+j:"")+(g?" WHERE "+("string"==typeof g?g:g.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function dS(k,i,g){function j(){++m===k.length&&l()}function l(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+cb+" WHERE seq IN "+fI(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+cb+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+cb+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new ak.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+cb+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+du+" WHERE digest=?",[A]))})})})}})}}if(k.length){var m=0,h=[];k.forEach(function(o){var n="SELECT seq FROM "+fC+" WHERE doc_id=? AND rev=?";g.executeSql(n,[i,o],function(q,p){if(!p.rows.length){return j()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+fC+" WHERE seq=?",[r],j)})})}}function jp(g){return function(h){console.error("WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(eP(ck,j,i))}}function cd(h){if("size" in h){return 1000000*h.size}var g=/Android/.test(window.navigator.userAgent);return g?5000000:1}function jv(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(g){return openDatabase(g.name,g.version,g.description,g.size)}:void 0}function d1(g,i){try{return{db:g(i)}}catch(h){return{error:h}}}function cX(g){var i=dX[g.name];if(!i){var h=jv();i=dX[g.name]=d1(h,g),i.db&&(i.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return i}function dl(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function jM(g){jF()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):aa()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function aq(){bL.EventEmitter.call(this),this._listeners={},jM(this)}function fF(g){return decodeURIComponent(window.escape(g))}function a8(g){return 65>g?g-48:g-55}function jO(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(a8(g.charCodeAt(i++))<<4|a8(g.charCodeAt(i++)))}return j}function aE(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(a8(g.charCodeAt(i+2))<<12|a8(g.charCodeAt(i+3))<<8|a8(g.charCodeAt(i))<<4|a8(g.charCodeAt(i+1))),i+=4}return j}function bs(h,g){return"UTF-8"===g?fF(jO(h,0,h.length)):aE(h,0,h.length)}function bb(h){try{return JSON.parse(h)}catch(g){return aT.parse(h)}}function jA(h){try{return JSON.stringify(h)}catch(g){return aT.stringify(h)}}function aW(m,g,j){function h(p){try{return b1(p)}catch(o){var q=eP(bS,"Attachment is not a valid base64 string");return{error:q}}}function i(o,q){if(o.stub){return q()}if("string"==typeof o.data){var p=h(o.data);if(p.error){return q(p.error)}o.length=p.length,"blob"===g?o.data=jE(p,o.content_type):"base64"===g?o.data=ax(p):o.data=p,cD(p).then(function(r){o.digest="md5-"+r,q()})}else{c6(o.data,function(r){"binary"===g?o.data=bC(r):"base64"===g&&(o.data=ax(bC(r))),cD(r).then(function(s){o.digest="md5-"+s,o.length=r.byteLength,q()})})}}function l(){n++,m.length===n&&(k?j(k):j())}if(!m.length){return j()}var k,n=0;m.forEach(function(r){function p(u){k=u,q++,q===s.length&&l()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return l()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&i(r.data._attachments[o],p)}})}function aQ(h,g){return h.pos-g.pos}function e7(i,l,k){for(var h,j=0,g=i.length;g>j;){h=j+g>>>1,k(i[h],l)<0?j=h+1:g=h}return j}function bp(g,i,h){var j=e7(g,i,h);g.splice(j,0,i)}function cM(i,k){for(var l,m,j=k,g=i.length;g>j;j++){var n=i[j],h=[n.id,n.opts,[]];m?(m[2].push(h),m=h):l=m=h}return l}function t(h,g){return h[0]<g[0]?-1:1}function bF(k,m){for(var i=[{tree1:k,tree2:m}],g=!1;i.length>0;){var h=i.pop(),j=h.tree1,l=h.tree2;(j[1].status||l[1].status)&&(j[1].status="available"===j[1].status||"available"===l[1].status?"available":"missing");for(var o=0;o<l[2].length;o++){if(j[2][0]){for(var p=!1,n=0;n<j[2].length;n++){j[2][n][0]===l[2][o][0]&&(i.push({tree1:j[2][n],tree2:l[2][o]}),p=!0)}p||(g="new_branch",bp(j[2],l[2][o],t))}else{g="new_leaf",j[2][0]=l[2][o]}}}return{conflicts:g,tree:k}}function bi(s,y,q){var o,k=[],x=!1,w=!1;if(!s.length){return{tree:[y],conflicts:"new_leaf"}}for(var A=0,j=s.length;j>A;A++){var p=s[A];if(p.pos===y.pos&&p.ids[0]===y.ids[0]){o=bF(p.ids,y.ids),k.push({pos:p.pos,ids:o.tree}),x=x||o.conflicts,w=!0}else{if(q!==!0){var n=p.pos<y.pos?p:y,v=p.pos<y.pos?y:p,u=v.pos-n.pos,z=[],i=[];for(i.push({ids:n.ids,diff:u,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],m=0,r=g.length;r>m;m++){i.push({ids:g[m],diff:h.diff-1,parent:h.ids,parentIdx:m})}}else{h.ids[0]===v.ids[0]&&z.push(h)}}var l=z[0];l?(o=bF(l.ids,v.ids),l.parent[2][l.parentIdx]=o.tree,k.push({pos:n.pos,ids:n.ids}),x=x||o.conflicts,w=!0):k.push(p)}else{k.push(p)}}}return w||k.push(y),k.sort(aQ),{tree:k,conflicts:x||"internal_node"}}function cQ(k,m){for(var i,g=jS(k),h=0,j=g.length;j>h;h++){var l=g[h],o=l.ids,p=Math.max(0,o.length-m),n={pos:l.pos+p,ids:cM(o,p)};i=i?bi(i,n,!0).tree:[n]}return i}function c9(g,i,h){var j=bi(g,i);return{tree:cQ(j.tree,h),conflicts:j.conflicts}}function ah(k,m){for(var i,g=k.slice(),h=m.split("-"),j=parseInt(h[0],10),l=h[1];i=g.pop();){if(i.pos===j&&i.ids[0]===l){return !0}for(var o=i.ids[2],p=0,n=o.length;n>p;p++){g.push({pos:i.pos+1,ids:o[p]})}}return !1}function eM(v,l,n,h,m,A,y,p){if(ah(l.rev_tree,n.metadata.rev)){return h[m]=n,A()}var z=l.winningRev||jD(l),k="deleted" in l?l.deleted:cW(l,z),q="deleted" in n.metadata?n.metadata.deleted:cW(n.metadata),w=/^1-/.test(n.metadata.rev);if(k&&!q&&p&&w){var B=n.data;B._rev=z,B._id=n.metadata.id,n=bh(B,p)}var i=c9(l.rev_tree,n.metadata.rev_tree[0],v),g=p&&(k&&q||!k&&"new_leaf"!==i.conflicts||k&&!q&&"new_branch"===i.conflicts);if(g){var s=eP(dd);return h[m]=s,A()}var j=n.metadata.rev;n.metadata.rev_tree=i.tree,l.rev_map&&(n.metadata.rev_map=l.rev_map);var u,r=jD(n.metadata),x=cW(n.metadata,r),o=k===x?0:x>k?-1:1;u=j===r?x:cW(n.metadata,j),y(n,r,x,u,!0,o,m,A)}function bG(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function fB(u,o,m,g,i,q,n,s,k){function j(B,x,C){var D=jD(B.metadata),w=cW(B.metadata,D);if("was_delete" in s&&w){return q[x]=eP(bZ,"deleted"),C()}var z=h&&bG(B);if(z){var A=eP(dd);return q[x]=A,C()}var y=w?0:1;n(B,D,w,w,!1,y,x,C)}function r(){++v===l&&k&&k()}u=u||1000;var h=s.new_edits,p=new ak.Map,v=0,l=o.length;o.forEach(function(y,w){if(y._id&&c4(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void m[x](y,{ctx:i},function(B,A){q[w]=B||A,r()})}var z=y.metadata.id;p.has(z)?(l--,p.get(z).push([y,w])):p.set(z,[[y,w]])}),p.forEach(function(x,z){function y(){++w<x.length?A():r()}function A(){var C=x[w],D=C[0],E=C[1];if(g.has(z)){eM(u,g.get(z),D,q,E,y,n,h)}else{var B=c9([],D.metadata.rev_tree[0],u);D.metadata.rev_tree=B.tree,j(D,E,y)}}var w=0;A()})}function bY(h){var g=[];return jz(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function bA(z,k,o,j,g,s,B){function m(){return w?B(w):(s.notify(j._name),j._docCount=-1,void B(null,r))}function C(E,D){var F="SELECT count(*) as cnt FROM "+du+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=eP(dB,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function q(F){function D(){++G===H.length&&F(E)}var H=[];if(l.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){C(I,function(J){J&&!E&&(E=J),D()})})}function y(L,H,O,K,F,Q,J,E){function N(){function ae(an,ai){function ao(){return ++at===a1.length&&ai(),!1}function a0(a3){var a4="INSERT INTO "+cb+" (digest, seq) VALUES (?,?)",a2=[T._attachments[a3].digest,an];p.executeSql(a4,a2,ao,ao)}var at=0,a1=Object.keys(T._attachments||{});if(!a1.length){return ai()}for(var ar=0;ar<a1.length;ar++){a0(a1[ar])}}var T=L.data,X=K?1:0,W=T._id,Y=T._rev,V=jN(T),U="INSERT INTO "+fC+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",Z=[W,Y,V,X];p.executeSql(U,Z,function(ao,an){var ai=an.insertId;ae(ai,function(){I(ao,ai)})},function(){var ai=b4("seq",fC,null,"doc_id=? AND rev=?");return p.executeSql(ai,[W,Y],function(ar,ao){var at=ao.rows.item(0).seq,a0="UPDATE "+fC+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",an=[V,X,W,Y];ar.executeSql(a0,an,function(a1){ae(at,function(){I(a1,at)})})}),!1})}function G(T){D||(T?(D=T,E(D)):P===R.length&&N())}function S(T){P++,G(T)}function M(){if(F&&j.auto_compaction){var T=L.metadata.id,U=bY(L.metadata);dS(U,T,p)}}function I(V,T){M(),L.metadata.seq=T,delete L.metadata.rev;var X=F?"UPDATE "+dp+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+fC+" WHERE doc_id="+dp+".id AND rev=?) WHERE id=?":"INSERT INTO "+dp+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Y=jA(L.metadata),U=L.metadata.id,W=F?[Y,T,H,U]:[U,T,T,Y];V.executeSql(X,W,function(){r[J]={ok:!0,id:L.metadata.id,rev:H},A.set(U,L.metadata),E()})}var D=null,P=0;L.data._id=L.metadata.id,L.data._rev=L.metadata.rev;var R=Object.keys(L.data._attachments||{});K&&(L.data._deleted=!0),R.forEach(function(V){var W=L.data._attachments[V];if(W.stub){P++,G()}else{var T=W.data;delete W.data;var U=W.digest;n(U,T,S)}}),R.length||N()}function x(){fB(z.revs_limit,l,j,A,p,r,y,o)}function v(E){function D(){++F===l.length&&E()}if(!l.length){return E()}var F=0;l.forEach(function(G){if(G._id&&c4(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+dp+" WHERE id = ?",[H],function(I,K){if(K.rows.length){var J=bb(K.rows.item(0).json);A.set(H,J)}D()})})}function n(F,D,G){var E="SELECT digest FROM "+du+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+du+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,b7(D)],function(){G()},function(){return G(),!1}))})}var h=o.new_edits,i=k.docs,l=i.map(function(E){if(E._id&&c4(E._id)){return E}var D=bh(E,h);return D}),u=l.filter(function(D){return D.error});if(u.length){return B(u[0])}var p,w,r=new Array(l.length),A=new ak.Map;aW(l,"binary",function(D){return D?B(D):void g.transaction(function(E){p=E,q(function(F){F?w=F:v(x)})},jp(B),m)})}function aJ(h,j,n,m,g){function i(){++o===l.length&&g&&g()}function k(q,s){var r=q._attachments[s],p={binary:j.binary,ctx:m};n._getAttachment(r,p,function(u,v){q._attachments[s]=ca.extend(jm(r,["digest","content_type"]),{data:v}),i()})}var l=Object.keys(h._attachments||{});if(!l.length){return g&&g()}var o=0;l.forEach(function(p){j.attachments&&j.include_docs?k(h,p):(h._attachments[p].stub=!0,i())})}function c2(C,h){function o(){aa()&&(window.localStorage["_pouch__websqldb_"+s._name]=!0),h(null,s)}function j(E,D){E.executeSql(jl),E.executeSql("ALTER TABLE "+fC+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){E.executeSql(dJ),E.executeSql("ALTER TABLE "+dp+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){E.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+dp+" (local, id)");var F="SELECT "+dp+".winningseq AS seq, "+dp+".json AS metadata FROM "+fC+" JOIN "+dp+" ON "+fC+".seq = "+dp+".winningseq";E.executeSql(F,[],function(H,M){for(var N=[],K=[],J=0;J<M.rows.length;J++){var G=M.rows.item(J),L=G.seq,I=JSON.parse(G.metadata);cW(I)&&N.push(L),c4(I.id)&&K.push(I.id)}H.executeSql("UPDATE "+dp+"SET local = 1 WHERE id IN "+fI(K.length),K,function(){H.executeSql("UPDATE "+fC+" SET deleted = 1 WHERE seq IN "+fI(N.length),N,D)})})})})}function g(E,D){var F="CREATE TABLE IF NOT EXISTS "+eH+" (id UNIQUE, rev, json)";E.executeSql(F,[],function(){var G="SELECT "+dp+".id AS id, "+fC+".json AS data FROM "+fC+" JOIN "+dp+" ON "+fC+".seq = "+dp+".winningseq WHERE local = 1";E.executeSql(G,[],function(K,H){function J(){if(!L.length){return D(K)}var N=L.shift(),M=JSON.parse(N.data)._rev;K.executeSql("INSERT INTO "+eH+" (id, rev, json) VALUES (?,?,?)",[N.id,M,N.data],function(O){O.executeSql("DELETE FROM "+dp+" WHERE id=?",[N.id],function(P){P.executeSql("DELETE FROM "+fC+" WHERE seq=?",[N.seq],function(){J()})})})}for(var L=[],I=0;I<H.rows.length;I++){L.push(H.rows.item(I))}J()})})}function x(F,D){function G(I){function H(){if(!I.length){return D(F)}var L=I.shift(),J=bs(L.hex,k),M=J.lastIndexOf("::"),K=J.substring(0,M),O=J.substring(M+2),N="UPDATE "+fC+" SET doc_id=?, rev=? WHERE doc_id_rev=?";F.executeSql(N,[K,O,J],function(){H()})}H()}var E="ALTER TABLE "+fC+" ADD COLUMN doc_id";F.executeSql(E,[],function(I){var H="ALTER TABLE "+fC+" ADD COLUMN rev";I.executeSql(H,[],function(J){J.executeSql(j0,[],function(L){var K="SELECT hex(doc_id_rev) as hex FROM "+fC;L.executeSql(K,[],function(O,M){for(var N=[],P=0;P<M.rows.length;P++){N.push(M.rows.item(P))}G(N)})})})})}function l(F,D){function G(H){var I="SELECT COUNT(*) AS cnt FROM "+du;H.executeSql(I,[],function(K,M){function J(){var P=b4(db+", "+dp+".id AS id",[dp,fC],bN,null,dp+".id ");P+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(P,[],function(Q,V){function S(ao,an){var ar=X[ao]=X[ao]||[];-1===ar.indexOf(an)&&ar.push(an)}if(!V.rows.length){return D(Q)}for(var X={},R=0;R<V.rows.length;R++){for(var U=V.rows.item(R),T=eQ(U.data,U.id,U.rev),Z=Object.keys(T._attachments||{}),ai=0;ai<Z.length;ai++){var W=T._attachments[Z[ai]];S(W.digest,U.seq)}}var ae=[];if(Object.keys(X).forEach(function(ao){var an=X[ao];an.forEach(function(ar){ae.push([ao,ar])})}),!ae.length){return J()}var Y=0;ae.forEach(function(an){var ao="INSERT INTO "+cb+" (digest, seq) VALUES (?,?)";Q.executeSql(ao,an,function(){++Y===ae.length&&J()})})})}var L=M.rows.item(0).cnt;if(!L){return D(K)}var O=0,N=10;J()})}var E="CREATE TABLE IF NOT EXISTS "+cb+" (digest, seq INTEGER)";F.executeSql(E,[],function(H){H.executeSql(dh,[],function(I){I.executeSql(js,[],G)})})}function m(E,D){var F="ALTER TABLE "+du+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";E.executeSql(F,[],D)}function q(E,D){var F="ALTER TABLE "+dp+" ADD COLUMN max_seq INTEGER";E.executeSql(F,[],function(G){var H="UPDATE "+dp+" SET max_seq=(SELECT MAX(seq) FROM "+fC+" WHERE doc_id=id)";G.executeSql(H,[],function(J){var I="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+dp+" (max_seq)";J.executeSql(I,[],D)})})}function u(E,D){E.executeSql('SELECT HEX("a") AS hex',[],function(G,H){var F=H.rows.item(0).hex;k=2===F.length?"UTF-8":"UTF-16",D()})}function i(){for(;r.length>0;){var D=r.pop();D(null,y)}}function v(G,D){if(0===D){var K="CREATE TABLE IF NOT EXISTS "+fM+" (dbid, db_version INTEGER)",I="CREATE TABLE IF NOT EXISTS "+du+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",E="CREATE TABLE IF NOT EXISTS "+cb+" (digest, seq INTEGER)",H="CREATE TABLE IF NOT EXISTS "+dp+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",F="CREATE TABLE IF NOT EXISTS "+fC+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",J="CREATE TABLE IF NOT EXISTS "+eH+" (id UNIQUE, rev, json)";G.executeSql(I),G.executeSql(J),G.executeSql(E,[],function(){G.executeSql(js),G.executeSql(dh)}),G.executeSql(H,[],function(){G.executeSql(jl),G.executeSql(F,[],function(){G.executeSql(dJ),G.executeSql(j0),G.executeSql(K,[],function(){var P="INSERT INTO "+fM+" (db_version, dbid) VALUES (?,?)";y=jr();var Q=[dN,y];G.executeSql(P,Q,function(){i()})})})})}else{var O=function(){var Q=dN>D;Q&&G.executeSql("UPDATE "+fM+" SET db_version = "+dN);var P="SELECT dbid FROM "+fM;G.executeSql(P,[],function(R,S){y=S.rows.item(0).dbid,i()})},L=[j,g,x,l,m,q,O],M=D,N=function(P){L[M-1](P,N),M++};N(G)}}function B(){A.transaction(function(D){u(D,function(){n(D)})},jp(h),o)}function n(E){var D="SELECT sql FROM sqlite_master WHERE tbl_name = "+fM;E.executeSql(D,[],function(G,F){F.rows.length?/db_version/.test(F.rows.item(0).sql)?G.executeSql("SELECT db_version FROM "+fM,[],function(H,J){var I=J.rows.item(0).db_version;v(H,I)}):G.executeSql("ALTER TABLE "+fM+" ADD COLUMN db_version INTEGER",[],function(){v(G,1)}):v(G,0)})}function z(E,D){if(-1!==s._docCount){return D(s._docCount)}var F=b4("COUNT("+dp+".id) AS 'num'",[dp,fC],bN,fC+".deleted=0");E.executeSql(F,[],function(G,H){s._docCount=H.rows.item(0).num,D(s._docCount)})}var k,s=this,y=null,p=cd(C),r=[];s._docCount=-1,s._name=C.name;var w=cX({name:s._name,version:eW,description:s._name,size:p,location:C.location,createFromLocation:C.createFromLocation,androidDatabaseImplementation:C.androidDatabaseImplementation});if(w.error){return jp(h)(w.error)}var A=w.db;"function"!=typeof A.readTransaction&&(A.readTransaction=A.transaction),B(),s.type=function(){return"websql"},s._id=fD(function(D){D(null,y)}),s._info=function(D){A.readTransaction(function(E){z(E,function(G){var F="SELECT MAX(seq) AS seq FROM "+fC;E.executeSql(F,[],function(J,H){var I=H.rows.item(0).seq||0;D(null,{doc_count:G,update_seq:I,sqlite_plugin:A._sqlitePlugin,websql_encoding:k})})})},jp(D))},s._bulkDocs=function(D,F,E){bA(C,D,F,s,A,c2.Changes,E)},s._get=function(K,E,I){function F(){I(M,{doc:G,metadata:J,ctx:H})}var G,J,M,H=E.ctx;if(!H){return A.readTransaction(function(N){s._get(K,ca.extend({ctx:N},E),I)})}var D,L;E.rev?(D=b4(db,[dp,fC],dp+".id="+fC+".doc_id",[fC+".doc_id=?",fC+".rev=?"]),L=[K,E.rev]):(D=b4(db,[dp,fC],bN,dp+".id=?"),L=[K]),H.executeSql(D,L,function(N,O){if(!O.rows.length){return M=eP(bZ,"missing"),F()}var P=O.rows.item(0);return J=bb(P.metadata),P.deleted&&!E.rev?(M=eP(bZ,"deleted"),F()):(G=eQ(P.data,J.id,P.rev),void F())})},s._allDocs=function(I,P){var M,H=[],J="startkey" in I?I.startkey:!1,E="endkey" in I?I.endkey:!1,N="key" in I?I.key:!1,Q="descending" in I?I.descending:!1,O="limit" in I?I.limit:-1,L="skip" in I?I.skip:0,G=I.inclusive_end!==!1,D=[],K=[];if(N!==!1){K.push(dp+".id = ?"),D.push(N)}else{if(J!==!1||E!==!1){if(J!==!1&&(K.push(dp+".id "+(Q?"<=":">=")+" ?"),D.push(J)),E!==!1){var F=Q?">":"<";G&&(F+="="),K.push(dp+".id "+F+" ?"),D.push(E)}N!==!1&&(K.push(dp+".id = ?"),D.push(N))}}"ok"!==I.deleted&&K.push(fC+".deleted = 0"),A.readTransaction(function(R){z(R,function(S){if(M=S,0!==O){var T=b4(db,[dp,fC],bN,K,dp+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+O+" OFFSET "+L,R.executeSql(T,D,function(X,U){for(var V=0,W=U.rows.length;W>V;V++){var ai=U.rows.item(V),ao=bb(ai.metadata),an=ao.id,Z=eQ(ai.data,an,ai.rev),Y=Z._rev,ae={id:an,key:an,value:{rev:Y}};if(I.include_docs&&(ae.doc=Z,ae.doc._rev=Y,I.conflicts&&(ae.doc._conflicts=jC(ao)),aJ(ae.doc,I,s,X)),ai.deleted){if("ok"!==I.deleted){continue}ae.value.deleted=!0,ae.doc=null}H.push(ae)}})}})},jp(P),function(){P(null,{total_rows:M,offset:I.skip,rows:H})})},s._changes=function(H){function D(){var R=dp+".json AS metadata, "+dp+".max_seq AS maxSeq, "+fC+".json AS winningDoc, "+fC+".rev AS winningRev ",S=dp+" JOIN "+fC,Q=dp+".id="+fC+".doc_id AND "+dp+".winningseq="+fC+".seq",P=["maxSeq > ?"],M=[H.since];H.doc_ids&&(P.push(dp+".id IN "+fI(H.doc_ids.length)),M=M.concat(H.doc_ids));var T="maxSeq "+(G?"DESC":"ASC"),N=b4(R,S,Q,P,T),L=jQ(H);H.view||H.filter||(N+=" LIMIT "+K);var O=H.since||0;A.readTransaction(function(U){U.executeSql(N,M,function(Y,ai){function Z(at){return function(){H.onChange(at)}}for(var X=0,V=ai.rows.length;V>X;X++){var ao=ai.rows.item(X),an=bb(ao.metadata);O=ao.maxSeq;var ar=eQ(ao.winningDoc,an.id,ao.winningRev),W=H.processChange(ar,an,H);W.seq=ao.maxSeq;var ae=L(W);if("object"==typeof ae){return H.complete(ae)}if(ae&&(F++,J&&I.push(W),H.attachments&&H.include_docs?aJ(ar,H,s,Y,Z(W)):Z(W)()),F===K){break}}})},jp(H.complete),function(){H.continuous||H.complete(null,{results:I,last_seq:O})})}if(H=aO(H),H.continuous){var E=s._name+":"+jr();return c2.Changes.addListener(s._name,E,s,H),c2.Changes.notify(s._name),{cancel:function(){c2.Changes.removeListener(s._name,E)}}}var G=H.descending;H.since=H.since&&!G?H.since:0;var K="limit" in H?H.limit:-1;0===K&&(K=1);var J;J="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var I=[],F=0;D()},s._close=function(D){D()},s._getAttachment=function(H,D,E){var G,K=D.ctx,J=H.digest,I=H.content_type,F="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+du+" WHERE digest=?";K.executeSql(F,[J],function(N,O){var L=O.rows.item(0),M=L.escaped?cm(L.body):bs(L.body,k);G=D.binary?jE(M,I):ax(M),E(null,G)})},s._getRevisionTree=function(E,D){A.readTransaction(function(G){var F="SELECT json AS metadata FROM "+dp+" WHERE id = ?";G.executeSql(F,[E],function(H,I){if(I.rows.length){var J=bb(I.rows.item(0).metadata);D(null,J.rev_tree)}else{D(eP(bZ))}})})},s._doCompaction=function(E,D,F){return D.length?void A.transaction(function(H){var G="SELECT json AS metadata FROM "+dp+" WHERE id = ?";H.executeSql(G,[E],function(I,K){var L=bb(K.rows.item(0).metadata);jz(L.rev_tree,function(N,P,M,O,R){var Q=P+"-"+M;-1!==D.indexOf(Q)&&(R.status="missing")});var J="UPDATE "+dp+" SET json = ? WHERE id = ?";I.executeSql(J,[jA(L),E])}),dS(D,E,H)},jp(F),function(){F()}):F()},s._getLocal=function(E,D){A.readTransaction(function(G){var F="SELECT json, rev FROM "+eH+" WHERE id=?";G.executeSql(F,[E],function(I,K){if(K.rows.length){var H=K.rows.item(0),J=eQ(H.json,E,H.rev);D(null,J)}else{D(eP(bZ))}})})},s._putLocal=function(K,E,I){function G(M){var O,N;J?(O="UPDATE "+eH+" SET rev=?, json=? WHERE id=? AND rev=?",N=[H,D,L,J]):(O="INSERT INTO "+eH+" (id, rev, json) VALUES (?,?,?)",N=[L,H,D]),M.executeSql(O,N,function(Q,P){P.rowsAffected?(F={ok:!0,id:L,rev:H},E.ctx&&I(null,F)):I(eP(dd))},function(){return I(eP(dd)),!1})}"function"==typeof E&&(I=E,E={}),delete K._revisions;var H,J=K._rev,L=K._id;H=J?K._rev="0-"+(parseInt(J.split("-")[1],10)+1):K._rev="0-1";var F,D=jN(K);E.ctx?G(E.ctx):A.transaction(G,jp(I),function(){F&&I(null,F)})},s._removeLocal=function(F,D,H){function E(I){var K="DELETE FROM "+eH+" WHERE id=? AND rev=?",J=[F._id,F._rev];I.executeSql(K,J,function(L,M){return M.rowsAffected?(G={ok:!0,id:F._id,rev:"0-0"},void (D.ctx&&H(null,G))):H(eP(bZ))})}"function"==typeof D&&(H=D,D={});var G;D.ctx?E(D.ctx):A.transaction(E,jp(H),function(){G&&H(null,G)})},s._destroy=function(E,D){c2.Changes.removeAllListeners(s._name),A.transaction(function(G){var F=[dp,fC,du,fM,eH,cb];F.forEach(function(H){G.executeSql("DROP TABLE IF EXISTS "+H,[])})},jp(D),function(){aa()&&(delete window.localStorage["_pouch__websqldb_"+s._name],delete window.localStorage[s._name]),D(null,{ok:!0})})}}function eT(g,i,h){try{g.apply(i,h)}catch(j){"undefined"!=typeof PouchDB&&PouchDB.emit("error",j)}}function cL(){if(!eC.running&&eC.queue.length){eC.running=!0;var g=eC.queue.shift();g.action(function(h,i){eT(g.callback,this,[h,i]),eC.running=!1,cI.nextTick(cL)})}}function ap(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(eP(aV,i,h.type))}}function jZ(g,i,h){return{data:jA(g),winningRev:i,deletedOrLocal:h?"1":"0",seq:g.seq,id:g.id}}function c1(h){if(!h){return null}var g=bb(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function e3(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function jL(g,i,h,j){h?j(g?"string"!=typeof g?g:by(g,i):di([""],{type:i})):g?"string"!=typeof g?jY(g,function(k){j(ax(k))}):j(g):j("")}function jT(i,k,l,m){function j(){++h===n.length&&m&&m()}function g(s,q){var r=s._attachments[q],p=r.digest,o=l.objectStore(ep).get(p);o.onsuccess=function(u){r.body=u.target.result.body,j()}}var n=Object.keys(i._attachments||{});if(!n.length){return m&&m()}var h=0;n.forEach(function(o){k.attachments&&k.include_docs?g(i,o):(i._attachments[o].stub=!0,j())})}function bg(h,g){return eD.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return eD.all(j.map(function(l){var n=i.doc._attachments[l];if("body" in n){var k=n.body,m=n.content_type;return new eD(function(o){jL(k,m,g,function(p){i.doc._attachments[l]=ca.extend(jm(n,["digest","content_type"]),{data:p}),o()})})}}))}}))}function eX(k,m,i){function g(){n--,n||h()}function h(){j.length&&j.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||o["delete"](q)}})}var j=[],l=i.objectStore(ju),o=i.objectStore(ep),p=i.objectStore(eG),n=k.length;k.forEach(function(s){var r=l.index("_doc_id_rev"),q=m+"::"+s;r.getKey(q).onsuccess=function(u){var w=u.target.result;if("number"!=typeof w){return g()}l["delete"](w);var v=p.index("seq").openCursor(IDBKeyRange.only(w));v.onsuccess=function(x){var z=x.target.result;if(z){var y=z.value.digestSeq.split("::")[0];j.push(y),p["delete"](z.primaryKey),z["continue"]()}else{g()}}}})}function cw(g,i,h){try{return{txn:g.transaction(i,h)}}catch(j){return{error:j}}}function jK(B,O,z,x,G,K,E){function N(){var Q=[fP,ju,ep,d7,eF,eG],P=cw(G,Q,"readwrite");return P.error?E(P.error):(I=P.txn,I.onabort=ap(E),I.ontimeout=ap(E),I.oncomplete=i,s=I.objectStore(fP),F=I.objectStore(ju),D=I.objectStore(ep),m=I.objectStore(eG),void g(function(R){return R?(j=!0,E(R)):void A()}))}function L(){fB(B.revs_limit,o,x,n,I,l,y,z)}function A(){function U(){++P===o.length&&L()}function S(W){var X=c1(W.target.result);X&&n.set(X.id,X),U()}if(o.length){for(var P=0,T=0,V=o.length;V>T;T++){var R=o[T];if(R._id&&c4(R._id)){U()}else{var Q=s.get(R.metadata.id);Q.onsuccess=S}}}}function i(){j||(K.notify(x._meta.name),x._meta.docCount+=C,E(null,l))}function w(Q,P){var R=D.get(Q);R.onsuccess=function(T){if(T.target.result){P()}else{var S=eP(dB,"unknown stub attachment with digest "+Q);S.status=412,P(S)}}}function g(R){function P(){++S===T.length&&R(Q)}var T=[];if(o.forEach(function(U){U.data&&U.data._attachments&&Object.keys(U.data._attachments).forEach(function(W){var V=U.data._attachments[W];V.stub&&T.push(V.digest)})}),!T.length){return R()}var Q,S=0;T.forEach(function(U){w(U,function(V){V&&!Q&&(Q=V),P()})})}function y(V,P,T,R,S,U,X,Q){C+=U,V.metadata.winningRev=P,V.metadata.deleted=T;var Y=V.data;Y._id=V.metadata.id,Y._rev=V.metadata.rev,R&&(Y._deleted=!0);var W=Y._attachments&&Object.keys(Y._attachments).length;return W?q(V,P,T,S,X,Q):void p(V,P,T,S,X,Q)}function M(Q){var P=bY(Q.metadata);eX(P,Q.metadata.id,I)}function p(Z,S,V,U,X,Q){function T(ao){U&&x.auto_compaction&&M(Z),W.seq=ao.target.result,delete W.rev;var an=jZ(W,S,V),ai=s.put(an);ai.onsuccess=P}function R(an){an.preventDefault(),an.stopPropagation();var ai=F.index("_doc_id_rev"),ao=ai.getKey(Y._doc_id_rev);ao.onsuccess=function(at){var ar=F.put(Y,at.target.result);ar.onsuccess=T}}function P(){l[X]={ok:!0,id:W.id,rev:S},n.set(Z.metadata.id,Z.metadata),H(Z,W.seq,Q)}var Y=Z.data,W=Z.metadata;Y._doc_id_rev=W.id+"::"+W.rev,delete Y._id,delete Y._rev;var ae=F.put(Y);ae.onsuccess=T,ae.onerror=R}function q(X,Q,U,S,T,V){function Z(){Y===W.length&&p(X,Q,U,S,T,V)}function R(){Y++,Z()}var P=X.data,Y=0,W=Object.keys(P._attachments);W.forEach(function(an){var ae=X.data._attachments[an];if(ae.stub){Y++,Z()}else{var ai=ae.data;delete ae.data;var ao=ae.digest;h(ao,ai,R)}})}function H(U,R,W){function T(){++Q===P.length&&W()}function V(Z){var Y=U.data._attachments[Z].digest,X=m.put({seq:R,digestSeq:Y+"::"+R});X.onsuccess=T,X.onerror=function(ae){ae.preventDefault(),ae.stopPropagation(),T()}}var Q=0,P=Object.keys(U.data._attachments||{});if(!P.length){return W()}for(var S=0;S<P.length;S++){V(P[S])}}function h(R,P,S){var Q=D.count(R);Q.onsuccess=function(U){var V=U.target.result;if(V){return S()}var T={digest:R,body:P},W=D.put(T);W.onsuccess=S}}for(var I,s,F,D,m,v,o=O.docs,C=0,k=0,J=o.length;J>k;k++){var r=o[k];r._id&&c4(r._id)||(r=o[k]=bh(r,z.new_edits),r.error&&!v&&(v=r))}if(v){return E(v)}var l=new Array(o.length),n=new ak.Map,j=!1,u=x._meta.blobSupport?"blob":"base64";aW(o,u,function(P){return P?E(P):void N()})}function dW(i,l,k,h,j){try{if(i&&l){return j?IDBKeyRange.bound(l,i,!k,!1):IDBKeyRange.bound(i,l,!1,!k)}if(i){return j?IDBKeyRange.upperBound(i):IDBKeyRange.lowerBound(i)}if(l){return j?IDBKeyRange.lowerBound(l,!k):IDBKeyRange.upperBound(l,!k)}if(h){return IDBKeyRange.only(h)}}catch(g){return{error:g}}return null}function dz(g,i,h,j){return"DataError"===h.name&&0===h.code?j(null,{total_rows:g._meta.docCount,offset:i.skip,rows:[]}):void j(eP(aV,h.name,h.message))}function fQ(i,l,k,h){function j(r,u){function I(N,M,O){var L=N.id+"::"+O;D.get(L).onsuccess=function(P){M.doc=e3(P.target.result),r.conflicts&&(M.doc._conflicts=jC(N)),jT(M.doc,r,n)}}function v(P,M,L){var O={id:L.id,key:L.id,value:{rev:M}},N=L.deleted;if("ok"===r.deleted){m.push(O),N?(O.value.deleted=!0,O.doc=null):r.include_docs&&I(L,O,M)}else{if(!N&&B--<=0&&(m.push(O),r.include_docs&&I(L,O,M),0===--z)){return}}P["continue"]()}function H(O){K=l._meta.docCount;var M=O.target.result;if(M){var N=c1(M.value),L=N.winningRev;v(M,L,N)}}function E(){u(null,{total_rows:K,offset:r.skip,rows:m})}function q(){r.attachments?bg(m,r.binary).then(E):E()}var G="startkey" in r?r.startkey:!1,s="endkey" in r?r.endkey:!1,J="key" in r?r.key:!1,B=r.skip||0,z="number"==typeof r.limit?r.limit:-1,o=r.inclusive_end!==!1,A="descending" in r&&r.descending?"prev":null,F=dW(G,s,o,J,A);if(F&&F.error){return dz(l,r,F.error,u)}var C=[fP,ju];r.attachments&&C.push(ep);var y=cw(k,C,"readonly");if(y.error){return u(y.error)}var n=y.txn,x=n.objectStore(fP),w=n.objectStore(ju),p=A?x.openCursor(F,A):x.openCursor(F),D=w.index("_doc_id_rev"),m=[],K=0;n.oncomplete=q,p.onsuccess=H}function g(m,n){return 0===m.limit?n(null,{total_rows:l._meta.docCount,offset:m.skip,rows:[]}):void j(m,n)}g(i,h)}function af(g){return new eD(function(h){var i=di([""]);g.objectStore(eI).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function c3(g,i){var h=this;eC.queue.push({action:function(j){ay(h,g,j)},callback:i}),cL()}function ay(i,u,l){function n(w){var v=w.createObjectStore(fP,{keyPath:"id"});w.createObjectStore(ju,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),w.createObjectStore(ep,{keyPath:"digest"}),w.createObjectStore(d7,{keyPath:"id",autoIncrement:!1}),w.createObjectStore(eI),v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),w.createObjectStore(eF,{keyPath:"_id"});var x=w.createObjectStore(eG,{autoIncrement:!0});x.createIndex("seq","seq"),x.createIndex("digestSeq","digestSeq",{unique:!0})}function p(w,v){var x=w.objectStore(fP);x.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=cW(y);y.deletedOrLocal=A?"1":"0",x.put(y),B["continue"]()}else{v()}}}function k(v){v.createObjectStore(eF,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function s(x,y){var v=x.objectStore(eF),w=x.objectStore(fP),z=x.objectStore(ju),A=w.openCursor();A.onsuccess=function(J){var G=J.target.result;if(G){var M=G.value,D=M.id,C=c4(D),L=jD(M);if(C){var I=D+"::"+L,F=D+"::",K=D+"::~",H=z.index("_doc_id_rev"),E=IDBKeyRange.bound(F,K,!1,!1),B=H.openCursor(E);B.onsuccess=function(N){if(B=N.target.result){var O=B.value;O._doc_id_rev===I&&v.put(O),z["delete"](B.primaryKey),B["continue"]()}else{w["delete"](G.primaryKey),G["continue"]()}}}else{G["continue"]()}}else{y&&y()}}}function o(w){var v=w.createObjectStore(eG,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function j(x,y){var v=x.objectStore(ju),w=x.objectStore(ep),z=x.objectStore(eG),A=w.count();A.onsuccess=function(B){var C=B.target.result;return C?void (v.openCursor().onsuccess=function(H){var D=H.target.result;if(!D){return y()}for(var M=D.value,F=D.primaryKey,J=Object.keys(M._attachments||{}),L={},K=0;K<J.length;K++){var I=M._attachments[J[K]];L[I.digest]=!0}var G=Object.keys(L);for(K=0;K<G.length;K++){var E=G[K];z.put({seq:F,digestSeq:E+"::"+F})}D["continue"]()}):y()}}function h(v){function x(A){return A.data?c1(A):(A.deleted="1"===A.deletedOrLocal,A)}var y=v.objectStore(ju),z=v.objectStore(fP),w=z.openCursor();w.onsuccess=function(C){function B(){var H=A.id+"::",F=A.id+"::￿",G=y.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,E()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function E(){var G=jZ(A,A.winningRev,A.deleted),F=z.put(G);F.onsuccess=function(){D["continue"]()}}var D=C.target.result;if(D){var A=x(D.value);return A.winningRev=A.winningRev||jD(A),A.seq?E():void B()}}}var m=u.name,g=null;i._meta=null,i.type=function(){return"idb"},i._id=fD(function(v){v(null,i._meta.instanceId)}),i._bulkDocs=function(x,v,w){jK(u,x,v,i,g,c3.Changes,w)},i._get=function(x,B,w){function D(){w(y,{doc:v,metadata:A,ctx:C})}var v,A,y,C=B.ctx;if(!C){var z=cw(g,[fP,ju,ep],"readonly");if(z.error){return w(z.error)}C=z.txn}C.objectStore(fP).get(x).onsuccess=function(E){if(A=c1(E.target.result),!A){return y=eP(bZ,"missing"),D()}if(cW(A)&&!B.rev){return y=eP(bZ,"deleted"),D()}var G=C.objectStore(ju),H=B.rev||A.winningRev,F=A.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return v=I.target.result,v&&(v=e3(v)),v?void D():(y=eP(bZ,"missing"),D())}}},i._getAttachment=function(w,y,A){var z;if(y.ctx){z=y.ctx}else{var x=cw(g,[fP,ju,ep],"readonly");if(x.error){return A(x.error)}z=x.txn}var v=w.digest,B=w.content_type;z.objectStore(ep).get(v).onsuccess=function(C){var D=C.target.result.body;jL(D,B,y.binary,function(E){A(null,E)})}},i._info=function(y){if(null===g||!da[m]){var z=new Error("db isn't open");return z.id="idbNull",y(z)}var A,x,v=cw(g,[ju],"readonly");if(v.error){return y(v.error)}var B=v.txn,w=B.objectStore(ju).openCursor(null,"prev");w.onsuccess=function(D){var C=D.target.result;A=C?C.key:0,x=i._meta.docCount},B.oncomplete=function(){y(null,{doc_count:x,update_seq:A,idb_attachment_format:i._meta.blobSupport?"binary":"base64"})}},i._allDocs=function(v,w){fQ(v,i,g,w)},i._changes=function(J){function I(Q){function T(){return N.seq!==O?Q["continue"]():(H=O,N.winningRev===P._rev?S(P):void R())}function R(){var U=P._id+"::"+N.winningRev,V=K.get(U);V.onsuccess=function(W){S(e3(W.target.result))}}function S(V){var W=J.processChange(V,N,J);W.seq=N.seq;var U=G(W);return"object"==typeof U?J.complete(U):(U&&(C++,E&&z.push(W),J.attachments&&J.include_docs?jT(V,J,B,function(){bg([W],J.binary).then(function(){J.onChange(W)})}):J.onChange(W)),void (C!==M&&Q["continue"]()))}var P=e3(Q.value),O=Q.key;if(w&&!w.has(P._id)){return Q["continue"]()}var N;return(N=y.get(P._id))?T():void (x.get(P._id).onsuccess=function(U){N=c1(U.target.result),y.set(P._id,N),T()})}function D(N){var O=N.target.result;O&&I(O)}function F(){var P=[fP,ju];J.attachments&&P.push(ep);var O=cw(g,P,"readonly");if(O.error){return J.complete(O.error)}B=O.txn,B.onabort=ap(J.complete),B.oncomplete=v,A=B.objectStore(ju),x=B.objectStore(fP),K=A.index("_doc_id_rev");var N;N=J.descending?A.openCursor(null,"prev"):A.openCursor(IDBKeyRange.lowerBound(J.since,!0)),N.onsuccess=D}function v(){function N(){J.complete(null,{results:z,last_seq:H})}!J.continuous&&J.attachments?bg(z).then(N):N()}if(J=aO(J),J.continuous){var L=m+":"+jr();return c3.Changes.addListener(m,L,i,J),c3.Changes.notify(m),{cancel:function(){c3.Changes.removeListener(m,L)}}}var w=J.doc_ids&&new ak.Set(J.doc_ids);J.since=J.since||0;var H=J.since,M="limit" in J?J.limit:-1;0===M&&(M=1);var E;E="return_docs" in J?J.return_docs:"returnDocs" in J?J.returnDocs:!0;var B,A,x,K,z=[],C=0,G=jQ(J),y=new ak.Map;F()},i._close=function(v){return null===g?v(eP(df)):(g.close(),delete da[m],g=null,void v())},i._getRevisionTree=function(v,x){var y=cw(g,[fP],"readonly");if(y.error){return x(y.error)}var z=y.txn,w=z.objectStore(fP).get(v);w.onsuccess=function(B){var A=c1(B.target.result);A?x(null,A.rev_tree):x(eP(bZ))}},i._doCompaction=function(w,y,A){var z=[fP,ju,ep,eG],x=cw(g,z,"readwrite");if(x.error){return A(x.error)}var v=x.txn,B=v.objectStore(fP);B.get(w).onsuccess=function(E){var C=c1(E.target.result);jz(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==y.indexOf(I)&&(J.status="missing")}),eX(y,w,v);var D=C.winningRev,F=C.deleted;v.objectStore(fP).put(jZ(C,D,F))},v.onabort=ap(A),v.oncomplete=function(){A()}},i._getLocal=function(v,x){var y=cw(g,[eF],"readonly");if(y.error){return x(y.error)}var z=y.txn,w=z.objectStore(eF).get(v);w.onerror=ap(x),w.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,x(null,A)):x(eP(bZ))}},i._putLocal=function(E,z,D){"function"==typeof z&&(D=z,z={}),delete E._revisions;var B=E._rev,C=E._id;B?E._rev="0-"+(parseInt(B.split("-")[1],10)+1):E._rev="0-1";var x,w=z.ctx;if(!w){var A=cw(g,[eF],"readwrite");if(A.error){return D(A.error)}w=A.txn,w.onerror=ap(D),w.oncomplete=function(){x&&D(null,x)}}var y,v=w.objectStore(eF);B?(y=v.get(C),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===B){var F=v.put(E);F.onsuccess=function(){x={ok:!0,id:E._id,rev:E._rev},z.ctx&&D(null,x)}}else{D(eP(dd))}}):(y=v.add(E),y.onerror=function(F){D(eP(dd)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){x={ok:!0,id:E._id,rev:E._rev},z.ctx&&D(null,x)})},i._removeLocal=function(x,B,w){"function"==typeof B&&(w=B,B={});var D=B.ctx;if(!D){var v=cw(g,[eF],"readwrite");if(v.error){return w(v.error)}D=v.txn,D.oncomplete=function(){A&&w(null,A)}}var A,y=x._id,C=D.objectStore(eF),z=C.get(y);z.onerror=ap(w),z.onsuccess=function(F){var E=F.target.result;E&&E._rev===x._rev?(C["delete"](y),A={ok:!0,id:y,rev:"0-0"},B.ctx&&w(null,A)):w(eP(bZ))}},i._destroy=function(w,v){c3.Changes.removeAllListeners(m),c3.openReqList[m]&&c3.openReqList[m].result&&(c3.openReqList[m].result.close(),delete da[m]);var x=indexedDB.deleteDatabase(m);x.onsuccess=function(){c3.openReqList[m]&&(c3.openReqList[m]=null),aa()&&m in localStorage&&delete localStorage[m],v(null,{ok:!0})},x.onerror=ap(v)};var q=da[m];if(q){return g=q.idb,i._meta=q.global,void cI.nextTick(function(){l(null,i)})}var r;r=u.storage?eZ(m,u.storage):indexedDB.open(m,dx),"openReqList" in c3||(c3.openReqList={}),c3.openReqList[m]=r,r.onupgradeneeded=function(x){function v(){var B=z[A-1];A++,B&&B(w,v)}var y=x.target.result;if(x.oldVersion<1){return n(y)}var w=x.currentTarget.transaction;x.oldVersion<3&&k(y),x.oldVersion<4&&o(y);var z=[p,s,j,h],A=x.oldVersion;v()},r.onsuccess=function(w){g=w.target.result,g.onversionchange=function(){g.close(),delete da[m]},g.onabort=function(B){console.error("Database has a global failure",B.target.error),g.close(),delete da[m]};var v=g.transaction([d7,eI,fP],"readwrite"),z=v.objectStore(d7).get(d7),y=null,x=null,A=null;z.onsuccess=function(D){var B=function(){null!==y&&null!==x&&null!==A&&(i._meta={name:m,instanceId:A,blobSupport:y,docCount:x},da[m]={idb:g,global:i._meta},l(null,i))},E=D.target.result||{id:d7};m+"_id" in E?(A=E[m+"_id"],B()):(A=jr(),E[m+"_id"]=A,v.objectStore(d7).put(E).onsuccess=function(){B()}),j2||(j2=af(v)),j2.then(function(F){y=F,B()});var C=v.objectStore(fP).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){x=F.target.result,B()}}},r.onerror=function(w){var v="Failed to open indexedDB, are you in private browsing mode?";console.error(v),l(eP(aV,v))}}function eZ(g,i){try{return indexedDB.open(g,{version:dx,storage:i})}catch(h){return indexedDB.open(g,dx)}}var ca=f(7),cF="default" in ca?ca["default"]:ca,eb=f(6);eb="default" in eb?eb["default"]:eb;var ak=f(12);ak="default" in ak?ak["default"]:ak;var bL=f(4),j1=f(1);j1="default" in j1?j1["default"]:j1;var bd=f(2);bd="default" in bd?bd["default"]:bd;var dQ=f(10),aA="default" in dQ?dQ["default"]:dQ,bm=f(8);bm="default" in bm?bm["default"]:bm;var cC=f(14);cC="default" in cC?cC["default"]:cC;var fJ=f(15);fJ="default" in fJ?fJ["default"]:fJ;var aT=f(16);aT="default" in aT?aT["default"]:aT;var eD="function"==typeof Promise?Promise:bm,eE=jG();eb(ba,Error),ba.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var aZ=new ba({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),jq=new ba({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),bZ=new ba({status:404,error:"not_found",reason:"missing"}),dd=new ba({status:409,error:"conflict",reason:"Document update conflict"}),fN=new ba({status:400,error:"invalid_id",reason:"_id field must contain a string"}),ab=new ba({status:412,error:"missing_id",reason:"_id is required for puts"}),ec=new ba({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),df=new ba({status:412,error:"precondition_failed",reason:"Database not open"}),dM=new ba({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),bS=new ba({status:500,error:"badarg",reason:"Some query argument is invalid"}),cJ=new ba({status:400,error:"invalid_request",reason:"Request was invalid"}),aI=new ba({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),cH=new ba({status:500,error:"doc_validation",reason:"Bad special document member"}),fL=new ba({status:400,error:"bad_request",reason:"Something wrong with the request"}),fO=new ba({status:400,error:"bad_request",reason:"Document must be a JSON object"}),dv=new ba({status:404,error:"not_found",reason:"Database not found"}),aV=new ba({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ck=new ba({status:500,error:"web_sql_went_bad",reason:"unknown"}),eN=new ba({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),bD=new ba({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),cy=new ba({status:400,error:"bad_request",reason:"Invalid rev format"}),aD=new ba({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),dB=new ba({status:412,error:"missing_stub"}),e2=new ba({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cp={UNAUTHORIZED:aZ,MISSING_BULK_DOCS:jq,MISSING_DOC:bZ,REV_CONFLICT:dd,INVALID_ID:fN,MISSING_ID:ab,RESERVED_ID:ec,NOT_OPEN:df,UNKNOWN_ERROR:dM,BAD_ARG:bS,INVALID_REQUEST:cJ,QUERY_PARSE_ERROR:aI,DOC_VALIDATION:cH,BAD_REQUEST:fL,NOT_AN_OBJECT:fO,DB_MISSING:dv,WSQ_ERROR:ck,LDB_ERROR:eN,FORBIDDEN:bD,INVALID_REV:cy,FILE_EXISTS:aD,MISSING_STUB:dB,IDB_ERROR:aV,INVALID_URL:e2},cz=function(h,k,j){var g=Object.keys(cp).filter(function(m){var l=cp[m];return"function"!=typeof l&&l[h]===k}),i=j&&g.filter(function(m){var l=cp[m];return l.message===j})[0]||g[0];return i?cp[i]:null},aS=function(){},jx=bd("pouchdb:api");eb(jW,bL.EventEmitter),jW.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},jW.prototype.doChanges=function(h){var k=this,j=h.complete;if(h=aO(h),"live" in h&&!("continuous" in h)&&(h.continuous=h.live),h.processChange=cE,"latest"===h.since&&(h.since="now"),h.since||(h.since=0),"now"===h.since){return void this.db.info().then(function(l){return k.isCancelled?void j(null,{status:"cancelled"}):(h.since=l.update_seq,void k.doChanges(h))},j)}if(h.continuous&&"now"!==h.since&&this.db.info().then(function(l){k.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),h.filter&&"string"==typeof h.filter&&("_view"===h.filter?h.view=jR(h.view):h.filter=jR(h.filter),"http"!==this.db.type()&&!h.doc_ids)){return this.filterChanges(h)}"descending" in h||(h.descending=!1),h.limit=0===h.limit?1:h.limit,h.complete=j;var g=this.db._changes(h);if(g&&"function"==typeof g.cancel){var i=k.cancel;k.cancel=j1(function(l){g.cancel(),i.apply(this,l)})}},jW.prototype.filterChanges=function(i){var l=this,k=i.complete;if("_view"===i.filter){if(!i.view||"string"!=typeof i.view){var h=eP(fL,"`view` filter parameter not found or invalid.");return k(h)}var j=jo(i.view);this.db.get("_design/"+j[0],function(o,n){if(l.isCancelled){return k(null,{status:"cancelled"})}if(o){return k(ea(o))}var m=n&&n.views&&n.views[j[1]]&&n.views[j[1]].map;return m?(i.filter=al(m),void l.doChanges(i)):k(eP(bZ,n.views?"missing json key: "+j[1]:"missing json key: views"))})}else{var g=jo(i.filter);if(!g){return l.doChanges(i)}this.db.get("_design/"+g[0],function(m,n){if(l.isCancelled){return k(null,{status:"cancelled"})}if(m){return k(ea(m))}var o=n&&n.filters&&n.filters[g[1]];return o?(i.filter=cG(o),void l.doChanges(i)):k(eP(bZ,n&&n.filters?"missing json key: "+g[1]:"missing json key: filters"))})}};var ac="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),eA=jB(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cN=jB(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);eb(eS,bL.EventEmitter),eS.prototype.post=d6("post",function(g,i,h){return"function"==typeof i&&(h=i,i={}),"object"!=typeof g||Array.isArray(g)?h(eP(fO)):void this.bulkDocs({docs:[g]},i,cB(h))}),eS.prototype.put=d6("put",j1(function(k){var i,g,j,l,m=k.shift(),h="_id" in m;if("object"!=typeof m||Array.isArray(m)){return(l=k.pop())(eP(fO))}for(;;){if(i=k.shift(),g=typeof i,"string"!==g||h?"string"!==g||!h||"_rev" in m?"object"===g?j=i:"function"===g&&(l=i):m._rev=i:(m._id=i,h=!0),!k.length){break}}return j=j||{},jU(m._id),c4(m._id)&&"function"==typeof this._putLocal?m._deleted?this._removeLocal(m,l):this._putLocal(m,l):void this.bulkDocs({docs:[m]},j,cB(l))})),eS.prototype.putAttachment=d6("putAttachment",function(i,k,l,m,j,g){function n(o){return o._attachments=o._attachments||{},o._attachments[k]={content_type:j,data:m},h.put(o)}var h=this;return"function"==typeof j&&(g=j,j=m,m=l,l=null),"undefined"==typeof j&&(j=m,m=l,l=null),h.get(i).then(function(o){if(o._rev!==l){throw eP(dd)}return n(o)},function(o){if(o.reason===bZ.message){return n({_id:i})}throw o})}),eS.prototype.removeAttachment=d6("removeAttachment",function(h,k,j,g){var i=this;i.get(h,function(m,l){return m?void g(m):l._rev!==j?void g(eP(dd)):l._attachments?(delete l._attachments[k],0===Object.keys(l._attachments).length&&delete l._attachments,void i.put(l,g)):g()})}),eS.prototype.remove=d6("remove",function(i,l,k,h){var j;"string"==typeof l?(j={_id:i,_rev:l},"function"==typeof k&&(h=k,k={})):(j=i,"function"==typeof l?(h=l,k={}):(h=k,k=l)),k=k||{},k.was_delete=!0;var g={_id:j._id,_rev:j._rev||k.rev};return g._deleted=!0,c4(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(j,h):void this.bulkDocs({docs:[g]},k,cB(h))}),eS.prototype.revsDiff=d6("revsDiff",function(i,k,l){function m(o,p){h.has(o)||h.set(o,{missing:[]}),h.get(o).missing.push(p)}function j(q,p){var o=i[q].slice(0);jz(p,function(s,r,x,v,w){var y=r+"-"+x,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==w.status&&m(q,y))}),o.forEach(function(r){m(q,r)})}"function"==typeof k&&(l=k,k={});var g=Object.keys(i);if(!g.length){return l(null,{})}var n=0,h=new ak.Map;g.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){h.set(o,{missing:i[o]})}else{if(q){return l(q)}j(o,p)}if(++n===g.length){var r={};return h.forEach(function(u,s){r[s]=u}),l(null,r)}})},this)}),eS.prototype.bulkGet=d6("bulkGet",function(h,g){bk(this,h,g)}),eS.prototype.compactDocument=d6("compactDocument",function(g,i,h){var j=this;this._getRevisionTree(g,function(n,l){if(n){return h(n)}var o=e8(l),m=[],k=[];Object.keys(o).forEach(function(p){o[p]>i&&m.push(p)}),jz(l,function(q,v,s,p,r){var u=v+"-"+s;"available"===r.status&&-1!==m.indexOf(u)&&k.push(u)}),j._doCompaction(g,k,h)})}),eS.prototype.compact=d6("compact",function(g,i){"function"==typeof g&&(i=g,g={});var h=this;g=g||{},h._compactionQueue=h._compactionQueue||[],h._compactionQueue.push({opts:g,callback:i}),1===h._compactionQueue.length&&d0(h)}),eS.prototype._compact=function(k,i){function g(n){h.push(l.compactDocument(n.id,0))}function j(o){var n=o.last_seq;eD.all(h).then(function(){return e(l,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){i(null,{ok:!0})})["catch"](i)}var l=this,m={return_docs:!1,last_seq:k.last_seq||0},h=[];l.changes(m).on("change",g).on("complete",j).on("error",i)},eS.prototype.get=d6("get",function(i,k,l){function m(){var o=[],p=j.length;return p?void j.forEach(function(q){g.get(i,{rev:q,revs:k.revs,attachments:k.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||l(null,o)})}):l(null,o)}if("function"==typeof k&&(l=k,k={}),"string"!=typeof i){return l(eP(fN))}if(c4(i)&&"function"==typeof this._getLocal){return this._getLocal(i,l)}var j=[],g=this;if(!k.open_revs){return this._get(i,k,function(B,o){if(B){return l(B)}var s=o.doc,p=o.metadata,v=o.ctx;if(k.conflicts){var y=jC(p);y.length&&(s._conflicts=y)}if(cW(p,s._rev)&&(s._deleted=!0),k.revs||k.revs_info){var r=jS(p.rev_tree),A=dj(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(s._rev.split("-")[1])}),x=A.ids.map(function(D){return D.id}).indexOf(s._rev.split("-")[1])+1,C=A.ids.length-x;if(A.ids.splice(x,C),A.ids.reverse(),k.revs&&(s._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),k.revs_info){var u=A.pos+A.ids.length;s._revs_info=A.ids.map(function(D){return u--,{rev:u+"-"+D.id,status:D.opts.status}})}}if(k.attachments&&s._attachments){var q=s._attachments,w=Object.keys(q).length;if(0===w){return l(null,s)}Object.keys(q).forEach(function(D){this._getAttachment(q[D],{binary:k.binary,ctx:v},function(F,G){var E=s._attachments[D];E.data=G,delete E.stub,delete E.length,--w||l(null,s)})},g)}else{if(s._attachments){for(var z in s._attachments){s._attachments.hasOwnProperty(z)&&(s._attachments[z].stub=!0)}}l(null,s)}})}if("all"===k.open_revs){this._getRevisionTree(i,function(o,p){return o?l(o):(j=dY(p).map(function(q){return q.rev}),void m())})}else{if(!Array.isArray(k.open_revs)){return l(eP(dM,"function_clause"))}j=k.open_revs;for(var n=0;n<j.length;n++){var h=j[n];if("string"!=typeof h||!/^\d+-/.test(h)){return l(eP(cy))}}m()}}),eS.prototype.getAttachment=d6("getAttachment",function(h,k,j,g){var i=this;j instanceof Function&&(g=j,j={}),this._get(h,j,function(m,l){return m?g(m):l.doc._attachments&&l.doc._attachments[k]?(j.ctx=l.ctx,j.binary=!0,i._getAttachment(l.doc._attachments[k],j,g),void 0):g(eP(bZ))})}),eS.prototype.allDocs=d6("allDocs",function(g,i){if("function"==typeof g&&(i=g,g={}),g.skip="undefined"!=typeof g.skip?g.skip:0,g.start_key&&(g.startkey=g.start_key),g.end_key&&(g.endkey=g.end_key),"keys" in g){if(!Array.isArray(g.keys)){return i(new TypeError("options.keys must be an array"))}var h=["startkey","endkey","key"].filter(function(j){return j in g})[0];if(h){return void i(eP(aI,"Query parameter `"+h+"` is not compatible with multi-get"))}if("http"!==this.type()){return bT(this,g,i)}}return this._allDocs(g,i)}),eS.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new jW(this,h,g)},eS.prototype.close=d6("close",function(g){return this._closed=!0,this._close(g)}),eS.prototype.info=d6("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),eS.prototype.id=d6("id",function(g){return this._id(g)}),eS.prototype.bulkDocs=d6("bulkDocs",function(h,k,j){if("function"==typeof k&&(j=k,k={}),k=k||{},Array.isArray(h)&&(h={docs:h}),!h||!h.docs||!Array.isArray(h.docs)){return j(eP(jq))}for(var g=0;g<h.docs.length;++g){if("object"!=typeof h.docs[g]||Array.isArray(h.docs[g])){return j(eP(fO))}}var i;return h.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){i=i||bw(m)})}),i?j(eP(fL,i)):("new_edits" in k||("new_edits" in h?k.new_edits=h.new_edits:k.new_edits=!0),k.new_edits||"http"===this.type()||h.docs.sort(d4),aL(h.docs),this._bulkDocs(h,k,function(m,l){return m?j(m):(k.new_edits||(l=l.filter(function(n){return n.error})),void j(null,l))}))}),eS.prototype.registerDependentDatabase=d6("registerDependentDatabase",function(g,i){function h(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[g]?!1:(k.dependentDbs[g]=!0,k)}var j=new this.constructor(g,this.__opts);e(this,"_local/_pouch_dependentDbs",h).then(function(){i(null,{db:j})})["catch"](i)}),eS.prototype.destroy=d6("destroy",function(h,k){function j(){g._destroy(h,function(l,m){return l?k(l):(g.emit("destroyed"),void k(null,m||{ok:!0}))})}"function"==typeof h&&(k=h,h={});var g=this,i="use_prefix" in g?g.use_prefix:!0;return"http"===g.type()?j():void g.get("_local/_pouch_dependentDbs",function(o,m){if(o){return 404!==o.status?k(o):j()}var p=m.dependentDbs,n=g.constructor,l=Object.keys(p).map(function(r){var q=i?r.replace(new RegExp("^"+n.prefix),""):r;return new n(q,g.__opts).destroy()});eD.all(l).then(j,k)})}),jP.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},jP.prototype.fail=function(g){this.failed=g,this.execute()},jP.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},jP.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},eb(aR,eS),aR.debug=bd;var e9;if(jF()){e9=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),e9=!!localStorage.getItem("_pouch_check_localstorage")}catch(c7){e9=!1}}aR.adapters={},aR.preferredAdapters=[],aR.prefix="_pouch_";var cu=new bL.EventEmitter;d9(aR),aR.parseAdapter=function(i,k){var l,m,j=i.match(/([a-z\-]*):\/\/(.*)/);if(j){if(i=/http(s?)/.test(j[1])?j[1]+"://"+j[2]:j[2],l=j[1],!aR.adapters[l].valid()){throw"Invalid adapter"}return{name:i,adapter:j[1]}}var g="idb" in aR.adapters&&"websql" in aR.adapters&&aa()&&localStorage["_pouch__websqldb_"+aR.prefix+i];if(k.adapter){m=k.adapter}else{if("undefined"!=typeof k&&k.db){m="leveldb"}else{for(var n=0;n<aR.preferredAdapters.length;++n){if(m=aR.preferredAdapters[n],m in aR.adapters){if(g&&"idb"===m){console.log('PouchDB is downgrading "'+i+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}l=aR.adapters[m];var h=l&&"use_prefix" in l?l.use_prefix:!0;return{name:h?aR.prefix+i:i,adapter:m}},aR.adapter=function(g,i,h){i.valid()&&(aR.adapters[g]=i,h&&aR.preferredAdapters.push(g))},aR.plugin=function(g){return Object.keys(g).forEach(function(h){aR.prototype[h]=g[h]}),aR},aR.defaults=function(h){function g(k,i,j){return this instanceof g?(("function"==typeof i||"undefined"==typeof i)&&(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=ca.extend({},h,i),void aR.call(this,k,i,j)):new g(k,i,j)}return eb(g,aR),d9(g),g.preferredAdapters=aR.preferredAdapters.slice(),Object.keys(aR).forEach(function(i){i in g||(g[i]=aR[i])}),g};var b1=function(g){return atob(g)},ax=function(g){return btoa(g)},bM=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],eK="queryKey",ej=/(?:^|&)([^&=]*)=?([^&]*)/g,a9=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,em=cF.extend,jX={ajax:ch,parseUri:dK,uuid:jr,Promise:eD,atob:b1,btoa:ax,binaryStringToBlobOrBuffer:jE,clone:aO,extend:em,createError:eP},bQ=aA.collate,bu=1,av="pouchdb",bU=5,dU=0;jV.prototype.writeCheckpoint=function(g,i){var h=this;return this.updateTarget(g,i).then(function(){return h.updateSource(g,i)})},jV.prototype.updateTarget=function(h,g){return dO(this.target,this.id,h,g,this.returnValue)},jV.prototype.updateSource=function(g,i){var h=this;return this.readOnlySource?eD.resolve(!0):dO(this.src,this.id,g,i,this.returnValue)["catch"](function(k){var j="number"==typeof k.status&&4===Math.floor(k.status/100);if(j){return h.readOnlySource=!0,!0}throw k})};var e5={undefined:function(h,g){return 0===bQ(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return dy(g,h).last_seq}};jV.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.src.get(g.id).then(function(i){if(h.version!==i.version){return dU}var j;return j=h.version?h.version.toString():"undefined",j in e5?e5[j](h,i):dU},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:dU}).then(function(){return dU},function(j){return 401===j.status?(g.readOnlySource=!0,h.last_seq):dU})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return dU})};var dg=0,cR=c0.setImmediate||c0.setTimeout,bE=32768,cD=fD(function(k,m){function i(){var q=o*j,u=q+j;if(o++,l>o){n(p,k,q,u),cR(i)}else{n(p,k,q,u);var r=p.end(!0),s=aY(r);m(null,s),p.destroy()}}var g="string"==typeof k,h=g?k.length:k.byteLength,j=Math.min(bE,h),l=Math.ceil(h/j),o=0,p=g?new fJ:new fJ.ArrayBuffer,n=g?cS:d5;i()});eb(e6,bL.EventEmitter),e6.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},e6.prototype.ready=function(h,k){function j(){i.cancel()}function g(){h.removeListener("destroyed",j),k.removeListener("destroyed",j)}var i=this;i._readyCalled||(i._readyCalled=!0,h.once("destroyed",j),k.once("destroyed",j),i.once("complete",g))};var eB={replicate:c8,toPouch:aX},dm=eB.replicate;eb(ag,bL.EventEmitter),ag.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var bq=25,d2=50,aK={},jt=1800,dI=bd("pouchdb:http");b9.valid=function(){return !0};var aG=function(h,g){return g&&h.then(function(i){cI.nextTick(function(){g(null,i)})},function(i){cI.nextTick(function(){g(i)})}),h},cZ=function(g){return j1(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&aG(i,j),i})},cA=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},dC=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},az=function(i){for(var l={},k=0,h=i.length;h>k;k++){l["$"+i[k]]=!0}var j=Object.keys(l),g=new Array(j.length);for(k=0,h=j.length;h>k;k++){g[k]=j[k].substring(1)}return g},dw={uniq:az,sequentialize:dC,fin:cA,callbackify:cZ,promisedCallback:aG};dL.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},dL.prototype.finish=function(){return this.promise};var cx,b2=aA.collate,bK=aA.toIndexableString,eL=aA.normalizeKey,cl=aA.parseIndexableString;cx="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var d8=dw.callbackify,d3=dw.sequentialize,e4=dw.uniq,aF=dw.fin,dV=dw.promisedCallback,eO={},jw=new dL,aN=50,bx={_sum:function(h,g){return cP(g)},_count:function(h,g){return g.length},_stats:function(g,i){function h(k){for(var n=0,m=0,j=k.length;j>m;m++){var l=k[m];n+=l*l}return n}return{sum:cP(i),min:Math.min.apply(null,i),max:Math.max.apply(null,i),count:i.length,sumsqr:h(i)}}},fG=d8(function(){var g=this;return"http"===g.type()?cU(g):"function"==typeof g._viewCleanup?eJ(g):e0(g)}),fE=function(h,k,j){"function"==typeof k&&(j=k,k={}),k=k?cq(k):{},"function"==typeof h&&(h={map:h});var g=this,i=eD.resolve().then(function(){return ad(g,h,k)});return dV(i,j),i};eb(aM,Error),eb(aj,Error),eb(el,Error);var dD={query:fE,viewCleanup:fG},dN=7,dp=cV("document-store"),fC=cV("by-sequence"),du=cV("attach-store"),eH=cV("local-store"),fM=cV("metadata-store"),cb=cV("attach-seq-store"),dX={};eb(aq,bL.EventEmitter),aq.prototype.addListener=function(k,i,g,j){function l(){function n(){h=!1}if(m._listeners[i]){if(h){return void (h="waiting")}h=!0;var o=jm(j,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>j.since&&!j.cancelled&&(j.since=p.seq,j.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){l()},0),h=!1}).on("error",n)}}if(!this._listeners[i]){var m=this,h=!1;this._listeners[i]=l,this.on(k,l)}},aq.prototype.removeListener=function(h,g){g in this._listeners&&bL.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},aq.prototype.notifyLocalWindows=function(g){jF()?chrome.storage.local.set({dbName:g}):aa()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},aq.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)};var eW=1,dJ="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+fC+" (seq, deleted)",j0="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+fC+" (doc_id, rev)",jl="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+dp+" (winningseq)",js="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+cb+" (seq)",dh="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+cb+" (digest, seq)",bN=fC+".seq = "+dp+".winningseq",db=fC+".seq AS seq, "+fC+".deleted AS deleted, "+fC+".json AS data, "+fC+".rev AS rev, "+dp+".json AS metadata";c2.valid=dl,c2.Changes=new aq;var j2,dx=5,fP="document-store",ju="by-sequence",ep="attach-store",eG="attach-seq-store",d7="meta-store",eF="local-store",eI="detect-blob-support",eC={running:!1,queue:[]},da={};c3.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},c3.Changes=new aq;var eR={idb:c3,websql:c2};aR.ajax=ch,aR.utils=jX,aR.Errors=cp,aR.replicate=eB.replicate,aR.sync=cK,aR.version="5.2.0",aR.adapter("http",b9),aR.adapter("https",b9),aR.plugin(dD),Object.keys(eR).forEach(function(g){aR.adapter(g,eR[g],!0)}),d.exports=aR}).call(this,f(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});