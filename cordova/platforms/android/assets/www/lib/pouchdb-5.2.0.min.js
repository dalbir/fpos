!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(n,h){if(!l[n]){if(!b[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(k){return k(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=l[n]={exports:{}};b[n][0].call(g.exports,function(m){var p=b[n][1][m];return e(p?p:m)},g,g.exports,d,b,l,i)}return l[n].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var j="color: "+this.color;h=[h[0],j,"color: inherit"].concat(Array.prototype.slice.call(h,1));var g=0,f=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),h.splice(f,0,j),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(a,r,f){function n(){return f.colors[b++%f.colors.length]}function i(g){function j(){}function h(){var w=h,q=+new Date,v=q-(u||q);w.diff=v,w.prev=u,w.curr=q,u=q,null==w.useColors&&(w.useColors=f.useColors()),null==w.color&&w.useColors&&(w.color=n());var m=Array.prototype.slice.call(arguments);m[0]=f.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=f.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof f.formatArgs&&(m=f.formatArgs.apply(w,m));var l=h.log||f.log||console.log.bind(console);l.apply(w,m)}j.enabled=!1,h.enabled=!0;var k=f.enabled(g)?h:j;return k.namespace=g,k}function e(h){f.save(h);for(var g=(h||"").split(/[\s,]+/),j=g.length,k=0;j>k;k++){g[k]&&(h=g[k].replace(/\*/g,".*?"),"-"===h[0]?f.skips.push(new RegExp("^"+h.substr(1)+"$")):f.names.push(new RegExp("^"+h+"$")))}}function t(){f.enable("")}function o(g){var j,h;for(j=0,h=f.skips.length;h>j;j++){if(f.skips[j].test(g)){return !1}}for(j=0,h=f.names.length;h>j;j++){if(f.names[j].test(g)){return !0}}return !1}function s(g){return g instanceof Error?g.stack||g.message:g}f=r.exports=i,f.coerce=s,f.disable=t,f.enable=e,f.enabled=o,f.humanize=a(9),f.names=[],f.skips=[],f.formatters={};var u,b=0},{9:9}],4:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,l,j,r,f,h;if(this._events||(this._events={}),"error"===g&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[g],m(l)){return !1}if(o(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(p(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(f,h){function j(){this.removeListener(f,j),g||(g=!0,h.apply(this,arguments))}if(!o(h)){throw TypeError("listener must be a function")}var g=!1;return j.listener=h,this.on(f,j),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(p(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(b,e,a){(function(u){function f(){x=!0;for(var g,h,j=z.length;j;){for(h=z,z=[],g=-1;++g<j;){h[g]()}j=z.length}x=!1}function n(g){1!==z.push(g)||x||l()}var l,y=u.MutationObserver||u.WebKitMutationObserver;if(y){var s=0,o=new y(f),r=u.document.createTextNode("");o.observe(r,{characterData:!0}),l=function(){r.data=s=++s%2}}else{if(u.setImmediate||"undefined"==typeof u.MessageChannel){l="document" in u&&"onreadystatechange" in u.document.createElement("script")?function(){var g=u.document.createElement("script");g.onreadystatechange=function(){f(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},u.document.documentElement.appendChild(g)}:function(){setTimeout(f,0)}}else{var i=new u.MessageChannel;i.port1.onmessage=f,l=function(){i.port2.postMessage(0)}}}var x,z=[];e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(b,e,a){(function(f){f("object"==typeof a?a:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(n){if(n){for(var i in n){"object"==typeof n[i]&&h[i]?k.call(h,h[i],n[i]):h[i]=n[i]}}}),h};j.extend=k})},{}],8:[function(f,u,o){function s(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=p,this.queue=[],this.outcome=void 0,g!==s&&y(this,g)}function e(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function m(j,k,g){t(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function b(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(g,k){function w(A){x||(x=!0,K.reject(g,A))}function j(A){x||(x=!0,K.resolve(g,A))}function q(){k(j,w)}var x=!1,z=r(q);"error"===z.status&&w(z.value)}function r(g,k){var q={};try{q.value=g(k),q.status="success"}catch(j){q.status="error",q.value=j}return q}function i(g){return g instanceof this?g:K.resolve(new this(s),g)}function n(g){var j=new this(s);return K.reject(j,g)}function a(j){function w(E,D){function C(F){z[D]=F,++g!==q||k||(k=!0,K.resolve(B,z))}A.resolve(E).then(C,function(F){k||(k=!0,K.reject(B,F))})}var A=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var q=j.length,k=!1;if(!q){return this.resolve([])}for(var z=new Array(q),g=0,x=-1,B=new this(s);++x<q;){w(j[x],x)}return B}function l(g){function k(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(j,B))},function(B){x||(x=!0,K.reject(j,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var q=g.length,x=!1;if(!q){return this.resolve([])}for(var z=-1,j=new this(s);++z<q;){k(g[z])}return j}var t=f(5),K={},L=["REJECTED"],h=["FULFILLED"],p=["PENDING"];u.exports=o=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(j,k){if("function"!=typeof j&&this.state===h||"function"!=typeof k&&this.state===L){return this}var q=new this.constructor(s);if(this.state!==p){var g=this.state===h?j:k;m(q,g,this.outcome)}else{this.queue.push(new e(q,j,k))}return q},e.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},e.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},e.prototype.callRejected=function(g){K.reject(this.promise,g)},e.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)},K.resolve=function(j,w){var q=r(b,w);if("error"===q.status){return K.reject(j,q.value)}var k=q.value;if(k){y(j,k)}else{j.state=h,j.outcome=w;for(var g=-1,x=j.queue.length;++g<x;){j.queue[g].callFulfilled(w)}}return j},K.reject=function(g,k){g.state=L,g.outcome=k;for(var q=-1,j=g.queue.length;++q<j;){g.queue[q].callRejected(k)}return g},o.resolve=i,o.reject=n,o.all=a,o.race=l},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(h,l,D){function b(v){if(null!==v){switch(typeof v){case"boolean":return v?1:0;case"number":return n(v);case"string":return v.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var w=Array.isArray(v),q=w?v:Object.keys(v),j=-1,g=q.length,m="";if(w){for(;++j<g;){m+=D.toIndexableString(q[j])}}else{for(;++j<g;){var k=q[j];m+=D.toIndexableString(k)+D.toIndexableString(v[k])}}return m}}return""}function o(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+i),x=parseInt(v,10)+t;for(j&&(x=-x),w+=i;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function r(q,j){var w=q.pop();if(j.length){var m=j[j.length-1];w===m.element&&(j.pop(),m=j[j.length-1]);var g=m.element,v=m.index;if(Array.isArray(g)){g.push(w)}else{if(v===q.length-2){var k=q.pop();g[k]=w}else{q.push(w)}}}}function s(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=D.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(v,w){for(var q=Object.keys(v),j=Object.keys(w),g=Math.min(q.length,j.length),m=0;g>m;m++){var k=D.collate(q[m],j[m]);if(0!==k){return k}if(k=D.collate(v[q[m]],w[j[m]]),0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function p(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function n(x){if(0===x){return"1"}var q=x.toExponential().split(/e\+?/),g=parseInt(q[1],10),k=0>x,j=k?"0":"2",y=(k?-g:g)-t,w=a.padLeft(y.toString(),"0",i);j+=f+w;var m=Math.abs(parseFloat(q[0]));k&&(m=10-m);var v=m.toFixed(20);return v=v.replace(/\.?0+$/,""),j+=f+v}var t=-324,i=3,f="",a=h(11);D.collate=function(j,m){if(j===m){return 0}j=D.normalizeKey(j),m=D.normalizeKey(m);var k=p(j),g=p(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},D.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=D.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=D.normalizeKey(q))}}}}}return g},D.toIndexableString=function(g){var j="\x00";return g=D.normalizeKey(g),p(g)+f+b(g)+j},D.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=o(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}r(w,m)}}}},{11:11}],11:[function(h,b,e){function a(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var f,g=r.length,o=n.length;for(f=0;g>f;f++){if(f===o){return 1}var i=r.charAt(f),q=n.charAt(f);if(i!==q){return q>i?-1:1}}return o>g?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(o,p){var q,g,n,r;g=[],r=[];for(q in p){h.call(p,q)&&(n=p[q],"this"!==q&&(g.push(q),r.push(n)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],r)}}).call(this)},{}],15:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(y){function o(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function u(j,q,k,A,w,z,x){return o(q&k|~q&A,j,q,w,z,x)}function t(j,q,k,A,w,z,x){return o(q&A|k&~A,j,q,w,z,x)}function Q(j,q,k,A,w,z,x){return o(q^k^A,j,q,w,z,x)}function r(j,q,k,A,w,z,x){return o(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=u(z,q,x,j,w[0],7,-680876936),j=u(j,z,q,x,w[1],12,-389564586),x=u(x,j,z,q,w[2],17,606105819),q=u(q,x,j,z,w[3],22,-1044525330),z=u(z,q,x,j,w[4],7,-176418897),j=u(j,z,q,x,w[5],12,1200080426),x=u(x,j,z,q,w[6],17,-1473231341),q=u(q,x,j,z,w[7],22,-45705983),z=u(z,q,x,j,w[8],7,1770035416),j=u(j,z,q,x,w[9],12,-1958414417),x=u(x,j,z,q,w[10],17,-42063),q=u(q,x,j,z,w[11],22,-1990404162),z=u(z,q,x,j,w[12],7,1804603682),j=u(j,z,q,x,w[13],12,-40341101),x=u(x,j,z,q,w[14],17,-1502002290),q=u(q,x,j,z,w[15],22,1236535329),z=t(z,q,x,j,w[1],5,-165796510),j=t(j,z,q,x,w[6],9,-1069501632),x=t(x,j,z,q,w[11],14,643717713),q=t(q,x,j,z,w[0],20,-373897302),z=t(z,q,x,j,w[5],5,-701558691),j=t(j,z,q,x,w[10],9,38016083),x=t(x,j,z,q,w[15],14,-660478335),q=t(q,x,j,z,w[4],20,-405537848),z=t(z,q,x,j,w[9],5,568446438),j=t(j,z,q,x,w[14],9,-1019803690),x=t(x,j,z,q,w[3],14,-187363961),q=t(q,x,j,z,w[8],20,1163531501),z=t(z,q,x,j,w[13],5,-1444681467),j=t(j,z,q,x,w[2],9,-51403784),x=t(x,j,z,q,w[7],14,1735328473),q=t(q,x,j,z,w[12],20,-1926607734),z=Q(z,q,x,j,w[5],4,-378558),j=Q(j,z,q,x,w[8],11,-2022574463),x=Q(x,j,z,q,w[11],16,1839030562),q=Q(q,x,j,z,w[14],23,-35309556),z=Q(z,q,x,j,w[1],4,-1530992060),j=Q(j,z,q,x,w[4],11,1272893353),x=Q(x,j,z,q,w[7],16,-155497632),q=Q(q,x,j,z,w[10],23,-1094730640),z=Q(z,q,x,j,w[13],4,681279174),j=Q(j,z,q,x,w[0],11,-358537222),x=Q(x,j,z,q,w[3],16,-722521979),q=Q(q,x,j,z,w[6],23,76029189),z=Q(z,q,x,j,w[9],4,-640364487),j=Q(j,z,q,x,w[12],11,-421815835),x=Q(x,j,z,q,w[15],16,530742520),q=Q(q,x,j,z,w[2],23,-995338651),z=r(z,q,x,j,w[0],6,-198630844),j=r(j,z,q,x,w[7],10,1126891415),x=r(x,j,z,q,w[14],15,-1416354905),q=r(q,x,j,z,w[5],21,-57434055),z=r(z,q,x,j,w[12],6,1700485571),j=r(j,z,q,x,w[3],10,-1894986606),x=r(x,j,z,q,w[10],15,-1051523),q=r(q,x,j,z,w[1],21,-2054922799),z=r(z,q,x,j,w[8],6,1873313359),j=r(j,z,q,x,w[15],10,-30611744),x=r(x,j,z,q,w[6],15,-1560198380),q=r(q,x,j,z,w[13],21,1309151649),z=r(z,q,x,j,w[4],6,-145523070),j=r(j,z,q,x,w[11],10,-1120210379),x=r(x,j,z,q,w[2],15,718787259),q=r(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function l(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function v(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function P(C){var k,z,A,j,x,B,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;q>=k;k+=64){g(w,l(C.substring(k-64,k)))}for(C=C.substring(k-64),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;z>k;k+=1){A[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(A[k>>2]|=128<<(k%4<<3),k>55){for(g(w,A),k=0;16>k;k+=1){A[k]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),B=parseInt(j[1],16)||0,A[14]=x,A[15]=B,g(w,A),w}function O(C){var B,z,A,j,x,k,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(B=64;q>=B;B+=64){g(w,v(C.subarray(B-64,B)))}for(C=q>B-64?C.subarray(B-64):new Uint8Array(0),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=0;z>B;B+=1){A[B>>2]|=C[B]<<(B%4<<3)}if(A[B>>2]|=128<<(B%4<<3),B>55){for(g(w,A),B=0;16>B;B+=1){A[B]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,A[14]=x,A[15]=k,g(w,A),w}function s(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function p(j){var k;for(k=0;k<j.length;k+=1){j[k]=s(j[k])}return j.join("")}function m(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function n(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(P("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(A,B){var z,k,C,D,w=this.byteLength,x=j(A,w),q=w;return B!==y&&(q=j(B,w)),x>q?new ArrayBuffer(0):(z=q-x,k=new ArrayBuffer(z),C=new Uint8Array(k),D=new Uint8Array(this,x,z),C.set(D),k)}}(),n.prototype.append=function(j){return this.appendBinary(m(j)),this},n.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,l(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},n.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},n.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},n.hash=function(j,k){return n.hashBinary(m(j),k)},n.hashBinary=function(k,w){var j=P(k),q=p(j);return w?e(q):q},n.ArrayBuffer=function(){this.reset()},n.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,v(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var j=n.prototype.getState.call(this);return j.buff=S(j.buff),j},n.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),n.prototype.setState.call(this,j)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(k,w){var j=O(new Uint8Array(k)),q=p(j);return w?e(q):q},n})},{}],16:[function(h,b,e){function a(r,n,f){var g=f[f.length-1];r===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,i=g.index;if(Array.isArray(o)){o.push(r)}else{if(i===n.length-2){var q=n.pop();o[q]=r}else{n.push(r)}}}e.stringify=function(i){var u=[];u.push({obj:i});for(var f,D,s,n,E,F,l,C,g,o,t,r="";f=u.pop();){if(D=f.obj,s=f.prefix||"",n=f.val||"",r+=s,n){r+=n}else{if("object"!=typeof D){r+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){r+="null"}else{if(Array.isArray(D)){for(u.push({val:"]"}),E=D.length-1;E>=0;E--){F=0===E?"":",",u.push({obj:D[E],prefix:F})}u.push({val:"["})}else{l=[];for(C in D){D.hasOwnProperty(C)&&l.push(C)}for(u.push({val:"}"}),E=l.length-1;E>=0;E--){g=l[E],o=D[g],t=E>0?",":"",t+=JSON.stringify(g)+":",u.push({obj:o,prefix:t})}u.push({val:"{"})}}}}}return r},e.parse=function(i){for(var B,t,D,A,l,o,g,s,C,n=[],u=[],f=0;;){if(B=i[f++],"}"!==B&&"]"!==B&&"undefined"!=typeof B){switch(B){case" ":case"	":case"\n":case":":case",":break;case"n":f+=3,a(null,n,u);break;case"t":f+=3,a(!0,n,u);break;case"f":f+=4,a(!1,n,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(t="",f--;;){if(D=i[f++],!/[\d\.\-e\+]/.test(D)){f--;break}t+=D}a(parseFloat(t),n,u);break;case'"':for(A="",l=void 0,o=0;;){if(g=i[f++],'"'===g&&("\\"!==l||o%2!==1)){break}A+=g,l=g,"\\"===l?o++:o=0}a(JSON.parse('"'+A+'"'),n,u);break;case"[":s={element:[],index:n.length},n.push(s.element),u.push(s);break;case"{":C={element:{},index:n.length},n.push(C.element),u.push(C);break;default:throw new Error("unexpectedly reached end of input: "+B)}}else{if(1===n.length){return n.pop()}a(n.pop(),n,u)}}}},{}],17:[function(b,e,a){(function(iO,i6){function gT(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function ee(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function hr(){for(var ab={},t=new fg(function(af,ad){ab.resolve=af,ab.reject=ad}),aa=new Array(arguments.length),ac=0;ac<aa.length;ac++){aa[ac]=arguments[ac]}return ab.promise=t,fg.resolve().then(function(){return fetch.apply(null,aa)}).then(function(ad){ab.resolve(ad)})["catch"](function(ad){ab.reject(ad)}),ab}function gz(ab,af){var t,ac,aa,ad=new Headers,ag={method:ab.method,credentials:"include",headers:ad};return ab.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?ee(ab.body,function(ah){ag.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?ag.body=JSON.stringify(ab.body):"body" in ab?ag.body=ab.body:ag.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&ad.set(ah,ab.headers[ah])}),t=hr(ab.url,ag),ab.timeout>0&&(ac=setTimeout(function(){t.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),t.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?af(null,aa,ah):af(ah,aa)})["catch"](function(ah){af(ah,aa)}),{abort:t.reject}}function hY(aa,ad){var t,ab,ag=function(){t.abort()};t=aa.xhr?new aa.xhr:new XMLHttpRequest;try{t.open(aa.method,aa.url)}catch(ac){ad(ac,{statusCode:413})}t.withCredentials="withCredentials" in aa?aa.withCredentials:!0,"GET"===aa.method?delete aa.headers["Content-Type"]:aa.json&&(aa.headers.Accept="application/json",aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json",aa.body&&aa.processData&&"string"!=typeof aa.body&&(aa.body=JSON.stringify(aa.body))),aa.binary&&(t.responseType="arraybuffer"),"body" in aa||(aa.body=null);for(var af in aa.headers){aa.headers.hasOwnProperty(af)&&t.setRequestHeader(af,aa.headers[af])}return aa.timeout>0&&(ab=setTimeout(ag,aa.timeout),t.onprogress=function(){clearTimeout(ab),ab=setTimeout(ag,aa.timeout)},"undefined"!=typeof t.upload&&(t.upload.onprogress=t.onprogress)),t.onreadystatechange=function(){if(4===t.readyState){var aj={statusCode:t.status};if(t.status>=200&&t.status<300){var al;al=aa.binary?gT([t.response||""],{type:t.getResponseHeader("Content-Type")}):t.responseText,ad(null,aj,al)}else{var ah={};try{ah=JSON.parse(t.response)}catch(ak){}ad(ah,aj)}}},aa.body&&aa.body instanceof Blob?ee(aa.body,function(ah){t.send(ah)}):t.send(aa.body),{abort:ag}}function T(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function G(aa,t){return hW||aa.xhr?hY(aa,t):gz(aa,t)}function hE(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function ho(ab,t,aa){function ac(af){for(var ad in ab){"function"!=typeof ab[ad]&&(this[ad]=ab[ad])}void 0!==aa&&(this.name=aa),void 0!==af&&(this.reason=af)}return ac.prototype=hE.prototype,new ac(t)}function f6(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=a5("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=ga:"doc_validation"===t?(ac=ih,aa=af):"bad_request"===t&&ac.message!==af&&(ac=iA),ac||(ac=a5("status",ab.status,af)||iS),ad=ho(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function fe(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function gk(ab){if("function"==typeof ab.slice){return ab.slice(0)}var t=new ArrayBuffer(ab.byteLength),aa=new Uint8Array(t),ac=new Uint8Array(ab);return aa.set(ac),t}function a7(aa){if(aa instanceof ArrayBuffer){return gk(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function gD(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=gD(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(fe(ab)){return a7(ab)}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=gD(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function hz(){return""}function i0(ab,ad){function t(ah,aj,ag){if(!ab.binary&&ab.json&&"string"==typeof ah){try{ah=JSON.parse(ah)}catch(af){return ag(af)}}Array.isArray(ah)&&(ah=ah.map(function(ak){return ak.error||ak.missing?f6(ak):ak})),ab.binary&&f(ah,aj),ag(null,ah,aj)}function ac(ag,aj){var al,ah;if(ag.code&&ag.status){var af=new Error(ag.message||ag.code);return af.status=ag.status,aj(af)}try{al=JSON.parse(ag.responseText),ah=f6(al)}catch(ak){ah=f6(ag)}aj(ah)}ab=gD(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=dt.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),G(ab,function(ah,al,af){if(ah){return ah.status=al?al.statusCode:400,ac(ah,ad)}var ak,am=al.headers&&al.headers["content-type"],ag=af||hz();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof ag&&(/json/.test(am)||/^[\s]*\{/.test(ag)&&/\}[\s]*$/.test(ag))){try{ag=JSON.parse(ag.toString())}catch(aj){}}al.statusCode>=200&&al.statusCode<300?t(ag,al,ad):(ak=f6(ag),ak.status=al.statusCode,ad(ak))})}function he(ab,t){var ah=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ac=-1!==ah.indexOf("safari")&&-1===ah.indexOf("chrome"),aa=-1!==ah.indexOf("msie"),af=ac&&"POST"===ab.method||aa&&"GET"===ab.method,ag="cache" in ab?ab.cache:!0;if(af||!ag){var ad=-1!==ab.url.indexOf("?");ab.url+=(ad?"&":"?")+"_nonce="+Date.now()}return i0(ab,t)}function ce(aa){var t=!1;return n(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function ar(t){return n(function(ac){ac=gD(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){iO.nextTick(function(){ad(ag,ah)})});var af=new fg(function(ag,ah){var ak;try{var al=ce(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function be(aa,ab){function t(ag,aj,ad){if(v.enabled){for(var ah=[ag._db_name,aj],af=0;af<ad.length-1;af++){ah.push(ad[af])}v.apply(null,ah);var ac=ad[ad.length-1];ad[ad.length-1]=function(ak,am){var al=[ag._db_name,aj];al=al.concat(ak?["error",ak]:["success",am]),v.apply(null,al),ac(ak,am)}}}return ar(n(function(ad){if(this._closed){return fg.reject(new Error("database is closed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new fg(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function cn(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function gq(aa,ab,t){return new fg(function(ad,ac){aa.get(ab,function(af,ah){if(af){if(404!==af.status){return ac(af)}ah={}}var aj=ah._rev,ag=t(ah);return ag?(ag._id=ab,ag._rev=aj,void ad(P(aa,ag,t))):ad({updated:!1,rev:aj})})})}function P(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return gq(aa,ab._id,t)})}function h(t){for(var ab,am,aa,ap,ak=t.rev_tree.slice();ap=ak.pop();){var ad=ap.ids,aj=ad[2],ac=ap.pos;if(aj.length){for(var af=0,ah=aj.length;ah>af;af++){ak.push({pos:ac+1,ids:aj[af]})}}else{var al=!!ad[1].deleted,ag=ad[0];(!ab||(aa!==al?aa:am!==ac?ac>am:ag>ab))&&(ab=ag,am=ac,aa=al)}}return am+"-"+ab}function hM(t){return t.ids}function fp(ab,ad){ad||(ad=h(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(hM);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function g4(t){return hy("return "+t+";",{})}function i9(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function a9(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function F(aa){var t=a9(aa);return t?t.join("/"):null}function s(ad,aa){for(var ag,aj=ad.slice();ag=aj.pop();){for(var ah=ag.pos,af=ag.ids,ac=af[2],ak=aa(0===ac.length,ah,af[0],ag.ctx,af[1]),ab=0,t=ac.length;t>ab;ab++){aj.push({pos:ah+1,ids:ac[ab],ctx:ak})}}}function S(aa,t){return aa.pos-t.pos}function gb(ab){var t=[];s(ab,function(ad,ah,af,aj,ag){ad&&t.push({rev:ah+"-"+af,pos:ah,opts:ag})}),t.sort(S).reverse();for(var aa=0,ac=t.length;ac>aa;aa++){delete t[aa].pos}return t}function i(aa){for(var ac=h(aa),ag=gb(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function A(aa,ac,ag){function ab(){t.cancel()}jc.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?gD(ac):{};var ad=ac.complete=ce(function(aj,ah){aj?t.emit("error",aj):t.emit("complete",ah),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(t.emit("change",ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new fg(function(aj,ah){ac.complete=function(al,ak){al?ah(al):aj(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function hb(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=gb(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return fp(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=i(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function hA(ah,ac,aj){function al(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),aj(null,{results:am})}function aa(){++af===t&&al()}function ak(aq,am,ap){ab[aq]={id:am,docs:ap},aa()}var ag=Array.isArray(ac)?ac:ac.docs,ad={};ag.forEach(function(am){am.id in ad?ad[am.id].push(am):ad[am.id]=[am]});var t=Object.keys(ad).length,af=0,ab=new Array(t);Object.keys(ad).forEach(function(am,av){var au=ad[am],ap=cn(au[0],["atts_since","attachments"]);ap.open_revs=au.map(function(aw){return aw.rev}),ap.open_revs=ap.open_revs.filter(function(aw){return aw});var aq=function(aw){return aw};0===ap.open_revs.length&&(delete ap.open_revs,aq=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in ac&&(ap[aw]=ac[aw])}),ah.get(am,ap,function(ax,aw){ak(av,am,ax?[{error:ax}]:aq(aw))})})}function fm(t){return/^_local/.test(t)}function E(t){for(var ab,am=[],aa=t.slice();ab=aa.pop();){var ap=ab.pos,ak=ab.ids,ad=ak[0],aj=ak[1],ac=ak[2],af=0===ac.length,ah=ab.history?ab.history.slice():[];ah.push({id:ad,opts:aj}),af&&am.push({pos:ap+1-ah.length,ids:ah});for(var al=0,ag=ac.length;ag>al;al++){aa.push({pos:ap+1,ids:ac[al],history:ah})}}return am.reverse()}function bo(t){return 0|Math.random()*t}function a4(ab,t){t=t||ie.length;var aa="",ac=-1;if(ab){for(;++ac<ab;){aa+=ie[bo(t)]}return aa}for(;++ac<36;){switch(ac){case 8:case 13:case 18:case 23:aa+="-";break;case 19:aa+=ie[3&bo(16)|8];break;default:aa+=ie[bo(16)]}}return aa}function j(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(aa){var t;if(aa?"string"!=typeof aa?t=ho(y):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=ho(a3)):t=ho(iq),t){throw t}}function iX(ab){if(!/^\d+\-./.test(ab)){return ho(co)}var t=ab.indexOf("-"),aa=ab.substring(0,t),ac=ab.substring(t+1);return{prefix:parseInt(aa,10),id:ac}}function O(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function h7(ad,aa){var ag,aj,ah,af={status:"available"};if(ad._deleted&&(af.deleted=!0),aa){if(ad._id||(ad._id=a4()),aj=a4(32,16).toLowerCase(),ad._rev){if(ah=iX(ad._rev),ah.error){return ah}ad._rev_tree=[{pos:ah.prefix,ids:[ah.id,{status:"missing"},[[aj,af,[]]]]}],ag=ah.prefix+1}else{ad._rev_tree=[{pos:1,ids:[aj,af,[]]}],ag=1}}else{if(ad._revisions&&(ad._rev_tree=O(ad._revisions,af),ag=ad._revisions.start,aj=ad._revisions.ids[0]),!ad._rev_tree){if(ah=iX(ad._rev),ah.error){return ah}ag=ah.prefix,aj=ah.id,ad._rev_tree=[{pos:ag,ids:[aj,af,[]]}]}}C(ad._id),ad._rev=ag+"-"+aj;var ac={metadata:{},data:{}};for(var ak in ad){if(Object.prototype.hasOwnProperty.call(ad,ak)){var ab="_"===ak[0];if(ab&&!at[ak]){var t=ho(ih,ak);throw t.message=ih.message+": "+ak,t}ab&&!hg[ak]?ac.metadata[ak.slice(1)]=ad[ak]:ac.data[ak]=ad[ak]}}return ac}function a1(aa,t){return t>aa?-1:aa>t?1:0}function gA(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function hG(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function iT(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=cn(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function ig(ab,ad){var t=a1(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return a1(ac,aa)}function eo(aa){var ab={},t=[];return s(aa,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(ab[ag]=0),void 0!==af&&t.push({from:af,to:ag}),ag}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function fi(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return fg.all(ac.map(function(af){var ag=dt.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new fg(function(aj,ah){ab._allDocs(ag,function(ak,al){return ak?ah(ak):(aa.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function gZ(ab){var t=ab._compactionQueue[0],ac=t.opts,aa=t.callback;ab.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ac.last_seq=ad.last_seq),ab._compact(ac,function(ag,af){ag?aa(ag):aa(null,af),iO.nextTick(function(){ab._compactionQueue.shift(),ab._compactionQueue.length&&gZ(ab)})})})}function h3(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function de(){jc.EventEmitter.call(this)}function I(){this.isReady=!1,this.failed=!1,this.queue=[]}function hw(t){t&&i6.debug&&console.error(t)}function iJ(aa,ac){function ag(){ad.emit("destroyed",t),ad.emit(t,"destroyed")}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function hN(ab,ad,t){if(!(this instanceof hN)){return new hN(ab,ad,t)}var ac=this;("function"==typeof ad||"undefined"==typeof ad)&&(t=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof t&&(t=hw),ab=ab||ad.name,ad=gD(ad),delete ad.name,this.__opts=ad;var aa=t;ac.auto_compaction=ad.auto_compaction,ac.prefix=hN.prefix,de.call(ac),ac.taskqueue=new I;var af=new fg(function(ag,aj){t=function(ap,am){return ap?aj(ap):(delete am.then,void ag(am))},ad=gD(ad);var al,ah,ak=ad.name||ab;return function(){try{if("string"!=typeof ak){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}if(al=hN.parseAdapter(ak,ad),ad.originalName=ak,ad.name=al.name,ad.prefix&&"http"!==al.adapter&&"https"!==al.adapter&&(ad.name=ad.prefix+ad.name),ad.adapter=ad.adapter||al.adapter,ac._adapter=ad.adapter,hj("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ak,!hN.adapters[ad.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!hN.adapters[ad.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ac.taskqueue.fail(am)}}(),ah?aj(ah):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void hN.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void t(am)):(iJ(ac,ad),ac.emit("created",ac),hN.emit("created",ad.originalName),ac.taskqueue.ready(ac),void t(null,ac))}))});af.then(function(ag){aa(null,ag)},aa),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function U(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function iy(){return gn}function ez(aa){Object.keys(jc.EventEmitter.prototype).forEach(function(ab){"function"==typeof jc.EventEmitter.prototype[ab]&&(aa[ab]=ib[ab].bind(ib))});var t=aa._destructionListeners=new jb.Map;aa.on("destroyed",function(ab){t.has(ab)&&(t.get(ab).forEach(function(ac){ac()}),t["delete"](ab))})}function f0(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function V(aa,t){return gT([f0(aa)],{type:t})}function g0(aa){for(var ac=q.exec(aa),ag={},ab=14;ab--;){var t=ja[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[gE]={},ag[ja[12]].replace(iF,function(aj,ah,ak){ah&&(ag[gE][ah]=ak)}),ag}function hx(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return ho(iA,aa)}}function H(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&hx(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function jg(aa,t){"console" in i6&&"info" in console&&console.info("The above "+aa+" is totally normal. "+t)}function gC(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&jg(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:i2,version:fW}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,er),af.version=fW,af.replicator=i2,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return gC(ab,ad,t,ac,aa)}throw ag}))})}function B(ab,t,aa,ac){this.src=ab,this.target=t,this.id=aa,this.returnValue=ac}function ew(ab,t){if(ab.session_id===t.session_id){return{last_seq:ab.last_seq,history:ab.history||[]}}var aa=ab.history||[],ac=t.history||[];return i5(aa,ac)}function i5(ab,t){var ah=ab[0],ac=ab.slice(1),aa=t[0],af=t.slice(1);if(!ah||0===t.length){return{last_seq:gW,history:[]}}var ag=ah.session_id;if(g9(ag,t)){return{last_seq:ah.last_seq,history:ab}}var ad=aa.session_id;return g9(ad,ac)?{last_seq:aa.last_seq,history:af}:i5(ac,af)}function g9(ab,t){var aa=t[0],ac=t.slice(1);return ab&&0!==t.length?ab===aa.session_id?!0:g9(ab,ac):!1}function Q(ab,t){ab=parseInt(ab,10)||0,t=parseInt(t,10),t!==t||ab>=t?t=(ab||1)<<1:t+=1;var aa=Math.random(),ac=t-ab;return ~~(ac*aa+ab)}function fz(aa){var t=0;return aa||(t=2000),Q(aa,t)}function jj(ab,t,aa,ac){return ab.retry===!1?(t.emit("error",aa),void t.removeAllListeners()):("function"!=typeof ab.back_off_function&&(ab.back_off_function=fz),t.emit("requestError",aa),("active"===t.state||"pending"===t.state)&&(t.emit("paused",aa),t.state="stopped",t.once("active",function(){ab.current_back_off=fh})),ab.current_back_off=ab.current_back_off||fh,ab.current_back_off=ab.back_off_function(ab.current_back_off),void setTimeout(ac,ab.current_back_off))}function iG(t){return gy(t)}function hV(ab,t,aa,ac){(aa>0||ac<t.byteLength)&&(t=new Uint8Array(t,aa,Math.min(ac,t.byteLength)-aa)),ab.append(t)}function h9(ab,t,aa,ac){(aa>0||ac<t.length)&&(t=t.substring(aa,ac)),ab.appendBinary(t)}function h5(t){return Object.keys(t).sort(hF.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function im(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(hF.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(h5(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),fg.all([aa.id(),ac.id()]).then(function(ah){var aj=ah[0]+ah[1]+t+af+ad+ab;return hq(aj)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function ix(t){return/^1-/.test(t)}function ha(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function gf(ag,ad,aj){function t(){var ak=ha(ad);if(ak.docs.length){return ag.bulkGet(ak).then(function(al){if(aj.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&ab.push(ap.ok)})})})}}function ah(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function af(ak){return ag.allDocs({keys:ak,include_docs:!0}).then(function(al){if(aj.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&ix(am.value.rev)&&!ah(am.doc)&&(ab.push(am.doc),delete ad[am.id])})})}function ac(){var ak=Object.keys(ad).filter(function(am){var al=ad[am].missing;return 1===al.length&&ix(al[0])});return ak.length>0?af(ak):void 0}function aa(){return ab}ad=gD(ad);var ab=[];return fg.resolve().then(ac).then(t).then(aa)}function ex(aA,az,ac,al,ad){function aO(){return aL?fg.resolve():im(aA,az,ac).then(function(aS){aw=aS,aL=new B(aA,az,aw,al)})}function ah(){if(aG=[],0!==aJ.docs.length){var aS=aJ.docs;return az.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(al.cancelled){throw aN(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(ad.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),av=av.concat(aT),ad.docs_written+=aJ.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?al.emit("denied",gD(aY)):aG.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,am("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw ad.doc_write_failures+=aS.length,aT})}}function ax(){ad.last_seq=aI=aJ.seq;var aS=gD(ad);return aG.length&&(aS.docs=aG,al.emit("change",aS)),aM=!0,aL.writeCheckpoint(aJ.seq,aq).then(function(){if(aM=!1,al.cancelled){throw aN(),new Error("cancelled")}aJ=void 0,aa()})["catch"](function(aT){throw aM=!1,am("writeCheckpoint completed with error",aT),aT})}function aD(){var aS={};return aJ.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),az.revsDiff(aS).then(function(aT){if(al.cancelled){throw aN(),new Error("cancelled")}aJ.diffs=aT})}function ak(){return gf(aA,aJ.diffs,al).then(function(aS){aS.forEach(function(aT){delete aJ.diffs[aT._id],ad.docs_read++,aJ.docs.push(aT)})})}function aC(){if(!al.cancelled&&!aJ){if(0===aQ.length){return void aR(!0)}aJ=aQ.shift(),aD().then(ak).then(ah).then(ax).then(aC)["catch"](function(aS){am("batch processing terminated with error",aS)})}}function aR(aS){return 0===ag.changes.length?void (0!==aQ.length||aJ||((aP&&ay.live||ap)&&(al.state="pending",al.emit("paused")),ap&&aN())):void ((aS||ap||ag.changes.length>=au)&&(aQ.push(ag),ag={seq:0,changes:[],docs:[]},("pending"===al.state||"stopped"===al.state)&&(al.state="active",al.emit("active")),aC()))}function am(aT,aS){ab||(aS.message||(aS.message=aT),ad.ok=!1,ad.status="aborting",ad.errors.push(aS),av=av.concat(aS),aQ=[],ag={seq:0,changes:[],docs:[]},aN())}function aN(){if(!(ab||al.cancelled&&(ad.status="cancelled",aM))){ad.status=ad.status||"complete",ad.end_time=new Date,ad.last_seq=aI,ab=!0;var aT=av.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=av.pop();av.length>0&&(aS.other_errors=av),aS.result=ad,jj(ac,al,aS,function(){ex(aA,az,ac,al)})}else{ad.errors=av,al.emit("complete",ad),al.removeAllListeners()}}}function af(aT){if(al.cancelled){return aN()}var aS=H(ac)(aT);aS&&(ag.seq=aT.seq,ag.changes.push(aT),aR(0===aQ.length))}function aE(aS){return aB=!1,al.cancelled?aN():(aS.results.length>0?(ay.since=aS.last_seq,aa()):aP?(ay.live=!0,aa()):ap=!0,void aR(!0))}function t(aS){return aB=!1,al.cancelled?aN():void am("changes rejected",aS)}function aa(){function aT(){aU.cancel()}function aS(){al.removeListener("cancel",aT)}if(!aB&&!ap&&aQ.length<aF){aB=!0,al._changes&&(al.removeListener("cancel",al._abortChanges),al._changes.cancel()),al.once("cancel",aT);var aU=aA.changes(ay).on("change",af);aU.then(aS,aS),aU.then(aE)["catch"](t),ac.retry&&(al._changes=aU,al._abortChanges=aT)}}function aH(){aO().then(function(){return al.cancelled?void aN():aL.getCheckpoint().then(function(aS){aI=aS,ay={since:aI,limit:au,batch_size:au,style:"all_docs",doc_ids:aK,return_docs:!0},ac.filter&&("string"!=typeof ac.filter?ay.include_docs=!0:ay.filter=ac.filter),"heartbeat" in ac&&(ay.heartbeat=ac.heartbeat),"timeout" in ac&&(ay.timeout=ac.timeout),ac.query_params&&(ay.query_params=ac.query_params),ac.view&&(ay.view=ac.view),aa()})})["catch"](function(aS){am("getCheckpoint rejected with ",aS)})}function aj(aS){throw aM=!1,am("writeCheckpoint completed with error",aS),aS}var aJ,aw,aL,aQ=[],ag={seq:0,changes:[],docs:[]},aM=!1,ap=!1,ab=!1,aI=0,aP=ac.continuous||ac.live||!1,au=ac.batch_size||100,aF=ac.batches_limit||10,aB=!1,aK=ac.doc_ids,av=[],aG=[],aq=a4();ad=ad||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var ay={};return al.ready(aA,az),al.cancelled?void aN():(al._addedListeners||(al.once("cancel",aN),"function"==typeof ac.complete&&(al.once("error",ac.complete),al.once("complete",function(aS){ac.complete(null,aS)})),al._addedListeners=!0),void ("undefined"==typeof ac.since?aH():aO().then(function(){return aM=!0,aL.writeCheckpoint(ac.since,aq)}).then(function(){return aM=!1,al.cancelled?void aN():(aI=ac.since,void aH())})["catch"](aj)))}function ij(){jc.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new fg(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function gV(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function iV(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw ho(iA,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=gD(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new ij(ag),ad=gV(aa,ag),af=gV(ac,ag);return ex(ad,af,ag,t),t}function hI(ab,t,aa,ac){return"function"==typeof aa&&(ac=aa,aa={}),"undefined"==typeof aa&&(aa={}),aa=gD(aa),aa.PouchConstructor=aa.PouchConstructor||this,ab=fV.toPouch(ab,aa),t=fV.toPouch(t,aa),new ji(ab,t,aa,ac)}function ji(ag,aq,ap,ad){function t(ay){aj.emit("change",{direction:"pull",change:ay})}function ak(ay){aj.emit("change",{direction:"push",change:ay})}function aa(ay){aj.emit("denied",{direction:"push",doc:ay})}function am(ay){aj.emit("denied",{direction:"pull",doc:ay})}function av(){aj.pushPaused=!0,aj.pullPaused&&aj.emit("paused")}function ac(){aj.pullPaused=!0,aj.pushPaused&&aj.emit("paused")}function ah(){aj.pushPaused=!1,aj.pullPaused&&aj.emit("active",{direction:"push"})}function al(){aj.pullPaused=!1,aj.pushPaused&&aj.emit("active",{direction:"pull"})}function af(ay){return function(aC,aE){var aD="change"===aC&&(aE===t||aE===ak),aA="denied"===aC&&(aE===am||aE===aa),az="paused"===aC&&(aE===ac||aE===av),aB="active"===aC&&(aE===al||aE===ah);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aj.removeAllListeners(aC))}}var aj=this;this.canceled=!1;var ab=ap.push?dt.extend({},ap,ap.push):ap,aw=ap.pull?dt.extend({},ap,ap.pull):ap;this.push=gc(ag,aq,ab),this.pull=gc(aq,ag,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ap.live&&(this.push.on("complete",aj.pull.cancel.bind(aj.pull)),this.pull.on("complete",aj.push.cancel.bind(aj.push))),this.on("newListener",function(ay){"change"===ay?(aj.pull.on("change",t),aj.push.on("change",ak)):"denied"===ay?(aj.pull.on("denied",am),aj.push.on("denied",aa)):"active"===ay?(aj.pull.on("active",al),aj.push.on("active",ah)):"paused"===ay&&(aj.pull.on("paused",ac),aj.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aj.pull.removeListener("change",t),aj.push.removeListener("change",ak)):"denied"===ay?(aj.pull.removeListener("denied",am),aj.push.removeListener("denied",aa)):"active"===ay?(aj.pull.removeListener("active",al),aj.push.removeListener("active",ah)):"paused"===ay&&(aj.pull.removeListener("paused",ac),aj.push.removeListener("paused",av))}),this.pull.on("removeListener",af("pull")),this.push.on("removeListener",af("push"));var au=fg.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aj.emit("complete",az),ad&&ad(null,az),aj.removeAllListeners(),az},function(ay){if(aj.cancel(),ad?ad(ay):aj.emit("error",ay),aj.removeAllListeners(),ad){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function fo(aa,t){return V(go(aa),t)}function ii(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function dr(ab,t){if("undefined"==typeof FileReader){return t(ii((new FileReaderSync).readAsArrayBuffer(ab)))}var aa=new FileReader,ac="function"==typeof aa.readAsBinaryString;aa.onloadend=function(af){var ad=af.target.result||"";return ac?t(ad):void t(ii(ad))},ac?aa.readAsBinaryString(ab):aa.readAsArrayBuffer(ab)}function fb(t){return new fg(function(aa){dr(t,function(ab){aa(gy(ab))})})}function u(ab){for(var t=[],aa=0,ac=ab.length;ac>aa;aa++){t=t.concat(ab[aa])}return t}function gK(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=fo(ab.data,ab.content_type)})}function fl(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function hd(t){return t._attachments&&Object.keys(t._attachments)?fg.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?fb(aa.data).then(function(ac){aa.data=ac}):void 0})):fg.resolve()}function gO(aa){var ab=g0(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function p(aa,t){return gx(aa,aa.db+"/"+t)}function gx(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function iM(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function gU(ak,aq){function aa(aw,ay,az){var av=aw.ajax||{},ax=dt.extend(gD(ag),av,ay);return hk(ax.method+" "+ax.url),f4.ajax(ax,az)}function ah(av,aw){return new fg(function(ax,ay){aa(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function af(av,aw){return be(av,n(function(ax){am().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function am(){if(ak.skipSetup||ak.skip_setup){return fg.resolve()}if(ab){return ab}var av={method:"GET",url:au};return ab=ah({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(jg(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:au})):fg.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:fg.reject(aw)}),ab["catch"](function(){ab=null}),ab}function t(av){return av.split("/").map(encodeURIComponent).join("/")}var al=this,ac=gO;ak.getHost&&(ac=ak.getHost);var ad=ac(ak.name,ak),au=p(ad,"");ak=gD(ak);var ag=ak.ajax||{};if(al.getUrl=function(){return au},al.getHeaders=function(){return ag.headers||{}},ak.auth||ad.auth){var ap=ak.auth||ad.auth,aj=gy(ap.username+":"+ap.password);ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+aj}var ab;setTimeout(function(){aq(null,al)}),al.type=function(){return"http"},al.id=af("id",function(av){aa({},{method:"GET",url:gx(ad,"")},function(ax,ay){var aw=ay&&ay.uuid?ay.uuid+ad.db:p(ad,"");av(null,aw)})}),al.request=af("request",function(av,aw){av.url=p(ad,av.url),aa({},av,aw)}),al.compact=af("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=gD(av),aa(av,{url:p(ad,"_compact"),method:"POST"},function(){function ax(){al.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),al.bulkGet=be("bulkGet",function(aB,aA){function aw(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),aa({},{url:p(ad,"_bulk_get"+iM(aD)),method:"POST",body:{docs:aB.docs}},aC)}function ax(){function aC(aJ){return function(aK,aL){aG[aJ]=aL.results,++aI===aE&&aA(null,{results:u(aG)})}}for(var aF=iD,aE=Math.ceil(aB.docs.length/aF),aI=0,aG=new Array(aE),aH=0;aE>aH;aH++){var aD=cn(aB,["revs","attachments"]);aD.docs=aB.docs.slice(aH*aF,Math.min(aB.docs.length,(aH+1)*aF)),hA(az,aD,aC(aH))}}var az=this,av=gx(ad,""),ay=hP[av];"boolean"!=typeof ay?aw(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(hP[av]=!1,jg(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aE)}else{hP[av]=!0,aA(null,aD)}}):ay?aw(aA):ax()}),al._info=function(av){am().then(function(){aa({},{method:"GET",url:p(ad,"")},function(aw,ax){return aw?av(aw):(ax.host=p(ad,""),void av(null,ax))})})["catch"](av)},al.get=af("get",function(aB,aA,aw){function ax(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?fg.all(aE.map(function(aF){var aH=aC[aF],aG=fl(aD._id)+"/"+t(aF)+"?rev="+aD._rev;return ah(aA,{method:"GET",url:p(ad,aG),binary:!0}).then(function(aI){return aA.binary?aI:fb(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function az(aC){return Array.isArray(aC)?fg.all(aC.map(function(aD){return aD.ok?ax(aD.ok):void 0})):ax(aC)}"function"==typeof aA&&(aw=aA,aA={}),aA=gD(aA);var ay={};aA.revs&&(ay.revs=!0),aA.revs_info&&(ay.revs_info=!0),aA.open_revs&&("all"!==aA.open_revs&&(aA.open_revs=JSON.stringify(aA.open_revs)),ay.open_revs=aA.open_revs),aA.rev&&(ay.rev=aA.rev),aA.conflicts&&(ay.conflicts=aA.conflicts),aB=fl(aB);var av={method:"GET",url:p(ad,aB+iM(ay))};ah(aA,av).then(function(aC){return fg.resolve().then(function(){return aA.attachments?az(aC):void 0}).then(function(){aw(null,aC)})})["catch"](aw)}),al.remove=af("remove",function(aw,aA,av,ay){var ax;"string"==typeof aA?(ax={_id:aw,_rev:aA},"function"==typeof av&&(ay=av,av={})):(ax=aw,"function"==typeof aA?(ay=aA,av={}):(ay=av,av=aA));var az=ax._rev||av.rev;aa(av,{method:"DELETE",url:p(ad,fl(ax._id))+"?rev="+az},ay)}),al.getAttachment=af("getAttachment",function(aw,av,ay,aA){"function"==typeof ay&&(aA=ay,ay={});var ax=ay.rev?"?rev="+ay.rev:"",az=p(ad,fl(aw))+"/"+t(av)+ax;aa(ay,{method:"GET",url:az,binary:!0},aA)}),al.removeAttachment=af("removeAttachment",function(aw,ay,ax,az){var av=p(ad,fl(aw)+"/"+t(ay))+"?rev="+ax;aa({},{method:"DELETE",url:av},az)}),al.putAttachment=af("putAttachment",function(az,aw,aF,aD,aC,av){"function"==typeof aC&&(av=aC,aC=aD,aD=aF,aF=null);var ax=fl(az)+"/"+t(aw),aA=p(ad,ax);if(aF&&(aA+="?rev="+aF),"string"==typeof aD){var aB;try{aB=go(aD)}catch(aE){return av(ho(fv,"Attachment is not a valid base64 string"))}aD=aB?V(aB,aC):""}var ay={headers:{"Content-Type":aC},method:"PUT",url:aA,processData:!1,body:aD,timeout:ag.timeout||60000};aa({},ay,av)}),al._bulkDocs=function(av,ax,aw){av.new_edits=ax.new_edits,am().then(function(){return fg.all(av.docs.map(hd))}).then(function(){aa(ax,{method:"POST",url:p(ad,"_bulk_docs"),body:av},function(ay,az){return ay?aw(ay):(az.forEach(function(aA){aA.ok=!0}),void aw(null,az))})})["catch"](aw)},al.allDocs=af("allDocs",function(aB,aw){"function"==typeof aB&&(aw=aB,aB={}),aB=gD(aB);var aA,ax={},az="GET";aB.conflicts&&(ax.conflicts=!0),aB.descending&&(ax.descending=!0),aB.include_docs&&(ax.include_docs=!0),aB.attachments&&(ax.attachments=!0),aB.key&&(ax.key=JSON.stringify(aB.key)),aB.start_key&&(aB.startkey=aB.start_key),aB.startkey&&(ax.startkey=JSON.stringify(aB.startkey)),aB.end_key&&(aB.endkey=aB.end_key),aB.endkey&&(ax.endkey=JSON.stringify(aB.endkey)),"undefined"!=typeof aB.inclusive_end&&(ax.inclusive_end=!!aB.inclusive_end),"undefined"!=typeof aB.limit&&(ax.limit=aB.limit),"undefined"!=typeof aB.skip&&(ax.skip=aB.skip);var av=iM(ax);if("undefined"!=typeof aB.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aB.keys));ay.length+av.length+1<=ao?av+="&"+ay:(az="POST",aA={keys:aB.keys})}ah(aB,{method:az,url:p(ad,"_all_docs"+av),body:aA}).then(function(aC){aB.include_docs&&aB.attachments&&aB.binary&&aC.rows.forEach(gK),aw(null,aC)})["catch"](aw)}),al._changes=function(az){var aB="batch_size" in az?az.batch_size:it;az=gD(az),az.timeout="timeout" in az?az.timeout:"timeout" in ag?ag.timeout:30000;var aI,aH=az.timeout?{timeout:az.timeout-5000}:{},aD="undefined"!=typeof az.limit?az.limit:!1;aI="return_docs" in az?az.return_docs:"returnDocs" in az?az.returnDocs:!0;var ax=aD;if(az.style&&(aH.style=az.style),(az.include_docs||az.filter&&"function"==typeof az.filter)&&(aH.include_docs=!0),az.attachments&&(aH.attachments=!0),az.continuous&&(aH.feed="longpoll"),az.conflicts&&(aH.conflicts=!0),az.descending&&(aH.descending=!0),"heartbeat" in az?az.heartbeat&&(aH.heartbeat=az.heartbeat):aH.heartbeat=10000,az.filter&&"string"==typeof az.filter&&(aH.filter=az.filter,"_view"===az.filter&&az.view&&"string"==typeof az.view&&(aH.view=az.view)),az.query_params&&"object"==typeof az.query_params){for(var aw in az.query_params){az.query_params.hasOwnProperty(aw)&&(aH[aw]=az.query_params[aw])}}var aC,aG="GET";if(az.doc_ids){aH.filter="_doc_ids";var ay=JSON.stringify(az.doc_ids);ay.length<ao?aH.doc_ids=ay:(aG="POST",aC={doc_ids:az.doc_ids})}var aA,av,aJ=function(aL,aM){if(!az.aborted){aH.since=aL,"object"==typeof aH.since&&(aH.since=JSON.stringify(aH.since)),az.descending?aD&&(aH.limit=ax):aH.limit=!aD||ax>aB?aB:ax;var aK={method:aG,url:p(ad,"_changes"+iM(aH)),timeout:az.timeout,body:aC};av=aL,az.aborted||am().then(function(){aA=aa(az,aK,aM)})["catch"](aM)}},aF={results:[]},aE=function(aK,aN){if(!az.aborted){var aO=0;if(aN&&aN.results){aO=aN.results.length,aF.last_seq=aN.last_seq;var aM={};aM.query=az.query_params,aN.results=aN.results.filter(function(aQ){ax--;var aP=H(az)(aQ);return aP&&(az.include_docs&&az.attachments&&az.binary&&gK(aQ),aI&&aF.results.push(aQ),az.onChange(aQ)),aP})}else{if(aK){return az.aborted=!0,void az.complete(aK)}}aN&&aN.last_seq&&(av=aN.last_seq);var aL=aD&&0>=ax||aN&&aB>aO||az.descending;(!az.continuous||aD&&0>=ax)&&aL?az.complete(null,aF):setTimeout(function(){aJ(av,aE)},0)}};return aJ(az.since||0,aE),{cancel:function(){az.aborted=!0,aA&&aA.abort()}}},al.revsDiff=af("revsDiff",function(av,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),aa(ax,{method:"POST",url:p(ad,"_revs_diff"),body:av},aw)}),al._close=function(av){av()},al._destroy=function(aw,av){aa(aw,{url:p(ad,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(al.emit("destroyed"),al.constructor.emit("destroyed",ak.name),void av(null,ay))})}}function iZ(){this.promise=new fg(function(t){t()})}function fk(t){return iH.hash(t)}function hU(ab){var t=ab.db,ah=ab.viewName,ac=ab.map,aa=ab.reduce,af=ab.temporary,ag=ac.toString()+(aa&&aa.toString())+"undefined";if(!af&&t._cachedViews){var ad=t._cachedViews[ag];if(ad){return fg.resolve(ad)}}return t.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ah;-1===aq.indexOf("/")&&(aq=ah+"/"+ah);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(af?"temp":fk(ag));return gq(t,"_local/mrviews",al).then(function(){return t.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:t,adapter:t.adapter,mapFun:ac,reduceFun:aa};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,af||(t._cachedViews=t._cachedViews||{},t._cachedViews[ag]=aq,aq.db.once("destroyed",function(){delete t._cachedViews[ag]})),aq})})})})}function gG(ab,ad,t,ac,aa,af){return hy("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function gj(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function fY(t){return 1===t.length&&/^1-/.test(t[0].rev)}function hX(aa,ab){try{aa.emit("error",ab)}catch(t){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(ab)}}function il(ab,t,aa){try{return{output:t.apply(null,aa)}}catch(ac){return hX(ab,ac),{error:ac}}}function ge(aa,ab){var t=f1(aa.key,ab.key);return 0!==t?t:f1(aa.value,ab.value)}function gJ(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function gF(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function bt(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=fo(ac.data,ac.content_type)})})}function gI(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&bt(aa),aa}}function hl(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new iv(t)}function iI(ab){for(var t=0,ah=0,ac=ab.length;ac>ah;ah++){var aa=ab[ah];if("number"!=typeof aa){if(!Array.isArray(aa)){throw hl("_sum")}t="number"==typeof t?[t]:t;for(var af=0,ag=aa.length;ag>af;af++){var ad=aa[af];if("number"!=typeof ad){throw hl("_sum")}"undefined"==typeof t[af]?t.push(ad):t[af]+=ad}}else{"number"==typeof t?t+=aa:t[0]+=aa}}return t}function hD(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function gs(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function hv(t){return t.group_level=gs(t.group_level),t.limit=gs(t.limit),t.skip=gs(t.skip),t}function g8(t){if(t){if("number"!=typeof t){return new iN('Invalid value for integer: "'+t+'"')}if(0>t){return new iN('Invalid value for positive integer: "'+t+'"')}}}function g3(ab,t){var aa=ab.descending?"endkey":"startkey",ac=ab.descending?"startkey":"endkey";if("undefined"!=typeof ab[aa]&&"undefined"!=typeof ab[ac]&&f1(ab[aa],ab[ac])>0){throw new iN("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(t.reduce&&ab.reduce!==!1){if(ab.include_docs){throw new iN("{include_docs:true} is invalid for reduce")}if(ab.keys&&ab.keys.length>1&&!ab.group&&!ab.group_level){throw new iN("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=g8(ab[af]);if(ad){throw ad}})}function f8(ag,ad,aj){var t,ah=[],af="GET";if(hD("reduce",aj,ah),hD("include_docs",aj,ah),hD("attachments",aj,ah),hD("limit",aj,ah),hD("descending",aj,ah),hD("group",aj,ah),hD("group_level",aj,ah),hD("skip",aj,ah),hD("stale",aj,ah),hD("conflicts",aj,ah),hD("startkey",aj,ah,!0),hD("start_key",aj,ah,!0),hD("endkey",aj,ah,!0),hD("end_key",aj,ah,!0),hD("inclusive_end",aj,ah),hD("key",aj,ah,!0),ah=ah.join("&"),ah=""===ah?"":"?"+ah,"undefined"!=typeof aj.keys){var ac=2000,aa="keys="+encodeURIComponent(JSON.stringify(aj.keys));aa.length+ah.length+1<=ac?ah+=("?"===ah[0]?"&":"?")+aa:(af="POST","string"==typeof ad?t={keys:aj.keys}:ad.keys=aj.keys)}if("string"==typeof ad){var ab=gj(ad);return ag.request({method:af,url:"_design/"+ab[0]+"/_view/"+ab[1]+ah,body:t}).then(gI(aj))}return t=t||{},Object.keys(ad).forEach(function(ak){Array.isArray(ad[ak])?t[ak]=ad[ak]:t[ak]=ad[ak].toString()}),ag.request({method:"POST",url:"_temp_view"+ah,body:t}).then(gI(aj))}function iC(aa,ab,t){return new fg(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function gL(t){return new fg(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function i8(t){return function(aa){if(404===aa.status){return t}throw aa}}function gY(ah,ac,aj){function al(){return fY(ab)?fg.resolve(ad):ac.db.get(ag)["catch"](i8(ad))}function aa(am){return am.keys.length?ac.db.allDocs({keys:am.keys,include_docs:!0}):fg.resolve({rows:[]})}function ak(aA,az){for(var av=[],ax={},au=0,ap=az.rows.length;ap>au;au++){var am=az.rows[au],aw=am.doc;if(aw&&(av.push(aw),ax[aw._id]=!0,aw._deleted=!af[aw._id],!aw._deleted)){var ay=af[aw._id];"value" in ay&&(aw.value=ay.value)}}var aq=Object.keys(af);return aq.forEach(function(aD){if(!ax[aD]){var aB={_id:aD},aC=af[aD];"value" in aC&&(aB.value=aC.value),av.push(aB)}}),aA.keys=hn(aq.concat(aA.keys)),av.push(aA),av}var ag="_local/doc_"+ah,ad={_id:ag,keys:[]},t=aj[ah],af=t.indexableKeysToKeyValues,ab=t.changes;return al().then(function(am){return aa(am).then(function(ap){return ak(am,ap)})})}function f5(ab,t,aa){var ac="_local/lastSeq";return ab.db.get(ac)["catch"](i8({_id:ac,seq:0})).then(function(af){var ad=Object.keys(t);return fg.all(ad.map(function(ag){return gY(ag,ab,t)})).then(function(ah){var ag=u(ah);return af.seq=aa,ag.push(af),ab.db.bulkDocs({docs:ag})})})}function gr(aa){var ab="string"==typeof aa?aa:aa.name,t=f2[ab];return t||(t=f2[ab]=new iZ),t}function iu(t){return ik(gr(t),function(){return i3(t)})()}function i3(ag){function ad(am,ak){var al={id:ah._id,key:gt(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gt(ak)),t.push(al)}function aj(ak,al){return function(){return f5(ag,ak,al)}}var t,ah,af;if("function"==typeof ag.mapFun&&2===ag.mapFun.length){var ac=ag.mapFun;af=function(ak){return ac(ak,ad)}}else{af=gG(ag.mapFun.toString(),ad,iI,gg,Array.isArray,JSON.parse)}var aa=ag.seq||0,ab=new iZ;return new fg(function(ap,ak){function al(){ab.finish().then(function(){ag.seq=aa,ap()})}function am(){function aq(au){ak(au)}ag.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:aa,limit:gP}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var aC={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){t=[],ah=aD.doc,ah._deleted||il(ag.sourceDB,af,[ah]),t.sort(ge);for(var aE,ay={},au=0,az=t.length;az>au;au++){var aw=t[au],aG=[aw.key,aw.id];0===f1(aw.key,aE)&&aG.push(au);var aB=je(aG);ay[aB]=aw,aE=aw.key}aC[aD.doc._id]={indexableKeysToKeyValues:ay,changes:aD.changes}}aa=aD.seq}return ab.add(aj(aC,aa)),aF.length<gP?al():am()}).on("error",aq)}am()})}function jf(ah,ac,aj){0===aj.group_level&&delete aj.group_level;var al,aa=aj.group||aj.group_level;al=fT[ah.reduceFun]?fT[ah.reduceFun]:gG(ah.reduceFun.toString(),null,iI,gg,Array.isArray,JSON.parse);var ak=[],ag=aj.group_level;ac.forEach(function(aq){var am=ak[ak.length-1],ap=aa?aq.key:null;return aa&&Array.isArray(ap)&&"number"==typeof ag&&(ap=ap.length>ag?ap.slice(0,ag):ap),am&&0===f1(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void ak.push({key:[[ap,aq.id]],value:[aq.value]})});for(var ad=0,t=ak.length;t>ad;ad++){var af=ak[ad],ab=il(ah.sourceDB,al,[af.key,af.value,!1]);if(ab.error&&ab.error instanceof iv){throw ab.error}af.value=ab.error?null:ab.output,af.key=af.key[0][0]}return{rows:gJ(ak,aj.limit,aj.skip)}}function gp(aa,t){return ik(gr(aa),function(){return gX(aa,t)})()}function gX(t,ab){function am(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ap=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=iP(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function aa(av){var aq;if(aq=ak?jf(t,av,ab):{total_rows:ap,offset:ad,rows:av},ab.include_docs){var au=hn(av.map(gF));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:ab.conflicts,attachments:ab.attachments,binary:ab.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=gF(ay),az=aw["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ap,ak=t.reduceFun&&ab.reduce!==!1,ad=ab.skip||0;if("undefined"==typeof ab.keys||ab.keys.length||(ab.limit=0,delete ab.keys),"undefined"!=typeof ab.keys){var aj=ab.keys,ac=aj.map(function(au){var aq={startkey:je([au]),endkey:je([au,{}])};return am(aq)});return fg.all(ac).then(u).then(aa)}var af={descending:ab.descending};if(ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"undefined"!=typeof ab.startkey&&(af.startkey=je(ab.descending?[ab.startkey,{}]:[ab.startkey])),"undefined"!=typeof ab.endkey){var ah=ab.inclusive_end!==!1;ab.descending&&(ah=!ah),af.endkey=je(ah?[ab.endkey,{}]:[ab.endkey])}if("undefined"!=typeof ab.key){var al=je([ab.key]),ag=je([ab.key,{}]);af.descending?(af.endkey=al,af.startkey=ag):(af.startkey=al,af.endkey=ag)}return ak||("number"==typeof ab.limit&&(af.limit=ab.limit),af.skip=ad),am(af).then(aa)}function a2(t){return t.request({method:"POST",url:"_view_cleanup"})}function gv(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(af){var ah=gj(af),ag="_design/"+ah[0],ad=ah[1];aa[ag]=aa[ag]||{},aa[ag][ad]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(af){var ad={};af.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ad[au]=ad[au]||am})})});var ag=Object.keys(ad).filter(function(aj){return !ad[aj]}),ah=ag.map(function(aj){return ik(gr(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return fg.all(ah).then(function(){return{ok:!0}})})},i8({ok:!0}))}function h1(aa,ad,ab){if("http"===aa.type()){return f8(aa,ad,ab)}if("function"==typeof aa._query){return iC(aa,ad,ab)}if("string"!=typeof ad){g3(ab,ad);var ah={db:aa,viewName:"temp_view/temp_view",map:ad.map,reduce:ad.reduce,temporary:!0};return w.add(function(){return hU(ah).then(function(ak){function aj(){return ak.db.destroy()}return h0(iu(ak).then(function(){return gp(ak,ab)}),aj)})}),w.finish()}var t=ad,ag=gj(t),ac=ag[0],af=ag[1];return aa.get("_design/"+ac).then(function(al){var ak=al.views&&al.views[af];if(!ak||"string"!=typeof ak.map){throw new jd("ddoc "+ac+" has no view named "+af)}g3(ab,ak);var aj={db:aa,viewName:t,map:ak.map,reduce:ak.reduce};return hU(aj).then(function(am){return"ok"===ab.stale||"update_after"===ab.stale?("update_after"===ab.stale&&iO.nextTick(function(){iu(am)}),gp(am,ab)):iu(am).then(function(){return gp(am,ab)})})})}function iN(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,iN)}catch(t){}}function jd(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,jd)}catch(t){}}function iv(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,iv)}catch(t){}}function fR(t){return"'"+t+"'"}function hi(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function gM(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function K(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hm(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function gd(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function hK(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function hs(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+gN+" WHERE seq IN "+gd(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+gN+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+gN+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new jb.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+gN+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+ae+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(aj){var ah="SELECT seq FROM "+bn+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ac,aj],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+bn+" WHERE seq=?",[ak],ab)})})}}function a8(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(ho(i4,ab,ac))}}function gw(aa){if("size" in aa){return 1000000*aa.size}var t=/Android/.test(window.navigator.userAgent);return t?5000000:1}function ai(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function iK(aa,ab){try{return{db:aa(ab)}}catch(t){return{error:t}}}function fd(aa){var ab=gh[aa.name];if(!ab){var t=ai();ab=gh[aa.name]=iK(t,aa),ab.db&&(ab.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return ab}function gi(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function L(t){U()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):iy()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function iQ(){jc.EventEmitter.call(this),this._listeners={},L(this)}function W(t){return decodeURIComponent(window.escape(t))}function r(t){return 65>t?t-48:t-55}function J(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(r(ab.charCodeAt(t++))<<4|r(ab.charCodeAt(t++)))}return ac}function ia(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(r(ab.charCodeAt(t+2))<<12|r(ab.charCodeAt(t+3))<<8|r(ab.charCodeAt(t))<<4|r(ab.charCodeAt(t+1))),t+=4}return ac}function h6(aa,t){return"UTF-8"===t?W(J(aa,0,aa.length)):ia(aa,0,aa.length)}function ht(aa){try{return JSON.parse(aa)}catch(t){return hH.parse(aa)}}function l(aa){try{return JSON.stringify(aa)}catch(t){return hH.stringify(aa)}}function hc(ac,af,aa){function ad(ak){try{return go(ak)}catch(al){var aj=ho(fv,"Attachment is not a valid base64 string");return{error:aj}}}function ab(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=ad(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===af?al.data=V(ak,al.content_type):"base64"===af?al.data=gy(ak):al.data=ak,hq(ak).then(function(am){al.digest="md5-"+am,aj()})}else{ee(al.data,function(am){"binary"===af?al.data=ii(am):"base64"===af&&(al.data=gy(ii(am))),hq(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function ah(){ag++,ac.length===ag&&(t?aa(t):aa())}if(!ac.length){return aa()}var t,ag=0;ac.forEach(function(ak){function am(aq){t=aq,al++,al===aj.length&&ah()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ah()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ab(ak.data._attachments[ap],am)}})}function fZ(aa,t){return aa.pos-t.pos}function ev(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function iw(ab,t,aa){var ac=ev(ab,t,aa);ab.splice(ac,0,t)}function hu(ab,t){for(var ah,ac,aa=t,af=ab.length;af>aa;aa++){var ag=ab[aa],ad=[ag.id,ag.opts,[]];ac?(ac[2].push(ad),ac=ad):ah=ac=ad}return ah}function g1(aa,t){return aa[0]<t[0]?-1:1}function hS(ad,aa){for(var ag=[{tree1:ad,tree2:aa}],aj=!1;ag.length>0;){var ah=ag.pop(),af=ah.tree1,ac=ah.tree2;(af[1].status||ac[1].status)&&(af[1].status="available"===af[1].status||"available"===ac[1].status?"available":"missing");for(var ak=0;ak<ac[2].length;ak++){if(af[2][0]){for(var ab=!1,t=0;t<af[2].length;t++){af[2][t][0]===ac[2][ak][0]&&(ag.push({tree1:af[2][t],tree2:ac[2][ak]}),ab=!0)}ab||(aj="new_branch",iw(af[2],ac[2][ak],g1))}else{aj="new_leaf",af[2][0]=ac[2][ak]}}}return{conflicts:aj,tree:ad}}function g(ad,ak,ag){var al,av=[],t=!1,aa=!1;if(!ad.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=ad.length;aw>ah;ah++){var aj=ad[ah];if(aj.pos===ak.pos&&aj.ids[0]===ak.ids[0]){al=hS(aj.ids,ak.ids),av.push({pos:aj.pos,ids:al.tree}),t=t||al.conflicts,aa=!0}else{if(ag!==!0){var am=aj.pos<ak.pos?aj:ak,ab=aj.pos<ak.pos?ak:aj,ac=ab.pos-am.pos,aq=[],ax=[];for(ax.push({ids:am.ids,diff:ac,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ap=0,af=az.length;af>ap;ap++){ax.push({ids:az[ap],diff:ay.diff-1,parent:ay.ids,parentIdx:ap})}}else{ay.ids[0]===ab.ids[0]&&aq.push(ay)}}var au=aq[0];au?(al=hS(au.ids,ab.ids),au.parent[2][au.parentIdx]=al.tree,av.push({pos:am.pos,ids:am.ids}),t=t||al.conflicts,aa=!0):av.push(aj)}else{av.push(aj)}}}return aa||av.push(ak),av.sort(fZ),{tree:av,conflicts:t||"internal_node"}}function iB(ad,aa){for(var ag,aj=E(ad),ah=0,af=aj.length;af>ah;ah++){var ac=aj[ah],ak=ac.ids,ab=Math.max(0,ak.length-aa),t={pos:ac.pos+ab,ids:hu(ak,ab)};ag=ag?g(ag,t,!0).tree:[t]}return ag}function gR(ab,t,aa){var ac=g(ab,t);return{tree:iB(ac.tree,aa),conflicts:ac.conflicts}}function jh(ad,aa){for(var ag,aj=ad.slice(),ah=aa.split("-"),af=parseInt(ah[0],10),ac=ah[1];ag=aj.pop();){if(ag.pos===af&&ag.ids[0]===ac){return !0}for(var ak=ag.ids[2],ab=0,t=ak.length;t>ab;ab++){aj.push({pos:ag.pos+1,ids:ak[ab]})}}return !1}function gm(aa,aw,aq,aA,au,ah,aj,ak){if(jh(aw.rev_tree,aq.metadata.rev)){return aA[au]=aq,ah()}var av=aw.winningRev||h(aw),ax="deleted" in aw?aw.deleted:fp(aw,av),ag="deleted" in aq.metadata?aq.metadata.deleted:fp(aq.metadata),t=/^1-/.test(aq.metadata.rev);if(ax&&!ag&&ak&&t){var af=aq.data;af._rev=av,af._id=aq.metadata.id,aq=h7(af,ak)}var az=gR(aw.rev_tree,aq.metadata.rev_tree[0],aa),am=ak&&(ax&&ag||!ax&&"new_leaf"!==az.conflicts||ax&&!ag&&"new_branch"===az.conflicts);if(am){var ac=ho(h2);return aA[au]=ac,ah()}var ay=aq.metadata.rev;aq.metadata.rev_tree=az.tree,aw.rev_map&&(aq.metadata.rev_map=aw.rev_map);var ab,ad=h(aq.metadata),al=fp(aq.metadata,ad),ap=ax===al?0:al>ax?-1:1;ab=ay===ad?al:fp(aq.metadata,ay),aj(aq,ad,al,ab,!0,ap,au,ah)}function jk(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function f9(ak,aq,aa,ah,af,am,t,al,ac){function ad(aw,aA,aC){var az=h(aw.metadata),av=fp(aw.metadata,az);if("was_delete" in al&&av){return am[aA]=ho(ga,"deleted"),aC()}var ax=ag&&jk(aw);if(ax){var ay=ho(h2);return am[aA]=ay,aC()}var aB=av?0:1;t(aw,az,av,av,!1,aB,aA,aC)}function au(){++aj===ab&&ac&&ac()}ak=ak||1000;var ag=al.new_edits,ap=new jb.Map,aj=0,ab=aq.length;aq.forEach(function(aw,ay){if(aw._id&&fm(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aa[ax](aw,{ctx:af},function(aA,az){am[ay]=aA||az,au()})}var av=aw.metadata.id;ap.has(av)?(ab--,ap.get(av).push([aw,ay])):ap.set(av,[[aw,ay]])}),ap.forEach(function(ay,aw){function ax(){++az<ay.length?av():au()}function av(){var aC=ay[az],aB=aC[0],aA=aC[1];if(ah.has(aw)){gm(ak,ah.get(aw),aB,am,aA,ax,t,ag)}else{var aD=gR([],aB.metadata.rev_tree[0],ak);aB.metadata.rev_tree=aD.tree,ad(aB,aA,ax)}}var az=0;av()})}function gu(aa){var t=[];return s(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function iz(aw,az,aq,aA,au,ab,af){function ax(){return am?af(am):(ab.notify(aA._name),aA._docCount=-1,void af(null,ac))}function ad(aD,aE){var aC="SELECT count(*) as cnt FROM "+ae+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=ho(et,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ag(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(ay.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ad(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aj(aD,aH,aQ,aE,aJ,aO,aF,aK){function aR(){function aZ(bb,bf){function bh(){return ++bc===ba.length&&bf(),!1}function bg(bi){var bk="INSERT INTO "+gN+" (digest, seq) VALUES (?,?)",bj=[aY._attachments[bi].digest,bb];ap.executeSql(bk,bj,bh,bh)}var bc=0,ba=Object.keys(aY._attachments||{});if(!ba.length){return bf()}for(var bd=0;bd<ba.length;bd++){bg(ba[bd])}}var aY=aD.data,aU=aE?1:0,aV=aY._id,aT=aY._rev,aW=K(aY),aX="INSERT INTO "+bn+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aS=[aV,aT,aW,aU];ap.executeSql(aX,aS,function(bc,ba){var bb=ba.insertId;aZ(bb,function(){aG(bc,bb)})},function(){var ba=hK("seq",bn,null,"doc_id=? AND rev=?");return ap.executeSql(ba,[aV,aT],function(bd,bf){var bc=bf.rows.item(0).seq,bb="UPDATE "+bn+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aW,aU,aV,aT];bd.executeSql(bb,bg,function(bh){aZ(bc,function(){aG(bh,bc)})})}),!1})}function aI(aS){aL||(aS?(aL=aS,aK(aL)):aP===aN.length&&aR())}function aM(aS){aP++,aI(aS)}function aC(){if(aJ&&aA.auto_compaction){var aS=aD.metadata.id,aT=gu(aD.metadata);hs(aT,aS,ap)}}function aG(aW,aS){aC(),aD.metadata.seq=aS,delete aD.metadata.rev;var aU=aJ?"UPDATE "+hf+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+bn+" WHERE doc_id="+hf+".id AND rev=?) WHERE id=?":"INSERT INTO "+hf+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=l(aD.metadata),aX=aD.metadata.id,aV=aJ?[aT,aS,aH,aX]:[aX,aS,aS,aT];aW.executeSql(aU,aV,function(){ac[aF]={ok:!0,id:aD.metadata.id,rev:aH},ah.set(aX,aD.metadata),aK()})}var aL=null,aP=0;aD.data._id=aD.metadata.id,aD.data._rev=aD.metadata.rev;var aN=Object.keys(aD.data._attachments||{});aE&&(aD.data._deleted=!0),aN.forEach(function(aS){var aV=aD.data._attachments[aS];if(aV.stub){aP++,aI()}else{var aU=aV.data;delete aV.data;var aT=aV.digest;av(aT,aU,aM)}}),aN.length||aR()}function ak(){f9(aw.revs_limit,ay,aA,ah,ap,ac,aj,aq)}function t(aD){function aE(){++aC===ay.length&&aD()}if(!ay.length){return aD()}var aC=0;ay.forEach(function(aG){if(aG._id&&fm(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hf+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=ht(aJ.rows.item(0).json);ah.set(aF,aH)}aE()})})}function av(aD,aF,aC){var aE="SELECT digest FROM "+ae+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+ae+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,hi(aF)],function(){aC()},function(){return aC(),!1}))})}var al=aq.new_edits,aB=az.docs,ay=aB.map(function(aC){if(aC._id&&fm(aC._id)){return aC}var aD=h7(aC,al);return aD}),aa=ay.filter(function(aC){return aC.error});if(aa.length){return af(aa[0])}var ap,am,ac=new Array(ay.length),ah=new jb.Map;hc(ay,"binary",function(aC){return aC?af(aC):void au.transaction(function(aD){ap=aD,ag(function(aE){aE?am=aE:t(ak)})},a8(af),ax)})}function hQ(ag,ad,aj,t,ah){function af(){++ab===aa.length&&ah&&ah()}function ac(am,ak){var al=am._attachments[ak],ap={binary:ad.binary,ctx:t};aj._getAttachment(al,ap,function(aq,au){am._attachments[ak]=dt.extend(cn(al,["digest","content_type"]),{data:au}),af()})}var aa=Object.keys(ag._attachments||{});if(!aa.length){return ah&&ah()}var ab=0;aa.forEach(function(ak){ad.attachments&&ad.include_docs?ac(ag,ak):(ag._attachments[ak].stub=!0,af())})}function iU(ad,al){function aq(){iy()&&(window.localStorage["_pouch__websqldb_"+ab._name]=!0),al(null,ab)}function aA(aC,aD){aC.executeSql(cr),aC.executeSql("ALTER TABLE "+bn+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(g2),aC.executeSql("ALTER TABLE "+hf+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hf+" (local, id)");var aE="SELECT "+hf+".winningseq AS seq, "+hf+".json AS metadata FROM "+bn+" JOIN "+hf+" ON "+bn+".seq = "+hf+".winningseq";aC.executeSql(aE,[],function(aM,aH){for(var aG=[],aJ=[],aK=0;aK<aH.rows.length;aK++){var aF=aH.rows.item(aK),aI=aF.seq,aL=JSON.parse(aF.metadata);fp(aL)&&aG.push(aI),fm(aL.id)&&aJ.push(aL.id)}aM.executeSql("UPDATE "+hf+"SET local = 1 WHERE id IN "+gd(aJ.length),aJ,function(){aM.executeSql("UPDATE "+bn+" SET deleted = 1 WHERE seq IN "+gd(aG.length),aG,aD)})})})})}function au(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+fc+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+hf+".id AS id, "+bn+".json AS data FROM "+bn+" JOIN "+hf+" ON "+bn+".seq = "+hf+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aK,aI){function aG(){if(!aJ.length){return aE(aK)}var aL=aJ.shift(),aM=JSON.parse(aL.data)._rev;aK.executeSql("INSERT INTO "+fc+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+hf+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+bn+" WHERE seq=?",[aL.seq],function(){aG()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aG()})})}function ak(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aL=aG.shift(),aN=h6(aL.hex,az),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aI=aN.substring(aK+2),aJ="UPDATE "+bn+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aJ,[aM,aI,aN],function(){aH()})}aH()}var aE="ALTER TABLE "+bn+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+bn+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(o,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+bn;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function ay(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+ae;aH.executeSql(aG,[],function(aM,aK){function aN(){var aO=hK(fu+", "+hf+".id AS id",[hf,bn],i7,null,hf+".id ");aO+=" LIMIT "+aJ+" OFFSET "+aI,aI+=aJ,aM.executeSql(aO,[],function(aX,aS){function aV(bc,bd){var bb=aP[bc]=aP[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aS.rows.length){return aF(aX)}for(var aP={},aW=0;aW<aS.rows.length;aW++){for(var aT=aS.rows.item(aW),aU=hm(aT.data,aT.id,aT.rev),aZ=Object.keys(aU._attachments||{}),aY=0;aY<aZ.length;aY++){var aR=aU._attachments[aZ[aY]];aV(aR.digest,aT.seq)}}var aQ=[];if(Object.keys(aP).forEach(function(bb){var bc=aP[bb];bc.forEach(function(bd){aQ.push([bb,bd])})}),!aQ.length){return aN()}var ba=0;aQ.forEach(function(bc){var bb="INSERT INTO "+gN+" (digest, seq) VALUES (?,?)";aX.executeSql(bb,bc,function(){++ba===aQ.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aF(aM)}var aI=0,aJ=10;aN()})}var aE="CREATE TABLE IF NOT EXISTS "+gN+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(eu,[],function(aH){aH.executeSql(a0,[],aC)})})}function ax(aD,aE){var aC="ALTER TABLE "+ae+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function ag(aD,aE){var aC="ALTER TABLE "+hf+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+hf+" SET max_seq=(SELECT MAX(seq) FROM "+bn+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aI){var aH="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hf+" (max_seq)";aI.executeSql(aH,[],aE)})})}function aa(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;az=2===aG.length?"UTF-8":"UTF-16",aD()})}function aB(){for(;ac.length>0;){var aC=ac.pop();aC(null,aj)}}function t(aE,aH){if(0===aH){var aM="CREATE TABLE IF NOT EXISTS "+ir+" (dbid, db_version INTEGER)",aC="CREATE TABLE IF NOT EXISTS "+ae+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aG="CREATE TABLE IF NOT EXISTS "+gN+" (digest, seq INTEGER)",aD="CREATE TABLE IF NOT EXISTS "+hf+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aF="CREATE TABLE IF NOT EXISTS "+bn+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aN="CREATE TABLE IF NOT EXISTS "+fc+" (id UNIQUE, rev, json)";aE.executeSql(aC),aE.executeSql(aN),aE.executeSql(aG,[],function(){aE.executeSql(a0),aE.executeSql(eu)}),aE.executeSql(aD,[],function(){aE.executeSql(cr),aE.executeSql(aF,[],function(){aE.executeSql(g2),aE.executeSql(o),aE.executeSql(aM,[],function(){var aP="INSERT INTO "+ir+" (db_version, dbid) VALUES (?,?)";aj=a4();var aO=[gH,aj];aE.executeSql(aP,aO,function(){aB()})})})})}else{var aI=function(){var aO=gH>aH;aO&&aE.executeSql("UPDATE "+ir+" SET db_version = "+gH);var aP="SELECT dbid FROM "+ir;aE.executeSql(aP,[],function(aR,aQ){aj=aQ.rows.item(0).dbid,aB()})},aL=[aA,au,ak,ay,ax,ag,aI],aK=aH,aJ=function(aO){aL[aK-1](aO,aJ),aK++};aJ(aE)}}function af(){ah.transaction(function(aC){aa(aC,function(){av(aC)})},a8(al),aq)}function av(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+ir;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+ir,[],function(aG,aH){var aI=aH.rows.item(0).db_version;t(aG,aI)}):aE.executeSql("ALTER TABLE "+ir+" ADD COLUMN db_version INTEGER",[],function(){t(aE,1)}):t(aE,0)})}function aw(aD,aE){if(-1!==ab._docCount){return aE(ab._docCount)}var aC=hK("COUNT("+hf+".id) AS 'num'",[hf,bn],i7,bn+".deleted=0");aD.executeSql(aC,[],function(aG,aF){ab._docCount=aF.rows.item(0).num,aE(ab._docCount)})}var az,ab=this,aj=null,ap=gw(ad),ac=[];ab._docCount=-1,ab._name=ad.name;var am=fd({name:ab._name,version:fs,description:ab._name,size:ap,location:ad.location,createFromLocation:ad.createFromLocation,androidDatabaseImplementation:ad.androidDatabaseImplementation});if(am.error){return a8(al)(am.error)}var ah=am.db;"function"!=typeof ah.readTransaction&&(ah.readTransaction=ah.transaction),af(),ab.type=function(){return"websql"},ab._id=ar(function(aC){aC(null,aj)}),ab._info=function(aC){ah.readTransaction(function(aD){aw(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+bn;aD.executeSql(aF,[],function(aH,aG){var aI=aG.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aI,sqlite_plugin:ah._sqlitePlugin,websql_encoding:az})})})},a8(aC))},ab._bulkDocs=function(aE,aC,aD){iz(ad,aE,aC,ab,ah,iU.Changes,aD)},ab._get=function(aI,aE,aK){function aD(){aK(aG,{doc:aC,metadata:aJ,ctx:aL})}var aC,aJ,aG,aL=aE.ctx;if(!aL){return ah.readTransaction(function(aM){ab._get(aI,dt.extend({ctx:aM},aE),aK)})}var aF,aH;aE.rev?(aF=hK(fu,[hf,bn],hf+".id="+bn+".doc_id",[bn+".doc_id=?",bn+".rev=?"]),aH=[aI,aE.rev]):(aF=hK(fu,[hf,bn],i7,hf+".id=?"),aH=[aI]),aL.executeSql(aF,aH,function(aO,aN){if(!aN.rows.length){return aG=ho(ga,"missing"),aD()}var aM=aN.rows.item(0);return aJ=ht(aM.metadata),aM.deleted&&!aE.rev?(aG=ho(ga,"deleted"),aD()):(aC=hm(aM.data,aJ.id,aM.rev),void aD())})},ab._allDocs=function(aE,aL){var aO,aF=[],aD="startkey" in aE?aE.startkey:!1,aI="endkey" in aE?aE.endkey:!1,aN="key" in aE?aE.key:!1,aK="descending" in aE?aE.descending:!1,aM="limit" in aE?aE.limit:-1,aP="skip" in aE?aE.skip:0,aG=aE.inclusive_end!==!1,aJ=[],aC=[];if(aN!==!1){aC.push(hf+".id = ?"),aJ.push(aN)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aC.push(hf+".id "+(aK?"<=":">=")+" ?"),aJ.push(aD)),aI!==!1){var aH=aK?">":"<";aG&&(aH+="="),aC.push(hf+".id "+aH+" ?"),aJ.push(aI)}aN!==!1&&(aC.push(hf+".id = ?"),aJ.push(aN))}}"ok"!==aE.deleted&&aC.push(bn+".deleted = 0"),ah.readTransaction(function(aQ){aw(aQ,function(aS){if(aO=aS,0!==aM){var aR=hK(fu,[hf,bn],i7,aC,hf+".id "+(aK?"DESC":"ASC"));aR+=" LIMIT "+aM+" OFFSET "+aP,aQ.executeSql(aR,aJ,function(aU,aX){for(var aW=0,aV=aX.rows.length;aV>aW;aW++){var ba=aX.rows.item(aW),aY=ht(ba.metadata),aZ=aY.id,bb=hm(ba.data,aZ,ba.rev),aT=bb._rev,bc={id:aZ,key:aZ,value:{rev:aT}};if(aE.include_docs&&(bc.doc=bb,bc.doc._rev=aT,aE.conflicts&&(bc.doc._conflicts=i(aY)),hQ(bc.doc,aE,ab,aU)),ba.deleted){if("ok"!==aE.deleted){continue}bc.value.deleted=!0,bc.doc=null}aF.push(bc)}})}})},a8(aL),function(){aL(null,{total_rows:aO,offset:aE.skip,rows:aF})})},ab._changes=function(aH){function aD(){var aM=hf+".json AS metadata, "+hf+".max_seq AS maxSeq, "+bn+".json AS winningDoc, "+bn+".rev AS winningRev ",aL=hf+" JOIN "+bn,aN=hf+".id="+bn+".doc_id AND "+hf+".winningseq="+bn+".seq",aO=["maxSeq > ?"],aR=[aH.since];aH.doc_ids&&(aO.push(hf+".id IN "+gd(aH.doc_ids.length)),aR=aR.concat(aH.doc_ids));var aK="maxSeq "+(aI?"DESC":"ASC"),aQ=hK(aM,aL,aN,aO,aK),aS=H(aH);aH.view||aH.filter||(aQ+=" LIMIT "+aE);var aP=aH.since||0;ah.readTransaction(function(aT){aT.executeSql(aQ,aR,function(aU,bb){function bc(bf){return function(){aH.onChange(bf)}}for(var aV=0,aX=bb.rows.length;aX>aV;aV++){var aZ=bb.rows.item(aV),ba=ht(aZ.metadata);aP=aZ.maxSeq;var aY=hm(aZ.winningDoc,ba.id,aZ.winningRev),aW=aH.processChange(aY,ba,aH);aW.seq=aZ.maxSeq;var bd=aS(aW);if("object"==typeof bd){return aH.complete(bd)}if(bd&&(aJ++,aF&&aG.push(aW),aH.attachments&&aH.include_docs?hQ(aY,aH,ab,aU,bc(aW)):bc(aW)()),aJ===aE){break}}})},a8(aH.complete),function(){aH.continuous||aH.complete(null,{results:aG,last_seq:aP})})}if(aH=gD(aH),aH.continuous){var aC=ab._name+":"+a4();return iU.Changes.addListener(ab._name,aC,ab,aH),iU.Changes.notify(ab._name),{cancel:function(){iU.Changes.removeListener(ab._name,aC)}}}var aI=aH.descending;aH.since=aH.since&&!aI?aH.since:0;var aE="limit" in aH?aH.limit:-1;0===aE&&(aE=1);var aF;aF="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var aG=[],aJ=0;aD()},ab._close=function(aC){aC()},ab._getAttachment=function(aH,aD,aC){var aI,aE=aD.ctx,aF=aH.digest,aG=aH.content_type,aJ="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+ae+" WHERE digest=?";aE.executeSql(aJ,[aF],function(aN,aM){var aL=aM.rows.item(0),aK=aL.escaped?gM(aL.body):h6(aL.body,az);aI=aD.binary?V(aK,aG):gy(aK),aC(null,aI)})},ab._getRevisionTree=function(aC,aD){ah.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+hf+" WHERE id = ?";aE.executeSql(aF,[aC],function(aG,aI){if(aI.rows.length){var aH=ht(aI.rows.item(0).metadata);aD(null,aH.rev_tree)}else{aD(ho(ga))}})})},ab._doCompaction=function(aD,aE,aC){return aE.length?void ah.transaction(function(aF){var aG="SELECT json AS metadata FROM "+hf+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aH){var aK=ht(aH.rows.item(0).metadata);s(aK.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aI="UPDATE "+hf+" SET json = ? WHERE id = ?";aJ.executeSql(aI,[l(aK),aD])}),hs(aE,aD,aF)},a8(aC),function(){aC()}):aC()},ab._getLocal=function(aC,aD){ah.readTransaction(function(aE){var aF="SELECT json, rev FROM "+fc+" WHERE id=?";aE.executeSql(aF,[aC],function(aG,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=hm(aH.json,aC,aH.rev);aD(null,aJ)}else{aD(ho(ga))}})})},ab._putLocal=function(aG,aD,aI){function aK(aN){var aL,aM;aH?(aL="UPDATE "+fc+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aJ,aE,aF,aH]):(aL="INSERT INTO "+fc+" (id, rev, json) VALUES (?,?,?)",aM=[aF,aJ,aE]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aC={ok:!0,id:aF,rev:aJ},aD.ctx&&aI(null,aC)):aI(ho(h2))},function(){return aI(ho(h2)),!1})}"function"==typeof aD&&(aI=aD,aD={}),delete aG._revisions;var aJ,aH=aG._rev,aF=aG._id;aJ=aH?aG._rev="0-"+(parseInt(aH.split("-")[1],10)+1):aG._rev="0-1";var aC,aE=K(aG);aD.ctx?aK(aD.ctx):ah.transaction(aK,a8(aI),function(){aC&&aI(null,aC)})},ab._removeLocal=function(aE,aG,aC){function aF(aI){var aJ="DELETE FROM "+fc+" WHERE id=? AND rev=?",aH=[aE._id,aE._rev];aI.executeSql(aJ,aH,function(aL,aK){return aK.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(ho(ga))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ah.transaction(aF,a8(aC),function(){aD&&aC(null,aD)})},ab._destroy=function(aC,aD){iU.Changes.removeAllListeners(ab._name),ah.transaction(function(aE){var aF=[hf,bn,ae,ir,fc,gN];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},a8(aD),function(){iy()&&(delete window.localStorage["_pouch__websqldb_"+ab._name],delete window.localStorage[ab._name]),aD(null,{ok:!0})})}}function ct(ab,t,aa){try{ab.apply(t,aa)}catch(ac){"undefined"!=typeof PouchDB&&PouchDB.emit("error",ac)}}function hB(){if(!fq.running&&fq.queue.length){fq.running=!0;var t=fq.queue.shift();t.action(function(ab,aa){ct(t.callback,this,[ab,aa]),fq.running=!1,iO.nextTick(hB)})}}function iW(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(ho(hp,aa,ab.type))}}function dn(aa,ab,t){return{data:l(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function i1(aa){if(!aa){return null}var t=ht(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function hC(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function M(ab,t,aa,ac){aa?ac(ab?"string"!=typeof ab?ab:fo(ab,t):gT([""],{type:t})):ab?"string"!=typeof ab?dr(ab,function(ad){ac(gy(ad))}):ac(ab):ac("")}function D(ab,t,ah,ac){function aa(){++ad===ag.length&&ac&&ac()}function af(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ah.objectStore(X).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,aa()}}var ag=Object.keys(ab._attachments||{});if(!ag.length){return ac&&ac()}var ad=0;ag.forEach(function(aj){t.attachments&&t.include_docs?af(ab,aj):(ab._attachments[aj].stub=!0,aa())})}function ic(aa,t){return fg.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return fg.all(ab.map(function(ad){var ag=ac.doc._attachments[ad];if("body" in ag){var af=ag.body,ah=ag.content_type;return new fg(function(aj){M(af,ah,t,function(ak){ac.doc._attachments[ad]=dt.extend(cn(ag,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function fj(ad,aa,ag){function aj(){t--,t||ah()}function ah(){af.length&&af.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ak["delete"](am)}})}var af=[],ac=ag.objectStore(an),ak=ag.objectStore(X),ab=ag.objectStore(fr),t=ad.length;ad.forEach(function(al){var am=ac.index("_doc_id_rev"),ap=aa+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return aj()}ac["delete"](av);var aq=ab.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];af.push(aw),ab["delete"](ay.primaryKey),ay["continue"]()}else{aj()}}}})}function gl(ab,t,aa){try{return{txn:ab.transaction(t,aa)}}catch(ac){return{error:ac}}}function N(aE,am,ad,aq,aB,ac,aC){function t(){var aO=[Z,an,X,fw,fU,fr],aP=gl(aB,aO,"readwrite");return aP.error?aC(aP.error):(al=aP.txn,al.onabort=iW(aC),al.ontimeout=iW(aC),al.oncomplete=aL,aH=al.objectStore(Z),ay=al.objectStore(an),aF=al.objectStore(X),aD=al.objectStore(fr),void aN(function(aQ){return aQ?(aK=!0,aC(aQ)):void ah()}))}function ab(){f9(aE.revs_limit,ap,aq,az,al,aG,aj,ad)}function ah(){function aR(){++aP===ap.length&&ab()}function aT(aW){var aV=i1(aW.target.result);aV&&az.set(aV.id,aV),aR()}if(ap.length){for(var aP=0,aS=0,aQ=ap.length;aQ>aS;aS++){var aU=ap[aS];if(aU._id&&fm(aU._id)){aR()}else{var aO=aH.get(aU.metadata.id);aO.onsuccess=aT}}}}function aL(){aK||(ac.notify(aq._meta.name),aq._meta.docCount+=aA,aC(null,aG))}function aw(aP,aQ){var aO=aF.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=ho(et,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(ap.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){aw(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function aj(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?af(aR,aX,aT,aU,aP,aW):void ak(aR,aX,aT,aU,aP,aW)}function aa(aO){var aP=gu(aO.metadata);fj(aP,aO.metadata.id,al)}function ak(aZ,aU,aR,aS,aP,aW){function aT(bc){aS&&aq.auto_compaction&&aa(aZ),aQ.seq=bc.target.result,delete aQ.rev;var ba=dn(aQ,aU,aR),bb=aH.put(ba);bb.onsuccess=aX}function aV(ba){ba.preventDefault(),ba.stopPropagation();var bb=ay.index("_doc_id_rev"),bc=bb.getKey(aO._doc_id_rev);bc.onsuccess=function(bd){var bf=ay.put(aO,bd.target.result);bf.onsuccess=aT}}function aX(){aG[aP]={ok:!0,id:aQ.id,rev:aU},az.set(aZ.metadata.id,aZ.metadata),av(aZ,aQ.seq,aW)}var aO=aZ.data,aQ=aZ.metadata;aO._doc_id_rev=aQ.id+"::"+aQ.rev,delete aO._id,delete aO._rev;var aY=ay.put(aO);aY.onsuccess=aT,aY.onerror=aV}function af(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&ak(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(aZ){var bb=aQ.data._attachments[aZ];if(bb.stub){aP++,aO()}else{var ba=bb.data;delete bb.data;var bc=bb.digest;aM(bc,ba,aW)}})}function av(aT,aO,aR){function aU(){++aP===aQ.length&&aR()}function aS(aW){var aX=aT.data._attachments[aW].digest,aY=aD.put({seq:aO,digestSeq:aX+"::"+aO});aY.onsuccess=aU,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aU()}}var aP=0,aQ=Object.keys(aT.data._attachments||{});if(!aQ.length){return aR()}for(var aV=0;aV<aQ.length;aV++){aS(aQ[aV])}}function aM(aP,aR,aO){var aQ=aF.count(aP);aQ.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aO()}var aU={digest:aP,body:aR},aV=aF.put(aU);aV.onsuccess=aO}}for(var al,aH,ay,aF,aD,ax,ap=am.docs,aA=0,aI=0,ag=ap.length;ag>aI;aI++){var aJ=ap[aI];aJ._id&&fm(aJ._id)||(aJ=ap[aI]=h7(aJ,ad.new_edits),aJ.error&&!ax&&(ax=aJ))}if(ax){return aC(ax)}var aG=new Array(ap.length),az=new jb.Map,aK=!1,au=aq._meta.blobSupport?"blob":"base64";hc(ap,au,function(aO){return aO?aC(aO):void t()})}function eq(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function ei(ab,t,aa,ac){return"DataError"===aa.name&&0===aa.code?ac(null,{total_rows:ab._meta.docCount,offset:t.skip,rows:[]}):void ac(ho(hp,aa.name,aa.message))}function Y(ab,ad,t,ac){function aa(aG,aE){function aw(aN,aK,aM){var aL=aN.id+"::"+aM;aJ.get(aL).onsuccess=function(aO){aK.doc=hC(aO.target.result),aG.conflicts&&(aK.doc._conflicts=i(aN)),D(aK.doc,aG,aF)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===aG.deleted){aI.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):aG.include_docs&&aw(aL,aN,aK)}else{if(!aO&&ah--<=0&&(aI.push(aN),aG.include_docs&&aw(aL,aN,aK),0===--aj)){return}}aM["continue"]()}function aB(aM){ag=ad._meta.docCount;var aK=aM.target.result;if(aK){var aN=i1(aK.value),aL=aN.winningRev;av(aK,aL,aN)}}function aH(){aE(null,{total_rows:ag,offset:aG.skip,rows:aI})}function ak(){aG.attachments?ic(aI,aG.binary).then(aH):aH()}var am="startkey" in aG?aG.startkey:!1,ay="endkey" in aG?aG.endkey:!1,al="key" in aG?aG.key:!1,ah=aG.skip||0,aj="number"==typeof aG.limit?aG.limit:-1,aC=aG.inclusive_end!==!1,ax="descending" in aG&&aG.descending?"prev":null,aA=eq(am,ay,aC,al,ax);if(aA&&aA.error){return ei(ad,aG,aA.error,aE)}var aD=[Z,an];aG.attachments&&aD.push(X);var aq=gl(t,aD,"readonly");if(aq.error){return aE(aq.error)}var aF=aq.txn,au=aF.objectStore(Z),az=aF.objectStore(an),ap=ax?au.openCursor(aA,ax):au.openCursor(aA),aJ=az.index("_doc_id_rev"),aI=[],ag=0;aF.oncomplete=ak,ap.onsuccess=aB}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ad._meta.docCount,offset:ah.skip,rows:[]}):void aa(ah,ag)}af(ab,ac)}function hR(t){return new fg(function(ab){var aa=gT([""]);t.objectStore(en).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function iR(aa,ab){var t=this;fq.queue.push({action:function(ac){f3(t,aa,ac)},callback:ab}),hB()}function f3(ag,ak,ac){function aa(av){var aw=av.createObjectStore(Z,{keyPath:"id"});av.createObjectStore(an,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(X,{keyPath:"digest"}),av.createObjectStore(fw,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(en),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(fU,{keyPath:"_id"});var au=av.createObjectStore(fr,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ap(av,aw){var au=av.objectStore(Z);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=fp(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function ad(au){au.createObjectStore(fU,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function al(ay,ax){var av=ay.objectStore(fU),az=ay.objectStore(Z),aw=ay.objectStore(an),au=az.openCursor();au.onsuccess=function(aL){var aC=aL.target.result;if(aC){var aI=aC.value,aF=aI.id,aG=fm(aF),aJ=h(aI);if(aG){var aA=aF+"::"+aJ,aD=aF+"::",aK=aF+"::~",aB=aw.index("_doc_id_rev"),aE=IDBKeyRange.bound(aD,aK,!1,!1),aH=aB.openCursor(aE);aH.onsuccess=function(aN){if(aH=aN.target.result){var aM=aH.value;aM._doc_id_rev===aA&&av.put(aM),aw["delete"](aH.primaryKey),aH["continue"]()}else{az["delete"](aC.primaryKey),aC["continue"]()}}}else{aC["continue"]()}}else{ax&&ax()}}}function aq(au){var av=au.createObjectStore(fr,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function af(ay,ax){var av=ay.objectStore(an),az=ay.objectStore(X),aw=ay.objectStore(fr),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (av.openCursor().onsuccess=function(aL){var aF=aL.target.result;if(!aF){return ax()}for(var aG=aF.value,aD=aF.primaryKey,aJ=Object.keys(aG._attachments||{}),aH={},aI=0;aI<aJ.length;aI++){var aK=aG._attachments[aJ[aI]];aH[aK.digest]=!0}var aC=Object.keys(aH);for(aI=0;aI<aC.length;aI++){var aE=aC[aI];aw.put({seq:aD,digestSeq:aE+"::"+aD})}aF["continue"]()}):ax()}}function ah(au){function ax(az){return az.data?i1(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=au.objectStore(an),av=au.objectStore(Z),ay=av.openCursor();ay.onsuccess=function(aC){function az(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=dn(aD,aD.winningRev,aD.deleted),aF=av.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=aC.target.result;if(aB){var aD=ax(aB.value);return aD.winningRev=aD.winningRev||h(aD),aD.seq?aA():void az()}}}var ab=ak.name,aj=null;ag._meta=null,ag.type=function(){return"idb"},ag._id=ar(function(au){au(null,ag._meta.instanceId)}),ag._bulkDocs=function(au,aw,av){N(ak,au,aw,ag,aj,iR.Changes,av)},ag._get=function(aw,aB,ax){function az(){ax(av,{doc:ay,metadata:aC,ctx:aA})}var ay,aC,av,aA=aB.ctx;if(!aA){var au=gl(aj,[Z,an,X],"readonly");if(au.error){return ax(au.error)}aA=au.txn}aA.objectStore(Z).get(aw).onsuccess=function(aG){if(aC=i1(aG.target.result),!aC){return av=ho(ga,"missing"),az()}if(fp(aC)&&!aB.rev){return av=ho(ga,"deleted"),az()}var aE=aA.objectStore(an),aD=aB.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return ay=aH.target.result,ay&&(ay=hC(ay)),ay?void az():(av=ho(ga,"missing"),az())}}},ag._getAttachment=function(ay,aA,av){var aw;if(aA.ctx){aw=aA.ctx}else{var az=gl(aj,[Z,an,X],"readonly");if(az.error){return av(az.error)}aw=az.txn}var au=ay.digest,ax=ay.content_type;aw.objectStore(X).get(au).onsuccess=function(aC){var aB=aC.target.result.body;M(aB,ax,aA.binary,function(aD){av(null,aD)})}},ag._info=function(aA){if(null===aj||!fS[ab]){var aw=new Error("db isn't open");return aw.id="idbNull",aA(aw)}var av,az,au=gl(aj,[an],"readonly");if(au.error){return aA(au.error)}var ax=au.txn,ay=ax.objectStore(an).openCursor(null,"prev");ay.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,az=ag._meta.docCount},ax.oncomplete=function(){aA(null,{doc_count:az,update_seq:av,idb_attachment_format:ag._meta.blobSupport?"binary":"base64"})}},ag._allDocs=function(av,au){Y(av,ag,aj,au)},ag._changes=function(aB){function au(aP){function aM(){return aS.seq!==aR?aP["continue"]():(aw=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aI.get(aU);aT.onsuccess=function(aV){aN(hC(aV.target.result))}}function aN(aU){var aT=aB.processChange(aU,aS,aB);aT.seq=aS.seq;var aV=aA(aT);return"object"==typeof aV?aB.complete(aV):(aV&&(ax++,aJ&&aK.push(aT),aB.attachments&&aB.include_docs?D(aU,aB,aD,function(){ic([aT],aB.binary).then(function(){aB.onChange(aT)})}):aB.onChange(aT)),void (ax!==aC&&aP["continue"]()))}var aQ=hC(aP.value),aR=aP.key;if(az&&!az.has(aQ._id)){return aP["continue"]()}var aS;return(aS=ay.get(aQ._id))?aM():void (av.get(aQ._id).onsuccess=function(aT){aS=i1(aT.target.result),ay.set(aQ._id,aS),aM()})}function aL(aN){var aM=aN.target.result;aM&&au(aM)}function aH(){var aM=[Z,an];aB.attachments&&aM.push(X);var aN=gl(aj,aM,"readonly");if(aN.error){return aB.complete(aN.error)}aD=aN.txn,aD.onabort=iW(aB.complete),aD.oncomplete=aE,aF=aD.objectStore(an),av=aD.objectStore(Z),aI=aF.index("_doc_id_rev");var aO;aO=aB.descending?aF.openCursor(null,"prev"):aF.openCursor(IDBKeyRange.lowerBound(aB.since,!0)),aO.onsuccess=aL}function aE(){function aM(){aB.complete(null,{results:aK,last_seq:aw})}!aB.continuous&&aB.attachments?ic(aK).then(aM):aM()}if(aB=gD(aB),aB.continuous){var aG=ab+":"+a4();return iR.Changes.addListener(ab,aG,ag,aB),iR.Changes.notify(ab),{cancel:function(){iR.Changes.removeListener(ab,aG)}}}var az=aB.doc_ids&&new jb.Set(aB.doc_ids);aB.since=aB.since||0;var aw=aB.since,aC="limit" in aB?aB.limit:-1;0===aC&&(aC=1);var aJ;aJ="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aD,aF,av,aI,aK=[],ax=0,aA=H(aB),ay=new jb.Map;aH()},ag._close=function(au){return null===aj?au(ho(fx)):(aj.close(),delete fS[ab],aj=null,void au())},ag._getRevisionTree=function(au,ax){var aw=gl(aj,[Z],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(Z).get(au);ay.onsuccess=function(aA){var az=i1(aA.target.result);az?ax(null,az.rev_tree):ax(ho(ga))}},ag._doCompaction=function(ay,aA,av){var aw=[Z,an,X,fr],az=gl(aj,aw,"readwrite");if(az.error){return av(az.error)}var au=az.txn,ax=au.objectStore(Z);ax.get(ay).onsuccess=function(aC){var aE=i1(aC.target.result);s(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==aA.indexOf(aF)&&(aK.status="missing")}),fj(aA,ay,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(Z).put(dn(aE,aD,aB))},au.onabort=iW(av),au.oncomplete=function(){av()}},ag._getLocal=function(au,ax){var aw=gl(aj,[fU],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(fU).get(au);ay.onerror=iW(ax),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(ho(ga))}},ag._putLocal=function(ay,aD,az){"function"==typeof aD&&(az=aD,aD={}),delete ay._revisions;var aB=ay._rev,aA=ay._id;aB?ay._rev="0-"+(parseInt(aB.split("-")[1],10)+1):ay._rev="0-1";var av,aw=aD.ctx;if(!aw){var aC=gl(aj,[fU],"readwrite");if(aC.error){return az(aC.error)}aw=aC.txn,aw.onerror=iW(az),aw.oncomplete=function(){av&&az(null,av)}}var au,ax=aw.objectStore(fU);aB?(au=ax.get(aA),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aB){var aG=ax.put(ay);aG.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)}}else{az(ho(h2))}}):(au=ax.add(ay),au.onerror=function(aE){az(ho(h2)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)})},ag._removeLocal=function(aw,aB,ax){"function"==typeof aB&&(ax=aB,aB={});var az=aB.ctx;if(!az){var ay=gl(aj,[fU],"readwrite");if(ay.error){return ax(ay.error)}az=ay.txn,az.oncomplete=function(){aC&&ax(null,aC)}}var aC,av=aw._id,aA=az.objectStore(fU),au=aA.get(av);au.onerror=iW(ax),au.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aw._rev?(aA["delete"](av),aC={ok:!0,id:av,rev:"0-0"},aB.ctx&&ax(null,aC)):ax(ho(ga))}},ag._destroy=function(av,aw){iR.Changes.removeAllListeners(ab),iR.openReqList[ab]&&iR.openReqList[ab].result&&(iR.openReqList[ab].result.close(),delete fS[ab]);var au=indexedDB.deleteDatabase(ab);au.onsuccess=function(){iR.openReqList[ab]&&(iR.openReqList[ab]=null),iy()&&ab in localStorage&&delete localStorage[ab],aw(null,{ok:!0})},au.onerror=iW(aw)};var am=fS[ab];if(am){return aj=am.idb,ag._meta=am.global,void iO.nextTick(function(){ac(null,ag)})}var t;t=ak.storage?ey(ab,ak.storage):indexedDB.open(ab,fa),"openReqList" in iR||(iR.openReqList={}),iR.openReqList[ab]=t,t.onupgradeneeded=function(ay){function av(){var aA=aw[au-1];au++,aA&&aA(az,av)}var ax=ay.target.result;if(ay.oldVersion<1){return aa(ax)}var az=ay.currentTarget.transaction;ay.oldVersion<3&&ad(ax),ay.oldVersion<4&&aq(ax);var aw=[ap,al,af,ah],au=ay.oldVersion;av()},t.onsuccess=function(az){aj=az.target.result,aj.onversionchange=function(){aj.close(),delete fS[ab]},aj.onabort=function(aA){console.error("Database has a global failure",aA.target.error),aj.close(),delete fS[ab]};var av=aj.transaction([fw,en,Z],"readwrite"),aw=av.objectStore(fw).get(fw),ax=null,ay=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ax&&null!==ay&&null!==au&&(ag._meta={name:ab,instanceId:au,blobSupport:ax,docCount:ay},fS[ab]={idb:aj,global:ag._meta},ac(null,ag))},aA=aB.target.result||{id:fw};ab+"_id" in aA?(au=aA[ab+"_id"],aD()):(au=a4(),aA[ab+"_id"]=au,av.objectStore(fw).put(aA).onsuccess=function(){aD()}),m||(m=hR(av)),m.then(function(aE){ax=aE,aD()});var aC=av.objectStore(Z).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ay=aE.target.result,aD()}}},t.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),ac(ho(hp,av))}}function ey(aa,ab){try{return indexedDB.open(aa,{version:fa,storage:ab})}catch(t){return indexedDB.open(aa,fa)}}var dt=b(7),g6="default" in dt?dt["default"]:dt,br=b(6);br="default" in br?br["default"]:br;var jb=b(12);jb="default" in jb?jb["default"]:jb;var jc=b(4),n=b(1);n="default" in n?n["default"]:n;var hj=b(2);hj="default" in hj?hj["default"]:hj;var hF=b(10),ip="default" in hF?hF["default"]:hF,g7=b(8);g7="default" in g7?g7["default"]:g7;var hy=b(14);hy="default" in hy?hy["default"]:hy;var iH=b(15);iH="default" in iH?iH["default"]:iH;var hH=b(16);hH="default" in hH?hH["default"]:hH;var fg="function"==typeof Promise?Promise:g7,hW=T();br(hE,Error),hE.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var iE=new hE({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),a6=new hE({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ga=new hE({status:404,error:"not_found",reason:"missing"}),h2=new hE({status:409,error:"conflict",reason:"Document update conflict"}),y=new hE({status:400,error:"invalid_id",reason:"_id field must contain a string"}),iq=new hE({status:412,error:"missing_id",reason:"_id is required for puts"}),a3=new hE({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),fx=new hE({status:412,error:"precondition_failed",reason:"Database not open"}),iS=new hE({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),fv=new hE({status:500,error:"badarg",reason:"Some query argument is invalid"}),iL=new hE({status:400,error:"invalid_request",reason:"Request was invalid"}),hT=new hE({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ih=new hE({status:500,error:"doc_validation",reason:"Bad special document member"}),iA=new hE({status:400,error:"bad_request",reason:"Something wrong with the request"}),x=new hE({status:400,error:"bad_request",reason:"Document must be a JSON object"}),fy=new hE({status:404,error:"not_found",reason:"Database not found"}),hp=new hE({status:500,error:"indexed_db_went_bad",reason:"unknown"}),i4=new hE({status:500,error:"web_sql_went_bad",reason:"unknown"}),f7=new hE({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),h8=new hE({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),co=new hE({status:400,error:"bad_request",reason:"Invalid rev format"}),id=new hE({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),et=new hE({status:412,error:"missing_stub"}),hL=new hE({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),fX={UNAUTHORIZED:iE,MISSING_BULK_DOCS:a6,MISSING_DOC:ga,REV_CONFLICT:h2,INVALID_ID:y,MISSING_ID:iq,RESERVED_ID:a3,NOT_OPEN:fx,UNKNOWN_ERROR:iS,BAD_ARG:fv,INVALID_REQUEST:iL,QUERY_PARSE_ERROR:hT,DOC_VALIDATION:ih,BAD_REQUEST:iA,NOT_AN_OBJECT:x,DB_MISSING:fy,WSQ_ERROR:i4,LDB_ERROR:f7,FORBIDDEN:h8,INVALID_REV:co,FILE_EXISTS:id,MISSING_STUB:et,IDB_ERROR:hp,INVALID_URL:hL},a5=function(ab,ad,t){var ac=Object.keys(fX).filter(function(af){var ag=fX[af];return"function"!=typeof ag&&ag[ab]===ad}),aa=t&&ac.filter(function(af){var ag=fX[af];return ag.message===t})[0]||ac[0];return aa?fX[aa]:null},f=function(){},v=hj("pouchdb:api");br(A,jc.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=gD(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=hb,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=F(ab.view):ab.filter=F(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=n(function(af){ac.cancel(),aa.apply(this,af)})}},A.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=ho(iA,"`view` filter parameter not found or invalid.");return t(ac)}var aa=a9(ab.view);this.db.get("_design/"+aa[0],function(ag,ah){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ag){return t(f6(ag))}var aj=ah&&ah.views&&ah.views[aa[1]]&&ah.views[aa[1]].map;return aj?(ab.filter=i9(aj),void ad.doChanges(ab)):t(ho(ga,ah.views?"missing json key: "+aa[1]:"missing json key: views"))})}else{var af=a9(ab.filter);if(!af){return ad.doChanges(ab)}this.db.get("_design/"+af[0],function(aj,ah){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(aj){return t(f6(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(ab.filter=g4(ag),void ad.doChanges(ab)):t(ho(ga,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),at=j(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hg=j(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);br(de,jc.EventEmitter),de.prototype.post=be("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(ho(x)):void this.bulkDocs({docs:[aa]},ab,hG(t))}),de.prototype.put=be("put",n(function(aa){var ac,ag,ab,t,ad=aa.shift(),af="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(t=aa.pop())(ho(x))}for(;;){if(ac=aa.shift(),ag=typeof ac,"string"!==ag||af?"string"!==ag||!af||"_rev" in ad?"object"===ag?ab=ac:"function"===ag&&(t=ac):ad._rev=ac:(ad._id=ac,af=!0),!aa.length){break}}return ab=ab||{},C(ad._id),fm(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,t):this._putLocal(ad,t):void this.bulkDocs({docs:[ad]},ab,hG(t))})),de.prototype.putAttachment=be("putAttachment",function(ab,t,ah,ac,aa,af){function ag(aj){return aj._attachments=aj._attachments||{},aj._attachments[t]={content_type:aa,data:ac},ad.put(aj)}var ad=this;return"function"==typeof aa&&(af=aa,aa=ac,ac=ah,ah=null),"undefined"==typeof aa&&(aa=ac,ac=ah,ah=null),ad.get(ab).then(function(aj){if(aj._rev!==ah){throw ho(h2)}return ag(aj)},function(aj){if(aj.reason===ga.message){return ag({_id:ab})}throw aj})}),de.prototype.removeAttachment=be("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(ho(h2)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),de.prototype.remove=be("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,fm(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,hG(ac))}),de.prototype.revsDiff=be("revsDiff",function(ab,t,ah){function ac(ak,aj){ad.has(ak)||ad.set(ak,{missing:[]}),ad.get(ak).missing.push(aj)}function aa(aj,ak){var al=ab[aj].slice(0);s(ak,function(am,ap,aq,aw,av){var au=ap+"-"+aq,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==av.status&&ac(aj,au))}),al.forEach(function(am){ac(aj,am)})}"function"==typeof t&&(ah=t,t={});var af=Object.keys(ab);if(!af.length){return ah(null,{})}var ag=0,ad=new jb.Map;af.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ad.set(aj,{missing:ab[aj]})}else{if(al){return ah(al)}aa(aj,am)}if(++ag===af.length){var ak={};return ad.forEach(function(ap,aq){ak[aq]=ap}),ah(null,ak)}})},this)}),de.prototype.bulkGet=be("bulkGet",function(aa,t){hA(this,aa,t)}),de.prototype.compactDocument=be("compactDocument",function(ab,t,aa){var ac=this;this._getRevisionTree(ab,function(ah,ad){if(ah){return aa(ah)}var ag=eo(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>t&&aj.push(ak)}),s(ad,function(au,al,ap,ak,aq){var am=al+"-"+ap;"available"===aq.status&&-1!==aj.indexOf(am)&&af.push(am)}),ac._doCompaction(ab,af,aa)})}),de.prototype.compact=be("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&gZ(t)}),de.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(aj){var ah=aj.last_seq;fg.all(af).then(function(){return gq(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},de.prototype.get=be("get",function(ab,t,ah){function ac(){var ak=[],aj=aa.length;return aj?void aa.forEach(function(al){af.get(ab,{rev:al,revs:t.revs,attachments:t.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ah(null,ak)})}):ah(null,ak)}if("function"==typeof t&&(ah=t,t={}),"string"!=typeof ab){return ah(ho(y))}if(fm(ab)&&"function"==typeof this._getLocal){return this._getLocal(ab,ah)}var aa=[],af=this;if(!t.open_revs){return this._get(ab,t,function(ax,aB){if(ax){return ah(ax)}var aA=aB.doc,az=aB.metadata,am=aB.ctx;if(t.conflicts){var ap=i(az);ap.length&&(aA._conflicts=ap)}if(fp(az,aA._rev)&&(aA._deleted=!0),t.revs||t.revs_info){var au=E(az.rev_tree),aj=gA(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aA._rev.split("-")[1])}),aq=aj.ids.map(function(aC){return aC.id}).indexOf(aA._rev.split("-")[1])+1,aw=aj.ids.length-aq;if(aj.ids.splice(aq,aw),aj.ids.reverse(),t.revs&&(aA._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),t.revs_info){var ay=aj.pos+aj.ids.length;aA._revs_info=aj.ids.map(function(aC){return ay--,{rev:ay+"-"+aC.id,status:aC.opts.status}})}}if(t.attachments&&aA._attachments){var av=aA._attachments,al=Object.keys(av).length;if(0===al){return ah(null,aA)}Object.keys(av).forEach(function(aC){this._getAttachment(av[aC],{binary:t.binary,ctx:am},function(aE,aD){var aF=aA._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--al||ah(null,aA)})},af)}else{if(aA._attachments){for(var ak in aA._attachments){aA._attachments.hasOwnProperty(ak)&&(aA._attachments[ak].stub=!0)}}ah(null,aA)}})}if("all"===t.open_revs){this._getRevisionTree(ab,function(ak,aj){return ak?ah(ak):(aa=gb(aj).map(function(al){return al.rev}),void ac())})}else{if(!Array.isArray(t.open_revs)){return ah(ho(iS,"function_clause"))}aa=t.open_revs;for(var ag=0;ag<aa.length;ag++){var ad=aa[ag];if("string"!=typeof ad||!/^\d+-/.test(ad)){return ah(ho(co))}}ac()}}),de.prototype.getAttachment=be("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ag.doc._attachments[ad],t,ac),void 0):ac(ho(ga))})}),de.prototype.allDocs=be("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(ho(hT,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return fi(this,aa,ab)}}return this._allDocs(aa,ab)}),de.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new A(this,aa,t)},de.prototype.close=be("close",function(t){return this._closed=!0,this._close(t)}),de.prototype.info=be("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),de.prototype.id=be("id",function(t){return this._id(t)}),de.prototype.bulkDocs=be("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(ho(a6))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(ho(x))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||h3(ag)})}),aa?t(ho(iA,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(ig),iT(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),de.prototype.registerDependentDatabase=be("registerDependentDatabase",function(ab,t){function aa(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ab]?!1:(ad.dependentDbs[ab]=!0,ad)}var ac=new this.constructor(ab,this.__opts);gq(this,"_local/_pouch_dependentDbs",aa).then(function(){t(null,{db:ac})})["catch"](t)}),de.prototype.destroy=be("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});fg.all(af).then(t,ad)})}),I.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},I.prototype.fail=function(t){this.failed=t,this.execute()},I.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},I.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},br(hN,de),hN.debug=hj;var gn;if(U()){gn=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),gn=!!localStorage.getItem("_pouch_check_localstorage")}catch(gS){gn=!1}}hN.adapters={},hN.preferredAdapters=[],hN.prefix="_pouch_";var ib=new jc.EventEmitter;ez(hN),hN.parseAdapter=function(ab,t){var ah,ac,aa=ab.match(/([a-z\-]*):\/\/(.*)/);if(aa){if(ab=/http(s?)/.test(aa[1])?aa[1]+"://"+aa[2]:aa[2],ah=aa[1],!hN.adapters[ah].valid()){throw"Invalid adapter"}return{name:ab,adapter:aa[1]}}var af="idb" in hN.adapters&&"websql" in hN.adapters&&iy()&&localStorage["_pouch__websqldb_"+hN.prefix+ab];if(t.adapter){ac=t.adapter}else{if("undefined"!=typeof t&&t.db){ac="leveldb"}else{for(var ag=0;ag<hN.preferredAdapters.length;++ag){if(ac=hN.preferredAdapters[ag],ac in hN.adapters){if(af&&"idb"===ac){console.log('PouchDB is downgrading "'+ab+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ah=hN.adapters[ac];var ad=ah&&"use_prefix" in ah?ah.use_prefix:!0;return{name:ad?hN.prefix+ab:ab,adapter:ac}},hN.adapter=function(aa,ab,t){ab.valid()&&(hN.adapters[aa]=ab,t&&hN.preferredAdapters.push(aa))},hN.plugin=function(t){return Object.keys(t).forEach(function(aa){hN.prototype[aa]=t[aa]}),hN},hN.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=dt.extend({},aa,ad),void hN.call(this,ab,ad,ac)):new t(ab,ad,ac)}return br(t,hN),ez(t),t.preferredAdapters=hN.preferredAdapters.slice(),Object.keys(hN).forEach(function(ab){ab in t||(t[ab]=hN[ab])}),t};var go=function(t){return atob(t)},gy=function(t){return btoa(t)},ja=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gE="queryKey",iF=/(?:^|&)([^&=]*)=?([^&]*)/g,q=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,z=g6.extend,f4={ajax:he,parseUri:g0,uuid:a4,Promise:fg,atob:go,btoa:gy,binaryStringToBlobOrBuffer:V,clone:gD,extend:z,createError:ho},iY=ip.collate,fW=1,i2="pouchdb",er=5,gW=0;B.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},B.prototype.updateTarget=function(aa,t){return gC(this.target,this.id,aa,t,this.returnValue)},B.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?fg.resolve(!0):gC(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return t.readOnlySource=!0,!0}throw ac})};var hh={undefined:function(aa,t){return 0===iY(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return ew(t,aa).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return gW}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hh?hh[ab](aa,ac):gW},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:gW}).then(function(){return gW},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):gW})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return gW})};var fh=0,io=i6.setImmediate||i6.setTimeout,h4=32768,hq=ar(function(ad,aa){function ag(){var aq=ak*af,al=aq+af;if(ak++,ac>ak){t(ab,ad,aq,al),io(ag)}else{t(ab,ad,aq,al);var ap=ab.end(!0),am=iG(ap);aa(null,am),ab.destroy()}}var aj="string"==typeof ad,ah=aj?ad.length:ad.byteLength,af=Math.min(h4,ah),ac=Math.ceil(ah/af),ak=0,ab=aj?new iH:new iH.ArrayBuffer,t=aj?h9:hV;ag()});br(ij,jc.EventEmitter),ij.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},ij.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))};var fV={replicate:iV,toPouch:gV},gc=fV.replicate;br(ji,jc.EventEmitter),ji.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var it=25,iD=50,hP={},ao=1800,hk=hj("pouchdb:http");gU.valid=function(){return !0};var hZ=function(aa,t){return t&&aa.then(function(ab){iO.nextTick(function(){t(null,ab)})},function(ab){iO.nextTick(function(){t(ab)})}),aa},ft=function(t){return n(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hZ(ab,aa),ab})},hJ=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},gQ=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},hO=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},fn={uniq:hO,sequentialize:gQ,fin:hJ,callbackify:ft,promisedCallback:hZ};iZ.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},iZ.prototype.finish=function(){return this.promise};var gg,f1=ip.collate,je=ip.toIndexableString,gt=ip.normalizeKey,iP=ip.parseIndexableString;gg="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var ff=fn.callbackify,ik=fn.sequentialize,hn=fn.uniq,h0=fn.fin,es=fn.promisedCallback,f2={},w=new iZ,gP=50,fT={_sum:function(aa,t){return iI(t)},_count:function(aa,t){return t.length},_stats:function(aa,ab){function t(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:iI(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},R=ff(function(){var t=this;return"http"===t.type()?a2(t):"function"==typeof t._viewCleanup?gL(t):gv(t)}),k=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?hv(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=fg.resolve().then(function(){return h1(ac,ab,ad)});return es(aa,t),aa};br(iN,Error),br(jd,Error),br(iv,Error);var gB={query:k,viewCleanup:R},gH=7,hf=fR("document-store"),bn=fR("by-sequence"),ae=fR("attach-store"),fc=fR("local-store"),ir=fR("metadata-store"),gN=fR("attach-seq-store"),gh={};br(iQ,jc.EventEmitter),iQ.prototype.addListener=function(aa,ac,ag,ab){function t(){function ah(){af=!1}if(ad._listeners[ac]){if(af){return void (af="waiting")}af=!0;var aj=cn(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){t()},0),af=!1}).on("error",ah)}}if(!this._listeners[ac]){var ad=this,af=!1;this._listeners[ac]=t,this.on(aa,t)}},iQ.prototype.removeListener=function(aa,t){t in this._listeners&&jc.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},iQ.prototype.notifyLocalWindows=function(t){U()?chrome.storage.local.set({dbName:t}):iy()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},iQ.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var fs=1,g2="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+bn+" (seq, deleted)",o="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+bn+" (doc_id, rev)",cr="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hf+" (winningseq)",a0="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+gN+" (seq)",eu="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+gN+" (digest, seq)",i7=bn+".seq = "+hf+".winningseq",fu=bn+".seq AS seq, "+bn+".deleted AS deleted, "+bn+".json AS data, "+bn+".rev AS rev, "+hf+".json AS metadata";iU.valid=gi,iU.Changes=new iQ;var m,fa=5,Z="document-store",an="by-sequence",X="attach-store",fr="attach-seq-store",fw="meta-store",fU="local-store",en="detect-blob-support",fq={running:!1,queue:[]},fS={};iR.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},iR.Changes=new iQ;var g5={idb:iR,websql:iU};hN.ajax=he,hN.utils=f4,hN.Errors=fX,hN.replicate=fV.replicate,hN.sync=hI,hN.version="5.2.0",hN.adapter("http",gU),hN.adapter("https",gU),hN.plugin(gB),Object.keys(g5).forEach(function(t){hN.adapter(t,g5[t],!0)}),e.exports=hN}).call(this,b(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});