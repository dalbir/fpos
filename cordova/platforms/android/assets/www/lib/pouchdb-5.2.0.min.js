!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(h,f){if(!i[h]){if(!l[h]){var g="function"==typeof require&&require;if(!f&&g){return g(h,!0)}if(e){return e(h,!0)}var j=new Error("Cannot find module '"+h+"'");throw j.code="MODULE_NOT_FOUND",j}var n=i[h]={exports:{}};l[h][0].call(n.exports,function(m){var p=l[h][1][m];return a(p?p:m)},n,n.exports,d,l,i,b)}return i[h].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var f="color: "+this.color;h=[h[0],f,"color: inherit"].concat(Array.prototype.slice.call(h,1));var j=0,g=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),h.splice(g,0,f),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(r,f,u){function b(){return u.colors[s++%u.colors.length]}function a(j){function g(){}function k(){var q=k,m=+new Date,p=m-(o||m);q.diff=p,q.prev=o,q.curr=m,o=m,null==q.useColors&&(q.useColors=u.useColors()),null==q.color&&q.useColors&&(q.color=b());var w=Array.prototype.slice.call(arguments);w[0]=u.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=u.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof u.formatArgs&&(w=u.formatArgs.apply(q,w));var v=k.log||u.log||console.log.bind(console);v.apply(q,w)}g.enabled=!1,k.enabled=!0;var h=u.enabled(j)?k:g;return h.namespace=j,h}function t(k){u.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?u.skips.push(new RegExp("^"+k.substr(1)+"$")):u.names.push(new RegExp("^"+k+"$")))}}function n(){u.enable("")}function e(g){var j,h;for(j=0,h=u.skips.length;h>j;j++){if(u.skips[j].test(g)){return !1}}for(j=0,h=u.names.length;h>j;j++){if(u.names[j].test(g)){return !0}}return !1}function i(g){return g instanceof Error?g.stack||g.message:g}u=f.exports=a,u.coerce=i,u.disable=n,u.enable=t,u.enabled=e,u.humanize=r(9),u.names=[],u.skips=[],u.formatters={};var o,s=0},{9:9}],4:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,h,r,f,l,j;if(this._events||(this._events={}),"error"===g&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(h=this._events[g],p(h)){return !1}if(o(h)){switch(arguments.length){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),h.apply(this,f)}}else{if(i(h)){for(f=Array.prototype.slice.call(arguments,1),j=h.slice(),r=j.length,l=0;r>l;l++){j[l].apply(this,f)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(i(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(e,a,b){(function(n){function u(){o=!0;for(var j,g,h=s.length;h;){for(g=s,s=[],j=-1;++j<h;){g[j]()}h=s.length}o=!1}function z(g){1!==s.push(g)||o||y()}var y,r=n.MutationObserver||n.WebKitMutationObserver;if(r){var l=0,f=new r(u),i=n.document.createTextNode("");f.observe(i,{characterData:!0}),y=function(){i.data=l=++l%2}}else{if(n.setImmediate||"undefined"==typeof n.MessageChannel){y="document" in n&&"onreadystatechange" in n.document.createElement("script")?function(){var g=n.document.createElement("script");g.onreadystatechange=function(){u(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},n.document.documentElement.appendChild(g)}:function(){setTimeout(u,0)}}else{var x=new n.MessageChannel;x.port1.onmessage=u,y=function(){x.port2.postMessage(0)}}}var o,s=[];a.exports=z}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(e,a,b){(function(f){f("object"==typeof b?b:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(n){if(n){for(var i in n){"object"==typeof n[i]&&h[i]?k.call(h,h[i],n[i]):h[i]=n[i]}}}),h};j.extend=k})},{}],8:[function(n,u,f){function o(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=h,this.queue=[],this.outcome=void 0,g!==o&&y(this,g)}function a(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function e(j,k,g){l(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function p(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=i(j);"error"===z.status&&w(z.value)}function i(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function t(g){return g instanceof this?g:K.resolve(new this(o),g)}function s(g){var j=new this(o);return K.reject(j,g)}function m(k){function x(E,D){function C(F){B[D]=F,++j!==w||A||(A=!0,K.resolve(g,B))}q.resolve(E).then(C,function(F){A||(A=!0,K.reject(g,F))})}var q=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var w=k.length,A=!1;if(!w){return this.resolve([])}for(var B=new Array(w),j=0,z=-1,g=new this(o);++z<w;){x(k[z],z)}return g}function r(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(o);++z<j;){g(k[z])}return q}var l=n(5),K={},L=["REJECTED"],b=["FULFILLED"],h=["PENDING"];u.exports=f=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===b||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(o);if(this.state!==h){var k=this.state===b?q:g;e(j,k,this.outcome)}else{this.queue.push(new a(j,q,g))}return j},a.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){e(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){K.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){e(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=i(p,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=b,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},f.resolve=t,f.reject=s,f.all=m,f.race=r},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(o,r,l){function b(m){if(null!==m){switch(typeof m){case"boolean":return m?1:0;case"number":return a(m);case"string":return m.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var j=Array.isArray(m),w=j?m:Object.keys(m),q=-1,v=w.length,g="";if(j){for(;++q<v;){g+=l.toIndexableString(w[q])}}else{for(;++q<v;){var k=w[q];g+=l.toIndexableString(k)+l.toIndexableString(m[k])}}return g}}return""}function D(k,y){var q,w=y,v="1"===k[y];if(v){q=0,y++}else{var m="0"===k[y];y++;var g="",x=k.substring(y,y+p),z=parseInt(x,10)+t;for(m&&(z=-z),y+=p;;){var j=k[y];if("\x00"===j){break}g+=j,y++}g=g.split("."),q=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),m&&(q-=10),0!==z&&(q=parseFloat(q+"e"+z))}return{num:q,length:y-w}}function h(w,q){var j=w.pop();if(q.length){var g=q[q.length-1];j===g.element&&(q.pop(),g=q[q.length-1]);var v=g.element,m=g.index;if(Array.isArray(v)){v.push(j)}else{if(m===w.length-2){var k=w.pop();v[k]=j}else{w.push(j)}}}}function s(q,j){for(var g=Math.min(q.length,j.length),m=0;g>m;m++){var k=l.collate(q[m],j[m]);if(0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(m,j){for(var w=Object.keys(m),q=Object.keys(j),v=Math.min(w.length,q.length),g=0;v>g;g++){var k=l.collate(w[g],q[g]);if(0!==k){return k}if(k=l.collate(m[w[g]],j[q[g]]),0!==k){return k}}return w.length===q.length?0:w.length>q.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(y){if(0===y){return"1"}var v=y.toExponential().split(/e\+?/),j=parseInt(v[1],10),m=0>y,k=m?"0":"2",g=(m?-j:j)-t,x=n.padLeft(g.toString(),"0",p);k+=f+x;var q=Math.abs(parseFloat(v[0]));m&&(q=10-q);var w=q.toFixed(20);return w=w.replace(/\.?0+$/,""),k+=f+w}var t=-324,p=3,f="",n=o(11);l.collate=function(j,m){if(j===m){return 0}j=l.normalizeKey(j),m=l.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},l.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=l.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=l.normalizeKey(v))}}}}}return g},l.toIndexableString=function(g){var j="\x00";return g=l.normalizeKey(g),i(g)+f+b(g)+j},l.parseIndexableString=function(k){for(var y=[],v=[],w=0;;){var g=k[w++];if("\x00"!==g){switch(g){case"1":y.push(null);break;case"2":y.push("1"===k[w]),w++;break;case"3":var x=D(k,w);y.push(x.num),w+=x.length;break;case"4":for(var z="";;){var j=k[w];if("\x00"===j){break}z+=j,w++}z=z.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),y.push(z);break;case"5":var m={element:[],index:y.length};y.push(m.element),v.push(m);break;case"6":var q={element:{},index:y.length};y.push(q.element),v.push(q);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}}else{if(1===y.length){return y.pop()}h(y,v)}}}},{11:11}],11:[function(h,b,e){function a(g,m,n){for(var l="",f=n-g.length;l.length<f;){l+=m}return l}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var g,o=r.length,f=n.length;for(g=0;o>g;g++){if(g===f){return 1}var i=r.charAt(g),q=n.charAt(g);if(i!==q){return q>i?-1:1}}return f>o?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(b,i,j){function e(){this.store={}}function a(g){if(this.store=new e,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}j.Map=e,j.Set=a,e.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},e.prototype.unmangle=function(f){return f.substring(1)},e.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},e.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},e.prototype.has=function(f){var g=this.mangle(f);return g in this.store},e.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},e.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},a.prototype.add=function(f){return this.store.set(f,!0)},a.prototype.has=function(f){return this.store.has(f)},a.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(q,g){var n,o,p,r;o=[],r=[];for(n in g){h.call(g,n)&&(p=g[n],"this"!==n&&(o.push(n),r.push(p)))}return Function.apply(null,f.call(o).concat([q])).apply(g["this"],r)}}).call(this)},{}],15:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(p){function u(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function P(j,A,k,w,q,z,x){return u(A&k|~A&w,j,A,q,z,x)}function n(j,A,k,w,q,z,x){return u(A&w|k&~w,j,A,q,z,x)}function s(j,A,k,w,q,z,x){return u(A^k^w,j,A,q,z,x)}function Q(j,A,k,w,q,z,x){return u(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=P(z,j,x,k,w[0],7,-680876936),k=P(k,z,j,x,w[1],12,-389564586),x=P(x,k,z,j,w[2],17,606105819),j=P(j,x,k,z,w[3],22,-1044525330),z=P(z,j,x,k,w[4],7,-176418897),k=P(k,z,j,x,w[5],12,1200080426),x=P(x,k,z,j,w[6],17,-1473231341),j=P(j,x,k,z,w[7],22,-45705983),z=P(z,j,x,k,w[8],7,1770035416),k=P(k,z,j,x,w[9],12,-1958414417),x=P(x,k,z,j,w[10],17,-42063),j=P(j,x,k,z,w[11],22,-1990404162),z=P(z,j,x,k,w[12],7,1804603682),k=P(k,z,j,x,w[13],12,-40341101),x=P(x,k,z,j,w[14],17,-1502002290),j=P(j,x,k,z,w[15],22,1236535329),z=n(z,j,x,k,w[1],5,-165796510),k=n(k,z,j,x,w[6],9,-1069501632),x=n(x,k,z,j,w[11],14,643717713),j=n(j,x,k,z,w[0],20,-373897302),z=n(z,j,x,k,w[5],5,-701558691),k=n(k,z,j,x,w[10],9,38016083),x=n(x,k,z,j,w[15],14,-660478335),j=n(j,x,k,z,w[4],20,-405537848),z=n(z,j,x,k,w[9],5,568446438),k=n(k,z,j,x,w[14],9,-1019803690),x=n(x,k,z,j,w[3],14,-187363961),j=n(j,x,k,z,w[8],20,1163531501),z=n(z,j,x,k,w[13],5,-1444681467),k=n(k,z,j,x,w[2],9,-51403784),x=n(x,k,z,j,w[7],14,1735328473),j=n(j,x,k,z,w[12],20,-1926607734),z=s(z,j,x,k,w[5],4,-378558),k=s(k,z,j,x,w[8],11,-2022574463),x=s(x,k,z,j,w[11],16,1839030562),j=s(j,x,k,z,w[14],23,-35309556),z=s(z,j,x,k,w[1],4,-1530992060),k=s(k,z,j,x,w[4],11,1272893353),x=s(x,k,z,j,w[7],16,-155497632),j=s(j,x,k,z,w[10],23,-1094730640),z=s(z,j,x,k,w[13],4,681279174),k=s(k,z,j,x,w[0],11,-358537222),x=s(x,k,z,j,w[3],16,-722521979),j=s(j,x,k,z,w[6],23,76029189),z=s(z,j,x,k,w[9],4,-640364487),k=s(k,z,j,x,w[12],11,-421815835),x=s(x,k,z,j,w[15],16,530742520),j=s(j,x,k,z,w[2],23,-995338651),z=Q(z,j,x,k,w[0],6,-198630844),k=Q(k,z,j,x,w[7],10,1126891415),x=Q(x,k,z,j,w[14],15,-1416354905),j=Q(j,x,k,z,w[5],21,-57434055),z=Q(z,j,x,k,w[12],6,1700485571),k=Q(k,z,j,x,w[3],10,-1894986606),x=Q(x,k,z,j,w[10],15,-1051523),j=Q(j,x,k,z,w[1],21,-2054922799),z=Q(z,j,x,k,w[8],6,1873313359),k=Q(k,z,j,x,w[15],10,-30611744),x=Q(x,k,z,j,w[6],15,-1560198380),j=Q(j,x,k,z,w[13],21,1309151649),z=Q(z,j,x,k,w[4],6,-145523070),k=Q(k,z,j,x,w[11],10,-1120210379),x=Q(x,k,z,j,w[2],15,718787259),j=Q(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function t(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function o(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function v(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,t(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function r(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,o(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function O(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function m(j){var k;for(k=0;k<j.length;k+=1){j[k]=O(j[k])}return j.join("")}function y(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function l(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(v("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(z,D){var C,A,w,k,x=this.byteLength,q=j(z,x),B=x;return D!==p&&(B=j(D,x)),q>B?new ArrayBuffer(0):(C=B-q,A=new ArrayBuffer(C),w=new Uint8Array(A),k=new Uint8Array(this,q,C),w.set(k),A)}}(),l.prototype.append=function(j){return this.appendBinary(y(j)),this},l.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,t(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},l.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},l.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},l.hash=function(j,k){return l.hashBinary(y(j),k)},l.hashBinary=function(q,w){var k=v(q),j=m(k);return w?e(j):j},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,o(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var j=l.prototype.getState.call(this);return j.buff=S(j.buff),j},l.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),l.prototype.setState.call(this,j)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(q,w){var k=r(new Uint8Array(q)),j=m(k);return w?e(j):j},l})},{}],16:[function(h,b,e){function a(r,n,g){var o=g[g.length-1];r===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,i=o.index;if(Array.isArray(f)){f.push(r)}else{if(i===n.length-2){var q=n.pop();f[q]=r}else{n.push(r)}}}e.stringify=function(f){var g=[];g.push({obj:f});for(var l,F,u,n,i,E,D,r,s,o,C,t="";l=g.pop();){if(F=l.obj,u=l.prefix||"",n=l.val||"",t+=u,n){t+=n}else{if("object"!=typeof F){t+="undefined"==typeof F?null:JSON.stringify(F)}else{if(null===F){t+="null"}else{if(Array.isArray(F)){for(g.push({val:"]"}),i=F.length-1;i>=0;i--){E=0===i?"":",",g.push({obj:F[i],prefix:E})}g.push({val:"["})}else{D=[];for(r in F){F.hasOwnProperty(r)&&D.push(r)}for(g.push({val:"}"}),i=D.length-1;i>=0;i--){s=D[i],o=F[s],C=i>0?",":"",C+=JSON.stringify(s)+":",g.push({obj:o,prefix:C})}g.push({val:"{"})}}}}}return t},e.parse=function(o){for(var s,g,l,D,t,u,A,f,i,B=[],C=[],n=0;;){if(s=o[n++],"}"!==s&&"]"!==s&&"undefined"!=typeof s){switch(s){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,a(null,B,C);break;case"t":n+=3,a(!0,B,C);break;case"f":n+=4,a(!1,B,C);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(g="",n--;;){if(l=o[n++],!/[\d\.\-e\+]/.test(l)){n--;break}g+=l}a(parseFloat(g),B,C);break;case'"':for(D="",t=void 0,u=0;;){if(A=o[n++],'"'===A&&("\\"!==t||u%2!==1)){break}D+=A,t=A,"\\"===t?u++:u=0}a(JSON.parse('"'+D+'"'),B,C);break;case"[":f={element:[],index:B.length},B.push(f.element),C.push(f);break;case"{":i={element:{},index:B.length},B.push(i.element),C.push(i);break;default:throw new Error("unexpectedly reached end of input: "+s)}}else{if(1===B.length){return B.pop()}a(B.pop(),B,C)}}}},{}],17:[function(e,a,b){(function(gk,gb){function gV(ad,aa){ad=ad||[],aa=aa||{};try{return new Blob(ad,aa)}catch(ab){if("TypeError"!==ab.name){throw ab}for(var t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ac=new t,af=0;af<ad.length;af+=1){ac.append(ad[af])}return ac.getBlob(aa.type)}}function gZ(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function hr(){for(var t={},ab=new g6(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,g6.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function gz(ad,af){var ab,t,ac,aa=new Headers,ag={method:ad.method,credentials:"include",headers:aa};return ad.json&&(aa.set("Accept","application/json"),aa.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?gZ(ad.body,function(ah){ag.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?ag.body=JSON.stringify(ad.body):"body" in ad?ag.body=ad.body:ag.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&aa.set(ah,ad.headers[ah])}),ab=hr(ad.url,ag),ad.timeout>0&&(t=setTimeout(function(){ab.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ab.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?af(null,ac,ah):af(ah,ac)})["catch"](function(ah){af(ah,ac)}),{abort:ab.reject}}function hG(ac,aa){var ab,ad,ag=function(){ab.abort()};ab=ac.xhr?new ac.xhr:new XMLHttpRequest;try{ab.open(ac.method,ac.url)}catch(t){aa(t,{statusCode:413})}ab.withCredentials="withCredentials" in ac?ac.withCredentials:!0,"GET"===ac.method?delete ac.headers["Content-Type"]:ac.json&&(ac.headers.Accept="application/json",ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json",ac.body&&ac.processData&&"string"!=typeof ac.body&&(ac.body=JSON.stringify(ac.body))),ac.binary&&(ab.responseType="arraybuffer"),"body" in ac||(ac.body=null);for(var af in ac.headers){ac.headers.hasOwnProperty(af)&&ab.setRequestHeader(af,ac.headers[af])}return ac.timeout>0&&(ad=setTimeout(ag,ac.timeout),ab.onprogress=function(){clearTimeout(ad),ad=setTimeout(ag,ac.timeout)},"undefined"!=typeof ab.upload&&(ab.upload.onprogress=ab.onprogress)),ab.onreadystatechange=function(){if(4===ab.readyState){var al={statusCode:ab.status};if(ab.status>=200&&ab.status<300){var aj;aj=ac.binary?gV([ab.response||""],{type:ab.getResponseHeader("Content-Type")}):ab.responseText,aa(null,al,aj)}else{var ak={};try{ak=JSON.parse(ab.response)}catch(ah){}aa(ak,al)}}},ac.body&&ac.body instanceof Blob?gZ(ac.body,function(ah){ab.send(ah)}):ab.send(ac.body),{abort:ag}}function bn(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function ew(aa,t){return et||aa.xhr?hG(aa,t):gz(aa,t)}function hw(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function eo(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=hw.prototype,new aa(ab)}function ez(ad){var aa,ab,t,ac,af;return ab=ad.error===!0&&"string"==typeof ad.name?ad.name:ad.error,af=ad.reason,t=i1("name",ab,af),ad.missing||"missing"===af||"deleted"===af||"not_found"===ab?t=iA:"doc_validation"===ab?(t=gl,ac=af):"bad_request"===ab&&t.message!==af&&(t=co),t||(t=i1("status",ad.status,af)||gM),aa=eo(t,af,ab),ac&&(aa.message=ac),ad.id&&(aa.id=ad.id),ad.status&&(aa.status=ad.status),ad.missing&&(aa.missing=ad.missing),aa}function f6(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function h1(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function ee(t){if(t instanceof ArrayBuffer){return h1(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function ij(ad){var aa,ab,t;if(!ad||"object"!=typeof ad){return ad}if(Array.isArray(ad)){for(aa=[],ab=0,t=ad.length;t>ab;ab++){aa[ab]=ij(ad[ab])}return aa}if(ad instanceof Date){return ad.toISOString()}if(f6(ad)){return ee(ad)}aa={};for(ab in ad){if(Object.prototype.hasOwnProperty.call(ad,ab)){var ac=ij(ad[ab]);"undefined"!=typeof ac&&(aa[ab]=ac)}}return aa}function gJ(){return""}function he(ad,aa){function ab(af,ag,aj){if(!ad.binary&&ad.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?ez(ak):ak})),ad.binary&&ie(af,ag),aj(null,af,ag)}function t(aj,al){var ag,ak;if(aj.code&&aj.status){var ah=new Error(aj.message||aj.code);return ah.status=aj.status,al(ah)}try{ag=JSON.parse(aj.responseText),ak=ez(ag)}catch(af){ak=ez(aj)}al(ak)}ad=ij(ad);var ac={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ad=hW.extend(ac,ad),ad.json&&(ad.binary||(ad.headers.Accept="application/json"),ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json"),ad.binary&&(ad.encoding=null,ad.json=!1),ad.processData||(ad.json=!1),ew(ad,function(ak,af,ah){if(ak){return ak.status=af?af.statusCode:400,t(ak,aa)}var am,ag=af.headers&&af.headers["content-type"],aj=ah||gJ();if(!ad.binary&&(ad.json||!ad.processData)&&"object"!=typeof aj&&(/json/.test(ag)||/^[\s]*\{/.test(aj)&&/\}[\s]*$/.test(aj))){try{aj=JSON.parse(aj.toString())}catch(al){}}af.statusCode>=200&&af.statusCode<300?ab(aj,af,aa):(am=ez(aj),am.status=af.statusCode,aa(am))})}function i6(af,ad){var ac=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ab=-1!==ac.indexOf("safari")&&-1===ac.indexOf("chrome"),t=-1!==ac.indexOf("msie"),ah=ab&&"POST"===af.method||t&&"GET"===af.method,aa="cache" in af?af.cache:!0;if(ah||!aa){var ag=-1!==af.url.indexOf("?");af.url+=(ag?"&":"?")+"_nonce="+Date.now()}return he(af,ad)}function i(aa){var t=!1;return ai(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function v(t){return ai(function(ac){ac=ij(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){gk.nextTick(function(){ad(ag,ah)})});var af=new g6(function(aj,ak){var ag;try{var ah=i(function(ap,am){ap?ak(ap):aj(am)});ac.push(ah),ag=t.apply(aa,ac),ag&&"function"==typeof ag.then&&aj(ag)}catch(al){ak(al)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gC(t,aa){function ab(aj,ad,ag){if(V.enabled){for(var ac=[aj._db_name,ad],ah=0;ah<ag.length-1;ah++){ac.push(ag[ah])}V.apply(null,ac);var af=ag[ag.length-1];ag[ag.length-1]=function(ak,am){var al=[aj._db_name,ad];al=al.concat(ak?["error",ak]:["success",am]),V.apply(null,al),af(ak,am)}}}return v(ai(function(ad){if(this._closed){return g6.reject(new Error("database is closed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new g6(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function j(ad,aa){for(var ab={},t=0,ac=aa.length;ac>t;t++){var af=aa[t];af in ad&&(ab[af]=ad[af])}return ab}function a9(t,aa,ab){return new g6(function(ad,ac){t.get(aa,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=ab(af);return aj?(aj._id=aa,aj._rev=ag,void ad(N(t,aj,ab))):ad({updated:!1,rev:ag})})})}function N(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return a9(t,aa._id,ab)})}function Q(t){for(var ag,ac,af,ad,aa=t.rev_tree.slice();ad=aa.pop();){var aj=ad.ids,ap=aj[2],ah=ad.pos;if(ap.length){for(var ak=0,am=ap.length;am>ak;ak++){aa.push({pos:ah+1,ids:ap[ak]})}}else{var ab=!!aj[1].deleted,al=aj[0];(!ag||(af!==ab?af:ac!==ah?ah>ac:al>ag))&&(ag=al,ac=ah,af=ab)}}return ac+"-"+ag}function iT(t){return t.ids}function hE(ad,aa){aa||(aa=Q(ad));for(var ab,t=aa.substring(aa.indexOf("-")+1),ac=ad.rev_tree.map(iT);ab=ac.pop();){if(ab[0]===t){return !!ab[1].deleted}ac=ac.concat(ab[2])}}function hM(t){return gn("return "+t+";",{})}function jj(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function h(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function F(aa){var t=h(aa);return t?t.join("/"):null}function T(ag,ad){for(var aj,aa=ag.slice();aj=aa.pop();){for(var ak=aj.pos,ah=aj.ids,af=ah[2],ac=ad(0===af.length,ak,ah[0],aj.ctx,ah[1]),ab=0,t=af.length;t>ab;ab++){aa.push({pos:ak+1,ids:af[ab],ctx:ac})}}}function ex(aa,t){return aa.pos-t.pos}function gG(t){var ab=[];T(t,function(ag,ad,ah,af,aj){ag&&ab.push({rev:ad+"-"+ah,pos:ad,opts:aj})}),ab.sort(ex).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function R(ac){for(var t=Q(ac),ag=gG(ac.rev_tree),ad=[],ab=0,aa=ag.length;aa>ab;ab++){var af=ag[ab];af.rev===t||af.opts.deleted||ad.push(af.rev)}return ad}function A(ac,t,ag){function ad(){ab.cancel()}iH.EventEmitter.call(this);var ab=this;this.db=ac,t=t?ij(t):{};var aa=t.complete=i(function(aj,ah){aj?ab.emit("error",aj):ab.emit("complete",ah),ab.removeAllListeners(),ac.removeListener("destroyed",ad)});ag&&(ab.on("complete",function(ah){ag(null,ah)}),ab.on("error",ag)),ac.once("destroyed",ad),t.onChange=function(ah){t.isCancelled||(ab.emit("change",ah),ab.startSeq&&ab.startSeq<=ah.seq&&(ab.startSeq=!1))};var af=new g6(function(aj,ah){t.complete=function(al,ak){al?ah(al):aj(ak)}});ab.once("cancel",function(){ac.removeListener("destroyed",ad),t.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){aa(null,ah)},aa),ac.taskqueue.isReady?ab.doChanges(t):ac.taskqueue.addTask(function(){ab.isCancelled?ab.emit("cancel"):ab.doChanges(t)})}function hN(ad,aa,ab){var t=[{rev:ad._rev}];"all_docs"===ab.style&&(t=gG(aa.rev_tree).map(function(af){return{rev:af.rev}}));var ac={id:aa.id,changes:t,doc:ad};return hE(aa,ad._rev)&&(ac.deleted=!0),ab.conflicts&&(ac.doc._conflicts=R(aa),ac.doc._conflicts.length||delete ac.doc._conflicts),ac}function hs(ak,af,al){function ac(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),al(null,{results:am})}function ad(){++ah===t&&ac()}function aa(aq,am,ap){ab[aq]={id:am,docs:ap},ad()}var aj=Array.isArray(af)?af:af.docs,ag={};aj.forEach(function(am){am.id in ag?ag[am.id].push(am):ag[am.id]=[am]});var t=Object.keys(ag).length,ah=0,ab=new Array(t);Object.keys(ag).forEach(function(ap,am){var av=ag[ap],aq=j(av[0],["atts_since","attachments"]);aq.open_revs=av.map(function(aw){return aw.rev}),aq.open_revs=aq.open_revs.filter(function(aw){return aw});var au=function(aw){return aw};0===aq.open_revs.length&&(delete aq.open_revs,au=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in af&&(aq[aw]=af[aw])}),ak.get(ap,aq,function(ax,aw){aa(am,ap,ax?[{error:ax}]:au(aw))})})}function hA(t){return/^_local/.test(t)}function E(t){for(var ag,ac=[],af=t.slice();ag=af.pop();){var ad=ag.pos,aa=ag.ids,aj=aa[0],ap=aa[1],ah=aa[2],ak=0===ah.length,am=ag.history?ag.history.slice():[];am.push({id:aj,opts:ap}),ak&&ac.push({pos:ad+1-am.length,ids:am});for(var ab=0,al=ah.length;al>ab;ab++){af.push({pos:ad+1,ids:ah[ab],history:am})}}return ac.reverse()}function gT(t){return 0|Math.random()*t}function ce(t,ab){ab=ab||a5.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=a5[gT(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=a5[3&gT(16)|8];break;default:ac+=a5[gT(16)]}}return ac}function S(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(aa){var t;if(aa?"string"!=typeof aa?t=eo(cn):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=eo(ey)):t=eo(a6),t){throw t}}function hb(t){if(!/^\d+\-./.test(t)){return eo(go)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function M(ac,t){for(var ag=ac.start-ac.ids.length+1,ad=ac.ids,ab=[ad[0],t,[]],aa=1,af=ad.length;af>aa;aa++){ab=[ad[aa],{status:"missing"},[ab]]}return[{pos:ag,ids:ab}]}function ht(ag,ad){var aj,aa,ak,ah={status:"available"};if(ag._deleted&&(ah.deleted=!0),ad){if(ag._id||(ag._id=ce()),aa=ce(32,16).toLowerCase(),ag._rev){if(ak=hb(ag._rev),ak.error){return ak}ag._rev_tree=[{pos:ak.prefix,ids:[ak.id,{status:"missing"},[[aa,ah,[]]]]}],aj=ak.prefix+1}else{ag._rev_tree=[{pos:1,ids:[aa,ah,[]]}],aj=1}}else{if(ag._revisions&&(ag._rev_tree=M(ag._revisions,ah),aj=ag._revisions.start,aa=ag._revisions.ids[0]),!ag._rev_tree){if(ak=hb(ag._rev),ak.error){return ak}aj=ak.prefix,aa=ak.id,ag._rev_tree=[{pos:aj,ids:[aa,ah,[]]}]}}C(ag._id),ag._rev=aj+"-"+aa;var af={metadata:{},data:{}};for(var ac in ag){if(Object.prototype.hasOwnProperty.call(ag,ac)){var ab="_"===ac[0];if(ab&&!g7[ac]){var t=eo(gl,ac);throw t.message=gl.message+": "+ac,t}ab&&!hJ[ac]?af.metadata[ac.slice(1)]=ag[ac]:af.data[ac]=ag[ac]}}return af}function f9(aa,t){return t>aa?-1:aa>t?1:0}function h7(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function i0(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function im(ad){for(var aa=0;aa<ad.length;aa++){var ab=ad[aa];if(ab._deleted){delete ab._attachments}else{if(ab._attachments){for(var t=Object.keys(ab._attachments),ac=0;ac<t.length;ac++){var af=t[ac];ab._attachments[af]=j(ab._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gD(ad,aa){var ab=f9(ad._id,aa._id);if(0!==ab){return ab}var t=ad._revisions?ad._revisions.start:0,ac=aa._revisions?aa._revisions.start:0;return f9(t,ac)}function de(t){var aa={},ab=[];return T(t,function(af,ag,ad,ah){var ac=ag+"-"+ad;return af&&(aa[ac]=0),void 0!==ah&&ab.push({from:ah,to:ac}),ac}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function hc(ad,aa,ab){var t="limit" in aa?aa.keys.slice(aa.skip,aa.limit+aa.skip):aa.skip>0?aa.keys.slice(aa.skip):aa.keys;if(aa.descending&&t.reverse(),!t.length){return ad._allDocs({limit:0},ab)}var ac={offset:aa.skip};return g6.all(t.map(function(af){var ag=hW.extend({key:af,deleted:"ok"},aa);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new g6(function(aj,ah){ad._allDocs(ag,function(ak,al){return ak?ah(ak):(ac.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ac.rows=af,ac})}function fe(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),gk.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&fe(t)})})})}function ho(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function g0(){iH.EventEmitter.call(this)}function G(){this.isReady=!1,this.failed=!1,this.queue=[]}function ic(t){t&&gb.debug&&console.error(t)}function g9(ac,t){function ag(){aa.emit("destroyed",ab),aa.emit(ab,"destroyed")}function ad(){ac.removeListener("destroyed",ag),ac.emit("destroyed",ac)}var ab=t.originalName,aa=ac.constructor,af=aa._destructionListeners;ac.once("destroyed",ag),af.has(ab)||af.set(ab,[]),af.get(ab).push(ad)}function ig(ad,aa,ab){if(!(this instanceof ig)){return new ig(ad,aa,ab)}var t=this;("function"==typeof aa||"undefined"==typeof aa)&&(ab=aa,aa={}),ad&&"object"==typeof ad&&(aa=ad,ad=void 0),"undefined"==typeof ab&&(ab=ic),ad=ad||aa.name,aa=ij(aa),delete aa.name,this.__opts=aa;var ac=ab;t.auto_compaction=aa.auto_compaction,t.prefix=ig.prefix,g0.call(t),t.taskqueue=new G;var af=new g6(function(aj,al){ab=function(ap,am){return ap?al(ap):(delete am.then,void aj(am))},aa=ij(aa);var ah,ak,ag=aa.name||ad;return function(){try{if("string"!=typeof ag){throw ak=new Error("Missing/invalid DB name"),ak.code=400,ak}if(ah=ig.parseAdapter(ag,aa),aa.originalName=ag,aa.name=ah.name,aa.prefix&&"http"!==ah.adapter&&"https"!==ah.adapter&&(aa.name=aa.prefix+aa.name),aa.adapter=aa.adapter||ah.adapter,t._adapter=aa.adapter,iW("pouchdb:adapter")("Picked adapter: "+aa.adapter),t._db_name=ag,!ig.adapters[aa.adapter]){throw ak=new Error("Adapter is missing"),ak.code=404,ak}if(!ig.adapters[aa.adapter].valid()){throw ak=new Error("Invalid Adapter"),ak.code=404,ak}}catch(am){t.taskqueue.fail(am)}}(),ak?al(ak):(t.adapter=aa.adapter,t.replicate={},t.replicate.from=function(aq,am,ap){return t.constructor.replicate(aq,t,am,ap)},t.replicate.to=function(aq,am,ap){return t.constructor.replicate(t,aq,am,ap)},t.sync=function(aq,am,ap){return t.constructor.sync(t,aq,am,ap)},t.replicate.sync=t.sync,void ig.adapters[aa.adapter].call(t,aa,function(am){return am?(t.taskqueue.fail(am),void ab(am)):(g9(t,aa),t.emit("created",t),ig.emit("created",aa.originalName),t.taskqueue.ready(t),void ab(null,t))}))});af.then(function(ag){ac(null,ag)},ac),t.then=af.then.bind(af),t["catch"]=af["catch"].bind(af)}function P(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function a7(){return z}function gA(aa){Object.keys(iH.EventEmitter.prototype).forEach(function(ab){"function"==typeof iH.EventEmitter.prototype[ab]&&(aa[ab]=hR[ab].bind(hR))});var t=aa._destructionListeners=new jk.Map;aa.on("destroyed",function(ab){t.has(ab)&&(t.get(ab).forEach(function(ac){ac()}),t["delete"](ab))})}function gO(ad){for(var aa=ad.length,ab=new ArrayBuffer(aa),t=new Uint8Array(ab),ac=0;aa>ac;ac++){t[ac]=ad.charCodeAt(ac)}return ab}function bo(aa,t){return gV([gO(aa)],{type:t})}function fm(ac){for(var t=iY.exec(ac),ag={},ad=14;ad--;){var ab=hg[ad],aa=t[ad]||"",af=-1!==["user","password"].indexOf(ab);ag[ab]=af?decodeURIComponent(aa):aa}return ag[er]={},ag[hg[12]].replace(fX,function(ah,ak,aj){ak&&(ag[er][ak]=aj)}),ag}function i9(ad,aa,ab){try{return !ad(aa,ab)}catch(t){var ac="Filter function threw: "+t.toString();return eo(co,ac)}}function be(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&i9(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function hi(aa,t){"console" in gb&&"info" in console&&console.info("The above "+aa+" is totally normal. "+t)}function gL(ad,aa,ab,t,ac){return ad.get(aa)["catch"](function(af){if(404===af.status){return"http"===ad.type()&&hi(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:t,_id:aa,history:[],replicator:je,version:hp}}throw af}).then(function(af){return ac.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==t}),af.history.unshift({last_seq:ab,session_id:t}),af.history=af.history.slice(0,iD),af.version=hp,af.replicator=je,af.session_id=t,af.last_seq=ab,ad.put(af)["catch"](function(ag){if(409===ag.status){return gL(ad,aa,ab,t,ac)}throw ag}))})}function B(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function h3(t,ab){if(t.session_id===ab.session_id){return{last_seq:t.last_seq,history:t.history||[]}}var ac=t.history||[],aa=ab.history||[];return gs(ac,aa)}function gs(af,ad){var ac=af[0],ab=af.slice(1),t=ad[0],ah=ad.slice(1);if(!ac||0===ad.length){return{last_seq:fh,history:[]}}var aa=ac.session_id;if(h5(aa,ad)){return{last_seq:ac.last_seq,history:af}}var ag=t.session_id;return h5(ag,ab)?{last_seq:t.last_seq,history:ah}:gs(ab,ah)}function h5(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:h5(t,aa):!1}function O(t,ab){t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1;var ac=Math.random(),aa=ab-t;return ~~(aa*ac+t)}function hd(aa){var t=0;return aa||(t=2000),O(aa,t)}function iJ(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=hd),ab.emit("requestError",ac),("active"===ab.state||"pending"===ab.state)&&(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=gW})),t.current_back_off=t.current_back_off||gW,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function iZ(t){return jc(t)}function fb(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function gf(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function h9(t){return Object.keys(t).sort(fj.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function iy(ac,t,ag){var ad=ag.doc_ids?ag.doc_ids.sort(fj.collate):"",ab=ag.filter?ag.filter.toString():"",aa="",af="";return ag.filter&&ag.query_params&&(aa=JSON.stringify(h9(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),g6.all([ac.id(),t.id()]).then(function(ah){var aj=ah[0]+ah[1]+ab+af+aa+ad;return hO(aj)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function g8(t){return/^1-/.test(t)}function i5(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function ii(aj,ag,t){function ac(){var ak=i5(ag);if(ak.docs.length){return aj.bulkGet(ak).then(function(al){if(t.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&ab.push(ap.ok)})})})}}function aa(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function ah(ak){return aj.allDocs({keys:ak,include_docs:!0}).then(function(al){if(t.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&g8(am.value.rev)&&!aa(am.doc)&&(ab.push(am.doc),delete ag[am.id])})})}function af(){var ak=Object.keys(ag).filter(function(am){var al=ag[am].missing;return 1===al.length&&g8(al[0])});return ak.length>0?ah(ak):void 0}function ad(){return ab}ag=ij(ag);var ab=[];return g6.resolve().then(af).then(ac).then(ad)}function fz(aB,aA,ad,am,af){function aP(){return aM?g6.resolve():iy(aB,aA,ad).then(function(aS){ax=aS,aM=new B(aB,aA,ax,am)})}function aj(){if(aH=[],0!==aK.docs.length){var aS=aK.docs;return aA.bulkDocs({docs:aS,new_edits:!1}).then(function(aU){if(am.cancelled){throw aO(),new Error("cancelled")}var aX=[],aV={};aU.forEach(function(aY){aY.error&&(af.doc_write_failures++,aX.push(aY),aV[aY.id]=aY)}),aw=aw.concat(aX),af.docs_written+=aK.docs.length-aX.length;var aW=aX.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aV[aZ._id];aY?am.emit("denied",ij(aY)):aH.push(aZ)}),aW.length>0){var aT=new Error("bulkDocs error");throw aT.other_errors=aX,ap("target.bulkDocs failed to write docs",aT),new Error("bulkWrite partial failure")}},function(aT){throw af.doc_write_failures+=aS.length,aT})}}function ay(){af.last_seq=aJ=aK.seq;var aS=ij(af);return aH.length&&(aS.docs=aH,am.emit("change",aS)),aN=!0,aM.writeCheckpoint(aK.seq,au).then(function(){if(aN=!1,am.cancelled){throw aO(),new Error("cancelled")}aK=void 0,ab()})["catch"](function(aT){throw aN=!1,ap("writeCheckpoint completed with error",aT),aT})}function aE(){var aS={};return aK.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aA.revsDiff(aS).then(function(aT){if(am.cancelled){throw aO(),new Error("cancelled")}aK.diffs=aT})}function al(){return ii(aB,aK.diffs,am).then(function(aS){aS.forEach(function(aT){delete aK.diffs[aT._id],af.docs_read++,aK.docs.push(aT)})})}function aD(){if(!am.cancelled&&!aK){if(0===aR.length){return void aa(!0)}aK=aR.shift(),aE().then(al).then(aj).then(ay).then(aD)["catch"](function(aS){ap("batch processing terminated with error",aS)})}}function aa(aS){return 0===ah.changes.length?void (0!==aR.length||aK||((aQ&&az.live||aq)&&(am.state="pending",am.emit("paused")),aq&&aO())):void ((aS||aq||ah.changes.length>=av)&&(aR.push(ah),ah={seq:0,changes:[],docs:[]},("pending"===am.state||"stopped"===am.state)&&(am.state="active",am.emit("active")),aD()))}function ap(aT,aS){ac||(aS.message||(aS.message=aT),af.ok=!1,af.status="aborting",af.errors.push(aS),aw=aw.concat(aS),aR=[],ah={seq:0,changes:[],docs:[]},aO())}function aO(){if(!(ac||am.cancelled&&(af.status="cancelled",aN))){af.status=af.status||"complete",af.end_time=new Date,af.last_seq=aJ,ac=!0;var aT=aw.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aw.pop();aw.length>0&&(aS.other_errors=aw),aS.result=af,iJ(ad,am,aS,function(){fz(aB,aA,ad,am)})}else{af.errors=aw,am.emit("complete",af),am.removeAllListeners()}}}function ag(aT){if(am.cancelled){return aO()}var aS=be(ad)(aT);aS&&(ah.seq=aT.seq,ah.changes.push(aT),aa(0===aR.length))}function aF(aS){return aC=!1,am.cancelled?aO():(aS.results.length>0?(az.since=aS.last_seq,ab()):aQ?(az.live=!0,ab()):aq=!0,void aa(!0))}function t(aS){return aC=!1,am.cancelled?aO():void ap("changes rejected",aS)}function ab(){function aS(){aT.cancel()}function aU(){am.removeListener("cancel",aS)}if(!aC&&!aq&&aR.length<aG){aC=!0,am._changes&&(am.removeListener("cancel",am._abortChanges),am._changes.cancel()),am.once("cancel",aS);var aT=aB.changes(az).on("change",ag);aT.then(aU,aU),aT.then(aF)["catch"](t),ad.retry&&(am._changes=aT,am._abortChanges=aS)}}function aI(){aP().then(function(){return am.cancelled?void aO():aM.getCheckpoint().then(function(aS){aJ=aS,az={since:aJ,limit:av,batch_size:av,style:"all_docs",doc_ids:aL,return_docs:!0},ad.filter&&("string"!=typeof ad.filter?az.include_docs=!0:az.filter=ad.filter),"heartbeat" in ad&&(az.heartbeat=ad.heartbeat),"timeout" in ad&&(az.timeout=ad.timeout),ad.query_params&&(az.query_params=ad.query_params),ad.view&&(az.view=ad.view),ab()})})["catch"](function(aS){ap("getCheckpoint rejected with ",aS)})}function ak(aS){throw aN=!1,ap("writeCheckpoint completed with error",aS),aS}var aK,ax,aM,aR=[],ah={seq:0,changes:[],docs:[]},aN=!1,aq=!1,ac=!1,aJ=0,aQ=ad.continuous||ad.live||!1,av=ad.batch_size||100,aG=ad.batches_limit||10,aC=!1,aL=ad.doc_ids,aw=[],aH=[],au=ce();af=af||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var az={};return am.ready(aB,aA),am.cancelled?void aO():(am._addedListeners||(am.once("cancel",aO),"function"==typeof ad.complete&&(am.once("error",ad.complete),am.once("complete",function(aS){ad.complete(null,aS)})),am._addedListeners=!0),void ("undefined"==typeof ad.since?aI():aP().then(function(){return aN=!0,aM.writeCheckpoint(ad.since,au)}).then(function(){return aN=!1,am.cancelled?void aO():(aJ=ad.since,void aI())})["catch"](ak)))}function f0(){iH.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new g6(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function hz(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function gY(ac,t,ag,ad){if("function"==typeof ag&&(ad=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw eo(co,"`doc_ids` filter parameter is not a list.")}ag.complete=ad,ag=ij(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ab=new f0(ag),aa=hz(ac,ag),af=hz(t,ag);return fz(aa,af,ag,ab),ab}function gj(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=ij(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=fV.toPouch(t,ac),ab=fV.toPouch(ab,ac),new a2(t,ab,ac,aa)}function a2(aj,aa,t,ag){function ab(ay){al.emit("change",{direction:"pull",change:ay})}function am(ay){al.emit("change",{direction:"push",change:ay})}function ac(ay){al.emit("denied",{direction:"push",doc:ay})}function aq(ay){al.emit("denied",{direction:"pull",doc:ay})}function av(){al.pushPaused=!0,al.pullPaused&&al.emit("paused")}function af(){al.pullPaused=!0,al.pushPaused&&al.emit("paused")}function ak(){al.pushPaused=!1,al.pullPaused&&al.emit("active",{direction:"push"})}function ap(){al.pullPaused=!1,al.pushPaused&&al.emit("active",{direction:"pull"})}function ah(ay){return function(aC,az){var aE="change"===aC&&(az===ab||az===am),aA="denied"===aC&&(az===aq||az===ac),aD="paused"===aC&&(az===af||az===av),aB="active"===aC&&(az===ap||az===ak);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&al.removeAllListeners(aC))}}var al=this;this.canceled=!1;var ad=t.push?hW.extend({},t,t.push):t,aw=t.pull?hW.extend({},t,t.pull):t;this.push=ft(aj,aa,ad),this.pull=ft(aa,aj,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};t.live&&(this.push.on("complete",al.pull.cancel.bind(al.pull)),this.pull.on("complete",al.push.cancel.bind(al.push))),this.on("newListener",function(ay){"change"===ay?(al.pull.on("change",ab),al.push.on("change",am)):"denied"===ay?(al.pull.on("denied",aq),al.push.on("denied",ac)):"active"===ay?(al.pull.on("active",ap),al.push.on("active",ak)):"paused"===ay&&(al.pull.on("paused",af),al.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(al.pull.removeListener("change",ab),al.push.removeListener("change",am)):"denied"===ay?(al.pull.removeListener("denied",aq),al.push.removeListener("denied",ac)):"active"===ay?(al.pull.removeListener("active",ap),al.push.removeListener("active",ak)):"paused"===ay&&(al.pull.removeListener("paused",af),al.push.removeListener("paused",av))}),this.pull.on("removeListener",ah("pull")),this.push.on("removeListener",ah("push"));var au=g6.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return al.emit("complete",az),ag&&ag(null,az),al.removeAllListeners(),az},function(ay){if(al.cancel(),ag?ag(ay):al.emit("error",ay),al.removeAllListeners(),ag){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function iO(aa,t){return bo(gy(aa),t)}function iM(ad){for(var aa="",ab=new Uint8Array(ad),t=ab.byteLength,ac=0;t>ac;ac++){aa+=String.fromCharCode(ab[ac])}return aa}function ar(t,ab){if("undefined"==typeof FileReader){return ab(iM((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(iM(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function fp(t){return new g6(function(aa){ar(t,function(ab){aa(jc(ab))})})}function U(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function s(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=iO(ab.data,ab.content_type)})}function iN(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function i3(t){return t._attachments&&Object.keys(t._attachments)?g6.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?fp(aa.data).then(function(ac){aa.data=ac}):void 0})):g6.resolve()}function ha(t){var aa=fm(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function fY(aa,t){return gU(aa,aa.db+"/"+t)}function gU(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function gx(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function gv(t,ah){function ak(aw,ay,az){var av=aw.ajax||{},ax=hW.extend(ij(au),av,ay);return fn(ax.method+" "+ax.url),at.ajax(ax,az)}function aa(av,aw){return new g6(function(ax,ay){ak(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function aq(av,aw){return gC(av,ai(function(ax){af().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function af(){if(t.skipSetup||t.skip_setup){return g6.resolve()}if(al){return al}var av={method:"GET",url:ad};return al=aa({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(hi(404,"PouchDB is just detecting if the remote exists."),aa({},{method:"PUT",url:ad})):g6.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:g6.reject(aw)}),al["catch"](function(){al=null}),al}function aj(av){return av.split("/").map(encodeURIComponent).join("/")}var ac=this,am=ha;t.getHost&&(am=t.getHost);var ap=am(t.name,t),ad=fY(ap,"");t=ij(t);var au=t.ajax||{};if(ac.getUrl=function(){return ad},ac.getHeaders=function(){return au.headers||{}},t.auth||ap.auth){var ag=t.auth||ap.auth,ab=jc(ag.username+":"+ag.password);au.headers=au.headers||{},au.headers.Authorization="Basic "+ab}var al;setTimeout(function(){ah(null,ac)}),ac.type=function(){return"http"},ac.id=aq("id",function(av){ak({},{method:"GET",url:gU(ap,"")},function(ay,aw){var ax=aw&&aw.uuid?aw.uuid+ap.db:fY(ap,"");av(null,ax)})}),ac.request=aq("request",function(av,aw){av.url=fY(ap,av.url),ak({},av,aw)}),ac.compact=aq("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=ij(av),ak(av,{url:fY(ap,"_compact"),method:"POST"},function(){function ax(){ac.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),ac.bulkGet=gC("bulkGet",function(aB,aA){function aw(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),ak({},{url:fY(ap,"_bulk_get"+gx(aD)),method:"POST",body:{docs:aB.docs}},aC)}function ax(){function aH(aJ){return function(aK,aL){aE[aJ]=aL.results,++aG===aC&&aA(null,{results:U(aE)})}}for(var aD=gE,aC=Math.ceil(aB.docs.length/aD),aG=0,aE=new Array(aC),aF=0;aC>aF;aF++){var aI=j(aB,["revs","attachments"]);aI.docs=aB.docs.slice(aF*aD,Math.min(aB.docs.length,(aF+1)*aD)),hs(az,aI,aH(aF))}}var az=this,av=gU(ap,""),ay=io[av];"boolean"!=typeof ay?aw(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(io[av]=!1,hi(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aE)}else{io[av]=!0,aA(null,aD)}}):ay?aw(aA):ax()}),ac._info=function(av){af().then(function(){ak({},{method:"GET",url:fY(ap,"")},function(aw,ax){return aw?av(aw):(ax.host=fY(ap,""),void av(null,ax))})})["catch"](av)},ac.get=aq("get",function(aB,aA,aw){function ax(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?g6.all(aE.map(function(aF){var aH=aC[aF],aG=iN(aD._id)+"/"+aj(aF)+"?rev="+aD._rev;return aa(aA,{method:"GET",url:fY(ap,aG),binary:!0}).then(function(aI){return aA.binary?aI:fp(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function az(aC){return Array.isArray(aC)?g6.all(aC.map(function(aD){return aD.ok?ax(aD.ok):void 0})):ax(aC)}"function"==typeof aA&&(aw=aA,aA={}),aA=ij(aA);var ay={};aA.revs&&(ay.revs=!0),aA.revs_info&&(ay.revs_info=!0),aA.open_revs&&("all"!==aA.open_revs&&(aA.open_revs=JSON.stringify(aA.open_revs)),ay.open_revs=aA.open_revs),aA.rev&&(ay.rev=aA.rev),aA.conflicts&&(ay.conflicts=aA.conflicts),aB=iN(aB);var av={method:"GET",url:fY(ap,aB+gx(ay))};aa(aA,av).then(function(aC){return g6.resolve().then(function(){return aA.attachments?az(aC):void 0}).then(function(){aw(null,aC)})})["catch"](aw)}),ac.remove=aq("remove",function(aw,ay,aA,av){var ax;"string"==typeof ay?(ax={_id:aw,_rev:ay},"function"==typeof aA&&(av=aA,aA={})):(ax=aw,"function"==typeof ay?(av=ay,aA={}):(av=aA,aA=ay));var az=ax._rev||aA.rev;ak(aA,{method:"DELETE",url:fY(ap,iN(ax._id))+"?rev="+az},av)}),ac.getAttachment=aq("getAttachment",function(aw,aA,av,ay){"function"==typeof av&&(ay=av,av={});var ax=av.rev?"?rev="+av.rev:"",az=fY(ap,iN(aw))+"/"+aj(aA)+ax;ak(av,{method:"GET",url:az,binary:!0},ay)}),ac.removeAttachment=aq("removeAttachment",function(aw,ay,ax,az){var av=fY(ap,iN(aw)+"/"+aj(ay))+"?rev="+ax;ak({},{method:"DELETE",url:av},az)}),ac.putAttachment=aq("putAttachment",function(aA,ax,av,aE,aD,aw){"function"==typeof aD&&(aw=aD,aD=aE,aE=av,av=null);var ay=iN(aA)+"/"+aj(ax),aB=fY(ap,ay);if(av&&(aB+="?rev="+av),"string"==typeof aE){var aC;try{aC=gy(aE)}catch(aF){return aw(eo(iE,"Attachment is not a valid base64 string"))}aE=aC?bo(aC,aD):""}var az={headers:{"Content-Type":aD},method:"PUT",url:aB,processData:!1,body:aE,timeout:au.timeout||60000};ak({},az,aw)}),ac._bulkDocs=function(ax,aw,av){ax.new_edits=aw.new_edits,af().then(function(){return g6.all(ax.docs.map(i3))}).then(function(){ak(aw,{method:"POST",url:fY(ap,"_bulk_docs"),body:ax},function(ay,az){return ay?av(ay):(az.forEach(function(aA){aA.ok=!0}),void av(null,az))})})["catch"](av)},ac.allDocs=aq("allDocs",function(aB,aw){"function"==typeof aB&&(aw=aB,aB={}),aB=ij(aB);var aA,ax={},az="GET";aB.conflicts&&(ax.conflicts=!0),aB.descending&&(ax.descending=!0),aB.include_docs&&(ax.include_docs=!0),aB.attachments&&(ax.attachments=!0),aB.key&&(ax.key=JSON.stringify(aB.key)),aB.start_key&&(aB.startkey=aB.start_key),aB.startkey&&(ax.startkey=JSON.stringify(aB.startkey)),aB.end_key&&(aB.endkey=aB.end_key),aB.endkey&&(ax.endkey=JSON.stringify(aB.endkey)),"undefined"!=typeof aB.inclusive_end&&(ax.inclusive_end=!!aB.inclusive_end),"undefined"!=typeof aB.limit&&(ax.limit=aB.limit),"undefined"!=typeof aB.skip&&(ax.skip=aB.skip);var av=gx(ax);if("undefined"!=typeof aB.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aB.keys));ay.length+av.length+1<=Y?av+="&"+ay:(az="POST",aA={keys:aB.keys})}aa(aB,{method:az,url:fY(ap,"_all_docs"+av),body:aA}).then(function(aC){aB.include_docs&&aB.attachments&&aB.binary&&aC.rows.forEach(s),aw(null,aC)})["catch"](aw)}),ac._changes=function(aG){var aD="batch_size" in aG?aG.batch_size:hq;aG=ij(aG),aG.timeout="timeout" in aG?aG.timeout:"timeout" in au?au.timeout:30000;var ax,az=aG.timeout?{timeout:aG.timeout-5000}:{},aH="undefined"!=typeof aG.limit?aG.limit:!1;ax="return_docs" in aG?aG.return_docs:"returnDocs" in aG?aG.returnDocs:!0;var aC=aH;if(aG.style&&(az.style=aG.style),(aG.include_docs||aG.filter&&"function"==typeof aG.filter)&&(az.include_docs=!0),aG.attachments&&(az.attachments=!0),aG.continuous&&(az.feed="longpoll"),aG.conflicts&&(az.conflicts=!0),aG.descending&&(az.descending=!0),"heartbeat" in aG?aG.heartbeat&&(az.heartbeat=aG.heartbeat):az.heartbeat=10000,aG.filter&&"string"==typeof aG.filter&&(az.filter=aG.filter,"_view"===aG.filter&&aG.view&&"string"==typeof aG.view&&(az.view=aG.view)),aG.query_params&&"object"==typeof aG.query_params){for(var aB in aG.query_params){aG.query_params.hasOwnProperty(aB)&&(az[aB]=aG.query_params[aB])}}var aI,aw="GET";if(aG.doc_ids){az.filter="_doc_ids";var aF=JSON.stringify(aG.doc_ids);aF.length<Y?az.doc_ids=aF:(aw="POST",aI={doc_ids:aG.doc_ids})}var av,aA,aJ=function(aM,aK){if(!aG.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),aG.descending?aH&&(az.limit=aC):az.limit=!aH||aC>aD?aD:aC;var aL={method:aw,url:fY(ap,"_changes"+gx(az)),timeout:aG.timeout,body:aI};aA=aM,aG.aborted||af().then(function(){av=ak(aG,aL,aK)})["catch"](aK)}},ay={results:[]},aE=function(aN,aL){if(!aG.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,ay.last_seq=aL.last_seq;var aK={};aK.query=aG.query_params,aL.results=aL.results.filter(function(aQ){aC--;var aP=be(aG)(aQ);return aP&&(aG.include_docs&&aG.attachments&&aG.binary&&s(aQ),ax&&ay.results.push(aQ),aG.onChange(aQ)),aP})}else{if(aN){return aG.aborted=!0,void aG.complete(aN)}}aL&&aL.last_seq&&(aA=aL.last_seq);var aO=aH&&0>=aC||aL&&aD>aM||aG.descending;(!aG.continuous||aH&&0>=aC)&&aO?aG.complete(null,ay):setTimeout(function(){aJ(aA,aE)},0)}};return aJ(aG.since||0,aE),{cancel:function(){aG.aborted=!0,av&&av.abort()}}},ac.revsDiff=aq("revsDiff",function(ax,aw,av){"function"==typeof aw&&(av=aw,aw={}),ak(aw,{method:"POST",url:fY(ap,"_revs_diff"),body:ax},av)}),ac._close=function(av){av()},ac._destroy=function(aw,av){ak(aw,{url:fY(ap,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(ac.emit("destroyed"),ac.constructor.emit("destroyed",t.name),void av(null,ay))})}}function fl(){this.promise=new g6(function(t){t()})}function iP(t){return q.hash(t)}function ir(af){var ad=af.db,ac=af.viewName,ab=af.map,t=af.reduce,ah=af.temporary,aa=ab.toString()+(t&&t.toString())+"undefined";if(!ah&&ad._cachedViews){var ag=ad._cachedViews[aa];if(ag){return g6.resolve(ag)}}return ad.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ac;-1===aq.indexOf("/")&&(aq=ac+"/"+ac);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ah?"temp":iP(aa));return a9(ad,"_local/mrviews",al).then(function(){return ad.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ad,adapter:ad.adapter,mapFun:ab,reduceFun:t};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ah||(ad._cachedViews=ad._cachedViews||{},ad._cachedViews[aa]=aq,aq.db.once("destroyed",function(){delete ad._cachedViews[aa]})),aq})})})})}function jd(ad,aa,ab,t,ac,af){return gn("return ("+ad.replace(/;\s*$/,"")+");",{emit:aa,sum:ab,log:t,isArray:ac,toJSON:af})}function gK(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function gt(t){return 1===t.length&&/^1-/.test(t[0].rev)}function hD(t,aa){try{t.emit("error",aa)}catch(ab){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(aa)}}function ix(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return hD(t,aa),{error:aa}}}function h0(t,aa){var ab=hZ(t.key,aa.key);return 0!==ab?ab:hZ(t.value,aa.value)}function jf(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function iC(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function gF(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=iO(ac.data,ac.content_type)})})}function hV(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&gF(aa),aa}}function hv(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new ev(t)}function gh(af){for(var ad=0,ac=0,ab=af.length;ab>ac;ac++){var t=af[ac];if("number"!=typeof t){if(!Array.isArray(t)){throw hv("_sum")}ad="number"==typeof ad?[ad]:ad;for(var ah=0,aa=t.length;aa>ah;ah++){var ag=t[ah];if("number"!=typeof ag){throw hv("_sum")}"undefined"==typeof ad[ah]?ad.push(ag):ad[ah]+=ag}}else{"number"==typeof ad?ad+=t:ad[0]+=t}}return ad}function hX(ad,aa,ab,t){var ac=aa[ad];"undefined"!=typeof ac&&(t&&(ac=encodeURIComponent(JSON.stringify(ac))),ab.push(ad+"="+ac))}function fo(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function gq(t){return t.group_level=fo(t.group_level),t.limit=fo(t.limit),t.skip=fo(t.skip),t}function gI(t){if(t){if("number"!=typeof t){return new il('Invalid value for integer: "'+t+'"')}if(0>t){return new il('Invalid value for positive integer: "'+t+'"')}}}function i8(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&hZ(t[ac],t[aa])>0){throw new il("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new il("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new il("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=gI(t[af]);if(ad){throw ad}})}function hU(aj,ag,t){var ac,aa=[],ah="GET";if(hX("reduce",t,aa),hX("include_docs",t,aa),hX("attachments",t,aa),hX("limit",t,aa),hX("descending",t,aa),hX("group",t,aa),hX("group_level",t,aa),hX("skip",t,aa),hX("stale",t,aa),hX("conflicts",t,aa),hX("startkey",t,aa,!0),hX("start_key",t,aa,!0),hX("endkey",t,aa,!0),hX("end_key",t,aa,!0),hX("inclusive_end",t,aa),hX("key",t,aa,!0),aa=aa.join("&"),aa=""===aa?"":"?"+aa,"undefined"!=typeof t.keys){var af=2000,ad="keys="+encodeURIComponent(JSON.stringify(t.keys));ad.length+aa.length+1<=af?aa+=("?"===aa[0]?"&":"?")+ad:(ah="POST","string"==typeof ag?ac={keys:t.keys}:ag.keys=t.keys)}if("string"==typeof ag){var ab=gK(ag);return aj.request({method:ah,url:"_design/"+ab[0]+"/_view/"+ab[1]+aa,body:ac}).then(hV(t))}return ac=ac||{},Object.keys(ag).forEach(function(ak){Array.isArray(ag[ak])?ac[ak]=ag[ak]:ac[ak]=ag[ak].toString()}),aj.request({method:"POST",url:"_temp_view"+aa,body:ac}).then(hV(t))}function p(t,aa,ab){return new g6(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function g4(t){return new g6(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function ji(t){return function(aa){if(404===aa.status){return t}throw aa}}function hI(ak,af,al){function ac(){return gt(ab)?g6.resolve(ag):af.db.get(aj)["catch"](ji(ag))}function ad(am){return am.keys.length?af.db.allDocs({keys:am.keys,include_docs:!0}):g6.resolve({rows:[]})}function aa(ap,aA){for(var aw=[],az={},ax=0,au=aA.rows.length;au>ax;ax++){var aq=aA.rows[ax],ay=aq.doc;if(ay&&(aw.push(ay),az[ay._id]=!0,ay._deleted=!ah[ay._id],!ay._deleted)){var am=ah[ay._id];"value" in am&&(ay.value=am.value)}}var av=Object.keys(ah);return av.forEach(function(aD){if(!az[aD]){var aB={_id:aD},aC=ah[aD];"value" in aC&&(aB.value=aC.value),aw.push(aB)}}),ap.keys=f2(av.concat(ap.keys)),aw.push(ap),aw}var aj="_local/doc_"+ak,ag={_id:aj,keys:[]},t=al[ak],ah=t.indexableKeysToKeyValues,ab=t.changes;return ac().then(function(am){return ad(am).then(function(ap){return aa(am,ap)})})}function dr(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](ji({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return g6.all(ad.map(function(ag){return hI(ag,t,ab)})).then(function(ah){var ag=U(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function gp(t){var aa="string"==typeof t?t:t.name,ab=g2[aa];return ab||(ab=g2[aa]=new fl),ab}function hl(t){return fc(gp(t),function(){return iG(t)})()}function iG(aj){function ag(am,ak){var al={id:aa._id,key:g3(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=g3(ak)),ac.push(al)}function t(ak,al){return function(){return dr(aj,ak,al)}}var ac,aa,ah;if("function"==typeof aj.mapFun&&2===aj.mapFun.length){var af=aj.mapFun;ah=function(ak){return af(ak,ag)}}else{ah=jd(aj.mapFun.toString(),ag,gh,i2,Array.isArray,JSON.parse)}var ad=aj.seq||0,ab=new fl;return new g6(function(ap,ak){function al(){ab.finish().then(function(){aj.seq=ad,ap()})}function am(){function aq(au){ak(au)}aj.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ad,limit:ik}).on("complete",function(aD){var av=aD.results;if(!av.length){return al()}for(var aG={},ax=0,aA=av.length;aA>ax;ax++){var aF=av[ax];if("_"!==aF.doc._id[0]){ac=[],aa=aF.doc,aa._deleted||ix(aj.sourceDB,ah,[aa]),ac.sort(h0);for(var au,aC={},ay=0,aB=ac.length;aB>ay;ay++){var az=ac[ay],aw=[az.key,az.id];0===hZ(az.key,au)&&aw.push(ay);var aE=hh(aw);aC[aE]=az,au=az.key}aG[aF.doc._id]={indexableKeysToKeyValues:aC,changes:aF.changes}}ad=aF.seq}return ab.add(t(aG,ad)),av.length<ik?al():am()}).on("error",aq)}am()})}function iI(ak,af,al){0===al.group_level&&delete al.group_level;var ac,ad=al.group||al.group_level;ac=hn[ak.reduceFun]?hn[ak.reduceFun]:jd(ak.reduceFun.toString(),null,gh,i2,Array.isArray,JSON.parse);var aa=[],aj=al.group_level;af.forEach(function(aq){var am=aa[aa.length-1],ap=ad?aq.key:null;return ad&&Array.isArray(ap)&&"number"==typeof aj&&(ap=ap.length>aj?ap.slice(0,aj):ap),am&&0===hZ(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void aa.push({key:[[ap,aq.id]],value:[aq.value]})});for(var ag=0,t=aa.length;t>ag;ag++){var ah=aa[ag],ab=ix(ak.sourceDB,ac,[ah.key,ah.value,!1]);if(ab.error&&ab.error instanceof ev){throw ab.error}ah.value=ab.error?null:ab.output,ah.key=ah.key[0][0]}return{rows:jf(aa,al.limit,al.skip)}}function y(aa,t){return fc(gp(aa),function(){return iV(aa,t)})()}function iV(t,ag){function ac(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ad=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=gr(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function af(au){var av;if(av=aa?iI(t,au,ag):{total_rows:ad,offset:aj,rows:au},ag.include_docs){var aq=f2(au.map(iC));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ag.conflicts,attachments:ag.attachments,binary:ag.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=iC(ay),az=aw["$"+aA];az&&(ay.doc=az)}),av})}return av}var ad,aa=t.reduceFun&&ag.reduce!==!1,aj=ag.skip||0;if("undefined"==typeof ag.keys||ag.keys.length||(ag.limit=0,delete ag.keys),"undefined"!=typeof ag.keys){var ap=ag.keys,ah=ap.map(function(au){var aq={startkey:hh([au]),endkey:hh([au,{}])};return ac(aq)});return g6.all(ah).then(U).then(af)}var ak={descending:ag.descending};if(ag.start_key&&(ag.startkey=ag.start_key),ag.end_key&&(ag.endkey=ag.end_key),"undefined"!=typeof ag.startkey&&(ak.startkey=hh(ag.descending?[ag.startkey,{}]:[ag.startkey])),"undefined"!=typeof ag.endkey){var am=ag.inclusive_end!==!1;ag.descending&&(am=!am),ak.endkey=hh(am?[ag.endkey,{}]:[ag.endkey])}if("undefined"!=typeof ag.key){var ab=hh([ag.key]),al=hh([ag.key,{}]);ak.descending?(ak.endkey=ab,ak.startkey=al):(ak.startkey=ab,ak.endkey=al)}return aa||("number"==typeof ag.limit&&(ak.limit=ag.limit),ak.skip=aj),ac(ak).then(af)}function ge(t){return t.request({method:"POST",url:"_view_cleanup"})}function f5(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=gK(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return fc(gp(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return g6.all(af).then(function(){return{ok:!0}})})},ji({ok:!0}))}function a4(t,ag,af){if("http"===t.type()){return hU(t,ag,af)}if("function"==typeof t._query){return p(t,ag,af)}if("string"!=typeof ag){i8(af,ag);var ac={db:t,viewName:"temp_view/temp_view",map:ag.map,reduce:ag.reduce,temporary:!0};return bt.add(function(){return ir(ac).then(function(ak){function aj(){return ak.db.destroy()}return iu(hl(ak).then(function(){return y(ak,af)}),aj)})}),bt.finish()}var ad=ag,aa=gK(ad),ab=aa[0],ah=aa[1];return t.get("_design/"+ab).then(function(al){var ak=al.views&&al.views[ah];if(!ak||"string"!=typeof ak.map){throw new a0("ddoc "+ab+" has no view named "+ah)}i8(af,ak);var aj={db:t,viewName:ad,map:ak.map,reduce:ak.reduce};return ir(aj).then(function(am){return"ok"===af.stale||"update_after"===af.stale?("update_after"===af.stale&&gk.nextTick(function(){hl(am)}),y(am,af)):hl(am).then(function(){return y(am,af)})})})}function il(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,il)}catch(t){}}function a0(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,a0)}catch(t){}}function ev(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,ev)}catch(t){}}function hF(t){return"'"+t+"'"}function gw(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hS(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function I(t){return delete t._id,delete t._rev,JSON.stringify(t)}function g1(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function r(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function hY(ad,aa,ab,t,ac){return"SELECT "+ad+" FROM "+("string"==typeof aa?aa:aa.join(" JOIN "))+(ab?" ON "+ab:"")+(t?" WHERE "+("string"==typeof t?t:t.join(" AND ")):"")+(ac?" ORDER BY "+ac:"")}function fi(ac,t,ag){function ad(){++aa===ac.length&&ab()}function ab(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+i7+" WHERE seq IN "+r(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+i7+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+i7+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new jk.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+i7+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+fr+" WHERE digest=?",[az]))})})})}})}}if(ac.length){var aa=0,af=[];ac.forEach(function(aj){var ah="SELECT seq FROM "+w+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[t,aj],function(al,am){if(!am.rows.length){return ad()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+w+" WHERE seq=?",[ak],ad)})})}}function g(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(eo(hT,ab,ac))}}function gu(aa){if("size" in aa){return 1000000*aa.size}var t=/Android/.test(window.navigator.userAgent);return t?5000000:1}function W(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function fd(t,aa){try{return{db:t(aa)}}catch(ab){return{error:ab}}}function gd(t){var aa=ff[t.name];if(!aa){var ab=W();aa=ff[t.name]=fd(ab,t),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return aa}function h6(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function J(t){P()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):a7()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function jg(){iH.EventEmitter.call(this),this._listeners={},J(this)}function ct(t){return decodeURIComponent(window.escape(t))}function hx(t){return 65>t?t-48:t-55}function H(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hx(t.charCodeAt(ab++))<<4|hx(t.charCodeAt(ab++)))}return aa}function iv(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hx(t.charCodeAt(ab+2))<<12|hx(t.charCodeAt(ab+3))<<8|hx(t.charCodeAt(ab))<<4|hx(t.charCodeAt(ab+1))),ab+=4}return aa}function iQ(aa,t){return"UTF-8"===t?ct(H(aa,0,aa.length)):iv(aa,0,aa.length)}function iX(aa){try{return JSON.parse(aa)}catch(t){return id.parse(aa)}}function br(aa){try{return JSON.stringify(aa)}catch(t){return id.stringify(aa)}}function ia(ab,ah,t){function ag(ak){try{return gy(ak)}catch(al){var aj=eo(iE,"Attachment is not a valid base64 string");return{error:aj}}}function af(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=ag(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===ah?al.data=bo(ak,al.content_type):"base64"===ah?al.data=jc(ak):al.data=ak,hO(ak).then(function(am){al.digest="md5-"+am,aj()})}else{gZ(al.data,function(am){"binary"===ah?al.data=iM(am):"base64"===ah&&(al.data=jc(iM(am))),hO(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function ac(){aa++,ab.length===aa&&(ad?t(ad):t())}if(!ab.length){return t()}var ad,aa=0;ab.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ac()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ac()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&af(ak.data._attachments[ap],am)}})}function ih(aa,t){return aa.pos-t.pos}function dn(ad,aa,ab){for(var t,ac=0,af=ad.length;af>ac;){t=ac+af>>>1,ab(ad[t],aa)<0?ac=t+1:af=t}return ac}function iR(t,ab,ac){var aa=dn(t,ab,ac);t.splice(aa,0,ab)}function gi(af,ad){for(var ac,ab,t=ad,ah=af.length;ah>t;t++){var aa=af[t],ag=[aa.id,aa.opts,[]];ab?(ab[2].push(ag),ab=ag):ac=ab=ag}return ac}function a8(aa,t){return aa[0]<t[0]?-1:1}function hj(ag,ad){for(var aj=[{tree1:ag,tree2:ad}],aa=!1;aj.length>0;){var ak=aj.pop(),ah=ak.tree1,af=ak.tree2;(ah[1].status||af[1].status)&&(ah[1].status="available"===ah[1].status||"available"===af[1].status?"available":"missing");for(var ac=0;ac<af[2].length;ac++){if(ah[2][0]){for(var ab=!1,t=0;t<ah[2].length;t++){ah[2][t][0]===af[2][ac][0]&&(aj.push({tree1:ah[2][t],tree2:af[2][ac]}),ab=!0)}ab||(aa="new_branch",iR(ah[2],af[2][ac],a8))}else{aa="new_leaf",ah[2][0]=af[2][ac]}}}return{conflicts:aa,tree:ag}}function iU(aj,ac,al){var ap,av=[],ad=!1,af=!1;if(!aj.length){return{tree:[ac],conflicts:"new_leaf"}}for(var aa=0,aw=aj.length;aw>aa;aa++){var am=aj[aa];if(am.pos===ac.pos&&am.ids[0]===ac.ids[0]){ap=hj(am.ids,ac.ids),av.push({pos:am.pos,ids:ap.tree}),ad=ad||ap.conflicts,af=!0}else{if(al!==!0){var aq=am.pos<ac.pos?am:ac,ag=am.pos<ac.pos?ac:am,ah=ag.pos-aq.pos,ab=[],ax=[];for(ax.push({ids:aq.ids,diff:ah,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],t=0,ak=az.length;ak>t;t++){ax.push({ids:az[t],diff:ay.diff-1,parent:ay.ids,parentIdx:t})}}else{ay.ids[0]===ag.ids[0]&&ab.push(ay)}}var au=ab[0];au?(ap=hj(au.ids,ag.ids),au.parent[2][au.parentIdx]=ap.tree,av.push({pos:aq.pos,ids:aq.ids}),ad=ad||ap.conflicts,af=!0):av.push(am)}else{av.push(am)}}}return af||av.push(ac),av.sort(ih),{tree:av,conflicts:ad||"internal_node"}}function hH(ag,ad){for(var aj,aa=E(ag),ak=0,ah=aa.length;ah>ak;ak++){var af=aa[ak],ac=af.ids,ab=Math.max(0,ac.length-ad),t={pos:af.pos+ab,ids:gi(ac,ab)};aj=aj?iU(aj,t,!0).tree:[t]}return aj}function fx(t,ab,ac){var aa=iU(t,ab);return{tree:hH(aa.tree,ac),conflicts:aa.conflicts}}function a1(ag,ad){for(var aj,aa=ag.slice(),ak=ad.split("-"),ah=parseInt(ak[0],10),af=ak[1];aj=aa.pop();){if(aj.pos===ah&&aj.ids[0]===af){return !0}for(var ac=aj.ids[2],ab=0,t=ac.length;t>ab;ab++){aa.push({pos:aj.pos+1,ids:ac[ab]})}}return !1}function fR(ah,t,aq,ay,au,ab,ad,aA){if(a1(t.rev_tree,aq.metadata.rev)){return ay[au]=aq,ab()}var ac=t.winningRev||Q(t),av="deleted" in t?t.deleted:hE(t,ac),am="deleted" in aq.metadata?aq.metadata.deleted:hE(aq.metadata),ag=/^1-/.test(aq.metadata.rev);if(av&&!am&&aA&&ag){var aa=aq.data;aa._rev=ac,aa._id=aq.metadata.id,aq=ht(aa,aA)}var ax=fx(t.rev_tree,aq.metadata.rev_tree[0],ah),az=aA&&(av&&am||!av&&"new_leaf"!==ax.conflicts||av&&!am&&"new_branch"===ax.conflicts);if(az){var ak=eo(h8);return ay[au]=ak,ab()}var aw=aq.metadata.rev;aq.metadata.rev_tree=ax.tree,t.rev_map&&(aq.metadata.rev_map=t.rev_map);var aj,al=Q(aq.metadata),af=hE(aq.metadata,al),ap=av===af?0:af>av?-1:1;aj=aw===al?af:hE(aq.metadata,aw),ad(aq,al,af,aj,!0,ap,au,ab)}function iK(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function x(t,ah,ak,aa,aq,af,aj,ac,am){function ap(aA,aC,aw){var av=Q(aA.metadata),az=hE(aA.metadata,av);if("was_delete" in ac&&az){return af[aC]=eo(iA,"deleted"),aw()}var ay=au&&iK(aA);if(ay){var ax=eo(h8);return af[aC]=ax,aw()}var aB=az?0:1;aj(aA,av,az,az,!1,aB,aC,aw)}function ad(){++ab===al&&am&&am()}t=t||1000;var au=ac.new_edits,ag=new jk.Map,ab=0,al=ah.length;ah.forEach(function(aw,ay){if(aw._id&&hA(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void ak[ax](aw,{ctx:aq},function(aA,az){af[ay]=aA||az,ad()})}var av=aw.metadata.id;ag.has(av)?(al--,ag.get(av).push([aw,ay])):ag.set(av,[[aw,ay]])}),ag.forEach(function(ay,aw){function ax(){++az<ay.length?av():ad()}function av(){var aC=ay[az],aB=aC[0],aA=aC[1];if(aa.has(aw)){fR(t,aa.get(aw),aB,af,aA,ax,aj,au)}else{var aD=fx([],aB.metadata.rev_tree[0],t);aB.metadata.rev_tree=aD.tree,ap(aB,aA,ax)}}var az=0;av()})}function iB(aa){var t=[];return T(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function hm(ad,av,aq,aw,az,al,ab){function au(){return ah?ab(ah):(al.notify(aw._name),aw._docCount=-1,void ab(null,am))}function aa(aD,aE){var aC="SELECT count(*) as cnt FROM "+fr+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=eo(h2,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aA(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(t.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aa(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function af(aR,aF,aO,aC,aH,aM,aD,aI){function aP(){function aT(bg,bh){function bf(){return ++bc===ba.length&&bh(),!1}function bb(bj){var bi="INSERT INTO "+i7+" (digest, seq) VALUES (?,?)",bk=[aS._attachments[bj].digest,bg];ap.executeSql(bi,bk,bf,bf)}var bc=0,ba=Object.keys(aS._attachments||{});if(!ba.length){return bh()}for(var bd=0;bd<ba.length;bd++){bb(ba[bd])}}var aS=aR.data,aW=aC?1:0,aX=aS._id,aV=aS._rev,aY=I(aS),aZ="INSERT INTO "+w+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aU=[aX,aV,aY,aW];ap.executeSql(aZ,aU,function(ba,bb){var bc=bb.insertId;aT(bc,function(){aE(ba,bc)})},function(){var ba=hY("seq",w,null,"doc_id=? AND rev=?");return ap.executeSql(ba,[aX,aV],function(bd,bf){var bc=bf.rows.item(0).seq,bb="UPDATE "+w+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aY,aW,aX,aV];bd.executeSql(bb,bg,function(bh){aT(bc,function(){aE(bh,bc)})})}),!1})}function aG(aS){aJ||(aS?(aJ=aS,aI(aJ)):aN===aL.length&&aP())}function aK(aS){aN++,aG(aS)}function aQ(){if(aH&&aw.auto_compaction){var aS=aR.metadata.id,aT=iB(aR.metadata);fi(aT,aS,ap)}}function aE(aW,aS){aQ(),aR.metadata.seq=aS,delete aR.metadata.rev;var aU=aH?"UPDATE "+fs+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+w+" WHERE doc_id="+fs+".id AND rev=?) WHERE id=?":"INSERT INTO "+fs+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=br(aR.metadata),aX=aR.metadata.id,aV=aH?[aT,aS,aF,aX]:[aX,aS,aS,aT];aW.executeSql(aU,aV,function(){am[aD]={ok:!0,id:aR.metadata.id,rev:aF},ac.set(aX,aR.metadata),aI()})}var aJ=null,aN=0;aR.data._id=aR.metadata.id,aR.data._rev=aR.metadata.rev;var aL=Object.keys(aR.data._attachments||{});aC&&(aR.data._deleted=!0),aL.forEach(function(aU){var aT=aR.data._attachments[aU];if(aT.stub){aN++,aG()}else{var aS=aT.data;delete aT.data;var aV=aT.digest;aB(aV,aS,aK)}}),aL.length||aP()}function ag(){x(ad.revs_limit,t,aw,ac,ap,am,af,aq)}function aj(aD){function aE(){++aC===t.length&&aD()}if(!t.length){return aD()}var aC=0;t.forEach(function(aG){if(aG._id&&hA(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+fs+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=iX(aI.rows.item(0).json);ac.set(aF,aJ)}aE()})})}function aB(aD,aF,aC){var aE="SELECT digest FROM "+fr+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+fr+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,gw(aF)],function(){aC()},function(){return aC(),!1}))})}var ay=aq.new_edits,ax=av.docs,t=ax.map(function(aC){if(aC._id&&hA(aC._id)){return aC}var aD=ht(aC,ay);return aD}),ak=t.filter(function(aC){return aC.error});if(ak.length){return ab(ak[0])}var ap,ah,am=new Array(t.length),ac=new jk.Map;ia(t,"binary",function(aC){return aC?ab(aC):void az.transaction(function(aD){ap=aD,aA(function(aE){aE?ah=aE:aj(ag)})},g(ab),au)})}function ip(aj,ag,t,ac,aa){function ah(){++ab===ad.length&&aa&&aa()}function af(am,ak){var al=am._attachments[ak],ap={binary:ag.binary,ctx:ac};t._getAttachment(al,ap,function(aq,au){am._attachments[ak]=hW.extend(j(al,["digest","content_type"]),{data:au}),ah()})}var ad=Object.keys(aj._attachments||{});if(!ad.length){return aa&&aa()}var ab=0;ad.forEach(function(ak){ag.attachments&&ag.include_docs?af(aj,ak):(aj._attachments[ak].stub=!0,ah())})}function hB(aa,ay){function aq(){a7()&&(window.localStorage["_pouch__websqldb_"+al._name]=!0),ay(null,al)}function aw(aC,aD){aC.executeSql(k),aC.executeSql("ALTER TABLE "+w+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(gN),aC.executeSql("ALTER TABLE "+fs+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+fs+" (local, id)");var aE="SELECT "+fs+".winningseq AS seq, "+fs+".json AS metadata FROM "+w+" JOIN "+fs+" ON "+w+".seq = "+fs+".winningseq";aC.executeSql(aE,[],function(aG,aJ){for(var aI=[],aL=[],aM=0;aM<aJ.rows.length;aM++){var aH=aJ.rows.item(aM),aK=aH.seq,aF=JSON.parse(aH.metadata);hE(aF)&&aI.push(aK),hA(aF.id)&&aL.push(aF.id)}aG.executeSql("UPDATE "+fs+"SET local = 1 WHERE id IN "+r(aL.length),aL,function(){aG.executeSql("UPDATE "+w+" SET deleted = 1 WHERE seq IN "+r(aI.length),aI,aD)})})})})}function az(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+es+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+fs+".id AS id, "+w+".json AS data FROM "+w+" JOIN "+fs+" ON "+w+".seq = "+fs+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aJ,aH){function aK(){if(!aI.length){return aE(aJ)}var aL=aI.shift(),aM=JSON.parse(aL.data)._rev;aJ.executeSql("INSERT INTO "+es+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+fs+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+w+" WHERE seq=?",[aL.seq],function(){aK()})})})}for(var aI=[],aG=0;aG<aH.rows.length;aG++){aI.push(aH.rows.item(aG))}aK()})})}function ag(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aL=aG.shift(),aN=iQ(aL.hex,av),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aI=aN.substring(aK+2),aJ="UPDATE "+w+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aJ,[aM,aI,aN],function(){aH()})}aH()}var aE="ALTER TABLE "+w+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+w+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(an,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+w;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function t(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+fr;aH.executeSql(aG,[],function(aM,aK){function aN(){var aO=hY(gX+", "+fs+".id AS id",[fs,w],hf,null,fs+".id ");aO+=" LIMIT "+aJ+" OFFSET "+aI,aI+=aJ,aM.executeSql(aO,[],function(aZ,aU){function aX(bc,bd){var bb=aS[bc]=aS[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aU.rows.length){return aF(aZ)}for(var aS={},aY=0;aY<aU.rows.length;aY++){for(var aV=aU.rows.item(aY),aW=g1(aV.data,aV.id,aV.rev),aR=Object.keys(aW._attachments||{}),aP=0;aP<aR.length;aP++){var aT=aW._attachments[aR[aP]];aX(aT.digest,aV.seq)}}var aQ=[];if(Object.keys(aS).forEach(function(bb){var bc=aS[bb];bc.forEach(function(bd){aQ.push([bb,bd])})}),!aQ.length){return aN()}var ba=0;aQ.forEach(function(bc){var bb="INSERT INTO "+i7+" (digest, seq) VALUES (?,?)";aZ.executeSql(bb,bc,function(){++ba===aQ.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aF(aM)}var aI=0,aJ=10;aN()})}var aE="CREATE TABLE IF NOT EXISTS "+i7+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(fu,[],function(aH){aH.executeSql(Z,[],aC)})})}function au(aD,aE){var aC="ALTER TABLE "+fr+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function aA(aD,aE){var aC="ALTER TABLE "+fs+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+fs+" SET max_seq=(SELECT MAX(seq) FROM "+w+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aI){var aH="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+fs+" (max_seq)";aI.executeSql(aH,[],aE)})})}function ak(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;av=2===aG.length?"UTF-8":"UTF-16",aD()})}function ax(){for(;am.length>0;){var aC=am.pop();aC(null,af)}}function aj(aG,aJ){if(0===aJ){var aC="CREATE TABLE IF NOT EXISTS "+o+" (dbid, db_version INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+fr+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aI="CREATE TABLE IF NOT EXISTS "+i7+" (digest, seq INTEGER)",aF="CREATE TABLE IF NOT EXISTS "+fs+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aH="CREATE TABLE IF NOT EXISTS "+w+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aD="CREATE TABLE IF NOT EXISTS "+es+" (id UNIQUE, rev, json)";aG.executeSql(aE),aG.executeSql(aD),aG.executeSql(aI,[],function(){aG.executeSql(Z),aG.executeSql(fu)}),aG.executeSql(aF,[],function(){aG.executeSql(k),aG.executeSql(aH,[],function(){aG.executeSql(gN),aG.executeSql(an),aG.executeSql(aC,[],function(){var aP="INSERT INTO "+o+" (db_version, dbid) VALUES (?,?)";af=ce();var aO=[fk,af];aG.executeSql(aP,aO,function(){ax()})})})})}else{var aK=function(){var aO=fk>aJ;aO&&aG.executeSql("UPDATE "+o+" SET db_version = "+fk);var aP="SELECT dbid FROM "+o;aG.executeSql(aP,[],function(aR,aQ){af=aQ.rows.item(0).dbid,ax()})},aN=[aw,az,ag,t,au,aA,aK],aM=aJ,aL=function(aO){aN[aM-1](aO,aL),aM++};aL(aG)}}function ab(){ac.transaction(function(aC){ak(aC,function(){aB(aC)})},g(ay),aq)}function aB(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+o;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+o,[],function(aH,aI){var aG=aI.rows.item(0).db_version;aj(aH,aG)}):aE.executeSql("ALTER TABLE "+o+" ADD COLUMN db_version INTEGER",[],function(){aj(aE,1)}):aj(aE,0)})}function ad(aD,aE){if(-1!==al._docCount){return aE(al._docCount)}var aC=hY("COUNT("+fs+".id) AS 'num'",[fs,w],hf,w+".deleted=0");aD.executeSql(aC,[],function(aG,aF){al._docCount=aF.rows.item(0).num,aE(al._docCount)})}var av,al=this,af=null,ap=gu(aa),am=[];al._docCount=-1,al._name=aa.name;var ah=gd({name:al._name,version:f8,description:al._name,size:ap,location:aa.location,createFromLocation:aa.createFromLocation,androidDatabaseImplementation:aa.androidDatabaseImplementation});if(ah.error){return g(ay)(ah.error)}var ac=ah.db;"function"!=typeof ac.readTransaction&&(ac.readTransaction=ac.transaction),ab(),al.type=function(){return"websql"},al._id=v(function(aC){aC(null,af)}),al._info=function(aC){ac.readTransaction(function(aD){ad(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+w;aD.executeSql(aF,[],function(aI,aH){var aG=aH.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aG,sqlite_plugin:ac._sqlitePlugin,websql_encoding:av})})})},g(aC))},al._bulkDocs=function(aE,aC,aD){hm(aa,aE,aC,al,ac,hB.Changes,aD)},al._get=function(aC,aI,aE){function aH(){aE(aK,{doc:aG,metadata:aD,ctx:aF})}var aG,aD,aK,aF=aI.ctx;if(!aF){return ac.readTransaction(function(aM){al._get(aC,hW.extend({ctx:aM},aI),aE)})}var aJ,aL;aI.rev?(aJ=hY(gX,[fs,w],fs+".id="+w+".doc_id",[w+".doc_id=?",w+".rev=?"]),aL=[aC,aI.rev]):(aJ=hY(gX,[fs,w],hf,fs+".id=?"),aL=[aC]),aF.executeSql(aJ,aL,function(aO,aN){if(!aN.rows.length){return aK=eo(iA,"missing"),aH()}var aM=aN.rows.item(0);return aD=iX(aM.metadata),aM.deleted&&!aI.rev?(aK=eo(iA,"deleted"),aH()):(aG=g1(aM.data,aD.id,aM.rev),void aH())})},al._allDocs=function(aE,aL){var aO,aF=[],aD="startkey" in aE?aE.startkey:!1,aI="endkey" in aE?aE.endkey:!1,aN="key" in aE?aE.key:!1,aK="descending" in aE?aE.descending:!1,aM="limit" in aE?aE.limit:-1,aP="skip" in aE?aE.skip:0,aG=aE.inclusive_end!==!1,aJ=[],aC=[];if(aN!==!1){aC.push(fs+".id = ?"),aJ.push(aN)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aC.push(fs+".id "+(aK?"<=":">=")+" ?"),aJ.push(aD)),aI!==!1){var aH=aK?">":"<";aG&&(aH+="="),aC.push(fs+".id "+aH+" ?"),aJ.push(aI)}aN!==!1&&(aC.push(fs+".id = ?"),aJ.push(aN))}}"ok"!==aE.deleted&&aC.push(w+".deleted = 0"),ac.readTransaction(function(aQ){ad(aQ,function(aS){if(aO=aS,0!==aM){var aR=hY(gX,[fs,w],hf,aC,fs+".id "+(aK?"DESC":"ASC"));aR+=" LIMIT "+aM+" OFFSET "+aP,aQ.executeSql(aR,aJ,function(aW,aZ){for(var aY=0,aX=aZ.rows.length;aX>aY;aY++){var aT=aZ.rows.item(aY),ba=iX(aT.metadata),bb=ba.id,aU=g1(aT.data,bb,aT.rev),aV=aU._rev,bc={id:bb,key:bb,value:{rev:aV}};if(aE.include_docs&&(bc.doc=aU,bc.doc._rev=aV,aE.conflicts&&(bc.doc._conflicts=R(ba)),ip(bc.doc,aE,al,aW)),aT.deleted){if("ok"!==aE.deleted){continue}bc.value.deleted=!0,bc.doc=null}aF.push(bc)}})}})},g(aL),function(){aL(null,{total_rows:aO,offset:aE.skip,rows:aF})})},al._changes=function(aD){function aH(){var aM=fs+".json AS metadata, "+fs+".max_seq AS maxSeq, "+w+".json AS winningDoc, "+w+".rev AS winningRev ",aL=fs+" JOIN "+w,aN=fs+".id="+w+".doc_id AND "+fs+".winningseq="+w+".seq",aO=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aO.push(fs+".id IN "+r(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aK="maxSeq "+(aE?"DESC":"ASC"),aQ=hY(aM,aL,aN,aO,aK),aS=be(aD);aD.view||aD.filter||(aQ+=" LIMIT "+aI);var aP=aD.since||0;ac.readTransaction(function(aT){aT.executeSql(aQ,aR,function(aW,aU){function aV(bf){return function(){aD.onChange(bf)}}for(var aX=0,aZ=aU.rows.length;aZ>aX;aX++){var bb=aU.rows.item(aX),bc=iX(bb.metadata);aP=bb.maxSeq;var ba=g1(bb.winningDoc,bc.id,bb.winningRev),aY=aD.processChange(ba,bc,aD);aY.seq=bb.maxSeq;var bd=aS(aY);if("object"==typeof bd){return aD.complete(bd)}if(bd&&(aF++,aJ&&aC.push(aY),aD.attachments&&aD.include_docs?ip(ba,aD,al,aW,aV(aY)):aV(aY)()),aF===aI){break}}})},g(aD.complete),function(){aD.continuous||aD.complete(null,{results:aC,last_seq:aP})})}if(aD=ij(aD),aD.continuous){var aG=al._name+":"+ce();return hB.Changes.addListener(al._name,aG,al,aD),hB.Changes.notify(al._name),{cancel:function(){hB.Changes.removeListener(al._name,aG)}}}var aE=aD.descending;aD.since=aD.since&&!aE?aD.since:0;var aI="limit" in aD?aD.limit:-1;0===aI&&(aI=1);var aJ;aJ="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aC=[],aF=0;aH()},al._close=function(aC){aC()},al._getAttachment=function(aD,aH,aG){var aE,aI=aH.ctx,aJ=aD.digest,aC=aD.content_type,aF="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+fr+" WHERE digest=?";aI.executeSql(aF,[aJ],function(aL,aK){var aN=aK.rows.item(0),aM=aN.escaped?hS(aN.body):iQ(aN.body,av);aE=aH.binary?bo(aM,aC):jc(aM),aG(null,aE)})},al._getRevisionTree=function(aC,aD){ac.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+fs+" WHERE id = ?";aE.executeSql(aF,[aC],function(aH,aG){if(aG.rows.length){var aI=iX(aG.rows.item(0).metadata);aD(null,aI.rev_tree)}else{aD(eo(iA))}})})},al._doCompaction=function(aD,aE,aC){return aE.length?void ac.transaction(function(aF){var aG="SELECT json AS metadata FROM "+fs+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){var aI=iX(aJ.rows.item(0).metadata);T(aI.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aK="UPDATE "+fs+" SET json = ? WHERE id = ?";aH.executeSql(aK,[br(aI),aD])}),fi(aE,aD,aF)},g(aC),function(){aC()}):aC()},al._getLocal=function(aC,aD){ac.readTransaction(function(aE){var aF="SELECT json, rev FROM "+es+" WHERE id=?";aE.executeSql(aF,[aC],function(aG,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=g1(aH.json,aC,aH.rev);aD(null,aJ)}else{aD(eo(iA))}})})},al._putLocal=function(aC,aI,aE){function aG(aN){var aL,aM;aD?(aL="UPDATE "+es+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aF,aJ,aK,aD]):(aL="INSERT INTO "+es+" (id, rev, json) VALUES (?,?,?)",aM=[aK,aF,aJ]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aH={ok:!0,id:aK,rev:aF},aI.ctx&&aE(null,aH)):aE(eo(h8))},function(){return aE(eo(h8)),!1})}"function"==typeof aI&&(aE=aI,aI={}),delete aC._revisions;var aF,aD=aC._rev,aK=aC._id;aF=aD?aC._rev="0-"+(parseInt(aD.split("-")[1],10)+1):aC._rev="0-1";var aH,aJ=I(aC);aI.ctx?aG(aI.ctx):ac.transaction(aG,g(aE),function(){aH&&aE(null,aH)})},al._removeLocal=function(aE,aG,aC){function aF(aH){var aI="DELETE FROM "+es+" WHERE id=? AND rev=?",aJ=[aE._id,aE._rev];aH.executeSql(aI,aJ,function(aL,aK){return aK.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(eo(iA))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ac.transaction(aF,g(aC),function(){aD&&aC(null,aD)})},al._destroy=function(aC,aD){hB.Changes.removeAllListeners(al._name),ac.transaction(function(aE){var aF=[fs,w,fr,o,es,i7];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},g(aD),function(){a7()&&(delete window.localStorage["_pouch__websqldb_"+al._name],delete window.localStorage[al._name]),aD(null,{ok:!0})})}}function ei(t,ab,ac){try{t.apply(ab,ac)}catch(aa){"undefined"!=typeof PouchDB&&PouchDB.emit("error",aa)}}function hK(){if(!fU.running&&fU.queue.length){fU.running=!0;var t=fU.queue.shift();t.action(function(ab,aa){ei(t.callback,this,[ab,aa]),fU.running=!1,gk.nextTick(hK)})}}function jh(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(eo(ib,aa,ab.type))}}function ao(t,aa,ab){return{data:br(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function hC(aa){if(!aa){return null}var t=iX(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function f3(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function K(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:iO(t,ab):gV([""],{type:ab})):t?"string"!=typeof t?ar(t,function(ad){aa(jc(ad))}):aa(t):aa("")}function D(af,ad,ac,ab){function t(){++ag===aa.length&&ab&&ab()}function ah(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ac.objectStore(eu).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,t()}}var aa=Object.keys(af._attachments||{});if(!aa.length){return ab&&ab()}var ag=0;aa.forEach(function(aj){ad.attachments&&ad.include_docs?ah(af,aj):(af._attachments[aj].stub=!0,t())})}function hu(aa,t){return g6.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return g6.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new g6(function(aj){K(ah,af,t,function(ak){ac.doc._attachments[ag]=hW.extend(j(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function f7(ag,ad,aj){function aa(){t--,t||ak()}function ak(){ah.length&&ah.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ac["delete"](am)}})}var ah=[],af=aj.objectStore(X),ac=aj.objectStore(eu),ab=aj.objectStore(fT),t=ag.length;ag.forEach(function(al){var am=af.index("_doc_id_rev"),ap=ad+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return aa()}af["delete"](au);var av=ab.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ah.push(ax),ab["delete"](aw.primaryKey),aw["continue"]()}else{aa()}}}})}function hQ(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function L(aq,aa,aC,aE,ak,af,am){function ab(){var aO=[m,X,eu,fa,g5,fT],aP=hQ(ak,aO,"readwrite");return aP.error?am(aP.error):(ah=aP.txn,ah.onabort=jh(am),ah.ontimeout=jh(am),ah.oncomplete=aL,av=ah.objectStore(m),al=ah.objectStore(X),ap=ah.objectStore(eu),ay=ah.objectStore(fT),void aN(function(aQ){return aQ?(aK=!0,am(aQ)):void aB()}))}function ad(){x(aq.revs_limit,ax,aE,aI,ah,aJ,aD,aC)}function aB(){function aU(){++aS===ax.length&&ad()}function aP(aW){var aV=hC(aW.target.result);aV&&aI.set(aV.id,aV),aU()}if(ax.length){for(var aS=0,aO=0,aT=ax.length;aT>aO;aO++){var aQ=ax[aO];if(aQ._id&&hA(aQ._id)){aU()}else{var aR=av.get(aQ.metadata.id);aR.onsuccess=aP}}}}function aL(){aK||(af.notify(aE._meta.name),aE._meta.docCount+=aA,am(null,aJ))}function t(aP,aQ){var aO=ap.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=eo(h2,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(ax.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){t(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function aD(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?aw(aR,aX,aT,aU,aP,aW):void aH(aR,aX,aT,aU,aP,aW)}function ac(aO){var aP=iB(aO.metadata);f7(aP,aO.metadata.id,ah)}function aH(aP,aW,aT,aU,aR,aY){function aV(ba){aU&&aE.auto_compaction&&ac(aP),aS.seq=ba.target.result,delete aS.rev;var bb=ao(aS,aW,aT),bc=av.put(bb);bc.onsuccess=aZ}function aX(bb){bb.preventDefault(),bb.stopPropagation();var bc=al.index("_doc_id_rev"),ba=bc.getKey(aQ._doc_id_rev);ba.onsuccess=function(bd){var bf=al.put(aQ,bd.target.result);bf.onsuccess=aV}}function aZ(){aJ[aR]={ok:!0,id:aS.id,rev:aW},aI.set(aP.metadata.id,aP.metadata),aj(aP,aS.seq,aY)}var aQ=aP.data,aS=aP.metadata;aQ._doc_id_rev=aS.id+"::"+aS.rev,delete aQ._id,delete aQ._rev;var aO=al.put(aQ);aO.onsuccess=aV,aO.onerror=aX}function aw(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&aH(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(bb){var aZ=aQ.data._attachments[bb];if(aZ.stub){aP++,aO()}else{var bc=aZ.data;delete aZ.data;var ba=aZ.digest;aM(ba,bc,aW)}})}function aj(aV,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aW){var aX=aV.data._attachments[aW].digest,aY=ay.put({seq:aQ,digestSeq:aX+"::"+aQ});aY.onsuccess=aO,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aV.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function aM(aP,aR,aO){var aQ=ap.count(aP);aQ.onsuccess=function(aV){var aU=aV.target.result;if(aU){return aO()}var aS={digest:aP,body:aR},aT=ap.put(aS);aT.onsuccess=aO}}for(var ah,av,al,ap,ay,aF,ax=aa.docs,aA=0,az=0,ag=ax.length;ag>az;az++){var aG=ax[az];aG._id&&hA(aG._id)||(aG=ax[az]=ht(aG,aC.new_edits),aG.error&&!aF&&(aF=aG))}if(aF){return am(aF)}var aJ=new Array(ax.length),aI=new jk.Map,aK=!1,au=aE._meta.blobSupport?"blob":"base64";ia(ax,au,function(aO){return aO?am(aO):void ab()})}function fg(ad,aa,ab,t,ac){try{if(ad&&aa){return ac?IDBKeyRange.bound(aa,ad,!ab,!1):IDBKeyRange.bound(ad,aa,!1,!ab)}if(ad){return ac?IDBKeyRange.upperBound(ad):IDBKeyRange.lowerBound(ad)}if(aa){return ac?IDBKeyRange.lowerBound(aa,!ab):IDBKeyRange.upperBound(aa,!ab)}if(t){return IDBKeyRange.only(t)}}catch(af){return{error:af}}return null}function gR(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(eo(ib,ac.name,ac.message))}function l(ad,aa,ab,t){function ac(aH,aG){function aj(aL,aM,aK){var aN=aL.id+"::"+aK;ap.get(aN).onsuccess=function(aO){aM.doc=f3(aO.target.result),aH.conflicts&&(aM.doc._conflicts=R(aL)),D(aM.doc,aH,aJ)}}function av(aK,aN,aO){var aL={id:aO.id,key:aO.id,value:{rev:aN}},aM=aO.deleted;if("ok"===aH.deleted){az.push(aL),aM?(aL.value.deleted=!0,aL.doc=null):aH.include_docs&&aj(aO,aL,aN)}else{if(!aM&&aB--<=0&&(az.push(aL),aH.include_docs&&aj(aO,aL,aN),0===--aD)){return}}aK["continue"]()}function ak(aK){ag=aa._meta.docCount;var aM=aK.target.result;if(aM){var aL=hC(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aA(){aG(null,{total_rows:ag,offset:aH.skip,rows:az})}function ax(){aH.attachments?hu(az,aH.binary).then(aA):aA()}var al="startkey" in aH?aH.startkey:!1,aw="endkey" in aH?aH.endkey:!1,ah="key" in aH?aH.key:!1,aB=aH.skip||0,aD="number"==typeof aH.limit?aH.limit:-1,ay=aH.inclusive_end!==!1,aC="descending" in aH&&aH.descending?"prev":null,am=fg(al,aw,ay,ah,aC);if(am&&am.error){return gR(aa,aH,am.error,aG)}var aq=[m,X];aH.attachments&&aq.push(eu);var aE=hQ(ab,aq,"readonly");if(aE.error){return aG(aE.error)}var aJ=aE.txn,au=aJ.objectStore(m),aF=aJ.objectStore(X),aI=aC?au.openCursor(am,aC):au.openCursor(am),ap=aF.index("_doc_id_rev"),az=[],ag=0;aJ.oncomplete=ax,aI.onsuccess=ak}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:aa._meta.docCount,offset:ah.skip,rows:[]}):void ac(ah,ag)}af(ad,t)}function a3(t){return new g6(function(ab){var aa=gV([""]);t.objectStore(fS).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function ga(t,aa){var ab=this;fU.queue.push({action:function(ac){jb(ab,t,ac)},callback:aa}),hK()}function jb(ap,ab,ak){function ah(av){var aw=av.createObjectStore(m,{keyPath:"id"});av.createObjectStore(X,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(eu,{keyPath:"digest"}),av.createObjectStore(fa,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(fS),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(g5,{keyPath:"_id"});var au=av.createObjectStore(fT,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function af(av,aw){var au=av.objectStore(m);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=hE(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function al(au){au.createObjectStore(g5,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ac(ax,aw){var az=ax.objectStore(g5),ay=ax.objectStore(m),av=ax.objectStore(X),au=ay.openCursor();au.onsuccess=function(aB){var aE=aB.target.result;if(aE){var aK=aE.value,aH=aK.id,aI=hA(aH),aL=Q(aK);if(aI){var aC=aH+"::"+aL,aF=aH+"::",aA=aH+"::~",aD=av.index("_doc_id_rev"),aG=IDBKeyRange.bound(aF,aA,!1,!1),aJ=aD.openCursor(aG);aJ.onsuccess=function(aN){if(aJ=aN.target.result){var aM=aJ.value;aM._doc_id_rev===aC&&az.put(aM),av["delete"](aJ.primaryKey),aJ["continue"]()}else{ay["delete"](aE.primaryKey),aE["continue"]()}}}else{aE["continue"]()}}else{aw&&aw()}}}function ag(au){var av=au.createObjectStore(fT,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function am(ax,aw){var az=ax.objectStore(X),ay=ax.objectStore(eu),av=ax.objectStore(fT),au=ay.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (az.openCursor().onsuccess=function(aF){var aJ=aF.target.result;if(!aJ){return aw()}for(var aK=aJ.value,aH=aJ.primaryKey,aD=Object.keys(aK._attachments||{}),aL={},aC=0;aC<aD.length;aC++){var aE=aK._attachments[aD[aC]];aL[aE.digest]=!0}var aG=Object.keys(aL);for(aC=0;aC<aG.length;aC++){var aI=aG[aC];av.put({seq:aH,digestSeq:aI+"::"+aH})}aJ["continue"]()}):aw()}}function aq(ay){function aw(az){return az.data?hC(az):(az.deleted="1"===az.deletedOrLocal,az)}var av=ay.objectStore(X),au=ay.objectStore(m),ax=au.openCursor();ax.onsuccess=function(aC){function az(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=av.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=ao(aD,aD.winningRev,aD.deleted),aF=au.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=aC.target.result;if(aB){var aD=aw(aB.value);return aD.winningRev=aD.winningRev||Q(aD),aD.seq?aA():void az()}}}var aj=ab.name,aa=null;ap._meta=null,ap.type=function(){return"idb"},ap._id=v(function(au){au(null,ap._meta.instanceId)}),ap._bulkDocs=function(au,aw,av){L(ab,au,aw,ap,aa,ga.Changes,av)},ap._get=function(av,aA,aw){function ay(){aw(au,{doc:ax,metadata:aB,ctx:az})}var ax,aB,au,az=aA.ctx;if(!az){var aC=hQ(aa,[m,X,eu],"readonly");if(aC.error){return aw(aC.error)}az=aC.txn}az.objectStore(m).get(av).onsuccess=function(aG){if(aB=hC(aG.target.result),!aB){return au=eo(iA,"missing"),ay()}if(hE(aB)&&!aA.rev){return au=eo(iA,"deleted"),ay()}var aE=az.objectStore(X),aD=aA.rev||aB.winningRev,aF=aB.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return ax=aH.target.result,ax&&(ax=f3(ax)),ax?void ay():(au=eo(iA,"missing"),ay())}}},ap._getAttachment=function(ay,aA,av){var aw;if(aA.ctx){aw=aA.ctx}else{var ax=hQ(aa,[m,X,eu],"readonly");if(ax.error){return av(ax.error)}aw=ax.txn}var az=ay.digest,au=ay.content_type;aw.objectStore(eu).get(az).onsuccess=function(aC){var aB=aC.target.result.body;K(aB,au,aA.binary,function(aD){av(null,aD)})}},ap._info=function(aA){if(null===aa||!fw[aj]){var aw=new Error("db isn't open");return aw.id="idbNull",aA(aw)}var av,ax,az=hQ(aa,[X],"readonly");if(az.error){return aA(az.error)}var au=az.txn,ay=au.objectStore(X).openCursor(null,"prev");ay.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,ax=ap._meta.docCount},au.oncomplete=function(){aA(null,{doc_count:ax,update_seq:av,idb_attachment_format:ap._meta.blobSupport?"binary":"base64"})}},ap._allDocs=function(av,au){l(av,ap,aa,au)},ap._changes=function(aD){function aE(aP){function aM(){return aS.seq!==aR?aP["continue"]():(au=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aC.get(aU);aT.onsuccess=function(aV){aN(f3(aV.target.result))}}function aN(aU){var aT=aD.processChange(aU,aS,aD);aT.seq=aS.seq;var aV=aF(aT);return"object"==typeof aV?aD.complete(aV):(aV&&(aH++,aG&&aJ.push(aT),aD.attachments&&aD.include_docs?D(aU,aD,ax,function(){hu([aT],aD.binary).then(function(){aD.onChange(aT)})}):aD.onChange(aT)),void (aH!==aA&&aP["continue"]()))}var aQ=f3(aP.value),aR=aP.key;if(aK&&!aK.has(aQ._id)){return aP["continue"]()}var aS;return(aS=ay.get(aQ._id))?aM():void (az.get(aQ._id).onsuccess=function(aT){aS=hC(aT.target.result),ay.set(aQ._id,aS),aM()})}function aw(aN){var aM=aN.target.result;aM&&aE(aM)}function av(){var aM=[m,X];aD.attachments&&aM.push(eu);var aN=hQ(aa,aM,"readonly");if(aN.error){return aD.complete(aN.error)}ax=aN.txn,ax.onabort=jh(aD.complete),ax.oncomplete=aL,aI=ax.objectStore(X),az=ax.objectStore(m),aC=aI.index("_doc_id_rev");var aO;aO=aD.descending?aI.openCursor(null,"prev"):aI.openCursor(IDBKeyRange.lowerBound(aD.since,!0)),aO.onsuccess=aw}function aL(){function aM(){aD.complete(null,{results:aJ,last_seq:au})}!aD.continuous&&aD.attachments?hu(aJ).then(aM):aM()}if(aD=ij(aD),aD.continuous){var aB=aj+":"+ce();return ga.Changes.addListener(aj,aB,ap,aD),ga.Changes.notify(aj),{cancel:function(){ga.Changes.removeListener(aj,aB)}}}var aK=aD.doc_ids&&new jk.Set(aD.doc_ids);aD.since=aD.since||0;var au=aD.since,aA="limit" in aD?aD.limit:-1;0===aA&&(aA=1);var aG;aG="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var ax,aI,az,aC,aJ=[],aH=0,aF=be(aD),ay=new jk.Map;av()},ap._close=function(au){return null===aa?au(eo(fv)):(aa.close(),delete fw[aj],aa=null,void au())},ap._getRevisionTree=function(ay,aw){var av=hQ(aa,[m],"readonly");if(av.error){return aw(av.error)}var au=av.txn,ax=au.objectStore(m).get(ay);ax.onsuccess=function(aA){var az=hC(aA.target.result);az?aw(null,az.rev_tree):aw(eo(iA))}},ap._doCompaction=function(ay,aA,av){var aw=[m,X,eu,fT],ax=hQ(aa,aw,"readwrite");if(ax.error){return av(ax.error)}var az=ax.txn,au=az.objectStore(m);au.get(ay).onsuccess=function(aC){var aE=hC(aC.target.result);T(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==aA.indexOf(aF)&&(aK.status="missing")}),f7(aA,ay,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(m).put(ao(aE,aD,aB))},az.onabort=jh(av),az.oncomplete=function(){av()}},ap._getLocal=function(ay,aw){var av=hQ(aa,[g5],"readonly");if(av.error){return aw(av.error)}var au=av.txn,ax=au.objectStore(g5).get(ay);ax.onerror=jh(aw),ax.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,aw(null,az)):aw(eo(iA))}},ap._putLocal=function(ay,aD,az){"function"==typeof aD&&(az=aD,aD={}),delete ay._revisions;var aB=ay._rev,aA=ay._id;aB?ay._rev="0-"+(parseInt(aB.split("-")[1],10)+1):ay._rev="0-1";var av,aw=aD.ctx;if(!aw){var aC=hQ(aa,[g5],"readwrite");if(aC.error){return az(aC.error)}aw=aC.txn,aw.onerror=jh(az),aw.oncomplete=function(){av&&az(null,av)}}var au,ax=aw.objectStore(g5);aB?(au=ax.get(aA),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aB){var aG=ax.put(ay);aG.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)}}else{az(eo(h8))}}):(au=ax.add(ay),au.onerror=function(aE){az(eo(h8)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)})},ap._removeLocal=function(av,aA,aw){"function"==typeof aA&&(aw=aA,aA={});var ay=aA.ctx;if(!ay){var ax=hQ(aa,[g5],"readwrite");if(ax.error){return aw(ax.error)}ay=ax.txn,ay.oncomplete=function(){aB&&aw(null,aB)}}var aB,au=av._id,az=ay.objectStore(g5),aC=az.get(au);aC.onerror=jh(aw),aC.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===av._rev?(az["delete"](au),aB={ok:!0,id:au,rev:"0-0"},aA.ctx&&aw(null,aB)):aw(eo(iA))}},ap._destroy=function(av,aw){ga.Changes.removeAllListeners(aj),ga.openReqList[aj]&&ga.openReqList[aj].result&&(ga.openReqList[aj].result.close(),delete fw[aj]);var au=indexedDB.deleteDatabase(aj);au.onsuccess=function(){ga.openReqList[aj]&&(ga.openReqList[aj]=null),a7()&&aj in localStorage&&delete localStorage[aj],aw(null,{ok:!0})},au.onerror=jh(aw)};var ad=fw[aj];if(ad){return aa=ad.idb,ap._meta=ad.global,void gk.nextTick(function(){ak(null,ap)})}var t;t=ab.storage?dt(aj,ab.storage):indexedDB.open(aj,fq),"openReqList" in ga||(ga.openReqList={}),ga.openReqList[aj]=t,t.onupgradeneeded=function(ax){function az(){var aA=av[au-1];au++,aA&&aA(ay,az)}var aw=ax.target.result;if(ax.oldVersion<1){return ah(aw)}var ay=ax.currentTarget.transaction;ax.oldVersion<3&&al(aw),ax.oldVersion<4&&ag(aw);var av=[af,ac,am,aq],au=ax.oldVersion;az()},t.onsuccess=function(ay){aa=ay.target.result,aa.onversionchange=function(){aa.close(),delete fw[aj]},aa.onabort=function(aA){console.error("Database has a global failure",aA.target.error),aa.close(),delete fw[aj]};var az=aa.transaction([fa,fS,m],"readwrite"),av=az.objectStore(fa).get(fa),aw=null,ax=null,au=null;av.onsuccess=function(aB){var aD=function(){null!==aw&&null!==ax&&null!==au&&(ap._meta={name:aj,instanceId:au,blobSupport:aw,docCount:ax},fw[aj]={idb:aa,global:ap._meta},ak(null,ap))},aA=aB.target.result||{id:fa};aj+"_id" in aA?(au=aA[aj+"_id"],aD()):(au=ce(),aA[aj+"_id"]=au,az.objectStore(fa).put(aA).onsuccess=function(){aD()}),ae||(ae=a3(az)),ae.then(function(aE){aw=aE,aD()});var aC=az.objectStore(m).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),ak(eo(ib,av))}}function dt(t,aa){try{return indexedDB.open(t,{version:fq,storage:aa})}catch(ab){return indexedDB.open(t,fq)}}var hW=e(7),gm="default" in hW?hW["default"]:hW,fZ=e(6);fZ="default" in fZ?fZ["default"]:fZ;var jk=e(12);jk="default" in jk?jk["default"]:jk;var iH=e(4),ai=e(1);ai="default" in ai?ai["default"]:ai;var iW=e(2);iW="default" in iW?iW["default"]:iW;var fj=e(10),iz="default" in fj?fj["default"]:fj,iS=e(8);iS="default" in iS?iS["default"]:iS;var gn=e(14);gn="default" in gn?gn["default"]:gn;var q=e(15);q="default" in q?q["default"]:q;var id=e(16);id="default" in id?id["default"]:id;var g6="function"==typeof Promise?Promise:iS,et=bn();fZ(hw,Error),hw.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hy=new hw({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),f=new hw({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),iA=new hw({status:404,error:"not_found",reason:"missing"}),h8=new hw({status:409,error:"conflict",reason:"Document update conflict"}),cn=new hw({status:400,error:"invalid_id",reason:"_id field must contain a string"}),a6=new hw({status:412,error:"missing_id",reason:"_id is required for puts"}),ey=new hw({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),fv=new hw({status:412,error:"precondition_failed",reason:"Database not open"}),gM=new hw({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),iE=new hw({status:500,error:"badarg",reason:"Some query argument is invalid"}),hL=new hw({status:400,error:"invalid_request",reason:"Request was invalid"}),iq=new hw({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),gl=new hw({status:500,error:"doc_validation",reason:"Bad special document member"}),co=new hw({status:400,error:"bad_request",reason:"Something wrong with the request"}),n=new hw({status:400,error:"bad_request",reason:"Document must be a JSON object"}),gS=new hw({status:404,error:"not_found",reason:"Database not found"}),ib=new hw({status:500,error:"indexed_db_went_bad",reason:"unknown"}),hT=new hw({status:500,error:"web_sql_went_bad",reason:"unknown"}),eq=new hw({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),iL=new hw({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),go=new hw({status:400,error:"bad_request",reason:"Invalid rev format"}),iw=new hw({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),h2=new hw({status:412,error:"missing_stub"}),f4=new hw({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),i4={UNAUTHORIZED:hy,MISSING_BULK_DOCS:f,MISSING_DOC:iA,REV_CONFLICT:h8,INVALID_ID:cn,MISSING_ID:a6,RESERVED_ID:ey,NOT_OPEN:fv,UNKNOWN_ERROR:gM,BAD_ARG:iE,INVALID_REQUEST:hL,QUERY_PARSE_ERROR:iq,DOC_VALIDATION:gl,BAD_REQUEST:co,NOT_AN_OBJECT:n,DB_MISSING:gS,WSQ_ERROR:hT,LDB_ERROR:eq,FORBIDDEN:iL,INVALID_REV:go,FILE_EXISTS:iw,MISSING_STUB:h2,IDB_ERROR:ib,INVALID_URL:f4},i1=function(ad,aa,ab){var t=Object.keys(i4).filter(function(af){var ag=i4[af];return"function"!=typeof ag&&ag[ad]===aa}),ac=ab&&t.filter(function(af){var ag=i4[af];return ag.message===ab})[0]||t[0];return ac?i4[ac]:null},ie=function(){},V=iW("pouchdb:api");fZ(A,iH.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(ad){var aa=this,ab=ad.complete;if(ad=ij(ad),"live" in ad&&!("continuous" in ad)&&(ad.continuous=ad.live),ad.processChange=hN,"latest"===ad.since&&(ad.since="now"),ad.since||(ad.since=0),"now"===ad.since){return void this.db.info().then(function(af){return aa.isCancelled?void ab(null,{status:"cancelled"}):(ad.since=af.update_seq,void aa.doChanges(ad))},ab)}if(ad.continuous&&"now"!==ad.since&&this.db.info().then(function(af){aa.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ad.filter&&"string"==typeof ad.filter&&("_view"===ad.filter?ad.view=F(ad.view):ad.filter=F(ad.filter),"http"!==this.db.type()&&!ad.doc_ids)){return this.filterChanges(ad)}"descending" in ad||(ad.descending=!1),ad.limit=0===ad.limit?1:ad.limit,ad.complete=ab;var t=this.db._changes(ad);if(t&&"function"==typeof t.cancel){var ac=aa.cancel;aa.cancel=ai(function(af){t.cancel(),ac.apply(this,af)})}},A.prototype.filterChanges=function(ad){var aa=this,ab=ad.complete;if("_view"===ad.filter){if(!ad.view||"string"!=typeof ad.view){var t=eo(co,"`view` filter parameter not found or invalid.");return ab(t)}var ac=h(ad.view);this.db.get("_design/"+ac[0],function(aj,ag){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(aj){return ab(ez(aj))}var ah=ag&&ag.views&&ag.views[ac[1]]&&ag.views[ac[1]].map;return ah?(ad.filter=jj(ah),void aa.doChanges(ad)):ab(eo(iA,ag.views?"missing json key: "+ac[1]:"missing json key: views"))})}else{var af=h(ad.filter);if(!af){return aa.doChanges(ad)}this.db.get("_design/"+af[0],function(ah,ag){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ah){return ab(ez(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(ad.filter=hM(aj),void aa.doChanges(ad)):ab(eo(iA,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var a5="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),g7=S(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hJ=S(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);fZ(g0,iH.EventEmitter),g0.prototype.post=gC("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(eo(n)):void this.bulkDocs({docs:[t]},aa,i0(ab))}),g0.prototype.put=gC("put",ai(function(ac){var t,ag,ad,ab,aa=ac.shift(),af="_id" in aa;if("object"!=typeof aa||Array.isArray(aa)){return(ab=ac.pop())(eo(n))}for(;;){if(t=ac.shift(),ag=typeof t,"string"!==ag||af?"string"!==ag||!af||"_rev" in aa?"object"===ag?ad=t:"function"===ag&&(ab=t):aa._rev=t:(aa._id=t,af=!0),!ac.length){break}}return ad=ad||{},C(aa._id),hA(aa._id)&&"function"==typeof this._putLocal?aa._deleted?this._removeLocal(aa,ab):this._putLocal(aa,ab):void this.bulkDocs({docs:[aa]},ad,i0(ab))})),g0.prototype.putAttachment=gC("putAttachment",function(af,ad,ac,ab,t,ah){function aa(aj){return aj._attachments=aj._attachments||{},aj._attachments[ad]={content_type:t,data:ab},ag.put(aj)}var ag=this;return"function"==typeof t&&(ah=t,t=ab,ab=ac,ac=null),"undefined"==typeof t&&(t=ab,ab=ac,ac=null),ag.get(af).then(function(aj){if(aj._rev!==ac){throw eo(h8)}return aa(aj)},function(aj){if(aj.reason===iA.message){return aa({_id:af})}throw aj})}),g0.prototype.removeAttachment=gC("removeAttachment",function(ad,aa,ab,t){var ac=this;ac.get(ad,function(af,ag){return af?void t(af):ag._rev!==ab?void t(eo(h8)):ag._attachments?(delete ag._attachments[aa],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ac.put(ag,t)):t()})}),g0.prototype.remove=gC("remove",function(ad,aa,ab,t){var ac;"string"==typeof aa?(ac={_id:ad,_rev:aa},"function"==typeof ab&&(t=ab,ab={})):(ac=ad,"function"==typeof aa?(t=aa,ab={}):(t=ab,ab=aa)),ab=ab||{},ab.was_delete=!0;var af={_id:ac._id,_rev:ac._rev||ab.rev};return af._deleted=!0,hA(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ac,t):void this.bulkDocs({docs:[af]},ab,i0(t))}),g0.prototype.revsDiff=gC("revsDiff",function(af,ad,ac){function ab(ak,aj){ag.has(ak)||ag.set(ak,{missing:[]}),ag.get(ak).missing.push(aj)}function t(aj,ak){var al=af[aj].slice(0);T(ak,function(ap,aq,av,am,aw){var au=aq+"-"+av,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==aw.status&&ab(aj,au))}),al.forEach(function(am){ab(aj,am)})}"function"==typeof ad&&(ac=ad,ad={});var ah=Object.keys(af);if(!ah.length){return ac(null,{})}var aa=0,ag=new jk.Map;ah.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ag.set(aj,{missing:af[aj]})}else{if(al){return ac(al)}t(aj,am)}if(++aa===ah.length){var ak={};return ag.forEach(function(ap,aq){ak[aq]=ap}),ac(null,ak)}})},this)}),g0.prototype.bulkGet=gC("bulkGet",function(aa,t){hs(this,aa,t)}),g0.prototype.compactDocument=gC("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ad,ag){if(ad){return ac(ad)}var aj=de(ag),af=[],ah=[];Object.keys(aj).forEach(function(ak){aj[ak]>ab&&af.push(ak)}),T(ag,function(ap,au,al,aq,am){var ak=au+"-"+al;"available"===am.status&&-1!==af.indexOf(ak)&&ah.push(ak)}),aa._doCompaction(t,ah,ac)})}),g0.prototype.compact=gC("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&fe(ab)}),g0.prototype._compact=function(ac,t){function ag(ah){af.push(ab.compactDocument(ah.id,0))}function ad(aj){var ah=aj.last_seq;g6.all(af).then(function(){return a9(ab,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){t(null,{ok:!0})})["catch"](t)}var ab=this,aa={return_docs:!1,last_seq:ac.last_seq||0},af=[];ab.changes(aa).on("change",ag).on("complete",ad).on("error",t)},g0.prototype.get=gC("get",function(af,ad,ac){function ab(){var ak=[],aj=t.length;return aj?void t.forEach(function(al){ah.get(af,{rev:al,revs:ad.revs,attachments:ad.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ac(null,ak)})}):ac(null,ak)}if("function"==typeof ad&&(ac=ad,ad={}),"string"!=typeof af){return ac(eo(cn))}if(hA(af)&&"function"==typeof this._getLocal){return this._getLocal(af,ac)}var t=[],ah=this;if(!ad.open_revs){return this._get(af,ad,function(az,ax){if(az){return ac(az)}var aq=ax.doc,aw=ax.metadata,ap=ax.ctx;if(ad.conflicts){var al=R(aw);al.length&&(aq._conflicts=al)}if(hE(aw,aq._rev)&&(aq._deleted=!0),ad.revs||ad.revs_info){var au=E(aw.rev_tree),aj=h7(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aq._rev.split("-")[1])}),am=aj.ids.map(function(aC){return aC.id}).indexOf(aq._rev.split("-")[1])+1,ay=aj.ids.length-am;if(aj.ids.splice(am,ay),aj.ids.reverse(),ad.revs&&(aq._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),ad.revs_info){var aB=aj.pos+aj.ids.length;aq._revs_info=aj.ids.map(function(aC){return aB--,{rev:aB+"-"+aC.id,status:aC.opts.status}})}}if(ad.attachments&&aq._attachments){var av=aq._attachments,aA=Object.keys(av).length;if(0===aA){return ac(null,aq)}Object.keys(av).forEach(function(aC){this._getAttachment(av[aC],{binary:ad.binary,ctx:ap},function(aE,aD){var aF=aq._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aA||ac(null,aq)})},ah)}else{if(aq._attachments){for(var ak in aq._attachments){aq._attachments.hasOwnProperty(ak)&&(aq._attachments[ak].stub=!0)}}ac(null,aq)}})}if("all"===ad.open_revs){this._getRevisionTree(af,function(ak,aj){return ak?ac(ak):(t=gG(aj).map(function(al){return al.rev}),void ab())})}else{if(!Array.isArray(ad.open_revs)){return ac(eo(gM,"function_clause"))}t=ad.open_revs;for(var aa=0;aa<t.length;aa++){var ag=t[aa];if("string"!=typeof ag||!/^\d+-/.test(ag)){return ac(eo(go))}}ab()}}),g0.prototype.getAttachment=gC("getAttachment",function(ad,aa,ab,t){var ac=this;ab instanceof Function&&(t=ab,ab={}),this._get(ad,ab,function(af,ag){return af?t(af):ag.doc._attachments&&ag.doc._attachments[aa]?(ab.ctx=ag.ctx,ab.binary=!0,ac._getAttachment(ag.doc._attachments[aa],ab,t),void 0):t(eo(iA))})}),g0.prototype.allDocs=gC("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(eo(iq,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return hc(this,t,aa)}}return this._allDocs(t,aa)}),g0.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new A(this,aa,t)},g0.prototype.close=gC("close",function(t){return this._closed=!0,this._close(t)}),g0.prototype.info=gC("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),g0.prototype.id=gC("id",function(t){return this._id(t)}),g0.prototype.bulkDocs=gC("bulkDocs",function(ad,aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa=aa||{},Array.isArray(ad)&&(ad={docs:ad}),!ad||!ad.docs||!Array.isArray(ad.docs)){return ab(eo(f))}for(var t=0;t<ad.docs.length;++t){if("object"!=typeof ad.docs[t]||Array.isArray(ad.docs[t])){return ab(eo(n))}}var ac;return ad.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ac=ac||ho(ag)})}),ac?ab(eo(co,ac)):("new_edits" in aa||("new_edits" in ad?aa.new_edits=ad.new_edits:aa.new_edits=!0),aa.new_edits||"http"===this.type()||ad.docs.sort(gD),im(ad.docs),this._bulkDocs(ad,aa,function(af,ag){return af?ab(af):(aa.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ab(null,ag))}))}),g0.prototype.registerDependentDatabase=gC("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);a9(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),g0.prototype.destroy=gC("destroy",function(ad,aa){function ab(){t._destroy(ad,function(ag,af){return ag?aa(ag):(t.emit("destroyed"),void aa(null,af||{ok:!0}))})}"function"==typeof ad&&(aa=ad,ad={});var t=this,ac="use_prefix" in t?t.use_prefix:!0;return"http"===t.type()?ab():void t.get("_local/_pouch_dependentDbs",function(ak,ag){if(ak){return 404!==ak.status?aa(ak):ab()}var aj=ag.dependentDbs,af=t.constructor,ah=Object.keys(aj).map(function(al){var am=ac?al.replace(new RegExp("^"+af.prefix),""):al;return new af(am,t.__opts).destroy()});g6.all(ah).then(ab,aa)})}),G.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},G.prototype.fail=function(t){this.failed=t,this.execute()},G.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},G.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},fZ(ig,g0),ig.debug=iW;var z;if(P()){z=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),z=!!localStorage.getItem("_pouch_check_localstorage")}catch(fy){z=!1}}ig.adapters={},ig.preferredAdapters=[],ig.prefix="_pouch_";var hR=new iH.EventEmitter;gA(ig),ig.parseAdapter=function(af,ad){var ac,ab,t=af.match(/([a-z\-]*):\/\/(.*)/);if(t){if(af=/http(s?)/.test(t[1])?t[1]+"://"+t[2]:t[2],ac=t[1],!ig.adapters[ac].valid()){throw"Invalid adapter"}return{name:af,adapter:t[1]}}var ah="idb" in ig.adapters&&"websql" in ig.adapters&&a7()&&localStorage["_pouch__websqldb_"+ig.prefix+af];if(ad.adapter){ab=ad.adapter}else{if("undefined"!=typeof ad&&ad.db){ab="leveldb"}else{for(var aa=0;aa<ig.preferredAdapters.length;++aa){if(ab=ig.preferredAdapters[aa],ab in ig.adapters){if(ah&&"idb"===ab){console.log('PouchDB is downgrading "'+af+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ac=ig.adapters[ab];var ag=ac&&"use_prefix" in ac?ac.use_prefix:!0;return{name:ag?ig.prefix+af:af,adapter:ab}},ig.adapter=function(t,aa,ab){aa.valid()&&(ig.adapters[t]=aa,ab&&ig.preferredAdapters.push(t))},ig.plugin=function(t){return Object.keys(t).forEach(function(aa){ig.prototype[aa]=t[aa]}),ig},ig.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=hW.extend({},aa,ad),void ig.call(this,ab,ad,ac)):new t(ab,ad,ac)}return fZ(t,ig),gA(t),t.preferredAdapters=ig.preferredAdapters.slice(),Object.keys(ig).forEach(function(ab){ab in t||(t[ab]=ig[ab])}),t};var gy=function(t){return atob(t)},jc=function(t){return btoa(t)},hg=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],er="queryKey",fX=/(?:^|&)([^&=]*)=?([^&]*)/g,iY=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fW=gm.extend,at={ajax:i6,parseUri:fm,uuid:ce,Promise:g6,atob:gy,btoa:jc,binaryStringToBlobOrBuffer:bo,clone:ij,extend:fW,createError:eo},iF=iz.collate,hp=1,je="pouchdb",iD=5,fh=0;B.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},B.prototype.updateTarget=function(aa,t){return gL(this.target,this.id,aa,t,this.returnValue)},B.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?g6.resolve(!0):gL(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return ab.readOnlySource=!0,!0}throw ac})};var f1={undefined:function(aa,t){return 0===iF(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return h3(t,aa).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return fh}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in f1?f1[ab](aa,ac):fh},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:fh}).then(function(){return fh},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):fh})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return fh})};var gW=0,gg=gb.setImmediate||gb.setTimeout,hk=32768,hO=v(function(ag,ad){function aj(){var aq=ac*ah,al=aq+ah;if(ac++,af>ac){t(ab,ag,aq,al),gg(aj)}else{t(ab,ag,aq,al);var ap=ab.end(!0),am=iZ(ap);ad(null,am),ab.destroy()}}var aa="string"==typeof ag,ak=aa?ag.length:ag.byteLength,ah=Math.min(hk,ak),af=Math.ceil(ak/ah),ac=0,ab=aa?new q:new q.ArrayBuffer,t=aa?gf:fb;aj()});fZ(f0,iH.EventEmitter),f0.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},f0.prototype.ready=function(ad,aa){function ab(){ac.cancel()}function t(){ad.removeListener("destroyed",ab),aa.removeListener("destroyed",ab)}var ac=this;ac._readyCalled||(ac._readyCalled=!0,ad.once("destroyed",ab),aa.once("destroyed",ab),ac.once("complete",t))};var fV={replicate:gY,toPouch:hz},ft=fV.replicate;fZ(a2,iH.EventEmitter),a2.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var hq=25,gE=50,io={},Y=1800,fn=iW("pouchdb:http");gv.valid=function(){return !0};var it=function(aa,t){return t&&aa.then(function(ab){gk.nextTick(function(){t(null,ab)})},function(ab){gk.nextTick(function(){t(ab)})}),aa},gc=function(t){return ai(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&it(ab,aa),ab})},hP=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},gQ=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},ja=function(ad){for(var aa={},ab=0,t=ad.length;t>ab;ab++){aa["$"+ad[ab]]=!0}var ac=Object.keys(aa),af=new Array(ac.length);for(ab=0,t=ac.length;t>ab;ab++){af[ab]=ac[ab].substring(1)}return af},h4={uniq:ja,sequentialize:gQ,fin:hP,callbackify:gc,promisedCallback:it};fl.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},fl.prototype.finish=function(){return this.promise};var i2,hZ=iz.collate,hh=iz.toIndexableString,g3=iz.normalizeKey,gr=iz.parseIndexableString;i2="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var gB=h4.callbackify,fc=h4.sequentialize,f2=h4.uniq,iu=h4.fin,gH=h4.promisedCallback,g2={},bt=new fl,ik=50,hn={_sum:function(aa,t){return gh(t)},_count:function(aa,t){return t.length},_stats:function(t,aa){function ab(ag){for(var ac=0,ad=0,ah=ag.length;ah>ad;ad++){var af=ag[ad];ac+=af*af}return ac}return{sum:gh(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},cr=gB(function(){var t=this;return"http"===t.type()?ge(t):"function"==typeof t._viewCleanup?g4(t):f5(t)}),u=function(ad,aa,ab){"function"==typeof aa&&(ab=aa,aa={}),aa=aa?gq(aa):{},"function"==typeof ad&&(ad={map:ad});var t=this,ac=g6.resolve().then(function(){return a4(t,ad,aa)});return gH(ac,ab),ac};fZ(il,Error),fZ(a0,Error),fZ(ev,Error);var gP={query:u,viewCleanup:cr},fk=7,fs=hF("document-store"),w=hF("by-sequence"),fr=hF("attach-store"),es=hF("local-store"),o=hF("metadata-store"),i7=hF("attach-seq-store"),ff={};fZ(jg,iH.EventEmitter),jg.prototype.addListener=function(ac,t,ag,ad){function ab(){function ah(){af=!1}if(aa._listeners[t]){if(af){return void (af="waiting")}af=!0;var aj=j(ad,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ad.since&&!ad.cancelled&&(ad.since=ak.seq,ad.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ab()},0),af=!1}).on("error",ah)}}if(!this._listeners[t]){var aa=this,af=!1;this._listeners[t]=ab,this.on(ac,ab)}},jg.prototype.removeListener=function(aa,t){t in this._listeners&&iH.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},jg.prototype.notifyLocalWindows=function(t){P()?chrome.storage.local.set({dbName:t}):a7()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},jg.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var f8=1,gN="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+w+" (seq, deleted)",an="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+w+" (doc_id, rev)",k="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+fs+" (winningseq)",Z="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+i7+" (seq)",fu="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+i7+" (digest, seq)",hf=w+".seq = "+fs+".winningseq",gX=w+".seq AS seq, "+w+".deleted AS deleted, "+w+".json AS data, "+w+".rev AS rev, "+fs+".json AS metadata";hB.valid=h6,hB.Changes=new jg;var ae,fq=5,m="document-store",X="by-sequence",eu="attach-store",fT="attach-seq-store",fa="meta-store",g5="local-store",fS="detect-blob-support",fU={running:!1,queue:[]},fw={};ga.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},ga.Changes=new jg;var en={idb:ga,websql:hB};ig.ajax=i6,ig.utils=at,ig.Errors=i4,ig.replicate=fV.replicate,ig.sync=gj,ig.version="5.2.0",ig.adapter("http",gv),ig.adapter("https",gv),ig.plugin(gP),Object.keys(en).forEach(function(t){ig.adapter(t,en[t],!0)}),a.exports=ig}).call(this,e(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});