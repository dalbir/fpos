!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(l,e){if(!c[l]){if(!h[l]){var m="function"==typeof require&&require;if(!e&&m){return m(l,!0)}if(d){return d(l,!0)}var k=new Error("Cannot find module '"+l+"'");throw k.code="MODULE_NOT_FOUND",k}var i=c[l]={exports:{}};h[l][0].call(i.exports,function(n){var o=h[l][1][n];return g(o?o:n)},i,i.exports,a,h,c,f)}return c[l].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],2:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var o="color: "+this.color;n=[n[0],o,"color: inherit"].concat(Array.prototype.slice.call(n,1));var p=0,i=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),n.splice(i,0,o),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(3),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{3:3}],3:[function(j,p,d){function v(){return d.colors[h++%d.colors.length]}function c(n){function f(){}function i(){var o=i,s=+new Date,r=s-(k||s);o.diff=r,o.prev=k,o.curr=s,k=s,null==o.useColors&&(o.useColors=d.useColors()),null==o.color&&o.useColors&&(o.color=v());var u=Array.prototype.slice.call(arguments);u[0]=d.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=d.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof d.formatArgs&&(u=d.formatArgs.apply(o,u));var x=i.log||d.log||console.log.bind(console);x.apply(o,u)}f.enabled=!1,i.enabled=!0;var e=d.enabled(n)?i:f;return e.namespace=n,e}function g(i){d.save(i);for(var n=(i||"").split(/[\s,]+/),f=n.length,e=0;f>e;e++){n[e]&&(i=n[e].replace(/\*/g,".*?"),"-"===i[0]?d.skips.push(new RegExp("^"+i.substr(1)+"$")):d.names.push(new RegExp("^"+i+"$")))}}function l(){d.enable("")}function q(i){var e,f;for(e=0,f=d.skips.length;f>e;e++){if(d.skips[e].test(i)){return !1}}for(e=0,f=d.names.length;f>e;e++){if(d.names[e].test(i)){return !0}}return !1}function m(e){return e instanceof Error?e.stack||e.message:e}d=p.exports=c,d.coerce=m,d.disable=l,d.enable=g,d.enabled=q,d.humanize=j(9),d.names=[],d.skips=[],d.formatters={};var k,h=0},{9:9}],4:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,m,q,e,n,o;if(this._events||(this._events={}),"error"===p&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(m=this._events[p],g(m)){return !1}if(k(m)){switch(arguments.length){case 1:m.call(this);break;case 2:m.call(this,arguments[1]);break;case 3:m.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1),m.apply(this,e)}}else{if(c(m)){for(e=Array.prototype.slice.call(arguments,1),o=m.slice(),q=o.length,n=0;q>n;n++){o[n].apply(this,e)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(n,i){function e(){this.removeListener(n,e),m||(m=!0,i.apply(this,arguments))}if(!k(i)){throw TypeError("listener must be a function")}var m=!1;return e.listener=i,this.on(n,e),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(c(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],5:[function(d,c,f){(function(p){function h(){m=!0;for(var l,i,n=j.length;n;){for(i=j,j=[],l=-1;++l<n;){i[l]()}n=j.length}m=!1}function w(i){1!==j.push(i)||m||e()}var e,k=p.MutationObserver||p.WebKitMutationObserver;if(k){var q=0,v=new k(h),t=p.document.createTextNode("");v.observe(t,{characterData:!0}),e=function(){t.data=q=++q%2}}else{if(p.setImmediate||"undefined"==typeof p.MessageChannel){e="document" in p&&"onreadystatechange" in p.document.createElement("script")?function(){var i=p.document.createElement("script");i.onreadystatechange=function(){h(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},p.document.documentElement.appendChild(i)}:function(){setTimeout(h,0)}}else{var g=new p.MessageChannel;g.port1.onmessage=h,e=function(){g.port2.postMessage(0)}}}var m,j=[];c.exports=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],7:[function(d,c,f){(function(e){e("object"==typeof f?f:this)}).call(this,function(h){var e=Array.prototype.slice,i=Array.prototype.forEach,g=function(j){if("object"!=typeof j){throw j+" is not an object"}var k=e.call(arguments,1);return i.call(k,function(m){if(m){for(var l in m){"object"==typeof m[l]&&j[l]?g.call(j,j[l],m[l]):j[l]=m[l]}}}),j};h.extend=g})},{}],8:[function(w,k,B){function G(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=I,this.queue=[],this.outcome=void 0,e!==G&&g(this,e)}function C(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function J(f,e,h){x(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function F(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(l,h){function f(o){e||(e=!0,d.reject(l,o))}function i(o){e||(e=!0,d.resolve(l,o))}function m(){h(i,f)}var e=!1,n=q(m);"error"===n.status&&f(n.value)}function q(h,e){var i={};try{i.value=h(e),i.status="success"}catch(f){i.status="error",i.value=f}return i}function D(e){return e instanceof this?e:d.resolve(new this(G),e)}function A(f){var e=new this(G);return d.reject(e,f)}function H(h){function n(r,s){function t(u){m[s]=u,++i!==o||e||(e=!0,d.resolve(l,m))}p.resolve(r).then(t,function(u){e||(e=!0,d.reject(l,u))})}var p=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var o=h.length,e=!1;if(!o){return this.resolve([])}for(var m=new Array(o),i=0,f=-1,l=new this(G);++f<o;){n(h[f],f)}return l}function E(l){function h(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(i,p))},function(p){e||(e=!0,d.reject(i,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var m=l.length,e=!1;if(!m){return this.resolve([])}for(var n=-1,i=new this(G);++n<m;){h(l[n])}return i}var x=w(5),d={},c=["REJECTED"],z=["FULFILLED"],I=["PENDING"];k.exports=B=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(f,e){if("function"!=typeof f&&this.state===z||"function"!=typeof e&&this.state===c){return this}var i=new this.constructor(G);if(this.state!==I){var h=this.state===z?f:e;J(i,h,this.outcome)}else{this.queue.push(new C(i,f,e))}return i},C.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},C.prototype.otherCallFulfilled=function(e){J(this.promise,this.onFulfilled,e)},C.prototype.callRejected=function(e){d.reject(this.promise,e)},C.prototype.otherCallRejected=function(e){J(this.promise,this.onRejected,e)},d.resolve=function(i,f){var m=q(F,f);if("error"===m.status){return d.reject(i,m.value)}var h=m.value;if(h){g(i,h)}else{i.state=z,i.outcome=f;for(var l=-1,e=i.queue.length;++l<e;){i.queue[l].callFulfilled(f)}}return i},d.reject=function(h,e){h.state=c,h.outcome=e;for(var i=-1,f=h.queue.length;++i<f;){h.queue[i].callRejected(e)}return h},B.resolve=D,B.reject=A,B.all=H,B.race=E},{5:5}],9:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],10:[function(c,v,d){function y(n){if(null!==n){switch(typeof n){case"boolean":return n?1:0;case"number":return k(n);case"string":return n.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var o=Array.isArray(n),l=o?n:Object.keys(n),f=-1,e=l.length,i="";if(o){for(;++f<e;){i+=d.toIndexableString(l[f])}}else{for(;++f<e;){var h=l[f];i+=d.toIndexableString(h)+d.toIndexableString(n[h])}}return i}}return""}function m(e,l){var r,o=l,p="1"===e[l];if(p){r=0,l++}else{var s="0"===e[l];l++;var h="",n=e.substring(l,l+q),i=parseInt(n,10)+B;for(s&&(i=-i),l+=q;;){var f=e[l];if("\x00"===f){break}h+=f,l++}h=h.split("."),r=1===h.length?parseInt(h,10):parseFloat(h[0]+"."+h[1]),s&&(r-=10),0!==i&&(r=parseFloat(r+"e"+i))}return{num:r,length:l-o}}function j(l,f){var o=l.pop();if(f.length){var i=f[f.length-1];o===i.element&&(f.pop(),i=f[f.length-1]);var e=i.element,n=i.index;if(Array.isArray(e)){e.push(o)}else{if(n===l.length-2){var h=l.pop();e[h]=o}else{l.push(o)}}}}function C(f,l){for(var e=Math.min(f.length,l.length),h=0;e>h;h++){var i=d.collate(f[h],l[h]);if(0!==i){return i}}return f.length===l.length?0:f.length>l.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(n,o){for(var l=Object.keys(n),f=Object.keys(o),e=Math.min(l.length,f.length),i=0;e>i;i++){var h=d.collate(l[i],f[i]);if(0!==h){return h}if(h=d.collate(n[l[i]],o[f[i]]),0!==h){return h}}return l.length===f.length?0:l.length>f.length?1:-1}function g(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function k(l){if(0===l){return"1"}var p=l.toExponential().split(/e\+?/),h=parseInt(p[1],10),e=0>l,f=e?"0":"2",i=(e?-h:h)-B,n=z.padLeft(i.toString(),"0",q);f+=w+n;var r=Math.abs(parseFloat(p[0]));e&&(r=10-r);var o=r.toFixed(20);return o=o.replace(/\.?0+$/,""),f+=w+o}var B=-324,q=3,w="",z=c(11);d.collate=function(h,e){if(h===e){return 0}h=d.normalizeKey(h),e=d.normalizeKey(e);var f=g(h),i=g(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},d.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=d.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=d.normalizeKey(e))}}}}}return l},d.toIndexableString=function(f){var e="\x00";return f=d.normalizeKey(f),g(f)+w+y(f)+e},d.parseIndexableString=function(e){for(var l=[],p=[],o=0;;){var h=e[o++];if("\x00"!==h){switch(h){case"1":l.push(null);break;case"2":l.push("1"===e[o]),o++;break;case"3":var n=m(e,o);l.push(n.num),o+=n.length;break;case"4":for(var i="";;){var f=e[o];if("\x00"===f){break}i+=f,o++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),l.push(i);break;case"5":var s={element:[],index:l.length};l.push(s.element),p.push(s);break;case"6":var r={element:{},index:l.length};l.push(r.element),p.push(r);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+h)}}else{if(1===l.length){return l.pop()}j(l,p)}}}},{11:11}],11:[function(f,c,g){function d(k,i,h){for(var j="",e=h-k.length;j.length<e;){j+=i}return j}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var m,l=j.length,h=p.length;for(m=0;l>m;m++){if(m===h){return 1}var e=j.charAt(m),k=p.charAt(m);if(e!==k){return k>e?-1:1}}return h>l?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],12:[function(d,h,g){function c(){this.store={}}function f(i){if(this.store=new c,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}g.Map=c,g.Set=f,c.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},c.prototype.unmangle=function(e){return e.substring(1)},c.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},c.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},c.prototype.has=function(i){var e=this.mangle(i);return e in this.store},c.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},c.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},f.prototype.add=function(e){return this.store.set(e,!0)},f.prototype.has=function(e){return this.store.has(e)},f.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],13:[function(p,x,h){function d(){m=!1,c.length?q=c.concat(q):j=-1,q.length&&g()}function g(){if(!m){var f=setTimeout(d);m=!0;for(var e=q.length;e;){for(c=q,q=[];++j<e;){c&&c[j].run()}j=-1,e=q.length}c=null,m=!1,clearTimeout(f)}}function k(f,e){this.fun=f,this.array=e}function v(){}var c,w=x.exports={},q=[],m=!1,j=-1;w.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i]}}q.push(new k(f,e)),1!==q.length||m||setTimeout(g,0)},k.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=v,w.addListener=v,w.once=v,w.off=v,w.removeListener=v,w.removeAllListeners=v,w.emit=v,w.binding=function(e){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(e){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],14:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(m,l){var k,j,i,h;j=[],h=[];for(k in l){e.call(l,k)&&(i=l[k],"this"!==k&&(j.push(k),h.push(i)))}return Function.apply(null,g.call(j).concat([m])).apply(l["this"],h)}}).call(this)},{}],15:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(I){function w(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function A(m,i,l,n,h,o,g){return w(i&l|~i&n,m,i,h,o,g)}function J(m,i,l,n,h,o,g){return w(i&n|l&~n,m,i,h,o,g)}function x(m,i,l,n,h,o,g){return w(i^l^n,m,i,h,o,g)}function D(m,i,l,n,h,o,g){return w(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=A(n,i,g,m,h[0],7,-680876936),m=A(m,n,i,g,h[1],12,-389564586),g=A(g,m,n,i,h[2],17,606105819),i=A(i,g,m,n,h[3],22,-1044525330),n=A(n,i,g,m,h[4],7,-176418897),m=A(m,n,i,g,h[5],12,1200080426),g=A(g,m,n,i,h[6],17,-1473231341),i=A(i,g,m,n,h[7],22,-45705983),n=A(n,i,g,m,h[8],7,1770035416),m=A(m,n,i,g,h[9],12,-1958414417),g=A(g,m,n,i,h[10],17,-42063),i=A(i,g,m,n,h[11],22,-1990404162),n=A(n,i,g,m,h[12],7,1804603682),m=A(m,n,i,g,h[13],12,-40341101),g=A(g,m,n,i,h[14],17,-1502002290),i=A(i,g,m,n,h[15],22,1236535329),n=J(n,i,g,m,h[1],5,-165796510),m=J(m,n,i,g,h[6],9,-1069501632),g=J(g,m,n,i,h[11],14,643717713),i=J(i,g,m,n,h[0],20,-373897302),n=J(n,i,g,m,h[5],5,-701558691),m=J(m,n,i,g,h[10],9,38016083),g=J(g,m,n,i,h[15],14,-660478335),i=J(i,g,m,n,h[4],20,-405537848),n=J(n,i,g,m,h[9],5,568446438),m=J(m,n,i,g,h[14],9,-1019803690),g=J(g,m,n,i,h[3],14,-187363961),i=J(i,g,m,n,h[8],20,1163531501),n=J(n,i,g,m,h[13],5,-1444681467),m=J(m,n,i,g,h[2],9,-51403784),g=J(g,m,n,i,h[7],14,1735328473),i=J(i,g,m,n,h[12],20,-1926607734),n=x(n,i,g,m,h[5],4,-378558),m=x(m,n,i,g,h[8],11,-2022574463),g=x(g,m,n,i,h[11],16,1839030562),i=x(i,g,m,n,h[14],23,-35309556),n=x(n,i,g,m,h[1],4,-1530992060),m=x(m,n,i,g,h[4],11,1272893353),g=x(g,m,n,i,h[7],16,-155497632),i=x(i,g,m,n,h[10],23,-1094730640),n=x(n,i,g,m,h[13],4,681279174),m=x(m,n,i,g,h[0],11,-358537222),g=x(g,m,n,i,h[3],16,-722521979),i=x(i,g,m,n,h[6],23,76029189),n=x(n,i,g,m,h[9],4,-640364487),m=x(m,n,i,g,h[12],11,-421815835),g=x(g,m,n,i,h[15],16,530742520),i=x(i,g,m,n,h[2],23,-995338651),n=D(n,i,g,m,h[0],6,-198630844),m=D(m,n,i,g,h[7],10,1126891415),g=D(g,m,n,i,h[14],15,-1416354905),i=D(i,g,m,n,h[5],21,-57434055),n=D(n,i,g,m,h[12],6,1700485571),m=D(m,n,i,g,h[3],10,-1894986606),g=D(g,m,n,i,h[10],15,-1051523),i=D(i,g,m,n,h[1],21,-2054922799),n=D(n,i,g,m,h[8],6,1873313359),m=D(m,n,i,g,h[15],10,-30611744),g=D(g,m,n,i,h[6],15,-1560198380),i=D(i,g,m,n,h[13],21,1309151649),n=D(n,i,g,m,h[4],6,-145523070),m=D(m,n,i,g,h[11],10,-1120210379),g=D(g,m,n,i,h[2],15,718787259),i=D(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function H(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function B(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function G(g){var m,o,l,n,p,i,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;h>=m;m+=64){M(r,H(g.substring(m-64,m)))}for(g=g.substring(m-64),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;o>m;m+=1){l[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(l[m>>2]|=128<<(m%4<<3),m>55){for(M(r,l),m=0;16>m;m+=1){l[m]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),i=parseInt(n[1],16)||0,l[14]=p,l[15]=i,M(r,l),r}function q(g){var i,o,l,n,p,m,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;h>=i;i+=64){M(r,B(g.subarray(i-64,i)))}for(g=h>i-64?g.subarray(i-64):new Uint8Array(0),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;o>i;i+=1){l[i>>2]|=g[i]<<(i%4<<3)}if(l[i>>2]|=128<<(i%4<<3),i>55){for(M(r,l),i=0;16>i;i+=1){l[i]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=p,l[15]=m,M(r,l),r}function E(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function z(h){var g;for(g=0;g<h.length;g+=1){h[g]=E(h[g])}return h.join("")}function F(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function C(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==z(G("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(i,o){var s,h,r,n,l=this.byteLength,m=g(i,l),p=l;return o!==I&&(p=g(o,l)),m>p?new ArrayBuffer(0):(s=p-m,h=new ArrayBuffer(s),r=new Uint8Array(h),n=new Uint8Array(this,m,s),r.set(n),h)}}(),C.prototype.append=function(g){return this.appendBinary(F(g)),this},C.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,H(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},C.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},C.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},C.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},C.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},C.hash=function(h,g){return C.hashBinary(F(h),g)},C.hashBinary=function(i,g){var l=G(i),h=z(l);return g?N(h):h},C.ArrayBuffer=function(){this.reset()},C.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,B(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},C.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.ArrayBuffer.prototype.getState=function(){var g=C.prototype.getState.call(this);return g.buff=j(g.buff),g},C.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),C.prototype.setState.call(this,g)},C.ArrayBuffer.prototype.destroy=C.prototype.destroy,C.ArrayBuffer.prototype._finish=C.prototype._finish,C.ArrayBuffer.hash=function(i,g){var l=q(new Uint8Array(i)),h=z(l);return g?N(h):h},C})},{}],16:[function(f,c,g){function d(j,p,m){var l=m[m.length-1];j===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,e=l.index;if(Array.isArray(h)){h.push(j)}else{if(e===p.length-2){var k=p.pop();h[k]=j}else{p.push(j)}}}g.stringify=function(p){var h=[];h.push({obj:p});for(var w,B,v,m,A,q,z,y,x,k,e,j="";w=h.pop();){if(B=w.obj,v=w.prefix||"",m=w.val||"",j+=v,m){j+=m}else{if("object"!=typeof B){j+="undefined"==typeof B?null:JSON.stringify(B)}else{if(null===B){j+="null"}else{if(Array.isArray(B)){for(h.push({val:"]"}),A=B.length-1;A>=0;A--){q=0===A?"":",",h.push({obj:B[A],prefix:q})}h.push({val:"["})}else{z=[];for(y in B){B.hasOwnProperty(y)&&z.push(y)}for(h.push({val:"}"}),A=z.length-1;A>=0;A--){x=z[A],k=B[x],e=A>0?",":"",e+=JSON.stringify(x)+":",h.push({obj:k,prefix:e})}h.push({val:"{"})}}}}}return j},g.parse=function(x){for(var w,m,y,q,v,h,e,p,k,z=[],r=[],j=0;;){if(w=x[j++],"}"!==w&&"]"!==w&&"undefined"!=typeof w){switch(w){case" ":case"	":case"\n":case":":case",":break;case"n":j+=3,d(null,z,r);break;case"t":j+=3,d(!0,z,r);break;case"f":j+=4,d(!1,z,r);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(m="",j--;;){if(y=x[j++],!/[\d\.\-e\+]/.test(y)){j--;break}m+=y}d(parseFloat(m),z,r);break;case'"':for(q="",v=void 0,h=0;;){if(e=x[j++],'"'===e&&("\\"!==v||h%2!==1)){break}q+=e,v=e,"\\"===v?h++:h=0}d(JSON.parse('"'+q+'"'),z,r);break;case"[":p={element:[],index:z.length},z.push(p.element),r.push(p);break;case"{":k={element:{},index:z.length},z.push(k.element),r.push(k);break;default:throw new Error("unexpectedly reached end of input: "+w)}}else{if(1===z.length){return z.pop()}d(z.pop(),z,r)}}}},{}],17:[function(d,c,f){(function(dF,dY){function aX(l,j){l=l||[],j=j||{};try{return new Blob(l,j)}catch(i){if("TypeError"!==i.name){throw i}for(var k="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,h=new k,g=0;g<l.length;g+=1){h.append(l[g])}return h.getBlob(j.type)}}function dK(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function bl(){for(var i={},g=new cF(function(k,l){i.resolve=k,i.reject=l}),j=new Array(arguments.length),h=0;h<j.length;h++){j[h]=arguments[h]}return i.promise=g,cF.resolve().then(function(){return fetch.apply(null,j)}).then(function(k){i.resolve(k)})["catch"](function(k){i.reject(k)}),i}function dj(m,h){var j,l,i,k=new Headers,g={method:m.method,credentials:"include",headers:k};return m.json&&(k.set("Accept","application/json"),k.set("Content-Type",m.headers["Content-Type"]||"application/json")),m.body&&m.body instanceof Blob?dK(m.body,function(n){g.body=n}):m.body&&m.processData&&"string"!=typeof m.body?g.body=JSON.stringify(m.body):"body" in m?g.body=m.body:g.body=null,Object.keys(m.headers).forEach(function(n){m.headers.hasOwnProperty(n)&&k.set(n,m.headers[n])}),j=bl(m.url,g),m.timeout>0&&(l=setTimeout(function(){j.reject(new Error("Load timeout for resource: "+m.url))},m.timeout)),j.promise.then(function(n){return i={statusCode:n.status},m.timeout>0&&clearTimeout(l),i.statusCode>=200&&i.statusCode<300?m.binary?n.blob():n.text():n.json()}).then(function(n){i.statusCode>=200&&i.statusCode<300?h(null,i,n):h(n,i)})["catch"](function(n){h(n,i)}),{abort:j.reject}}function cB(i,k){var j,m,g=function(){j.abort()};j=i.xhr?new i.xhr:new XMLHttpRequest;try{j.open(i.method,i.url)}catch(l){k(l,{statusCode:413})}j.withCredentials="withCredentials" in i?i.withCredentials:!0,"GET"===i.method?delete i.headers["Content-Type"]:i.json&&(i.headers.Accept="application/json",i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.body&&i.processData&&"string"!=typeof i.body&&(i.body=JSON.stringify(i.body))),i.binary&&(j.responseType="arraybuffer"),"body" in i||(i.body=null);for(var h in i.headers){i.headers.hasOwnProperty(h)&&j.setRequestHeader(h,i.headers[h])}return i.timeout>0&&(m=setTimeout(g,i.timeout),j.onprogress=function(){clearTimeout(m),m=setTimeout(g,i.timeout)},"undefined"!=typeof j.upload&&(j.upload.onprogress=j.onprogress)),j.onreadystatechange=function(){if(4===j.readyState){var q={statusCode:j.status};if(j.status>=200&&j.status<300){var o;o=i.binary?aX([j.response||""],{type:j.getResponseHeader("Content-Type")}):j.responseText,k(null,q,o)}else{var n={};try{n=JSON.parse(j.response)}catch(p){}k(n,q)}}},i.body&&i.body instanceof Blob?dK(i.body,function(n){j.send(n)}):j.send(i.body),{abort:g}}function jo(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function dy(h,g){return dB||h.xhr?cB(h,g):dj(h,g)}function b6(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function e8(i,g,j){function h(k){for(var l in i){"function"!=typeof i[l]&&(this[l]=i[l])}void 0!==j&&(this.name=j),void 0!==k&&(this.reason=k)}return h.prototype=b6.prototype,new h(g)}function bw(l){var j,i,k,h,g;return i=l.error===!0&&"string"==typeof l.name?l.name:l.error,g=l.reason,k=c1("name",i,g),l.missing||"missing"===g||"deleted"===g||"not_found"===i?k=cQ:"doc_validation"===i?(k=cw,h=g):"bad_request"===i&&k.message!==g&&(k=jm),k||(k=c1("status",l.status,g)||cm),j=e8(k,g,i),h&&(j.message=h),l.id&&(j.id=l.id),l.status&&(j.status=l.status),l.missing&&(j.missing=l.missing),j}function fB(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function bs(i){if("function"==typeof i.slice){return i.slice(0)}var g=new ArrayBuffer(i.byteLength),j=new Uint8Array(g),h=new Uint8Array(i);return j.set(h),g}function c6(h){if(h instanceof ArrayBuffer){return bs(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function e6(k){var i,h,j;if(!k||"object"!=typeof k){return k}if(Array.isArray(k)){for(i=[],h=0,j=k.length;j>h;h++){i[h]=e6(k[h])}return i}if(k instanceof Date){return k.toISOString()}if(fB(k)){return c6(k)}i={};for(h in k){if(Object.prototype.hasOwnProperty.call(k,h)){var g=e6(k[h]);"undefined"!=typeof g&&(i[h]=g)}}return i}function bV(){return""}function ch(k,i){function h(l,o,m){if(!k.binary&&k.json&&"string"==typeof l){try{l=JSON.parse(l)}catch(n){return m(n)}}Array.isArray(l)&&(l=l.map(function(p){return p.error||p.missing?bw(p):p})),k.binary&&ac(l,o),m(null,l,o)}function j(o,m){var q,n;if(o.code&&o.status){var p=new Error(o.message||o.code);return p.status=o.status,m(p)}try{q=JSON.parse(o.responseText),n=bw(q)}catch(l){n=bw(o)}m(n)}k=e6(k);var g={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return k=dd.extend(g,k),k.json&&(k.binary||(k.headers.Accept="application/json"),k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json"),k.binary&&(k.encoding=null,k.json=!1),k.processData||(k.json=!1),dy(k,function(o,l,q){if(o){return o.status=l?l.statusCode:400,j(o,i)}var m,r=l.headers&&l.headers["content-type"],p=q||bV();if(!k.binary&&(k.json||!k.processData)&&"object"!=typeof p&&(/json/.test(r)||/^[\s]*\{/.test(p)&&/\}[\s]*$/.test(p))){try{p=JSON.parse(p.toString())}catch(n){}}l.statusCode>=200&&l.statusCode<300?h(p,l,i):(m=bw(p),m.status=l.statusCode,i(m))})}function cj(g,h){var m=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i=-1!==m.indexOf("safari")&&-1===m.indexOf("chrome"),k=-1!==m.indexOf("msie"),l=i&&"POST"===g.method||k&&"GET"===g.method,j="cache" in g?g.cache:!0;if(l||!j){var n=-1!==g.url.indexOf("?");g.url+=(n?"&":"?")+"_nonce="+Date.now()}return ch(g,h)}function jC(h){var g=!1;return jv(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function jx(g){return jv(function(j){j=e6(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){dF.nextTick(function(){i(n,m)})});var h=new cF(function(o,n){var q;try{var p=jC(function(r,s){r?n(r):o(s)});j.push(p),q=g.apply(l,j),q&&"function"==typeof q.then&&o(q)}catch(m){n(m)}});return k&&h.then(function(m){k(null,m)},k),h})}function b0(h,g){function i(m,k,o){if(jE.enabled){for(var l=[m._db_name,k],n=0;n<o.length-1;n++){l.push(o[n])}jE.apply(null,l);var j=o[o.length-1];o[o.length-1]=function(r,p){var q=[m._db_name,k];q=q.concat(r?["error",r]:["success",p]),jE.apply(null,q),j(r,p)}}}return jx(jv(function(j){if(this._closed){return cF.reject(new Error("database is closed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new cF(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function jB(l,j){for(var i={},k=0,h=j.length;h>k;k++){var g=j[k];g in l&&(i[g]=l[g])}return i}function eU(h,g,i){return new cF(function(j,k){h.get(g,function(n,l){if(n){if(404!==n.status){return k(n)}l={}}var o=l._rev,m=i(l);return m?(m._id=g,m._rev=o,void j(jK(h,m,i))):j({updated:!1,rev:o})})})}function jK(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return eU(h,g._id,i)})}function ef(r){for(var j,m,k,l,o=r.rev_tree.slice();l=o.pop();){var h=l.ids,p=h[2],i=l.pos;if(p.length){for(var g=0,q=p.length;q>g;g++){o.push({pos:i+1,ids:p[g]})}}else{var n=!!h[1].deleted,s=h[0];(!j||(k!==n?k:m!==i?i>m:s>j))&&(j=s,m=i,k=n)}}return m+"-"+j}function aL(g){return g.ids}function ba(k,i){i||(i=ef(k));for(var h,j=i.substring(i.indexOf("-")+1),g=k.rev_tree.map(aL);h=g.pop();){if(h[0]===j){return !!h[1].deleted}g=g.concat(h[2])}}function aR(g){return b1("return "+g+";",{})}function bH(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jD(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function jR(h){var g=jD(h);return g?g.join("/"):null}function jG(i,k){for(var g,m=i.slice();g=m.pop();){for(var o=g.pos,h=g.ids,j=h[2],l=k(0===j.length,o,h[0],g.ctx,h[1]),p=0,n=j.length;n>p;p++){m.push({pos:o+1,ids:j[p],ctx:l})}}}function dA(h,g){return h.pos-g.pos}function cc(i){var g=[];jG(i,function(o,l,n,k,m){o&&g.push({rev:l+"-"+n,pos:l,opts:m})}),g.sort(dA).reverse();for(var j=0,h=g.length;h>j;j++){delete g[j].pos}return g}function jH(i){for(var l=ef(i),g=cc(i.rev_tree),m=[],j=0,k=g.length;k>j;j++){var h=g[j];h.rev===l||h.opts.deleted||m.push(h.rev)}return m}function jW(i,l,g){function m(){j.cancel()}fJ.EventEmitter.call(this);var j=this;this.db=i,l=l?e6(l):{};var k=l.complete=jC(function(o,n){o?j.emit("error",o):j.emit("complete",n),j.removeAllListeners(),i.removeListener("destroyed",m)});g&&(j.on("complete",function(n){g(null,n)}),j.on("error",g)),i.once("destroyed",m),l.onChange=function(n){l.isCancelled||(j.emit("change",n),j.startSeq&&j.startSeq<=n.seq&&(j.startSeq=!1))};var h=new cF(function(o,n){l.complete=function(p,q){p?n(p):o(q)}});j.once("cancel",function(){i.removeListener("destroyed",m),l.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){k(null,n)},k),i.taskqueue.isReady?j.doChanges(l):i.taskqueue.addTask(function(){j.isCancelled?j.emit("cancel"):j.doChanges(l)})}function bj(k,i,h){var j=[{rev:k._rev}];"all_docs"===h.style&&(j=cc(i.rev_tree).map(function(l){return{rev:l.rev}}));var g={id:i.id,changes:j,doc:k};return ba(i,k._rev)&&(g.deleted=!0),h.conflicts&&(g.doc._conflicts=jH(i),g.doc._conflicts.length||delete g.doc._conflicts),g}function dS(g,k,p){function m(){var r=[];q.forEach(function(s){s.docs.forEach(function(u){r.push({id:s.id,docs:[u]})})}),p(null,{results:r})}function l(){++i===o&&m()}function n(r,u,s){q[r]={id:u,docs:s},l()}var h=Array.isArray(k)?k:k.docs,j={};h.forEach(function(r){r.id in j?j[r.id].push(r):j[r.id]=[r]});var o=Object.keys(j).length,i=0,q=new Array(o);Object.keys(j).forEach(function(r,s){var u=j[r],w=jB(u[0],["atts_since","attachments"]);w.open_revs=u.map(function(x){return x.rev}),w.open_revs=w.open_revs.filter(function(x){return x});var v=function(x){return x};0===w.open_revs.length&&(delete w.open_revs,v=function(x){return[{ok:x}]}),["revs","attachments","binary"].forEach(function(x){x in k&&(w[x]=k[x])}),g.get(r,w,function(x,y){n(s,r,x?[{error:x}]:v(y))})})}function aU(g){return/^_local/.test(g)}function jS(r){for(var j,m=[],k=r.slice();j=k.pop();){var l=j.pos,o=j.ids,h=o[0],p=o[1],i=o[2],g=0===i.length,q=j.history?j.history.slice():[];q.push({id:h,opts:p}),g&&m.push({pos:l+1-q.length,ids:q});for(var n=0,s=i.length;s>n;n++){k.push({pos:l+1,ids:i[n],history:q})}}return m.reverse()}function eJ(g){return 0|Math.random()*g}function jn(i,g){g=g||cz.length;var j="",h=-1;if(i){for(;++h<i;){j+=cz[eJ(g)]}return j}for(;++h<36;){switch(h){case 8:case 13:case 18:case 23:j+="-";break;case 19:j+=cz[3&eJ(16)|8];break;default:j+=cz[eJ(16)]}}return j}function fG(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function jU(h){var g;if(h?"string"!=typeof h?g=e8(eT):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=e8(eZ)):g=e8(jq),g){throw g}}function aW(i){if(!/^\d+\-./.test(i)){return e8(e9)}var g=i.indexOf("-"),j=i.substring(0,g),h=i.substring(g+1);return{prefix:parseInt(j,10),id:h}}function jL(i,l){for(var g=i.start-i.ids.length+1,m=i.ids,j=[m[0],l,[]],k=1,h=m.length;h>k;k++){j=[m[k],{status:"missing"},[j]]}return[{pos:g,ids:j}]}function bb(i,k){var g,m,o,h={status:"available"};if(i._deleted&&(h.deleted=!0),k){if(i._id||(i._id=jn()),m=jn(32,16).toLowerCase(),i._rev){if(o=aW(i._rev),o.error){return o}i._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[m,h,[]]]]}],g=o.prefix+1}else{i._rev_tree=[{pos:1,ids:[m,h,[]]}],g=1}}else{if(i._revisions&&(i._rev_tree=jL(i._revisions,h),g=i._revisions.start,m=i._revisions.ids[0]),!i._rev_tree){if(o=aW(i._rev),o.error){return o}g=o.prefix,m=o.id,i._rev_tree=[{pos:g,ids:[m,h,[]]}]}}jU(i._id),i._rev=g+"-"+m;var j={metadata:{},data:{}};for(var l in i){if(Object.prototype.hasOwnProperty.call(i,l)){var p="_"===l[0];if(p&&!cN[l]){var n=e8(cw,l);throw n.message=cw.message+": "+l,n}p&&!cA[l]?j.metadata[l.slice(1)]=i[l]:j.data[l]=i[l]}}return j}function ea(h,g){return g>h?-1:h>g?1:0}function bh(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function bP(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function aB(l){for(var j=0;j<l.length;j++){var i=l[j];if(i._deleted){delete i._attachments}else{if(i._attachments){for(var k=Object.keys(i._attachments),h=0;h<k.length;h++){var g=k[h];i._attachments[g]=jB(i._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function aO(k,i){var h=ea(k._id,i._id);if(0!==h){return h}var j=k._revisions?k._revisions.start:0,g=i._revisions?i._revisions.start:0;return ea(j,g)}function eS(h){var g={},i=[];return jG(h,function(j,n,k,m){var l=n+"-"+k;return j&&(g[l]=0),void 0!==m&&i.push({from:m,to:l}),l}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function bd(k,i,h){var j="limit" in i?i.keys.slice(i.skip,i.limit+i.skip):i.skip>0?i.keys.slice(i.skip):i.keys;if(i.descending&&j.reverse(),!j.length){return k._allDocs({limit:0},h)}var g={offset:i.skip};return cF.all(j.map(function(m){var l=dd.extend({key:m,deleted:"ok"},i);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new cF(function(o,n){k._allDocs(l,function(q,p){return q?n(q):(g.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return g.rows=l,g})}function d9(i){var g=i._compactionQueue[0],h=g.opts,j=g.callback;i.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(h.last_seq=k.last_seq),i._compact(h,function(l,m){l?j(l):j(null,m),dF.nextTick(function(){i._compactionQueue.shift(),i._compactionQueue.length&&d9(i)})})})}function eP(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function cG(){fJ.EventEmitter.call(this)}function fH(){this.isReady=!1,this.failed=!1,this.queue=[]}function bg(g){g&&dY.debug&&console.error(g)}function t(i,l){function g(){k.emit("destroyed",j),k.emit(j,"destroyed")}function m(){i.removeListener("destroyed",g),i.emit("destroyed",i)}var j=l.originalName,k=i.constructor,h=k._destructionListeners;i.once("destroyed",g),h.has(j)||h.set(j,[]),h.get(j).push(m)}function cS(l,j,i){if(!(this instanceof cS)){return new cS(l,j,i)}var k=this;("function"==typeof j||"undefined"==typeof j)&&(i=j,j={}),l&&"object"==typeof l&&(j=l,l=void 0),"undefined"==typeof i&&(i=bg),l=l||j.name,j=e6(j),delete j.name,this.__opts=j;var h=i;k.auto_compaction=j.auto_compaction,k.prefix=cS.prefix,cG.call(k),k.taskqueue=new fH;var g=new cF(function(o,m){i=function(r,s){return r?m(r):(delete s.then,void o(s))},j=e6(j);var p,n,q=j.name||l;return function(){try{if("string"!=typeof q){throw n=new Error("Missing/invalid DB name"),n.code=400,n}if(p=cS.parseAdapter(q,j),j.originalName=q,j.name=p.name,j.prefix&&"http"!==p.adapter&&"https"!==p.adapter&&(j.name=j.prefix+j.name),j.adapter=j.adapter||p.adapter,k._adapter=j.adapter,c2("pouchdb:adapter")("Picked adapter: "+j.adapter),k._db_name=q,!cS.adapters[j.adapter]){throw n=new Error("Adapter is missing"),n.code=404,n}if(!cS.adapters[j.adapter].valid()){throw n=new Error("Invalid Adapter"),n.code=404,n}}catch(r){k.taskqueue.fail(r)}}(),n?m(n):(k.adapter=j.adapter,k.replicate={},k.replicate.from=function(r,u,s){return k.constructor.replicate(r,k,u,s)},k.replicate.to=function(r,u,s){return k.constructor.replicate(k,r,u,s)},k.sync=function(r,u,s){return k.constructor.sync(k,r,u,s)},k.replicate.sync=k.sync,void cS.adapters[j.adapter].call(k,j,function(r){return r?(k.taskqueue.fail(r),void i(r)):(t(k,j),k.emit("created",k),cS.emit("created",j.originalName),k.taskqueue.ready(k),void i(null,k))}))});g.then(function(m){h(null,m)},h),k.then=g.then.bind(g),k["catch"]=g["catch"].bind(g)}function jI(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function jp(){return em}function e0(h){Object.keys(fJ.EventEmitter.prototype).forEach(function(i){"function"==typeof fJ.EventEmitter.prototype[i]&&(h[i]=af[i].bind(af))});var g=h._destructionListeners=new bG.Map;h.on("destroyed",function(i){g.has(i)&&(g.get(i).forEach(function(j){j()}),g["delete"](i))})}function aw(k){for(var i=k.length,h=new ArrayBuffer(i),j=new Uint8Array(h),g=0;i>g;g++){j[g]=k.charCodeAt(g)}return h}function ds(h,g){return aX([aw(h)],{type:g})}function c4(i){for(var l=bQ.exec(i),g={},m=14;m--;){var j=bm[m],k=l[m]||"",h=-1!==["user","password"].indexOf(j);g[j]=h?decodeURIComponent(k):k}return g[bU]={},g[bm[12]].replace(cp,function(o,p,n){p&&(g[bU][p]=n)}),g}function al(k,i,h){try{return !k(i,h)}catch(j){var g="Filter function threw: "+j.toString();return e8(jm,g)}}function fC(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&al(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function cE(h,g){"console" in dY&&"info" in console&&console.info("The above "+h+" is totally normal. "+g)}function di(k,i,h,j,g){return k.get(i)["catch"](function(l){if(404===l.status){return"http"===k.type()&&cE(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:j,_id:i,history:[],replicator:bK,version:cD}}throw l}).then(function(l){return g.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==j}),l.history.unshift({last_seq:h,session_id:j}),l.history=l.history.slice(0,d2),l.version=cD,l.replicator=bK,l.session_id=j,l.last_seq=h,k.put(l)["catch"](function(m){if(409===m.status){return di(k,i,h,j,g)}throw m}))})}function jV(i,g,j,h){this.src=i,this.target=g,this.id=j,this.returnValue=h}function cX(i,g){if(i.session_id===g.session_id){return{last_seq:i.last_seq,history:i.history||[]}}var j=i.history||[],h=g.history||[];return dE(j,h)}function dE(g,h){var m=g[0],i=g.slice(1),k=h[0],l=h.slice(1);if(!m||0===h.length){return{last_seq:dg,history:[]}}var j=m.session_id;if(dc(j,h)){return{last_seq:m.last_seq,history:g}}var n=k.session_id;return dc(n,i)?{last_seq:k.last_seq,history:l}:dE(i,l)}function dc(i,g){var j=g[0],h=g.slice(1);return i&&0!==g.length?i===j.session_id?!0:dc(i,h):!1}function jJ(i,g){i=parseInt(i,10)||0,g=parseInt(g,10),g!==g||i>=g?g=(i||1)<<1:g+=1;var j=Math.random(),h=g-i;return ~~(h*j+i)}function cs(h){var g=0;return h||(g=2000),jJ(h,g)}function eh(i,g,j,h){return i.retry===!1?(g.emit("error",j),void g.removeAllListeners()):("function"!=typeof i.back_off_function&&(i.back_off_function=cs),g.emit("requestError",j),("active"===g.state||"pending"===g.state)&&(g.emit("paused",j),g.state="stopped",g.once("active",function(){i.current_back_off=dU})),i.current_back_off=i.current_back_off||dU,i.current_back_off=i.back_off_function(i.current_back_off),void setTimeout(h,i.current_back_off))}function dL(g){return bL(g)}function c5(i,g,j,h){(j>0||h<g.byteLength)&&(g=new Uint8Array(g,j,Math.min(h,g.byteLength)-j)),i.append(g)}function aP(i,g,j,h){(j>0||h<g.length)&&(g=g.substring(j,h)),i.appendBinary(g)}function d4(g){return Object.keys(g).sort(bT.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function aa(i,l,g){var m=g.doc_ids?g.doc_ids.sort(bT.collate):"",j=g.filter?g.filter.toString():"",k="",h="";return g.filter&&g.query_params&&(k=JSON.stringify(d4(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),cF.all([i.id(),l.id()]).then(function(n){var o=n[0]+n[1]+j+h+k+m;return az(o)}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dq(g){return/^1-/.test(g)}function bO(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0,attachments:!0,binary:!0}}function bC(n,h,m){function k(){var p=bO(h);if(p.docs.length){return n.bulkGet(p).then(function(q){if(m.cancelled){throw new Error("cancelled")}q.results.forEach(function(r){r.docs.forEach(function(s){s.ok&&o.push(s.ok)})})})}}function l(p){return p._attachments&&Object.keys(p._attachments).length>0}function g(p){return n.allDocs({keys:p,include_docs:!0}).then(function(q){if(m.cancelled){throw new Error("cancelled")}q.rows.forEach(function(r){!r.deleted&&r.doc&&dq(r.value.rev)&&!l(r.doc)&&(o.push(r.doc),delete h[r.id])})})}function i(){var p=Object.keys(h).filter(function(q){var r=h[q].missing;return 1===r.length&&dq(r[0])});return p.length>0?g(p):void 0}function j(){return o}h=e6(h);var o=[];return cF.resolve().then(i).then(k).then(j)}function bR(P,Q,v,n,u){function B(){return E?cF.resolve():aa(P,Q,v).then(function(T){h=T,E=new jV(P,Q,h,n)})}function q(){if(J=[],0!==G.docs.length){var T=G.docs;return Q.bulkDocs({docs:T,new_edits:!1}).then(function(Y){if(n.cancelled){throw C(),new Error("cancelled")}var V=[],X={};Y.forEach(function(Z){Z.error&&(u.doc_write_failures++,V.push(Z),X[Z.id]=Z)}),i=i.concat(V),u.docs_written+=G.docs.length-V.length;var W=V.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=X[Z._id];ae?n.emit("denied",e6(ae)):J.push(Z)}),W.length>0){var U=new Error("bulkDocs error");throw U.other_errors=V,m("target.bulkDocs failed to write docs",U),new Error("bulkWrite partial failure")}},function(U){throw u.doc_write_failures+=T.length,U})}}function g(){u.last_seq=H=G.seq;var T=e6(u);return J.length&&(T.docs=J,n.emit("change",T)),D=!0,E.writeCheckpoint(G.seq,k).then(function(){if(D=!1,n.cancelled){throw C(),new Error("cancelled")}G=void 0,x()})["catch"](function(U){throw D=!1,m("writeCheckpoint completed with error",U),U})}function M(){var T={};return G.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),Q.revsDiff(T).then(function(U){if(n.cancelled){throw C(),new Error("cancelled")}G.diffs=U})}function o(){return bC(P,G.diffs,n).then(function(T){T.forEach(function(U){delete G.diffs[U._id],u.docs_read++,G.docs.push(U)})})}function N(){if(!n.cancelled&&!G){if(0===z.length){return void y(!0)}G=z.shift(),M().then(o).then(q).then(g).then(N)["catch"](function(T){m("batch processing terminated with error",T)})}}function y(T){return 0===r.changes.length?void (0!==z.length||G||((A&&R.live||l)&&(n.state="pending",n.emit("paused")),l&&C())):void ((T||l||r.changes.length>=j)&&(z.push(r),r={seq:0,changes:[],docs:[]},("pending"===n.state||"stopped"===n.state)&&(n.state="active",n.emit("active")),N()))}function m(U,T){w||(T.message||(T.message=U),u.ok=!1,u.status="aborting",u.errors.push(T),i=i.concat(T),z=[],r={seq:0,changes:[],docs:[]},C())}function C(){if(!(w||n.cancelled&&(u.status="cancelled",D))){u.status=u.status||"complete",u.end_time=new Date,u.last_seq=H,w=!0;var U=i.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=i.pop();i.length>0&&(T.other_errors=i),T.result=u,eh(v,n,T,function(){bR(P,Q,v,n)})}else{u.errors=i,n.emit("complete",u),n.removeAllListeners()}}}function s(U){if(n.cancelled){return C()}var T=fC(v)(U);T&&(r.seq=U.seq,r.changes.push(U),y(0===z.length))}function L(T){return O=!1,n.cancelled?C():(T.results.length>0?(R.since=T.last_seq,x()):A?(R.live=!0,x()):l=!0,void y(!0))}function S(T){return O=!1,n.cancelled?C():void m("changes rejected",T)}function x(){function U(){T.cancel()}function V(){n.removeListener("cancel",U)}if(!O&&!l&&z.length<K){O=!0,n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",U);var T=P.changes(R).on("change",s);T.then(V,V),T.then(L)["catch"](S),v.retry&&(n._changes=T,n._abortChanges=U)}}function I(){B().then(function(){return n.cancelled?void C():E.getCheckpoint().then(function(T){H=T,R={since:H,limit:j,batch_size:j,style:"all_docs",doc_ids:F,return_docs:!0},v.filter&&("string"!=typeof v.filter?R.include_docs=!0:R.filter=v.filter),"heartbeat" in v&&(R.heartbeat=v.heartbeat),"timeout" in v&&(R.timeout=v.timeout),v.query_params&&(R.query_params=v.query_params),v.view&&(R.view=v.view),x()})})["catch"](function(T){m("getCheckpoint rejected with ",T)})}function p(T){throw D=!1,m("writeCheckpoint completed with error",T),T}var G,h,E,z=[],r={seq:0,changes:[],docs:[]},D=!1,l=!1,w=!1,H=0,A=v.continuous||v.live||!1,j=v.batch_size||100,K=v.batches_limit||10,O=!1,F=v.doc_ids,i=[],J=[],k=jn();u=u||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var R={};return n.ready(P,Q),n.cancelled?void C():(n._addedListeners||(n.once("cancel",C),"function"==typeof v.complete&&(n.once("error",v.complete),n.once("complete",function(T){v.complete(null,T)})),n._addedListeners=!0),void ("undefined"==typeof v.since?I():B().then(function(){return D=!0,E.writeCheckpoint(v.since,k)}).then(function(){return D=!1,n.cancelled?void C():(H=v.since,void I())})["catch"](p)))}function cg(){fJ.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new cF(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function dR(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function bf(i,l,g,m){if("function"==typeof g&&(m=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw e8(jm,"`doc_ids` filter parameter is not a list.")}g.complete=m,g=e6(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var j=new cg(g),k=dR(i,g),h=dR(l,g);return bR(k,h,g,j),j}function dP(i,g,j,h){return"function"==typeof j&&(h=j,j={}),"undefined"==typeof j&&(j={}),j=e6(j),j.PouchConstructor=j.PouchConstructor||this,i=eB.toPouch(i,j),g=eB.toPouch(g,j),new d6(i,g,j,h)}function d6(o,w,x,q){function v(z){m.emit("change",{direction:"pull",change:z})}function l(z){m.emit("change",{direction:"push",change:z})}function u(z){m.emit("denied",{direction:"push",doc:z})}function y(z){m.emit("denied",{direction:"pull",doc:z})}function i(){m.pushPaused=!0,m.pullPaused&&m.emit("paused")}function r(){m.pullPaused=!0,m.pushPaused&&m.emit("paused")}function n(){m.pushPaused=!1,m.pullPaused&&m.emit("active",{direction:"push"})}function k(){m.pullPaused=!1,m.pushPaused&&m.emit("active",{direction:"pull"})}function p(z){return function(D,B){var C="change"===D&&(B===v||B===l),F="denied"===D&&(B===y||B===u),A="paused"===D&&(B===r||B===i),E="active"===D&&(B===k||B===n);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&m.removeAllListeners(D))}}var m=this;this.canceled=!1;var s=x.push?dd.extend({},x,x.push):x,h=x.pull?dd.extend({},x,x.pull):x;this.push=cZ(o,w,s),this.pull=cZ(w,o,h),this.pushPaused=!0,this.pullPaused=!0;var g={};x.live&&(this.push.on("complete",m.pull.cancel.bind(m.pull)),this.pull.on("complete",m.push.cancel.bind(m.push))),this.on("newListener",function(z){"change"===z?(m.pull.on("change",v),m.push.on("change",l)):"denied"===z?(m.pull.on("denied",y),m.push.on("denied",u)):"active"===z?(m.pull.on("active",k),m.push.on("active",n)):"paused"===z&&(m.pull.on("paused",r),m.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(m.pull.removeListener("change",v),m.push.removeListener("change",l)):"denied"===z?(m.pull.removeListener("denied",y),m.push.removeListener("denied",u)):"active"===z?(m.pull.removeListener("active",k),m.push.removeListener("active",n)):"paused"===z&&(m.pull.removeListener("paused",r),m.push.removeListener("paused",i))}),this.pull.on("removeListener",p("pull")),this.push.on("removeListener",p("push"));var j=cF.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return m.emit("complete",z),q&&q(null,z),m.removeAllListeners(),z},function(z){if(m.cancel(),q?q(z):m.emit("error",z),m.removeAllListeners(),q){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function cI(h,g){return ds(ax(h),g)}function b3(k){for(var i="",h=new Uint8Array(k),j=h.byteLength,g=0;j>g;g++){i+=String.fromCharCode(h[g])}return i}function fD(i,g){if("undefined"==typeof FileReader){return g(b3((new FileReaderSync).readAsArrayBuffer(i)))}var j=new FileReader,h="function"==typeof j.readAsBinaryString;j.onloadend=function(k){var l=k.target.result||"";return h?g(l):void g(b3(l))},h?j.readAsBinaryString(i):j.readAsArrayBuffer(i)}function by(g){return new cF(function(h){fD(g,function(i){h(bL(i))})})}function jF(i){for(var g=[],j=0,h=i.length;h>j;j++){g=g.concat(i[j])}return g}function jz(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=cI(j.data,j.content_type)})}function cl(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function c0(g){return g._attachments&&Object.keys(g._attachments)?cF.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?by(i.data).then(function(j){i.data=j}):void 0})):cF.resolve()}function ci(h){var g=c4(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function dH(h,g){return b9(h,h.db+"/"+g)}function b9(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function dk(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function dO(n,g){function u(z,x,w){var A=z.ajax||{},y=dd.extend(e6(r),A,x);return dw(y.method+" "+y.url),eA.ajax(y,w)}function m(x,w){return new cF(function(z,y){u(x,w,function(A,B){return A?y(A):void z(B)})})}function o(x,w){return b0(x,jv(function(y){i().then(function(z){return w.apply(this,y)})["catch"](function(z){var A=y.pop();A(z)})}))}function i(){if(n.skipSetup||n.skip_setup){return cF.resolve()}if(s){return s}var w={method:"GET",url:j};return s=m({},w)["catch"](function(x){return x&&x.status&&404===x.status?(cE(404,"PouchDB is just detecting if the remote exists."),m({},{method:"PUT",url:j})):cF.reject(x)})["catch"](function(x){return x&&x.status&&412===x.status?!0:cF.reject(x)}),s["catch"](function(){s=null}),s}function v(w){return w.split("/").map(encodeURIComponent).join("/")}var k=this,q=ci;n.getHost&&(q=n.getHost);var p=q(n.name,n),j=dH(p,"");n=e6(n);var r=n.ajax||{};if(k.getUrl=function(){return j},k.getHeaders=function(){return r.headers||{}},n.auth||p.auth){var h=n.auth||p.auth,l=bL(h.username+":"+h.password);r.headers=r.headers||{},r.headers.Authorization="Basic "+l}var s;setTimeout(function(){g(null,k)}),k.type=function(){return"http"},k.id=o("id",function(w){u({},{method:"GET",url:b9(p,"")},function(z,y){var x=y&&y.uuid?y.uuid+p.db:dH(p,"");w(null,x)})}),k.request=o("request",function(x,w){x.url=dH(p,x.url),u({},x,w)}),k.compact=o("compact",function(x,w){"function"==typeof x&&(w=x,x={}),x=e6(x),u(x,{url:dH(p,"_compact"),method:"POST"},function(){function y(){k.info(function(z,A){A&&!A.compact_running?w(null,{ok:!0}):setTimeout(y,x.interval||200)})}y()})}),k.bulkGet=b0("bulkGet",function(y,A){function B(E){var D={};y.revs&&(D.revs=!0),y.attachments&&(D.attachments=!0),u({},{url:dH(p,"_bulk_get"+dk(D)),method:"POST",body:{docs:y.docs}},E)}function z(){function F(K){return function(M,L){I[K]=L.results,++G===D&&A(null,{results:jF(I)})}}for(var J=eK,D=Math.ceil(y.docs.length/J),G=0,I=new Array(D),H=0;D>H;H++){var E=jB(y,["revs","attachments"]);E.docs=y.docs.slice(H*J,Math.min(y.docs.length,(H+1)*J)),dS(w,E,F(H))}}var w=this,C=b9(p,""),x=bq[C];"boolean"!=typeof x?B(function(D,E){if(D){var F=Math.floor(D.status/100);4===F||5===F?(bq[C]=!1,cE(D.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),z()):A(D)}else{bq[C]=!0,A(null,E)}}):x?B(A):z()}),k._info=function(w){i().then(function(){u({},{method:"GET",url:dH(p,"")},function(y,x){return y?w(y):(x.host=dH(p,""),void w(null,x))})})["catch"](w)},k.get=o("get",function(y,A,B){function z(E){var F=E._attachments,D=F&&Object.keys(F);return F&&D.length?cF.all(D.map(function(I){var G=F[I],H=cl(E._id)+"/"+v(I)+"?rev="+E._rev;return m(A,{method:"GET",url:dH(p,H),binary:!0}).then(function(J){return A.binary?J:by(J)}).then(function(J){delete G.stub,delete G.length,G.data=J})})):void 0}function w(D){return Array.isArray(D)?cF.all(D.map(function(E){return E.ok?z(E.ok):void 0})):z(D)}"function"==typeof A&&(B=A,A={}),A=e6(A);var x={};A.revs&&(x.revs=!0),A.revs_info&&(x.revs_info=!0),A.open_revs&&("all"!==A.open_revs&&(A.open_revs=JSON.stringify(A.open_revs)),x.open_revs=A.open_revs),A.rev&&(x.rev=A.rev),A.conflicts&&(x.conflicts=A.conflicts),y=cl(y);var C={method:"GET",url:dH(p,y+dk(x))};m(A,C).then(function(D){return cF.resolve().then(function(){return A.attachments?w(D):void 0}).then(function(){B(null,D)})})["catch"](B)}),k.remove=o("remove",function(A,B,x,z){var y;"string"==typeof B?(y={_id:A,_rev:B},"function"==typeof x&&(z=x,x={})):(y=A,"function"==typeof B?(z=B,x={}):(z=x,x=B));var w=y._rev||x.rev;u(x,{method:"DELETE",url:dH(p,cl(y._id))+"?rev="+w},z)}),k.getAttachment=o("getAttachment",function(A,x,z,B){"function"==typeof z&&(B=z,z={});var y=z.rev?"?rev="+z.rev:"",w=dH(p,cl(A))+"/"+v(x)+y;u(z,{method:"GET",url:w,binary:!0},B)}),k.removeAttachment=o("removeAttachment",function(z,x,y,w){var A=dH(p,cl(z)+"/"+v(x))+"?rev="+y;u({},{method:"DELETE",url:A},w)}),k.putAttachment=o("putAttachment",function(D,G,x,z,A,w){"function"==typeof A&&(w=A,A=z,z=x,x=null);var F=cl(D)+"/"+v(G),C=dH(p,F);if(x&&(C+="?rev="+x),"string"==typeof z){var B;try{B=ax(z)}catch(y){return w(e8(aZ,"Attachment is not a valid base64 string"))}z=B?ds(B,A):""}var E={headers:{"Content-Type":A},method:"PUT",url:C,processData:!1,body:z,timeout:r.timeout||60000};u({},E,w)}),k._bulkDocs=function(x,y,w){x.new_edits=y.new_edits,i().then(function(){return cF.all(x.docs.map(c0))}).then(function(){u(y,{method:"POST",url:dH(p,"_bulk_docs"),body:x},function(A,z){return A?w(A):(z.forEach(function(B){B.ok=!0}),void w(null,z))})})["catch"](w)},k.allDocs=o("allDocs",function(y,B){"function"==typeof y&&(B=y,y={}),y=e6(y);var A,z={},w="GET";y.conflicts&&(z.conflicts=!0),y.descending&&(z.descending=!0),y.include_docs&&(z.include_docs=!0),y.attachments&&(z.attachments=!0),y.key&&(z.key=JSON.stringify(y.key)),y.start_key&&(y.startkey=y.start_key),y.startkey&&(z.startkey=JSON.stringify(y.startkey)),y.end_key&&(y.endkey=y.end_key),y.endkey&&(z.endkey=JSON.stringify(y.endkey)),"undefined"!=typeof y.inclusive_end&&(z.inclusive_end=!!y.inclusive_end),"undefined"!=typeof y.limit&&(z.limit=y.limit),"undefined"!=typeof y.skip&&(z.skip=y.skip);var C=dk(z);if("undefined"!=typeof y.keys){var x="keys="+encodeURIComponent(JSON.stringify(y.keys));x.length+C.length+1<=fQ?C+="&"+x:(w="POST",A={keys:y.keys})}m(y,{method:w,url:dH(p,"_all_docs"+C),body:A}).then(function(D){y.include_docs&&y.attachments&&y.binary&&D.rows.forEach(jz),B(null,D)})["catch"](B)}),k._changes=function(y){var B="batch_size" in y?y.batch_size:aV;y=e6(y),y.timeout="timeout" in y?y.timeout:"timeout" in r?r.timeout:30000;var G,C=y.timeout?{timeout:y.timeout-5000}:{},J="undefined"!=typeof y.limit?y.limit:!1;G="return_docs" in y?y.return_docs:"returnDocs" in y?y.returnDocs:!0;var z=J;if(y.style&&(C.style=y.style),(y.include_docs||y.filter&&"function"==typeof y.filter)&&(C.include_docs=!0),y.attachments&&(C.attachments=!0),y.continuous&&(C.feed="longpoll"),y.conflicts&&(C.conflicts=!0),y.descending&&(C.descending=!0),"heartbeat" in y?y.heartbeat&&(C.heartbeat=y.heartbeat):C.heartbeat=10000,y.filter&&"string"==typeof y.filter&&(C.filter=y.filter,"_view"===y.filter&&y.view&&"string"==typeof y.view&&(C.view=y.view)),y.query_params&&"object"==typeof y.query_params){for(var F in y.query_params){y.query_params.hasOwnProperty(F)&&(C[F]=y.query_params[F])}}var x,H="GET";if(y.doc_ids){C.filter="_doc_ids";var K=JSON.stringify(y.doc_ids);K.length<fQ?C.doc_ids=K:(H="POST",x={doc_ids:y.doc_ids})}var I,A,w=function(N,M){if(!y.aborted){C.since=N,"object"==typeof C.since&&(C.since=JSON.stringify(C.since)),y.descending?J&&(C.limit=z):C.limit=!J||z>B?B:z;var L={method:H,url:dH(p,"_changes"+dk(C)),timeout:y.timeout,body:x};A=N,y.aborted||i().then(function(){I=u(y,L,M)})["catch"](M)}},D={results:[]},E=function(O,L){if(!y.aborted){var P=0;if(L&&L.results){P=L.results.length,D.last_seq=L.last_seq;var M={};M.query=y.query_params,L.results=L.results.filter(function(Q){z--;var R=fC(y)(Q);return R&&(y.include_docs&&y.attachments&&y.binary&&jz(Q),G&&D.results.push(Q),y.onChange(Q)),R})}else{if(O){return y.aborted=!0,void y.complete(O)}}L&&L.last_seq&&(A=L.last_seq);var N=J&&0>=z||L&&B>P||y.descending;(!y.continuous||J&&0>=z)&&N?y.complete(null,D):setTimeout(function(){w(A,E)},0)}};return w(y.since||0,E),{cancel:function(){y.aborted=!0,I&&I.abort()}}},k.revsDiff=o("revsDiff",function(x,y,w){"function"==typeof y&&(w=y,y={}),u(y,{method:"POST",url:dH(p,"_revs_diff"),body:x},w)}),k._close=function(w){w()},k._destroy=function(w,x){u(w,{url:dH(p,""),method:"DELETE"},function(z,y){return z&&z.status&&404!==z.status?x(z):(k.emit("destroyed"),k.constructor.emit("destroyed",n.name),void x(null,y))})}}function bz(){this.promise=new cF(function(g){g()})}function aM(g){return a9.hash(g)}function fM(g){var h=g.db,m=g.viewName,i=g.map,k=g.reduce,l=g.temporary,j=i.toString()+(k&&k.toString())+"undefined";if(!l&&h._cachedViews){var n=h._cachedViews[j];if(n){return cF.resolve(n)}}return h.info().then(function(p){function o(u){u.views=u.views||{};var r=m;-1===r.indexOf("/")&&(r=m+"/"+m);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(l?"temp":aM(j));return eU(h,"_local/mrviews",o).then(function(){return h.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:h,adapter:h.adapter,mapFun:i,reduceFun:k};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,l||(h._cachedViews=h._cachedViews||{},h._cachedViews[j]=r,r.db.once("destroyed",function(){delete h._cachedViews[j]})),r})})})})}function aj(l,j,i,k,h,g){return b1("return ("+l.replace(/;\s*$/,"")+");",{emit:j,sum:i,log:k,isArray:h,toJSON:g})}function eg(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function eL(g){return 1===g.length&&/^1-/.test(g[0].rev)}function b5(h,g){try{h.emit("error",g)}catch(i){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(g)}}function ek(i,g,j){try{return{output:g.apply(null,j)}}catch(h){return b5(i,h),{error:h}}}function aF(h,g){var i=aG(h.key,g.key);return 0!==i?i:aG(h.value,g.value)}function bJ(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function fK(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function dN(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=cI(k.data,k.content_type)})})}function d5(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&dN(h),h}}function cq(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new e7(g)}function dX(g){for(var h=0,m=0,i=g.length;i>m;m++){var k=g[m];if("number"!=typeof k){if(!Array.isArray(k)){throw cq("_sum")}h="number"==typeof h?[h]:h;for(var l=0,j=k.length;j>l;l++){var n=k[l];if("number"!=typeof n){throw cq("_sum")}"undefined"==typeof h[l]?h.push(n):h[l]+=n}}else{"number"==typeof h?h+=k:h[0]+=k}}return h}function cY(k,i,h,j){var g=i[k];"undefined"!=typeof g&&(j&&(g=encodeURIComponent(JSON.stringify(g))),h.push(k+"="+g))}function bv(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function e(g){return g.group_level=bv(g.group_level),g.limit=bv(g.limit),g.skip=bv(g.skip),g}function bX(g){if(g){if("number"!=typeof g){return new aC('Invalid value for integer: "'+g+'"')}if(0>g){return new aC('Invalid value for positive integer: "'+g+'"')}}}function am(i,g){var j=i.descending?"endkey":"startkey",h=i.descending?"startkey":"endkey";if("undefined"!=typeof i[j]&&"undefined"!=typeof i[h]&&aG(i[j],i[h])>0){throw new aC("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(g.reduce&&i.reduce!==!1){if(i.include_docs){throw new aC("{include_docs:true} is invalid for reduce")}if(i.keys&&i.keys.length>1&&!i.group&&!i.group_level){throw new aC("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=bX(i[k]);if(l){throw l}})}function aH(n,h,m){var k,l=[],g="GET";if(cY("reduce",m,l),cY("include_docs",m,l),cY("attachments",m,l),cY("limit",m,l),cY("descending",m,l),cY("group",m,l),cY("group_level",m,l),cY("skip",m,l),cY("stale",m,l),cY("conflicts",m,l),cY("startkey",m,l,!0),cY("start_key",m,l,!0),cY("endkey",m,l,!0),cY("end_key",m,l,!0),cY("inclusive_end",m,l),cY("key",m,l,!0),l=l.join("&"),l=""===l?"":"?"+l,"undefined"!=typeof m.keys){var i=2000,j="keys="+encodeURIComponent(JSON.stringify(m.keys));j.length+l.length+1<=i?l+=("?"===l[0]?"&":"?")+j:(g="POST","string"==typeof h?k={keys:m.keys}:h.keys=m.keys)}if("string"==typeof h){var o=eg(h);return n.request({method:g,url:"_design/"+o[0]+"/_view/"+o[1]+l,body:k}).then(d5(m))}return k=k||{},Object.keys(h).forEach(function(p){Array.isArray(h[p])?k[p]=h[p]:k[p]=h[p].toString()}),n.request({method:"POST",url:"_temp_view"+l,body:k}).then(d5(m))}function ed(h,g,i){return new cF(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function b8(g){return new cF(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function ag(g){return function(h){if(404===h.status){return g}throw h}}function cK(g,k,p){function m(){return eL(q)?cF.resolve(j):k.db.get(h)["catch"](ag(j))}function l(r){return r.keys.length?k.db.allDocs({keys:r.keys,include_docs:!0}):cF.resolve({rows:[]})}function n(v,x){for(var B=[],y={},A=0,r=x.rows.length;r>A;A++){var u=x.rows[A],z=u.doc;if(z&&(B.push(z),y[z._id]=!0,z._deleted=!i[z._id],!z._deleted)){var w=i[z._id];"value" in w&&(z.value=w.value)}}var s=Object.keys(i);return s.forEach(function(C){if(!y[C]){var E={_id:C},D=i[C];"value" in D&&(E.value=D.value),B.push(E)}}),v.keys=eO(s.concat(v.keys)),B.push(v),B}var h="_local/doc_"+g,j={_id:h,keys:[]},o=p[g],i=o.indexableKeysToKeyValues,q=o.changes;return m().then(function(r){return l(r).then(function(s){return n(r,s)})})}function jY(i,g,j){var h="_local/lastSeq";return i.db.get(h)["catch"](ag({_id:h,seq:0})).then(function(k){var l=Object.keys(g);return cF.all(l.map(function(m){return cK(m,i,g)})).then(function(m){var n=jF(m);return k.seq=j,n.push(k),i.db.bulkDocs({docs:n})})})}function fA(h){var g="string"==typeof h?h:h.name,i=dT[g];return i||(i=dT[g]=new bz),i}function bc(g){return eH(fA(g),function(){return aY(g)})()}function aY(n){function h(p,r){var q={id:l._id,key:dJ(p)};"undefined"!=typeof r&&null!==r&&(q.value=dJ(r)),k.push(q)}function m(q,p){return function(){return jY(n,q,p)}}var k,l,g;if("function"==typeof n.mapFun&&2===n.mapFun.length){var i=n.mapFun;g=function(p){return i(p,h)}}else{g=aj(n.mapFun.toString(),h,dX,av,Array.isArray,JSON.parse)}var j=n.seq||0,o=new bz;return new cF(function(p,s){function r(){o.finish().then(function(){n.seq=j,p()})}function q(){function u(v){s(v)}n.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:j,limit:d3}).on("complete",function(A){var v=A.results;if(!v.length){return r()}for(var w={},F=0,C=v.length;C>F;F++){var x=v[F];if("_"!==x.doc._id[0]){k=[],l=x.doc,l._deleted||ek(n.sourceDB,g,[l]),k.sort(aF);for(var H,z={},D=0,B=k.length;B>D;D++){var E=k[D],G=[E.key,E.id];0===aG(E.key,H)&&G.push(D);var y=e5(G);z[y]=E,H=E.key}w[x.doc._id]={indexableKeysToKeyValues:z,changes:x.changes}}j=x.seq}return o.add(m(w,j)),v.length<d3?r():q()}).on("error",u)}q()})}function cP(g,k,p){0===p.group_level&&delete p.group_level;var m,l=p.group||p.group_level;m=e4[g.reduceFun]?e4[g.reduceFun]:aj(g.reduceFun.toString(),null,dX,av,Array.isArray,JSON.parse);var n=[],h=p.group_level;k.forEach(function(r){var u=n[n.length-1],s=l?r.key:null;return l&&Array.isArray(s)&&"number"==typeof h&&(s=s.length>h?s.slice(0,h):s),u&&0===aG(u.key[0][0],s)?(u.key.push([s,r.id]),void u.value.push(r.value)):void n.push({key:[[s,r.id]],value:[r.value]})});for(var j=0,o=n.length;o>j;j++){var i=n[j],q=ek(g.sourceDB,m,[i.key,i.value,!1]);if(q.error&&q.error instanceof e7){throw q.error}i.value=q.error?null:q.output,i.key=i.key[0][0]}return{rows:bJ(n,p.limit,p.skip)}}function fN(h,g){return eH(fA(h),function(){return c8(h,g)})()}function c8(r,j){function m(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return l=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=cv(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function k(u){var w;if(w=o?cP(r,u,j):{total_rows:l,offset:h,rows:u},j.include_docs){var v=eO(u.map(fK));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:j.conflicts,attachments:j.attachments,binary:j.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),u.forEach(function(A){var B=fK(A),z=y["$"+B];z&&(A.doc=z)}),w})}return w}var l,o=r.reduceFun&&j.reduce!==!1,h=j.skip||0;if("undefined"==typeof j.keys||j.keys.length||(j.limit=0,delete j.keys),"undefined"!=typeof j.keys){var p=j.keys,i=p.map(function(v){var u={startkey:e5([v]),endkey:e5([v,{}])};return m(u)});return cF.all(i).then(jF).then(k)}var g={descending:j.descending};if(j.start_key&&(j.startkey=j.start_key),j.end_key&&(j.endkey=j.end_key),"undefined"!=typeof j.startkey&&(g.startkey=e5(j.descending?[j.startkey,{}]:[j.startkey])),"undefined"!=typeof j.endkey){var q=j.inclusive_end!==!1;j.descending&&(q=!q),g.endkey=e5(q?[j.endkey,{}]:[j.endkey])}if("undefined"!=typeof j.key){var n=e5([j.key]),s=e5([j.key,{}]);g.descending?(g.endkey=n,g.startkey=s):(g.startkey=n,g.endkey=s)}return o||("number"==typeof j.limit&&(g.limit=j.limit),g.skip=h),m(g).then(k)}function cf(g){return g.request({method:"POST",url:"_view_cleanup"})}function e1(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(m){var k=eg(m),l="_design/"+k[0],n=k[1];j[l]=j[l]||{},j[l][n]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(m){var n={};m.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){n[v]=n[v]||s})})});var l=Object.keys(n).filter(function(o){return !n[o]}),k=l.map(function(o){return eH(fA(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return cF.all(k).then(function(){return{ok:!0}})})},ag({ok:!0}))}function jr(k,n,g){if("http"===k.type()){return aH(k,n,g)}if("function"==typeof k._query){return ed(k,n,g)}if("string"!=typeof n){am(g,n);var m={db:k,viewName:"temp_view/temp_view",map:n.map,reduce:n.reduce,temporary:!0};return dZ.add(function(){return fM(m).then(function(o){function p(){return o.db.destroy()}return bB(bc(o).then(function(){return fN(o,g)}),p)})}),dZ.finish()}var h=n,j=eg(h),i=j[0],l=j[1];return k.get("_design/"+i).then(function(o){var p=o.views&&o.views[l];if(!p||"string"!=typeof p.map){throw new js("ddoc "+i+" has no view named "+l)}am(g,p);var q={db:k,viewName:h,map:p.map,reduce:p.reduce};return fM(q).then(function(r){return"ok"===g.stale||"update_after"===g.stale?("update_after"===g.stale&&dF.nextTick(function(){bc(r)}),fN(r,g)):bc(r).then(function(){return fN(r,g)})})})}function aC(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,aC)}catch(g){}}function js(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,js)}catch(g){}}function e7(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,e7)}catch(g){}}function dQ(g){return"'"+g+"'"}function cd(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function bF(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jP(g){return delete g._id,delete g._rev,JSON.stringify(g)}function d0(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function a8(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function ad(k,i,h,j,g){return"SELECT "+k+" FROM "+("string"==typeof i?i:i.join(" JOIN "))+(h?" ON "+h:"")+(j?" WHERE "+("string"==typeof j?j:j.join(" AND ")):"")+(g?" ORDER BY "+g:"")}function eD(i,l,g){function m(){++k===i.length&&j()}function j(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+bN+" WHERE seq IN "+a8(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+bN+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+bN+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new bG.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+bN+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+eG+" WHERE digest=?",[A]))})})})}})}}if(i.length){var k=0,h=[];i.forEach(function(o){var n="SELECT seq FROM "+jw+" WHERE doc_id=? AND rev=?";g.executeSql(n,[l,o],function(q,p){if(!p.rows.length){return m()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+jw+" WHERE seq=?",[r],m)})})}}function bi(g){return function(h){console.error("WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(e8(aI,j,i))}}function bY(h){if("size" in h){return 1000000*h.size}var g=/Android/.test(window.navigator.userAgent);return g?5000000:1}function fF(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(g){return openDatabase(g.name,g.version,g.description,g.size)}:void 0}function eY(h,g){try{return{db:h(g)}}catch(i){return{error:i}}}function fI(h){var g=cW[h.name];if(!g){var i=fF();g=cW[h.name]=eY(i,h),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return g}function cT(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function jO(g){jI()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):jp()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function bI(){fJ.EventEmitter.call(this),this._listeners={},jO(this)}function cy(g){return decodeURIComponent(window.escape(g))}function bk(g){return 65>g?g-48:g-55}function jQ(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(bk(i.charCodeAt(g++))<<4|bk(i.charCodeAt(g++)))}return h}function bp(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(bk(i.charCodeAt(g+2))<<12|bk(i.charCodeAt(g+3))<<8|bk(i.charCodeAt(g))<<4|bk(i.charCodeAt(g+1))),g+=4}return h}function aq(h,g){return"UTF-8"===g?cy(jQ(h,0,h.length)):bp(h,0,h.length)}function bW(h){try{return JSON.parse(h)}catch(g){return aD.parse(h)}}function eb(h){try{return JSON.stringify(h)}catch(g){return aD.stringify(h)}}function aE(i,l,k){function n(p){try{return ax(p)}catch(o){var q=e8(aZ,"Attachment is not a valid base64 string");return{error:q}}}function g(o,q){if(o.stub){return q()}if("string"==typeof o.data){var p=n(o.data);if(p.error){return q(p.error)}o.length=p.length,"blob"===l?o.data=ds(p,o.content_type):"base64"===l?o.data=bL(p):o.data=p,az(p).then(function(r){o.digest="md5-"+r,q()})}else{dK(o.data,function(r){"binary"===l?o.data=b3(r):"base64"===l&&(o.data=bL(b3(r))),az(r).then(function(s){o.digest="md5-"+s,o.length=r.byteLength,q()})})}}function m(){j++,i.length===j&&(h?k(h):k())}if(!i.length){return k()}var h,j=0;i.forEach(function(r){function p(u){h=u,q++,q===s.length&&m()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return m()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&g(r.data._attachments[o],p)}})}function cH(h,g){return h.pos-g.pos}function jZ(l,j,i){for(var k,h=0,g=l.length;g>h;){k=h+g>>>1,i(l[k],j)<0?h=k+1:g=k}return h}function dM(i,g,j){var h=jZ(i,g,j);i.splice(h,0,g)}function eM(g,h){for(var m,i,k=h,l=g.length;l>k;k++){var j=g[k],n=[j.id,j.opts,[]];i?(i[2].push(n),i=n):m=i=n}return m}function cU(h,g){return h[0]<g[0]?-1:1}function b7(i,k){for(var g=[{tree1:i,tree2:k}],m=!1;g.length>0;){var o=g.pop(),h=o.tree1,j=o.tree2;(h[1].status||j[1].status)&&(h[1].status="available"===h[1].status||"available"===j[1].status?"available":"missing");for(var l=0;l<j[2].length;l++){if(h[2][0]){for(var p=!1,n=0;n<h[2].length;n++){h[2][n][0]===j[2][l][0]&&(g.push({tree1:h[2][n],tree2:j[2][l]}),p=!0)}p||(m="new_branch",dM(h[2],j[2][l],cU))}else{m="new_leaf",h[2][0]=j[2][l]}}}return{conflicts:m,tree:i}}function ap(p,u,o){var m,k=[],s=!1,r=!1;if(!p.length){return{tree:[u],conflicts:"new_leaf"}}for(var w=0,j=p.length;j>w;w++){var n=p[w];if(n.pos===u.pos&&n.ids[0]===u.ids[0]){m=b7(n.ids,u.ids),k.push({pos:n.pos,ids:m.tree}),s=s||m.conflicts,r=!0}else{if(o!==!0){var z=n.pos<u.pos?n:u,q=n.pos<u.pos?u:n,A=q.pos-z.pos,v=[],i=[];for(i.push({ids:z.ids,diff:A,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],x=0,y=g.length;y>x;x++){i.push({ids:g[x],diff:h.diff-1,parent:h.ids,parentIdx:x})}}else{h.ids[0]===q.ids[0]&&v.push(h)}}var l=v[0];l?(m=b7(l.ids,q.ids),l.parent[2][l.parentIdx]=m.tree,k.push({pos:z.pos,ids:z.ids}),s=s||m.conflicts,r=!0):k.push(n)}else{k.push(n)}}}return r||k.push(u),k.sort(cH),{tree:k,conflicts:s||"internal_node"}}function aT(i,k){for(var g,m=jS(i),o=0,h=m.length;h>o;o++){var j=m[o],l=j.ids,p=Math.max(0,l.length-k),n={pos:j.pos+p,ids:eM(l,p)};g=g?ap(g,n,!0).tree:[n]}return g}function bS(i,g,j){var h=ap(i,g);return{tree:aT(h.tree,j),conflicts:h.conflicts}}function eV(i,k){for(var g,m=i.slice(),o=k.split("-"),h=parseInt(o[0],10),j=o[1];g=m.pop();){if(g.pos===h&&g.ids[0]===j){return !0}for(var l=g.ids[2],p=0,n=l.length;n>p;p++){m.push({pos:g.pos+1,ids:l[p]})}}return !1}function cV(A,w,n,j,m,u,r,h){if(eV(w.rev_tree,n.metadata.rev)){return j[m]=n,u()}var s=w.winningRev||ef(w),z="deleted" in w?w.deleted:ba(w,s),g="deleted" in n.metadata?n.metadata.deleted:ba(n.metadata),q=/^1-/.test(n.metadata.rev);if(z&&!g&&h&&q){var v=n.data;v._rev=s,v._id=n.metadata.id,n=bb(v,h)}var k=bS(w.rev_tree,n.metadata.rev_tree[0],A),i=h&&(z&&g||!z&&"new_leaf"!==k.conflicts||z&&!g&&"new_branch"===k.conflicts);if(i){var p=e8(bD);return j[m]=p,u()}var l=n.metadata.rev;n.metadata.rev_tree=k.tree,w.rev_map&&(n.metadata.rev_map=w.rev_map);var y,x=ef(n.metadata),B=ba(n.metadata,x),o=z===B?0:B>z?-1:1;y=l===x?B:ba(n.metadata,l),r(n,x,B,y,!0,o,m,u)}function d1(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function fO(n,g,u,m,o,i,v,k,q){function p(x,C,B){var w=ef(x.metadata),D=ba(x.metadata,w);if("was_delete" in k&&D){return i[C]=e8(cQ,"deleted"),B()}var A=r&&d1(x);if(A){var z=e8(bD);return i[C]=z,B()}var y=D?0:1;v(x,w,D,D,!1,y,C,B)}function j(){++l===s&&q&&q()}n=n||1000;var r=k.new_edits,h=new bG.Map,l=0,s=g.length;g.forEach(function(y,w){if(y._id&&aU(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void u[x](y,{ctx:o},function(B,A){i[w]=B||A,j()})}var z=y.metadata.id;h.has(z)?(s--,h.get(z).push([y,w])):h.set(z,[[y,w]])}),h.forEach(function(x,z){function y(){++w<x.length?A():j()}function A(){var C=x[w],D=C[0],E=C[1];if(m.has(z)){cV(n,m.get(z),D,i,E,y,v,r)}else{var B=bS([],D.metadata.rev_tree[0],n);D.metadata.rev_tree=B.tree,p(D,E,y)}}var w=0;A()})}function bA(h){var g=[];return jG(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function eQ(C,n,o,z,k,x,s){function g(){return A?s(A):(x.notify(z._name),z._docCount=-1,void s(null,w))}function u(E,D){var F="SELECT count(*) as cnt FROM "+eG+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=e8(eE,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function j(F){function D(){++G===H.length&&F(E)}var H=[];if(v.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){u(I,function(J){J&&!E&&(E=J),D()})})}function B(N,J,Q,M,H,S,L,G){function P(){function Y(a0,ao){function ai(){return ++at===a1.length&&ao(),!1}function an(a2){var a3="INSERT INTO "+bN+" (digest, seq) VALUES (?,?)",a4=[Z._attachments[a2].digest,a0];p.executeSql(a3,a4,ai,ai)}var at=0,a1=Object.keys(Z._attachments||{});if(!a1.length){return ao()}for(var ar=0;ar<a1.length;ar++){an(a1[ar])}}var Z=N.data,V=M?1:0,U=Z._id,W=Z._rev,T=jP(Z),ae="INSERT INTO "+jw+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",X=[U,W,T,V];p.executeSql(ae,X,function(an,ai){var ao=ai.insertId;Y(ao,function(){K(an,ao)})},function(){var ai=ad("seq",jw,null,"doc_id=? AND rev=?");return p.executeSql(ai,[U,W],function(ar,ao){var at=ao.rows.item(0).seq,a0="UPDATE "+jw+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",an=[T,V,U,W];ar.executeSql(a0,an,function(a1){Y(at,function(){K(a1,at)})})}),!1})}function I(T){F||(T?(F=T,G(F)):R===D.length&&P())}function E(T){R++,I(T)}function O(){if(H&&z.auto_compaction){var T=N.metadata.id,U=bA(N.metadata);eD(U,T,p)}}function K(V,T){O(),N.metadata.seq=T,delete N.metadata.rev;var X=H?"UPDATE "+db+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+jw+" WHERE doc_id="+db+".id AND rev=?) WHERE id=?":"INSERT INTO "+db+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Y=eb(N.metadata),U=N.metadata.id,W=H?[Y,T,J,U]:[U,T,T,Y];V.executeSql(X,W,function(){w[L]={ok:!0,id:N.metadata.id,rev:J},r.set(U,N.metadata),G()})}var F=null,R=0;N.data._id=N.metadata.id,N.data._rev=N.metadata.rev;var D=Object.keys(N.data._attachments||{});M&&(N.data._deleted=!0),D.forEach(function(T){var U=N.data._attachments[T];if(U.stub){R++,I()}else{var V=U.data;delete U.data;var W=U.digest;i(W,V,E)}}),D.length||P()}function q(){fO(C.revs_limit,v,z,r,p,w,B,o)}function y(E){function D(){++F===v.length&&E()}if(!v.length){return E()}var F=0;v.forEach(function(G){if(G._id&&aU(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+db+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=bW(I.rows.item(0).json);r.set(H,K)}D()})})}function i(F,D,G){var E="SELECT digest FROM "+eG+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+eG+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,cd(D)],function(){G()},function(){return G(),!1}))})}var l=o.new_edits,m=n.docs,v=m.map(function(E){if(E._id&&aU(E._id)){return E}var D=bb(E,l);return D}),h=v.filter(function(D){return D.error});if(h.length){return s(h[0])}var p,A,w=new Array(v.length),r=new bG.Map;aE(v,"binary",function(D){return D?s(D):void k.transaction(function(E){p=E,j(function(F){F?A=F:y(q)})},bi(s),g)})}function aA(n,h,m,k,l){function g(){++o===j.length&&l&&l()}function i(q,s){var r=q._attachments[s],p={binary:h.binary,ctx:k};m._getAttachment(r,p,function(u,v){q._attachments[s]=dd.extend(jB(r,["digest","content_type"]),{data:v}),g()})}var j=Object.keys(n._attachments||{});if(!j.length){return l&&l()}var o=0;j.forEach(function(p){h.attachments&&h.include_docs?i(n,p):(n._attachments[p].stub=!0,g())})}function e3(u,l){function o(){jp()&&(window.localStorage["_pouch__websqldb_"+h._name]=!0),l(null,h)}function z(E,D){E.executeSql(fE),E.executeSql("ALTER TABLE "+jw+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){E.executeSql(cb),E.executeSql("ALTER TABLE "+db+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){E.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+db+" (local, id)");var F="SELECT "+db+".winningseq AS seq, "+db+".json AS metadata FROM "+jw+" JOIN "+db+" ON "+jw+".seq = "+db+".winningseq";E.executeSql(F,[],function(N,K){for(var L=[],I=[],H=0;H<K.rows.length;H++){var M=K.rows.item(H),J=M.seq,G=JSON.parse(M.metadata);ba(G)&&L.push(J),aU(G.id)&&I.push(G.id)}N.executeSql("UPDATE "+db+"SET local = 1 WHERE id IN "+a8(I.length),I,function(){N.executeSql("UPDATE "+jw+" SET deleted = 1 WHERE seq IN "+a8(L.length),L,D)})})})})}function k(E,D){var F="CREATE TABLE IF NOT EXISTS "+dV+" (id UNIQUE, rev, json)";E.executeSql(F,[],function(){var G="SELECT "+db+".id AS id, "+jw+".json AS data FROM "+jw+" JOIN "+db+" ON "+jw+".seq = "+db+".winningseq WHERE local = 1";E.executeSql(G,[],function(L,I){function K(){if(!H.length){return D(L)}var N=H.shift(),M=JSON.parse(N.data)._rev;L.executeSql("INSERT INTO "+dV+" (id, rev, json) VALUES (?,?,?)",[N.id,M,N.data],function(O){O.executeSql("DELETE FROM "+db+" WHERE id=?",[N.id],function(P){P.executeSql("DELETE FROM "+jw+" WHERE seq=?",[N.seq],function(){K()})})})}for(var H=[],J=0;J<I.rows.length;J++){H.push(I.rows.item(J))}K()})})}function B(F,D){function G(I){function H(){if(!I.length){return D(F)}var L=I.shift(),J=aq(L.hex,n),M=J.lastIndexOf("::"),K=J.substring(0,M),O=J.substring(M+2),N="UPDATE "+jw+" SET doc_id=?, rev=? WHERE doc_id_rev=?";F.executeSql(N,[K,O,J],function(){H()})}H()}var E="ALTER TABLE "+jw+" ADD COLUMN doc_id";F.executeSql(E,[],function(I){var H="ALTER TABLE "+jw+" ADD COLUMN rev";I.executeSql(H,[],function(J){J.executeSql(ju,[],function(L){var K="SELECT hex(doc_id_rev) as hex FROM "+jw;L.executeSql(K,[],function(O,M){for(var N=[],P=0;P<M.rows.length;P++){N.push(M.rows.item(P))}G(N)})})})})}function v(F,D){function G(H){var I="SELECT COUNT(*) AS cnt FROM "+eG;H.executeSql(I,[],function(K,M){function J(){var P=ad(cO+", "+db+".id AS id",[db,jw],dp,null,db+".id ");P+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(P,[],function(Z,T){function Q(ao,an){var ar=V[ao]=V[ao]||[];-1===ar.indexOf(an)&&ar.push(an)}if(!T.rows.length){return D(Z)}for(var V={},ai=0;ai<T.rows.length;ai++){for(var S=T.rows.item(ai),R=d0(S.data,S.id,S.rev),W=Object.keys(R._attachments||{}),X=0;X<W.length;X++){var U=R._attachments[W[X]];Q(U.digest,S.seq)}}var ae=[];if(Object.keys(V).forEach(function(ao){var an=V[ao];an.forEach(function(ar){ae.push([ao,ar])})}),!ae.length){return J()}var Y=0;ae.forEach(function(an){var ao="INSERT INTO "+bN+" (digest, seq) VALUES (?,?)";Z.executeSql(ao,an,function(){++Y===ae.length&&J()})})})}var L=M.rows.item(0).cnt;if(!L){return D(K)}var O=0,N=10;J()})}var E="CREATE TABLE IF NOT EXISTS "+bN+" (digest, seq INTEGER)";F.executeSql(E,[],function(H){H.executeSql(eW,[],function(I){I.executeSql(fP,[],G)})})}function g(E,D){var F="ALTER TABLE "+eG+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";E.executeSql(F,[],D)}function j(E,D){var F="ALTER TABLE "+db+" ADD COLUMN max_seq INTEGER";E.executeSql(F,[],function(G){var H="UPDATE "+db+" SET max_seq=(SELECT MAX(seq) FROM "+jw+" WHERE doc_id=id)";G.executeSql(H,[],function(J){var I="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+db+" (max_seq)";J.executeSql(I,[],D)})})}function x(E,D){E.executeSql('SELECT HEX("a") AS hex',[],function(G,H){var F=H.rows.item(0).hex;n=2===F.length?"UTF-8":"UTF-16",D()})}function m(){for(;p.length>0;){var D=p.pop();D(null,q)}}function y(E,N){if(0===N){var I="CREATE TABLE IF NOT EXISTS "+j0+" (dbid, db_version INTEGER)",G="CREATE TABLE IF NOT EXISTS "+eG+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",O="CREATE TABLE IF NOT EXISTS "+bN+" (digest, seq INTEGER)",F="CREATE TABLE IF NOT EXISTS "+db+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",D="CREATE TABLE IF NOT EXISTS "+jw+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",H="CREATE TABLE IF NOT EXISTS "+dV+" (id UNIQUE, rev, json)";E.executeSql(G),E.executeSql(H),E.executeSql(O,[],function(){E.executeSql(fP),E.executeSql(eW)}),E.executeSql(F,[],function(){E.executeSql(fE),E.executeSql(D,[],function(){E.executeSql(cb),E.executeSql(ju),E.executeSql(I,[],function(){var P="INSERT INTO "+j0+" (db_version, dbid) VALUES (?,?)";q=jn();var Q=[d8,q];E.executeSql(P,Q,function(){m()})})})})}else{var M=function(){var Q=d8>N;Q&&E.executeSql("UPDATE "+j0+" SET db_version = "+d8);var P="SELECT dbid FROM "+j0;E.executeSql(P,[],function(R,S){q=S.rows.item(0).dbid,m()})},J=[z,k,B,v,g,j,M],K=N,L=function(P){J[K-1](P,L),K++};L(E)}}function s(){r.transaction(function(D){x(D,function(){i(D)})},bi(l),o)}function i(E){var D="SELECT sql FROM sqlite_master WHERE tbl_name = "+j0;E.executeSql(D,[],function(G,F){F.rows.length?/db_version/.test(F.rows.item(0).sql)?G.executeSql("SELECT db_version FROM "+j0,[],function(J,I){var H=I.rows.item(0).db_version;y(J,H)}):G.executeSql("ALTER TABLE "+j0+" ADD COLUMN db_version INTEGER",[],function(){y(G,1)}):y(G,0)})}function C(E,D){if(-1!==h._docCount){return D(h._docCount)}var F=ad("COUNT("+db+".id) AS 'num'",[db,jw],dp,jw+".deleted=0");E.executeSql(F,[],function(G,H){h._docCount=H.rows.item(0).num,D(h._docCount)})}var n,h=this,q=null,w=bY(u),p=[];h._docCount=-1,h._name=u.name;var A=fI({name:h._name,version:dG,description:h._name,size:w,location:u.location,createFromLocation:u.createFromLocation,androidDatabaseImplementation:u.androidDatabaseImplementation});if(A.error){return bi(l)(A.error)}var r=A.db;"function"!=typeof r.readTransaction&&(r.readTransaction=r.transaction),s(),h.type=function(){return"websql"},h._id=jx(function(D){D(null,q)}),h._info=function(D){r.readTransaction(function(E){C(E,function(G){var F="SELECT MAX(seq) AS seq FROM "+jw;E.executeSql(F,[],function(I,J){var H=J.rows.item(0).seq||0;D(null,{doc_count:G,update_seq:H,sqlite_plugin:r._sqlitePlugin,websql_encoding:n})})})},bi(D))},h._bulkDocs=function(D,F,E){eQ(u,D,F,h,r,e3.Changes,E)},h._get=function(G,K,E){function L(){E(I,{doc:M,metadata:F,ctx:D})}var M,F,I,D=K.ctx;if(!D){return r.readTransaction(function(N){h._get(G,dd.extend({ctx:N},K),E)})}var J,H;K.rev?(J=ad(cO,[db,jw],db+".id="+jw+".doc_id",[jw+".doc_id=?",jw+".rev=?"]),H=[G,K.rev]):(J=ad(cO,[db,jw],dp,db+".id=?"),H=[G]),D.executeSql(J,H,function(N,O){if(!O.rows.length){return I=e8(cQ,"missing"),L()}var P=O.rows.item(0);return F=bW(P.metadata),P.deleted&&!K.rev?(I=e8(cQ,"deleted"),L()):(M=d0(P.data,F.id,P.rev),void L())})},h._allDocs=function(I,P){var M,H=[],J="startkey" in I?I.startkey:!1,E="endkey" in I?I.endkey:!1,N="key" in I?I.key:!1,Q="descending" in I?I.descending:!1,O="limit" in I?I.limit:-1,L="skip" in I?I.skip:0,G=I.inclusive_end!==!1,D=[],K=[];if(N!==!1){K.push(db+".id = ?"),D.push(N)}else{if(J!==!1||E!==!1){if(J!==!1&&(K.push(db+".id "+(Q?"<=":">=")+" ?"),D.push(J)),E!==!1){var F=Q?">":"<";G&&(F+="="),K.push(db+".id "+F+" ?"),D.push(E)}N!==!1&&(K.push(db+".id = ?"),D.push(N))}}"ok"!==I.deleted&&K.push(jw+".deleted = 0"),r.readTransaction(function(R){C(R,function(S){if(M=S,0!==O){var T=ad(cO,[db,jw],dp,K,db+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+O+" OFFSET "+L,R.executeSql(T,D,function(V,an){for(var ao=0,U=an.rows.length;U>ao;ao++){var Y=an.rows.item(ao),ai=bW(Y.metadata),Z=ai.id,X=d0(Y.data,Z,Y.rev),W=X._rev,ae={id:Z,key:Z,value:{rev:W}};if(I.include_docs&&(ae.doc=X,ae.doc._rev=W,I.conflicts&&(ae.doc._conflicts=jH(ai)),aA(ae.doc,I,h,V)),Y.deleted){if("ok"!==I.deleted){continue}ae.value.deleted=!0,ae.doc=null}H.push(ae)}})}})},bi(P),function(){P(null,{total_rows:M,offset:I.skip,rows:H})})},h._changes=function(D){function H(){var R=db+".json AS metadata, "+db+".max_seq AS maxSeq, "+jw+".json AS winningDoc, "+jw+".rev AS winningRev ",S=db+" JOIN "+jw,Q=db+".id="+jw+".doc_id AND "+db+".winningseq="+jw+".seq",P=["maxSeq > ?"],M=[D.since];D.doc_ids&&(P.push(db+".id IN "+a8(D.doc_ids.length)),M=M.concat(D.doc_ids));var T="maxSeq "+(K?"DESC":"ASC"),N=ad(R,S,Q,P,T),L=fC(D);D.view||D.filter||(N+=" LIMIT "+G);var O=D.since||0;r.readTransaction(function(U){U.executeSql(N,M,function(W,Y){function X(at){return function(){D.onChange(at)}}for(var V=0,ao=Y.rows.length;ao>V;V++){var ai=Y.rows.item(V),Z=bW(ai.metadata);O=ai.maxSeq;var an=d0(ai.winningDoc,Z.id,ai.winningRev),ar=D.processChange(an,Z,D);ar.seq=ai.maxSeq;var ae=L(ar);if("object"==typeof ae){return D.complete(ae)}if(ae&&(J++,F&&E.push(ar),D.attachments&&D.include_docs?aA(an,D,h,W,X(ar)):X(ar)()),J===G){break}}})},bi(D.complete),function(){D.continuous||D.complete(null,{results:E,last_seq:O})})}if(D=e6(D),D.continuous){var I=h._name+":"+jn();return e3.Changes.addListener(h._name,I,h,D),e3.Changes.notify(h._name),{cancel:function(){e3.Changes.removeListener(h._name,I)}}}var K=D.descending;D.since=D.since&&!K?D.since:0;var G="limit" in D?D.limit:-1;0===G&&(G=1);var F;F="return_docs" in D?D.return_docs:"returnDocs" in D?D.returnDocs:!0;var E=[],J=0;H()},h._close=function(D){D()},h._getAttachment=function(D,H,I){var K,G=H.ctx,F=D.digest,E=D.content_type,J="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+eG+" WHERE digest=?";G.executeSql(J,[F],function(L,M){var N=M.rows.item(0),O=N.escaped?bF(N.body):aq(N.body,n);K=H.binary?ds(O,E):bL(O),I(null,K)})},h._getRevisionTree=function(E,D){r.readTransaction(function(G){var F="SELECT json AS metadata FROM "+db+" WHERE id = ?";G.executeSql(F,[E],function(J,H){if(H.rows.length){var I=bW(H.rows.item(0).metadata);D(null,I.rev_tree)}else{D(e8(cQ))}})})},h._doCompaction=function(E,D,F){return D.length?void r.transaction(function(H){var G="SELECT json AS metadata FROM "+db+" WHERE id = ?";H.executeSql(G,[E],function(K,I){var J=bW(I.rows.item(0).metadata);jG(J.rev_tree,function(N,P,M,O,R){var Q=P+"-"+M;-1!==D.indexOf(Q)&&(R.status="missing")});var L="UPDATE "+db+" SET json = ? WHERE id = ?";K.executeSql(L,[eb(J),E])}),eD(D,E,H)},bi(F),function(){F()}):F()},h._getLocal=function(E,D){r.readTransaction(function(G){var F="SELECT json, rev FROM "+dV+" WHERE id=?";G.executeSql(F,[E],function(I,K){if(K.rows.length){var H=K.rows.item(0),J=d0(H.json,E,H.rev);D(null,J)}else{D(e8(cQ))}})})},h._putLocal=function(F,I,D){function K(M){var O,N;E?(O="UPDATE "+dV+" SET rev=?, json=? WHERE id=? AND rev=?",N=[L,H,G,E]):(O="INSERT INTO "+dV+" (id, rev, json) VALUES (?,?,?)",N=[G,L,H]),M.executeSql(O,N,function(Q,P){P.rowsAffected?(J={ok:!0,id:G,rev:L},I.ctx&&D(null,J)):D(e8(bD))},function(){return D(e8(bD)),!1})}"function"==typeof I&&(D=I,I={}),delete F._revisions;var L,E=F._rev,G=F._id;L=E?F._rev="0-"+(parseInt(E.split("-")[1],10)+1):F._rev="0-1";var J,H=jP(F);I.ctx?K(I.ctx):r.transaction(K,bi(D),function(){J&&D(null,J)})},h._removeLocal=function(F,D,H){function E(J){var I="DELETE FROM "+dV+" WHERE id=? AND rev=?",K=[F._id,F._rev];J.executeSql(I,K,function(L,M){return M.rowsAffected?(G={ok:!0,id:F._id,rev:"0-0"},void (D.ctx&&H(null,G))):H(e8(cQ))})}"function"==typeof D&&(H=D,D={});var G;D.ctx?E(D.ctx):r.transaction(E,bi(H),function(){G&&H(null,G)})},h._destroy=function(E,D){e3.Changes.removeAllListeners(h._name),r.transaction(function(G){var F=[db,jw,eG,j0,dV,bN];F.forEach(function(H){G.executeSql("DROP TABLE IF EXISTS "+H,[])})},bi(D),function(){jp()&&(delete window.localStorage["_pouch__websqldb_"+h._name],delete window.localStorage[h._name]),D(null,{ok:!0})})}}function dz(i,g,j){try{i.apply(g,j)}catch(h){"undefined"!=typeof PouchDB&&PouchDB.emit("error",h)}}function b4(){if(!bx.running&&bx.queue.length){bx.running=!0;var g=bx.queue.shift();g.action(function(h,i){dz(g.callback,this,[h,i]),bx.running=!1,dF.nextTick(b4)})}}function ah(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(e8(cu,i,h.type))}}function jt(h,g,i){return{data:eb(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function cL(h){if(!h){return null}var g=bW(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function bZ(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function jN(i,g,j,h){j?h(i?"string"!=typeof i?i:cI(i,g):aX([""],{type:g})):i?"string"!=typeof i?fD(i,function(k){h(bL(k))}):h(i):h("")}function jT(g,h,m,i){function k(){++n===j.length&&i&&i()}function l(s,q){var r=s._attachments[q],p=r.digest,o=m.objectStore(dh).get(p);o.onsuccess=function(u){r.body=u.target.result.body,k()}}var j=Object.keys(g._attachments||{});if(!j.length){return i&&i()}var n=0;j.forEach(function(o){h.attachments&&h.include_docs?l(g,o):(g._attachments[o].stub=!0,k())})}function cM(h,g){return cF.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return cF.all(j.map(function(n){var l=i.doc._attachments[n];if("body" in l){var m=l.body,k=l.content_type;return new cF(function(o){jN(m,k,g,function(p){i.doc._attachments[n]=dd.extend(jB(l,["digest","content_type"]),{data:p}),o()})})}}))}}))}function eN(i,k,g){function m(){n--,n||o()}function o(){h.length&&h.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||l["delete"](q)}})}var h=[],j=g.objectStore(ep),l=g.objectStore(dh),p=g.objectStore(da),n=i.length;i.forEach(function(s){var r=j.index("_doc_id_rev"),q=k+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return m()}j["delete"](u);var w=p.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];h.push(x),p["delete"](y.primaryKey),y["continue"]()}else{m()}}}})}function aJ(i,g,j){try{return{txn:i.transaction(g,j)}}catch(h){return{error:h}}}function jM(x,M,E,m,y,q,O){function L(){var Q=[j2,ep,dh,dx,eR,da],P=aJ(y,Q,"readwrite");return P.error?O(P.error):(p=P.txn,p.onabort=ah(O),p.ontimeout=ah(O),p.oncomplete=i,H=p.objectStore(j2),I=p.objectStore(ep),o=p.objectStore(dh),F=p.objectStore(da),void g(function(R){return R?(j=!0,O(R)):void G()}))}function z(){fO(x.revs_limit,v,m,k,p,r,B,E)}function G(){function R(){++T===v.length&&z()}function P(W){var X=cL(W.target.result);X&&k.set(X.id,X),R()}if(v.length){for(var T=0,Q=0,S=v.length;S>Q;Q++){var V=v[Q];if(V._id&&aU(V._id)){R()}else{var U=H.get(V.metadata.id);U.onsuccess=P}}}}function i(){j||(q.notify(m._meta.name),m._meta.docCount+=C,O(null,r))}function N(Q,P){var R=o.get(Q);R.onsuccess=function(T){if(T.target.result){P()}else{var S=e8(eE,"unknown stub attachment with digest "+Q);S.status=412,P(S)}}}function g(R){function P(){++S===T.length&&R(Q)}var T=[];if(v.forEach(function(U){U.data&&U.data._attachments&&Object.keys(U.data._attachments).forEach(function(W){var V=U.data._attachments[W];V.stub&&T.push(V.digest)})}),!T.length){return R()}var Q,S=0;T.forEach(function(U){N(U,function(V){V&&!Q&&(Q=V),P()})})}function B(V,P,T,R,S,U,X,Q){C+=U,V.metadata.winningRev=P,V.metadata.deleted=T;var Y=V.data;Y._id=V.metadata.id,Y._rev=V.metadata.rev,R&&(Y._deleted=!0);var W=Y._attachments&&Object.keys(Y._attachments).length;return W?w(V,P,T,S,X,Q):void s(V,P,T,S,X,Q)}function K(Q){var P=bA(Q.metadata);eN(P,Q.metadata.id,p)}function s(X,Q,T,S,V,ae){function R(an){S&&m.auto_compaction&&K(X),U.seq=an.target.result,delete U.rev;var ai=jt(U,Q,T),ao=H.put(ai);ao.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ao=I.index("_doc_id_rev"),an=ao.getKey(W._doc_id_rev);an.onsuccess=function(at){var ar=I.put(W,at.target.result);ar.onsuccess=R}}function Z(){r[V]={ok:!0,id:U.id,rev:Q},k.set(X.metadata.id,X.metadata),A(X,U.seq,ae)}var W=X.data,U=X.metadata;W._doc_id_rev=U.id+"::"+U.rev,delete W._id,delete W._rev;var Y=I.put(W);Y.onsuccess=R,Y.onerror=P}function w(X,Q,U,S,T,V){function Z(){Y===W.length&&s(X,Q,U,S,T,V)}function R(){Y++,Z()}var P=X.data,Y=0,W=Object.keys(P._attachments);W.forEach(function(ae){var an=X.data._attachments[ae];if(an.stub){Y++,Z()}else{var ao=an.data;delete an.data;var ai=an.digest;h(ai,ao,R)}})}function A(S,P,U){function R(){++W===V.length&&U()}function T(Z){var Y=S.data._attachments[Z].digest,X=F.put({seq:P,digestSeq:Y+"::"+P});X.onsuccess=R,X.onerror=function(ae){ae.preventDefault(),ae.stopPropagation(),R()}}var W=0,V=Object.keys(S.data._attachments||{});if(!V.length){return U()}for(var Q=0;Q<V.length;Q++){T(V[Q])}}function h(R,P,S){var Q=o.count(R);Q.onsuccess=function(W){var T=W.target.result;if(T){return S()}var V={digest:R,body:P},U=o.put(V);U.onsuccess=S}}for(var p,H,I,o,F,D,v=M.docs,C=0,n=0,J=v.length;J>n;n++){var l=v[n];l._id&&aU(l._id)||(l=v[n]=bb(l,E.new_edits),l.error&&!D&&(D=l))}if(D){return O(D)}var r=new Array(v.length),k=new bG.Map,j=!1,u=m._meta.blobSupport?"blob":"base64";aE(v,u,function(P){return P?O(P):void L()})}function eX(l,j,i,k,h){try{if(l&&j){return h?IDBKeyRange.bound(j,l,!i,!1):IDBKeyRange.bound(l,j,!1,!i)}if(l){return h?IDBKeyRange.upperBound(l):IDBKeyRange.lowerBound(l)}if(j){return h?IDBKeyRange.lowerBound(j,!i):IDBKeyRange.upperBound(j,!i)}if(k){return IDBKeyRange.only(k)}}catch(g){return{error:g}}return null}function c9(i,g,j,h){return"DataError"===j.name&&0===j.code?h(null,{total_rows:i._meta.docCount,offset:g.skip,rows:[]}):void h(e8(cu,j.name,j.message))}function jA(l,j,i,k){function h(E,r){function z(L,O,M){var N=L.id+"::"+M;p.get(N).onsuccess=function(P){O.doc=bZ(P.target.result),E.conflicts&&(O.doc._conflicts=jH(L)),jT(O.doc,E,D)}}function v(M,O,N){var L={id:N.id,key:N.id,value:{rev:O}},P=N.deleted;if("ok"===E.deleted){w.push(L),P?(L.value.deleted=!0,L.doc=null):E.include_docs&&z(N,L,O)}else{if(!P&&H--<=0&&(w.push(L),E.include_docs&&z(N,L,O),0===--C)){return}}M["continue"]()}function q(M){K=j._meta.docCount;var O=M.target.result;if(O){var L=cL(O.value),N=L.winningRev;v(O,N,L)}}function F(){r(null,{total_rows:K,offset:E.skip,rows:w})}function A(){E.attachments?cM(w,E.binary).then(F):F()}var J="startkey" in E?E.startkey:!1,I="endkey" in E?E.endkey:!1,B="key" in E?E.key:!1,H=E.skip||0,C="number"==typeof E.limit?E.limit:-1,s=E.inclusive_end!==!1,o="descending" in E&&E.descending?"prev":null,G=eX(J,I,s,B,o);if(G&&G.error){return c9(j,E,G.error,r)}var y=[j2,ep];E.attachments&&y.push(dh);var u=aJ(i,y,"readonly");if(u.error){return r(u.error)}var D=u.txn,x=D.objectStore(j2),n=D.objectStore(ep),m=o?x.openCursor(G,o):x.openCursor(G),p=n.index("_doc_id_rev"),w=[],K=0;D.oncomplete=A,m.onsuccess=q}function g(m,n){return 0===m.limit?n(null,{total_rows:j._meta.docCount,offset:m.skip,rows:[]}):void h(m,n)}g(l,k)}function ec(g){return new cF(function(h){var i=aX([""]);g.objectStore(eF).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function ay(h,g){var i=this;bx.queue.push({action:function(j){ak(i,h,j)},callback:g}),b4()}function ak(p,m,u){function h(w){var v=w.createObjectStore(j2,{keyPath:"id"});w.createObjectStore(ep,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),w.createObjectStore(dh,{keyPath:"digest"}),w.createObjectStore(dx,{keyPath:"id",autoIncrement:!1}),w.createObjectStore(eF),v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),w.createObjectStore(eR,{keyPath:"_id"});var x=w.createObjectStore(da,{autoIncrement:!0});x.createIndex("seq","seq"),x.createIndex("digestSeq","digestSeq",{unique:!0})}function j(w,v){var x=w.objectStore(j2);x.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=ba(y);y.deletedOrLocal=A?"1":"0",x.put(y),B["continue"]()}else{v()}}}function s(v){v.createObjectStore(eR,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function l(y,z){var w=y.objectStore(eR),x=y.objectStore(j2),v=y.objectStore(ep),A=x.openCursor();A.onsuccess=function(H){var E=H.target.result;if(E){var K=E.value,B=K.id,M=aU(B),J=ef(K);if(M){var G=B+"::"+J,D=B+"::",I=B+"::~",F=v.index("_doc_id_rev"),C=IDBKeyRange.bound(D,I,!1,!1),L=F.openCursor(C);L.onsuccess=function(N){if(L=N.target.result){var O=L.value;O._doc_id_rev===G&&w.put(O),v["delete"](L.primaryKey),L["continue"]()}else{x["delete"](E.primaryKey),E["continue"]()}}}else{E["continue"]()}}else{z&&z()}}}function i(w){var v=w.createObjectStore(da,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function q(y,z){var w=y.objectStore(ep),x=y.objectStore(dh),v=y.objectStore(da),A=x.count();A.onsuccess=function(B){var C=B.target.result;return C?void (w.openCursor().onsuccess=function(D){var J=D.target.result;if(!J){return z()}for(var I=J.value,L=J.primaryKey,F=Object.keys(I._attachments||{}),H={},G=0;G<F.length;G++){var E=I._attachments[F[G]];H[E.digest]=!0}var M=Object.keys(H);for(G=0;G<M.length;G++){var K=M[G];v.put({seq:L,digestSeq:K+"::"+L})}J["continue"]()}):z()}}function o(w){function y(A){return A.data?cL(A):(A.deleted="1"===A.deletedOrLocal,A)}var z=w.objectStore(ep),v=w.objectStore(j2),x=v.openCursor();x.onsuccess=function(C){function B(){var H=A.id+"::",F=A.id+"::￿",G=z.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,E()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function E(){var G=jt(A,A.winningRev,A.deleted),F=v.put(G);F.onsuccess=function(){D["continue"]()}}var D=C.target.result;if(D){var A=y(D.value);return A.winningRev=A.winningRev||ef(A),A.seq?E():void B()}}}var g=m.name,n=null;p._meta=null,p.type=function(){return"idb"},p._id=jx(function(v){v(null,p._meta.instanceId)}),p._bulkDocs=function(x,v,w){jM(m,x,v,p,n,ay.Changes,w)},p._get=function(y,C,x){function v(){x(z,{doc:w,metadata:B,ctx:D})}var w,B,z,D=C.ctx;if(!D){var A=aJ(n,[j2,ep,dh],"readonly");if(A.error){return x(A.error)}D=A.txn}D.objectStore(j2).get(y).onsuccess=function(E){if(B=cL(E.target.result),!B){return z=e8(cQ,"missing"),v()}if(ba(B)&&!C.rev){return z=e8(cQ,"deleted"),v()}var G=D.objectStore(ep),H=C.rev||B.winningRev,F=B.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return w=I.target.result,w&&(w=bZ(w)),w?void v():(z=e8(cQ,"missing"),v())}}},p._getAttachment=function(w,y,A){var z;if(y.ctx){z=y.ctx}else{var B=aJ(n,[j2,ep,dh],"readonly");if(B.error){return A(B.error)}z=B.txn}var x=w.digest,v=w.content_type;z.objectStore(dh).get(x).onsuccess=function(C){var D=C.target.result.body;jN(D,v,y.binary,function(E){A(null,E)})}},p._info=function(y){if(null===n||!d7[g]){var z=new Error("db isn't open");return z.id="idbNull",y(z)}var A,B,x=aJ(n,[ep],"readonly");if(x.error){return y(x.error)}var v=x.txn,w=v.objectStore(ep).openCursor(null,"prev");w.onsuccess=function(D){var C=D.target.result;A=C?C.key:0,B=p._meta.docCount},v.oncomplete=function(){y(null,{doc_count:B,update_seq:A,idb_attachment_format:p._meta.blobSupport?"binary":"base64"})}},p._allDocs=function(v,w){jA(v,p,n,w)},p._changes=function(B){function v(Q){function T(){return N.seq!==O?Q["continue"]():(I=O,N.winningRev===P._rev?S(P):void R())}function R(){var U=P._id+"::"+N.winningRev,V=M.get(U);V.onsuccess=function(W){S(bZ(W.target.result))}}function S(V){var W=B.processChange(V,N,B);W.seq=N.seq;var U=A(W);return"object"==typeof U?B.complete(U):(U&&(F++,L&&E.push(W),B.attachments&&B.include_docs?jT(V,B,C,function(){cM([W],B.binary).then(function(){B.onChange(W)})}):B.onChange(W)),void (F!==G&&Q["continue"]()))}var P=bZ(Q.value),O=Q.key;if(z&&!z.has(P._id)){return Q["continue"]()}var N;return(N=y.get(P._id))?T():void (w.get(P._id).onsuccess=function(U){N=cL(U.target.result),y.set(P._id,N),T()})}function H(N){var O=N.target.result;O&&v(O)}function x(){var P=[j2,ep];B.attachments&&P.push(dh);var O=aJ(n,P,"readonly");if(O.error){return B.complete(O.error)}C=O.txn,C.onabort=ah(B.complete),C.oncomplete=D,K=C.objectStore(ep),w=C.objectStore(j2),M=K.index("_doc_id_rev");var N;N=B.descending?K.openCursor(null,"prev"):K.openCursor(IDBKeyRange.lowerBound(B.since,!0)),N.onsuccess=H}function D(){function N(){B.complete(null,{results:E,last_seq:I})}!B.continuous&&B.attachments?cM(E).then(N):N()}if(B=e6(B),B.continuous){var J=g+":"+jn();return ay.Changes.addListener(g,J,p,B),ay.Changes.notify(g),{cancel:function(){ay.Changes.removeListener(g,J)}}}var z=B.doc_ids&&new bG.Set(B.doc_ids);B.since=B.since||0;var I=B.since,G="limit" in B?B.limit:-1;0===G&&(G=1);var L;L="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var C,K,w,M,E=[],F=0,A=fC(B),y=new bG.Map;x()},p._close=function(v){return null===n?v(e8(df)):(n.close(),delete d7[g],n=null,void v())},p._getRevisionTree=function(w,y){var z=aJ(n,[j2],"readonly");if(z.error){return y(z.error)}var v=z.txn,x=v.objectStore(j2).get(w);x.onsuccess=function(B){var A=cL(B.target.result);A?y(null,A.rev_tree):y(e8(cQ))}},p._doCompaction=function(w,y,A){var z=[j2,ep,dh,da],B=aJ(n,z,"readwrite");if(B.error){return A(B.error)}var x=B.txn,v=x.objectStore(j2);v.get(w).onsuccess=function(E){var C=cL(E.target.result);jG(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==y.indexOf(I)&&(J.status="missing")}),eN(y,w,x);var D=C.winningRev,F=C.deleted;x.objectStore(j2).put(jt(C,D,F))},x.onabort=ah(A),x.oncomplete=function(){A()}},p._getLocal=function(w,y){var z=aJ(n,[eR],"readonly");if(z.error){return y(z.error)}var v=z.txn,x=v.objectStore(eR).get(w);x.onerror=ah(y),x.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,y(null,A)):y(e8(cQ))}},p._putLocal=function(E,z,D){"function"==typeof z&&(D=z,z={}),delete E._revisions;var B=E._rev,C=E._id;B?E._rev="0-"+(parseInt(B.split("-")[1],10)+1):E._rev="0-1";var x,w=z.ctx;if(!w){var A=aJ(n,[eR],"readwrite");if(A.error){return D(A.error)}w=A.txn,w.onerror=ah(D),w.oncomplete=function(){x&&D(null,x)}}var y,v=w.objectStore(eR);B?(y=v.get(C),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===B){var F=v.put(E);F.onsuccess=function(){x={ok:!0,id:E._id,rev:E._rev},z.ctx&&D(null,x)}}else{D(e8(bD))}}):(y=v.add(E),y.onerror=function(F){D(e8(bD)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){x={ok:!0,id:E._id,rev:E._rev},z.ctx&&D(null,x)})},p._removeLocal=function(y,C,x){"function"==typeof C&&(x=C,C={});var v=C.ctx;if(!v){var w=aJ(n,[eR],"readwrite");if(w.error){return x(w.error)}v=w.txn,v.oncomplete=function(){B&&x(null,B)}}var B,z=y._id,D=v.objectStore(eR),A=D.get(z);A.onerror=ah(x),A.onsuccess=function(F){var E=F.target.result;E&&E._rev===y._rev?(D["delete"](z),B={ok:!0,id:z,rev:"0-0"},C.ctx&&x(null,B)):x(e8(cQ))}},p._destroy=function(w,v){ay.Changes.removeAllListeners(g),ay.openReqList[g]&&ay.openReqList[g].result&&(ay.openReqList[g].result.close(),delete d7[g]);var x=indexedDB.deleteDatabase(g);x.onsuccess=function(){ay.openReqList[g]&&(ay.openReqList[g]=null),jp()&&g in localStorage&&delete localStorage[g],v(null,{ok:!0})},x.onerror=ah(v)};var k=d7[g];if(k){return n=k.idb,p._meta=k.global,void dF.nextTick(function(){u(null,p)})}var r;r=m.storage?ca(g,m.storage):indexedDB.open(g,eC),"openReqList" in ay||(ay.openReqList={}),ay.openReqList[g]=r,r.onupgradeneeded=function(y){function w(){var B=v[A-1];A++,B&&B(x,w)}var z=y.target.result;if(y.oldVersion<1){return h(z)}var x=y.currentTarget.transaction;y.oldVersion<3&&s(z),y.oldVersion<4&&i(z);var v=[j,l,q,o],A=y.oldVersion;w()},r.onsuccess=function(x){n=x.target.result,n.onversionchange=function(){n.close(),delete d7[g]},n.onabort=function(B){console.error("Database has a global failure",B.target.error),n.close(),delete d7[g]};var w=n.transaction([dx,eF,j2],"readwrite"),v=w.objectStore(dx).get(dx),z=null,y=null,A=null;v.onsuccess=function(D){var B=function(){null!==z&&null!==y&&null!==A&&(p._meta={name:g,instanceId:A,blobSupport:z,docCount:y},d7[g]={idb:n,global:p._meta},u(null,p))},E=D.target.result||{id:dx};g+"_id" in E?(A=E[g+"_id"],B()):(A=jn(),E[g+"_id"]=A,w.objectStore(dx).put(E).onsuccess=function(){B()}),du||(du=ec(w)),du.then(function(F){z=F,B()});var C=w.objectStore(j2).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){y=F.target.result,B()}}},r.onerror=function(w){var v="Failed to open indexedDB, are you in private browsing mode?";console.error(v),u(e8(cu,v))}}function ca(h,g){try{return indexedDB.open(h,{version:eC,storage:g})}catch(i){return indexedDB.open(h,eC)}}var dd=d(7),dl="default" in dd?dd["default"]:dd,aQ=d(6);aQ="default" in aQ?aQ["default"]:aQ;var bG=d(12);bG="default" in bG?bG["default"]:bG;var fJ=d(4),jv=d(1);jv="default" in jv?jv["default"]:jv;var c2=d(2);c2="default" in c2?c2["default"]:c2;var bT=d(10),fL="default" in bT?bT["default"]:bT,c3=d(8);c3="default" in c3?c3["default"]:c3;var b1=d(14);b1="default" in b1?b1["default"]:b1;var a9=d(15);a9="default" in a9?a9["default"]:a9;var aD=d(16);aD="default" in aD?aD["default"]:aD;var cF="function"==typeof Promise?Promise:c3,dB=jo();aQ(b6,Error),b6.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var cC=new b6({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),aS=new b6({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),cQ=new b6({status:404,error:"not_found",reason:"missing"}),bD=new b6({status:409,error:"conflict",reason:"Document update conflict"}),eT=new b6({status:400,error:"invalid_id",reason:"_id field must contain a string"}),jq=new b6({status:412,error:"missing_id",reason:"_id is required for puts"}),eZ=new b6({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),df=new b6({status:412,error:"precondition_failed",reason:"Database not open"}),cm=new b6({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),aZ=new b6({status:500,error:"badarg",reason:"Some query argument is invalid"}),e2=new b6({status:400,error:"invalid_request",reason:"Request was invalid"}),ab=new b6({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),cw=new b6({status:500,error:"doc_validation",reason:"Bad special document member"}),jm=new b6({status:400,error:"bad_request",reason:"Something wrong with the request"}),j1=new b6({status:400,error:"bad_request",reason:"Document must be a JSON object"}),c7=new b6({status:404,error:"not_found",reason:"Database not found"}),cu=new b6({status:500,error:"indexed_db_went_bad",reason:"unknown"}),aI=new b6({status:500,error:"web_sql_went_bad",reason:"unknown"}),dW=new b6({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),cJ=new b6({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),e9=new b6({status:400,error:"bad_request",reason:"Invalid rev format"}),el=new b6({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),eE=new b6({status:412,error:"missing_stub"}),jX=new b6({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),ck={UNAUTHORIZED:cC,MISSING_BULK_DOCS:aS,MISSING_DOC:cQ,REV_CONFLICT:bD,INVALID_ID:eT,MISSING_ID:jq,RESERVED_ID:eZ,NOT_OPEN:df,UNKNOWN_ERROR:cm,BAD_ARG:aZ,INVALID_REQUEST:e2,QUERY_PARSE_ERROR:ab,DOC_VALIDATION:cw,BAD_REQUEST:jm,NOT_AN_OBJECT:j1,DB_MISSING:c7,WSQ_ERROR:aI,LDB_ERROR:dW,FORBIDDEN:cJ,INVALID_REV:e9,FILE_EXISTS:el,MISSING_STUB:eE,IDB_ERROR:cu,INVALID_URL:jX},c1=function(k,i,h){var j=Object.keys(ck).filter(function(m){var l=ck[m];return"function"!=typeof l&&l[k]===i}),g=h&&j.filter(function(m){var l=ck[m];return l.message===h})[0]||j[0];return g?ck[g]:null},ac=function(){},jE=c2("pouchdb:api");aQ(jW,fJ.EventEmitter),jW.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},jW.prototype.doChanges=function(k){var i=this,h=k.complete;if(k=e6(k),"live" in k&&!("continuous" in k)&&(k.continuous=k.live),k.processChange=bj,"latest"===k.since&&(k.since="now"),k.since||(k.since=0),"now"===k.since){return void this.db.info().then(function(l){return i.isCancelled?void h(null,{status:"cancelled"}):(k.since=l.update_seq,void i.doChanges(k))},h)}if(k.continuous&&"now"!==k.since&&this.db.info().then(function(l){i.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),k.filter&&"string"==typeof k.filter&&("_view"===k.filter?k.view=jR(k.view):k.filter=jR(k.filter),"http"!==this.db.type()&&!k.doc_ids)){return this.filterChanges(k)}"descending" in k||(k.descending=!1),k.limit=0===k.limit?1:k.limit,k.complete=h;var j=this.db._changes(k);if(j&&"function"==typeof j.cancel){var g=i.cancel;i.cancel=jv(function(l){j.cancel(),g.apply(this,l)})}},jW.prototype.filterChanges=function(l){var j=this,i=l.complete;if("_view"===l.filter){if(!l.view||"string"!=typeof l.view){var k=e8(jm,"`view` filter parameter not found or invalid.");return i(k)}var h=jD(l.view);this.db.get("_design/"+h[0],function(m,o){if(j.isCancelled){return i(null,{status:"cancelled"})}if(m){return i(bw(m))}var n=o&&o.views&&o.views[h[1]]&&o.views[h[1]].map;return n?(l.filter=bH(n),void j.doChanges(l)):i(e8(cQ,o.views?"missing json key: "+h[1]:"missing json key: views"))})}else{var g=jD(l.filter);if(!g){return j.doChanges(l)}this.db.get("_design/"+g[0],function(n,o){if(j.isCancelled){return i(null,{status:"cancelled"})}if(n){return i(bw(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(l.filter=aR(m),void j.doChanges(l)):i(e8(cQ,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}};var cz="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),cN=fG(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cA=fG(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);aQ(cG,fJ.EventEmitter),cG.prototype.post=b0("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(e8(j1)):void this.bulkDocs({docs:[h]},g,bP(i))}),cG.prototype.put=b0("put",jv(function(i){var l,g,m,j,k=i.shift(),h="_id" in k;if("object"!=typeof k||Array.isArray(k)){return(j=i.pop())(e8(j1))}for(;;){if(l=i.shift(),g=typeof l,"string"!==g||h?"string"!==g||!h||"_rev" in k?"object"===g?m=l:"function"===g&&(j=l):k._rev=l:(k._id=l,h=!0),!i.length){break}}return m=m||{},jU(k._id),aU(k._id)&&"function"==typeof this._putLocal?k._deleted?this._removeLocal(k,j):this._putLocal(k,j):void this.bulkDocs({docs:[k]},m,bP(j))})),cG.prototype.putAttachment=b0("putAttachment",function(g,h,m,i,k,l){function j(o){return o._attachments=o._attachments||{},o._attachments[h]={content_type:k,data:i},n.put(o)}var n=this;return"function"==typeof k&&(l=k,k=i,i=m,m=null),"undefined"==typeof k&&(k=i,i=m,m=null),n.get(g).then(function(o){if(o._rev!==m){throw e8(bD)}return j(o)},function(o){if(o.reason===cQ.message){return j({_id:g})}throw o})}),cG.prototype.removeAttachment=b0("removeAttachment",function(k,i,h,j){var g=this;g.get(k,function(m,l){return m?void j(m):l._rev!==h?void j(e8(bD)):l._attachments?(delete l._attachments[i],0===Object.keys(l._attachments).length&&delete l._attachments,void g.put(l,j)):j()})}),cG.prototype.remove=b0("remove",function(l,j,i,k){var h;"string"==typeof j?(h={_id:l,_rev:j},"function"==typeof i&&(k=i,i={})):(h=l,"function"==typeof j?(k=j,i={}):(k=i,i=j)),i=i||{},i.was_delete=!0;var g={_id:h._id,_rev:h._rev||i.rev};return g._deleted=!0,aU(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(h,k):void this.bulkDocs({docs:[g]},i,bP(k))}),cG.prototype.revsDiff=b0("revsDiff",function(g,h,m){function i(o,p){n.has(o)||n.set(o,{missing:[]}),n.get(o).missing.push(p)}function k(q,p){var o=g[q].slice(0);jG(p,function(r,x,w,s,v){var y=x+"-"+w,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==v.status&&i(q,y))}),o.forEach(function(r){i(q,r)})}"function"==typeof h&&(m=h,h={});var l=Object.keys(g);if(!l.length){return m(null,{})}var j=0,n=new bG.Map;l.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){n.set(o,{missing:g[o]})}else{if(q){return m(q)}k(o,p)}if(++j===l.length){var r={};return n.forEach(function(u,s){r[s]=u}),m(null,r)}})},this)}),cG.prototype.bulkGet=b0("bulkGet",function(h,g){dS(this,h,g)}),cG.prototype.compactDocument=b0("compactDocument",function(i,g,j){var h=this;this._getRevisionTree(i,function(l,o){if(l){return j(l)}var m=eS(o),k=[],n=[];Object.keys(m).forEach(function(p){m[p]>g&&k.push(p)}),jG(o,function(s,q,v,r,u){var p=q+"-"+v;"available"===u.status&&-1!==k.indexOf(p)&&n.push(p)}),h._doCompaction(i,n,j)})}),cG.prototype.compact=b0("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&d9(i)}),cG.prototype._compact=function(i,l){function g(n){h.push(j.compactDocument(n.id,0))}function m(o){var n=o.last_seq;cF.all(h).then(function(){return eU(j,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){l(null,{ok:!0})})["catch"](l)}var j=this,k={return_docs:!1,last_seq:i.last_seq||0},h=[];j.changes(k).on("change",g).on("complete",m).on("error",l)},cG.prototype.get=b0("get",function(g,h,m){function i(){var o=[],p=k.length;return p?void k.forEach(function(q){l.get(g,{rev:q,revs:h.revs,attachments:h.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||m(null,o)})}):m(null,o)}if("function"==typeof h&&(m=h,h={}),"string"!=typeof g){return m(e8(eT))}if(aU(g)&&"function"==typeof this._getLocal){return this._getLocal(g,m)}var k=[],l=this;if(!h.open_revs){return this._get(g,h,function(p,B){if(p){return m(p)}var x=B.doc,C=B.metadata,v=B.ctx;if(h.conflicts){var w=jH(C);w.length&&(x._conflicts=w)}if(ba(C,x._rev)&&(x._deleted=!0),h.revs||h.revs_info){var r=jS(C.rev_tree),A=bh(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(x._rev.split("-")[1])}),y=A.ids.map(function(D){return D.id}).indexOf(x._rev.split("-")[1])+1,u=A.ids.length-y;if(A.ids.splice(y,u),A.ids.reverse(),h.revs&&(x._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),h.revs_info){var o=A.pos+A.ids.length;x._revs_info=A.ids.map(function(D){return o--,{rev:o+"-"+D.id,status:D.opts.status}})}}if(h.attachments&&x._attachments){var q=x._attachments,s=Object.keys(q).length;if(0===s){return m(null,x)}Object.keys(q).forEach(function(D){this._getAttachment(q[D],{binary:h.binary,ctx:v},function(F,G){var E=x._attachments[D];E.data=G,delete E.stub,delete E.length,--s||m(null,x)})},l)}else{if(x._attachments){for(var z in x._attachments){x._attachments.hasOwnProperty(z)&&(x._attachments[z].stub=!0)}}m(null,x)}})}if("all"===h.open_revs){this._getRevisionTree(g,function(o,p){return o?m(o):(k=cc(p).map(function(q){return q.rev}),void i())})}else{if(!Array.isArray(h.open_revs)){return m(e8(cm,"function_clause"))}k=h.open_revs;for(var j=0;j<k.length;j++){var n=k[j];if("string"!=typeof n||!/^\d+-/.test(n)){return m(e8(e9))}}i()}}),cG.prototype.getAttachment=b0("getAttachment",function(k,i,h,j){var g=this;h instanceof Function&&(j=h,h={}),this._get(k,h,function(m,l){return m?j(m):l.doc._attachments&&l.doc._attachments[i]?(h.ctx=l.ctx,h.binary=!0,g._getAttachment(l.doc._attachments[i],h,j),void 0):j(e8(cQ))})}),cG.prototype.allDocs=b0("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(e8(ab,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return bd(this,h,g)}}return this._allDocs(h,g)}),cG.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new jW(this,h,g)},cG.prototype.close=b0("close",function(g){return this._closed=!0,this._close(g)}),cG.prototype.info=b0("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),cG.prototype.id=b0("id",function(g){return this._id(g)}),cG.prototype.bulkDocs=b0("bulkDocs",function(k,i,h){if("function"==typeof i&&(h=i,i={}),i=i||{},Array.isArray(k)&&(k={docs:k}),!k||!k.docs||!Array.isArray(k.docs)){return h(e8(aS))}for(var j=0;j<k.docs.length;++j){if("object"!=typeof k.docs[j]||Array.isArray(k.docs[j])){return h(e8(j1))}}var g;return k.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){g=g||eP(m)})}),g?h(e8(jm,g)):("new_edits" in i||("new_edits" in k?i.new_edits=k.new_edits:i.new_edits=!0),i.new_edits||"http"===this.type()||k.docs.sort(aO),aB(k.docs),this._bulkDocs(k,i,function(m,l){return m?h(m):(i.new_edits||(l=l.filter(function(n){return n.error})),void h(null,l))}))}),cG.prototype.registerDependentDatabase=b0("registerDependentDatabase",function(i,g){function j(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[i]?!1:(k.dependentDbs[i]=!0,k)}var h=new this.constructor(i,this.__opts);eU(this,"_local/_pouch_dependentDbs",j).then(function(){g(null,{db:h})})["catch"](g)}),cG.prototype.destroy=b0("destroy",function(k,i){function h(){j._destroy(k,function(l,m){return l?i(l):(j.emit("destroyed"),void i(null,m||{ok:!0}))})}"function"==typeof k&&(i=k,k={});var j=this,g="use_prefix" in j?j.use_prefix:!0;return"http"===j.type()?h():void j.get("_local/_pouch_dependentDbs",function(m,p){if(m){return 404!==m.status?i(m):h()}var n=p.dependentDbs,l=j.constructor,o=Object.keys(n).map(function(r){var q=g?r.replace(new RegExp("^"+l.prefix),""):r;return new l(q,j.__opts).destroy()});cF.all(o).then(h,i)})}),fH.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},fH.prototype.fail=function(g){this.failed=g,this.execute()},fH.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},fH.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},aQ(cS,cG),cS.debug=c2;var em;if(jI()){em=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),em=!!localStorage.getItem("_pouch_check_localstorage")}catch(dv){em=!1}}cS.adapters={},cS.preferredAdapters=[],cS.prefix="_pouch_";var af=new fJ.EventEmitter;e0(cS),cS.parseAdapter=function(g,h){var m,i,k=g.match(/([a-z\-]*):\/\/(.*)/);if(k){if(g=/http(s?)/.test(k[1])?k[1]+"://"+k[2]:k[2],m=k[1],!cS.adapters[m].valid()){throw"Invalid adapter"}return{name:g,adapter:k[1]}}var l="idb" in cS.adapters&&"websql" in cS.adapters&&jp()&&localStorage["_pouch__websqldb_"+cS.prefix+g];if(h.adapter){i=h.adapter}else{if("undefined"!=typeof h&&h.db){i="leveldb"}else{for(var j=0;j<cS.preferredAdapters.length;++j){if(i=cS.preferredAdapters[j],i in cS.adapters){if(l&&"idb"===i){console.log('PouchDB is downgrading "'+g+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}m=cS.adapters[i];var n=m&&"use_prefix" in m?m.use_prefix:!0;return{name:n?cS.prefix+g:g,adapter:i}},cS.adapter=function(h,g,i){g.valid()&&(cS.adapters[h]=g,i&&cS.preferredAdapters.push(h))},cS.plugin=function(g){return Object.keys(g).forEach(function(h){cS.prototype[h]=g[h]}),cS},cS.defaults=function(h){function g(k,i,j){return this instanceof g?(("function"==typeof i||"undefined"==typeof i)&&(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=dd.extend({},h,i),void cS.call(this,k,i,j)):new g(k,i,j)}return aQ(g,cS),e0(g),g.preferredAdapters=cS.preferredAdapters.slice(),Object.keys(cS).forEach(function(i){i in g||(g[i]=cS[i])}),g};var ax=function(g){return atob(g)},bL=function(g){return btoa(g)},bm=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],bU="queryKey",cp=/(?:^|&)([^&=]*)=?([^&]*)/g,bQ=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bu=dl.extend,eA={ajax:cj,parseUri:c4,uuid:jn,Promise:cF,atob:ax,btoa:bL,binaryStringToBlobOrBuffer:ds,clone:e6,extend:bu,createError:e8},ej=fL.collate,cD=1,bK="pouchdb",d2=5,dg=0;jV.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},jV.prototype.updateTarget=function(h,g){return di(this.target,this.id,h,g,this.returnValue)},jV.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?cF.resolve(!0):di(this.src,this.id,h,g,this.returnValue)["catch"](function(k){var j="number"==typeof k.status&&4===Math.floor(k.status/100);if(j){return i.readOnlySource=!0,!0}throw k})};var b2={undefined:function(h,g){return 0===ej(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return cX(g,h).last_seq}};jV.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.src.get(g.id).then(function(i){if(h.version!==i.version){return dg}var j;return j=h.version?h.version.toString():"undefined",j in b2?b2[j](h,i):dg},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:dg}).then(function(){return dg},function(j){return 401===j.status?(g.readOnlySource=!0,h.last_seq):dg})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return dg})};var dU=0,cx=dY.setImmediate||dY.setTimeout,dI=32768,az=jx(function(i,k){function g(){var q=l*h,u=q+h;if(l++,j>l){n(p,i,q,u),cx(g)}else{n(p,i,q,u);var r=p.end(!0),s=dL(r);k(null,s),p.destroy()}}var m="string"==typeof i,o=m?i.length:i.byteLength,h=Math.min(dI,o),j=Math.ceil(o/h),l=0,p=m?new a9:new a9.ArrayBuffer,n=m?aP:c5;g()});aQ(cg,fJ.EventEmitter),cg.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},cg.prototype.ready=function(k,i){function h(){g.cancel()}function j(){k.removeListener("destroyed",h),i.removeListener("destroyed",h)}var g=this;g._readyCalled||(g._readyCalled=!0,k.once("destroyed",h),i.once("destroyed",h),g.once("complete",j))};var eB={replicate:bf,toPouch:dR},cZ=eB.replicate;aQ(d6,fJ.EventEmitter),d6.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var aV=25,eK=50,bq={},fQ=1800,dw=c2("pouchdb:http");dO.valid=function(){return !0};var cR=function(h,g){return g&&h.then(function(i){dF.nextTick(function(){g(null,i)})},function(i){dF.nextTick(function(){g(i)})}),h},dm=function(g){return jv(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&cR(i,j),i})},aK=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},dC=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},bM=function(l){for(var j={},i=0,k=l.length;k>i;i++){j["$"+l[i]]=!0}var h=Object.keys(j),g=new Array(h.length);for(i=0,k=h.length;k>i;i++){g[i]=h[i].substring(1)}return g},bE={uniq:bM,sequentialize:dC,fin:aK,callbackify:dm,promisedCallback:cR};bz.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},bz.prototype.finish=function(){return this.promise};var av,aG=fL.collate,e5=fL.toIndexableString,dJ=fL.normalizeKey,cv=fL.parseIndexableString;av="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var dD=bE.callbackify,eH=bE.sequentialize,eO=bE.uniq,bB=bE.fin,au=bE.promisedCallback,dT={},dZ=new bz,d3=50,e4={_sum:function(h,g){return dX(g)},_count:function(h,g){return g.length},_stats:function(h,g){function i(n){for(var l=0,k=0,m=n.length;m>k;k++){var j=n[k];l+=j*j}return l}return{sum:dX(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},jl=dD(function(){var g=this;return"http"===g.type()?cf(g):"function"==typeof g._viewCleanup?b8(g):e1(g)}),jy=function(k,i,h){"function"==typeof i&&(h=i,i={}),i=i?e(i):{},"function"==typeof k&&(k={map:k});var j=this,g=cF.resolve().then(function(){return jr(j,k,i)});return au(g,h),g};aQ(aC,Error),aQ(js,Error),aQ(e7,Error);var aN={query:jy,viewCleanup:jl},d8=7,db=dQ("document-store"),jw=dQ("by-sequence"),eG=dQ("attach-store"),dV=dQ("local-store"),j0=dQ("metadata-store"),bN=dQ("attach-seq-store"),cW={};aQ(bI,fJ.EventEmitter),bI.prototype.addListener=function(i,l,g,m){function j(){function n(){h=!1}if(k._listeners[l]){if(h){return void (h="waiting")}h=!0;var o=jB(m,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>m.since&&!m.cancelled&&(m.since=p.seq,m.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){j()},0),h=!1}).on("error",n)}}if(!this._listeners[l]){var k=this,h=!1;this._listeners[l]=j,this.on(i,j)}},bI.prototype.removeListener=function(h,g){g in this._listeners&&fJ.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},bI.prototype.notifyLocalWindows=function(g){jI()?chrome.storage.local.set({dbName:g}):jp()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},bI.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)};var dG=1,cb="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+jw+" (seq, deleted)",ju="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+jw+" (doc_id, rev)",fE="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+db+" (winningseq)",fP="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+bN+" (seq)",eW="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+bN+" (digest, seq)",dp=jw+".seq = "+db+".winningseq",cO=jw+".seq AS seq, "+jw+".deleted AS deleted, "+jw+".json AS data, "+jw+".rev AS rev, "+db+".json AS metadata";e3.valid=cT,e3.Changes=new bI;var du,eC=5,j2="document-store",ep="by-sequence",dh="attach-store",da="attach-seq-store",dx="meta-store",eR="local-store",eF="detect-blob-support",bx={running:!1,queue:[]},d7={};ay.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},ay.Changes=new bI;var eI={idb:ay,websql:e3};cS.ajax=cj,cS.utils=eA,cS.Errors=ck,cS.replicate=eB.replicate,cS.sync=dP,cS.version="5.2.0",cS.adapter("http",dO),cS.adapter("https",dO),cS.plugin(aN),Object.keys(eI).forEach(function(g){cS.adapter(g,eI[g],!0)}),c.exports=cS}).call(this,d(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});