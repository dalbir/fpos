!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(f,j){if(!i[f]){if(!l[f]){var n="function"==typeof require&&require;if(!j&&n){return n(f,!0)}if(e){return e(f,!0)}var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var h=i[f]={exports:{}};l[f][0].call(h.exports,function(p){var m=l[f][1][p];return a(m?m:p)},h,h.exports,d,l,i,b)}return i[f].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var f="color: "+this.color;k=[k[0],f,"color: inherit"].concat(Array.prototype.slice.call(k,1));var j=0,g=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),k.splice(g,0,f),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(k){function h(){}function g(){var q=g,m=+new Date,p=m-(b||m);q.diff=p,q.prev=b,q.curr=m,b=m,null==q.useColors&&(q.useColors=n.useColors()),null==q.color&&q.useColors&&(q.color=r());var w=Array.prototype.slice.call(arguments);w[0]=n.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=n.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof n.formatArgs&&(w=n.formatArgs.apply(q,w));var v=g.log||n.log||console.log.bind(console);v.apply(q,w)}h.enabled=!1,g.enabled=!0;var j=n.enabled(k)?g:h;return j.namespace=k,j}function i(g){n.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?n.skips.push(new RegExp("^"+g.substr(1)+"$")):n.names.push(new RegExp("^"+g+"$")))}}function a(){n.enable("")}function s(g){var j,h;for(j=0,h=n.skips.length;h>j;j++){if(n.skips[j].test(g)){return !1}}for(j=0,h=n.names.length;h>j;j++){if(n.names[j].test(g)){return !0}}return !1}function u(g){return g instanceof Error?g.stack||g.message:g}n=t.exports=o,n.coerce=u,n.disable=a,n.enable=i,n.enabled=s,n.humanize=e(9),n.names=[],n.skips=[],n.formatters={};var b,f=0},{9:9}],4:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,j,f,l,h,r;if(this._events||(this._events={}),"error"===k&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(j=this._events[k],p(j)){return !1}if(b(j)){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),j.apply(this,l)}}else{if(i(j)){for(l=Array.prototype.slice.call(arguments,1),r=j.slice(),f=r.length,h=0;f>h;h++){r[h].apply(this,l)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(i(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(e,a,b){(function(y){function l(){z=!0;for(var j,g,h=i.length;h;){for(g=i,i=[],j=-1;++j<h;){g[j]()}h=i.length}z=!1}function r(g){1!==i.push(g)||z||o()}var o,f=y.MutationObserver||y.WebKitMutationObserver;if(f){var x=0,s=new f(l),u=y.document.createTextNode("");s.observe(u,{characterData:!0}),o=function(){u.data=x=++x%2}}else{if(y.setImmediate||"undefined"==typeof y.MessageChannel){o="document" in y&&"onreadystatechange" in y.document.createElement("script")?function(){var g=y.document.createElement("script");g.onreadystatechange=function(){l(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},y.document.documentElement.appendChild(g)}:function(){setTimeout(l,0)}}else{var n=new y.MessageChannel;n.port1.onmessage=l,o=function(){n.port2.postMessage(0)}}}var z,i=[];a.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(e,a,b){(function(f){f("object"==typeof b?b:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(i){if(i){for(var n in i){"object"==typeof i[n]&&h[n]?k.call(h,h[n],i[n]):h[n]=i[n]}}}),h};j.extend=k})},{}],8:[function(l,u,t){function i(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=a,this.queue=[],this.outcome=void 0,g!==i&&y(this,g)}function h(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function p(j,k,g){s(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function e(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=f(g);"error"===z.status&&w(z.value)}function f(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function n(g){return g instanceof this?g:K.resolve(new this(i),g)}function r(g){var j=new this(i);return K.reject(j,g)}function b(w){function g(E,D){function C(F){k[D]=F,++q!==B||x||(x=!0,K.resolve(A,k))}z.resolve(E).then(C,function(F){x||(x=!0,K.reject(A,F))})}var z=this;if("[object Array]"!==Object.prototype.toString.call(w)){return this.reject(new TypeError("must be an array"))}var B=w.length,x=!1;if(!B){return this.resolve([])}for(var k=new Array(B),q=0,j=-1,A=new this(i);++j<B;){g(w[j],j)}return A}function o(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(i);++z<g;){q(j[z])}return k}var s=l(5),K={},L=["REJECTED"],m=["FULFILLED"],a=["PENDING"];u.exports=t=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===m||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(i);if(this.state!==a){var j=this.state===m?k:q;p(g,j,this.outcome)}else{this.queue.push(new h(g,k,q))}return g},h.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){p(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){K.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){p(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=f(e,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=m,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},t.resolve=n,t.reject=r,t.all=b,t.race=o},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(D,h,r){function s(j){if(null!==j){switch(typeof j){case"boolean":return j?1:0;case"number":return i(j);case"string":return j.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var m=Array.isArray(j),v=m?j:Object.keys(j),g=-1,w=v.length,q="";if(m){for(;++g<w;){q+=r.toIndexableString(v[g])}}else{for(;++g<w;){var k=v[g];q+=r.toIndexableString(k)+r.toIndexableString(j[k])}}return q}}return""}function l(q,g){var w,y=g,x="1"===q[g];if(x){w=0,g++}else{var v="0"===q[g];g++;var k="",z=q.substring(g,g+a),j=parseInt(z,10)+e;for(v&&(j=-j),g+=a;;){var m=q[g];if("\x00"===m){break}k+=m,g++}k=k.split("."),w=1===k.length?parseInt(k,10):parseFloat(k[0]+"."+k[1]),v&&(w-=10),0!==j&&(w=parseFloat(w+"e"+j))}return{num:w,length:g-y}}function o(v,g){var m=v.pop();if(g.length){var q=g[g.length-1];m===q.element&&(g.pop(),q=g[g.length-1]);var w=q.element,j=q.index;if(Array.isArray(w)){w.push(m)}else{if(j===v.length-2){var k=v.pop();w[k]=m}else{v.push(m)}}}}function b(k,q){for(var m=Math.min(k.length,q.length),j=0;m>j;j++){var g=r.collate(k[j],q[j]);if(0!==g){return g}}return k.length===q.length?0:k.length>q.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(j,m){for(var v=Object.keys(j),g=Object.keys(m),w=Math.min(v.length,g.length),q=0;w>q;q++){var k=r.collate(v[q],g[q]);if(0!==k){return k}if(k=r.collate(j[v[q]],m[g[q]]),0!==k){return k}}return v.length===g.length?0:v.length>g.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(k){if(0===k){return"1"}var y=k.toExponential().split(/e\+?/),q=parseInt(y[1],10),w=0>k,v=w?"0":"2",m=(w?-q:q)-e,j=p.padLeft(m.toString(),"0",a);v+=u+j;var x=Math.abs(parseFloat(y[0]));w&&(x=10-x);var g=x.toFixed(20);return g=g.replace(/\.?0+$/,""),v+=u+g}var e=-324,a=3,u="",p=D(11);r.collate=function(j,m){if(j===m){return 0}j=r.normalizeKey(j),m=r.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},r.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=r.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=r.normalizeKey(v))}}}}}return g},r.toIndexableString=function(g){var j="\x00";return g=r.normalizeKey(g),n(g)+u+s(g)+j},r.parseIndexableString=function(q){for(var g=[],x=[],y=0;;){var k=q[y++];if("\x00"!==k){switch(k){case"1":g.push(null);break;case"2":g.push("1"===q[y]),y++;break;case"3":var z=l(q,y);g.push(z.num),y+=z.length;break;case"4":for(var j="";;){var m=q[y];if("\x00"===m){break}j+=m,y++}j=j.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),g.push(j);break;case"5":var v={element:[],index:g.length};g.push(v.element),x.push(v);break;case"6":var w={element:{},index:g.length};g.push(w.element),x.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+k)}}else{if(1===g.length){return g.pop()}o(g,x)}}}},{11:11}],11:[function(b,h,a){function e(n,g,l){for(var f="",m=l-n.length;f.length<m;){f+=g}return f}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var g,o=n.length,f=r.length;for(g=0;o>g;g++){if(g===f){return 1}var q=n.charAt(g),i=r.charAt(g);if(q!==i){return i>q?-1:1}}return f>o?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(a,e,i){function b(){this.store={}}function j(g){if(this.store=new b,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}i.Map=b,i.Set=j,b.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},b.prototype.unmangle=function(f){return f.substring(1)},b.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},b.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},b.prototype.has=function(f){var g=this.mangle(f);return g in this.store},b.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},b.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},j.prototype.add=function(f){return this.store.set(f,!0)},j.prototype.has=function(f){return this.store.has(f)},j.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(n,o){var p,q,g,r;q=[],r=[];for(p in o){h.call(o,p)&&(g=o[p],"this"!==p&&(q.push(p),r.push(g)))}return Function.apply(null,f.call(q).concat([n])).apply(o["this"],r)}}).call(this)},{}],15:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(l){function s(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function O(j,A,k,w,q,z,x){return s(A&k|~A&w,j,A,q,z,x)}function y(j,A,k,w,q,z,x){return s(A&w|k&~w,j,A,q,z,x)}function P(j,A,k,w,q,z,x){return s(A^k^w,j,A,q,z,x)}function u(j,A,k,w,q,z,x){return s(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=O(z,j,x,k,w[0],7,-680876936),k=O(k,z,j,x,w[1],12,-389564586),x=O(x,k,z,j,w[2],17,606105819),j=O(j,x,k,z,w[3],22,-1044525330),z=O(z,j,x,k,w[4],7,-176418897),k=O(k,z,j,x,w[5],12,1200080426),x=O(x,k,z,j,w[6],17,-1473231341),j=O(j,x,k,z,w[7],22,-45705983),z=O(z,j,x,k,w[8],7,1770035416),k=O(k,z,j,x,w[9],12,-1958414417),x=O(x,k,z,j,w[10],17,-42063),j=O(j,x,k,z,w[11],22,-1990404162),z=O(z,j,x,k,w[12],7,1804603682),k=O(k,z,j,x,w[13],12,-40341101),x=O(x,k,z,j,w[14],17,-1502002290),j=O(j,x,k,z,w[15],22,1236535329),z=y(z,j,x,k,w[1],5,-165796510),k=y(k,z,j,x,w[6],9,-1069501632),x=y(x,k,z,j,w[11],14,643717713),j=y(j,x,k,z,w[0],20,-373897302),z=y(z,j,x,k,w[5],5,-701558691),k=y(k,z,j,x,w[10],9,38016083),x=y(x,k,z,j,w[15],14,-660478335),j=y(j,x,k,z,w[4],20,-405537848),z=y(z,j,x,k,w[9],5,568446438),k=y(k,z,j,x,w[14],9,-1019803690),x=y(x,k,z,j,w[3],14,-187363961),j=y(j,x,k,z,w[8],20,1163531501),z=y(z,j,x,k,w[13],5,-1444681467),k=y(k,z,j,x,w[2],9,-51403784),x=y(x,k,z,j,w[7],14,1735328473),j=y(j,x,k,z,w[12],20,-1926607734),z=P(z,j,x,k,w[5],4,-378558),k=P(k,z,j,x,w[8],11,-2022574463),x=P(x,k,z,j,w[11],16,1839030562),j=P(j,x,k,z,w[14],23,-35309556),z=P(z,j,x,k,w[1],4,-1530992060),k=P(k,z,j,x,w[4],11,1272893353),x=P(x,k,z,j,w[7],16,-155497632),j=P(j,x,k,z,w[10],23,-1094730640),z=P(z,j,x,k,w[13],4,681279174),k=P(k,z,j,x,w[0],11,-358537222),x=P(x,k,z,j,w[3],16,-722521979),j=P(j,x,k,z,w[6],23,76029189),z=P(z,j,x,k,w[9],4,-640364487),k=P(k,z,j,x,w[12],11,-421815835),x=P(x,k,z,j,w[15],16,530742520),j=P(j,x,k,z,w[2],23,-995338651),z=u(z,j,x,k,w[0],6,-198630844),k=u(k,z,j,x,w[7],10,1126891415),x=u(x,k,z,j,w[14],15,-1416354905),j=u(j,x,k,z,w[5],21,-57434055),z=u(z,j,x,k,w[12],6,1700485571),k=u(k,z,j,x,w[3],10,-1894986606),x=u(x,k,z,j,w[10],15,-1051523),j=u(j,x,k,z,w[1],21,-2054922799),z=u(z,j,x,k,w[8],6,1873313359),k=u(k,z,j,x,w[15],10,-30611744),x=u(x,k,z,j,w[6],15,-1560198380),j=u(j,x,k,z,w[13],21,1309151649),z=u(z,j,x,k,w[4],6,-145523070),k=u(k,z,j,x,w[11],10,-1120210379),x=u(x,k,z,j,w[2],15,718787259),j=u(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function m(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function Q(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function r(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,m(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function o(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,Q(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function v(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function t(j){var k;for(k=0;k<j.length;k+=1){j[k]=v(j[k])}return j.join("")}function n(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function p(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==t(r("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(x,z){var q,w,A,C,D=this.byteLength,k=j(x,D),B=D;return z!==l&&(B=j(z,D)),k>B?new ArrayBuffer(0):(q=B-k,w=new ArrayBuffer(q),A=new Uint8Array(w),C=new Uint8Array(this,k,q),A.set(C),w)}}(),p.prototype.append=function(j){return this.appendBinary(n(j)),this},p.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,m(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},p.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},p.hash=function(j,k){return p.hashBinary(n(j),k)},p.hashBinary=function(q,w){var k=r(q),j=t(k);return w?e(j):j},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,Q(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var j=p.prototype.getState.call(this);return j.buff=S(j.buff),j},p.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),p.prototype.setState.call(this,j)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(q,w){var k=o(new Uint8Array(q)),j=t(k);return w?e(j):j},p})},{}],16:[function(b,h,a){function e(n,r,g){var o=g[g.length-1];n===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,q=o.index;if(Array.isArray(f)){f.push(n)}else{if(q===r.length-2){var i=r.pop();f[i]=n}else{r.push(n)}}}a.stringify=function(f){var D=[];D.push({obj:f});for(var E,s,i,n,l,u,g,r,F,o,C,t="";E=D.pop();){if(s=E.obj,i=E.prefix||"",n=E.val||"",t+=i,n){t+=n}else{if("object"!=typeof s){t+="undefined"==typeof s?null:JSON.stringify(s)}else{if(null===s){t+="null"}else{if(Array.isArray(s)){for(D.push({val:"]"}),l=s.length-1;l>=0;l--){u=0===l?"":",",D.push({obj:s[l],prefix:u})}D.push({val:"["})}else{g=[];for(r in s){s.hasOwnProperty(r)&&g.push(r)}for(D.push({val:"}"}),l=g.length-1;l>=0;l--){F=g[l],o=s[F],C=l>0?",":"",C+=JSON.stringify(F)+":",D.push({obj:o,prefix:C})}D.push({val:"{"})}}}}}return t},a.parse=function(f){for(var o,A,t,l,g,n,D,u,s,i=[],B=[],C=0;;){if(o=f[C++],"}"!==o&&"]"!==o&&"undefined"!=typeof o){switch(o){case" ":case"	":case"\n":case":":case",":break;case"n":C+=3,e(null,i,B);break;case"t":C+=3,e(!0,i,B);break;case"f":C+=4,e(!1,i,B);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(A="",C--;;){if(t=f[C++],!/[\d\.\-e\+]/.test(t)){C--;break}A+=t}e(parseFloat(A),i,B);break;case'"':for(l="",g=void 0,n=0;;){if(D=f[C++],'"'===D&&("\\"!==g||n%2!==1)){break}l+=D,g=D,"\\"===g?n++:n=0}e(JSON.parse('"'+l+'"'),i,B);break;case"[":u={element:[],index:i.length},i.push(u.element),B.push(u);break;case"{":s={element:{},index:i.length},i.push(s.element),B.push(s);break;default:throw new Error("unexpectedly reached end of input: "+o)}}else{if(1===i.length){return i.pop()}e(i.pop(),i,B)}}}},{}],17:[function(e,a,b){(function(gV,gD){function ex(aa,ac){aa=aa||[],ac=ac||{};try{return new Blob(aa,ac)}catch(ad){if("TypeError"!==ad.name){throw ad}for(var ab="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,t=new ab,af=0;af<aa.length;af+=1){t.append(aa[af])}return t.getBlob(ac.type)}}function ew(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function hr(){for(var aa={},ac=new f7(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,f7.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function i6(aa,af){var ad,ab,t,ac=new Headers,ag={method:aa.method,credentials:"include",headers:ac};return aa.json&&(ac.set("Accept","application/json"),ac.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?ew(aa.body,function(ah){ag.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?ag.body=JSON.stringify(aa.body):"body" in aa?ag.body=aa.body:ag.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ac.set(ah,aa.headers[ah])}),ad=hr(aa.url,ag),aa.timeout>0&&(ab=setTimeout(function(){ad.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ad.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?af(null,t,ah):af(ah,t)})["catch"](function(ah){af(ah,t)}),{abort:ad.reject}}function iX(t,ac){var ad,aa,ag=function(){ad.abort()};ad=t.xhr?new t.xhr:new XMLHttpRequest;try{ad.open(t.method,t.url)}catch(ab){ac(ab,{statusCode:413})}ad.withCredentials="withCredentials" in t?t.withCredentials:!0,"GET"===t.method?delete t.headers["Content-Type"]:t.json&&(t.headers.Accept="application/json",t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.body&&t.processData&&"string"!=typeof t.body&&(t.body=JSON.stringify(t.body))),t.binary&&(ad.responseType="arraybuffer"),"body" in t||(t.body=null);for(var af in t.headers){t.headers.hasOwnProperty(af)&&ad.setRequestHeader(af,t.headers[af])}return t.timeout>0&&(aa=setTimeout(ag,t.timeout),ad.onprogress=function(){clearTimeout(aa),aa=setTimeout(ag,t.timeout)},"undefined"!=typeof ad.upload&&(ad.upload.onprogress=ad.onprogress)),ad.onreadystatechange=function(){if(4===ad.readyState){var ah={statusCode:ad.status};if(ad.status>=200&&ad.status<300){var ak;ak=t.binary?ex([ad.response||""],{type:ad.getResponseHeader("Content-Type")}):ad.responseText,ac(null,ah,ak)}else{var al={};try{al=JSON.parse(ad.response)}catch(aj){}ac(al,ah)}}},t.body&&t.body instanceof Blob?ew(t.body,function(ah){ad.send(ah)}):ad.send(t.body),{abort:ag}}function h(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function H(t,aa){return gR||t.xhr?iX(t,aa):i6(t,aa)}function g4(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gZ(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=g4.prototype,new ab(ac)}function eo(aa){var ac,ad,ab,t,af;return ad=aa.error===!0&&"string"==typeof aa.name?aa.name:aa.error,af=aa.reason,ab=iF("name",ad,af),aa.missing||"missing"===af||"deleted"===af||"not_found"===ad?ab=ib:"doc_validation"===ad?(ab=i1,t=af):"bad_request"===ad&&ab.message!==af&&(ab=hR),ab||(ab=iF("status",aa.status,af)||hp),ac=gZ(ab,af,ad),t&&(ac.message=t),aa.id&&(ac.id=aa.id),aa.status&&(ac.status=aa.status),aa.missing&&(ac.missing=aa.missing),ac}function ho(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function hz(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function iJ(t){if(t instanceof ArrayBuffer){return hz(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function he(aa){var ac,ad,ab;if(!aa||"object"!=typeof aa){return aa}if(Array.isArray(aa)){for(ac=[],ad=0,ab=aa.length;ab>ad;ad++){ac[ad]=he(aa[ad])}return ac}if(aa instanceof Date){return aa.toISOString()}if(ho(aa)){return iJ(aa)}ac={};for(ad in aa){if(Object.prototype.hasOwnProperty.call(aa,ad)){var t=he(aa[ad]);"undefined"!=typeof t&&(ac[ad]=t)}}return ac}function iO(){return""}function hM(aa,ac){function ad(ag,ah,af){if(!aa.binary&&aa.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?eo(ak):ak})),aa.binary&&q(ag,ah),af(null,ag,ah)}function ab(af,ah){var ak,ag;if(af.code&&af.status){var al=new Error(af.message||af.code);return al.status=af.status,ah(al)}try{ak=JSON.parse(af.responseText),ag=eo(ak)}catch(aj){ag=eo(af)}ah(ag)}aa=he(aa);var t={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return aa=ei.extend(t,aa),aa.json&&(aa.binary||(aa.headers.Accept="application/json"),aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json"),aa.binary&&(aa.encoding=null,aa.json=!1),aa.processData||(aa.json=!1),H(aa,function(ag,ak,am){if(ag){return ag.status=ak?ak.statusCode:400,ab(ag,ac)}var aj,al=ak.headers&&ak.headers["content-type"],af=am||iO();if(!aa.binary&&(aa.json||!aa.processData)&&"object"!=typeof af&&(/json/.test(al)||/^[\s]*\{/.test(af)&&/\}[\s]*$/.test(af))){try{af=JSON.parse(af.toString())}catch(ah){}}ak.statusCode>=200&&ak.statusCode<300?ad(af,ak,ac):(aj=eo(af),aj.status=ak.statusCode,ac(aj))})}function ig(t,ac){var ag=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aa=-1!==ag.indexOf("safari")&&-1===ag.indexOf("chrome"),ah=-1!==ag.indexOf("msie"),ad=aa&&"POST"===t.method||ah&&"GET"===t.method,af="cache" in t?t.cache:!0;if(ad||!af){var ab=-1!==t.url.indexOf("?");t.url+=(ab?"&":"?")+"_nonce="+Date.now()}return hM(t,ac)}function p(t){var aa=!1;return ao(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function y(t){return ao(function(ac){ac=he(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){gV.nextTick(function(){ad(ah,ag)})});var af=new f7(function(al,ag){var aj;try{var ak=p(function(ap,am){ap?ag(ap):al(am)});ac.push(ak),aj=t.apply(aa,ac),aj&&"function"==typeof aj.then&&al(aj)}catch(ah){ag(ah)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function G(t,aa){function ab(af,ah,ac){if(co.enabled){for(var ag=[af._db_name,ah],ad=0;ad<ac.length-1;ad++){ag.push(ac[ad])}co.apply(null,ag);var aj=ac[ac.length-1];ac[ac.length-1]=function(ak,am){var al=[af._db_name,ah];al=al.concat(ak?["error",ak]:["success",am]),co.apply(null,al),aj(ak,am)}}}return y(ao(function(ad){if(this._closed){return f7.reject(new Error("database is closed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new f7(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function ar(aa,ac){for(var ad={},ab=0,t=ac.length;t>ab;ab++){var af=ac[ab];af in aa&&(ad[af]=aa[af])}return ad}function gf(t,aa,ab){return new f7(function(ad,ac){t.get(aa,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=ab(ag);return af?(af._id=aa,af._rev=ah,void ad(Q(t,af,ab))):ad({updated:!1,rev:ah})})})}function Q(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return gf(t,aa._id,ab)})}function s(t){for(var ap,ak,am,al,ah=t.rev_tree.slice();al=ah.pop();){var ab=al.ids,ag=ab[2],aa=al.pos;if(ag.length){for(var ac=0,af=ag.length;af>ac;ac++){ah.push({pos:aa+1,ids:ag[ac]})}}else{var aj=!!ab[1].deleted,ad=ab[0];(!ap||(am!==aj?am:ak!==aa?aa>ak:ad>ap))&&(ap=ad,ak=aa,am=aj)}}return ak+"-"+ap}function hE(t){return t.ids}function gT(aa,ac){ac||(ac=s(aa));for(var ad,ab=ac.substring(ac.indexOf("-")+1),t=aa.rev_tree.map(hE);ad=t.pop();){if(ad[0]===ab){return !!ad[1].deleted}t=t.concat(ad[2])}}function fp(t){return iL("return "+t+";",{})}function iT(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function gK(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function F(t){var aa=gK(t);return aa?aa.join("/"):null}function be(ac,ak){for(var af,ah=ac.slice();af=ah.pop();){for(var ag=af.pos,ad=af.ids,aa=ad[2],aj=ak(0===aa.length,ag,ad[0],af.ctx,ad[1]),t=0,ab=aa.length;ab>t;t++){ah.push({pos:ag+1,ids:aa[t],ctx:aj})}}}function V(t,aa){return t.pos-aa.pos}function ij(aa){var ac=[];be(aa,function(aj,ag,ad,ah,af){aj&&ac.push({rev:ag+"-"+ad,pos:ag,opts:af})}),ac.sort(V).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function u(t){for(var ab=s(t),ag=ij(t.rev_tree),aa=[],ad=0,ac=ag.length;ac>ad;ad++){var af=ag[ad];af.rev===ab||af.opts.deleted||aa.push(af.rev)}return aa}function A(t,ab,ag){function aa(){ad.cancel()}hT.EventEmitter.call(this);var ad=this;this.db=t,ab=ab?he(ab):{};var ac=ab.complete=p(function(ah,aj){ah?ad.emit("error",ah):ad.emit("complete",aj),ad.removeAllListeners(),t.removeListener("destroyed",aa)});ag&&(ad.on("complete",function(ah){ag(null,ah)}),ad.on("error",ag)),t.once("destroyed",aa),ab.onChange=function(ah){ab.isCancelled||(ad.emit("change",ah),ad.startSeq&&ad.startSeq<=ah.seq&&(ad.startSeq=!1))};var af=new f7(function(ah,aj){ab.complete=function(al,ak){al?aj(al):ah(ak)}});ad.once("cancel",function(){t.removeListener("destroyed",aa),ab.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ac(null,ah)},ac),t.taskqueue.isReady?ad.doChanges(ab):t.taskqueue.addTask(function(){ad.isCancelled?ad.emit("cancel"):ad.doChanges(ab)})}function hY(aa,ac,ad){var ab=[{rev:aa._rev}];"all_docs"===ad.style&&(ab=ij(ac.rev_tree).map(function(af){return{rev:af.rev}}));var t={id:ac.id,changes:ab,doc:aa};return gT(ac,aa._rev)&&(t.deleted=!0),ad.conflicts&&(t.doc._conflicts=u(ac),t.doc._conflicts.length||delete t.doc._conflicts),t}function h7(ag,aa,ah){function ak(){var am=[];t.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ah(null,{results:am})}function al(){++ad===ab&&ak()}function aj(aq,am,ap){t[aq]={id:am,docs:ap},al()}var af=Array.isArray(aa)?aa:aa.docs,ac={};af.forEach(function(am){am.id in ac?ac[am.id].push(am):ac[am.id]=[am]});var ab=Object.keys(ac).length,ad=0,t=new Array(ab);Object.keys(ac).forEach(function(aq,ap){var am=ac[aq],au=ar(am[0],["atts_since","attachments"]);au.open_revs=am.map(function(aw){return aw.rev}),au.open_revs=au.open_revs.filter(function(aw){return aw});var av=function(aw){return aw};0===au.open_revs.length&&(delete au.open_revs,av=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in aa&&(au[aw]=aa[aw])}),ag.get(aq,au,function(aw,ax){aj(ap,aq,aw?[{error:aw}]:av(ax))})})}function gA(t){return/^_local/.test(t)}function E(t){for(var ap,ak=[],am=t.slice();ap=am.pop();){var al=ap.pos,ah=ap.ids,ab=ah[0],ag=ah[1],aa=ah[2],ac=0===aa.length,af=ap.history?ap.history.slice():[];af.push({id:ab,opts:ag}),ac&&ak.push({pos:al+1-af.length,ids:af});for(var aj=0,ad=aa.length;ad>aj;aj++){am.push({pos:al+1,ids:aa[aj],history:af})}}return ak.reverse()}function S(t){return 0|Math.random()*t}function iC(aa,ac){ac=ac||iY.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=iY[S(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=iY[3&S(16)|8];break;default:t+=iY[S(16)]}}return t}function v(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(t){var aa;if(t?"string"!=typeof t?aa=gZ(dr):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=gZ(iA)):aa=gZ(jc),aa){throw aa}}function hN(aa){if(!/^\d+\-./.test(aa)){return gZ(a3)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function P(t,ab){for(var ag=t.start-t.ids.length+1,aa=t.ids,ad=[aa[0],ab,[]],ac=1,af=aa.length;af>ac;ac++){ad=[aa[ac],{status:"missing"},[ad]]}return[{pos:ag,ids:ad}]}function fm(ac,ak){var af,ah,ag,ad={status:"available"};if(ac._deleted&&(ad.deleted=!0),ak){if(ac._id||(ac._id=iC()),ah=iC(32,16).toLowerCase(),ac._rev){if(ag=hN(ac._rev),ag.error){return ag}ac._rev_tree=[{pos:ag.prefix,ids:[ag.id,{status:"missing"},[[ah,ad,[]]]]}],af=ag.prefix+1}else{ac._rev_tree=[{pos:1,ids:[ah,ad,[]]}],af=1}}else{if(ac._revisions&&(ac._rev_tree=P(ac._revisions,ad),af=ac._revisions.start,ah=ac._revisions.ids[0]),!ac._rev_tree){if(ag=hN(ac._rev),ag.error){return ag}af=ag.prefix,ah=ag.id,ac._rev_tree=[{pos:af,ids:[ah,ad,[]]}]}}C(ac._id),ac._rev=af+"-"+ah;var aa={metadata:{},data:{}};for(var aj in ac){if(Object.prototype.hasOwnProperty.call(ac,aj)){var t="_"===aj[0];if(t&&!z[aj]){var ab=gZ(i1,aj);throw ab.message=i1.message+": "+aj,ab}t&&!io[aj]?aa.metadata[aj.slice(1)]=ac[aj]:aa.data[aj]=ac[aj]}}return aa}function iv(t,aa){return aa>t?-1:t>aa?1:0}function g0(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function hb(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function hw(aa){for(var ac=0;ac<aa.length;ac++){var ad=aa[ac];if(ad._deleted){delete ad._attachments}else{if(ad._attachments){for(var ab=Object.keys(ad._attachments),t=0;t<ab.length;t++){var af=ab[t];ad._attachments[af]=ar(ad._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function i0(aa,ac){var ad=iv(aa._id,ac._id);if(0!==ad){return ad}var ab=aa._revisions?aa._revisions.start:0,t=ac._revisions?ac._revisions.start:0;return iv(ab,t)}function fe(t){var aa={},ab=[];return be(t,function(ah,ac,ag,ad){var af=ac+"-"+ag;return ah&&(aa[af]=0),void 0!==ad&&ab.push({from:ad,to:af}),af}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function gi(aa,ac,ad){var ab="limit" in ac?ac.keys.slice(ac.skip,ac.limit+ac.skip):ac.skip>0?ac.keys.slice(ac.skip):ac.keys;if(ac.descending&&ab.reverse(),!ab.length){return aa._allDocs({limit:0},ad)}var t={offset:ac.skip};return f7.all(ab.map(function(af){var ag=ei.extend({key:af,deleted:"ok"},ac);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new f7(function(ah,aj){aa._allDocs(ag,function(ak,al){return ak?aj(ak):(t.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return t.rows=af,t})}function h3(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),gV.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&h3(aa)})})})}function ee(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function f6(){hT.EventEmitter.call(this)}function J(){this.isReady=!1,this.failed=!1,this.queue=[]}function hK(t){t&&gD.debug&&console.error(t)}function iy(t,ab){function ag(){ac.emit("destroyed",ad),ac.emit(ad,"destroyed")}function aa(){t.removeListener("destroyed",ag),t.emit("destroyed",t)}var ad=ab.originalName,ac=t.constructor,af=ac._destructionListeners;t.once("destroyed",ag),af.has(ad)||af.set(ad,[]),af.get(ad).push(aa)}function hG(aa,ac,ad){if(!(this instanceof hG)){return new hG(aa,ac,ad)}var ab=this;("function"==typeof ac||"undefined"==typeof ac)&&(ad=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ad&&(ad=hK),aa=aa||ac.name,ac=he(ac),delete ac.name,this.__opts=ac;var t=ad;ab.auto_compaction=ac.auto_compaction,ab.prefix=hG.prefix,f6.call(ab),ab.taskqueue=new J;var af=new f7(function(al,ah){ad=function(ap,am){return ap?ah(ap):(delete am.then,void al(am))},ac=he(ac);var ak,ag,aj=ac.name||aa;return function(){try{if("string"!=typeof aj){throw ag=new Error("Missing/invalid DB name"),ag.code=400,ag}if(ak=hG.parseAdapter(aj,ac),ac.originalName=aj,ac.name=ak.name,ac.prefix&&"http"!==ak.adapter&&"https"!==ak.adapter&&(ac.name=ac.prefix+ac.name),ac.adapter=ac.adapter||ak.adapter,ab._adapter=ac.adapter,iz("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aj,!hG.adapters[ac.adapter]){throw ag=new Error("Adapter is missing"),ag.code=404,ag}if(!hG.adapters[ac.adapter].valid()){throw ag=new Error("Invalid Adapter"),ag.code=404,ag}}catch(am){ab.taskqueue.fail(am)}}(),ag?ah(ag):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void hG.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ad(am)):(iy(ab,ac),ab.emit("created",ab),hG.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ad(null,ab))}))});af.then(function(ag){t(null,ag)},t),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function i(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function jj(){return hL}function de(t){Object.keys(hT.EventEmitter.prototype).forEach(function(ab){"function"==typeof hT.EventEmitter.prototype[ab]&&(t[ab]=iS[ab].bind(iS))});var aa=t._destructionListeners=new hQ.Map;t.on("destroyed",function(ab){aa.has(ab)&&(aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab))})}function gb(aa){for(var ac=aa.length,ad=new ArrayBuffer(ac),ab=new Uint8Array(ad),t=0;ac>t;t++){ab[t]=aa.charCodeAt(t)}return ad}function k(t,aa){return ex([gb(t)],{type:aa})}function ez(t){for(var ab=a6.exec(t),ag={},aa=14;aa--;){var ad=hP[aa],ac=ab[aa]||"",af=-1!==["user","password"].indexOf(ad);ag[ad]=af?decodeURIComponent(ac):ac}return ag[hk]={},ag[hP[12]].replace(ie,function(ah,ak,aj){ak&&(ag[hk][ak]=aj)}),ag}function g(aa,ac,ad){try{return !aa(ac,ad)}catch(ab){var t="Filter function threw: "+ab.toString();return gZ(hR,t)}}function I(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&g(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function ia(t,aa){"console" in gD&&"info" in console&&console.info("The above "+t+" is totally normal. "+aa)}function g9(aa,ac,ad,ab,t){return aa.get(ac)["catch"](function(af){if(404===af.status){return"http"===aa.type()&&ia(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ab,_id:ac,history:[],replicator:f1,version:at}}throw af}).then(function(af){return t.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ab}),af.history.unshift({last_seq:ad,session_id:ab}),af.history=af.history.slice(0,fn),af.version=at,af.replicator=f1,af.session_id=ab,af.last_seq=ad,aa.put(af)["catch"](function(ag){if(409===ag.status){return g9(aa,ac,ad,ab,t)}throw ag}))})}function B(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function a7(aa,ac){if(aa.session_id===ac.session_id){return{last_seq:aa.last_seq,history:aa.history||[]}}var t=aa.history||[],ab=ac.history||[];return gz(t,ab)}function gz(t,ac){var ag=t[0],aa=t.slice(1),ah=ac[0],ad=ac.slice(1);if(!ag||0===ac.length){return{last_seq:ft,history:[]}}var af=ag.session_id;if(a9(af,ac)){return{last_seq:ag.last_seq,history:t}}var ab=ah.session_id;return a9(ab,aa)?{last_seq:ah.last_seq,history:ad}:gz(aa,ad)}function a9(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:a9(aa,ab):!1}function T(aa,ac){aa=parseInt(aa,10)||0,ac=parseInt(ac,10),ac!==ac||aa>=ac?ac=(aa||1)<<1:ac+=1;var t=Math.random(),ab=ac-aa;return ~~(ab*t+aa)}function h5(t){var aa=0;return t||(aa=2000),T(t,aa)}function im(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=h5),ac.emit("requestError",t),("active"===ac.state||"pending"===ac.state)&&(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=gc})),aa.current_back_off=aa.current_back_off||gc,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function ii(t){return i4(t)}function gO(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function fz(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function fb(t){return Object.keys(t).sort(g6.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function i9(t,ab,ag){var aa=ag.doc_ids?ag.doc_ids.sort(g6.collate):"",ad=ag.filter?ag.filter.toString():"",ac="",af="";return ag.filter&&ag.query_params&&(ac=JSON.stringify(fb(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),f7.all([t.id(),ab.id()]).then(function(aj){var ah=aj[0]+aj[1]+ad+af+ac+aa;return hg(ah)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function ji(t){return/^1-/.test(t)}function hV(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0,attachments:!0,binary:!0}}function hd(af,ac,ah){function aa(){var ak=hV(ac);if(ak.docs.length){return af.bulkGet(ak).then(function(al){if(ah.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&t.push(ap.ok)})})})}}function ag(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function ad(ak){return af.allDocs({keys:ak,include_docs:!0}).then(function(al){if(ah.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&ji(am.value.rev)&&!ag(am.doc)&&(t.push(am.doc),delete ac[am.id])})})}function ab(){var ak=Object.keys(ac).filter(function(am){var al=ac[am].missing;return 1===al.length&&ji(al[0])});return ak.length>0?ad(ak):void 0}function aj(){return t}ac=he(ac);var t=[];return f7.resolve().then(ab).then(aa).then(aj)}function bo(aa,aR,aB,aI,aC){function av(){return ap?f7.resolve():i9(aa,aR,aB).then(function(aS){aO=aS,ap=new B(aa,aR,aO,aI)})}function aF(){if(ah=[],0!==al.docs.length){var aS=al.docs;return aR.bulkDocs({docs:aS,new_edits:!1}).then(function(aT){if(aI.cancelled){throw au(),new Error("cancelled")}var aW=[],aU={};aT.forEach(function(aY){aY.error&&(aC.doc_write_failures++,aW.push(aY),aU[aY.id]=aY)}),aN=aN.concat(aW),aC.docs_written+=al.docs.length-aW.length;var aV=aW.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aU[aZ._id];aY?aI.emit("denied",he(aY)):ah.push(aZ)}),aV.length>0){var aX=new Error("bulkDocs error");throw aX.other_errors=aW,aJ("target.bulkDocs failed to write docs",aX),new Error("bulkWrite partial failure")}},function(aT){throw aC.doc_write_failures+=aS.length,aT})}}function aP(){aC.last_seq=ak=al.seq;var aS=he(aC);return ah.length&&(aS.docs=ah,aI.emit("change",aS)),aq=!0,ap.writeCheckpoint(al.seq,aL).then(function(){if(aq=!1,aI.cancelled){throw au(),new Error("cancelled")}al=void 0,az()})["catch"](function(aT){throw aq=!1,aJ("writeCheckpoint completed with error",aT),aT})}function ad(){var aS={};return al.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aR.revsDiff(aS).then(function(aT){if(aI.cancelled){throw au(),new Error("cancelled")}al.diffs=aT})}function aH(){return hd(aa,al.diffs,aI).then(function(aS){aS.forEach(function(aT){delete al.diffs[aT._id],aC.docs_read++,al.docs.push(aT)})})}function ac(){if(!aI.cancelled&&!al){if(0===ax.length){return void ay(!0)}al=ax.shift(),ad().then(aH).then(aF).then(aP).then(ac)["catch"](function(aS){aJ("batch processing terminated with error",aS)})}}function ay(aS){return 0===aE.changes.length?void (0!==ax.length||al||((aw&&aQ.live||aK)&&(aI.state="pending",aI.emit("paused")),aK&&au())):void ((aS||aK||aE.changes.length>=aM)&&(ax.push(aE),aE={seq:0,changes:[],docs:[]},("pending"===aI.state||"stopped"===aI.state)&&(aI.state="active",aI.emit("active")),ac()))}function aJ(aS,aT){aA||(aT.message||(aT.message=aS),aC.ok=!1,aC.status="aborting",aC.errors.push(aT),aN=aN.concat(aT),ax=[],aE={seq:0,changes:[],docs:[]},au())}function au(){if(!(aA||aI.cancelled&&(aC.status="cancelled",aq))){aC.status=aC.status||"complete",aC.end_time=new Date,aC.last_seq=ak,aA=!0;var aS=aN.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aN.pop();aN.length>0&&(aT.other_errors=aN),aT.result=aC,im(aB,aI,aT,function(){bo(aa,aR,aB,aI)})}else{aC.errors=aN,aI.emit("complete",aC),aI.removeAllListeners()}}}function aD(aS){if(aI.cancelled){return au()}var aT=I(aB)(aS);aT&&(aE.seq=aS.seq,aE.changes.push(aS),ay(0===ax.length))}function af(aS){return ab=!1,aI.cancelled?au():(aS.results.length>0?(aQ.since=aS.last_seq,az()):aw?(aQ.live=!0,az()):aK=!0,void ay(!0))}function t(aS){return ab=!1,aI.cancelled?au():void aJ("changes rejected",aS)}function az(){function aS(){aT.cancel()}function aU(){aI.removeListener("cancel",aS)}if(!ab&&!aK&&ax.length<ag){ab=!0,aI._changes&&(aI.removeListener("cancel",aI._abortChanges),aI._changes.cancel()),aI.once("cancel",aS);var aT=aa.changes(aQ).on("change",aD);aT.then(aU,aU),aT.then(af)["catch"](t),aB.retry&&(aI._changes=aT,aI._abortChanges=aS)}}function aj(){av().then(function(){return aI.cancelled?void au():ap.getCheckpoint().then(function(aS){ak=aS,aQ={since:ak,limit:aM,batch_size:aM,style:"all_docs",doc_ids:am,return_docs:!0},aB.filter&&("string"!=typeof aB.filter?aQ.include_docs=!0:aQ.filter=aB.filter),"heartbeat" in aB&&(aQ.heartbeat=aB.heartbeat),"timeout" in aB&&(aQ.timeout=aB.timeout),aB.query_params&&(aQ.query_params=aB.query_params),aB.view&&(aQ.view=aB.view),az()})})["catch"](function(aS){aJ("getCheckpoint rejected with ",aS)})}function aG(aS){throw aq=!1,aJ("writeCheckpoint completed with error",aS),aS}var al,aO,ap,ax=[],aE={seq:0,changes:[],docs:[]},aq=!1,aK=!1,aA=!1,ak=0,aw=aB.continuous||aB.live||!1,aM=aB.batch_size||100,ag=aB.batches_limit||10,ab=!1,am=aB.doc_ids,aN=[],ah=[],aL=iC();aC=aC||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aQ={};return aI.ready(aa,aR),aI.cancelled?void au():(aI._addedListeners||(aI.once("cancel",au),"function"==typeof aB.complete&&(aI.once("error",aB.complete),aI.once("complete",function(aS){aB.complete(null,aS)})),aI._addedListeners=!0),void ("undefined"==typeof aB.since?aj():av().then(function(){return aq=!0,ap.writeCheckpoint(aB.since,aL)}).then(function(){return aq=!1,aI.cancelled?void au():(ak=aB.since,void aj())})["catch"](aG)))}function i5(){hT.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new f7(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function fo(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function hD(t,ab,ag,aa){if("function"==typeof ag&&(aa=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gZ(hR,"`doc_ids` filter parameter is not a list.")}ag.complete=aa,ag=he(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ad=new i5(ag),ac=fo(t,ag),af=fo(ab,ag);return bo(ac,af,ag,ad),ad}function hl(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=he(t),t.PouchConstructor=t.PouchConstructor||this,aa=fV.toPouch(aa,t),ac=fV.toPouch(ac,t),new il(aa,ac,t,ab)}function il(af,ap,am,ac){function aq(ay){ah.emit("change",{direction:"pull",change:ay})}function aj(ay){ah.emit("change",{direction:"push",change:ay})}function t(ay){ah.emit("denied",{direction:"push",doc:ay})}function al(ay){ah.emit("denied",{direction:"pull",doc:ay})}function av(){ah.pushPaused=!0,ah.pullPaused&&ah.emit("paused")}function ab(){ah.pullPaused=!0,ah.pushPaused&&ah.emit("paused")}function ag(){ah.pushPaused=!1,ah.pullPaused&&ah.emit("active",{direction:"push"})}function ak(){ah.pullPaused=!1,ah.pushPaused&&ah.emit("active",{direction:"pull"})}function ad(ay){return function(aC,az){var aE="change"===aC&&(az===aq||az===aj),aA="denied"===aC&&(az===al||az===t),aD="paused"===aC&&(az===ab||az===av),aB="active"===aC&&(az===ak||az===ag);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ah.removeAllListeners(aC))}}var ah=this;this.canceled=!1;var aa=am.push?ei.extend({},am,am.push):am,aw=am.pull?ei.extend({},am,am.pull):am;this.push=gW(af,ap,aa),this.pull=gW(ap,af,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};am.live&&(this.push.on("complete",ah.pull.cancel.bind(ah.pull)),this.pull.on("complete",ah.push.cancel.bind(ah.push))),this.on("newListener",function(ay){"change"===ay?(ah.pull.on("change",aq),ah.push.on("change",aj)):"denied"===ay?(ah.pull.on("denied",al),ah.push.on("denied",t)):"active"===ay?(ah.pull.on("active",ak),ah.push.on("active",ag)):"paused"===ay&&(ah.pull.on("paused",ab),ah.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ah.pull.removeListener("change",aq),ah.push.removeListener("change",aj)):"denied"===ay?(ah.pull.removeListener("denied",al),ah.push.removeListener("denied",t)):"active"===ay?(ah.pull.removeListener("active",ak),ah.push.removeListener("active",ag)):"paused"===ay&&(ah.pull.removeListener("paused",ab),ah.push.removeListener("paused",av))}),this.pull.on("removeListener",ad("pull")),this.push.on("removeListener",ad("push"));var au=f7.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ah.emit("complete",az),ac&&ac(null,az),ah.removeAllListeners(),az},function(ay){if(ah.cancel(),ac?ac(ay):ah.emit("error",ay),ah.removeAllListeners(),ac){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gJ(t,aa){return k(fX(t),aa)}function i3(aa){for(var ac="",ad=new Uint8Array(aa),ab=ad.byteLength,t=0;ab>t;t++){ac+=String.fromCharCode(ad[t])}return ac}function gq(aa,ac){if("undefined"==typeof FileReader){return ac(i3((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(i3(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function ha(t){return new f7(function(aa){gq(t,function(ab){aa(i4(ab))})})}function ce(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function gp(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=gJ(ab.data,ab.content_type)})}function gx(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function h9(t){return t._attachments&&Object.keys(t._attachments)?f7.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?ha(aa.data).then(function(ac){aa.data=ac}):void 0})):f7.resolve()}function gG(t){var aa=ez(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function a4(t,aa){return iZ(t,t.db+"/"+aa)}function iZ(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function iG(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function fl(af,ak){function am(ay,aw,ax){var av=ay.ajax||{},az=ei.extend(he(ab),av,aw);return iD(az.method+" "+az.url),go.ajax(az,ax)}function ac(av,aw){return new f7(function(ax,ay){am(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function aa(av,aw){return G(av,ao(function(ax){ah().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function ah(){if(af.skipSetup||af.skip_setup){return f7.resolve()}if(ap){return ap}var av={method:"GET",url:al};return ap=ac({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(ia(404,"PouchDB is just detecting if the remote exists."),ac({},{method:"PUT",url:al})):f7.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:f7.reject(aw)}),ap["catch"](function(){ap=null}),ap}function aq(av){return av.split("/").map(encodeURIComponent).join("/")}var ag=this,au=gG;af.getHost&&(au=af.getHost);var t=au(af.name,af),al=a4(t,"");af=he(af);var ab=af.ajax||{};if(ag.getUrl=function(){return al},ag.getHeaders=function(){return ab.headers||{}},af.auth||t.auth){var aj=af.auth||t.auth,ad=i4(aj.username+":"+aj.password);ab.headers=ab.headers||{},ab.headers.Authorization="Basic "+ad}var ap;setTimeout(function(){ak(null,ag)}),ag.type=function(){return"http"},ag.id=aa("id",function(av){am({},{method:"GET",url:iZ(t,"")},function(ay,aw){var ax=aw&&aw.uuid?aw.uuid+t.db:a4(t,"");av(null,ax)})}),ag.request=aa("request",function(av,aw){av.url=a4(t,av.url),am({},av,aw)}),ag.compact=aa("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=he(av),am(av,{url:a4(t,"_compact"),method:"POST"},function(){function ax(){ag.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),ag.bulkGet=G("bulkGet",function(aB,aw){function aA(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),am({},{url:a4(t,"_bulk_get"+iG(aD)),method:"POST",body:{docs:aB.docs}},aC)}function az(){function aD(aJ){return function(aL,aK){aH[aJ]=aK.results,++aC===aF&&aw(null,{results:ce(aH)})}}for(var aG=h4,aF=Math.ceil(aB.docs.length/aG),aC=0,aH=new Array(aF),aI=0;aF>aI;aI++){var aE=ar(aB,["revs","attachments"]);aE.docs=aB.docs.slice(aI*aG,Math.min(aB.docs.length,(aI+1)*aG)),h7(ax,aE,aD(aI))}}var ax=this,ay=iZ(t,""),av=hO[ay];"boolean"!=typeof av?aA(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(hO[ay]=!1,ia(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),az()):aw(aE)}else{hO[ay]=!0,aw(null,aD)}}):av?aA(aw):az()}),ag._info=function(av){ah().then(function(){am({},{method:"GET",url:a4(t,"")},function(ax,aw){return ax?av(ax):(aw.host=a4(t,""),void av(null,aw))})})["catch"](av)},ag.get=aa("get",function(aB,aw,aA){function az(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?f7.all(aE.map(function(aF){var aH=aC[aF],aG=gx(aD._id)+"/"+aq(aF)+"?rev="+aD._rev;return ac(aw,{method:"GET",url:a4(t,aG),binary:!0}).then(function(aI){return aw.binary?aI:ha(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function ax(aC){return Array.isArray(aC)?f7.all(aC.map(function(aD){return aD.ok?az(aD.ok):void 0})):az(aC)}"function"==typeof aw&&(aA=aw,aw={}),aw=he(aw);var av={};aw.revs&&(av.revs=!0),aw.revs_info&&(av.revs_info=!0),aw.open_revs&&("all"!==aw.open_revs&&(aw.open_revs=JSON.stringify(aw.open_revs)),av.open_revs=aw.open_revs),aw.rev&&(av.rev=aw.rev),aw.conflicts&&(av.conflicts=aw.conflicts),aB=gx(aB);var ay={method:"GET",url:a4(t,aB+iG(av))};ac(aw,ay).then(function(aC){return f7.resolve().then(function(){return aw.attachments?ax(aC):void 0}).then(function(){aA(null,aC)})})["catch"](aA)}),ag.remove=aa("remove",function(aw,ay,aA,av){var az;"string"==typeof ay?(az={_id:aw,_rev:ay},"function"==typeof aA&&(av=aA,aA={})):(az=aw,"function"==typeof ay?(av=ay,aA={}):(av=aA,aA=ay));var ax=az._rev||aA.rev;am(aA,{method:"DELETE",url:a4(t,gx(az._id))+"?rev="+ax},av)}),ag.getAttachment=aa("getAttachment",function(aw,aA,av,ay){"function"==typeof av&&(ay=av,av={});var az=av.rev?"?rev="+av.rev:"",ax=a4(t,gx(aw))+"/"+aq(aA)+az;am(av,{method:"GET",url:ax,binary:!0},ay)}),ag.removeAttachment=aa("removeAttachment",function(ay,aw,az,ax){var av=a4(t,gx(ay)+"/"+aq(aw))+"?rev="+az;am({},{method:"DELETE",url:av},ax)}),ag.putAttachment=aa("putAttachment",function(aE,aB,az,ax,aw,aA){"function"==typeof aw&&(aA=aw,aw=ax,ax=az,az=null);var aC=gx(aE)+"/"+aq(aB),aF=a4(t,aC);if(az&&(aF+="?rev="+az),"string"==typeof ax){var av;try{av=fX(ax)}catch(ay){return aA(gZ(fx,"Attachment is not a valid base64 string"))}ax=av?k(av,aw):""}var aD={headers:{"Content-Type":aw},method:"PUT",url:aF,processData:!1,body:ax,timeout:ab.timeout||60000};am({},aD,aA)}),ag._bulkDocs=function(ax,aw,av){ax.new_edits=aw.new_edits,ah().then(function(){return f7.all(ax.docs.map(h9))}).then(function(){am(aw,{method:"POST",url:a4(t,"_bulk_docs"),body:ax},function(ay,az){return ay?av(ay):(az.forEach(function(aA){aA.ok=!0}),void av(null,az))})})["catch"](av)},ag.allDocs=aa("allDocs",function(aB,aA){"function"==typeof aB&&(aA=aB,aB={}),aB=he(aB);var aw,az={},ax="GET";aB.conflicts&&(az.conflicts=!0),aB.descending&&(az.descending=!0),aB.include_docs&&(az.include_docs=!0),aB.attachments&&(az.attachments=!0),aB.key&&(az.key=JSON.stringify(aB.key)),aB.start_key&&(aB.startkey=aB.start_key),aB.startkey&&(az.startkey=JSON.stringify(aB.startkey)),aB.end_key&&(aB.endkey=aB.end_key),aB.endkey&&(az.endkey=JSON.stringify(aB.endkey)),"undefined"!=typeof aB.inclusive_end&&(az.inclusive_end=!!aB.inclusive_end),"undefined"!=typeof aB.limit&&(az.limit=aB.limit),"undefined"!=typeof aB.skip&&(az.skip=aB.skip);var ay=iG(az);if("undefined"!=typeof aB.keys){var av="keys="+encodeURIComponent(JSON.stringify(aB.keys));av.length+ay.length+1<=x?ay+="&"+av:(ax="POST",aw={keys:aB.keys})}ac(aB,{method:ax,url:a4(t,"_all_docs"+ay),body:aw}).then(function(aC){aB.include_docs&&aB.attachments&&aB.binary&&aC.rows.forEach(gp),aA(null,aC)})["catch"](aA)}),ag._changes=function(aC){var aG="batch_size" in aC?aC.batch_size:je;aC=he(aC),aC.timeout="timeout" in aC?aC.timeout:"timeout" in ab?ab.timeout:30000;var aB,ax=aC.timeout?{timeout:aC.timeout-5000}:{},aI="undefined"!=typeof aC.limit?aC.limit:!1;aB="return_docs" in aC?aC.return_docs:"returnDocs" in aC?aC.returnDocs:!0;var aD=aI;if(aC.style&&(ax.style=aC.style),(aC.include_docs||aC.filter&&"function"==typeof aC.filter)&&(ax.include_docs=!0),aC.attachments&&(ax.attachments=!0),aC.continuous&&(ax.feed="longpoll"),aC.conflicts&&(ax.conflicts=!0),aC.descending&&(ax.descending=!0),"heartbeat" in aC?aC.heartbeat&&(ax.heartbeat=aC.heartbeat):ax.heartbeat=10000,aC.filter&&"string"==typeof aC.filter&&(ax.filter=aC.filter,"_view"===aC.filter&&aC.view&&"string"==typeof aC.view&&(ax.view=aC.view)),aC.query_params&&"object"==typeof aC.query_params){for(var az in aC.query_params){aC.query_params.hasOwnProperty(az)&&(ax[az]=aC.query_params[az])}}var aH,aw="GET";if(aC.doc_ids){ax.filter="_doc_ids";var aA=JSON.stringify(aC.doc_ids);aA.length<x?ax.doc_ids=aA:(aw="POST",aH={doc_ids:aC.doc_ids})}var aF,ay,aE=function(aM,aK){if(!aC.aborted){ax.since=aM,"object"==typeof ax.since&&(ax.since=JSON.stringify(ax.since)),aC.descending?aI&&(ax.limit=aD):ax.limit=!aI||aD>aG?aG:aD;var aL={method:aw,url:a4(t,"_changes"+iG(ax)),timeout:aC.timeout,body:aH};ay=aM,aC.aborted||ah().then(function(){aF=am(aC,aL,aK)})["catch"](aK)}},av={results:[]},aJ=function(aL,aO){if(!aC.aborted){var aK=0;if(aO&&aO.results){aK=aO.results.length,av.last_seq=aO.last_seq;var aN={};aN.query=aC.query_params,aO.results=aO.results.filter(function(aQ){aD--;var aP=I(aC)(aQ);return aP&&(aC.include_docs&&aC.attachments&&aC.binary&&gp(aQ),aB&&av.results.push(aQ),aC.onChange(aQ)),aP})}else{if(aL){return aC.aborted=!0,void aC.complete(aL)}}aO&&aO.last_seq&&(ay=aO.last_seq);var aM=aI&&0>=aD||aO&&aG>aK||aC.descending;(!aC.continuous||aI&&0>=aD)&&aM?aC.complete(null,av):setTimeout(function(){aE(ay,aJ)},0)}};return aE(aC.since||0,aJ),{cancel:function(){aC.aborted=!0,aF&&aF.abort()}}},ag.revsDiff=aa("revsDiff",function(ax,aw,av){"function"==typeof aw&&(av=aw,aw={}),am(aw,{method:"POST",url:a4(t,"_revs_diff"),body:ax},av)}),ag._close=function(av){av()},ag._destroy=function(aw,av){am(aw,{url:a4(t,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(ag.emit("destroyed"),ag.constructor.emit("destroyed",af.name),void av(null,ay))})}}function iM(){this.promise=new f7(function(t){t()})}function gs(t){return iq.hash(t)}function gF(t){var ac=t.db,ag=t.viewName,aa=t.map,ah=t.reduce,ad=t.temporary,af=aa.toString()+(ah&&ah.toString())+"undefined";if(!ad&&ac._cachedViews){var ab=ac._cachedViews[af];if(ab){return f7.resolve(ab)}}return ac.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ag;-1===aq.indexOf("/")&&(aq=ag+"/"+ag);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ad?"temp":gs(af));return gf(ac,"_local/mrviews",al).then(function(){return ac.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ac,adapter:ac.adapter,mapFun:aa,reduceFun:ah};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ad||(ac._cachedViews=ac._cachedViews||{},ac._cachedViews[af]=aq,aq.db.once("destroyed",function(){delete ac._cachedViews[af]})),aq})})})})}function f0(aa,ac,ad,ab,t,af){return iL("return ("+aa.replace(/;\s*$/,"")+");",{emit:ac,sum:ad,log:ab,isArray:t,toJSON:af})}function hv(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function bt(t){return 1===t.length&&/^1-/.test(t[0].rev)}function iV(t,aa){try{t.emit("error",aa)}catch(ab){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(aa)}}function i8(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return iV(aa,ab),{error:ab}}}function g8(t,aa){var ab=gg(t.key,aa.key);return 0!==ab?ab:gg(t.value,aa.value)}function gk(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function fY(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function j(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gJ(ac.data,ac.content_type)})})}function ge(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&j(aa),aa}}function iI(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new jg(aa)}function iu(t){for(var ac=0,ag=0,aa=t.length;aa>ag;ag++){var ah=t[ag];if("number"!=typeof ah){if(!Array.isArray(ah)){throw iI("_sum")}ac="number"==typeof ac?[ac]:ac;for(var ad=0,af=ah.length;af>ad;ad++){var ab=ah[ad];if("number"!=typeof ab){throw iI("_sum")}"undefined"==typeof ac[ad]?ac.push(ab):ac[ad]+=ab}}else{"number"==typeof ac?ac+=ah:ac[0]+=ah}}return ac}function gY(aa,ac,ad,ab){var t=ac[aa];"undefined"!=typeof t&&(ab&&(t=encodeURIComponent(JSON.stringify(t))),ad.push(aa+"="+t))}function gC(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function hI(t){return t.group_level=gC(t.group_level),t.limit=gC(t.limit),t.skip=gC(t.skip),t}function a2(t){if(t){if("number"!=typeof t){return new gU('Invalid value for integer: "'+t+'"')}if(0>t){return new gU('Invalid value for positive integer: "'+t+'"')}}}function fk(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&gg(aa[t],aa[ab])>0){throw new gU("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new gU("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new gU("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=a2(aa[af]);if(ad){throw ad}})}function es(af,ac,ah){var aa,ag=[],ad="GET";if(gY("reduce",ah,ag),gY("include_docs",ah,ag),gY("attachments",ah,ag),gY("limit",ah,ag),gY("descending",ah,ag),gY("group",ah,ag),gY("group_level",ah,ag),gY("skip",ah,ag),gY("stale",ah,ag),gY("conflicts",ah,ag),gY("startkey",ah,ag,!0),gY("start_key",ah,ag,!0),gY("endkey",ah,ag,!0),gY("end_key",ah,ag,!0),gY("inclusive_end",ah,ag),gY("key",ah,ag,!0),ag=ag.join("&"),ag=""===ag?"":"?"+ag,"undefined"!=typeof ah.keys){var ab=2000,aj="keys="+encodeURIComponent(JSON.stringify(ah.keys));aj.length+ag.length+1<=ab?ag+=("?"===ag[0]?"&":"?")+aj:(ad="POST","string"==typeof ac?aa={keys:ah.keys}:ac.keys=ah.keys)}if("string"==typeof ac){var t=hv(ac);return af.request({method:ad,url:"_design/"+t[0]+"/_view/"+t[1]+ag,body:aa}).then(ge(ah))}return aa=aa||{},Object.keys(ac).forEach(function(ak){Array.isArray(ac[ak])?aa[ak]=ac[ak]:aa[ak]=ac[ak].toString()}),af.request({method:"POST",url:"_temp_view"+ag,body:aa}).then(ge(ah))}function h1(t,aa,ab){return new f7(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function gt(t){return new f7(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function iN(t){return function(aa){if(404===aa.status){return t}throw aa}}function hX(ag,aa,ah){function ak(){return bt(t)?f7.resolve(ac):aa.db.get(af)["catch"](iN(ac))}function al(am){return am.keys.length?aa.db.allDocs({keys:am.keys,include_docs:!0}):f7.resolve({rows:[]})}function aj(av,aq){for(var az=[],am={},ay=0,aw=aq.rows.length;aw>ay;ay++){var au=aq.rows[ay],aA=au.doc;if(aA&&(az.push(aA),am[aA._id]=!0,aA._deleted=!ad[aA._id],!aA._deleted)){var ap=ad[aA._id];"value" in ap&&(aA.value=ap.value)}}var ax=Object.keys(ad);return ax.forEach(function(aD){if(!am[aD]){var aB={_id:aD},aC=ad[aD];"value" in aC&&(aB.value=aC.value),az.push(aB)}}),av.keys=gX(ax.concat(av.keys)),az.push(av),az}var af="_local/doc_"+ag,ac={_id:af,keys:[]},ab=ah[ag],ad=ab.indexableKeysToKeyValues,t=ab.changes;return ak().then(function(am){return al(am).then(function(ap){return aj(am,ap)})})}function gr(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](iN({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return f7.all(ad.map(function(ag){return hX(ag,aa,ac)})).then(function(ag){var ah=ce(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function gv(t){var aa="string"==typeof t?t:t.name,ab=gh[aa];return ab||(ab=gh[aa]=new iM),ab}function jf(t){return i7(gv(t),function(){return gj(t)})()}function gj(af){function ac(am,ak){var al={id:ag._id,key:gI(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gI(ak)),aa.push(al)}function ah(ak,al){return function(){return gr(af,ak,al)}}var aa,ag,ad;if("function"==typeof af.mapFun&&2===af.mapFun.length){var ab=af.mapFun;ad=function(ak){return ab(ak,ac)}}else{ad=f0(af.mapFun.toString(),ac,iu,hh,Array.isArray,JSON.parse)}var aj=af.seq||0,t=new iM;return new f7(function(ap,ak){function al(){t.finish().then(function(){af.seq=aj,ap()})}function am(){function aq(au){ak(au)}af.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:aj,limit:gN}).on("complete",function(aF){var ax=aF.results;if(!ax.length){return al()}for(var au={},aA=0,aD=ax.length;aD>aA;aA++){var av=ax[aA];if("_"!==av.doc._id[0]){aa=[],ag=av.doc,ag._deleted||i8(af.sourceDB,ad,[ag]),aa.sort(g8);for(var aw,aC={},ay=0,aE=aa.length;aE>ay;ay++){var aB=aa[ay],az=[aB.key,aB.id];0===gg(aB.key,aw)&&az.push(ay);var aG=hZ(az);aC[aG]=aB,aw=aB.key}au[av.doc._id]={indexableKeysToKeyValues:aC,changes:av.changes}}aj=av.seq}return t.add(ah(au,aj)),ax.length<gN?al():am()}).on("error",aq)}am()})}function h0(ag,aa,ah){0===ah.group_level&&delete ah.group_level;var ak,al=ah.group||ah.group_level;ak=fu[ag.reduceFun]?fu[ag.reduceFun]:f0(ag.reduceFun.toString(),null,iu,hh,Array.isArray,JSON.parse);var aj=[],af=ah.group_level;aa.forEach(function(aq){var am=aj[aj.length-1],ap=al?aq.key:null;return al&&Array.isArray(ap)&&"number"==typeof af&&(ap=ap.length>af?ap.slice(0,af):ap),am&&0===gg(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void aj.push({key:[[ap,aq.id]],value:[aq.value]})});for(var ac=0,ab=aj.length;ab>ac;ac++){var ad=aj[ac],t=i8(ag.sourceDB,ak,[ad.key,ad.value,!1]);if(t.error&&t.error instanceof jg){throw t.error}ad.value=t.error?null:t.output,ad.key=ad.key[0][0]}return{rows:gk(aj,ah.limit,ah.skip)}}function f5(t,aa){return i7(gv(t),function(){return fT(t,aa)})()}function fT(t,ap){function ak(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return al=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=g3(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function am(au){var av;if(av=ah?h0(t,au,ap):{total_rows:al,offset:ab,rows:au},ap.include_docs){var aq=gX(au.map(fY));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ap.conflicts,attachments:ap.attachments,binary:ap.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=fY(ay),az=ax["$"+aA];az&&(ay.doc=az)}),av})}return av}var al,ah=t.reduceFun&&ap.reduce!==!1,ab=ap.skip||0;if("undefined"==typeof ap.keys||ap.keys.length||(ap.limit=0,delete ap.keys),"undefined"!=typeof ap.keys){var ag=ap.keys,aa=ag.map(function(aq){var au={startkey:hZ([aq]),endkey:hZ([aq,{}])};return ak(au)});return f7.all(aa).then(ce).then(am)}var ac={descending:ap.descending};if(ap.start_key&&(ap.startkey=ap.start_key),ap.end_key&&(ap.endkey=ap.end_key),"undefined"!=typeof ap.startkey&&(ac.startkey=hZ(ap.descending?[ap.startkey,{}]:[ap.startkey])),"undefined"!=typeof ap.endkey){var af=ap.inclusive_end!==!1;ap.descending&&(af=!af),ac.endkey=hZ(af?[ap.endkey,{}]:[ap.endkey])}if("undefined"!=typeof ap.key){var aj=hZ([ap.key]),ad=hZ([ap.key,{}]);ac.descending?(ac.endkey=aj,ac.startkey=ad):(ac.startkey=aj,ac.endkey=ad)}return ah||("number"==typeof ap.limit&&(ac.limit=ap.limit),ac.skip=ab),ak(ac).then(am)}function ix(t){return t.request({method:"POST",url:"_view_cleanup"})}function iP(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=hv(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return i7(gv(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return f7.all(ag).then(function(){return{ok:!0}})})},iN({ok:!0}))}function gL(ah,ab,t){if("http"===ah.type()){return es(ah,ab,t)}if("function"==typeof ah._query){return h1(ah,ab,t)}if("string"!=typeof ab){fk(t,ab);var ag={db:ah,viewName:"temp_view/temp_view",map:ab.map,reduce:ab.reduce,temporary:!0};return cr.add(function(){return gF(ag).then(function(ak){function aj(){return ak.db.destroy()}return gH(jf(ak).then(function(){return f5(ak,t)}),aj)})}),cr.finish()}var ac=ab,af=hv(ac),aa=af[0],ad=af[1];return ah.get("_design/"+aa).then(function(al){var ak=al.views&&al.views[ad];if(!ak||"string"!=typeof ak.map){throw new hU("ddoc "+aa+" has no view named "+ad)}fk(t,ak);var aj={db:ah,viewName:ac,map:ak.map,reduce:ak.reduce};return gF(aj).then(function(am){return"ok"===t.stale||"update_after"===t.stale?("update_after"===t.stale&&gV.nextTick(function(){jf(am)}),f5(am,t)):jf(am).then(function(){return f5(am,t)})})})}function gU(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gU)}catch(aa){}}function hU(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,hU)}catch(aa){}}function jg(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,jg)}catch(aa){}}function fi(t){return"'"+t+"'"}function iw(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function gw(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function L(t){return delete t._id,delete t._rev,JSON.stringify(t)}function iK(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function g1(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function ht(aa,ac,ad,ab,t){return"SELECT "+aa+" FROM "+("string"==typeof ac?ac:ac.join(" JOIN "))+(ad?" ON "+ad:"")+(ab?" WHERE "+("string"==typeof ab?ab:ab.join(" AND ")):"")+(t?" ORDER BY "+t:"")}function hu(t,ab,ag){function aa(){++ac===t.length&&ad()}function ad(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+gB+" WHERE seq IN "+g1(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+gB+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+gB+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new hQ.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+gB+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+X+" WHERE digest=?",[az]))})})})}})}}if(t.length){var ac=0,af=[];t.forEach(function(ah){var aj="SELECT seq FROM "+R+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ab,ah],function(al,am){if(!am.rows.length){return aa()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+R+" WHERE seq=?",[ak],aa)})})}}function gd(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gZ(gn,ab,ac))}}function iR(t){if("size" in t){return 1000000*t.size}var aa=/Android/.test(window.navigator.userAgent);return aa?5000000:1}function Y(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function iB(t,aa){try{return{db:t(aa)}}catch(ab){return{error:ab}}}function hm(t){var aa=hn[t.name];if(!aa){var ab=Y();aa=hn[t.name]=iB(ab,t),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return aa}function hs(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function M(t){i()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):jj()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function hc(){hT.EventEmitter.call(this),this._listeners={},M(this)}function l(t){return decodeURIComponent(window.escape(t))}function a8(t){return 65>t?t-48:t-55}function K(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(a8(aa.charCodeAt(ac++))<<4|a8(aa.charCodeAt(ac++)))}return ab}function iQ(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(a8(aa.charCodeAt(ac+2))<<12|a8(aa.charCodeAt(ac+3))<<8|a8(aa.charCodeAt(ac))<<4|a8(aa.charCodeAt(ac+1))),ac+=4}return ab}function fj(t,aa){return"UTF-8"===aa?l(K(t,0,t.length)):iQ(t,0,t.length)}function hA(t){try{return JSON.parse(t)}catch(aa){return hj.parse(t)}}function ai(t){try{return JSON.stringify(t)}catch(aa){return hj.stringify(t)}}function h6(aa,ad,ah){function ab(ak){try{return fX(ak)}catch(al){var aj=gZ(fx,"Attachment is not a valid base64 string");return{error:aj}}}function t(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=ab(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===ad?al.data=k(ak,al.content_type):"base64"===ad?al.data=i4(ak):al.data=ak,hg(ak).then(function(am){al.digest="md5-"+am,aj()})}else{ew(al.data,function(am){"binary"===ad?al.data=i3(am):"base64"===ad&&(al.data=i4(i3(am))),hg(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function ag(){af++,aa.length===af&&(ac?ah(ac):ah())}if(!aa.length){return ah()}var ac,af=0;aa.forEach(function(ak){function am(aq){ac=aq,al++,al===aj.length&&ag()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ag()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&t(ak.data._attachments[ap],am)}})}function ct(t,aa){return t.pos-aa.pos}function a1(aa,ac,ad){for(var ab,t=0,af=aa.length;af>t;){ab=t+af>>>1,ad(aa[ab],ac)<0?t=ab+1:af=ab}return t}function jh(aa,ac,t){var ab=a1(aa,ac,t);aa.splice(ab,0,ac)}function hB(t,ac){for(var ag,aa,ah=ac,ad=t.length;ad>ah;ah++){var af=t[ah],ab=[af.id,af.opts,[]];aa?(aa[2].push(ab),aa=ab):ag=aa=ab}return ag}function fd(t,aa){return t[0]<aa[0]?-1:1}function gu(ac,ak){for(var af=[{tree1:ac,tree2:ak}],ah=!1;af.length>0;){var ag=af.pop(),ad=ag.tree1,aa=ag.tree2;(ad[1].status||aa[1].status)&&(ad[1].status="available"===ad[1].status||"available"===aa[1].status?"available":"missing");for(var aj=0;aj<aa[2].length;aj++){if(ad[2][0]){for(var t=!1,ab=0;ab<ad[2].length;ab++){ad[2][ab][0]===aa[2][aj][0]&&(af.push({tree1:ad[2][ab],tree2:aa[2][aj]}),t=!0)}t||(ah="new_branch",jh(ad[2],aa[2][aj],fd))}else{ah="new_leaf",ad[2][0]=aa[2][aj]}}}return{conflicts:ah,tree:ac}}function r(ab,ah,ad){var aj,av=[],aq=!1,ak=!1;if(!ab.length){return{tree:[ah],conflicts:"new_leaf"}}for(var af=0,aw=ab.length;aw>af;af++){var ag=ab[af];if(ag.pos===ah.pos&&ag.ids[0]===ah.ids[0]){aj=gu(ag.ids,ah.ids),av.push({pos:ag.pos,ids:aj.tree}),aq=aq||aj.conflicts,ak=!0}else{if(ad!==!0){var al=ag.pos<ah.pos?ag:ah,t=ag.pos<ah.pos?ah:ag,aa=t.pos-al.pos,ap=[],ax=[];for(ax.push({ids:al.ids,diff:aa,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],am=0,ac=az.length;ac>am;am++){ax.push({ids:az[am],diff:ay.diff-1,parent:ay.ids,parentIdx:am})}}else{ay.ids[0]===t.ids[0]&&ap.push(ay)}}var au=ap[0];au?(aj=gu(au.ids,t.ids),au.parent[2][au.parentIdx]=aj.tree,av.push({pos:al.pos,ids:al.ids}),aq=aq||aj.conflicts,ak=!0):av.push(ag)}else{av.push(ag)}}}return ak||av.push(ah),av.sort(ct),{tree:av,conflicts:aq||"internal_node"}}function hS(ac,ak){for(var af,ah=E(ac),ag=0,ad=ah.length;ad>ag;ag++){var aa=ah[ag],aj=aa.ids,t=Math.max(0,aj.length-ak),ab={pos:aa.pos+t,ids:hB(aj,t)};af=af?r(af,ab,!0).tree:[ab]}return af}function dt(aa,ac,t){var ab=r(aa,ac);return{tree:hS(ab.tree,t),conflicts:ab.conflicts}}function ic(ac,ak){for(var af,ah=ac.slice(),ag=ak.split("-"),ad=parseInt(ag[0],10),aa=ag[1];af=ah.pop();){if(af.pos===ad&&af.ids[0]===aa){return !0}for(var aj=af.ids[2],t=0,ab=aj.length;ab>t;t++){ah.push({pos:af.pos+1,ids:aj[t]})}}return !1}function hF(aj,ax,aq,am,au,ad,af,ag){if(ic(ax.rev_tree,aq.metadata.rev)){return am[au]=aq,ad()}var aw=ax.winningRev||s(ax),ay="deleted" in ax?ax.deleted:gT(ax,aw),ac="deleted" in aq.metadata?aq.metadata.deleted:gT(aq.metadata),av=/^1-/.test(aq.metadata.rev);if(ay&&!ac&&ag&&av){var ab=aq.data;ab._rev=aw,ab._id=aq.metadata.id,aq=fm(ab,ag)}var aA=dt(ax.rev_tree,aq.metadata.rev_tree[0],aj),ak=ag&&(ay&&ac||!ay&&"new_leaf"!==aA.conflicts||ay&&!ac&&"new_branch"===aA.conflicts);if(ak){var t=gZ(gS);return am[au]=t,ad()}var az=aq.metadata.rev;aq.metadata.rev_tree=aA.tree,ax.rev_map&&(aq.metadata.rev_map=ax.rev_map);var al,aa=s(aq.metadata),ah=gT(aq.metadata,aa),ap=ay===ah?0:ah>ay?-1:1;al=az===aa?ah:gT(aq.metadata,az),af(aq,aa,ah,al,!0,ap,au,ad)}function ip(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ev(af,ak,am,ac,aa,ah,aq,ag,au){function t(aA,aC,aw){var ax=s(aA.metadata),ay=gT(aA.metadata,ax);if("was_delete" in ag&&ay){return ah[aC]=gZ(ib,"deleted"),aw()}var av=ab&&ip(aA);if(av){var az=gZ(gS);return ah[aC]=az,aw()}var aB=ay?0:1;aq(aA,ax,ay,ay,!1,aB,aC,aw)}function al(){++ad===ap&&au&&au()}af=af||1000;var ab=ag.new_edits,aj=new hQ.Map,ad=0,ap=ak.length;ak.forEach(function(ay,aw){if(ay._id&&gA(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void am[av](ay,{ctx:aa},function(aA,az){ah[aw]=aA||az,al()})}var ax=ay.metadata.id;aj.has(ax)?(ap--,aj.get(ax).push([ay,aw])):aj.set(ax,[[ay,aw]])}),aj.forEach(function(aw,ay){function az(){++ax<aw.length?av():al()}function av(){var aC=aw[ax],aB=aC[0],aA=aC[1];if(ac.has(ay)){hF(af,ac.get(ay),aB,ah,aA,az,aq,ab)}else{var aD=dt([],aB.metadata.rev_tree[0],af);aB.metadata.rev_tree=aD.tree,t(aB,aA,az)}}var ax=0;av()})}function gM(t){var aa=[];return be(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function jk(ay,aB,aq,al,av,ak,aa){function az(){return ah?aa(ah):(ak.notify(al._name),al._docCount=-1,void aa(null,am))}function t(aD,aE){var aC="SELECT count(*) as cnt FROM "+X+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gZ(fy,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ab(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aA.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){t(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ad(aM,aQ,aJ,aN,aC,aH,aO,aD){function aK(){function aU(bf,bg){function bb(){return ++ba===bc.length&&bg(),!1}function bh(bj){var bi="INSERT INTO "+gB+" (digest, seq) VALUES (?,?)",bk=[aT._attachments[bj].digest,bf];ap.executeSql(bi,bk,bb,bb)}var ba=0,bc=Object.keys(aT._attachments||{});if(!bc.length){return bg()}for(var bd=0;bd<bc.length;bd++){bh(bc[bd])}}var aT=aM.data,aX=aN?1:0,aY=aT._id,aW=aT._rev,aZ=L(aT),aS="INSERT INTO "+R+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aV=[aY,aW,aZ,aX];ap.executeSql(aS,aV,function(ba,bb){var bc=bb.insertId;aU(bc,function(){aP(ba,bc)})},function(){var ba=ht("seq",R,null,"doc_id=? AND rev=?");return ap.executeSql(ba,[aY,aW],function(bd,bf){var bb=bf.rows.item(0).seq,bc="UPDATE "+R+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aZ,aX,aY,aW];bd.executeSql(bc,bg,function(bh){aU(bb,function(){aP(bh,bb)})})}),!1})}function aR(aS){aE||(aS?(aE=aS,aD(aE)):aI===aG.length&&aK())}function aF(aS){aI++,aR(aS)}function aL(){if(aC&&al.auto_compaction){var aT=aM.metadata.id,aS=gM(aM.metadata);hu(aS,aT,ap)}}function aP(aT,aV){aL(),aM.metadata.seq=aV,delete aM.metadata.rev;var aX=aC?"UPDATE "+ik+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+R+" WHERE doc_id="+ik+".id AND rev=?) WHERE id=?":"INSERT INTO "+ik+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aW=ai(aM.metadata),aU=aM.metadata.id,aS=aC?[aW,aV,aQ,aU]:[aU,aV,aV,aW];aT.executeSql(aX,aS,function(){am[aO]={ok:!0,id:aM.metadata.id,rev:aQ},ac.set(aU,aM.metadata),aD()})}var aE=null,aI=0;aM.data._id=aM.metadata.id,aM.data._rev=aM.metadata.rev;var aG=Object.keys(aM.data._attachments||{});aN&&(aM.data._deleted=!0),aG.forEach(function(aV){var aU=aM.data._attachments[aV];if(aU.stub){aI++,aR()}else{var aT=aU.data;delete aU.data;var aS=aU.digest;ax(aS,aT,aF)}}),aG.length||aK()}function af(){ev(ay.revs_limit,aA,al,ac,ap,am,ad,aq)}function aw(aD){function aE(){++aC===aA.length&&aD()}if(!aA.length){return aD()}var aC=0;aA.forEach(function(aG){if(aG._id&&gA(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+ik+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=hA(aI.rows.item(0).json);ac.set(aF,aJ)}aE()})})}function ax(aD,aF,aC){var aE="SELECT digest FROM "+X+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+X+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iw(aF)],function(){aC()},function(){return aC(),!1}))})}var ag=aq.new_edits,au=aB.docs,aA=au.map(function(aC){if(aC._id&&gA(aC._id)){return aC}var aD=fm(aC,ag);return aD}),aj=aA.filter(function(aC){return aC.error});if(aj.length){return aa(aj[0])}var ap,ah,am=new Array(aA.length),ac=new hQ.Map;h6(aA,"binary",function(aC){return aC?aa(aC):void av.transaction(function(aD){ap=aD,ab(function(aE){aE?ah=aE:aw(af)})},gd(aa),az)})}function f3(af,ac,ah,aa,ag){function ad(){++t===aj.length&&ag&&ag()}function ab(am,ak){var al=am._attachments[ak],ap={binary:ac.binary,ctx:aa};ah._getAttachment(al,ap,function(au,aq){am._attachments[ak]=ei.extend(ar(al,["digest","content_type"]),{data:aq}),ad()})}var aj=Object.keys(af._attachments||{});if(!aj.length){return ag&&ag()}var t=0;aj.forEach(function(ak){ac.attachments&&ac.include_docs?ab(af,ak):(af._attachments[ak].stub=!0,ad())})}function hx(t,ag){function aq(){jj()&&(window.localStorage["_pouch__websqldb_"+ak._name]=!0),ag(null,ak)}function al(aC,aD){aC.executeSql(bn),aC.executeSql("ALTER TABLE "+R+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(ff),aC.executeSql("ALTER TABLE "+ik+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+ik+" (local, id)");var aE="SELECT "+ik+".winningseq AS seq, "+ik+".json AS metadata FROM "+R+" JOIN "+ik+" ON "+R+".seq = "+ik+".winningseq";aC.executeSql(aE,[],function(aH,aK){for(var aJ=[],aM=[],aF=0;aF<aK.rows.length;aF++){var aI=aK.rows.item(aF),aL=aI.seq,aG=JSON.parse(aI.metadata);gT(aG)&&aJ.push(aL),gA(aG.id)&&aM.push(aG.id)}aH.executeSql("UPDATE "+ik+"SET local = 1 WHERE id IN "+g1(aM.length),aM,function(){aH.executeSql("UPDATE "+R+" SET deleted = 1 WHERE seq IN "+g1(aJ.length),aJ,aD)})})})})}function av(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+hf+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+ik+".id AS id, "+R+".json AS data FROM "+R+" JOIN "+ik+" ON "+R+".seq = "+ik+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aI,aG){function aJ(){if(!aH.length){return aE(aI)}var aL=aH.shift(),aM=JSON.parse(aL.data)._rev;aI.executeSql("INSERT INTO "+hf+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+ik+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+R+" WHERE seq=?",[aL.seq],function(){aJ()})})})}for(var aH=[],aK=0;aK<aG.rows.length;aK++){aH.push(aG.rows.item(aK))}aJ()})})}function af(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aI=aG.shift(),aK=fj(aI.hex,aB),aN=aK.lastIndexOf("::"),aJ=aK.substring(0,aN),aL=aK.substring(aN+2),aM="UPDATE "+R+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aM,[aJ,aL,aK],function(){aH()})}aH()}var aE="ALTER TABLE "+R+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+R+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(a0,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+R;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function aA(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+X;aH.executeSql(aG,[],function(aJ,aN){function aK(){var aO=ht(fr+", "+ik+".id AS id",[ik,R],gP,null,ik+".id ");aO+=" LIMIT "+aM+" OFFSET "+aL,aL+=aM,aJ.executeSql(aO,[],function(aW,aR){function aU(bc,bd){var bb=aZ[bc]=aZ[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aR.rows.length){return aF(aW)}for(var aZ={},aV=0;aV<aR.rows.length;aV++){for(var aS=aR.rows.item(aV),aT=iK(aS.data,aS.id,aS.rev),aY=Object.keys(aT._attachments||{}),aX=0;aX<aY.length;aX++){var aP=aT._attachments[aY[aX]];aU(aP.digest,aS.seq)}}var ba=[];if(Object.keys(aZ).forEach(function(bb){var bc=aZ[bb];bc.forEach(function(bd){ba.push([bb,bd])})}),!ba.length){return aK()}var aQ=0;ba.forEach(function(bc){var bb="INSERT INTO "+gB+" (digest, seq) VALUES (?,?)";aW.executeSql(bb,bc,function(){++aQ===ba.length&&aK()})})})}var aI=aN.rows.item(0).cnt;if(!aI){return aF(aJ)}var aL=0,aM=10;aK()})}var aE="CREATE TABLE IF NOT EXISTS "+gB+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(ae,[],function(aH){aH.executeSql(ir,[],aC)})})}function az(aD,aE){var aC="ALTER TABLE "+X+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function ab(aD,aE){var aC="ALTER TABLE "+ik+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+ik+" SET max_seq=(SELECT MAX(seq) FROM "+R+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aH){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+ik+" (max_seq)";aH.executeSql(aI,[],aE)})})}function aj(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;aB=2===aG.length?"UTF-8":"UTF-16",aD()})}function au(){for(;am.length>0;){var aC=am.pop();aC(null,ad)}}function aw(aJ,aM){if(0===aM){var aF="CREATE TABLE IF NOT EXISTS "+jd+" (dbid, db_version INTEGER)",aH="CREATE TABLE IF NOT EXISTS "+X+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aL="CREATE TABLE IF NOT EXISTS "+gB+" (digest, seq INTEGER)",aI="CREATE TABLE IF NOT EXISTS "+ik+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aK="CREATE TABLE IF NOT EXISTS "+R+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aG="CREATE TABLE IF NOT EXISTS "+hf+" (id UNIQUE, rev, json)";aJ.executeSql(aH),aJ.executeSql(aG),aJ.executeSql(aL,[],function(){aJ.executeSql(ir),aJ.executeSql(ae)}),aJ.executeSql(aI,[],function(){aJ.executeSql(bn),aJ.executeSql(aK,[],function(){aJ.executeSql(ff),aJ.executeSql(a0),aJ.executeSql(aF,[],function(){var aP="INSERT INTO "+jd+" (db_version, dbid) VALUES (?,?)";ad=iC();var aO=[f8,ad];aJ.executeSql(aP,aO,function(){au()})})})})}else{var aN=function(){var aO=f8>aM;aO&&aJ.executeSql("UPDATE "+jd+" SET db_version = "+f8);var aP="SELECT dbid FROM "+jd;aJ.executeSql(aP,[],function(aR,aQ){ad=aQ.rows.item(0).dbid,au()})},aE=[al,av,af,aA,az,ab,aN],aD=aM,aC=function(aO){aE[aD-1](aO,aC),aD++};aC(aJ)}}function aa(){ac.transaction(function(aC){aj(aC,function(){ax(aC)})},gd(ag),aq)}function ax(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+jd;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+jd,[],function(aH,aI){var aG=aI.rows.item(0).db_version;aw(aH,aG)}):aE.executeSql("ALTER TABLE "+jd+" ADD COLUMN db_version INTEGER",[],function(){aw(aE,1)}):aw(aE,0)})}function ay(aD,aE){if(-1!==ak._docCount){return aE(ak._docCount)}var aC=ht("COUNT("+ik+".id) AS 'num'",[ik,R],gP,R+".deleted=0");aD.executeSql(aC,[],function(aG,aF){ak._docCount=aF.rows.item(0).num,aE(ak._docCount)})}var aB,ak=this,ad=null,ap=iR(t),am=[];ak._docCount=-1,ak._name=t.name;var ah=hm({name:ak._name,version:fc,description:ak._name,size:ap,location:t.location,createFromLocation:t.createFromLocation,androidDatabaseImplementation:t.androidDatabaseImplementation});if(ah.error){return gd(ag)(ah.error)}var ac=ah.db;"function"!=typeof ac.readTransaction&&(ac.readTransaction=ac.transaction),aa(),ak.type=function(){return"websql"},ak._id=y(function(aC){aC(null,ad)}),ak._info=function(aC){ac.readTransaction(function(aD){ay(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+R;aD.executeSql(aF,[],function(aI,aH){var aG=aH.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aG,sqlite_plugin:ac._sqlitePlugin,websql_encoding:aB})})})},gd(aC))},ak._bulkDocs=function(aE,aC,aD){jk(t,aE,aC,ak,ac,hx.Changes,aD)},ak._get=function(aL,aH,aD){function aG(){aD(aJ,{doc:aF,metadata:aC,ctx:aE})}var aF,aC,aJ,aE=aH.ctx;if(!aE){return ac.readTransaction(function(aM){ak._get(aL,ei.extend({ctx:aM},aH),aD)})}var aI,aK;aH.rev?(aI=ht(fr,[ik,R],ik+".id="+R+".doc_id",[R+".doc_id=?",R+".rev=?"]),aK=[aL,aH.rev]):(aI=ht(fr,[ik,R],gP,ik+".id=?"),aK=[aL]),aE.executeSql(aI,aK,function(aO,aN){if(!aN.rows.length){return aJ=gZ(ib,"missing"),aG()}var aM=aN.rows.item(0);return aC=hA(aM.metadata),aM.deleted&&!aH.rev?(aJ=gZ(ib,"deleted"),aG()):(aF=iK(aM.data,aC.id,aM.rev),void aG())})},ak._allDocs=function(aL,aE){var aH,aM=[],aK="startkey" in aL?aL.startkey:!1,aP="endkey" in aL?aL.endkey:!1,aG="key" in aL?aL.key:!1,aD="descending" in aL?aL.descending:!1,aF="limit" in aL?aL.limit:-1,aI="skip" in aL?aL.skip:0,aN=aL.inclusive_end!==!1,aC=[],aJ=[];if(aG!==!1){aJ.push(ik+".id = ?"),aC.push(aG)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aJ.push(ik+".id "+(aD?"<=":">=")+" ?"),aC.push(aK)),aP!==!1){var aO=aD?">":"<";aN&&(aO+="="),aJ.push(ik+".id "+aO+" ?"),aC.push(aP)}aG!==!1&&(aJ.push(ik+".id = ?"),aC.push(aG))}}"ok"!==aL.deleted&&aJ.push(R+".deleted = 0"),ac.readTransaction(function(aQ){ay(aQ,function(aS){if(aH=aS,0!==aF){var aR=ht(fr,[ik,R],gP,aJ,ik+".id "+(aD?"DESC":"ASC"));aR+=" LIMIT "+aF+" OFFSET "+aI,aQ.executeSql(aR,aC,function(aT,aW){for(var aV=0,aU=aW.rows.length;aU>aV;aV++){var aZ=aW.rows.item(aV),aX=hA(aZ.metadata),aY=aX.id,ba=iK(aZ.data,aY,aZ.rev),bb=ba._rev,bc={id:aY,key:aY,value:{rev:bb}};if(aL.include_docs&&(bc.doc=ba,bc.doc._rev=bb,aL.conflicts&&(bc.doc._conflicts=u(aX)),f3(bc.doc,aL,ak,aT)),aZ.deleted){if("ok"!==aL.deleted){continue}bc.value.deleted=!0,bc.doc=null}aM.push(bc)}})}})},gd(aE),function(){aE(null,{total_rows:aH,offset:aL.skip,rows:aM})})},ak._changes=function(aJ){function aF(){var aM=ik+".json AS metadata, "+ik+".max_seq AS maxSeq, "+R+".json AS winningDoc, "+R+".rev AS winningRev ",aL=ik+" JOIN "+R,aN=ik+".id="+R+".doc_id AND "+ik+".winningseq="+R+".seq",aO=["maxSeq > ?"],aR=[aJ.since];aJ.doc_ids&&(aO.push(ik+".id IN "+g1(aJ.doc_ids.length)),aR=aR.concat(aJ.doc_ids));var aK="maxSeq "+(aC?"DESC":"ASC"),aQ=ht(aM,aL,aN,aO,aK),aS=I(aJ);aJ.view||aJ.filter||(aQ+=" LIMIT "+aG);var aP=aJ.since||0;ac.readTransaction(function(aT){aT.executeSql(aQ,aR,function(bc,ba){function bb(bf){return function(){aJ.onChange(bf)}}for(var aU=0,aW=ba.rows.length;aW>aU;aU++){var aY=ba.rows.item(aU),aZ=hA(aY.metadata);aP=aY.maxSeq;var aX=iK(aY.winningDoc,aZ.id,aY.winningRev),aV=aJ.processChange(aX,aZ,aJ);aV.seq=aY.maxSeq;var bd=aS(aV);if("object"==typeof bd){return aJ.complete(bd)}if(bd&&(aD++,aH&&aI.push(aV),aJ.attachments&&aJ.include_docs?f3(aX,aJ,ak,bc,bb(aV)):bb(aV)()),aD===aG){break}}})},gd(aJ.complete),function(){aJ.continuous||aJ.complete(null,{results:aI,last_seq:aP})})}if(aJ=he(aJ),aJ.continuous){var aE=ak._name+":"+iC();return hx.Changes.addListener(ak._name,aE,ak,aJ),hx.Changes.notify(ak._name),{cancel:function(){hx.Changes.removeListener(ak._name,aE)}}}var aC=aJ.descending;aJ.since=aJ.since&&!aC?aJ.since:0;var aG="limit" in aJ?aJ.limit:-1;0===aG&&(aG=1);var aH;aH="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aI=[],aD=0;aF()},ak._close=function(aC){aC()},ak._getAttachment=function(aJ,aF,aE){var aC,aG=aF.ctx,aH=aJ.digest,aI=aJ.content_type,aD="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+X+" WHERE digest=?";aG.executeSql(aD,[aH],function(aK,aN){var aM=aN.rows.item(0),aL=aM.escaped?gw(aM.body):fj(aM.body,aB);aC=aF.binary?k(aL,aI):i4(aL),aE(null,aC)})},ak._getRevisionTree=function(aC,aD){ac.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+ik+" WHERE id = ?";aE.executeSql(aF,[aC],function(aH,aG){if(aG.rows.length){var aI=hA(aG.rows.item(0).metadata);aD(null,aI.rev_tree)}else{aD(gZ(ib))}})})},ak._doCompaction=function(aD,aE,aC){return aE.length?void ac.transaction(function(aF){var aG="SELECT json AS metadata FROM "+ik+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aK){var aJ=hA(aK.rows.item(0).metadata);be(aJ.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aH="UPDATE "+ik+" SET json = ? WHERE id = ?";aI.executeSql(aH,[ai(aJ),aD])}),hu(aE,aD,aF)},gd(aC),function(){aC()}):aC()},ak._getLocal=function(aC,aD){ac.readTransaction(function(aE){var aF="SELECT json, rev FROM "+hf+" WHERE id=?";aE.executeSql(aF,[aC],function(aI,aG){if(aG.rows.length){var aJ=aG.rows.item(0),aH=iK(aJ.json,aC,aJ.rev);aD(null,aH)}else{aD(gZ(ib))}})})},ak._putLocal=function(aI,aF,aK){function aD(aN){var aL,aM;aJ?(aL="UPDATE "+hf+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aC,aG,aH,aJ]):(aL="INSERT INTO "+hf+" (id, rev, json) VALUES (?,?,?)",aM=[aH,aC,aG]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aE={ok:!0,id:aH,rev:aC},aF.ctx&&aK(null,aE)):aK(gZ(gS))},function(){return aK(gZ(gS)),!1})}"function"==typeof aF&&(aK=aF,aF={}),delete aI._revisions;var aC,aJ=aI._rev,aH=aI._id;aC=aJ?aI._rev="0-"+(parseInt(aJ.split("-")[1],10)+1):aI._rev="0-1";var aE,aG=L(aI);aF.ctx?aD(aF.ctx):ac.transaction(aD,gd(aK),function(){aE&&aK(null,aE)})},ak._removeLocal=function(aE,aG,aC){function aF(aH){var aI="DELETE FROM "+hf+" WHERE id=? AND rev=?",aJ=[aE._id,aE._rev];aH.executeSql(aI,aJ,function(aK,aL){return aL.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(gZ(ib))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ac.transaction(aF,gd(aC),function(){aD&&aC(null,aD)})},ak._destroy=function(aC,aD){hx.Changes.removeAllListeners(ak._name),ac.transaction(function(aE){var aF=[ik,R,X,jd,hf,gB];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},gd(aD),function(){jj()&&(delete window.localStorage["_pouch__websqldb_"+ak._name],delete window.localStorage[ak._name]),aD(null,{ok:!0})})}}function br(aa,ac,t){try{aa.apply(ac,t)}catch(ab){"undefined"!=typeof PouchDB&&PouchDB.emit("error",ab)}}function id(){if(!en.running&&en.queue.length){en.running=!0;var t=en.queue.shift();t.action(function(ab,aa){br(t.callback,this,[ab,aa]),en.running=!1,gV.nextTick(id)})}}function hH(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gZ(g7,aa,ab.type))}}function f9(t,aa,ab){return{data:ai(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function fZ(t){if(!t){return null}var aa=hA(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function ih(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function N(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:gJ(aa,ac):ex([""],{type:ac})):aa?"string"!=typeof aa?gq(aa,function(ad){ab(i4(ad))}):ab(aa):ab("")}function D(t,ac,ag,aa){function ah(){++ab===af.length&&aa&&aa()}function ad(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ag.objectStore(m).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ah()}}var af=Object.keys(t._attachments||{});if(!af.length){return aa&&aa()}var ab=0;af.forEach(function(aj){ac.attachments&&ac.include_docs?ad(t,aj):(t._attachments[aj].stub=!0,ah())})}function iU(t,aa){return f7.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return f7.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new f7(function(aj){N(ad,ag,aa,function(ak){ac.doc._attachments[ah]=ei.extend(ar(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function gm(ac,ak,af){function ah(){ab--,ab||ag()}function ag(){ad.length&&ad.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aj["delete"](am)}})}var ad=[],aa=af.objectStore(Z),aj=af.objectStore(m),t=af.objectStore(eu),ab=ac.length;ac.forEach(function(al){var am=aa.index("_doc_id_rev"),ap=ak+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ah()}aa["delete"](au);var av=t.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ad.push(ax),t["delete"](aw.primaryKey),aw["continue"]()}else{ah()}}}})}function hC(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function O(ak,aw,ac,aB,aE,ab,af){function am(){var aO=[o,Z,m,fU,fS,eu],aP=hC(aE,aO,"readwrite");return aP.error?af(aP.error):(av=aP.txn,av.onabort=hH(af),av.ontimeout=hH(af),av.oncomplete=aL,aD=av.objectStore(o),aH=av.objectStore(Z),ap=av.objectStore(m),ah=av.objectStore(eu),void aN(function(aQ){return aQ?(aK=!0,af(aQ)):void aj()}))}function aa(){ev(ak.revs_limit,ax,aB,aJ,av,az,al,ac)}function aj(){function aT(){++aR===ax.length&&aa()}function aO(aV){var aW=fZ(aV.target.result);aW&&aJ.set(aW.id,aW),aT()}if(ax.length){for(var aR=0,aU=0,aS=ax.length;aS>aU;aU++){var aP=ax[aU];if(aP._id&&gA(aP._id)){aT()}else{var aQ=aD.get(aP.metadata.id);aQ.onsuccess=aO}}}}function aL(){aK||(ab.notify(aB._meta.name),aB._meta.docCount+=aA,af(null,az))}function aC(aP,aQ){var aO=ap.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=gZ(fy,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(ax.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){aC(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function al(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?ad(aR,aX,aT,aU,aP,aW):void aq(aR,aX,aT,aU,aP,aW)}function t(aO){var aP=gM(aO.metadata);gm(aP,aO.metadata.id,av)}function aq(aY,aT,aQ,aR,aO,aV){function aS(ba){aR&&aB.auto_compaction&&t(aY),aP.seq=ba.target.result,delete aP.rev;var bb=f9(aP,aT,aQ),bc=aD.put(bb);bc.onsuccess=aW}function aU(bb){bb.preventDefault(),bb.stopPropagation();var bc=aH.index("_doc_id_rev"),ba=bc.getKey(aZ._doc_id_rev);ba.onsuccess=function(bd){var bf=aH.put(aZ,bd.target.result);bf.onsuccess=aS}}function aW(){az[aO]={ok:!0,id:aP.id,rev:aT},aJ.set(aY.metadata.id,aY.metadata),ay(aY,aP.seq,aV)}var aZ=aY.data,aP=aY.metadata;aZ._doc_id_rev=aP.id+"::"+aP.rev,delete aZ._id,delete aZ._rev;var aX=aH.put(aZ);aX.onsuccess=aS,aX.onerror=aU}function ad(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&aq(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(ba){var bc=aQ.data._attachments[ba];if(bc.stub){aP++,aO()}else{var bb=bc.data;delete bc.data;var aZ=bc.digest;aM(aZ,bb,aW)}})}function ay(aO,aR,aU){function aP(){++aS===aT.length&&aU()}function aV(aW){var aX=aO.data._attachments[aW].digest,aY=ah.put({seq:aR,digestSeq:aX+"::"+aR});aY.onsuccess=aP,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aP()}}var aS=0,aT=Object.keys(aO.data._attachments||{});if(!aT.length){return aU()}for(var aQ=0;aQ<aT.length;aQ++){aV(aT[aQ])}}function aM(aP,aR,aO){var aQ=ap.count(aP);aQ.onsuccess=function(aS){var aV=aS.target.result;if(aV){return aO()}var aT={digest:aP,body:aR},aU=ap.put(aT);aU.onsuccess=aO}}for(var av,aD,aH,ap,ah,aF,ax=aw.docs,aA=0,aG=0,ag=ax.length;ag>aG;aG++){var aI=ax[aG];aI._id&&gA(aI._id)||(aI=ax[aG]=fm(aI,ac.new_edits),aI.error&&!aF&&(aF=aI))}if(aF){return af(aF)}var az=new Array(ax.length),aJ=new hQ.Map,aK=!1,au=aB._meta.blobSupport?"blob":"base64";h6(ax,au,function(aO){return aO?af(aO):void am()})}function fg(aa,ac,ad,ab,t){try{if(aa&&ac){return t?IDBKeyRange.bound(ac,aa,!ad,!1):IDBKeyRange.bound(aa,ac,!1,!ad)}if(aa){return t?IDBKeyRange.upperBound(aa):IDBKeyRange.lowerBound(aa)}if(ac){return t?IDBKeyRange.lowerBound(ac,!ad):IDBKeyRange.upperBound(ac,!ad)}if(ab){return IDBKeyRange.only(ab)}}catch(af){return{error:af}}return null}function ey(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(gZ(g7,t.name,t.message))}function n(aa,ac,ad,ab){function t(ax,ak){function aA(aK,aL,aN){var aM=aK.id+"::"+aN;aI.get(aM).onsuccess=function(aO){aL.doc=ih(aO.target.result),ax.conflicts&&(aL.doc._conflicts=u(aK)),D(aL.doc,ax,al)}}function av(aN,aL,aM){var aO={id:aM.id,key:aM.id,value:{rev:aL}},aK=aM.deleted;if("ok"===ax.deleted){aF.push(aO),aK?(aO.value.deleted=!0,aO.doc=null):ax.include_docs&&aA(aM,aO,aL)}else{if(!aK&&aj--<=0&&(aF.push(aO),ax.include_docs&&aA(aM,aO,aL),0===--am)){return}}aN["continue"]()}function aD(aN){ag=ac._meta.docCount;var aL=aN.target.result;if(aL){var aK=fZ(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function aC(){ak(null,{total_rows:ag,offset:ax.skip,rows:aF})}function aq(){ax.attachments?iU(aF,ax.binary).then(aC):aC()}var aw="startkey" in ax?ax.startkey:!1,aH="endkey" in ax?ax.endkey:!1,au="key" in ax?ax.key:!1,aj=ax.skip||0,am="number"==typeof ax.limit?ax.limit:-1,aG=ax.inclusive_end!==!1,aE="descending" in ax&&ax.descending?"prev":null,ay=fg(aw,aH,aG,au,aE);if(ay&&ay.error){return ey(ac,ax,ay.error,ak)}var ah=[o,Z];ax.attachments&&ah.push(m);var aB=hC(ad,ah,"readonly");if(aB.error){return ak(aB.error)}var al=aB.txn,ap=al.objectStore(o),aJ=al.objectStore(Z),az=aE?ap.openCursor(ay,aE):ap.openCursor(ay),aI=aJ.index("_doc_id_rev"),aF=[],ag=0;al.oncomplete=aq,az.onsuccess=aD}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ac._meta.docCount,offset:ag.skip,rows:[]}):void t(ag,ah)}af(aa,ab)}function ga(t){return new f7(function(ab){var aa=ex([""]);t.objectStore(fa).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function hi(t,aa){var ab=this;en.queue.push({action:function(ac){gl(ab,t,ac)},callback:aa}),id()}function gl(ac,ag,aq){function am(av){var aw=av.createObjectStore(o,{keyPath:"id"});av.createObjectStore(Z,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(m,{keyPath:"digest"}),av.createObjectStore(fU,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(fa),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(fS,{keyPath:"_id"});var au=av.createObjectStore(eu,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(av,aw){var au=av.objectStore(o);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=gT(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function aa(au){au.createObjectStore(fS,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ah(aw,av){var ay=aw.objectStore(fS),ax=aw.objectStore(o),az=aw.objectStore(Z),au=ax.openCursor();au.onsuccess=function(aE){var aH=aE.target.result;if(aH){var aB=aH.value,aK=aB.id,aL=gA(aK),aC=s(aB);if(aL){var aF=aK+"::"+aC,aI=aK+"::",aD=aK+"::~",aG=az.index("_doc_id_rev"),aJ=IDBKeyRange.bound(aI,aD,!1,!1),aA=aG.openCursor(aJ);aA.onsuccess=function(aN){if(aA=aN.target.result){var aM=aA.value;aM._doc_id_rev===aF&&ay.put(aM),az["delete"](aA.primaryKey),aA["continue"]()}else{ax["delete"](aH.primaryKey),aH["continue"]()}}}else{aH["continue"]()}}else{av&&av()}}}function al(au){var av=au.createObjectStore(eu,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ab(aw,av){var ay=aw.objectStore(Z),ax=aw.objectStore(m),az=aw.objectStore(eu),au=ax.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ay.openCursor().onsuccess=function(aE){var aI=aE.target.result;if(!aI){return av()}for(var aJ=aI.value,aG=aI.primaryKey,aC=Object.keys(aJ._attachments||{}),aK={},aL=0;aL<aC.length;aL++){var aD=aJ._attachments[aC[aL]];aK[aD.digest]=!0}var aF=Object.keys(aK);for(aL=0;aL<aF.length;aL++){var aH=aF[aL];az.put({seq:aG,digestSeq:aH+"::"+aG})}aI["continue"]()}):av()}}function ad(ax){function av(az){return az.data?fZ(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ax.objectStore(Z),ay=ax.objectStore(o),aw=ay.openCursor();aw.onsuccess=function(aC){function aD(){var aF=az.id+"::",aH=az.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=f9(az,az.winningRev,az.deleted),aF=ay.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=aC.target.result;if(aB){var az=av(aB.value);return az.winningRev=az.winningRev||s(az),az.seq?aA():void aD()}}}var ap=ag.name,af=null;ac._meta=null,ac.type=function(){return"idb"},ac._id=y(function(au){au(null,ac._meta.instanceId)}),ac._bulkDocs=function(au,aw,av){O(ag,au,aw,ac,af,hi.Changes,av)},ac._get=function(aB,ax,aC){function av(){aC(aA,{doc:au,metadata:ay,ctx:aw})}var au,ay,aA,aw=ax.ctx;if(!aw){var az=hC(af,[o,Z,m],"readonly");if(az.error){return aC(az.error)}aw=az.txn}aw.objectStore(o).get(aB).onsuccess=function(aG){if(ay=fZ(aG.target.result),!ay){return aA=gZ(ib,"missing"),av()}if(gT(ay)&&!ax.rev){return aA=gZ(ib,"deleted"),av()}var aE=aw.objectStore(Z),aD=ax.rev||ay.winningRev,aF=ay.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return au=aH.target.result,au&&(au=ih(au)),au?void av():(aA=gZ(ib,"missing"),av())}}},ac._getAttachment=function(aw,aA,av){var ay;if(aA.ctx){ay=aA.ctx}else{var ax=hC(af,[o,Z,m],"readonly");if(ax.error){return av(ax.error)}ay=ax.txn}var az=aw.digest,au=aw.content_type;ay.objectStore(m).get(az).onsuccess=function(aC){var aB=aC.target.result.body;N(aB,au,aA.binary,function(aD){av(null,aD)})}},ac._info=function(aA){if(null===af||!fq[ap]){var ay=new Error("db isn't open");return ay.id="idbNull",aA(ay)}var av,ax,az=hC(af,[Z],"readonly");if(az.error){return aA(az.error)}var au=az.txn,aw=au.objectStore(Z).openCursor(null,"prev");aw.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,ax=ac._meta.docCount},au.oncomplete=function(){aA(null,{doc_count:ax,update_seq:av,idb_attachment_format:ac._meta.blobSupport?"binary":"base64"})}},ac._allDocs=function(av,au){n(av,ac,af,au)},ac._changes=function(av){function aC(aP){function aM(){return aS.seq!==aR?aP["continue"]():(aI=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aL.get(aU);aT.onsuccess=function(aV){aN(ih(aV.target.result))}}function aN(aU){var aT=av.processChange(aU,aS,av);aT.seq=aS.seq;var aV=au(aT);return"object"==typeof aV?av.complete(aV):(aV&&(aK++,ax&&aD.push(aT),av.attachments&&av.include_docs?D(aU,av,az,function(){iU([aT],av.binary).then(function(){av.onChange(aT)})}):av.onChange(aT)),void (aK!==aw&&aP["continue"]()))}var aQ=ih(aP.value),aR=aP.key;if(aB&&!aB.has(aQ._id)){return aP["continue"]()}var aS;return(aS=ay.get(aQ._id))?aM():void (aG.get(aQ._id).onsuccess=function(aT){aS=fZ(aT.target.result),ay.set(aQ._id,aS),aM()})}function aF(aN){var aM=aN.target.result;aM&&aC(aM)}function aJ(){var aM=[o,Z];av.attachments&&aM.push(m);var aN=hC(af,aM,"readonly");if(aN.error){return av.complete(aN.error)}az=aN.txn,az.onabort=hH(av.complete),az.oncomplete=aA,aE=az.objectStore(Z),aG=az.objectStore(o),aL=aE.index("_doc_id_rev");var aO;aO=av.descending?aE.openCursor(null,"prev"):aE.openCursor(IDBKeyRange.lowerBound(av.since,!0)),aO.onsuccess=aF}function aA(){function aM(){av.complete(null,{results:aD,last_seq:aI})}!av.continuous&&av.attachments?iU(aD).then(aM):aM()}if(av=he(av),av.continuous){var aH=ap+":"+iC();return hi.Changes.addListener(ap,aH,ac,av),hi.Changes.notify(ap),{cancel:function(){hi.Changes.removeListener(ap,aH)}}}var aB=av.doc_ids&&new hQ.Set(av.doc_ids);av.since=av.since||0;var aI=av.since,aw="limit" in av?av.limit:-1;0===aw&&(aw=1);var ax;ax="return_docs" in av?av.return_docs:"returnDocs" in av?av.returnDocs:!0;var az,aE,aG,aL,aD=[],aK=0,au=I(av),ay=new hQ.Map;aJ()},ac._close=function(au){return null===af?au(gZ(hW)):(af.close(),delete fq[ap],af=null,void au())},ac._getRevisionTree=function(ax,av){var au=hC(af,[o],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(o).get(ax);aw.onsuccess=function(aA){var az=fZ(aA.target.result);az?av(null,az.rev_tree):av(gZ(ib))}},ac._doCompaction=function(aw,aA,av){var ay=[o,Z,m,eu],ax=hC(af,ay,"readwrite");if(ax.error){return av(ax.error)}var az=ax.txn,au=az.objectStore(o);au.get(aw).onsuccess=function(aC){var aE=fZ(aC.target.result);be(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==aA.indexOf(aI)&&(aH.status="missing")}),gm(aA,aw,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(o).put(f9(aE,aD,aB))},az.onabort=hH(av),az.oncomplete=function(){av()}},ac._getLocal=function(ax,av){var au=hC(af,[fS],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(fS).get(ax);aw.onerror=hH(av),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,av(null,az)):av(gZ(ib))}},ac._putLocal=function(aD,ay,au){"function"==typeof ay&&(au=ay,ay={}),delete aD._revisions;var aw=aD._rev,av=aD._id;aw?aD._rev="0-"+(parseInt(aw.split("-")[1],10)+1):aD._rev="0-1";var aA,aB=ay.ctx;if(!aB){var ax=hC(af,[fS],"readwrite");if(ax.error){return au(ax.error)}aB=ax.txn,aB.onerror=hH(au),aB.oncomplete=function(){aA&&au(null,aA)}}var az,aC=aB.objectStore(fS);aw?(az=aC.get(av),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aw){var aG=aC.put(aD);aG.onsuccess=function(){aA={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&au(null,aA)}}else{au(gZ(gS))}}):(az=aC.add(aD),az.onerror=function(aE){au(gZ(gS)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aA={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&au(null,aA)})},ac._removeLocal=function(aB,ax,aC){"function"==typeof ax&&(aC=ax,ax={});var av=ax.ctx;if(!av){var au=hC(af,[fS],"readwrite");if(au.error){return aC(au.error)}av=au.txn,av.oncomplete=function(){ay&&aC(null,ay)}}var ay,aA=aB._id,aw=av.objectStore(fS),az=aw.get(aA);az.onerror=hH(aC),az.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aB._rev?(aw["delete"](aA),ay={ok:!0,id:aA,rev:"0-0"},ax.ctx&&aC(null,ay)):aC(gZ(ib))}},ac._destroy=function(av,aw){hi.Changes.removeAllListeners(ap),hi.openReqList[ap]&&hi.openReqList[ap].result&&(hi.openReqList[ap].result.close(),delete fq[ap]);var au=indexedDB.deleteDatabase(ap);au.onsuccess=function(){hi.openReqList[ap]&&(hi.openReqList[ap]=null),jj()&&ap in localStorage&&delete localStorage[ap],aw(null,{ok:!0})},au.onerror=hH(aw)};var aj=fq[ap];if(aj){return af=aj.idb,ac._meta=aj.global,void gV.nextTick(function(){aq(null,ac)})}var t;t=ag.storage?cn(ap,ag.storage):indexedDB.open(ap,g5),"openReqList" in hi||(hi.openReqList={}),hi.openReqList[ap]=t,t.onupgradeneeded=function(aw){function ay(){var aA=az[au-1];au++,aA&&aA(ax,ay)}var av=aw.target.result;if(aw.oldVersion<1){return am(av)}var ax=aw.currentTarget.transaction;aw.oldVersion<3&&aa(av),aw.oldVersion<4&&al(av);var az=[ak,ah,ab,ad],au=aw.oldVersion;ay()},t.onsuccess=function(ax){af=ax.target.result,af.onversionchange=function(){af.close(),delete fq[ap]},af.onabort=function(aA){console.error("Database has a global failure",aA.target.error),af.close(),delete fq[ap]};var ay=af.transaction([fU,fa,o],"readwrite"),az=ay.objectStore(fU).get(fU),av=null,aw=null,au=null;az.onsuccess=function(aB){var aD=function(){null!==av&&null!==aw&&null!==au&&(ac._meta={name:ap,instanceId:au,blobSupport:av,docCount:aw},fq[ap]={idb:af,global:ac._meta},aq(null,ac))},aA=aB.target.result||{id:fU};ap+"_id" in aA?(au=aA[ap+"_id"],aD()):(au=iC(),aA[ap+"_id"]=au,ay.objectStore(fU).put(aA).onsuccess=function(){aD()}),an||(an=ga(ay)),an.then(function(aE){av=aE,aD()});var aC=ay.objectStore(o).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){aw=aE.target.result,aD()}}},t.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),aq(gZ(g7,av))}}function cn(t,aa){try{return indexedDB.open(t,{version:g5,storage:aa})}catch(ab){return indexedDB.open(t,g5)}}var ei=e(7),fR="default" in ei?ei["default"]:ei,W=e(6);W="default" in W?W["default"]:W;var hQ=e(12);hQ="default" in hQ?hQ["default"]:hQ;var hT=e(4),ao=e(1);ao="default" in ao?ao["default"]:ao;var iz=e(2);iz="default" in iz?iz["default"]:iz;var g6=e(10),jb="default" in g6?g6["default"]:g6,fW=e(8);fW="default" in fW?fW["default"]:fW;var iL=e(14);iL="default" in iL?iL["default"]:iL;var iq=e(15);iq="default" in iq?iq["default"]:iq;var hj=e(16);hj="default" in hj?hj["default"]:hj;var f7="function"==typeof Promise?Promise:fW,gR=h();W(g4,Error),g4.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var h8=new g4({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),iH=new g4({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ib=new g4({status:404,error:"not_found",reason:"missing"}),gS=new g4({status:409,error:"conflict",reason:"Document update conflict"}),dr=new g4({status:400,error:"invalid_id",reason:"_id field must contain a string"}),jc=new g4({status:412,error:"missing_id",reason:"_id is required for puts"}),iA=new g4({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hW=new g4({status:412,error:"precondition_failed",reason:"Database not open"}),hp=new g4({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),fx=new g4({status:500,error:"badarg",reason:"Some query argument is invalid"}),iE=new g4({status:400,error:"invalid_request",reason:"Request was invalid"}),gy=new g4({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),i1=new g4({status:500,error:"doc_validation",reason:"Bad special document member"}),hR=new g4({status:400,error:"bad_request",reason:"Something wrong with the request"}),dn=new g4({status:400,error:"bad_request",reason:"Document must be a JSON object"}),h2=new g4({status:404,error:"not_found",reason:"Database not found"}),g7=new g4({status:500,error:"indexed_db_went_bad",reason:"unknown"}),gn=new g4({status:500,error:"web_sql_went_bad",reason:"unknown"}),eq=new g4({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fv=new g4({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),a3=new g4({status:400,error:"bad_request",reason:"Invalid rev format"}),iW=new g4({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),fy=new g4({status:412,error:"missing_stub"}),hy=new g4({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),a5={UNAUTHORIZED:h8,MISSING_BULK_DOCS:iH,MISSING_DOC:ib,REV_CONFLICT:gS,INVALID_ID:dr,MISSING_ID:jc,RESERVED_ID:iA,NOT_OPEN:hW,UNKNOWN_ERROR:hp,BAD_ARG:fx,INVALID_REQUEST:iE,QUERY_PARSE_ERROR:gy,DOC_VALIDATION:i1,BAD_REQUEST:hR,NOT_AN_OBJECT:dn,DB_MISSING:h2,WSQ_ERROR:gn,LDB_ERROR:eq,FORBIDDEN:fv,INVALID_REV:a3,FILE_EXISTS:iW,MISSING_STUB:fy,IDB_ERROR:g7,INVALID_URL:hy},iF=function(aa,ac,ad){var ab=Object.keys(a5).filter(function(af){var ag=a5[af];return"function"!=typeof ag&&ag[aa]===ac}),t=ad&&ab.filter(function(af){var ag=a5[af];return ag.message===ad})[0]||ab[0];return t?a5[t]:null},q=function(){},co=iz("pouchdb:api");W(A,hT.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(aa){var ac=this,ad=aa.complete;if(aa=he(aa),"live" in aa&&!("continuous" in aa)&&(aa.continuous=aa.live),aa.processChange=hY,"latest"===aa.since&&(aa.since="now"),aa.since||(aa.since=0),"now"===aa.since){return void this.db.info().then(function(af){return ac.isCancelled?void ad(null,{status:"cancelled"}):(aa.since=af.update_seq,void ac.doChanges(aa))},ad)}if(aa.continuous&&"now"!==aa.since&&this.db.info().then(function(af){ac.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),aa.filter&&"string"==typeof aa.filter&&("_view"===aa.filter?aa.view=F(aa.view):aa.filter=F(aa.filter),"http"!==this.db.type()&&!aa.doc_ids)){return this.filterChanges(aa)}"descending" in aa||(aa.descending=!1),aa.limit=0===aa.limit?1:aa.limit,aa.complete=ad;var ab=this.db._changes(aa);if(ab&&"function"==typeof ab.cancel){var t=ac.cancel;ac.cancel=ao(function(af){ab.cancel(),t.apply(this,af)})}},A.prototype.filterChanges=function(aa){var ac=this,ad=aa.complete;if("_view"===aa.filter){if(!aa.view||"string"!=typeof aa.view){var ab=gZ(hR,"`view` filter parameter not found or invalid.");return ad(ab)}var t=gK(aa.view);this.db.get("_design/"+t[0],function(aj,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(aj){return ad(eo(aj))}var ah=ag&&ag.views&&ag.views[t[1]]&&ag.views[t[1]].map;return ah?(aa.filter=iT(ah),void ac.doChanges(aa)):ad(gZ(ib,ag.views?"missing json key: "+t[1]:"missing json key: views"))})}else{var af=gK(aa.filter);if(!af){return ac.doChanges(aa)}this.db.get("_design/"+af[0],function(ah,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(ah){return ad(eo(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(aa.filter=fp(aj),void ac.doChanges(aa)):ad(gZ(ib,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var iY="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),z=v(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),io=v(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);W(f6,hT.EventEmitter),f6.prototype.post=G("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(gZ(dn)):void this.bulkDocs({docs:[t]},aa,hb(ab))}),f6.prototype.put=G("put",ao(function(t){var ab,ag,aa,ad,ac=t.shift(),af="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(ad=t.pop())(gZ(dn))}for(;;){if(ab=t.shift(),ag=typeof ab,"string"!==ag||af?"string"!==ag||!af||"_rev" in ac?"object"===ag?aa=ab:"function"===ag&&(ad=ab):ac._rev=ab:(ac._id=ab,af=!0),!t.length){break}}return aa=aa||{},C(ac._id),gA(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,ad):this._putLocal(ac,ad):void this.bulkDocs({docs:[ac]},aa,hb(ad))})),f6.prototype.putAttachment=G("putAttachment",function(t,ac,ag,aa,ah,ad){function af(aj){return aj._attachments=aj._attachments||{},aj._attachments[ac]={content_type:ah,data:aa},ab.put(aj)}var ab=this;return"function"==typeof ah&&(ad=ah,ah=aa,aa=ag,ag=null),"undefined"==typeof ah&&(ah=aa,aa=ag,ag=null),ab.get(t).then(function(aj){if(aj._rev!==ag){throw gZ(gS)}return af(aj)},function(aj){if(aj.reason===ib.message){return af({_id:t})}throw aj})}),f6.prototype.removeAttachment=G("removeAttachment",function(aa,ac,ad,ab){var t=this;t.get(aa,function(af,ag){return af?void ab(af):ag._rev!==ad?void ab(gZ(gS)):ag._attachments?(delete ag._attachments[ac],0===Object.keys(ag._attachments).length&&delete ag._attachments,void t.put(ag,ab)):ab()})}),f6.prototype.remove=G("remove",function(aa,ac,ad,ab){var t;"string"==typeof ac?(t={_id:aa,_rev:ac},"function"==typeof ad&&(ab=ad,ad={})):(t=aa,"function"==typeof ac?(ab=ac,ad={}):(ab=ad,ad=ac)),ad=ad||{},ad.was_delete=!0;var af={_id:t._id,_rev:t._rev||ad.rev};return af._deleted=!0,gA(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(t,ab):void this.bulkDocs({docs:[af]},ad,hb(ab))}),f6.prototype.revsDiff=G("revsDiff",function(t,ac,ag){function aa(ak,aj){ab.has(ak)||ab.set(ak,{missing:[]}),ab.get(ak).missing.push(aj)}function ah(aj,ak){var al=t[aj].slice(0);be(ak,function(aq,av,aw,ap,am){var ax=av+"-"+aw,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==am.status&&aa(aj,ax))}),al.forEach(function(am){aa(aj,am)})}"function"==typeof ac&&(ag=ac,ac={});var ad=Object.keys(t);if(!ad.length){return ag(null,{})}var af=0,ab=new hQ.Map;ad.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ab.set(aj,{missing:t[aj]})}else{if(al){return ag(al)}ah(aj,am)}if(++af===ad.length){var ak={};return ab.forEach(function(ap,aq){ak[aq]=ap}),ag(null,ak)}})},this)}),f6.prototype.bulkGet=G("bulkGet",function(t,aa){h7(this,t,aa)}),f6.prototype.compactDocument=G("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(ag,aj){if(ag){return t(ag)}var af=fe(aj),ah=[],ad=[];Object.keys(af).forEach(function(ak){af[ak]>ac&&ah.push(ak)}),be(aj,function(ak,am,aq,al,au){var ap=am+"-"+aq;"available"===au.status&&-1!==ah.indexOf(ap)&&ad.push(ap)}),ab._doCompaction(aa,ad,t)})}),f6.prototype.compact=G("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&h3(ab)}),f6.prototype._compact=function(t,ab){function ag(ah){af.push(ad.compactDocument(ah.id,0))}function aa(ah){var aj=ah.last_seq;f7.all(af).then(function(){return gf(ad,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ab(null,{ok:!0})})["catch"](ab)}var ad=this,ac={return_docs:!1,last_seq:t.last_seq||0},af=[];ad.changes(ac).on("change",ag).on("complete",aa).on("error",ab)},f6.prototype.get=G("get",function(t,ac,ag){function aa(){var ak=[],aj=ah.length;return aj?void ah.forEach(function(al){ad.get(t,{rev:al,revs:ac.revs,attachments:ac.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ag(null,ak)})}):ag(null,ak)}if("function"==typeof ac&&(ag=ac,ac={}),"string"!=typeof t){return ag(gZ(dr))}if(gA(t)&&"function"==typeof this._getLocal){return this._getLocal(t,ag)}var ah=[],ad=this;if(!ac.open_revs){return this._get(t,ac,function(aq,aA){if(aq){return ag(aq)}var ay=aA.doc,ap=aA.metadata,ax=aA.ctx;if(ac.conflicts){var az=u(ap);az.length&&(ay._conflicts=az)}if(gT(ap,ay._rev)&&(ay._deleted=!0),ac.revs||ac.revs_info){var aj=E(ap.rev_tree),au=g0(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ay._rev.split("-")[1])}),aB=au.ids.map(function(aC){return aC.id}).indexOf(ay._rev.split("-")[1])+1,am=au.ids.length-aB;if(au.ids.splice(aB,am),au.ids.reverse(),ac.revs&&(ay._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ac.revs_info){var al=au.pos+au.ids.length;ay._revs_info=au.ids.map(function(aC){return al--,{rev:al+"-"+aC.id,status:aC.opts.status}})}}if(ac.attachments&&ay._attachments){var ak=ay._attachments,aw=Object.keys(ak).length;if(0===aw){return ag(null,ay)}Object.keys(ak).forEach(function(aC){this._getAttachment(ak[aC],{binary:ac.binary,ctx:ax},function(aE,aD){var aF=ay._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aw||ag(null,ay)})},ad)}else{if(ay._attachments){for(var av in ay._attachments){ay._attachments.hasOwnProperty(av)&&(ay._attachments[av].stub=!0)}}ag(null,ay)}})}if("all"===ac.open_revs){this._getRevisionTree(t,function(ak,aj){return ak?ag(ak):(ah=ij(aj).map(function(al){return al.rev}),void aa())})}else{if(!Array.isArray(ac.open_revs)){return ag(gZ(hp,"function_clause"))}ah=ac.open_revs;for(var af=0;af<ah.length;af++){var ab=ah[af];if("string"!=typeof ab||!/^\d+-/.test(ab)){return ag(gZ(a3))}}aa()}}),f6.prototype.getAttachment=G("getAttachment",function(aa,ac,ad,ab){var t=this;ad instanceof Function&&(ab=ad,ad={}),this._get(aa,ad,function(af,ag){return af?ab(af):ag.doc._attachments&&ag.doc._attachments[ac]?(ad.ctx=ag.ctx,ad.binary=!0,t._getAttachment(ag.doc._attachments[ac],ad,ab),void 0):ab(gZ(ib))})}),f6.prototype.allDocs=G("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(gZ(gy,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return gi(this,t,aa)}}return this._allDocs(t,aa)}),f6.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new A(this,t,aa)},f6.prototype.close=G("close",function(t){return this._closed=!0,this._close(t)}),f6.prototype.info=G("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),f6.prototype.id=G("id",function(t){return this._id(t)}),f6.prototype.bulkDocs=G("bulkDocs",function(aa,ac,ad){if("function"==typeof ac&&(ad=ac,ac={}),ac=ac||{},Array.isArray(aa)&&(aa={docs:aa}),!aa||!aa.docs||!Array.isArray(aa.docs)){return ad(gZ(iH))}for(var ab=0;ab<aa.docs.length;++ab){if("object"!=typeof aa.docs[ab]||Array.isArray(aa.docs[ab])){return ad(gZ(dn))}}var t;return aa.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){t=t||ee(ag)})}),t?ad(gZ(hR,t)):("new_edits" in ac||("new_edits" in aa?ac.new_edits=aa.new_edits:ac.new_edits=!0),ac.new_edits||"http"===this.type()||aa.docs.sort(i0),hw(aa.docs),this._bulkDocs(aa,ac,function(af,ag){return af?ad(af):(ac.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ad(null,ag))}))}),f6.prototype.registerDependentDatabase=G("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);gf(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),f6.prototype.destroy=G("destroy",function(aa,ac){function ad(){ab._destroy(aa,function(ag,af){return ag?ac(ag):(ab.emit("destroyed"),void ac(null,af||{ok:!0}))})}"function"==typeof aa&&(ac=aa,aa={});var ab=this,t="use_prefix" in ab?ab.use_prefix:!0;return"http"===ab.type()?ad():void ab.get("_local/_pouch_dependentDbs",function(ag,aj){if(ag){return 404!==ag.status?ac(ag):ad()}var af=aj.dependentDbs,ah=ab.constructor,ak=Object.keys(af).map(function(al){var am=t?al.replace(new RegExp("^"+ah.prefix),""):al;return new ah(am,ab.__opts).destroy()});f7.all(ak).then(ad,ac)})}),J.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},J.prototype.fail=function(t){this.failed=t,this.execute()},J.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},J.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},W(hG,f6),hG.debug=iz;var hL;if(i()){hL=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),hL=!!localStorage.getItem("_pouch_check_localstorage")}catch(et){hL=!1}}hG.adapters={},hG.preferredAdapters=[],hG.prefix="_pouch_";var iS=new hT.EventEmitter;de(hG),hG.parseAdapter=function(t,ac){var ag,aa,ah=t.match(/([a-z\-]*):\/\/(.*)/);if(ah){if(t=/http(s?)/.test(ah[1])?ah[1]+"://"+ah[2]:ah[2],ag=ah[1],!hG.adapters[ag].valid()){throw"Invalid adapter"}return{name:t,adapter:ah[1]}}var ad="idb" in hG.adapters&&"websql" in hG.adapters&&jj()&&localStorage["_pouch__websqldb_"+hG.prefix+t];if(ac.adapter){aa=ac.adapter}else{if("undefined"!=typeof ac&&ac.db){aa="leveldb"}else{for(var af=0;af<hG.preferredAdapters.length;++af){if(aa=hG.preferredAdapters[af],aa in hG.adapters){if(ad&&"idb"===aa){console.log('PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ag=hG.adapters[aa];var ab=ag&&"use_prefix" in ag?ag.use_prefix:!0;return{name:ab?hG.prefix+t:t,adapter:aa}},hG.adapter=function(t,aa,ab){aa.valid()&&(hG.adapters[t]=aa,ab&&hG.preferredAdapters.push(t))},hG.plugin=function(t){return Object.keys(t).forEach(function(aa){hG.prototype[aa]=t[aa]}),hG},hG.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=ei.extend({},t,ad),void hG.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return W(aa,hG),de(aa),aa.preferredAdapters=hG.preferredAdapters.slice(),Object.keys(hG).forEach(function(ab){ab in aa||(aa[ab]=hG[ab])}),aa};var fX=function(t){return atob(t)},i4=function(t){return btoa(t)},hP=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],hk="queryKey",ie=/(?:^|&)([^&=]*)=?([^&]*)/g,a6=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f4=fR.extend,go={ajax:ig,parseUri:ez,uuid:iC,Promise:f7,atob:fX,btoa:i4,binaryStringToBlobOrBuffer:k,clone:he,extend:f4,createError:gZ},f=jb.collate,at=1,f1="pouchdb",fn=5,ft=0;B.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},B.prototype.updateTarget=function(t,aa){return g9(this.target,this.id,t,aa,this.returnValue)},B.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?f7.resolve(!0):g9(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return ab.readOnlySource=!0,!0}throw ac})};var it={undefined:function(t,aa){return 0===f(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return a7(aa,t).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ft}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in it?it[ab](aa,ac):ft},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ft}).then(function(){return ft},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):ft})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ft})};var gc=0,ja=gD.setImmediate||gD.setTimeout,er=32768,hg=y(function(ac,ak){function af(){var aq=aj*ad,al=aq+ad;if(aj++,aa>aj){ab(t,ac,aq,al),ja(af)}else{ab(t,ac,aq,al);var ap=t.end(!0),am=ii(ap);ak(null,am),t.destroy()}}var ah="string"==typeof ac,ag=ah?ac.length:ac.byteLength,ad=Math.min(er,ag),aa=Math.ceil(ag/ad),aj=0,t=ah?new iq:new iq.ArrayBuffer,ab=ah?fz:gO;af()});W(i5,hT.EventEmitter),i5.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},i5.prototype.ready=function(aa,ac){function ad(){t.cancel()}function ab(){aa.removeListener("destroyed",ad),ac.removeListener("destroyed",ad)}var t=this;t._readyCalled||(t._readyCalled=!0,aa.once("destroyed",ad),ac.once("destroyed",ad),t.once("complete",ab))};var fV={replicate:hD,toPouch:fo},gW=fV.replicate;W(il,hT.EventEmitter),il.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var je=25,h4=50,hO={},x=1800,iD=iz("pouchdb:http");fl.valid=function(){return !0};var i2=function(t,aa){return aa&&t.then(function(ab){gV.nextTick(function(){aa(null,ab)})},function(ab){gV.nextTick(function(){aa(ab)})}),t},fh=function(t){return ao(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&i2(ab,aa),ab})},hq=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},gQ=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},hJ=function(aa){for(var ac={},ad=0,ab=aa.length;ab>ad;ad++){ac["$"+aa[ad]]=!0}var t=Object.keys(ac),af=new Array(t.length);for(ad=0,ab=t.length;ab>ad;ad++){af[ad]=t[ad].substring(1)}return af},gE={uniq:hJ,sequentialize:gQ,fin:hq,callbackify:fh,promisedCallback:i2};iM.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},iM.prototype.finish=function(){return this.promise};var hh,gg=jb.collate,hZ=jb.toIndexableString,gI=jb.normalizeKey,g3=jb.parseIndexableString;hh="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var f2=gE.callbackify,i7=gE.sequentialize,gX=gE.uniq,gH=gE.fin,fs=gE.promisedCallback,gh={},cr=new iM,gN=50,fu={_sum:function(t,aa){return iu(aa)},_count:function(t,aa){return aa.length},_stats:function(t,aa){function ab(ac){for(var af=0,ag=0,ad=ac.length;ad>ag;ag++){var ah=ac[ag];af+=ah*ah}return af}return{sum:iu(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},U=f2(function(){var t=this;return"http"===t.type()?ix(t):"function"==typeof t._viewCleanup?gt(t):iP(t)}),w=function(aa,ac,ad){"function"==typeof ac&&(ad=ac,ac={}),ac=ac?hI(ac):{},"function"==typeof aa&&(aa={map:aa});var ab=this,t=f7.resolve().then(function(){return gL(ab,aa,ac)});return fs(t,ad),t};W(gU,Error),W(hU,Error),W(jg,Error);var g2={query:w,viewCleanup:U},f8=7,ik=fi("document-store"),R=fi("by-sequence"),X=fi("attach-store"),hf=fi("local-store"),jd=fi("metadata-store"),gB=fi("attach-seq-store"),hn={};W(hc,hT.EventEmitter),hc.prototype.addListener=function(t,ab,ag,aa){function ad(){function aj(){af=!1}if(ac._listeners[ab]){if(af){return void (af="waiting")}af=!0;var ah=ar(aa,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>aa.since&&!aa.cancelled&&(aa.since=ak.seq,aa.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ad()},0),af=!1}).on("error",aj)}}if(!this._listeners[ab]){var ac=this,af=!1;this._listeners[ab]=ad,this.on(t,ad)}},hc.prototype.removeListener=function(t,aa){aa in this._listeners&&hT.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},hc.prototype.notifyLocalWindows=function(t){i()?chrome.storage.local.set({dbName:t}):jj()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},hc.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var fc=1,ff="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+R+" (seq, deleted)",a0="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+R+" (doc_id, rev)",bn="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+ik+" (winningseq)",ir="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+gB+" (seq)",ae="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+gB+" (digest, seq)",gP=R+".seq = "+ik+".winningseq",fr=R+".seq AS seq, "+R+".deleted AS deleted, "+R+".json AS data, "+R+".rev AS rev, "+ik+".json AS metadata";hx.valid=hs,hx.Changes=new hc;var an,g5=5,o="document-store",Z="by-sequence",m="attach-store",eu="attach-seq-store",fU="meta-store",fS="local-store",fa="detect-blob-support",en={running:!1,queue:[]},fq={};hi.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},hi.Changes=new hc;var fw={idb:hi,websql:hx};hG.ajax=ig,hG.utils=go,hG.Errors=a5,hG.replicate=fV.replicate,hG.sync=hl,hG.version="5.2.0",hG.adapter("http",fl),hG.adapter("https",fl),hG.plugin(g2),Object.keys(fw).forEach(function(t){hG.adapter(t,fw[t],!0)}),a.exports=hG}).call(this,e(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});