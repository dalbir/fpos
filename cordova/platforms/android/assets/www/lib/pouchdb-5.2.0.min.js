!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(n,h){if(!b[n]){if(!i[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(a){return a(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=b[n]={exports:{}};i[n][0].call(g.exports,function(m){var p=i[n][1][m];return k(p?p:m)},g,g.exports,d,i,b,l)}return b[n].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var g="color: "+this.color;h=[h[0],g,"color: inherit"].concat(Array.prototype.slice.call(h,1));var f=0,j=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),h.splice(j,0,g),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(j){function g(){}function k(){var m=k,w=+new Date,l=w-(b||w);m.diff=l,m.prev=b,m.curr=w,b=w,null==m.useColors&&(m.useColors=n.useColors()),null==m.color&&m.useColors&&(m.color=r());var q=Array.prototype.slice.call(arguments);q[0]=n.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=n.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof n.formatArgs&&(q=n.formatArgs.apply(m,q));var p=k.log||n.log||console.log.bind(console);p.apply(m,q)}g.enabled=!1,k.enabled=!0;var h=n.enabled(j)?k:g;return h.namespace=j,h}function i(k){n.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?n.skips.push(new RegExp("^"+k.substr(1)+"$")):n.names.push(new RegExp("^"+k+"$")))}}function a(){n.enable("")}function s(g){var j,h;for(j=0,h=n.skips.length;h>j;j++){if(n.skips[j].test(g)){return !1}}for(j=0,h=n.names.length;h>j;j++){if(n.names[j].test(g)){return !0}}return !1}function u(g){return g instanceof Error?g.stack||g.message:g}n=t.exports=o,n.coerce=u,n.disable=a,n.enable=i,n.enabled=s,n.humanize=e(9),n.names=[],n.skips=[],n.formatters={};var b,f=0},{9:9}],4:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,l,j,r,f,h;if(this._events||(this._events={}),"error"===g&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[g],i(l)){return !1}if(o(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(m(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(m(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(a,b,e){(function(y){function l(){z=!0;for(var h,j,g=i.length;g;){for(j=i,i=[],h=-1;++h<g;){j[h]()}g=i.length}z=!1}function r(g){1!==i.push(g)||z||o()}var o,f=y.MutationObserver||y.WebKitMutationObserver;if(f){var x=0,s=new f(l),u=y.document.createTextNode("");s.observe(u,{characterData:!0}),o=function(){u.data=x=++x%2}}else{if(y.setImmediate||"undefined"==typeof y.MessageChannel){o="document" in y&&"onreadystatechange" in y.document.createElement("script")?function(){var g=y.document.createElement("script");g.onreadystatechange=function(){l(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},y.document.documentElement.appendChild(g)}:function(){setTimeout(l,0)}}else{var n=new y.MessageChannel;n.port1.onmessage=l,o=function(){n.port2.postMessage(0)}}}var z,i=[];b.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(a,b,e){(function(f){f("object"==typeof e?e:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(n){if(n){for(var i in n){"object"==typeof n[i]&&h[i]?k.call(h,h[i],n[i]):h[i]=n[i]}}}),h};j.extend=k})},{}],8:[function(n,u,f){function o(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=b,this.queue=[],this.outcome=void 0,g!==o&&y(this,g)}function m(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function a(j,k,g){l(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function h(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=i(j);"error"===z.status&&w(z.value)}function i(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function t(g){return g instanceof this?g:K.resolve(new this(o),g)}function s(g){var j=new this(o);return K.reject(j,g)}function e(x){function j(E,D){function C(F){A[D]=F,++w!==g||z||(z=!0,K.resolve(q,A))}B.resolve(E).then(C,function(F){z||(z=!0,K.reject(q,F))})}var B=this;if("[object Array]"!==Object.prototype.toString.call(x)){return this.reject(new TypeError("must be an array"))}var g=x.length,z=!1;if(!g){return this.resolve([])}for(var A=new Array(g),w=0,k=-1,q=new this(o);++k<g;){j(x[k],k)}return q}function r(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(o);++z<j;){g(k[z])}return q}var l=n(5),K={},L=["REJECTED"],p=["FULFILLED"],b=["PENDING"];u.exports=f=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===p||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(o);if(this.state!==b){var k=this.state===p?q:g;a(j,k,this.outcome)}else{this.queue.push(new m(j,q,g))}return j},m.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},m.prototype.otherCallFulfilled=function(g){a(this.promise,this.onFulfilled,g)},m.prototype.callRejected=function(g){K.reject(this.promise,g)},m.prototype.otherCallRejected=function(g){a(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=i(h,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=p,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},f.resolve=t,f.reject=s,f.all=e,f.race=r},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(s,l,i){function b(g){if(null!==g){switch(typeof g){case"boolean":return g?1:0;case"number":return a(g);case"string":return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var q=Array.isArray(g),j=q?g:Object.keys(g),w=-1,m=j.length,k="";if(q){for(;++w<m;){k+=i.toIndexableString(j[w])}}else{for(;++w<m;){var v=j[w];k+=i.toIndexableString(v)+i.toIndexableString(g[v])}}return k}}return""}function r(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+p),x=parseInt(v,10)+t;for(j&&(x=-x),w+=p;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function D(j,w){var q=j.pop();if(w.length){var v=w[w.length-1];q===v.element&&(w.pop(),v=w[w.length-1]);var m=v.element,g=v.index;if(Array.isArray(m)){m.push(q)}else{if(g===j.length-2){var k=j.pop();m[k]=q}else{j.push(q)}}}}function h(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=i.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(g,q){for(var j=Object.keys(g),w=Object.keys(q),m=Math.min(j.length,w.length),k=0;m>k;k++){var v=i.collate(j[k],w[k]);if(0!==v){return v}if(v=i.collate(g[j[k]],q[w[k]]),0!==v){return v}}return j.length===w.length?0:j.length>w.length?1:-1}function o(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(m){if(0===m){return"1"}var g=m.toExponential().split(/e\+?/),v=parseInt(g[1],10),x=0>m,w=x?"0":"2",q=(x?-v:v)-t,k=n.padLeft(q.toString(),"0",p);w+=f+k;var y=Math.abs(parseFloat(g[0]));x&&(y=10-y);var j=y.toFixed(20);return j=j.replace(/\.?0+$/,""),w+=f+j}var t=-324,p=3,f="",n=s(11);i.collate=function(j,m){if(j===m){return 0}j=i.normalizeKey(j),m=i.normalizeKey(m);var k=o(j),g=o(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?h(j,m):u(j,m)},i.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=i.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=i.normalizeKey(m))}}}}}return g},i.toIndexableString=function(g){var j="\x00";return g=i.normalizeKey(g),o(g)+f+b(g)+j},i.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=r(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}D(w,m)}}}},{11:11}],11:[function(h,b,e){function a(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var o,f=r.length,g=n.length;for(o=0;f>o;o++){if(o===g){return 1}var i=r.charAt(o),q=n.charAt(o);if(i!==q){return q>i?-1:1}}return g>f?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(o,p){var q,g,r,n;g=[],n=[];for(q in p){h.call(p,q)&&(r=p[q],"this"!==q&&(g.push(q),n.push(r)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],n)}}).call(this)},{}],15:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(m){function u(j,w,z,k,q,x){return w=t(t(w,j),t(k,x)),t(w<<q|w>>>32-q,z)}function P(j,w,k,q,A,z,x){return u(w&k|~w&q,j,w,A,z,x)}function l(j,w,k,q,A,z,x){return u(w&q|k&~q,j,w,A,z,x)}function s(j,w,k,q,A,z,x){return u(w^k^q,j,w,A,z,x)}function Q(j,w,k,q,A,z,x){return u(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=P(z,k,x,q,w[0],7,-680876936),q=P(q,z,k,x,w[1],12,-389564586),x=P(x,q,z,k,w[2],17,606105819),k=P(k,x,q,z,w[3],22,-1044525330),z=P(z,k,x,q,w[4],7,-176418897),q=P(q,z,k,x,w[5],12,1200080426),x=P(x,q,z,k,w[6],17,-1473231341),k=P(k,x,q,z,w[7],22,-45705983),z=P(z,k,x,q,w[8],7,1770035416),q=P(q,z,k,x,w[9],12,-1958414417),x=P(x,q,z,k,w[10],17,-42063),k=P(k,x,q,z,w[11],22,-1990404162),z=P(z,k,x,q,w[12],7,1804603682),q=P(q,z,k,x,w[13],12,-40341101),x=P(x,q,z,k,w[14],17,-1502002290),k=P(k,x,q,z,w[15],22,1236535329),z=l(z,k,x,q,w[1],5,-165796510),q=l(q,z,k,x,w[6],9,-1069501632),x=l(x,q,z,k,w[11],14,643717713),k=l(k,x,q,z,w[0],20,-373897302),z=l(z,k,x,q,w[5],5,-701558691),q=l(q,z,k,x,w[10],9,38016083),x=l(x,q,z,k,w[15],14,-660478335),k=l(k,x,q,z,w[4],20,-405537848),z=l(z,k,x,q,w[9],5,568446438),q=l(q,z,k,x,w[14],9,-1019803690),x=l(x,q,z,k,w[3],14,-187363961),k=l(k,x,q,z,w[8],20,1163531501),z=l(z,k,x,q,w[13],5,-1444681467),q=l(q,z,k,x,w[2],9,-51403784),x=l(x,q,z,k,w[7],14,1735328473),k=l(k,x,q,z,w[12],20,-1926607734),z=s(z,k,x,q,w[5],4,-378558),q=s(q,z,k,x,w[8],11,-2022574463),x=s(x,q,z,k,w[11],16,1839030562),k=s(k,x,q,z,w[14],23,-35309556),z=s(z,k,x,q,w[1],4,-1530992060),q=s(q,z,k,x,w[4],11,1272893353),x=s(x,q,z,k,w[7],16,-155497632),k=s(k,x,q,z,w[10],23,-1094730640),z=s(z,k,x,q,w[13],4,681279174),q=s(q,z,k,x,w[0],11,-358537222),x=s(x,q,z,k,w[3],16,-722521979),k=s(k,x,q,z,w[6],23,76029189),z=s(z,k,x,q,w[9],4,-640364487),q=s(q,z,k,x,w[12],11,-421815835),x=s(x,q,z,k,w[15],16,530742520),k=s(k,x,q,z,w[2],23,-995338651),z=Q(z,k,x,q,w[0],6,-198630844),q=Q(q,z,k,x,w[7],10,1126891415),x=Q(x,q,z,k,w[14],15,-1416354905),k=Q(k,x,q,z,w[5],21,-57434055),z=Q(z,k,x,q,w[12],6,1700485571),q=Q(q,z,k,x,w[3],10,-1894986606),x=Q(x,q,z,k,w[10],15,-1051523),k=Q(k,x,q,z,w[1],21,-2054922799),z=Q(z,k,x,q,w[8],6,1873313359),q=Q(q,z,k,x,w[15],10,-30611744),x=Q(x,q,z,k,w[6],15,-1560198380),k=Q(k,x,q,z,w[13],21,1309151649),z=Q(z,k,x,q,w[4],6,-145523070),q=Q(q,z,k,x,w[11],10,-1120210379),x=Q(x,q,z,k,w[2],15,718787259),k=Q(k,x,q,z,w[9],21,-343485551),j[0]=t(z,j[0]),j[1]=t(k,j[1]),j[2]=t(x,j[2]),j[3]=t(q,j[3])}function n(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function o(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function v(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,n(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function r(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,o(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function O(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function y(j){var k;for(k=0;k<j.length;k+=1){j[k]=O(j[k])}return j.join("")}function p(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function i(){this.reset()}var t=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==y(v("hello"))&&(t=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(q,C){var B,D,x,w,k=this.byteLength,A=j(q,k),z=k;return C!==m&&(z=j(C,k)),A>z?new ArrayBuffer(0):(B=z-A,D=new ArrayBuffer(B),x=new Uint8Array(D),w=new Uint8Array(this,A,B),x.set(w),D)}}(),i.prototype.append=function(j){return this.appendBinary(p(j)),this},i.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,n(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},i.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},i.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},i.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},i.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},i.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},i.hash=function(j,k){return i.hashBinary(p(j),k)},i.hashBinary=function(j,w){var q=v(j),k=y(q);return w?e(k):k},i.ArrayBuffer=function(){this.reset()},i.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,o(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},i.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},i.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.ArrayBuffer.prototype.getState=function(){var j=i.prototype.getState.call(this);return j.buff=S(j.buff),j},i.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),i.prototype.setState.call(this,j)},i.ArrayBuffer.prototype.destroy=i.prototype.destroy,i.ArrayBuffer.prototype._finish=i.prototype._finish,i.ArrayBuffer.hash=function(j,w){var q=r(new Uint8Array(j)),k=y(q);return w?e(k):k},i})},{}],16:[function(h,b,e){function a(r,n,o){var f=o[o.length-1];r===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,i=f.index;if(Array.isArray(g)){g.push(r)}else{if(i===n.length-2){var q=n.pop();g[q]=r}else{n.push(r)}}}e.stringify=function(f){var i=[];i.push({obj:f});for(var g,D,s,n,l,E,F,t,u,o,r,C="";g=i.pop();){if(D=g.obj,s=g.prefix||"",n=g.val||"",C+=s,n){C+=n}else{if("object"!=typeof D){C+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){C+="null"}else{if(Array.isArray(D)){for(i.push({val:"]"}),l=D.length-1;l>=0;l--){E=0===l?"":",",i.push({obj:D[l],prefix:E})}i.push({val:"["})}else{F=[];for(t in D){D.hasOwnProperty(t)&&F.push(t)}for(i.push({val:"}"}),l=F.length-1;l>=0;l--){u=F[l],o=D[u],r=l>0?",":"",r+=JSON.stringify(u)+":",i.push({obj:o,prefix:r})}i.push({val:"{"})}}}}}return C},e.parse=function(o){for(var s,i,D,A,l,u,g,f,B,t=[],C=[],n=0;;){if(s=o[n++],"}"!==s&&"]"!==s&&"undefined"!=typeof s){switch(s){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,a(null,t,C);break;case"t":n+=3,a(!0,t,C);break;case"f":n+=4,a(!1,t,C);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(i="",n--;;){if(D=o[n++],!/[\d\.\-e\+]/.test(D)){n--;break}i+=D}a(parseFloat(i),t,C);break;case'"':for(A="",l=void 0,u=0;;){if(g=o[n++],'"'===g&&("\\"!==l||u%2!==1)){break}A+=g,l=g,"\\"===l?u++:u=0}a(JSON.parse('"'+A+'"'),t,C);break;case"[":f={element:[],index:t.length},t.push(f.element),C.push(f);break;case"{":B={element:{},index:t.length},t.push(B.element),C.push(B);break;default:throw new Error("unexpectedly reached end of input: "+s)}}else{if(1===t.length){return t.pop()}a(t.pop(),t,C)}}}},{}],17:[function(a,b,e){(function(i,o){function p(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function ii(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function fR(){for(var t={},ab=new hp(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,hp.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function hb(ab,af){var t,ac,aa,ad=new Headers,ag={method:ab.method,credentials:"include",headers:ad};return ab.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?ii(ab.body,function(ah){ag.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?ag.body=JSON.stringify(ab.body):"body" in ab?ag.body=ab.body:ag.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&ad.set(ah,ab.headers[ah])}),t=fR(ab.url,ag),ab.timeout>0&&(ac=setTimeout(function(){t.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),t.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?af(null,aa,ah):af(ah,aa)})["catch"](function(ah){af(ah,aa)}),{abort:t.reject}}function gb(aa,ad){var t,ab,ag=function(){t.abort()};t=aa.xhr?new aa.xhr:new XMLHttpRequest;try{t.open(aa.method,aa.url)}catch(ac){ad(ac,{statusCode:413})}t.withCredentials="withCredentials" in aa?aa.withCredentials:!0,"GET"===aa.method?delete aa.headers["Content-Type"]:aa.json&&(aa.headers.Accept="application/json",aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json",aa.body&&aa.processData&&"string"!=typeof aa.body&&(aa.body=JSON.stringify(aa.body))),aa.binary&&(t.responseType="arraybuffer"),"body" in aa||(aa.body=null);for(var af in aa.headers){aa.headers.hasOwnProperty(af)&&t.setRequestHeader(af,aa.headers[af])}return aa.timeout>0&&(ab=setTimeout(ag,aa.timeout),t.onprogress=function(){clearTimeout(ab),ab=setTimeout(ag,aa.timeout)},"undefined"!=typeof t.upload&&(t.upload.onprogress=t.onprogress)),t.onreadystatechange=function(){if(4===t.readyState){var al={statusCode:t.status};if(t.status>=200&&t.status<300){var aj;aj=aa.binary?p([t.response||""],{type:t.getResponseHeader("Content-Type")}):t.responseText,ad(null,al,aj)}else{var ak={};try{ak=JSON.parse(t.response)}catch(ah){}ad(ak,al)}}},aa.body&&aa.body instanceof Blob?ii(aa.body,function(ah){t.send(ah)}):t.send(aa.body),{abort:ag}}function fp(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function iU(aa,t){return go||aa.xhr?gb(aa,t):hb(aa,t)}function i9(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function hA(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=i9.prototype,new aa(ab)}function g0(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=iH("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=hL:"doc_validation"===t?(ac=hH,aa=af):"bad_request"===t&&ac.message!==af&&(ac=T),ac||(ac=iH("status",ab.status,af)||gd),ad=hA(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function W(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function f9(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function gJ(ab){if(ab instanceof ArrayBuffer){return f9(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function iK(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=iK(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(W(ab)){return gJ(ab)}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=iK(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function U(){return""}function gu(ab,ad){function t(af,ag,aj){if(!ab.binary&&ab.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?g0(ak):ak})),ab.binary&&iB(af,ag),aj(null,af,ag)}function ac(al,ag){var aj,af;if(al.code&&al.status){var ak=new Error(al.message||al.code);return ak.status=al.status,ag(ak)}try{aj=JSON.parse(al.responseText),af=g0(aj)}catch(ah){af=g0(al)}ag(af)}ab=iK(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=fj.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),iU(ab,function(al,ag,aj){if(al){return al.status=ag?ag.statusCode:400,ac(al,ad)}var af,ah=ag.headers&&ag.headers["content-type"],ak=aj||U();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof ak&&(/json/.test(ah)||/^[\s]*\{/.test(ak)&&/\}[\s]*$/.test(ak))){try{ak=JSON.parse(ak.toString())}catch(am){}}ag.statusCode>=200&&ag.statusCode<300?t(ak,ag,ad):(af=g0(ak),af.status=ag.statusCode,ad(af))})}function gZ(af,ad){var ac=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ab=-1!==ac.indexOf("safari")&&-1===ac.indexOf("chrome"),t=-1!==ac.indexOf("msie"),ah=ab&&"POST"===af.method||t&&"GET"===af.method,aa="cache" in af?af.cache:!0;if(ah||!aa){var ag=-1!==af.url.indexOf("?");af.url+=(ag?"&":"?")+"_nonce="+Date.now()}return gu(af,ad)}function K(aa){var t=!1;return S(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function gV(t){return S(function(ac){ac=iK(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){i.nextTick(function(){ad(ag,ah)})});var af=new hp(function(ag,ah){var ak;try{var al=K(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function ew(ab,t){function aa(ad,ag,aj){if(O.enabled){for(var af=[ad._db_name,ag],ac=0;ac<aj.length-1;ac++){af.push(aj[ac])}O.apply(null,af);var ah=aj[aj.length-1];aj[aj.length-1]=function(ak,am){var al=[ad._db_name,ag];al=al.concat(ak?["error",ak]:["success",am]),O.apply(null,al),ah(ak,am)}}}return gV(S(function(ad){if(this._closed){return hp.reject(new Error("database is closed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new hp(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function iO(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function f6(ab,t,aa){return new hp(function(ad,ac){ab.get(t,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=aa(af);return aj?(aj._id=t,aj._rev=ag,void ad(be(ab,aj,aa))):ad({updated:!1,rev:ag})})})}function be(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return f6(ab,t._id,aa)})}function gq(t){for(var al,ah,ak,aj,af=t.rev_tree.slice();aj=af.pop();){var ap=aj.ids,ad=ap[2],am=aj.pos;if(ad.length){for(var aa=0,ac=ad.length;ac>aa;aa++){af.push({pos:am+1,ids:ad[aa]})}}else{var ag=!!ap[1].deleted,ab=ap[0];(!al||(ak!==ag?ak:ah!==am?am>ah:ab>al))&&(al=ab,ah=am,ak=ag)}}return ah+"-"+al}function ee(t){return t.ids}function ig(ab,ad){ad||(ad=gq(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(ee);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function i3(t){return q("return "+t+";",{})}function ho(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function P(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function F(aa){var t=P(aa);return t?t.join("/"):null}function iv(ag,ad){for(var aj,aa=ag.slice();aj=aa.pop();){for(var ak=aj.pos,ah=aj.ids,af=ah[2],ac=ad(0===af.length,ak,ah[0],aj.ctx,ah[1]),ab=0,t=af.length;t>ab;ab++){aa.push({pos:ak+1,ids:af[ab],ctx:ac})}}}function hY(aa,t){return aa.pos-t.pos}function an(t){var ab=[];iv(t,function(ad,ah,af,aj,ag){ad&&ab.push({rev:ah+"-"+af,pos:ah,opts:ag})}),ab.sort(hY).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function I(aa){for(var ac=gq(aa),ag=an(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function A(aa,ac,ag){function ab(){t.cancel()}fX.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?iK(ac):{};var ad=ac.complete=K(function(aj,ah){aj?t.emit("error",aj):t.emit("complete",ah),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(t.emit("change",ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new hp(function(aj,ah){ac.complete=function(al,ak){al?ah(al):aj(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function jb(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=an(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return ig(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=I(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function hG(aj,ad,ak){function aa(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ak(null,{results:am})}function t(){++ag===af&&aa()}function al(aq,am,ap){ab[aq]={id:am,docs:ap},t()}var ah=Array.isArray(ad)?ad:ad.docs,ac={};ah.forEach(function(am){am.id in ac?ac[am.id].push(am):ac[am.id]=[am]});var af=Object.keys(ac).length,ag=0,ab=new Array(af);Object.keys(ac).forEach(function(am,av){var au=ac[am],ap=iO(au[0],["atts_since","attachments"]);ap.open_revs=au.map(function(aw){return aw.rev}),ap.open_revs=ap.open_revs.filter(function(aw){return aw});var aq=function(aw){return aw};0===ap.open_revs.length&&(delete ap.open_revs,aq=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in ad&&(ap[aw]=ad[aw])}),aj.get(am,ap,function(ax,aw){al(av,am,ax?[{error:ax}]:aq(aw))})})}function hr(t){return/^_local/.test(t)}function E(t){for(var al,ah=[],ak=t.slice();al=ak.pop();){var aj=al.pos,af=al.ids,ap=af[0],ad=af[1],am=af[2],aa=0===am.length,ac=al.history?al.history.slice():[];ac.push({id:ap,opts:ad}),aa&&ah.push({pos:aj+1-ac.length,ids:ac});for(var ag=0,ab=am.length;ab>ag;ag++){ak.push({pos:aj+1,ids:am[ag],history:ac})}}return ah.reverse()}function im(t){return 0|Math.random()*t}function M(t,ab){ab=ab||f.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=f[im(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=f[3&im(16)|8];break;default:ac+=f[im(16)]}}return ac}function N(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(aa){var t;if(aa?"string"!=typeof aa?t=hA(fv):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=hA(iL)):t=hA(iR),t){throw t}}function gM(t){if(!/^\d+\-./.test(t)){return hA(hO)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function s(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function gf(ag,ad){var aj,aa,ak,ah={status:"available"};if(ag._deleted&&(ah.deleted=!0),ad){if(ag._id||(ag._id=M()),aa=M(32,16).toLowerCase(),ag._rev){if(ak=gM(ag._rev),ak.error){return ak}ag._rev_tree=[{pos:ak.prefix,ids:[ak.id,{status:"missing"},[[aa,ah,[]]]]}],aj=ak.prefix+1}else{ag._rev_tree=[{pos:1,ids:[aa,ah,[]]}],aj=1}}else{if(ag._revisions&&(ag._rev_tree=s(ag._revisions,ah),aj=ag._revisions.start,aa=ag._revisions.ids[0]),!ag._rev_tree){if(ak=gM(ag._rev),ak.error){return ak}aj=ak.prefix,aa=ak.id,ag._rev_tree=[{pos:aj,ids:[aa,ah,[]]}]}}C(ag._id),ag._rev=aj+"-"+aa;var af={metadata:{},data:{}};for(var ac in ag){if(Object.prototype.hasOwnProperty.call(ag,ac)){var ab="_"===ac[0];if(ab&&!hq[ac]){var t=hA(hH,ac);throw t.message=hH.message+": "+ac,t}ab&&!jk[ac]?af.metadata[ac.slice(1)]=ag[ac]:af.data[ac]=ag[ac]}}return af}function de(aa,t){return t>aa?-1:aa>t?1:0}function hQ(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function gD(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function ht(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=iO(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function i4(ab,ad){var t=de(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return de(ac,aa)}function x(ab){var t={},aa=[];return iv(ab,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(t[ag]=0),void 0!==af&&aa.push({from:af,to:ag}),ag}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function g9(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return hp.all(ac.map(function(af){var ag=fj.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hp(function(aj,ah){ab._allDocs(ag,function(ak,al){return ak?ah(ak):(aa.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function hB(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),i.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&hB(t)})})})}function fe(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function iy(){fX.EventEmitter.call(this)}function ex(){this.isReady=!1,this.failed=!1,this.queue=[]}function ia(t){t&&o.debug&&console.error(t)}function iX(aa,ac){function ag(){ad.emit("destroyed",t),ad.emit(t,"destroyed")}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function i6(ab,ad,t){if(!(this instanceof i6)){return new i6(ab,ad,t)}var ac=this;("function"==typeof ad||"undefined"==typeof ad)&&(t=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof t&&(t=ia),ab=ab||ad.name,ad=iK(ad),delete ad.name,this.__opts=ad;var aa=t;ac.auto_compaction=ad.auto_compaction,ac.prefix=i6.prefix,iy.call(ac),ac.taskqueue=new ex;var af=new hp(function(ag,aj){t=function(ap,am){return ap?aj(ap):(delete am.then,void ag(am))},ad=iK(ad);var al,ah,ak=ad.name||ab;return function(){try{if("string"!=typeof ak){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}if(al=i6.parseAdapter(ak,ad),ad.originalName=ak,ad.name=al.name,ad.prefix&&"http"!==al.adapter&&"https"!==al.adapter&&(ad.name=ad.prefix+ad.name),ad.adapter=ad.adapter||al.adapter,ac._adapter=ad.adapter,hT("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ak,!i6.adapters[ad.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!i6.adapters[ad.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ac.taskqueue.fail(am)}}(),ah?aj(ah):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void i6.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void t(am)):(iX(ac,ad),ac.emit("created",ac),i6.emit("created",ad.originalName),ac.taskqueue.ready(ac),void t(null,ac))}))});af.then(function(ag){aa(null,ag)},aa),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function H(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function f3(){return f4}function eo(aa){Object.keys(fX.EventEmitter.prototype).forEach(function(ab){"function"==typeof fX.EventEmitter.prototype[ab]&&(aa[ab]=it[ab].bind(it))});var t=aa._destructionListeners=new iJ.Map;aa.on("destroyed",function(ab){t.has(ab)&&(t.get(ab).forEach(function(ac){ac()}),t["delete"](ab))})}function m(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function ij(aa,t){return p([m(aa)],{type:t})}function hi(aa){for(var ac=at.exec(aa),ag={},ab=14;ab--;){var t=co[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[iD]={},ag[co[12]].replace(iz,function(ak,aj,ah){aj&&(ag[iD][aj]=ah)}),ag}function hV(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return hA(T,aa)}}function gT(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&hV(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function hS(aa,t){"console" in o&&"info" in console&&console.info("The above "+aa+" is totally normal. "+t)}function g4(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&hS(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:iA,version:fV}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,gE),af.version=fV,af.replicator=iA,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return g4(ab,ad,t,ac,aa)}throw ag}))})}function B(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function jj(t,ab){if(t.session_id===ab.session_id){return{last_seq:t.last_seq,history:t.history||[]}}var ac=t.history||[],aa=ab.history||[];return fl(ac,aa)}function fl(af,ad){var ac=af[0],ab=af.slice(1),t=ad[0],ah=ad.slice(1);if(!ac||0===ad.length){return{last_seq:fh,history:[]}}var aa=ac.session_id;if(gz(aa,ad)){return{last_seq:ac.last_seq,history:af}}var ag=t.session_id;return gz(ag,ab)?{last_seq:t.last_seq,history:ah}:fl(ab,ah)}function gz(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:gz(t,aa):!1}function G(t,ab){t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1;var ac=Math.random(),aa=ab-t;return ~~(aa*ac+t)}function he(aa){var t=0;return aa||(t=2000),G(aa,t)}function hw(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=he),ab.emit("requestError",ac),("active"===ab.state||"pending"===ab.state)&&(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=gW})),t.current_back_off=t.current_back_off||gW,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function ix(t){return hu(t)}function iG(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function gw(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function f0(t){return Object.keys(t).sort(cn.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function hd(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(cn.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(f0(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hp.all([aa.id(),ac.id()]).then(function(ah){var aj=ah[0]+ah[1]+t+af+ad+ab;return iY(aj)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function iT(t){return/^1-/.test(t)}function h1(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function a9(ah,af,aa){function ab(){var ak=h1(af);if(ak.docs.length){return ah.bulkGet(ak).then(function(al){if(aa.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&ad.push(ap.ok)})})})}}function t(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function aj(ak){return ah.allDocs({keys:ak,include_docs:!0}).then(function(al){if(aa.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&iT(am.value.rev)&&!t(am.doc)&&(ad.push(am.doc),delete af[am.id])})})}function ag(){var ak=Object.keys(af).filter(function(am){var al=af[am].missing;return 1===al.length&&iT(al[0])});return ak.length>0?aj(ak):void 0}function ac(){return ad}af=iK(af);var ad=[];return hp.resolve().then(ag).then(ab).then(ac)}function gs(aF,aE,aj,av,ak){function ab(){return aQ?hp.resolve():hd(aF,aE,aj).then(function(aS){aB=aS,aQ=new B(aF,aE,aB,av)})}function ap(){if(aL=[],0!==aO.docs.length){var aS=aO.docs;return aE.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(av.cancelled){throw aa(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(ak.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),aA=aA.concat(aT),ak.docs_written+=aO.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?av.emit("denied",iK(aY)):aL.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,aw("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw ak.doc_write_failures+=aS.length,aT})}}function aC(){ak.last_seq=aN=aO.seq;var aS=iK(ak);return aL.length&&(aS.docs=aL,av.emit("change",aS)),aR=!0,aQ.writeCheckpoint(aO.seq,ay).then(function(){if(aR=!1,av.cancelled){throw aa(),new Error("cancelled")}aO=void 0,ag()})["catch"](function(aT){throw aR=!1,aw("writeCheckpoint completed with error",aT),aT})}function aI(){var aS={};return aO.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aE.revsDiff(aS).then(function(aT){if(av.cancelled){throw aa(),new Error("cancelled")}aO.diffs=aT})}function au(){return a9(aF,aO.diffs,av).then(function(aS){aS.forEach(function(aT){delete aO.diffs[aT._id],ak.docs_read++,aO.docs.push(aT)})})}function aH(){if(!av.cancelled&&!aO){if(0===ad.length){return void af(!0)}aO=ad.shift(),aI().then(au).then(ap).then(aC).then(aH)["catch"](function(aS){aw("batch processing terminated with error",aS)})}}function af(aS){return 0===am.changes.length?void (0!==ad.length||aO||((ac&&aD.live||ax)&&(av.state="pending",av.emit("paused")),ax&&aa())):void ((aS||ax||am.changes.length>=az)&&(ad.push(am),am={seq:0,changes:[],docs:[]},("pending"===av.state||"stopped"===av.state)&&(av.state="active",av.emit("active")),aH()))}function aw(aT,aS){ah||(aS.message||(aS.message=aT),ak.ok=!1,ak.status="aborting",ak.errors.push(aS),aA=aA.concat(aS),ad=[],am={seq:0,changes:[],docs:[]},aa())}function aa(){if(!(ah||av.cancelled&&(ak.status="cancelled",aR))){ak.status=ak.status||"complete",ak.end_time=new Date,ak.last_seq=aN,ah=!0;var aT=aA.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aA.pop();aA.length>0&&(aS.other_errors=aA),aS.result=ak,hw(aj,av,aS,function(){gs(aF,aE,aj,av)})}else{ak.errors=aA,av.emit("complete",ak),av.removeAllListeners()}}}function al(aT){if(av.cancelled){return aa()}var aS=gT(aj)(aT);aS&&(am.seq=aT.seq,am.changes.push(aT),af(0===ad.length))}function aJ(aS){return aG=!1,av.cancelled?aa():(aS.results.length>0?(aD.since=aS.last_seq,ag()):ac?(aD.live=!0,ag()):ax=!0,void af(!0))}function t(aS){return aG=!1,av.cancelled?aa():void aw("changes rejected",aS)}function ag(){function aU(){aS.cancel()}function aT(){av.removeListener("cancel",aU)}if(!aG&&!ax&&ad.length<aK){aG=!0,av._changes&&(av.removeListener("cancel",av._abortChanges),av._changes.cancel()),av.once("cancel",aU);var aS=aF.changes(aD).on("change",al);aS.then(aT,aT),aS.then(aJ)["catch"](t),aj.retry&&(av._changes=aS,av._abortChanges=aU)}}function aM(){ab().then(function(){return av.cancelled?void aa():aQ.getCheckpoint().then(function(aS){aN=aS,aD={since:aN,limit:az,batch_size:az,style:"all_docs",doc_ids:aP,return_docs:!0},aj.filter&&("string"!=typeof aj.filter?aD.include_docs=!0:aD.filter=aj.filter),"heartbeat" in aj&&(aD.heartbeat=aj.heartbeat),"timeout" in aj&&(aD.timeout=aj.timeout),aj.query_params&&(aD.query_params=aj.query_params),aj.view&&(aD.view=aj.view),ag()})})["catch"](function(aS){aw("getCheckpoint rejected with ",aS)})}function aq(aS){throw aR=!1,aw("writeCheckpoint completed with error",aS),aS}var aO,aB,aQ,ad=[],am={seq:0,changes:[],docs:[]},aR=!1,ax=!1,ah=!1,aN=0,ac=aj.continuous||aj.live||!1,az=aj.batch_size||100,aK=aj.batches_limit||10,aG=!1,aP=aj.doc_ids,aA=[],aL=[],ay=M();ak=ak||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aD={};return av.ready(aF,aE),av.cancelled?void aa():(av._addedListeners||(av.once("cancel",aa),"function"==typeof aj.complete&&(av.once("error",aj.complete),av.once("complete",function(aS){aj.complete(null,aS)})),av._addedListeners=!0),void ("undefined"==typeof aj.since?aM():ab().then(function(){return aR=!0,aQ.writeCheckpoint(aj.since,ay)}).then(function(){return aR=!1,av.cancelled?void aa():(aN=aj.since,void aM())})["catch"](aq)))}function iC(){fX.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hp(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function ji(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function gY(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw hA(T,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=iK(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new iC(ag),ad=ji(aa,ag),af=ji(ac,ag);return gs(ad,af,ag,t),t}function h9(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=iK(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=g7.toPouch(t,ac),ab=g7.toPouch(ab,ac),new il(t,ab,ac,aa)}function il(ab,ak,aj,t){function al(ay){ad.emit("change",{direction:"pull",change:ay})}function af(ay){ad.emit("change",{direction:"push",change:ay})}function am(ay){ad.emit("denied",{direction:"push",doc:ay})}function ah(ay){ad.emit("denied",{direction:"pull",doc:ay})}function av(){ad.pushPaused=!0,ad.pullPaused&&ad.emit("paused")}function aq(){ad.pullPaused=!0,ad.pushPaused&&ad.emit("paused")}function ac(){ad.pushPaused=!1,ad.pullPaused&&ad.emit("active",{direction:"push"})}function ag(){ad.pullPaused=!1,ad.pushPaused&&ad.emit("active",{direction:"pull"})}function aa(ay){return function(aC,aD){var az="change"===aC&&(aD===al||aD===af),aA="denied"===aC&&(aD===ah||aD===am),aE="paused"===aC&&(aD===aq||aD===av),aB="active"===aC&&(aD===ag||aD===ac);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ad.removeAllListeners(aC))}}var ad=this;this.canceled=!1;var ap=aj.push?fj.extend({},aj,aj.push):aj,aw=aj.pull?fj.extend({},aj,aj.pull):aj;this.push=ft(ab,ak,ap),this.pull=ft(ak,ab,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};aj.live&&(this.push.on("complete",ad.pull.cancel.bind(ad.pull)),this.pull.on("complete",ad.push.cancel.bind(ad.push))),this.on("newListener",function(ay){"change"===ay?(ad.pull.on("change",al),ad.push.on("change",af)):"denied"===ay?(ad.pull.on("denied",ah),ad.push.on("denied",am)):"active"===ay?(ad.pull.on("active",ag),ad.push.on("active",ac)):"paused"===ay&&(ad.pull.on("paused",aq),ad.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ad.pull.removeListener("change",al),ad.push.removeListener("change",af)):"denied"===ay?(ad.pull.removeListener("denied",ah),ad.push.removeListener("denied",am)):"active"===ay?(ad.pull.removeListener("active",ag),ad.push.removeListener("active",ac)):"paused"===ay&&(ad.pull.removeListener("paused",aq),ad.push.removeListener("paused",av))}),this.pull.on("removeListener",aa("pull")),this.push.on("removeListener",aa("push"));var au=hp.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ad.emit("complete",az),t&&t(null,az),ad.removeAllListeners(),az},function(ay){if(ad.cancel(),t?t(ay):ad.emit("error",ay),ad.removeAllListeners(),t){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gC(aa,t){return ij(hP(aa),t)}function hK(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function ha(t,ab){if("undefined"==typeof FileReader){return ab(hK((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(hK(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function fb(t){return new hp(function(aa){ha(t,function(ab){aa(hu(ab))})})}function J(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function Q(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=gC(ab.data,ab.content_type)})}function iM(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function iQ(t){return t._attachments&&Object.keys(t._attachments)?hp.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?fb(aa.data).then(function(ac){aa.data=ac}):void 0})):hp.resolve()}function y(ab){var t=hi(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function fo(aa,t){return hf(aa,aa.db+"/"+t)}function hf(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function a2(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function fY(ac,aj){function aq(aw,ay,az){var av=aw.ajax||{},ax=fj.extend(iK(au),av,ay);return h4(ax.method+" "+ax.url),io.ajax(ax,az)}function af(av,aw){return new hp(function(ax,ay){aq(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function t(av,aw){return ew(av,S(function(ax){ak().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function ak(){if(ac.skipSetup||ac.skip_setup){return hp.resolve()}if(al){return al}var av={method:"GET",url:ad};return al=af({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(hS(404,"PouchDB is just detecting if the remote exists."),af({},{method:"PUT",url:ad})):hp.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:hp.reject(aw)}),al["catch"](function(){al=null}),al}function am(av){return av.split("/").map(encodeURIComponent).join("/")}var ah=this,ap=y;ac.getHost&&(ap=ac.getHost);var aa=ap(ac.name,ac),ad=fo(aa,"");ac=iK(ac);var au=ac.ajax||{};if(ah.getUrl=function(){return ad},ah.getHeaders=function(){return au.headers||{}},ac.auth||aa.auth){var ag=ac.auth||aa.auth,ab=hu(ag.username+":"+ag.password);au.headers=au.headers||{},au.headers.Authorization="Basic "+ab}var al;setTimeout(function(){aj(null,ah)}),ah.type=function(){return"http"},ah.id=t("id",function(av){aq({},{method:"GET",url:hf(aa,"")},function(aw,ax){var ay=ax&&ax.uuid?ax.uuid+aa.db:fo(aa,"");av(null,ay)})}),ah.request=t("request",function(av,aw){av.url=fo(aa,av.url),aq({},av,aw)}),ah.compact=t("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=iK(av),aq(av,{url:fo(aa,"_compact"),method:"POST"},function(){function ax(){ah.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),ah.bulkGet=ew("bulkGet",function(aB,aA){function aw(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),aq({},{url:fo(aa,"_bulk_get"+a2(aD)),method:"POST",body:{docs:aB.docs}},aC)}function ax(){function aG(aJ){return function(aK,aL){aD[aJ]=aL.results,++aF===aI&&aA(null,{results:J(aD)})}}for(var aC=er,aI=Math.ceil(aB.docs.length/aC),aF=0,aD=new Array(aI),aE=0;aI>aE;aE++){var aH=iO(aB,["revs","attachments"]);aH.docs=aB.docs.slice(aE*aC,Math.min(aB.docs.length,(aE+1)*aC)),hG(az,aH,aG(aE))}}var az=this,av=hf(aa,""),ay=hg[av];"boolean"!=typeof ay?aw(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(hg[av]=!1,hS(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aE)}else{hg[av]=!0,aA(null,aD)}}):ay?aw(aA):ax()}),ah._info=function(av){ak().then(function(){aq({},{method:"GET",url:fo(aa,"")},function(aw,ax){return aw?av(aw):(ax.host=fo(aa,""),void av(null,ax))})})["catch"](av)},ah.get=t("get",function(aB,aA,aw){function ax(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?hp.all(aE.map(function(aF){var aH=aC[aF],aG=iM(aD._id)+"/"+am(aF)+"?rev="+aD._rev;return af(aA,{method:"GET",url:fo(aa,aG),binary:!0}).then(function(aI){return aA.binary?aI:fb(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function az(aC){return Array.isArray(aC)?hp.all(aC.map(function(aD){return aD.ok?ax(aD.ok):void 0})):ax(aC)}"function"==typeof aA&&(aw=aA,aA={}),aA=iK(aA);var ay={};aA.revs&&(ay.revs=!0),aA.revs_info&&(ay.revs_info=!0),aA.open_revs&&("all"!==aA.open_revs&&(aA.open_revs=JSON.stringify(aA.open_revs)),ay.open_revs=aA.open_revs),aA.rev&&(ay.rev=aA.rev),aA.conflicts&&(ay.conflicts=aA.conflicts),aB=iM(aB);var av={method:"GET",url:fo(aa,aB+a2(ay))};af(aA,av).then(function(aC){return hp.resolve().then(function(){return aA.attachments?az(aC):void 0}).then(function(){aw(null,aC)})})["catch"](aw)}),ah.remove=t("remove",function(aw,av,ay,aA){var ax;"string"==typeof av?(ax={_id:aw,_rev:av},"function"==typeof ay&&(aA=ay,ay={})):(ax=aw,"function"==typeof av?(aA=av,ay={}):(aA=ay,ay=av));var az=ax._rev||ay.rev;aq(ay,{method:"DELETE",url:fo(aa,iM(ax._id))+"?rev="+az},aA)}),ah.getAttachment=t("getAttachment",function(aw,ay,aA,av){"function"==typeof aA&&(av=aA,aA={});var ax=aA.rev?"?rev="+aA.rev:"",az=fo(aa,iM(aw))+"/"+am(ay)+ax;aq(aA,{method:"GET",url:az,binary:!0},av)}),ah.removeAttachment=t("removeAttachment",function(aw,ay,ax,az){var av=fo(aa,iM(aw)+"/"+am(ay))+"?rev="+ax;aq({},{method:"DELETE",url:av},az)}),ah.putAttachment=t("putAttachment",function(aE,aB,az,ax,aw,aA){"function"==typeof aw&&(aA=aw,aw=ax,ax=az,az=null);var aC=iM(aE)+"/"+am(aB),aF=fo(aa,aC);if(az&&(aF+="?rev="+az),"string"==typeof ax){var av;try{av=hP(ax)}catch(ay){return aA(hA(fW,"Attachment is not a valid base64 string"))}ax=av?ij(av,aw):""}var aD={headers:{"Content-Type":aw},method:"PUT",url:aF,processData:!1,body:ax,timeout:au.timeout||60000};aq({},aD,aA)}),ah._bulkDocs=function(aw,av,ax){aw.new_edits=av.new_edits,ak().then(function(){return hp.all(aw.docs.map(iQ))}).then(function(){aq(av,{method:"POST",url:fo(aa,"_bulk_docs"),body:aw},function(ay,az){return ay?ax(ay):(az.forEach(function(aA){aA.ok=!0}),void ax(null,az))})})["catch"](ax)},ah.allDocs=t("allDocs",function(aB,aw){"function"==typeof aB&&(aw=aB,aB={}),aB=iK(aB);var aA,ax={},az="GET";aB.conflicts&&(ax.conflicts=!0),aB.descending&&(ax.descending=!0),aB.include_docs&&(ax.include_docs=!0),aB.attachments&&(ax.attachments=!0),aB.key&&(ax.key=JSON.stringify(aB.key)),aB.start_key&&(aB.startkey=aB.start_key),aB.startkey&&(ax.startkey=JSON.stringify(aB.startkey)),aB.end_key&&(aB.endkey=aB.end_key),aB.endkey&&(ax.endkey=JSON.stringify(aB.endkey)),"undefined"!=typeof aB.inclusive_end&&(ax.inclusive_end=!!aB.inclusive_end),"undefined"!=typeof aB.limit&&(ax.limit=aB.limit),"undefined"!=typeof aB.skip&&(ax.skip=aB.skip);var av=a2(ax);if("undefined"!=typeof aB.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aB.keys));ay.length+av.length+1<=V?av+="&"+ay:(az="POST",aA={keys:aB.keys})}af(aB,{method:az,url:fo(aa,"_all_docs"+av),body:aA}).then(function(aC){aB.include_docs&&aB.attachments&&aB.binary&&aC.rows.forEach(Q),aw(null,aC)})["catch"](aw)}),ah._changes=function(aw){var aI="batch_size" in aw?aw.batch_size:Y;aw=iK(aw),aw.timeout="timeout" in aw?aw.timeout:"timeout" in au?au.timeout:30000;var aD,aF=aw.timeout?{timeout:aw.timeout-5000}:{},az="undefined"!=typeof aw.limit?aw.limit:!1;aD="return_docs" in aw?aw.return_docs:"returnDocs" in aw?aw.returnDocs:!0;var aH=az;if(aw.style&&(aF.style=aw.style),(aw.include_docs||aw.filter&&"function"==typeof aw.filter)&&(aF.include_docs=!0),aw.attachments&&(aF.attachments=!0),aw.continuous&&(aF.feed="longpoll"),aw.conflicts&&(aF.conflicts=!0),aw.descending&&(aF.descending=!0),"heartbeat" in aw?aw.heartbeat&&(aF.heartbeat=aw.heartbeat):aF.heartbeat=10000,aw.filter&&"string"==typeof aw.filter&&(aF.filter=aw.filter,"_view"===aw.filter&&aw.view&&"string"==typeof aw.view&&(aF.view=aw.view)),aw.query_params&&"object"==typeof aw.query_params){for(var aG in aw.query_params){aw.query_params.hasOwnProperty(aG)&&(aF[aG]=aw.query_params[aG])}}var ax,aC="GET";if(aw.doc_ids){aF.filter="_doc_ids";var aB=JSON.stringify(aw.doc_ids);aB.length<V?aF.doc_ids=aB:(aC="POST",ax={doc_ids:aw.doc_ids})}var av,aJ,aA=function(aK,aL){if(!aw.aborted){aF.since=aK,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aw.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aI?aI:aH;var aM={method:aC,url:fo(aa,"_changes"+a2(aF)),timeout:aw.timeout,body:ax};aJ=aK,aw.aborted||ak().then(function(){av=aq(aw,aM,aL)})["catch"](aL)}},ay={results:[]},aE=function(aK,aN){if(!aw.aborted){var aO=0;if(aN&&aN.results){aO=aN.results.length,ay.last_seq=aN.last_seq;var aM={};aM.query=aw.query_params,aN.results=aN.results.filter(function(aQ){aH--;var aP=gT(aw)(aQ);return aP&&(aw.include_docs&&aw.attachments&&aw.binary&&Q(aQ),aD&&ay.results.push(aQ),aw.onChange(aQ)),aP})}else{if(aK){return aw.aborted=!0,void aw.complete(aK)}}aN&&aN.last_seq&&(aJ=aN.last_seq);var aL=az&&0>=aH||aN&&aI>aO||aw.descending;(!aw.continuous||az&&0>=aH)&&aL?aw.complete(null,ay):setTimeout(function(){aA(aJ,aE)},0)}};return aA(aw.since||0,aE),{cancel:function(){aw.aborted=!0,av&&av.abort()}}},ah.revsDiff=t("revsDiff",function(aw,av,ax){"function"==typeof av&&(ax=av,av={}),aq(av,{method:"POST",url:fo(aa,"_revs_diff"),body:aw},ax)}),ah._close=function(av){av()},ah._destroy=function(aw,av){aq(aw,{url:fo(aa,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(ah.emit("destroyed"),ah.constructor.emit("destroyed",ac.name),void av(null,ay))})}}function hE(){this.promise=new hp(function(t){t()})}function i5(t){return ja.hash(t)}function eu(af){var ad=af.db,ac=af.viewName,ab=af.map,t=af.reduce,ah=af.temporary,aa=ab.toString()+(t&&t.toString())+"undefined";if(!ah&&ad._cachedViews){var ag=ad._cachedViews[aa];if(ag){return hp.resolve(ag)}}return ad.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ac;-1===aq.indexOf("/")&&(aq=ac+"/"+ac);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ah?"temp":i5(aa));return f6(ad,"_local/mrviews",al).then(function(){return ad.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ad,adapter:ad.adapter,mapFun:ab,reduceFun:t};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ah||(ad._cachedViews=ad._cachedViews||{},ad._cachedViews[aa]=aq,aq.db.once("destroyed",function(){delete ad._cachedViews[aa]})),aq})})})})}function ae(ab,ad,t,ac,aa,af){return q("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function iI(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function gK(t){return 1===t.length&&/^1-/.test(t[0].rev)}function hD(ab,t){try{ab.emit("error",t)}catch(aa){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(t)}}function i8(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return hD(t,aa),{error:aa}}}function g3(ab,t){var aa=hR(ab.key,t.key);return 0!==aa?aa:hR(ab.value,t.value)}function iN(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function gU(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function ik(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gC(ac.data,ac.content_type)})})}function gO(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&ik(aa),aa}}function j(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new l(t)}function gp(af){for(var ad=0,ac=0,ab=af.length;ab>ac;ac++){var t=af[ac];if("number"!=typeof t){if(!Array.isArray(t)){throw j("_sum")}ad="number"==typeof ad?[ad]:ad;for(var ah=0,aa=t.length;aa>ah;ah++){var ag=t[ah];if("number"!=typeof ag){throw j("_sum")}"undefined"==typeof ad[ah]?ad.push(ag):ad[ah]+=ag}}else{"number"==typeof ad?ad+=t:ad[0]+=t}}return ad}function hX(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function g8(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function hM(t){return t.group_level=g8(t.group_level),t.limit=g8(t.limit),t.skip=g8(t.skip),t}function gG(t){if(t){if("number"!=typeof t){return new fk('Invalid value for integer: "'+t+'"')}if(0>t){return new fk('Invalid value for positive integer: "'+t+'"')}}}function f5(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&hR(t[ac],t[aa])>0){throw new fk("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new fk("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new fk("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=gG(t[af]);if(ad){throw ad}})}function X(ah,af,aa){var ab,t=[],aj="GET";if(hX("reduce",aa,t),hX("include_docs",aa,t),hX("attachments",aa,t),hX("limit",aa,t),hX("descending",aa,t),hX("group",aa,t),hX("group_level",aa,t),hX("skip",aa,t),hX("stale",aa,t),hX("conflicts",aa,t),hX("startkey",aa,t,!0),hX("start_key",aa,t,!0),hX("endkey",aa,t,!0),hX("end_key",aa,t,!0),hX("inclusive_end",aa,t),hX("key",aa,t,!0),t=t.join("&"),t=""===t?"":"?"+t,"undefined"!=typeof aa.keys){var ag=2000,ac="keys="+encodeURIComponent(JSON.stringify(aa.keys));ac.length+t.length+1<=ag?t+=("?"===t[0]?"&":"?")+ac:(aj="POST","string"==typeof af?ab={keys:aa.keys}:af.keys=aa.keys)}if("string"==typeof af){var ad=iI(af);return ah.request({method:aj,url:"_design/"+ad[0]+"/_view/"+ad[1]+t,body:ab}).then(gO(aa))}return ab=ab||{},Object.keys(af).forEach(function(ak){Array.isArray(af[ak])?ab[ak]=af[ak]:ab[ak]=af[ak].toString()}),ah.request({method:"POST",url:"_temp_view"+t,body:ab}).then(gO(aa))}function g5(ab,t,aa){return new hp(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function ge(t){return new hp(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function iu(t){return function(aa){if(404===aa.status){return t}throw aa}}function fz(aj,ad,ak){function aa(){return gK(ab)?hp.resolve(ac):ad.db.get(ah)["catch"](iu(ac))}function t(am){return am.keys.length?ad.db.allDocs({keys:am.keys,include_docs:!0}):hp.resolve({rows:[]})}function al(aA,az){for(var av=[],ax={},au=0,ap=az.rows.length;ap>au;au++){var am=az.rows[au],aw=am.doc;if(aw&&(av.push(aw),ax[aw._id]=!0,aw._deleted=!ag[aw._id],!aw._deleted)){var ay=ag[aw._id];"value" in ay&&(aw.value=ay.value)}}var aq=Object.keys(ag);return aq.forEach(function(aD){if(!ax[aD]){var aB={_id:aD},aC=ag[aD];"value" in aC&&(aB.value=aC.value),av.push(aB)}}),aA.keys=gN(aq.concat(aA.keys)),av.push(aA),av}var ah="_local/doc_"+aj,ac={_id:ah,keys:[]},af=ak[aj],ag=af.indexableKeysToKeyValues,ab=af.changes;return aa().then(function(am){return t(am).then(function(ap){return al(am,ap)})})}function gF(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](iu({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return hp.all(ad.map(function(ag){return fz(ag,t,ab)})).then(function(ah){var ag=J(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function u(ab){var t="string"==typeof ab?ab:ab.name,aa=iZ[t];return aa||(aa=iZ[t]=new hE),aa}function hI(t){return gB(u(t),function(){return gk(t)})()}function gk(ah){function af(am,ak){var al={id:t._id,key:h5(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=h5(ak)),ab.push(al)}function aa(ak,al){return function(){return gF(ah,ak,al)}}var ab,t,aj;if("function"==typeof ah.mapFun&&2===ah.mapFun.length){var ag=ah.mapFun;aj=function(ak){return ag(ak,af)}}else{aj=ae(ah.mapFun.toString(),af,gp,hZ,Array.isArray,JSON.parse)}var ac=ah.seq||0,ad=new hE;return new hp(function(ap,ak){function al(){ad.finish().then(function(){ah.seq=ac,ap()})}function am(){function aq(au){ak(au)}ah.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ac,limit:jf}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var au={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){ab=[],t=aD.doc,t._deleted||i8(ah.sourceDB,aj,[t]),ab.sort(g3);for(var ay,aE={},aB=0,az=ab.length;az>aB;aB++){var aw=ab[aB],aG=[aw.key,aw.id];0===hR(aw.key,ay)&&aG.push(aB);var aC=gg(aG);aE[aC]=aw,ay=aw.key}au[aD.doc._id]={indexableKeysToKeyValues:aE,changes:aD.changes}}ac=aD.seq}return ad.add(aa(au,ac)),aF.length<jf?al():am()}).on("error",aq)}am()})}function fc(aj,ad,ak){0===ak.group_level&&delete ak.group_level;var aa,t=ak.group||ak.group_level;aa=i7[aj.reduceFun]?i7[aj.reduceFun]:ae(aj.reduceFun.toString(),null,gp,hZ,Array.isArray,JSON.parse);var al=[],ah=ak.group_level;ad.forEach(function(aq){var am=al[al.length-1],ap=t?aq.key:null;return t&&Array.isArray(ap)&&"number"==typeof ah&&(ap=ap.length>ah?ap.slice(0,ah):ap),am&&0===hR(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void al.push({key:[[ap,aq.id]],value:[aq.value]})});for(var ac=0,af=al.length;af>ac;ac++){var ag=al[ac],ab=i8(aj.sourceDB,aa,[ag.key,ag.value,!1]);if(ab.error&&ab.error instanceof l){throw ab.error}ag.value=ab.error?null:ab.output,ag.key=ag.key[0][0]}return{rows:iN(al,ak.limit,ak.skip)}}function hU(aa,t){return gB(u(aa),function(){return iV(aa,t)})()}function iV(t,al){function ah(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return aj=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=gr(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function ak(aq){var au;if(au=af?fc(t,aq,al):{total_rows:aj,offset:ap,rows:aq},al.include_docs){var av=gN(aq.map(gU));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:al.conflicts,attachments:al.attachments,binary:al.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=gU(ay),az=aw["$"+aA];az&&(ay.doc=az)}),au})}return au}var aj,af=t.reduceFun&&al.reduce!==!1,ap=al.skip||0;if("undefined"==typeof al.keys||al.keys.length||(al.limit=0,delete al.keys),"undefined"!=typeof al.keys){var ad=al.keys,am=ad.map(function(au){var aq={startkey:gg([au]),endkey:gg([au,{}])};return ah(aq)});return hp.all(am).then(J).then(ak)}var aa={descending:al.descending};if(al.start_key&&(al.startkey=al.start_key),al.end_key&&(al.endkey=al.end_key),"undefined"!=typeof al.startkey&&(aa.startkey=gg(al.descending?[al.startkey,{}]:[al.startkey])),"undefined"!=typeof al.endkey){var ac=al.inclusive_end!==!1;al.descending&&(ac=!ac),aa.endkey=gg(ac?[al.endkey,{}]:[al.endkey])}if("undefined"!=typeof al.key){var ag=gg([al.key]),ab=gg([al.key,{}]);aa.descending?(aa.endkey=ag,aa.startkey=ab):(aa.startkey=ag,aa.endkey=ab)}return af||("number"==typeof al.limit&&(aa.limit=al.limit),aa.skip=ap),ah(aa).then(ak)}function gL(t){return t.request({method:"POST",url:"_view_cleanup"})}function bt(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=iI(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return gB(u(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hp.all(af).then(function(){return{ok:!0}})})},iu({ok:!0}))}function fs(t,ag,af){if("http"===t.type()){return X(t,ag,af)}if("function"==typeof t._query){return g5(t,ag,af)}if("string"!=typeof ag){f5(af,ag);var ac={db:t,viewName:"temp_view/temp_view",map:ag.map,reduce:ag.reduce,temporary:!0};return Z.add(function(){return eu(ac).then(function(ak){function aj(){return ak.db.destroy()}return hz(hI(ak).then(function(){return hU(ak,af)}),aj)})}),Z.finish()}var ad=ag,aa=iI(ad),ab=aa[0],ah=aa[1];return t.get("_design/"+ab).then(function(al){var ak=al.views&&al.views[ah];if(!ak||"string"!=typeof ak.map){throw new fr("ddoc "+ab+" has no view named "+ah)}f5(af,ak);var aj={db:t,viewName:ad,map:ak.map,reduce:ak.reduce};return eu(aj).then(function(am){return"ok"===af.stale||"update_after"===af.stale?("update_after"===af.stale&&i.nextTick(function(){hI(am)}),hU(am,af)):hI(am).then(function(){return hU(am,af)})})})}function fk(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,fk)}catch(t){}}function fr(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,fr)}catch(t){}}function l(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,l)}catch(t){}}function h6(t){return"'"+t+"'"}function g1(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function h7(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function hC(t){return delete t._id,delete t._rev,JSON.stringify(t)}function n(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function hc(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function R(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function hF(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+gh+" WHERE seq IN "+hc(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+gh+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+gh+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new iJ.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+gh+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+g2+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(aj){var ah="SELECT seq FROM "+cr+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ac,aj],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+cr+" WHERE seq=?",[ak],ab)})})}}function a0(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(hA(ie,ab,ac))}}function fm(aa){if("size" in aa){return 1000000*aa.size}var t=/Android/.test(window.navigator.userAgent);return t?5000000:1}function hs(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function v(ab,t){try{return{db:ab(t)}}catch(aa){return{error:aa}}}function gl(ab){var t=gI[ab.name];if(!t){var aa=hs();t=gI[ab.name]=v(aa,ab),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return t}function h3(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function dt(t){H()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):f3()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function jc(){fX.EventEmitter.call(this),this._listeners={},dt(this)}function fi(t){return decodeURIComponent(window.escape(t))}function eq(t){return 65>t?t-48:t-55}function bo(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(eq(t.charCodeAt(ab++))<<4|eq(t.charCodeAt(ab++)))}return aa}function a7(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(eq(t.charCodeAt(ab+2))<<12|eq(t.charCodeAt(ab+3))<<8|eq(t.charCodeAt(ab))<<4|eq(t.charCodeAt(ab+1))),ab+=4}return aa}function ez(aa,t){return"UTF-8"===t?fi(bo(aa,0,aa.length)):a7(aa,0,aa.length)}function ev(aa){try{return JSON.parse(aa)}catch(t){return a3.parse(aa)}}function gi(aa){try{return JSON.stringify(aa)}catch(t){return a3.stringify(aa)}}function iw(ab,ah,t){function ag(ak){try{return hP(ak)}catch(al){var aj=hA(fW,"Attachment is not a valid base64 string");return{error:aj}}}function af(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=ag(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===ah?al.data=ij(ak,al.content_type):"base64"===ah?al.data=hu(ak):al.data=ak,iY(ak).then(function(am){al.digest="md5-"+am,aj()})}else{ii(al.data,function(am){"binary"===ah?al.data=hK(am):"base64"===ah&&(al.data=hu(hK(am))),iY(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function ac(){aa++,ab.length===aa&&(ad?t(ad):t())}if(!ab.length){return t()}var ad,aa=0;ab.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ac()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ac()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&af(ak.data._attachments[ap],am)}})}function ce(aa,t){return aa.pos-t.pos}function br(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function fd(t,ab,ac){var aa=br(t,ab,ac);t.splice(aa,0,ab)}function g6(af,ad){for(var ac,ab,t=ad,ah=af.length;ah>t;t++){var aa=af[t],ag=[aa.id,aa.opts,[]];ab?(ab[2].push(ag),ab=ag):ac=ab=ag}return ac}function gm(aa,t){return aa[0]<t[0]?-1:1}function hm(ag,ad){for(var aj=[{tree1:ag,tree2:ad}],aa=!1;aj.length>0;){var ak=aj.pop(),ah=ak.tree1,af=ak.tree2;(ah[1].status||af[1].status)&&(ah[1].status="available"===ah[1].status||"available"===af[1].status?"available":"missing");for(var ac=0;ac<af[2].length;ac++){if(ah[2][0]){for(var ab=!1,t=0;t<ah[2].length;t++){ah[2][t][0]===af[2][ac][0]&&(aj.push({tree1:ah[2][t],tree2:af[2][ac]}),ab=!0)}ab||(aa="new_branch",fd(ah[2],af[2][ac],gm))}else{aa="new_leaf",ah[2][0]=af[2][ac]}}}return{conflicts:aa,tree:ag}}function hx(ag,ak,aj){var am,av=[],ab=!1,aa=!1;if(!ag.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=ag.length;aw>ah;ah++){var al=ag[ah];if(al.pos===ak.pos&&al.ids[0]===ak.ids[0]){am=hm(al.ids,ak.ids),av.push({pos:al.pos,ids:am.tree}),ab=ab||am.conflicts,aa=!0}else{if(aj!==!0){var ap=al.pos<ak.pos?al:ak,ad=al.pos<ak.pos?ak:al,ac=ad.pos-ap.pos,t=[],ax=[];for(ax.push({ids:ap.ids,diff:ac,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],aq=0,af=az.length;af>aq;aq++){ax.push({ids:az[aq],diff:ay.diff-1,parent:ay.ids,parentIdx:aq})}}else{ay.ids[0]===ad.ids[0]&&t.push(ay)}}var au=t[0];au?(am=hm(au.ids,ad.ids),au.parent[2][au.parentIdx]=am.tree,av.push({pos:ap.pos,ids:ap.ids}),ab=ab||am.conflicts,aa=!0):av.push(al)}else{av.push(al)}}}return aa||av.push(ak),av.sort(ce),{tree:av,conflicts:ab||"internal_node"}}function dn(ag,ad){for(var aj,aa=E(ag),ak=0,ah=aa.length;ah>ak;ak++){var af=aa[ak],ac=af.ids,ab=Math.max(0,ac.length-ad),t={pos:af.pos+ab,ids:g6(ac,ab)};aj=aj?hx(aj,t,!0).tree:[t]}return aj}function gy(t,ab,ac){var aa=hx(t,ab);return{tree:dn(aa.tree,ac),conflicts:aa.conflicts}}function ai(ag,ad){for(var aj,aa=ag.slice(),ak=ad.split("-"),ah=parseInt(ak[0],10),af=ak[1];aj=aa.pop();){if(aj.pos===ah&&aj.ids[0]===af){return !0}for(var ac=aj.ids[2],ab=0,t=ac.length;t>ab;ab++){aa.push({pos:aj.pos+1,ids:ac[ab]})}}return !1}function ic(al,ax,aq,am,au,af,ah,ag){if(ai(ax.rev_tree,aq.metadata.rev)){return am[au]=aq,af()}var aw=ax.winningRev||gq(ax),ay="deleted" in ax?ax.deleted:ig(ax,aw),ac="deleted" in aq.metadata?aq.metadata.deleted:ig(aq.metadata),av=/^1-/.test(aq.metadata.rev);if(ay&&!ac&&ag&&av){var ad=aq.data;ad._rev=aw,ad._id=aq.metadata.id,aq=gf(ad,ag)}var aA=gy(ax.rev_tree,aq.metadata.rev_tree[0],al),ak=ag&&(ay&&ac||!ay&&"new_leaf"!==aA.conflicts||ay&&!ac&&"new_branch"===aA.conflicts);if(ak){var t=hA(a4);return am[au]=t,af()}var az=aq.metadata.rev;aq.metadata.rev_tree=aA.tree,ax.rev_map&&(aq.metadata.rev_map=ax.rev_map);var aa,ab=gq(aq.metadata),aj=ig(aq.metadata,ab),ap=ay===aj?0:aj>ay?-1:1;aa=az===ab?aj:ig(aq.metadata,az),ah(aq,ab,aj,aa,!0,ap,au,af)}function hN(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ct(ac,aj,aq,af,t,ak,am,ah,ap){function aa(aC,aw,aA){var av=gq(aC.metadata),az=ig(aC.metadata,av);if("was_delete" in ah&&az){return ak[aw]=hA(hL,"deleted"),aA()}var ay=au&&hN(aC);if(ay){var ax=hA(a4);return ak[aw]=ax,aA()}var aB=az?0:1;am(aC,av,az,az,!1,aB,aw,aA)}function ad(){++ab===al&&ap&&ap()}ac=ac||1000;var au=ah.new_edits,ag=new iJ.Map,ab=0,al=aj.length;aj.forEach(function(aw,ay){if(aw._id&&hr(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aq[ax](aw,{ctx:t},function(aA,az){ak[ay]=aA||az,ad()})}var av=aw.metadata.id;ag.has(av)?(al--,ag.get(av).push([aw,ay])):ag.set(av,[[aw,ay]])}),ag.forEach(function(ay,aw){function ax(){++az<ay.length?av():ad()}function av(){var aC=ay[az],aB=aC[0],aA=aC[1];if(af.has(aw)){ic(ac,af.get(aw),aB,ak,aA,ax,am,au)}else{var aD=gy([],aB.metadata.rev_tree[0],ac);aB.metadata.rev_tree=aD.tree,aa(aB,aA,ax)}}var az=0;av()})}function g(aa){var t=[];return iv(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function i0(ap,az,aq,ag,au,t,ad){function ax(){return ac?ad(ac):(t.notify(ag._name),ag._docCount=-1,void ad(null,ah))}function ay(aD,aE){var aC="SELECT count(*) as cnt FROM "+g2+" WHERE digest=?";aj.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=hA(h2,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ak(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(al.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ay(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aw(aJ,aN,aG,aK,aP,aE,aL,aQ){function aH(){function aT(bg,bh){function bf(){return ++bc===ba.length&&bh(),!1}function bb(bk){var bj="INSERT INTO "+gh+" (digest, seq) VALUES (?,?)",bi=[aS._attachments[bk].digest,bg];aj.executeSql(bj,bi,bf,bf)}var bc=0,ba=Object.keys(aS._attachments||{});if(!ba.length){return bh()}for(var bd=0;bd<ba.length;bd++){bb(ba[bd])}}var aS=aJ.data,aW=aK?1:0,aX=aS._id,aV=aS._rev,aY=hC(aS),aZ="INSERT INTO "+cr+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aU=[aX,aV,aY,aW];aj.executeSql(aZ,aU,function(bb,bc){var ba=bc.insertId;aT(ba,function(){aM(bb,ba)})},function(){var ba=R("seq",cr,null,"doc_id=? AND rev=?");return aj.executeSql(ba,[aX,aV],function(bd,bf){var bc=bf.rows.item(0).seq,bb="UPDATE "+cr+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aY,aW,aX,aV];bd.executeSql(bb,bg,function(bh){aT(bc,function(){aM(bh,bc)})})}),!1})}function aO(aS){aR||(aS?(aR=aS,aQ(aR)):aF===aD.length&&aH())}function aC(aS){aF++,aO(aS)}function aI(){if(aP&&ag.auto_compaction){var aS=aJ.metadata.id,aT=g(aJ.metadata);hF(aT,aS,aj)}}function aM(aW,aS){aI(),aJ.metadata.seq=aS,delete aJ.metadata.rev;var aU=aP?"UPDATE "+iP+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+cr+" WHERE doc_id="+iP+".id AND rev=?) WHERE id=?":"INSERT INTO "+iP+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=gi(aJ.metadata),aX=aJ.metadata.id,aV=aP?[aT,aS,aN,aX]:[aX,aS,aS,aT];aW.executeSql(aU,aV,function(){ah[aL]={ok:!0,id:aJ.metadata.id,rev:aN},am.set(aX,aJ.metadata),aQ()})}var aR=null,aF=0;aJ.data._id=aJ.metadata.id,aJ.data._rev=aJ.metadata.rev;var aD=Object.keys(aJ.data._attachments||{});aK&&(aJ.data._deleted=!0),aD.forEach(function(aU){var aT=aJ.data._attachments[aU];if(aT.stub){aF++,aO()}else{var aS=aT.data;delete aT.data;var aV=aT.digest;av(aV,aS,aC)}}),aD.length||aH()}function aa(){ct(ap.revs_limit,al,ag,am,aj,ah,aw,aq)}function aA(aD){function aE(){++aC===al.length&&aD()}if(!al.length){return aD()}var aC=0;al.forEach(function(aG){if(aG._id&&hr(aG._id)){return aE()}var aF=aG.metadata.id;aj.executeSql("SELECT json FROM "+iP+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=ev(aH.rows.item(0).json);am.set(aF,aI)}aE()})})}function av(aD,aF,aC){var aE="SELECT digest FROM "+g2+" WHERE digest=?";aj.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+g2+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,g1(aF)],function(){aC()},function(){return aC(),!1}))})}var ab=aq.new_edits,aB=az.docs,al=aB.map(function(aC){if(aC._id&&hr(aC._id)){return aC}var aD=gf(aC,ab);return aD}),af=al.filter(function(aC){return aC.error});if(af.length){return ad(af[0])}var aj,ac,ah=new Array(al.length),am=new iJ.Map;iw(al,"binary",function(aC){return aC?ad(aC):void au.transaction(function(aD){aj=aD,ak(function(aE){aE?ac=aE:aA(aa)})},a0(ad),ax)})}function gR(ah,af,aa,ab,t){function aj(){++ad===ac.length&&t&&t()}function ag(am,ak){var al=am._attachments[ak],ap={binary:af.binary,ctx:ab};aa._getAttachment(al,ap,function(aq,au){am._attachments[ak]=fj.extend(iO(al,["digest","content_type"]),{data:au}),aj()})}var ac=Object.keys(ah._attachments||{});if(!ac.length){return t&&t()}var ad=0;ac.forEach(function(ak){af.attachments&&af.include_docs?ag(ah,ak):(ah._attachments[ak].stub=!0,aj())})}function hj(aw,ab){function aq(){f3()&&(window.localStorage["_pouch__websqldb_"+af._name]=!0),ab(null,af)}function ag(aC,aD){aC.executeSql(w),aC.executeSql("ALTER TABLE "+cr+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(fa),aC.executeSql("ALTER TABLE "+iP+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+iP+" (local, id)");var aE="SELECT "+iP+".winningseq AS seq, "+iP+".json AS metadata FROM "+cr+" JOIN "+iP+" ON "+cr+".seq = "+iP+".winningseq";aC.executeSql(aE,[],function(aG,aJ){for(var aI=[],aL=[],aM=0;aM<aJ.rows.length;aM++){var aH=aJ.rows.item(aM),aK=aH.seq,aF=JSON.parse(aH.metadata);ig(aF)&&aI.push(aK),hr(aF.id)&&aL.push(aF.id)}aG.executeSql("UPDATE "+iP+"SET local = 1 WHERE id IN "+hc(aL.length),aL,function(){aG.executeSql("UPDATE "+cr+" SET deleted = 1 WHERE seq IN "+hc(aI.length),aI,aD)})})})})}function au(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+gt+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+iP+".id AS id, "+cr+".json AS data FROM "+cr+" JOIN "+iP+" ON "+cr+".seq = "+iP+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aK,aI){function aG(){if(!aJ.length){return aE(aK)}var aL=aJ.shift(),aM=JSON.parse(aL.data)._rev;aK.executeSql("INSERT INTO "+gt+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+iP+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+cr+" WHERE seq=?",[aL.seq],function(){aG()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aG()})})}function t(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aL=aG.shift(),aN=ez(aL.hex,az),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aI=aN.substring(aK+2),aJ="UPDATE "+cr+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aJ,[aM,aI,aN],function(){aH()})}aH()}var aE="ALTER TABLE "+cr+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+cr+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(gX,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+cr;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function al(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+g2;aH.executeSql(aG,[],function(aM,aK){function aN(){var aO=R(gP+", "+iP+".id AS id",[iP,cr],gj,null,iP+".id ");aO+=" LIMIT "+aJ+" OFFSET "+aI,aI+=aJ,aM.executeSql(aO,[],function(aX,aS){function aV(bc,bd){var bb=aP[bc]=aP[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aS.rows.length){return aF(aX)}for(var aP={},aW=0;aW<aS.rows.length;aW++){for(var aT=aS.rows.item(aW),aU=n(aT.data,aT.id,aT.rev),aZ=Object.keys(aU._attachments||{}),aY=0;aY<aZ.length;aY++){var aR=aU._attachments[aZ[aY]];aV(aR.digest,aT.seq)}}var aQ=[];if(Object.keys(aP).forEach(function(bb){var bc=aP[bb];bc.forEach(function(bd){aQ.push([bb,bd])})}),!aQ.length){return aN()}var ba=0;aQ.forEach(function(bc){var bb="INSERT INTO "+gh+" (digest, seq) VALUES (?,?)";aX.executeSql(bb,bc,function(){++ba===aQ.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aF(aM)}var aI=0,aJ=10;aN()})}var aE="CREATE TABLE IF NOT EXISTS "+gh+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(hl,[],function(aH){aH.executeSql(fT,[],aC)})})}function ax(aD,aE){var aC="ALTER TABLE "+g2+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function ak(aD,aE){var aC="ALTER TABLE "+iP+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+iP+" SET max_seq=(SELECT MAX(seq) FROM "+cr+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aI){var aH="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+iP+" (max_seq)";aI.executeSql(aH,[],aE)})})}function ad(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;az=2===aG.length?"UTF-8":"UTF-16",aD()})}function aB(){for(;aa.length>0;){var aC=aa.pop();aC(null,ah)}}function ay(aC,aF){if(0===aF){var aK="CREATE TABLE IF NOT EXISTS "+fu+" (dbid, db_version INTEGER)",aM="CREATE TABLE IF NOT EXISTS "+g2+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aE="CREATE TABLE IF NOT EXISTS "+gh+" (digest, seq INTEGER)",aN="CREATE TABLE IF NOT EXISTS "+iP+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aD="CREATE TABLE IF NOT EXISTS "+cr+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aL="CREATE TABLE IF NOT EXISTS "+gt+" (id UNIQUE, rev, json)";aC.executeSql(aM),aC.executeSql(aL),aC.executeSql(aE,[],function(){aC.executeSql(fT),aC.executeSql(hl)}),aC.executeSql(aN,[],function(){aC.executeSql(w),aC.executeSql(aD,[],function(){aC.executeSql(fa),aC.executeSql(gX),aC.executeSql(aK,[],function(){var aP="INSERT INTO "+fu+" (db_version, dbid) VALUES (?,?)";ah=M();var aO=[a6,ah];aC.executeSql(aP,aO,function(){aB()})})})})}else{var aG=function(){var aO=a6>aF;aO&&aC.executeSql("UPDATE "+fu+" SET db_version = "+a6);var aP="SELECT dbid FROM "+fu;aC.executeSql(aP,[],function(aR,aQ){ah=aQ.rows.item(0).dbid,aB()})},aJ=[ag,au,t,al,ax,ak,aG],aI=aF,aH=function(aO){aJ[aI-1](aO,aH),aI++};aH(aC)}}function aj(){am.transaction(function(aC){ad(aC,function(){av(aC)})},a0(ab),aq)}function av(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+fu;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+fu,[],function(aI,aG){var aH=aG.rows.item(0).db_version;ay(aI,aH)}):aE.executeSql("ALTER TABLE "+fu+" ADD COLUMN db_version INTEGER",[],function(){ay(aE,1)}):ay(aE,0)})}function aA(aD,aE){if(-1!==af._docCount){return aE(af._docCount)}var aC=R("COUNT("+iP+".id) AS 'num'",[iP,cr],gj,cr+".deleted=0");aD.executeSql(aC,[],function(aG,aF){af._docCount=aF.rows.item(0).num,aE(af._docCount)})}var az,af=this,ah=null,ac=fm(aw),aa=[];af._docCount=-1,af._name=aw.name;var ap=gl({name:af._name,version:f2,description:af._name,size:ac,location:aw.location,createFromLocation:aw.createFromLocation,androidDatabaseImplementation:aw.androidDatabaseImplementation});if(ap.error){return a0(ab)(ap.error)}var am=ap.db;"function"!=typeof am.readTransaction&&(am.readTransaction=am.transaction),aj(),af.type=function(){return"websql"},af._id=gV(function(aC){aC(null,ah)}),af._info=function(aC){am.readTransaction(function(aD){aA(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+cr;aD.executeSql(aF,[],function(aG,aI){var aH=aI.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aH,sqlite_plugin:am._sqlitePlugin,websql_encoding:az})})})},a0(aC))},af._bulkDocs=function(aE,aC,aD){i0(aw,aE,aC,af,am,hj.Changes,aD)},af._get=function(aI,aE,aK){function aD(){aK(aG,{doc:aC,metadata:aJ,ctx:aL})}var aC,aJ,aG,aL=aE.ctx;if(!aL){return am.readTransaction(function(aM){af._get(aI,fj.extend({ctx:aM},aE),aK)})}var aF,aH;aE.rev?(aF=R(gP,[iP,cr],iP+".id="+cr+".doc_id",[cr+".doc_id=?",cr+".rev=?"]),aH=[aI,aE.rev]):(aF=R(gP,[iP,cr],gj,iP+".id=?"),aH=[aI]),aL.executeSql(aF,aH,function(aO,aN){if(!aN.rows.length){return aG=hA(hL,"missing"),aD()}var aM=aN.rows.item(0);return aJ=ev(aM.metadata),aM.deleted&&!aE.rev?(aG=hA(hL,"deleted"),aD()):(aC=n(aM.data,aJ.id,aM.rev),void aD())})},af._allDocs=function(aE,aL){var aO,aF=[],aD="startkey" in aE?aE.startkey:!1,aI="endkey" in aE?aE.endkey:!1,aN="key" in aE?aE.key:!1,aK="descending" in aE?aE.descending:!1,aM="limit" in aE?aE.limit:-1,aP="skip" in aE?aE.skip:0,aG=aE.inclusive_end!==!1,aJ=[],aC=[];if(aN!==!1){aC.push(iP+".id = ?"),aJ.push(aN)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aC.push(iP+".id "+(aK?"<=":">=")+" ?"),aJ.push(aD)),aI!==!1){var aH=aK?">":"<";aG&&(aH+="="),aC.push(iP+".id "+aH+" ?"),aJ.push(aI)}aN!==!1&&(aC.push(iP+".id = ?"),aJ.push(aN))}}"ok"!==aE.deleted&&aC.push(cr+".deleted = 0"),am.readTransaction(function(aQ){aA(aQ,function(aS){if(aO=aS,0!==aM){var aR=R(gP,[iP,cr],gj,aC,iP+".id "+(aK?"DESC":"ASC"));aR+=" LIMIT "+aM+" OFFSET "+aP,aQ.executeSql(aR,aJ,function(aV,aY){for(var aX=0,aW=aY.rows.length;aW>aX;aX++){var bb=aY.rows.item(aX),aZ=ev(bb.metadata),ba=aZ.id,aT=n(bb.data,ba,bb.rev),aU=aT._rev,bc={id:ba,key:ba,value:{rev:aU}};if(aE.include_docs&&(bc.doc=aT,bc.doc._rev=aU,aE.conflicts&&(bc.doc._conflicts=I(aZ)),gR(bc.doc,aE,af,aV)),bb.deleted){if("ok"!==aE.deleted){continue}bc.value.deleted=!0,bc.doc=null}aF.push(bc)}})}})},a0(aL),function(){aL(null,{total_rows:aO,offset:aE.skip,rows:aF})})},af._changes=function(aD){function aH(){var aM=iP+".json AS metadata, "+iP+".max_seq AS maxSeq, "+cr+".json AS winningDoc, "+cr+".rev AS winningRev ",aL=iP+" JOIN "+cr,aN=iP+".id="+cr+".doc_id AND "+iP+".winningseq="+cr+".seq",aO=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aO.push(iP+".id IN "+hc(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aK="maxSeq "+(aE?"DESC":"ASC"),aQ=R(aM,aL,aN,aO,aK),aS=gT(aD);aD.view||aD.filter||(aQ+=" LIMIT "+aI);var aP=aD.since||0;am.readTransaction(function(aT){aT.executeSql(aQ,aR,function(aU,bc){function bd(bf){return function(){aD.onChange(bf)}}for(var aV=0,aY=bc.rows.length;aY>aV;aV++){var ba=bc.rows.item(aV),bb=ev(ba.metadata);aP=ba.maxSeq;var aZ=n(ba.winningDoc,bb.id,ba.winningRev),aW=aD.processChange(aZ,bb,aD);aW.seq=ba.maxSeq;var aX=aS(aW);if("object"==typeof aX){return aD.complete(aX)}if(aX&&(aF++,aJ&&aC.push(aW),aD.attachments&&aD.include_docs?gR(aZ,aD,af,aU,bd(aW)):bd(aW)()),aF===aI){break}}})},a0(aD.complete),function(){aD.continuous||aD.complete(null,{results:aC,last_seq:aP})})}if(aD=iK(aD),aD.continuous){var aG=af._name+":"+M();return hj.Changes.addListener(af._name,aG,af,aD),hj.Changes.notify(af._name),{cancel:function(){hj.Changes.removeListener(af._name,aG)}}}var aE=aD.descending;aD.since=aD.since&&!aE?aD.since:0;var aI="limit" in aD?aD.limit:-1;0===aI&&(aI=1);var aJ;aJ="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aC=[],aF=0;aH()},af._close=function(aC){aC()},af._getAttachment=function(aD,aH,aG){var aE,aI=aH.ctx,aJ=aD.digest,aC=aD.content_type,aF="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+g2+" WHERE digest=?";aI.executeSql(aF,[aJ],function(aL,aK){var aN=aK.rows.item(0),aM=aN.escaped?h7(aN.body):ez(aN.body,az);aE=aH.binary?ij(aM,aC):hu(aM),aG(null,aE)})},af._getRevisionTree=function(aC,aD){am.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+iP+" WHERE id = ?";aE.executeSql(aF,[aC],function(aI,aH){if(aH.rows.length){var aG=ev(aH.rows.item(0).metadata);aD(null,aG.rev_tree)}else{aD(hA(hL))}})})},af._doCompaction=function(aD,aE,aC){return aE.length?void am.transaction(function(aF){var aG="SELECT json AS metadata FROM "+iP+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){var aI=ev(aJ.rows.item(0).metadata);iv(aI.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aK="UPDATE "+iP+" SET json = ? WHERE id = ?";aH.executeSql(aK,[gi(aI),aD])}),hF(aE,aD,aF)},a0(aC),function(){aC()}):aC()},af._getLocal=function(aC,aD){am.readTransaction(function(aE){var aF="SELECT json, rev FROM "+gt+" WHERE id=?";aE.executeSql(aF,[aC],function(aG,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=n(aH.json,aC,aH.rev);aD(null,aJ)}else{aD(hA(hL))}})})},af._putLocal=function(aE,aK,aG){function aI(aN){var aL,aM;aF?(aL="UPDATE "+gt+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aH,aC,aD,aF]):(aL="INSERT INTO "+gt+" (id, rev, json) VALUES (?,?,?)",aM=[aD,aH,aC]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aJ={ok:!0,id:aD,rev:aH},aK.ctx&&aG(null,aJ)):aG(hA(a4))},function(){return aG(hA(a4)),!1})}"function"==typeof aK&&(aG=aK,aK={}),delete aE._revisions;var aH,aF=aE._rev,aD=aE._id;aH=aF?aE._rev="0-"+(parseInt(aF.split("-")[1],10)+1):aE._rev="0-1";var aJ,aC=hC(aE);aK.ctx?aI(aK.ctx):am.transaction(aI,a0(aG),function(){aJ&&aG(null,aJ)})},af._removeLocal=function(aE,aG,aC){function aF(aJ){var aH="DELETE FROM "+gt+" WHERE id=? AND rev=?",aI=[aE._id,aE._rev];aJ.executeSql(aH,aI,function(aL,aK){return aK.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(hA(hL))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):am.transaction(aF,a0(aC),function(){aD&&aC(null,aD)})},af._destroy=function(aC,aD){hj.Changes.removeAllListeners(af._name),am.transaction(function(aE){var aF=[iP,cr,g2,fu,gt,gh];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},a0(aD),function(){f3()&&(delete window.localStorage["_pouch__websqldb_"+af._name],delete window.localStorage[af._name]),aD(null,{ok:!0})})}}function hy(t,ab,ac){try{t.apply(ab,ac)}catch(aa){"undefined"!=typeof PouchDB&&PouchDB.emit("error",aa)}}function a1(){if(!gv.running&&gv.queue.length){gv.running=!0;var t=gv.queue.shift();t.action(function(ab,aa){hy(t.callback,this,[ab,aa]),gv.running=!1,i.nextTick(a1)})}}function gA(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(hA(iF,aa,ab.type))}}function ey(ab,t,aa){return{data:gi(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function jg(aa){if(!aa){return null}var t=ev(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function jd(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function ei(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:gC(t,ab):p([""],{type:ab})):t?"string"!=typeof t?ha(t,function(ad){aa(hu(ad))}):aa(t):aa("")}function D(af,ad,ac,ab){function t(){++ag===aa.length&&ab&&ab()}function ah(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ac.objectStore(ir).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,t()}}var aa=Object.keys(af._attachments||{});if(!aa.length){return ab&&ab()}var ag=0;aa.forEach(function(aj){ad.attachments&&ad.include_docs?ah(af,aj):(af._attachments[aj].stub=!0,t())})}function f7(aa,t){return hp.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hp.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new hp(function(aj){ei(ah,af,t,function(ak){ac.doc._attachments[ag]=fj.extend(iO(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function a8(ag,ad,aj){function aa(){t--,t||ak()}function ak(){ah.length&&ah.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ac["delete"](am)}})}var ah=[],af=aj.objectStore(hv),ac=aj.objectStore(ir),ab=aj.objectStore(fU),t=ag.length;ag.forEach(function(al){var am=af.index("_doc_id_rev"),ap=ad+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return aa()}af["delete"](aq);var au=ab.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];ah.push(ay),ab["delete"](ax.primaryKey),ax["continue"]()}else{aa()}}}})}function id(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function h(ah,aE,af,aB,ay,ad,aw){function aa(){var aO=[gH,hv,ir,es,fq,fU],aP=id(ay,aO,"readwrite");return aP.error?aw(aP.error):(aD=aP.txn,aD.onabort=gA(aw),aD.ontimeout=gA(aw),aD.oncomplete=aL,al=aD.objectStore(gH),ax=aD.objectStore(hv),aF=aD.objectStore(ir),av=aD.objectStore(fU),void aN(function(aQ){return aQ?(aK=!0,aw(aQ)):void aH()}))}function ac(){ct(ah.revs_limit,aG,aB,aI,aD,au,ak,af)}function aH(){function aS(){++aQ===aG.length&&ac()}function aU(aW){var aV=jg(aW.target.result);aV&&aI.set(aV.id,aV),aS()}if(aG.length){for(var aQ=0,aT=0,aR=aG.length;aR>aT;aT++){var aO=aG[aT];if(aO._id&&hr(aO._id)){aS()}else{var aP=al.get(aO.metadata.id);aP.onsuccess=aU}}}}function aL(){aK||(ad.notify(aB._meta.name),aB._meta.docCount+=aJ,aw(null,au))}function am(aP,aQ){var aO=aF.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=hA(h2,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(aG.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){am(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function ak(aR,aX,aT,aV,aU,aS,aP,aW){aJ+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?aC(aR,aX,aT,aU,aP,aW):void aq(aR,aX,aT,aU,aP,aW)}function ab(aO){var aP=g(aO.metadata);a8(aP,aO.metadata.id,aD)}function aq(aX,aS,aP,aQ,aZ,aU){function aR(bb){aQ&&aB.auto_compaction&&ab(aX),aO.seq=bb.target.result,delete aO.rev;var bc=ey(aO,aS,aP),ba=al.put(bc);ba.onsuccess=aV}function aT(bc){bc.preventDefault(),bc.stopPropagation();var ba=ax.index("_doc_id_rev"),bb=ba.getKey(aY._doc_id_rev);bb.onsuccess=function(bd){var bf=ax.put(aY,bd.target.result);bf.onsuccess=aR}}function aV(){au[aZ]={ok:!0,id:aO.id,rev:aS},aI.set(aX.metadata.id,aX.metadata),aj(aX,aO.seq,aU)}var aY=aX.data,aO=aX.metadata;aY._doc_id_rev=aO.id+"::"+aO.rev,delete aY._id,delete aY._rev;var aW=ax.put(aY);aW.onsuccess=aR,aW.onerror=aT}function aC(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&aq(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(bb){var aZ=aQ.data._attachments[bb];if(aZ.stub){aP++,aO()}else{var bc=aZ.data;delete aZ.data;var ba=aZ.digest;aM(ba,bc,aW)}})}function aj(aV,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aW){var aX=aV.data._attachments[aW].digest,aY=av.put({seq:aQ,digestSeq:aX+"::"+aQ});aY.onsuccess=aO,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aV.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function aM(aP,aR,aO){var aQ=aF.count(aP);aQ.onsuccess=function(aV){var aU=aV.target.result;if(aU){return aO()}var aS={digest:aP,body:aR},aT=aF.put(aS);aT.onsuccess=aO}}for(var aD,al,ax,aF,av,aA,aG=aE.docs,aJ=0,az=0,ag=aG.length;ag>az;az++){var ap=aG[az];ap._id&&hr(ap._id)||(ap=aG[az]=gf(ap,af.new_edits),ap.error&&!aA&&(aA=ap))}if(aA){return aw(aA)}var au=new Array(aG.length),aI=new iJ.Map,aK=!1,t=aB._meta.blobSupport?"blob":"base64";iw(aG,t,function(aO){return aO?aw(aO):void aa()})}function r(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function gn(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(hA(iF,ac.name,ac.message))}function hW(ab,ad,t,ac){function aa(ay,ah){function aG(aL,aM,aK){var aN=aL.id+"::"+aK;aJ.get(aN).onsuccess=function(aO){aM.doc=jd(aO.target.result),ay.conflicts&&(aM.doc._conflicts=I(aL)),D(aM.doc,ay,au)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===ay.deleted){al.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):ay.include_docs&&aG(aL,aN,aK)}else{if(!aO&&aA--<=0&&(al.push(aN),ay.include_docs&&aG(aL,aN,aK),0===--aH)){return}}aM["continue"]()}function aw(aK){ag=ad._meta.docCount;var aM=aK.target.result;if(aM){var aL=jg(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aB(){ah(null,{total_rows:ag,offset:ay.skip,rows:al})}function aF(){ay.attachments?f7(al,ay.binary).then(aB):aB()}var ax="startkey" in ay?ay.startkey:!1,aE="endkey" in ay?ay.endkey:!1,aC="key" in ay?ay.key:!1,aA=ay.skip||0,aH="number"==typeof ay.limit?ay.limit:-1,aq=ay.inclusive_end!==!1,aD="descending" in ay&&ay.descending?"prev":null,ak=r(ax,aE,aq,aC,aD);if(ak&&ak.error){return gn(ad,ay,ak.error,ah)}var az=[gH,hv];ay.attachments&&az.push(ir);var am=id(t,az,"readonly");if(am.error){return ah(am.error)}var au=am.txn,ap=au.objectStore(gH),aI=au.objectStore(hv),aj=aD?ap.openCursor(ak,aD):ap.openCursor(ak),aJ=aI.index("_doc_id_rev"),al=[],ag=0;au.oncomplete=aF,aj.onsuccess=aw}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ad._meta.docCount,offset:ah.skip,rows:[]}):void aa(ah,ag)}af(ab,ac)}function h8(t){return new hp(function(ab){var aa=p([""]);t.objectStore(fw).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function fZ(ab,t){var aa=this;gv.queue.push({action:function(ac){ih(aa,ab,ac)},callback:t}),a1()}function ih(al,aq,ah){function af(av){var aw=av.createObjectStore(gH,{keyPath:"id"});av.createObjectStore(hv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(ir,{keyPath:"digest"}),av.createObjectStore(es,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(fw),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(fq,{keyPath:"_id"});var au=av.createObjectStore(fU,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ac(av,aw){var au=av.objectStore(gH);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=ig(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function aj(au){au.createObjectStore(fq,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aa(ay,ax){var av=ay.objectStore(fq),az=ay.objectStore(gH),aw=ay.objectStore(hv),au=az.openCursor();au.onsuccess=function(aJ){var aA=aJ.target.result;if(aA){var aG=aA.value,aD=aG.id,aE=hr(aD),aH=gq(aG);if(aE){var aK=aD+"::"+aH,aB=aD+"::",aI=aD+"::~",aL=aw.index("_doc_id_rev"),aC=IDBKeyRange.bound(aB,aI,!1,!1),aF=aL.openCursor(aC);aF.onsuccess=function(aN){if(aF=aN.target.result){var aM=aF.value;aM._doc_id_rev===aK&&av.put(aM),aw["delete"](aF.primaryKey),aF["continue"]()}else{az["delete"](aA.primaryKey),aA["continue"]()}}}else{aA["continue"]()}}else{ax&&ax()}}}function ad(au){var av=au.createObjectStore(fU,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(ay,ax){var av=ay.objectStore(hv),az=ay.objectStore(ir),aw=ay.objectStore(fU),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (av.openCursor().onsuccess=function(aL){var aF=aL.target.result;if(!aF){return ax()}for(var aG=aF.value,aD=aF.primaryKey,aJ=Object.keys(aG._attachments||{}),aH={},aI=0;aI<aJ.length;aI++){var aK=aG._attachments[aJ[aI]];aH[aK.digest]=!0}var aC=Object.keys(aH);for(aI=0;aI<aC.length;aI++){var aE=aC[aI];aw.put({seq:aD,digestSeq:aE+"::"+aD})}aF["continue"]()}):ax()}}function am(au){function ax(az){return az.data?jg(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=au.objectStore(hv),av=au.objectStore(gH),ay=av.openCursor();ay.onsuccess=function(aC){function az(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=ey(aD,aD.winningRev,aD.deleted),aF=av.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=aC.target.result;if(aB){var aD=ax(aB.value);return aD.winningRev=aD.winningRev||gq(aD),aD.seq?aA():void az()}}}var t=aq.name,ap=null;al._meta=null,al.type=function(){return"idb"},al._id=gV(function(au){au(null,al._meta.instanceId)}),al._bulkDocs=function(au,aw,av){h(aq,au,aw,al,ap,fZ.Changes,av)},al._get=function(aA,aw,aB){function au(){aB(az,{doc:aC,metadata:ax,ctx:av})}var aC,ax,az,av=aw.ctx;if(!av){var ay=id(ap,[gH,hv,ir],"readonly");if(ay.error){return aB(ay.error)}av=ay.txn}av.objectStore(gH).get(aA).onsuccess=function(aG){if(ax=jg(aG.target.result),!ax){return az=hA(hL,"missing"),au()}if(ig(ax)&&!aw.rev){return az=hA(hL,"deleted"),au()}var aE=av.objectStore(hv),aD=aw.rev||ax.winningRev,aF=ax.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aC=aH.target.result,aC&&(aC=jd(aC)),aC?void au():(az=hA(hL,"missing"),au())}}},al._getAttachment=function(ay,aA,av){var aw;if(aA.ctx){aw=aA.ctx}else{var au=id(ap,[gH,hv,ir],"readonly");if(au.error){return av(au.error)}aw=au.txn}var ax=ay.digest,az=ay.content_type;aw.objectStore(ir).get(ax).onsuccess=function(aC){var aB=aC.target.result.body;ei(aB,az,aA.binary,function(aD){av(null,aD)})}},al._info=function(aA){if(null===ap||!hn[t]){var aw=new Error("db isn't open");return aw.id="idbNull",aA(aw)}var av,au,ax=id(ap,[hv],"readonly");if(ax.error){return aA(ax.error)}var az=ax.txn,ay=az.objectStore(hv).openCursor(null,"prev");ay.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,au=al._meta.docCount},az.oncomplete=function(){aA(null,{doc_count:au,update_seq:av,idb_attachment_format:al._meta.blobSupport?"binary":"base64"})}},al._allDocs=function(av,au){hW(av,al,ap,au)},al._changes=function(az){function aE(aP){function aM(){return aS.seq!==aR?aP["continue"]():(au=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aC.get(aU);aT.onsuccess=function(aV){aN(jd(aV.target.result))}}function aN(aU){var aT=az.processChange(aU,aS,az);aT.seq=aS.seq;var aV=aF(aT);return"object"==typeof aV?az.complete(aV):(aV&&(aJ++,aH&&ax.push(aT),az.attachments&&az.include_docs?D(aU,az,aK,function(){f7([aT],az.binary).then(function(){az.onChange(aT)})}):az.onChange(aT)),void (aJ!==aA&&aP["continue"]()))}var aQ=jd(aP.value),aR=aP.key;if(aD&&!aD.has(aQ._id)){return aP["continue"]()}var aS;return(aS=ay.get(aQ._id))?aM():void (aB.get(aQ._id).onsuccess=function(aT){aS=jg(aT.target.result),ay.set(aQ._id,aS),aM()})}function aw(aN){var aM=aN.target.result;aM&&aE(aM)}function aG(){var aM=[gH,hv];az.attachments&&aM.push(ir);var aN=id(ap,aM,"readonly");if(aN.error){return az.complete(aN.error)}aK=aN.txn,aK.onabort=gA(az.complete),aK.oncomplete=aL,aI=aK.objectStore(hv),aB=aK.objectStore(gH),aC=aI.index("_doc_id_rev");var aO;aO=az.descending?aI.openCursor(null,"prev"):aI.openCursor(IDBKeyRange.lowerBound(az.since,!0)),aO.onsuccess=aw}function aL(){function aM(){az.complete(null,{results:ax,last_seq:au})}!az.continuous&&az.attachments?f7(ax).then(aM):aM()}if(az=iK(az),az.continuous){var av=t+":"+M();return fZ.Changes.addListener(t,av,al,az),fZ.Changes.notify(t),{cancel:function(){fZ.Changes.removeListener(t,av)}}}var aD=az.doc_ids&&new iJ.Set(az.doc_ids);az.since=az.since||0;var au=az.since,aA="limit" in az?az.limit:-1;0===aA&&(aA=1);var aH;aH="return_docs" in az?az.return_docs:"returnDocs" in az?az.returnDocs:!0;var aK,aI,aB,aC,ax=[],aJ=0,aF=gT(az),ay=new iJ.Map;aG()},al._close=function(au){return null===ap?au(hA(iE)):(ap.close(),delete hn[t],ap=null,void au())},al._getRevisionTree=function(au,ax){var aw=id(ap,[gH],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(gH).get(au);ay.onsuccess=function(aA){var az=jg(aA.target.result);az?ax(null,az.rev_tree):ax(hA(hL))}},al._doCompaction=function(ay,aA,av){var aw=[gH,hv,ir,fU],au=id(ap,aw,"readwrite");if(au.error){return av(au.error)}var ax=au.txn,az=ax.objectStore(gH);az.get(ay).onsuccess=function(aC){var aE=jg(aC.target.result);iv(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==aA.indexOf(aF)&&(aK.status="missing")}),a8(aA,ay,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(gH).put(ey(aE,aD,aB))},ax.onabort=gA(av),ax.oncomplete=function(){av()}},al._getLocal=function(au,ax){var aw=id(ap,[fq],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(fq).get(au);ay.onerror=gA(ax),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(hA(hL))}},al._putLocal=function(ay,aD,az){"function"==typeof aD&&(az=aD,aD={}),delete ay._revisions;var aB=ay._rev,aA=ay._id;aB?ay._rev="0-"+(parseInt(aB.split("-")[1],10)+1):ay._rev="0-1";var av,aw=aD.ctx;if(!aw){var aC=id(ap,[fq],"readwrite");if(aC.error){return az(aC.error)}aw=aC.txn,aw.onerror=gA(az),aw.oncomplete=function(){av&&az(null,av)}}var au,ax=aw.objectStore(fq);aB?(au=ax.get(aA),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aB){var aG=ax.put(ay);aG.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)}}else{az(hA(a4))}}):(au=ax.add(ay),au.onerror=function(aE){az(hA(a4)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)})},al._removeLocal=function(aA,aw,aB){"function"==typeof aw&&(aB=aw,aw={});var au=aw.ctx;if(!au){var aC=id(ap,[fq],"readwrite");if(aC.error){return aB(aC.error)}au=aC.txn,au.oncomplete=function(){ax&&aB(null,ax)}}var ax,az=aA._id,av=au.objectStore(fq),ay=av.get(az);ay.onerror=gA(aB),ay.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aA._rev?(av["delete"](az),ax={ok:!0,id:az,rev:"0-0"},aw.ctx&&aB(null,ax)):aB(hA(hL))}},al._destroy=function(av,aw){fZ.Changes.removeAllListeners(t),fZ.openReqList[t]&&fZ.openReqList[t].result&&(fZ.openReqList[t].result.close(),delete hn[t]);var au=indexedDB.deleteDatabase(t);au.onsuccess=function(){fZ.openReqList[t]&&(fZ.openReqList[t]=null),f3()&&t in localStorage&&delete localStorage[t],aw(null,{ok:!0})},au.onerror=gA(aw)};var ag=hn[t];if(ag){return ap=ag.idb,al._meta=ag.global,void i.nextTick(function(){ah(null,al)})}var ab;ab=aq.storage?et(t,aq.storage):indexedDB.open(t,f8),"openReqList" in fZ||(fZ.openReqList={}),fZ.openReqList[t]=ab,ab.onupgradeneeded=function(ay){function av(){var aA=aw[au-1];au++,aA&&aA(az,av)}var ax=ay.target.result;if(ay.oldVersion<1){return af(ax)}var az=ay.currentTarget.transaction;ay.oldVersion<3&&aj(ax),ay.oldVersion<4&&ad(ax);var aw=[ac,aa,ak,am],au=ay.oldVersion;av()},ab.onsuccess=function(az){ap=az.target.result,ap.onversionchange=function(){ap.close(),delete hn[t]},ap.onabort=function(aA){console.error("Database has a global failure",aA.target.error),ap.close(),delete hn[t]};var av=ap.transaction([es,fw,gH],"readwrite"),aw=av.objectStore(es).get(es),ax=null,ay=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ax&&null!==ay&&null!==au&&(al._meta={name:t,instanceId:au,blobSupport:ax,docCount:ay},hn[t]={idb:ap,global:al._meta},ah(null,al))},aA=aB.target.result||{id:es};t+"_id" in aA?(au=aA[t+"_id"],aD()):(au=M(),aA[t+"_id"]=au,av.objectStore(es).put(aA).onsuccess=function(){aD()}),fS||(fS=h8(av)),fS.then(function(aE){ax=aE,aD()});var aC=av.objectStore(gH).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ay=aE.target.result,aD()}}},ab.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),ah(hA(iF,av))}}function et(ab,t){try{return indexedDB.open(ab,{version:f8,storage:t})}catch(aa){return indexedDB.open(ab,f8)}}var fj=a(7),ar="default" in fj?fj["default"]:fj,ip=a(6);ip="default" in ip?ip["default"]:ip;var iJ=a(12);iJ="default" in iJ?iJ["default"]:iJ;var fX=a(4),S=a(1);S="default" in S?S["default"]:S;var hT=a(2);hT="default" in hT?hT["default"]:hT;var cn=a(10),fx="default" in cn?cn["default"]:cn,i1=a(8);i1="default" in i1?i1["default"]:i1;var q=a(14);q="default" in q?q["default"]:q;var ja=a(15);ja="default" in ja?ja["default"]:ja;var a3=a(16);a3="default" in a3?a3["default"]:a3;var hp="function"==typeof Promise?Promise:i1,go=fp();ip(i9,Error),i9.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var dr=new i9({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),z=new i9({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),hL=new i9({status:404,error:"not_found",reason:"missing"}),a4=new i9({status:409,error:"conflict",reason:"Document update conflict"}),fv=new i9({status:400,error:"invalid_id",reason:"_id field must contain a string"}),iR=new i9({status:412,error:"missing_id",reason:"_id is required for puts"}),iL=new i9({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),iE=new i9({status:412,error:"precondition_failed",reason:"Database not open"}),gd=new i9({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),fW=new i9({status:500,error:"badarg",reason:"Some query argument is invalid"}),iS=new i9({status:400,error:"invalid_request",reason:"Request was invalid"}),a5=new i9({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),hH=new i9({status:500,error:"doc_validation",reason:"Bad special document member"}),T=new i9({status:400,error:"bad_request",reason:"Something wrong with the request"}),k=new i9({status:400,error:"bad_request",reason:"Document must be a JSON object"}),gS=new i9({status:404,error:"not_found",reason:"Database not found"}),iF=new i9({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ie=new i9({status:500,error:"web_sql_went_bad",reason:"unknown"}),fg=new i9({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),iq=new i9({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),hO=new i9({status:400,error:"bad_request",reason:"Invalid rev format"}),f1=new i9({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),h2=new i9({status:412,error:"missing_stub"}),ga=new i9({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),i2={UNAUTHORIZED:dr,MISSING_BULK_DOCS:z,MISSING_DOC:hL,REV_CONFLICT:a4,INVALID_ID:fv,MISSING_ID:iR,RESERVED_ID:iL,NOT_OPEN:iE,UNKNOWN_ERROR:gd,BAD_ARG:fW,INVALID_REQUEST:iS,QUERY_PARSE_ERROR:a5,DOC_VALIDATION:hH,BAD_REQUEST:T,NOT_AN_OBJECT:k,DB_MISSING:gS,WSQ_ERROR:ie,LDB_ERROR:fg,FORBIDDEN:iq,INVALID_REV:hO,FILE_EXISTS:f1,MISSING_STUB:h2,IDB_ERROR:iF,INVALID_URL:ga},iH=function(ab,ad,t){var ac=Object.keys(i2).filter(function(af){var ag=i2[af];return"function"!=typeof ag&&ag[ab]===ad}),aa=t&&ac.filter(function(af){var ag=i2[af];return ag.message===t})[0]||ac[0];return aa?i2[aa]:null},iB=function(){},O=hT("pouchdb:api");ip(A,fX.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=iK(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=jb,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=F(ab.view):ab.filter=F(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=S(function(af){ac.cancel(),aa.apply(this,af)})}},A.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=hA(T,"`view` filter parameter not found or invalid.");return t(ac)}var aa=P(ab.view);this.db.get("_design/"+aa[0],function(ah,aj){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ah){return t(g0(ah))}var ag=aj&&aj.views&&aj.views[aa[1]]&&aj.views[aa[1]].map;return ag?(ab.filter=ho(ag),void ad.doChanges(ab)):t(hA(hL,aj.views?"missing json key: "+aa[1]:"missing json key: views"))})}else{var af=P(ab.filter);if(!af){return ad.doChanges(ab)}this.db.get("_design/"+af[0],function(ag,aj){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ag){return t(g0(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ab.filter=i3(ah),void ad.doChanges(ab)):t(hA(hL,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),hq=N(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),jk=N(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);ip(iy,fX.EventEmitter),iy.prototype.post=ew("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(hA(k)):void this.bulkDocs({docs:[ab]},t,gD(aa))}),iy.prototype.put=ew("put",S(function(aa){var ac,ag,ab,t,ad=aa.shift(),af="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(t=aa.pop())(hA(k))}for(;;){if(ac=aa.shift(),ag=typeof ac,"string"!==ag||af?"string"!==ag||!af||"_rev" in ad?"object"===ag?ab=ac:"function"===ag&&(t=ac):ad._rev=ac:(ad._id=ac,af=!0),!aa.length){break}}return ab=ab||{},C(ad._id),hr(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,t):this._putLocal(ad,t):void this.bulkDocs({docs:[ad]},ab,gD(t))})),iy.prototype.putAttachment=ew("putAttachment",function(af,ad,ac,ab,t,ah){function aa(aj){return aj._attachments=aj._attachments||{},aj._attachments[ad]={content_type:t,data:ab},ag.put(aj)}var ag=this;return"function"==typeof t&&(ah=t,t=ab,ab=ac,ac=null),"undefined"==typeof t&&(t=ab,ab=ac,ac=null),ag.get(af).then(function(aj){if(aj._rev!==ac){throw hA(a4)}return aa(aj)},function(aj){if(aj.reason===hL.message){return aa({_id:af})}throw aj})}),iy.prototype.removeAttachment=ew("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(hA(a4)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),iy.prototype.remove=ew("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,hr(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,gD(ac))}),iy.prototype.revsDiff=ew("revsDiff",function(af,ad,ac){function ab(ak,aj){ag.has(ak)||ag.set(ak,{missing:[]}),ag.get(ak).missing.push(aj)}function t(aj,ak){var al=af[aj].slice(0);iv(ak,function(am,ap,aq,aw,au){var av=ap+"-"+aq,ax=al.indexOf(av);-1!==ax&&(al.splice(ax,1),"available"!==au.status&&ab(aj,av))}),al.forEach(function(am){ab(aj,am)})}"function"==typeof ad&&(ac=ad,ad={});var ah=Object.keys(af);if(!ah.length){return ac(null,{})}var aa=0,ag=new iJ.Map;ah.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ag.set(aj,{missing:af[aj]})}else{if(al){return ac(al)}t(aj,am)}if(++aa===ah.length){var ak={};return ag.forEach(function(ap,aq){ak[aq]=ap}),ac(null,ak)}})},this)}),iy.prototype.bulkGet=ew("bulkGet",function(aa,t){hG(this,aa,t)}),iy.prototype.compactDocument=ew("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ah,ad){if(ah){return ac(ah)}var ag=x(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>ab&&aj.push(ak)}),iv(ad,function(al,ap,au,am,ak){var aq=ap+"-"+au;"available"===ak.status&&-1!==aj.indexOf(aq)&&af.push(aq)}),aa._doCompaction(t,af,ac)})}),iy.prototype.compact=ew("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&hB(aa)}),iy.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(aj){var ah=aj.last_seq;hp.all(af).then(function(){return f6(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},iy.prototype.get=ew("get",function(af,ad,ac){function ab(){var ak=[],aj=t.length;return aj?void t.forEach(function(al){ah.get(af,{rev:al,revs:ad.revs,attachments:ad.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ac(null,ak)})}):ac(null,ak)}if("function"==typeof ad&&(ac=ad,ad={}),"string"!=typeof af){return ac(hA(fv))}if(hr(af)&&"function"==typeof this._getLocal){return this._getLocal(af,ac)}var t=[],ah=this;if(!ad.open_revs){return this._get(af,ad,function(ax,aw){if(ax){return ac(ax)}var al=aw.doc,az=aw.metadata,aq=aw.ctx;if(ad.conflicts){var ap=I(az);ap.length&&(al._conflicts=ap)}if(ig(az,al._rev)&&(al._deleted=!0),ad.revs||ad.revs_info){var au=E(az.rev_tree),aj=hQ(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(al._rev.split("-")[1])}),am=aj.ids.map(function(aC){return aC.id}).indexOf(al._rev.split("-")[1])+1,av=aj.ids.length-am;if(aj.ids.splice(am,av),aj.ids.reverse(),ad.revs&&(al._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),ad.revs_info){var ay=aj.pos+aj.ids.length;al._revs_info=aj.ids.map(function(aC){return ay--,{rev:ay+"-"+aC.id,status:aC.opts.status}})}}if(ad.attachments&&al._attachments){var aB=al._attachments,aA=Object.keys(aB).length;if(0===aA){return ac(null,al)}Object.keys(aB).forEach(function(aC){this._getAttachment(aB[aC],{binary:ad.binary,ctx:aq},function(aE,aD){var aF=al._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aA||ac(null,al)})},ah)}else{if(al._attachments){for(var ak in al._attachments){al._attachments.hasOwnProperty(ak)&&(al._attachments[ak].stub=!0)}}ac(null,al)}})}if("all"===ad.open_revs){this._getRevisionTree(af,function(ak,aj){return ak?ac(ak):(t=an(aj).map(function(al){return al.rev}),void ab())})}else{if(!Array.isArray(ad.open_revs)){return ac(hA(gd,"function_clause"))}t=ad.open_revs;for(var aa=0;aa<t.length;aa++){var ag=t[aa];if("string"!=typeof ag||!/^\d+-/.test(ag)){return ac(hA(hO))}}ab()}}),iy.prototype.getAttachment=ew("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ag.doc._attachments[ad],t,ac),void 0):ac(hA(hL))})}),iy.prototype.allDocs=ew("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(hA(a5,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return g9(this,ab,t)}}return this._allDocs(ab,t)}),iy.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new A(this,aa,t)},iy.prototype.close=ew("close",function(t){return this._closed=!0,this._close(t)}),iy.prototype.info=ew("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),iy.prototype.id=ew("id",function(t){return this._id(t)}),iy.prototype.bulkDocs=ew("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(hA(z))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(hA(k))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||fe(ag)})}),aa?t(hA(T,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(i4),ht(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),iy.prototype.registerDependentDatabase=ew("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);f6(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),iy.prototype.destroy=ew("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});hp.all(af).then(t,ad)})}),ex.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},ex.prototype.fail=function(t){this.failed=t,this.execute()},ex.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ex.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},ip(i6,iy),i6.debug=hT;var f4;if(H()){f4=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),f4=!!localStorage.getItem("_pouch_check_localstorage")}catch(fy){f4=!1}}i6.adapters={},i6.preferredAdapters=[],i6.prefix="_pouch_";var it=new fX.EventEmitter;eo(i6),i6.parseAdapter=function(af,ad){var ac,ab,t=af.match(/([a-z\-]*):\/\/(.*)/);if(t){if(af=/http(s?)/.test(t[1])?t[1]+"://"+t[2]:t[2],ac=t[1],!i6.adapters[ac].valid()){throw"Invalid adapter"}return{name:af,adapter:t[1]}}var ah="idb" in i6.adapters&&"websql" in i6.adapters&&f3()&&localStorage["_pouch__websqldb_"+i6.prefix+af];if(ad.adapter){ab=ad.adapter}else{if("undefined"!=typeof ad&&ad.db){ab="leveldb"}else{for(var aa=0;aa<i6.preferredAdapters.length;++aa){if(ab=i6.preferredAdapters[aa],ab in i6.adapters){if(ah&&"idb"===ab){console.log('PouchDB is downgrading "'+af+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ac=i6.adapters[ab];var ag=ac&&"use_prefix" in ac?ac.use_prefix:!0;return{name:ag?i6.prefix+af:af,adapter:ab}},i6.adapter=function(ab,t,aa){t.valid()&&(i6.adapters[ab]=t,aa&&i6.preferredAdapters.push(ab))},i6.plugin=function(t){return Object.keys(t).forEach(function(aa){i6.prototype[aa]=t[aa]}),i6},i6.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=fj.extend({},aa,ad),void i6.call(this,ab,ad,ac)):new t(ab,ad,ac)}return ip(t,i6),eo(t),t.preferredAdapters=i6.preferredAdapters.slice(),Object.keys(i6).forEach(function(ab){ab in t||(t[ab]=i6[ab])}),t};var hP=function(t){return atob(t)},hu=function(t){return btoa(t)},co=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],iD="queryKey",iz=/(?:^|&)([^&=]*)=?([^&]*)/g,at=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ao=ar.extend,io={ajax:gZ,parseUri:hi,uuid:M,Promise:hp,atob:hP,btoa:hu,binaryStringToBlobOrBuffer:ij,clone:iK,extend:ao,createError:hA},hJ=fx.collate,fV=1,iA="pouchdb",gE=5,fh=0;B.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},B.prototype.updateTarget=function(aa,t){return g4(this.target,this.id,aa,t,this.returnValue)},B.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?hp.resolve(!0):g4(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return aa.readOnlySource=!0,!0}throw ac})};var ib={undefined:function(aa,t){return 0===hJ(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return jj(t,aa).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return fh}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in ib?ib[ab](aa,ac):fh},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:fh}).then(function(){return fh},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):fh})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return fh})};var gW=0,iW=o.setImmediate||o.setTimeout,fn=32768,iY=gV(function(ag,ad){function aj(){var aq=ac*ah,al=aq+ah;if(ac++,af>ac){t(ab,ag,aq,al),iW(aj)}else{t(ab,ag,aq,al);var ap=ab.end(!0),am=ix(ap);ad(null,am),ab.destroy()}}var aa="string"==typeof ag,ak=aa?ag.length:ag.byteLength,ah=Math.min(fn,ak),af=Math.ceil(ak/ah),ac=0,ab=aa?new ja:new ja.ArrayBuffer,t=aa?gw:iG;aj()});ip(iC,fX.EventEmitter),iC.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},iC.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))};var g7={replicate:gY,toPouch:ji},ft=g7.replicate;ip(il,fX.EventEmitter),il.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var Y=25,er=50,hg={},V=1800,h4=hT("pouchdb:http");fY.valid=function(){return !0};var hh=function(aa,t){return t&&aa.then(function(ab){i.nextTick(function(){t(null,ab)})},function(ab){i.nextTick(function(){t(ab)})}),aa},gc=function(t){return S(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hh(ab,aa),ab})},je=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},gQ=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},jh=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},hk={uniq:jh,sequentialize:gQ,fin:je,callbackify:gc,promisedCallback:hh};hE.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},hE.prototype.finish=function(){return this.promise};var hZ,hR=fx.collate,gg=fx.toIndexableString,h5=fx.normalizeKey,gr=fx.parseIndexableString;hZ="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var gx=hk.callbackify,gB=hk.sequentialize,gN=hk.uniq,hz=hk.fin,ff=hk.promisedCallback,iZ={},Z=new hE,jf=50,i7={_sum:function(aa,t){return gp(t)},_count:function(aa,t){return t.length},_stats:function(ab,t){function aa(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:gp(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},bn=gx(function(){var t=this;return"http"===t.type()?gL(t):"function"==typeof t._viewCleanup?ge(t):bt(t)}),L=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?hM(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=hp.resolve().then(function(){return fs(ac,ab,ad)});return ff(aa,t),aa};ip(fk,Error),ip(fr,Error),ip(l,Error);var en={query:L,viewCleanup:bn},a6=7,iP=h6("document-store"),cr=h6("by-sequence"),g2=h6("attach-store"),gt=h6("local-store"),fu=h6("metadata-store"),gh=h6("attach-seq-store"),gI={};ip(jc,fX.EventEmitter),jc.prototype.addListener=function(aa,ac,ag,ab){function t(){function ah(){af=!1}if(ad._listeners[ac]){if(af){return void (af="waiting")}af=!0;var aj=iO(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){t()},0),af=!1}).on("error",ah)}}if(!this._listeners[ac]){var ad=this,af=!1;this._listeners[ac]=t,this.on(aa,t)}},jc.prototype.removeListener=function(aa,t){t in this._listeners&&fX.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},jc.prototype.notifyLocalWindows=function(t){H()?chrome.storage.local.set({dbName:t}):f3()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},jc.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var f2=1,fa="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+cr+" (seq, deleted)",gX="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+cr+" (doc_id, rev)",w="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+iP+" (winningseq)",fT="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+gh+" (seq)",hl="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+gh+" (digest, seq)",gj=cr+".seq = "+iP+".winningseq",gP=cr+".seq AS seq, "+cr+".deleted AS deleted, "+cr+".json AS data, "+cr+".rev AS rev, "+iP+".json AS metadata";hj.valid=h3,hj.Changes=new jc;var fS,f8=5,gH="document-store",hv="by-sequence",ir="attach-store",fU="attach-seq-store",es="meta-store",fq="local-store",fw="detect-blob-support",gv={running:!1,queue:[]},hn={};fZ.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},fZ.Changes=new jc;var h0={idb:fZ,websql:hj};i6.ajax=gZ,i6.utils=io,i6.Errors=i2,i6.replicate=g7.replicate,i6.sync=h9,i6.version="5.2.0",i6.adapter("http",fY),i6.adapter("https",fY),i6.plugin(en),Object.keys(h0).forEach(function(t){i6.adapter(t,h0[t],!0)}),b.exports=i6}).call(this,a(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});