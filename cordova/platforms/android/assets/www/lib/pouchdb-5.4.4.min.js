!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(g,n){if(!b[g]){if(!i[g]){var f="function"==typeof require&&require;if(!n&&f){return f(g,!0)}if(a){return a(g,!0)}var h=new Error("Cannot find module '"+g+"'");throw h.code="MODULE_NOT_FOUND",h}var j=b[g]={exports:{}};i[g][0].call(j.exports,function(p){var m=i[g][1][p];return k(m?m:p)},j,j.exports,d,i,b,l)}return b[g].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(h){var g,f,k,j,r,l;if(this._events||(this._events={}),"error"===h&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(f=this._events[h],i(f)){return !1}if(b(f)){switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:j=Array.prototype.slice.call(arguments,1),f.apply(this,j)}}else{if(m(f)){for(j=Array.prototype.slice.call(arguments,1),l=f.slice(),k=l.length,r=0;k>r;r++){l[r].apply(this,j)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(g,j){function f(){this.removeListener(g,f),h||(h=!0,j.apply(this,arguments))}if(!b(j)){throw TypeError("listener must be a function")}var h=!1;return f.listener=j,this.on(g,f),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(m(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(e,n,b){function h(){l&&r&&(l=!1,r.length?a=r.concat(a):o=-1,a.length&&f())}function f(){if(!l){var g=s(h);l=!0;for(var j=a.length;j;){for(r=a,a=[];++o<j;){r&&r[o].run()}o=-1,j=a.length}r=null,l=!1,u(g)}}function t(g,j){this.fun=g,this.array=j}function i(){}var s,u,B=n.exports={};!function(){try{s=setTimeout}catch(g){s=function(){throw new Error("setTimeout is not defined")}}try{u=clearTimeout}catch(g){u=function(){throw new Error("clearTimeout is not defined")}}}();var r,a=[],l=!1,o=-1;B.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}a.push(new t(j,k)),1!==a.length||l||s(f,0)},t.prototype.run=function(){this.fun.apply(null,this.array)},B.title="browser",B.browser=!0,B.env={},B.argv=[],B.version="",B.versions={},B.on=i,B.addListener=i,B.once=i,B.off=i,B.removeListener=i,B.removeAllListeners=i,B.emit=i,B.binding=function(g){throw new Error("process.binding is not supported")},B.cwd=function(){return"/"},B.chdir=function(g){throw new Error("process.chdir is not supported")},B.umask=function(){return 0}},{}],3:[function(a,b,e){(function(fi,fy){function gD(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fv(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fh(ac){if("function"==typeof ac.slice){return ac.slice(0)}var aa=new ArrayBuffer(ac.byteLength),ab=new Uint8Array(aa),t=new Uint8Array(ac);return ab.set(t),aa}function E(ab){if(ab instanceof ArrayBuffer){return fh(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function a1(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&fV.call(aa)==g7}function hn(t){var ab,ac,aa;if(!t||"object"!=typeof t){return t}if(Array.isArray(t)){for(ab=[],ac=0,aa=t.length;aa>ac;ac++){ab[ac]=hn(t[ac])}return ab}if(t instanceof Date){return t.toISOString()}if(fv(t)){return E(t)}if(!a1(t)){return t}ab={};for(ac in t){if(Object.prototype.hasOwnProperty.call(t,ac)){var ad=hn(t[ac]);"undefined"!=typeof ad&&(ab[ac]=ad)}}return ab}function fg(t){var aa=!1;return bt(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function cn(t){return bt(function(ac){ac=hn(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){fi.nextTick(function(){ad(ah,ag)})});var af=new hc(function(ak,al){var ah;try{var aj=fg(function(ap,am){ap?al(ap):ak(am)});ac.push(aj),ah=t.apply(aa,ac),ah&&"function"==typeof ah.then&&ak(ah)}catch(ag){al(ag)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function a4(ab,t){function aa(ah,ac,af){if(hl.enabled){for(var aj=[ah._db_name,ac],ag=0;ag<af.length-1;ag++){aj.push(af[ag])}hl.apply(null,aj);var ad=af[af.length-1];af[af.length-1]=function(ak,am){var al=[ah._db_name,ac];al=al.concat(ak?["error",ak]:["success",am]),hl.apply(null,al),ad(ak,am)}}}return cn(bt(function(ad){if(this._closed){return hc.reject(new Error("database is closed"))}if(this._destroyed){return hc.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new hc(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function fc(t,ab){for(var ac={},aa=0,ad=ab.length;ad>aa;aa++){var af=ab[aa];af in t&&(ac[af]=t[af])}return ac}function ct(t){return t}function a5(t){return[{ok:t}]}function R(aj,ah,t){function ab(){var av=[];ag.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),t(null,{results:av})}function aa(){++au===al&&ab()}function ap(aw,ax,av){ag[aw]={id:ax,docs:av},aa()}function ac(){if(!(am>=ad.length)){var av=Math.min(am+fe,ad.length),aw=ad.slice(am,av);ak(aw,am),am+=aw.length}}function ak(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=af[aC],aB=fc(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(ct);var ax=ct;0===aB.open_revs.length&&(delete aB.open_revs,ax=a5),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ah&&(aB[aD]=ah[aD])}),aj.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),ap(ay,aC,aE),ac()})})}var aq=ah.docs,af={};aq.forEach(function(av){av.id in af?af[av.id].push(av):af[av.id]=[av]});var al=Object.keys(af).length,au=0,ag=new Array(al),ad=Object.keys(af),am=0;ac()}function he(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fZ(){return cr}function iS(t){he()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fZ()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ce(){C.EventEmitter.call(this),this._listeners={},iS(this)}function a8(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function u(t,ab){var ac=600000;t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1,ab>ac&&(t=ac>>1,ab=ac);var aa=Math.random(),ad=ab-t;return ~~(ad*aa+t)}function B(t){var aa=0;return t||(aa=2000),u(t,aa)}function eo(t,aa){a8("info","The above "+t+" is totally normal. "+aa)}function gC(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function p(ac,aa,ab){function t(af){for(var ad in ac){"function"!=typeof ac[ad]&&(this[ad]=ac[ad])}void 0!==ab&&(this.name=ab),void 0!==af&&(this.reason=af)}return t.prototype=gC.prototype,new t(aa)}function n(t){var ab,ac,aa,ad,af;return ac=t.error===!0&&"string"==typeof t.name?t.name:t.error,af=t.reason,aa=h8("name",ac,af),t.missing||"missing"===af||"deleted"===af||"not_found"===ac?aa=i3:"doc_validation"===ac?(aa=at,ad=af):"bad_request"===ac&&aa.message!==af&&(aa=hd),aa||(aa=h8("status",t.status,af)||i8),ab=p(aa,af,ac),ad&&(ab.message=ad),t.id&&(ab.id=t.id),t.status&&(ab.status=t.status),t.missing&&(ab.missing=t.missing),ab}function iN(t,ab,ac){try{return !t(ab,ac)}catch(aa){var ad="Filter function threw: "+aa.toString();return p(hd,ad)}}function fn(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&iN(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function iD(ac){for(var aa=[],ab=0,t=ac.length;t>ab;ab++){aa=aa.concat(ac[ab])}return aa}function Y(t){var aa;if(t?"string"!=typeof t?aa=p(g1):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=p(W)):aa=p(dn),aa){throw aa}}function gy(t,aa){return"listenerCount" in t?t.listenerCount(aa):C.EventEmitter.listenerCount(t,aa)}function m(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function h(t){var aa=m(t);return aa?aa.join("/"):null}function z(ad){for(var aa=ez.exec(ad),ag={},t=14;t--;){var ac=ju[t],ab=aa[t]||"",af=-1!==["user","password"].indexOf(ac);ag[ac]=af?decodeURIComponent(ab):ab}return ag[iJ]={},ag[ju[12]].replace(de,function(ak,aj,ah){aj&&(ag[iJ][aj]=ah)}),ag}function fl(ab,t,aa){return new hc(function(ad,ac){ab.get(t,function(ag,aj){if(ag){if(404!==ag.status){return ac(ag)}aj={}}var af=aj._rev,ah=aa(aj);return ah?(ah._id=t,ah._rev=af,void ad(T(ab,ah,aa))):ad({updated:!1,rev:af})})})}function T(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return fl(ab,t._id,aa)})}function fb(t){return 0|Math.random()*t}function w(ac,aa){aa=aa||gg.length;var ab="",t=-1;if(ac){for(;++t<ac;){ab+=gg[fb(aa)]}return ab}for(;++t<36;){switch(t){case 8:case 13:case 18:case 23:ab+="-";break;case 19:ab+=gg[3&fb(16)|8];break;default:ab+=gg[fb(16)]}}return ab}function hU(t){for(var ad,aa,ac,ab,am=t.rev_tree.slice();ab=am.pop();){var ag=ab.ids,al=ag[2],af=ab.pos;if(al.length){for(var ah=0,ak=al.length;ak>ah;ah++){am.push({pos:af+1,ids:al[ah]})}}else{var ap=!!ag[1].deleted,aj=ag[0];ad&&!(ac!==ap?ac:aa!==af?af>aa:aj>ad)||(ad=aj,aa=af,ac=ap)}}return aa+"-"+ad}function ao(ak,ah){for(var ac,af=ak.slice();ac=af.pop();){for(var ad=ac.pos,aa=ac.ids,aj=aa[2],ag=ah(0===aj.length,ad,aa[0],ac.ctx,aa[1]),t=0,ab=aj.length;ab>t;t++){af.push({pos:ad+1,ids:aj[t],ctx:ag})}}}function j(t,aa){return t.pos-aa.pos}function iW(ac){var aa=[];ao(ac,function(ah,af,aj,ag,ad){ah&&aa.push({rev:af+"-"+aj,pos:af,opts:ad})}),aa.sort(j).reverse();for(var ab=0,t=aa.length;t>ab;ab++){delete aa[ab].pos}return aa}function iT(ad){for(var aa=hU(ad),ag=iW(ad.rev_tree),t=[],ac=0,ab=ag.length;ab>ac;ac++){var af=ag[ac];af.rev===aa||af.opts.deleted||t.push(af.rev)}return t}function gk(t){var aa=[];return ao(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function M(t){for(var ad,aa=[],ac=t.slice();ad=ac.pop();){var ab=ad.pos,am=ad.ids,ag=am[0],al=am[1],af=am[2],ah=0===af.length,ak=ad.history?ad.history.slice():[];ak.push({id:ag,opts:al}),ah&&aa.push({pos:ab+1-ak.length,ids:ak});for(var ap=0,aj=af.length;aj>ap;ap++){ac.push({pos:ab+1,ids:af[ap],history:ak})}}return aa.reverse()}function fd(t,aa){return t.pos-aa.pos}function hx(t,ab,ac){for(var aa,ad=0,af=t.length;af>ad;){aa=ad+af>>>1,ac(t[aa],ab)<0?ad=aa+1:af=aa}return ad}function iE(ac,aa,ab){var t=hx(ac,aa,ab);ac.splice(t,0,aa)}function y(aa,ah){for(var ad,ag,af=ah,t=aa.length;t>af;af++){var ab=aa[af],ac=[ab.id,ab.opts,[]];ag?(ag[2].push(ac),ag=ac):ad=ag=ac}return ad}function a7(t,aa){return t[0]<aa[0]?-1:1}function ig(ak,ah){for(var ac=[{tree1:ak,tree2:ah}],af=!1;ac.length>0;){var ad=ac.pop(),aa=ad.tree1,aj=ad.tree2;(aa[1].status||aj[1].status)&&(aa[1].status="available"===aa[1].status||"available"===aj[1].status?"available":"missing");for(var ag=0;ag<aj[2].length;ag++){if(aa[2][0]){for(var t=!1,ab=0;ab<aa[2].length;ab++){aa[2][ab][0]===aj[2][ag][0]&&(ac.push({tree1:aa[2][ab],tree2:aj[2][ag]}),t=!0)}t||(af="new_branch",iE(aa[2],aj[2][ag],a7))}else{af="new_leaf",aa[2][0]=aj[2][ag]}}}return{conflicts:af,tree:ak}}function A(aa,af,ap){var t,av=[],aj=!1,ah=!1;if(!aa.length){return{tree:[af],conflicts:"new_leaf"}}for(var ac=0,aw=aa.length;aw>ac;ac++){var aq=aa[ac];if(aq.pos===af.pos&&aq.ids[0]===af.ids[0]){t=ig(aq.ids,af.ids),av.push({pos:aq.pos,ids:t.tree}),aj=aj||t.conflicts,ah=!0}else{if(ap!==!0){var ab=aq.pos<af.pos?aq:af,al=aq.pos<af.pos?af:aq,ak=al.pos-ab.pos,ag=[],ax=[];for(ax.push({ids:ab.ids,diff:ak,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],au=0,am=az.length;am>au;au++){ax.push({ids:az[au],diff:ay.diff-1,parent:ay.ids,parentIdx:au})}}else{ay.ids[0]===al.ids[0]&&ag.push(ay)}}var ad=ag[0];ad?(t=ig(ad.ids,al.ids),ad.parent[2][ad.parentIdx]=t.tree,av.push({pos:ab.pos,ids:ab.ids}),aj=aj||t.conflicts,ah=!0):av.push(aq)}else{av.push(aq)}}}return ah||av.push(af),av.sort(fd),{tree:av,conflicts:aj||"internal_node"}}function D(t,ad){for(var aa,ac=M(t),ab={},am=0,ag=ac.length;ag>am;am++){for(var al=ac[am],af=al.ids,ah=Math.max(0,af.length-ad),ak={pos:al.pos+ah,ids:y(af,ah)},ap=0;ah>ap;ap++){var aj=al.pos+ap+"-"+af[ap].id;ab[aj]=!0}aa=aa?A(aa,ak,!0).tree:[ak]}return ao(aa,function(au,av,aq){delete ab[av+"-"+aq]}),{tree:aa,revs:Object.keys(ab)}}function Z(t,ab,ac){var aa=A(t,ab),ad=D(aa.tree,ac);return{tree:ad.tree,stemmedRevs:ad.revs,conflicts:aa.conflicts}}function gX(ak,ah){for(var ac,af=ak.slice(),ad=ah.split("-"),aa=parseInt(ad[0],10),aj=ad[1];ac=af.pop();){if(ac.pos===aa&&ac.ids[0]===aj){return !0}for(var ag=ac.ids[2],t=0,ab=ag.length;ab>t;t++){af.push({pos:ac.pos+1,ids:ag[t]})}}return !1}function i4(t){return t.ids}function g0(t,ab){ab||(ab=hU(t));for(var ac,aa=ab.substring(ab.indexOf("-")+1),ad=t.rev_tree.map(i4);ac=ad.pop();){if(ac[0]===aa){return !!ac[1].deleted}ad=ad.concat(ac[2])}}function fU(t){return/^_local/.test(t)}function o(t){return gL("return "+t+";",{})}function jk(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function ii(ab,t){try{ab.emit("change",t)}catch(aa){a8("error",'Error in .on("change", function):',aa)}}function et(ad,aa,ag){function t(){ac.cancel()}C.EventEmitter.call(this);var ac=this;this.db=ad,aa=aa?hn(aa):{};var ab=aa.complete=fg(function(ah,aj){ah?gy(ac,"error")>0&&ac.emit("error",ah):ac.emit("complete",aj),ac.removeAllListeners(),ad.removeListener("destroyed",t)});ag&&(ac.on("complete",function(ah){ag(null,ah)}),ac.on("error",ag)),ad.once("destroyed",t),aa.onChange=function(ah){aa.isCancelled||(ii(ac,ah),ac.startSeq&&ac.startSeq<=ah.seq&&(ac.startSeq=!1))};var af=new hc(function(ah,aj){aa.complete=function(al,ak){al?aj(al):ah(ak)}});ac.once("cancel",function(){ad.removeListener("destroyed",t),aa.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ab(null,ah)},ab),ad.taskqueue.isReady?ac.doChanges(aa):ad.taskqueue.addTask(function(){ac.isCancelled?ac.emit("cancel"):ac.doChanges(aa)})}function jf(t,ab,ac){var aa=[{rev:t._rev}];"all_docs"===ac.style&&(aa=iW(ab.rev_tree).map(function(af){return{rev:af.rev}}));var ad={id:ab.id,changes:aa,doc:t};return g0(ab,t._rev)&&(ad.deleted=!0),ac.conflicts&&(ad.doc._conflicts=iT(ab),ad.doc._conflicts.length||delete ad.doc._conflicts),ad}function hH(t,aa){return aa>t?-1:t>aa?1:0}function ip(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function co(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function hL(t){for(var ab=0;ab<t.length;ab++){var ac=t[ab];if(ac._deleted){delete ac._attachments}else{if(ac._attachments){for(var aa=Object.keys(ac._attachments),ad=0;ad<aa.length;ad++){var af=aa[ad];ac._attachments[af]=fc(ac._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function jl(t,ab){var ac=hH(t._id,ab._id);if(0!==ac){return ac}var aa=t._revisions?t._revisions.start:0,ad=ab._revisions?ab._revisions.start:0;return hH(aa,ad)}function iZ(ab){var t={},aa=[];return ao(ab,function(ag,ah,af,ac){var ad=ah+"-"+af;return ag&&(t[ad]=0),void 0!==ac&&aa.push({from:ac,to:ad}),ad}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function go(t,ab,ac){var aa="limit" in ab?ab.keys.slice(ab.skip,ab.limit+ab.skip):ab.skip>0?ab.keys.slice(ab.skip):ab.keys;if(ab.descending&&aa.reverse(),!aa.length){return t._allDocs({limit:0},ac)}var ad={offset:ab.skip};return hc.all(aa.map(function(af){var ag=jw.extend({key:af,deleted:"ok"},ab);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hc(function(ah,aj){t._allDocs(ag,function(ak,al){return ak?aj(ak):(ad.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ad.rows=af,ad})}function hF(ac){var aa=ac._compactionQueue[0],t=aa.opts,ab=aa.callback;ac.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(t.last_seq=ad.last_seq),ac._compact(t,function(ag,af){ag?ab(ag):ab(null,af),fi.nextTick(function(){ac._compactionQueue.shift(),ac._compactionQueue.length&&hF(ac)})})})}function iu(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function J(){C.EventEmitter.call(this)}function hq(){this.isReady=!1,this.failed=!1,this.queue=[]}function fu(t){t&&fy.debug&&a8("error",t)}function iC(ad,aa){function ag(){ab.emit("destroyed",ac)}function t(){ad.removeListener("destroyed",ag),ad.emit("destroyed",ad)}var ac=aa.originalName,ab=ad.constructor,af=ab._destructionListeners;ad.once("destroyed",ag),af.has(ac)||af.set(ac,[]),af.get(ac).push(t)}function jB(ad,aa,ag){if(!(this instanceof jB)){return new jB(ad,aa,ag)}var t=this;if("function"!=typeof aa&&"undefined"!=typeof aa||(ag=aa,aa={}),ad&&"object"==typeof ad&&(aa=ad,ad=void 0),"undefined"==typeof ag){ag=fu}else{var ac=ag;ag=function(){return a8("warn","Using a callback for new PouchDB()is deprecated."),ac.apply(null,arguments)}}ad=ad||aa.name,aa=hn(aa),delete aa.name,this.__opts=aa;var ab=ag;t.auto_compaction=aa.auto_compaction,t.prefix=jB.prefix,J.call(t),t.taskqueue=new hq;var af=new hc(function(ak,ah){ag=function(ap,am){return ap?ah(ap):(delete am.then,void ak(am))},aa=hn(aa);var aj,al;return function(){try{if("string"!=typeof ad){throw al=new Error("Missing/invalid DB name"),al.code=400,al}var ap=(aa.prefix||"")+ad;if(aj=jB.parseAdapter(ap,aa),aa.originalName=ad,aa.name=aj.name,aa.adapter=aa.adapter||aj.adapter,t._adapter=aa.adapter,id("pouchdb:adapter")("Picked adapter: "+aa.adapter),t._db_name=ad,!jB.adapters[aa.adapter]){throw al=new Error("Adapter is missing"),al.code=404,al}if(!jB.adapters[aa.adapter].valid()){throw al=new Error("Invalid Adapter"),al.code=404,al}}catch(am){t.taskqueue.fail(am)}}(),al?ah(al):(t.adapter=aa.adapter,t.replicate={},t.replicate.from=function(aq,am,ap){return t.constructor.replicate(aq,t,am,ap)},t.replicate.to=function(aq,am,ap){return t.constructor.replicate(t,aq,am,ap)},t.sync=function(aq,am,ap){return t.constructor.sync(t,aq,am,ap)},t.replicate.sync=t.sync,void jB.adapters[aa.adapter].call(t,aa,function(am){return am?(t.taskqueue.fail(am),void ag(am)):(iC(t,aa),t.emit("created",t),jB.emit("created",aa.originalName),t.taskqueue.ready(t),void ag(null,t))}))});af.then(function(ah){ab(null,ah)},ab),t.then=af.then.bind(af),t["catch"]=af["catch"].bind(af)}function gK(t){Object.keys(C.EventEmitter.prototype).forEach(function(ab){"function"==typeof C.EventEmitter.prototype[ab]&&(t[ab]=hw[ab].bind(hw))});var aa=t._destructionListeners=new gt.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function im(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function jd(ac){if(!/^\d+\-./.test(ac)){return p(h3)}var aa=ac.indexOf("-"),ab=ac.substring(0,aa),t=ac.substring(aa+1);return{prefix:parseInt(ab,10),id:t}}function hi(ad,aa){for(var ag=ad.start-ad.ids.length+1,t=ad.ids,ac=[t[0],aa,[]],ab=1,af=t.length;af>ab;ab++){ac=[t[ab],{status:"missing"},[ac]]}return[{pos:ag,ids:ac}]}function gl(ak,ah){var ac,af,ad,aa={status:"available"};if(ak._deleted&&(aa.deleted=!0),ah){if(ak._id||(ak._id=w()),af=w(32,16).toLowerCase(),ak._rev){if(ad=jd(ak._rev),ad.error){return ad}ak._rev_tree=[{pos:ad.prefix,ids:[ad.id,{status:"missing"},[[af,aa,[]]]]}],ac=ad.prefix+1}else{ak._rev_tree=[{pos:1,ids:[af,aa,[]]}],ac=1}}else{if(ak._revisions&&(ak._rev_tree=hi(ak._revisions,aa),ac=ak._revisions.start,af=ak._revisions.ids[0]),!ak._rev_tree){if(ad=jd(ak._rev),ad.error){return ad}ac=ad.prefix,af=ad.id,ak._rev_tree=[{pos:ac,ids:[af,aa,[]]}]}}Y(ak._id),ak._rev=ac+"-"+af;var aj={metadata:{},data:{}};for(var ag in ak){if(Object.prototype.hasOwnProperty.call(ak,ag)){var t="_"===ag[0];if(t&&!gT[ag]){var ab=p(at,ag);throw ab.message=at.message+": "+ag,ab}t&&!hy[ag]?aj.metadata[ag.slice(1)]=ak[ag]:aj.data[ag]=ak[ag]}}return aj}function g5(t){for(var ab="",ac=new Uint8Array(t),aa=ac.byteLength,ad=0;aa>ad;ad++){ab+=String.fromCharCode(ac[ad])}return ab}function gj(t){return jm(g5(t))}function l(t,ab){t=t||[],ab=ab||{};try{return new Blob(t,ab)}catch(ac){if("TypeError"!==ac.name){throw ac}for(var aa="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ad=new aa,af=0;af<t.length;af+=1){ad.append(t[af])}return ad.getBlob(ab.type)}}function I(t){for(var ab=t.length,ac=new ArrayBuffer(ab),aa=new Uint8Array(ac),ad=0;ab>ad;ad++){aa[ad]=t.charCodeAt(ad)}return ac}function g9(t,aa){return l([I(t)],{type:aa})}function jt(t,aa){return g9(js(t),aa)}function bo(ac,aa){if("undefined"==typeof FileReader){return aa(g5((new FileReaderSync).readAsArrayBuffer(ac)))}var ab=new FileReader,t="function"==typeof ab.readAsBinaryString;ab.onloadend=function(af){var ad=af.target.result||"";return t?aa(ad):void aa(g5(ad))},t?ab.readAsBinaryString(ac):ab.readAsArrayBuffer(ac)}function gF(t,aa){bo(t,function(ab){aa(jm(ab))})}function h0(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function jA(t){return jm(t)}function jc(ac,aa,ab,t){(ab>0||t<aa.byteLength)&&(aa=new Uint8Array(aa,ab,Math.min(t,aa.byteLength)-ab)),ac.append(aa)}function ee(ac,aa,ab,t){(ab>0||t<aa.length)&&(aa=aa.substring(ab,t)),ac.appendBinary(aa)}function H(ak,ah){function ac(){var aq=ag*aa,al=aq+aa;if(ag++,aj>ag){ab(t,ak,aq,al),fX(ac)}else{ab(t,ak,aq,al);var ap=t.end(!0),am=jA(ap);ah(am),t.destroy()}}var af="string"==typeof ak,ad=af?ak.length:ak.byteLength,aa=Math.min(hM,ad),aj=Math.ceil(ad/aa),ag=0,t=af?new hO:new hO.ArrayBuffer,ab=af?ee:jc;ac()}function es(t){return hO.hash(t)}function ar(aa,ah,ad){function ag(al){try{return js(al)}catch(aj){var ak=p(ew,"Attachment is not a valid base64 string");return{error:ak}}}function af(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ag(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ah?aj.data=g9(al,aj.content_type):"base64"===ah?aj.data=jm(al):aj.data=al,H(al,function(am){aj.digest="md5-"+am,ak()})}else{h0(aj.data,function(am){"binary"===ah?aj.data=g5(am):"base64"===ah&&(aj.data=gj(am)),H(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function t(){ac++,aa.length===ac&&(ab?ad(ab):ad())}if(!aa.length){return ad()}var ab,ac=0;aa.forEach(function(ak){function am(aq){ab=aq,al++,al===aj.length&&t()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return t()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&af(ak.data._attachments[ap],am)}})}function hT(t,ad,ax,al,ay,ak,af,ab){if(gX(ad.rev_tree,ax.metadata.rev)){return al[ay]=ax,ak()}var az=ad.winningRev||hU(ad),au="deleted" in ad?ad.deleted:g0(ad,az),aa="deleted" in ax.metadata?ax.metadata.deleted:g0(ax.metadata),aq=/^1-/.test(ax.metadata.rev);if(au&&!aa&&ab&&aq){var aj=ax.data;aj._rev=az,aj._id=ax.metadata.id,ax=gl(aj,ab)}var ag=Z(ad.rev_tree,ax.metadata.rev_tree[0],t),aA=ab&&(au&&aa||!au&&"new_leaf"!==ag.conflicts||au&&!aa&&"new_branch"===ag.conflicts);if(aA){var ap=p(h7);return al[ay]=ap,ak()}var am=ax.metadata.rev;ax.metadata.rev_tree=ag.tree,ax.stemmedRevs=ag.stemmedRevs||[],ad.rev_map&&(ax.metadata.rev_map=ad.rev_map);var av,aw=hU(ax.metadata),ac=g0(ax.metadata,aw),ah=au===ac?0:ac>au?-1:1;av=am===aw?ac:g0(ax.metadata,am),af(ax,aw,ac,av,!0,ah,ay,ak)}function P(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jD(ab,ak,am,t,ap,af,al,ag,aj){function aq(aw,aA,aC){var az=hU(aw.metadata),ax=g0(aw.metadata,az);if("was_delete" in ag&&ax){return af[aA]=p(i3,"deleted"),aC()}var ay=ah&&P(aw);if(ay){var aB=p(h7);return af[aA]=aB,aC()}var av=ax?0:1;al(aw,az,ax,ax,!1,av,aA,aC)}function ac(){++ad===au&&aj&&aj()}ab=ab||1000;var ah=ag.new_edits,aa=new gt.Map,ad=0,au=ak.length;ak.forEach(function(ay,aw){if(ay._id&&fU(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void am[av](ay,{ctx:ap},function(aA,az){af[aw]=aA||az,ac()})}var ax=ay.metadata.id;aa.has(ax)?(au--,aa.get(ax).push([ay,aw])):aa.set(ax,[[ay,aw]])}),aa.forEach(function(aw,ay){function az(){++ax<aw.length?av():ac()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(t.has(ay)){hT(ab,t.get(ay),aA,af,aB,az,al,ah)}else{var aD=Z([],aA.metadata.rev_tree[0],ab);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],aq(aA,aB,az)}}var ax=0;av()})}function a0(t){try{return JSON.parse(t)}catch(aa){return fm.parse(t)}}function ft(t){return t.length<50000?JSON.parse(t):a0(t)}function ci(t){try{return JSON.stringify(t)}catch(aa){return fm.stringify(t)}}function g4(t,ab,ac,aa){try{t.apply(ab,ac)}catch(ad){aa.emit("error",ad)}}function iO(t){if(!gh.running&&gh.queue.length){gh.running=!0;var aa=gh.queue.shift();aa.action(function(ac,ab){g4(aa.callback,this,[ac,ab],t),gh.running=!1,fi.nextTick(function(){iO(t)})})}}function ix(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(p(jC,aa,ab.type))}}function er(ab,t,aa){return{data:ci(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function a2(t){if(!t){return null}var aa=ft(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function di(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function hX(ac,aa,ab,t){ab?t(ac?"string"!=typeof ac?ac:jt(ac,aa):l([""],{type:aa})):ac?"string"!=typeof ac?bo(ac,function(ad){t(jm(ad))}):t(ac):t("")}function hB(aa,ah,ad,ag){function af(){++ac===ab.length&&ag&&ag()}function t(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ad.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,af()}}var ab=Object.keys(aa._attachments||{});if(!ab.length){return ag&&ag()}var ac=0;ab.forEach(function(aj){ah.attachments&&ah.include_docs?t(aa,aj):(aa._attachments[aj].stub=!0,af())})}function gM(t,aa){return hc.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hc.all(ab.map(function(af){var ah=ac.doc._attachments[af];if("body" in ah){var ag=ah.body,ad=ah.content_type;return new hc(function(aj){hX(ag,ad,aa,function(ak){ac.doc._attachments[af]=jw.extend(fc(ah,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function iI(ak,ah,ac){function af(){ab--,ab||ad()}function ad(){aa.length&&aa.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ag["delete"](am)}})}var aa=[],aj=ac.objectStore(x),ag=ac.objectStore(gr),t=ac.objectStore(hf),ab=ak.length;ak.forEach(function(al){var am=aj.index("_doc_id_rev"),ap=ah+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return af()}aj["delete"](aq);var au=t.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];aa.push(ay),t["delete"](ax.primaryKey),ax["continue"]()}else{af()}}}})}function an(ac,aa,ab){try{return{txn:ac.transaction(aa,ab)}}catch(t){return{error:t}}}function hQ(aD,aF,t,ax,aa,aC,am){function az(){var aN=[g8,x,gr,h9,hf],aO=an(aa,aN,"readwrite");return aO.error?am(aO.error):(au=aO.txn,au.onabort=ix(am),au.ontimeout=ix(am),au.oncomplete=av,aj=au.objectStore(g8),aI=au.objectStore(x),aw=au.objectStore(gr),aB=au.objectStore(hf),void aM(function(aP){return aP?(ab=!0,am(aP)):void aL()}))}function ay(){jD(aD.revs_limit,aA,ax,ac,au,ak,ap,t)}function aL(){function aQ(){++aO===aA.length&&ay()}function aS(aU){var aV=a2(aU.target.result);aV&&ac.set(aV.id,aV),aQ()}if(aA.length){for(var aO=0,aR=0,aP=aA.length;aP>aR;aR++){var aT=aA[aR];if(aT._id&&fU(aT._id)){aQ()}else{var aN=aj.get(aT.metadata.id);aN.onsuccess=aS}}}}function av(){ab||(aC.notify(ax._meta.name),ax._meta.docCount+=al,am(null,ak))}function aE(aO,aP){var aN=aw.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=p(gv,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aA.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aE(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function ap(aQ,aW,aS,aU,aT,aR,aO,aV){al+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aJ(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(aZ){var bb=aP.stemmedRevs||[];aV&&ax.auto_compaction&&(bb=bb.concat(gk(aP.metadata))),bb&&bb.length&&iI(bb,aP.metadata.id,au),aT.seq=aZ.target.result,delete aT.rev;var bc=er(aT,aW,aU),ba=aj.put(bc);ba.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=aI.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=aI.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ak[aS]={ok:!0,id:aT.id,rev:aW},ac.set(aP.metadata.id,aP.metadata),aH(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=aI.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aJ(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;aG(ba,bb,aV)}})}function aH(aR,aU,aP){function aS(){++aN===aO.length&&aP()}function aQ(aX){var aV=aR.data._attachments[aX].digest,aW=aB.put({seq:aU,digestSeq:aV+"::"+aU});aW.onsuccess=aS,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aS()}}var aN=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function aG(aO,aQ,aN){var aP=aw.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=aw.put(aS);aT.onsuccess=aN}}for(var au,aj,aI,aw,aB,ah,aA=aF.docs,al=0,ag=0,af=aA.length;af>ag;ag++){var aq=aA[ag];aq._id&&fU(aq._id)||(aq=aA[ag]=gl(aq,t.new_edits),aq.error&&!ah&&(ah=aq))}if(ah){return am(ah)}var ak=new Array(aA.length),ac=new gt.Map,ab=!1,aK=ax._meta.blobSupport?"blob":"base64";ar(aA,aK,function(aN){return aN?am(aN):void az()})}function G(t,ab,ac,aa,ad){try{if(t&&ab){return ad?IDBKeyRange.bound(ab,t,!ac,!1):IDBKeyRange.bound(t,ab,!1,!ac)}if(t){return ad?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t)}if(ab){return ad?IDBKeyRange.lowerBound(ab,!ac):IDBKeyRange.upperBound(ab,!ac)}if(aa){return IDBKeyRange.only(aa)}}catch(af){return{error:af}}return null}function i1(ac,aa,ab,t){return"DataError"===ab.name&&0===ab.code?t(null,{total_rows:ac._meta.docCount,offset:aa.skip,rows:[]}):void t(p(jC,ab.name,ab.message))}function fk(t,ab,ac,aa){function ad(aE,aq){function aA(aM,aN,aL){var aK=aM.id+"::"+aL;aF.get(aK).onsuccess=function(aO){aN.doc=di(aO.target.result),aE.conflicts&&(aN.doc._conflicts=iT(aM)),hB(aN.doc,aE,ah)}}function av(aO,aM,aN){var aK={id:aN.id,key:aN.id,value:{rev:aM}},aL=aN.deleted;if("ok"===aE.deleted){aD.push(aK),aL?(aK.value.deleted=!0,aK.doc=null):aE.include_docs&&aA(aN,aK,aM)}else{if(!aL&&am--<=0&&(aD.push(aK),aE.include_docs&&aA(aN,aK,aM),0===--aw)){return}}aO["continue"]()}function al(aL){ag=ab._meta.docCount;var aN=aL.target.result;if(aN){var aM=a2(aN.value),aK=aM.winningRev;av(aN,aK,aM)}}function aC(){aq(null,{total_rows:ag,offset:aE.skip,rows:aD})}function aJ(){aE.attachments?gM(aD,aE.binary).then(aC):aC()}var ay="startkey" in aE?aE.startkey:!1,aI="endkey" in aE?aE.endkey:!1,az="key" in aE?aE.key:!1,am=aE.skip||0,aw="number"==typeof aE.limit?aE.limit:-1,ax=aE.inclusive_end!==!1,ak="descending" in aE&&aE.descending?"prev":null,aG=G(ay,aI,ax,az,ak);if(aG&&aG.error){return i1(ab,aE,aG.error,aq)}var aj=[g8,x];aE.attachments&&aj.push(gr);var aH=an(ac,aj,"readonly");if(aH.error){return aq(aH.error)}var ah=aH.txn,au=ah.objectStore(g8),ap=ah.objectStore(x),aB=ak?au.openCursor(aG,ak):au.openCursor(aG),aF=ap.index("_doc_id_rev"),aD=[],ag=0;ah.oncomplete=aJ,aB.onsuccess=al}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ab._meta.docCount,offset:ag.skip,rows:[]}):void ad(ag,ah)}af(t,aa)}function a9(t){return new hc(function(ab){var aa=l([""]);t.objectStore(jh).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function fW(ab,t){var aa=this;gh.queue.push({action:function(ac){jx(aa,ab,ac)},callback:t}),iO(aa.constructor)}function jx(ak,aj,ad){function ab(au){var av=au.createObjectStore(g8,{keyPath:"id"});au.createObjectStore(x,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gr,{keyPath:"digest"}),au.createObjectStore(fa,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jh),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(h9,{keyPath:"_id"});var aw=au.createObjectStore(hf,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function aa(au,av){var aw=au.objectStore(g8);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=g0(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function af(au){au.createObjectStore(h9,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function al(aw,az){var av=aw.objectStore(h9),ay=aw.objectStore(g8),au=aw.objectStore(x),ax=ay.openCursor();ax.onsuccess=function(aG){var aJ=aG.target.result;if(aJ){var aD=aJ.value,aA=aD.id,aB=fU(aA),aE=hU(aD);if(aB){var aH=aA+"::"+aE,aK=aA+"::",aF=aA+"::~",aI=au.index("_doc_id_rev"),aL=IDBKeyRange.bound(aK,aF,!1,!1),aC=aI.openCursor(aL);aC.onsuccess=function(aN){if(aC=aN.target.result){var aM=aC.value;aM._doc_id_rev===aH&&av.put(aM),au["delete"](aC.primaryKey),aC["continue"]()}else{ay["delete"](aJ.primaryKey),aJ["continue"]()}}}else{aJ["continue"]()}}else{az&&az()}}}function aq(au){var av=au.createObjectStore(hf,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ap(aw,az){var av=aw.objectStore(x),ay=aw.objectStore(gr),au=aw.objectStore(hf),ax=ay.count();ax.onsuccess=function(aB){var aA=aB.target.result;return aA?void (av.openCursor().onsuccess=function(aC){var aG=aC.target.result;if(!aG){return az()}for(var aH=aG.value,aE=aG.primaryKey,aK=Object.keys(aH._attachments||{}),aI={},aJ=0;aJ<aK.length;aJ++){var aL=aH._attachments[aK[aJ]];aI[aL.digest]=!0}var aD=Object.keys(aI);for(aJ=0;aJ<aD.length;aJ++){var aF=aD[aJ];au.put({seq:aE,digestSeq:aF+"::"+aE})}aG["continue"]()}):az()}}function ah(au){function ay(az){return az.data?a2(az):(az.deleted="1"===az.deletedOrLocal,az)}var av=au.objectStore(x),aw=au.objectStore(g8),ax=aw.openCursor();ax.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=av.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=er(aD,aD.winningRev,aD.deleted),aF=aw.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ay(aA.value);return aD.winningRev=aD.winningRev||hU(aD),aD.seq?az():void aB()}}}var t=aj.name,ac=null;ak._meta=null,ak.type=function(){return"idb"},ak._id=cn(function(au){au(null,ak._meta.instanceId)}),ak._bulkDocs=function(aw,av,au){hQ(aj,aw,av,ak,ac,hk,au)},ak._get=function(au,az,aA){function aw(){aA(aC,{doc:av,metadata:ax,ctx:ay})}var av,ax,aC,ay=az.ctx;if(!ay){var aB=an(ac,[g8,x,gr],"readonly");if(aB.error){return aA(aB.error)}ay=aB.txn}ay.objectStore(g8).get(au).onsuccess=function(aG){if(ax=a2(aG.target.result),!ax){return aC=p(i3,"missing"),aw()}if(g0(ax)&&!az.rev){return aC=p(i3,"deleted"),aw()}var aE=ay.objectStore(x),aD=az.rev||ax.winningRev,aF=ax.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return av=aH.target.result,av&&(av=di(av)),av?void aw():(aC=p(i3,"missing"),aw())}}},ak._getAttachment=function(au,az,aA,aw,av){var ax;if(aw.ctx){ax=aw.ctx}else{var aC=an(ac,[g8,x,gr],"readonly");if(aC.error){return av(aC.error)}ax=aC.txn}var ay=aA.digest,aB=aA.content_type;ax.objectStore(gr).get(ay).onsuccess=function(aE){var aD=aE.target.result.body;hX(aD,aB,aw.binary,function(aF){av(null,aF)})}},ak._info=function(av){if(null===ac||!iK.has(t)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,ay,au=an(ac,[x],"readonly");if(au.error){return av(au.error)}var aw=au.txn,ax=aw.objectStore(x).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,ay=ak._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:az,idb_attachment_format:ak._meta.blobSupport?"binary":"base64"})}},ak._allDocs=function(av,au){fk(av,ak,ac,au)},ak._changes=function(ax){function az(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aF=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=ay.get(aU);aT.onsuccess=function(aV){aO(di(aV.target.result))}}function aO(aU){var aT=ax.processChange(aU,aN,ax);aT.seq=aN.seq;var aV=aL(aT);return"object"==typeof aV?ax.complete(aV):(aV&&(av++,aG&&aI.push(aT),ax.attachments&&ax.include_docs?hB(aU,ax,aD,function(){gM([aT],ax.binary).then(function(){ax.onChange(aT)})}):ax.onChange(aT)),void (av!==aB&&aS["continue"]()))}var aQ=di(aS.value),aR=aS.key;if(aJ&&!aJ.has(aQ._id)){return aS["continue"]()}var aN;return(aN=aw.get(aQ._id))?aM():void (aE.get(aQ._id).onsuccess=function(aT){aN=a2(aT.target.result),aw.set(aQ._id,aN),aM()})}function aA(aN){var aM=aN.target.result;aM&&az(aM)}function au(){var aM=[g8,x];ax.attachments&&aM.push(gr);var aN=an(ac,aM,"readonly");if(aN.error){return ax.complete(aN.error)}aD=aN.txn,aD.onabort=ix(ax.complete),aD.oncomplete=aC,aK=aD.objectStore(x),aE=aD.objectStore(g8),ay=aK.index("_doc_id_rev");var aO;aO=ax.descending?aK.openCursor(null,"prev"):aK.openCursor(IDBKeyRange.lowerBound(ax.since,!0)),aO.onsuccess=aA}function aC(){function aM(){ax.complete(null,{results:aI,last_seq:aF})}!ax.continuous&&ax.attachments?gM(aI).then(aM):aM()}if(ax=hn(ax),ax.continuous){var aH=t+":"+w();return hk.addListener(t,aH,ak,ax),hk.notify(t),{cancel:function(){hk.removeListener(t,aH)}}}var aJ=ax.doc_ids&&new gt.Set(ax.doc_ids);ax.since=ax.since||0;var aF=ax.since,aB="limit" in ax?ax.limit:-1;0===aB&&(aB=1);var aG;aG="return_docs" in ax?ax.return_docs:"returnDocs" in ax?ax.returnDocs:!0;var aD,aK,aE,ay,aI=[],av=0,aL=fn(ax),aw=new gt.Map;au()},ak._close=function(au){return null===ac?au(p(g3)):(ac.close(),iK["delete"](t),ac=null,void au())},ak._getRevisionTree=function(au,ay){var av=an(ac,[g8],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(g8).get(au);ax.onsuccess=function(aA){var az=a2(aA.target.result);az?ay(null,az.rev_tree):ay(p(i3))}},ak._doCompaction=function(aA,ax,ay){var av=[g8,x,gr,hf],az=an(ac,av,"readwrite");if(az.error){return ay(az.error)}var au=az.txn,aw=au.objectStore(g8);aw.get(aA).onsuccess=function(aC){var aE=a2(aC.target.result);ao(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==ax.indexOf(aI)&&(aH.status="missing")}),iI(ax,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(g8).put(er(aE,aD,aB))},au.onabort=ix(ay),au.oncomplete=function(){ay()}},ak._getLocal=function(au,ay){var av=an(ac,[h9],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(h9).get(au);ax.onerror=ix(ay),ax.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ay(null,az)):ay(p(i3))}},ak._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=an(ac,[h9],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=ix(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(h9);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(p(h7))}}):(az=aC.add(aD),az.onerror=function(aE){aA(p(h7)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ak._removeLocal=function(au,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.ctx;if(!aw){var av=an(ac,[h9],"readwrite");if(av.error){return aA(av.error)}aw=av.txn,aw.oncomplete=function(){ax&&aA(null,ax)}}var ax,aC=au._id,ay=aw.objectStore(h9),aB=ay.get(aC);aB.onerror=ix(aA),aB.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===au._rev?(ay["delete"](aC),ax={ok:!0,id:aC,rev:"0-0"},az.ctx&&aA(null,ax)):aA(p(i3))}},ak._destroy=function(av,ax){hk.removeAllListeners(t);var au=gq.get(t);au&&au.result&&(au.result.close(),iK["delete"](t));var aw=indexedDB.deleteDatabase(t);aw.onsuccess=function(){gq["delete"](t),fZ()&&t in localStorage&&delete localStorage[t],ax(null,{ok:!0})},aw.onerror=ix(ax)};var am=iK.get(t);if(am){return ac=am.idb,ak._meta=am.global,void fi.nextTick(function(){ad(null,ak)})}var ag;ag=aj.storage?i0(t,aj.storage):indexedDB.open(t,g2),gq.set(t,ag),ag.onupgradeneeded=function(az){function aw(){var aA=au[ax-1];ax++,aA&&aA(av,aw)}var ay=az.target.result;if(az.oldVersion<1){return ab(ay)}var av=az.currentTarget.transaction;az.oldVersion<3&&af(ay),az.oldVersion<4&&aq(ay);var au=[aa,al,ap,ah],ax=az.oldVersion;aw()},ag.onsuccess=function(ay){ac=ay.target.result,ac.onversionchange=function(){ac.close(),iK["delete"](t)},ac.onabort=function(aA){a8("error","Database has a global failure",aA.target.error),ac.close(),iK["delete"](t)};var av=ac.transaction([fa,jh,g8],"readwrite"),au=av.objectStore(fa).get(fa),az=null,ax=null,aw=null;au.onsuccess=function(aB){var aD=function(){null!==az&&null!==ax&&null!==aw&&(ak._meta={name:t,instanceId:aw,blobSupport:az,docCount:ax},iK.set(t,{idb:ac,global:ak._meta}),ad(null,ak))},aA=aB.target.result||{id:fa};t+"_id" in aA?(aw=aA[t+"_id"],aD()):(aw=w(),aA[t+"_id"]=aw,av.objectStore(fa).put(aA).onsuccess=function(){aD()}),fs||(fs=a9(av)),fs.then(function(aE){az=aE,aD()});var aC=av.objectStore(g8).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},ag.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";a8("error",au),ad(p(jC,au))}}function i0(ab,t){try{return indexedDB.open(ab,{version:g2,storage:t})}catch(aa){return indexedDB.open(ab,g2)}}function F(t){t.adapter("idb",fW,!0)}function iR(t){return decodeURIComponent(escape(t))}function h2(t){return 65>t?t-48:t-55}function hW(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(h2(ac.charCodeAt(aa++))<<4|h2(ac.charCodeAt(aa++)))}return t}function gH(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(h2(ac.charCodeAt(aa+2))<<12|h2(ac.charCodeAt(aa+3))<<8|h2(ac.charCodeAt(aa))<<4|h2(ac.charCodeAt(aa+1))),aa+=4}return t}function L(t,aa){return"UTF-8"===aa?iR(hW(t,0,t.length)):gH(t,0,t.length)}function gZ(t){return"'"+t+"'"}function fx(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function ji(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jq(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hp(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function g(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function hs(t,ab,ac,aa,ad){return"SELECT "+t+" FROM "+("string"==typeof ab?ab:ab.join(" JOIN "))+(ac?" ON "+ac:"")+(aa?" WHERE "+("string"==typeof aa?aa:aa.join(" AND ")):"")+(ad?" ORDER BY "+ad:"")}function O(ad,aa,ag){function t(){++ab===ad.length&&ac()}function ac(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+hP+" WHERE seq IN "+g(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+hP+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+hP+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new gt.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+hP+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+iM+" WHERE digest=?",[az]))})})})}})}}if(ad.length){var ab=0,af=[];ad.forEach(function(ah){var aj="SELECT seq FROM "+i9+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[aa,ah],function(al,am){if(!am.rows.length){return t()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+i9+" WHERE seq=?",[ak],t)})})}}function jp(t){return function(ad){a8("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(p(fr,ab,ac))}}function ic(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function hh(aj,am,ax,aB,az,ad,ac){function au(){return t?ac(t):(ad.notify(aB._name),aB._docCount=-1,void ac(null,af))}function ab(aD,aE){var aC="SELECT count(*) as cnt FROM "+iM+" WHERE digest=?";aw.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=p(gv,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function al(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ab(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ak(aM,aE,aJ,aO,aQ,aH,aC,aF){function aK(){function aR(ba,bc){function aZ(){return ++bb===bd.length&&bc(),!1}function bg(bj){var bi="INSERT INTO "+hP+" (digest, seq) VALUES (?,?)",bh=[aS._attachments[bj].digest,ba];aw.executeSql(bi,bh,aZ,aZ)}var bb=0,bd=Object.keys(aS._attachments||{});if(!bd.length){return bc()}for(var bf=0;bf<bd.length;bf++){bg(bd[bf])}}var aS=aM.data,aX=aO?1:0,aU=aS._id,aY=aS._rev,aW=jq(aS),aV="INSERT INTO "+i9+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aT=[aU,aY,aW,aX];aw.executeSql(aV,aT,function(ba,bb){var aZ=bb.insertId;aR(aZ,function(){aL(ba,aZ)})},function(){var aZ=hs("seq",i9,null,"doc_id=? AND rev=?");return aw.executeSql(aZ,[aU,aY],function(bd,bc){var bb=bc.rows.item(0).seq,bf="UPDATE "+i9+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aW,aX,aU,aY];bd.executeSql(bf,ba,function(bg){aR(bb,function(){aL(bg,bb)})})}),!1})}function aN(aR){aP||(aR?(aP=aR,aF(aP)):aG===aI.length&&aK())}function aD(aR){aG++,aN(aR)}function aL(aX,aR){var aV=aM.metadata.id,aW=aM.stemmedRevs||[];aQ&&aB.auto_compaction&&(aW=gk(aM.metadata).concat(aW)),aW.length&&O(aW,aV,aX),aM.metadata.seq=aR,delete aM.metadata.rev;var aU=aQ?"UPDATE "+it+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+i9+" WHERE doc_id="+it+".id AND rev=?) WHERE id=?":"INSERT INTO "+it+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=ci(aM.metadata),aS=aQ?[aT,aR,aE,aV]:[aV,aR,aR,aT];aX.executeSql(aU,aS,function(){af[aC]={ok:!0,id:aM.metadata.id,rev:aE},ah.set(aV,aM.metadata),aF()})}var aP=null,aG=0;aM.data._id=aM.metadata.id,aM.data._rev=aM.metadata.rev;var aI=Object.keys(aM.data._attachments||{});aO&&(aM.data._deleted=!0),aI.forEach(function(aS){var aU=aM.data._attachments[aS];if(aU.stub){aG++,aN()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aE,10);var aR=aU.digest;aa(aR,aT,aD)}}),aI.length||aK()}function ag(){jD(aj.revs_limit,aq,aB,ah,aw,af,ak,ax)}function av(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&fU(aG._id)){return aE()}var aF=aG.metadata.id;aw.executeSql("SELECT json FROM "+it+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=ft(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function aa(aD,aF,aC){var aE="SELECT digest FROM "+iM+" WHERE digest=?";aw.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iM+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,fx(aF)],function(){aC()},function(){return aC(),!1}))})}var aA=ax.new_edits,ap=am.docs,aq=ap.map(function(aC){if(aC._id&&fU(aC._id)){return aC}var aD=gl(aC,aA);return aD}),ay=aq.filter(function(aC){return aC.error});if(ay.length){return ac(ay[0])}var aw,t,af=new Array(aq.length),ah=new gt.Map;ar(aq,"binary",function(aC){return aC?ac(aC):void az.transaction(function(aD){aw=aD,al(function(aE){aE?t=aE:av(ag)})},jp(ac),au)})}function ff(t){return t.websql(t.name,t.version,t.description,t.size)}function f(t){try{return{db:ff(t)}}catch(aa){return{error:aa}}}function gn(t){var aa=V.get(t.name);return aa||(aa=f(t),V.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function gQ(t,aj,ac,af,ad){function ab(){++ah===ag.length&&ad&&ad()}function aa(am,ak){var al=am._attachments[ak],ap={binary:aj.binary,ctx:af};ac._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=jw.extend(fc(al,["digest","content_type"]),{data:aq}),ab()})}var ag=Object.keys(t._attachments||{});if(!ag.length){return ad&&ad()}var ah=0;ag.forEach(function(ak){aj.attachments&&aj.include_docs?aa(t,ak):(t._attachments[ak].stub=!0,ab())})}function X(ak,au){function aa(){fZ()&&(window.localStorage["_pouch__websqldb_"+ah._name]=!0),au(null,ah)}function aC(aD,aE){aD.executeSql(s),aD.executeSql("ALTER TABLE "+i9+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(hA),aD.executeSql("ALTER TABLE "+it+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+it+" (local, id)");var aF="SELECT "+it+".winningseq AS seq, "+it+".json AS metadata FROM "+i9+" JOIN "+it+" ON "+i9+".seq = "+it+".winningseq";aD.executeSql(aF,[],function(aL,aH){for(var aM=[],aJ=[],aI=0;aI<aH.rows.length;aI++){var aG=aH.rows.item(aI),aN=aG.seq,aK=JSON.parse(aG.metadata);g0(aK)&&aM.push(aN),fU(aK.id)&&aJ.push(aK.id)}aL.executeSql("UPDATE "+it+"SET local = 1 WHERE id IN "+g(aJ.length),aJ,function(){aL.executeSql("UPDATE "+i9+" SET deleted = 1 WHERE seq IN "+g(aM.length),aM,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hV+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+it+".id AS id, "+i9+".json AS data FROM "+i9+" JOIN "+it+" ON "+i9+".seq = "+it+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aK,aI){function aL(){if(!aJ.length){return aF(aK)}var aM=aJ.shift(),aN=JSON.parse(aM.data)._rev;aK.executeSql("INSERT INTO "+hV+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+it+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+i9+" WHERE seq=?",[aM.seq],function(){aL()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aL()})})}function al(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aN=aH.shift(),aJ=L(aN.hex,aA),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+i9+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aI()})}aI()}var aF="ALTER TABLE "+i9+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+i9+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(iG,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+i9;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ab(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+iM;aI.executeSql(aH,[],function(aO,aM){function aJ(){var aP=hs(hE+", "+it+".id AS id",[it,i9],hu,null,it+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aU){function aZ(bc,bd){var bf=aS[bc]=aS[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aU.rows.length){return aG(ba)}for(var aS={},aX=0;aX<aU.rows.length;aX++){for(var aV=aU.rows.item(aX),aW=hp(aV.data,aV.id,aV.rev),aQ=Object.keys(aW._attachments||{}),bb=0;bb<aQ.length;bb++){var aT=aW._attachments[aQ[bb]];aZ(aT.digest,aV.seq)}}var aY=[];if(Object.keys(aS).forEach(function(bc){var bd=aS[bc];bd.forEach(function(bf){aY.push([bc,bf])})}),!aY.length){return aJ()}var aR=0;aY.forEach(function(bd){var bc="INSERT INTO "+hP+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===aY.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+hP+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(ia,[],function(aI){aI.executeSql(i2,[],aD)})})}function am(aE,aF){var aD="ALTER TABLE "+iM+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+it+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+it+" SET max_seq=(SELECT MAX(seq) FROM "+i9+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+it+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ax(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;aA=2===aG.length?"UTF-8":"UTF-16",aE()})}function ag(){for(;av.length>0;){var aD=av.pop();aD(null,ac)}}function aj(aM,aE){if(0===aE){var aH="CREATE TABLE IF NOT EXISTS "+hb+" (dbid, db_version INTEGER)",aK="CREATE TABLE IF NOT EXISTS "+iM+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aN="CREATE TABLE IF NOT EXISTS "+hP+" (digest, seq INTEGER)",aD="CREATE TABLE IF NOT EXISTS "+it+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aO="CREATE TABLE IF NOT EXISTS "+i9+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aI="CREATE TABLE IF NOT EXISTS "+hV+" (id UNIQUE, rev, json)";aM.executeSql(aK),aM.executeSql(aI),aM.executeSql(aN,[],function(){aM.executeSql(i2),aM.executeSql(ia)}),aM.executeSql(aD,[],function(){aM.executeSql(s),aM.executeSql(aO,[],function(){aM.executeSql(hA),aM.executeSql(iG),aM.executeSql(aH,[],function(){var aP="INSERT INTO "+hb+" (db_version, dbid) VALUES (?,?)";ac=w();var aQ=[K,ac];aM.executeSql(aP,aQ,function(){ag()})})})})}else{var aG=function(){var aQ=K>aE;aQ&&aM.executeSql("UPDATE "+hb+" SET db_version = "+K);var aP="SELECT dbid FROM "+hb;aM.executeSql(aP,[],function(aR,aS){ac=aS.rows.item(0).dbid,ag()})},aJ=[aC,aq,al,ab,am,ap,aG],aL=aE,aF=function(aP){aJ[aL-1](aP,aF),aL++};aF(aM)}}function az(){aB.transaction(function(aD){ax(aD,function(){ad(aD)})},jp(au),aa)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+hb;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+hb,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;aj(aJ,aI)}):aF.executeSql("ALTER TABLE "+hb+" ADD COLUMN db_version INTEGER",[],function(){aj(aF,1)}):aj(aF,0)})}function aw(aE,aF){if(-1!==ah._docCount){return aF(ah._docCount)}var aD=hs("COUNT("+it+".id) AS 'num'",[it,i9],hu,i9+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ah._docCount=aH.rows.item(0).num,aF(ah._docCount)})}var aA,ah=this,ac=null,af=ic(ak),av=[];ah._docCount=-1,ah._name=ak.name;var ay=jw.extend({},ak,{version:jz,description:ak.name,size:af}),t=gn(ay);if(t.error){return jp(au)(t.error)}var aB=t.db;"function"!=typeof aB.readTransaction&&(aB.readTransaction=aB.transaction),az(),ah.type=function(){return"websql"},ah._id=cn(function(aD){aD(null,ac)}),ah._info=function(aD){aB.readTransaction(function(aE){aw(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+i9;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:aB._sqlitePlugin,websql_encoding:aA})})})},jp(aD))},ah._bulkDocs=function(aF,aD,aE){hh(ak,aF,aD,ah,aB,ie,aE)},ah._get=function(aJ,aI,aL){function aE(){aL(aG,{doc:aD,metadata:aK,ctx:aM})}var aD,aK,aG,aM=aI.ctx;if(!aM){return aB.readTransaction(function(aN){ah._get(aJ,jw.extend({ctx:aN},aI),aL)})}var aF,aH;aI.rev?(aF=hs(hE,[it,i9],it+".id="+i9+".doc_id",[i9+".doc_id=?",i9+".rev=?"]),aH=[aJ,aI.rev]):(aF=hs(hE,[it,i9],hu,it+".id=?"),aH=[aJ]),aM.executeSql(aF,aH,function(aP,aO){if(!aO.rows.length){return aG=p(i3,"missing"),aE()}var aN=aO.rows.item(0);return aK=ft(aN.metadata),aN.deleted&&!aI.rev?(aG=p(i3,"deleted"),aE()):(aD=hp(aN.data,aK.id,aN.rev),void aE())})},ah._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(it+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(it+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(it+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(it+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(i9+".deleted = 0"),aB.readTransaction(function(aR){aw(aR,function(aS){if(aF=aS,0!==aH){var aT=hs(hE,[it,i9],hu,aL,it+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aU,bb){for(var bc=0,aY=bb.rows.length;aY>bc;bc++){var aV=bb.rows.item(bc),bd=ft(aV.metadata),aZ=bd.id,aW=hp(aV.data,aZ,aV.rev),aX=aW._rev,ba={id:aZ,key:aZ,value:{rev:aX}};if(aQ.include_docs&&(ba.doc=aW,ba.doc._rev=aX,aQ.conflicts&&(ba.doc._conflicts=iT(bd)),gQ(ba.doc,aQ,ah,aU)),aV.deleted){if("ok"!==aQ.deleted){continue}ba.value.deleted=!0,ba.doc=null}aM.push(ba)}})}})},jp(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ah._changes=function(aE){function aD(){var aN=it+".json AS metadata, "+it+".max_seq AS maxSeq, "+i9+".json AS winningDoc, "+i9+".rev AS winningRev ",aM=it+" JOIN "+i9,aO=it+".id="+i9+".doc_id AND "+it+".winningseq="+i9+".seq",aP=["maxSeq > ?"],aR=[aE.since];aE.doc_ids&&(aP.push(it+".id IN "+g(aE.doc_ids.length)),aR=aR.concat(aE.doc_ids));var aL="maxSeq "+(aH?"DESC":"ASC"),aS=hs(aN,aM,aO,aP,aL),aT=fn(aE);aE.view||aE.filter||(aS+=" LIMIT "+aK);var aQ=aE.since||0;aB.readTransaction(function(aU){aU.executeSql(aS,aR,function(aW,aV){function aX(bg){return function(){aE.onChange(bg)}}for(var aZ=0,bb=aV.rows.length;bb>aZ;aZ++){var bc=aV.rows.item(aZ),bd=ft(bc.metadata);aQ=bc.maxSeq;var bf=hp(bc.winningDoc,bd.id,bc.winningRev),aY=aE.processChange(bf,bd,aE);aY.seq=bc.maxSeq;var ba=aT(aY);if("object"==typeof ba){return aE.complete(ba)}if(ba&&(aI++,aF&&aG.push(aY),aE.attachments&&aE.include_docs?gQ(bf,aE,ah,aW,aX(aY)):aX(aY)()),aI===aK){break}}})},jp(aE.complete),function(){aE.continuous||aE.complete(null,{results:aG,last_seq:aQ})})}if(aE=hn(aE),aE.continuous){var aJ=ah._name+":"+w();return ie.addListener(ah._name,aJ,ah,aE),ie.notify(ah._name),{cancel:function(){ie.removeListener(ah._name,aJ)}}}var aH=aE.descending;aE.since=aE.since&&!aH?aE.since:0;var aK="limit" in aE?aE.limit:-1;0===aK&&(aK=1);var aF;aF="return_docs" in aE?aE.return_docs:"returnDocs" in aE?aE.returnDocs:!0;var aG=[],aI=0;aD()},ah._close=function(aD){aD()},ah._getAttachment=function(aJ,aI,aL,aE,aD){var aK,aG=aE.ctx,aM=aL.digest,aF=aL.content_type,aH="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iM+" WHERE digest=?";aG.executeSql(aH,[aM],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?ji(aO.body):L(aO.body,aA);aK=aE.binary?g9(aN,aF):jm(aN),aD(null,aK)})},ah._getRevisionTree=function(aD,aE){aB.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+it+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=ft(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(p(i3))}})})},ah._doCompaction=function(aE,aF,aD){return aF.length?void aB.transaction(function(aH){var aG="SELECT json AS metadata FROM "+it+" WHERE id = ?";aH.executeSql(aG,[aE],function(aK,aI){var aL=ft(aI.rows.item(0).metadata);ao(aL.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aJ="UPDATE "+it+" SET json = ? WHERE id = ?";aK.executeSql(aJ,[ci(aL),aE])}),O(aF,aE,aH)},jp(aD),function(){aD()}):aD()},ah._getLocal=function(aD,aE){aB.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hV+" WHERE id=?";aF.executeSql(aG,[aD],function(aJ,aH){if(aH.rows.length){var aK=aH.rows.item(0),aI=hp(aK.json,aD,aK.rev);aE(null,aI)}else{aE(p(i3))}})})},ah._putLocal=function(aH,aD,aJ){function aL(aO){var aM,aN;aI?(aM="UPDATE "+hV+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aK,aE,aF,aI]):(aM="INSERT INTO "+hV+" (id, rev, json) VALUES (?,?,?)",aN=[aF,aK,aE]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aG={ok:!0,id:aF,rev:aK},aD.ctx&&aJ(null,aG)):aJ(p(h7))},function(){return aJ(p(h7)),!1})}"function"==typeof aD&&(aJ=aD,aD={}),delete aH._revisions;var aK,aI=aH._rev,aF=aH._id;aK=aI?aH._rev="0-"+(parseInt(aI.split("-")[1],10)+1):aH._rev="0-1";var aG,aE=jq(aH);aD.ctx?aL(aD.ctx):aB.transaction(aL,jp(aJ),function(){aG&&aJ(null,aG)})},ah._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+hV+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(p(i3))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):aB.transaction(aF,jp(aH),function(){aD&&aH(null,aD)})},ah._destroy=function(aD,aE){ie.removeAllListeners(ah._name),aB.transaction(function(aF){var aG=[it,i9,iM,hb,hV,hP];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},jp(aE),function(){fZ()&&(delete window.localStorage["_pouch__websqldb_"+ah._name],delete window.localStorage[ah._name]),aE(null,{ok:!0})})}}function gO(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function g6(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=fZ(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=gO();return ab&&(localStorage[t]=aa?"1":"0"),aa}function k(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:g6()}function fp(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=jw.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function N(ac,aa){var ab=fp(ac),t=jw.extend({websql:ab},ac);X.call(this,t,aa)}function a3(t){t.adapter("websql",N,!0)}function ei(){for(var ac={},aa=new hc(function(af,ad){ac.resolve=af,ac.reject=ad}),ab=new Array(arguments.length),t=0;t<ab.length;t++){ab[t]=arguments[t]}return ac.promise=aa,hc.resolve().then(function(){return fetch.apply(null,ab)}).then(function(ad){ac.resolve(ad)})["catch"](function(ad){ac.reject(ad)}),ac}function hR(ad,aa){var ag,t,ac,ab=new Headers,af={method:ad.method,credentials:"include",headers:ab};return ad.json&&(ab.set("Accept","application/json"),ab.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?h0(ad.body,function(ah){af.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?af.body=JSON.stringify(ad.body):"body" in ad?af.body=ad.body:af.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&ab.set(ah,ad.headers[ah])}),ag=ei(ad.url,af),ad.timeout>0&&(t=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ag.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?aa(null,ac,ah):aa(ah,ac)})["catch"](function(ah){aa(ah,ac)}),{abort:ag.reject}}function gz(t,aj){var ac,af,ad=!1,ab=function(){ac.abort()},aa=function(){ad=!0,ac.abort()};ac=t.xhr?new t.xhr:new XMLHttpRequest;try{ac.open(t.method,t.url)}catch(ag){aj(ag,{statusCode:413})}ac.withCredentials="withCredentials" in t?t.withCredentials:!0,"GET"===t.method?delete t.headers["Content-Type"]:t.json&&(t.headers.Accept="application/json",t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.body&&t.processData&&"string"!=typeof t.body&&(t.body=JSON.stringify(t.body))),t.binary&&(ac.responseType="arraybuffer"),"body" in t||(t.body=null);for(var ah in t.headers){t.headers.hasOwnProperty(ah)&&ac.setRequestHeader(ah,t.headers[ah])}return t.timeout>0&&(af=setTimeout(aa,t.timeout),ac.onprogress=function(){clearTimeout(af),4!==ac.readyState&&(af=setTimeout(aa,t.timeout))},"undefined"!=typeof ac.upload&&(ac.upload.onprogress=ac.onprogress)),ac.onreadystatechange=function(){if(4===ac.readyState){var ak={statusCode:ac.status};if(ac.status>=200&&ac.status<300){var am;am=t.binary?l([ac.response||""],{type:ac.getResponseHeader("Content-Type")}):ac.responseText,aj(null,ak,am)}else{var ap={};if(ad){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ac.response)}catch(al){}}aj(ap,ak)}}},t.body&&t.body instanceof Blob?h0(t.body,function(ak){ac.send(ak)}):ac.send(t.body),{abort:ab}}function hN(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function ga(t,aa){return jr||t.xhr?gz(t,aa):hR(t,aa)}function io(){return""}function hI(t,ab){function ac(aj,af,ah){if(!t.binary&&t.json&&"string"==typeof aj){try{aj=JSON.parse(aj)}catch(ag){return ah(ag)}}Array.isArray(aj)&&(aj=aj.map(function(ak){return ak.error||ak.missing?n(ak):ak})),t.binary&&gS(aj,af),ah(null,aj,af)}function aa(ah,ak){var af,aj;if(ah.code&&ah.status){var ag=new Error(ah.message||ah.code);return ag.status=ah.status,ak(ag)}if(ah.message&&"ETIMEDOUT"===ah.message){return ak(ah)}try{af=JSON.parse(ah.responseText),aj=n(af)}catch(al){aj=n(ah)}ak(aj)}t=hn(t);var ad={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return t=jw.extend(ad,t),t.json&&(t.binary||(t.headers.Accept="application/json"),t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json"),t.binary&&(t.encoding=null,t.json=!1),t.processData||(t.json=!1),ga(t,function(ag,ak,am){if(ag){return ag.status=ak?ak.statusCode:400,aa(ag,ab)}var aj,al=ak.headers&&ak.headers["content-type"],af=am||io();if(!t.binary&&(t.json||!t.processData)&&"object"!=typeof af&&(/json/.test(al)||/^[\s]*\{/.test(af)&&/\}[\s]*$/.test(af))){try{af=JSON.parse(af.toString())}catch(ah){}}ak.statusCode>=200&&ak.statusCode<300?ac(af,ak,ab):(aj=n(af),aj.status=ak.statusCode,ab(aj))})}function gs(ak,ah){var ac=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",af=-1!==ac.indexOf("safari")&&-1===ac.indexOf("chrome"),ad=-1!==ac.indexOf("msie"),aa=-1!==ac.indexOf("edge"),aj=af||(ad||aa)&&"GET"===ak.method,ag="cache" in ak?ak.cache:!0,t=/^blob:/.test(ak.url);if(!t&&(aj||!ag)){var ab=-1!==ak.url.indexOf("?");ak.url+=(ab?"&":"?")+"_nonce="+Date.now()}return hI(ak,ah)}function iy(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=jt(ab.data,ab.content_type)})}function gm(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function ja(t){return t._attachments&&Object.keys(t._attachments)?hc.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hc(function(ac){gF(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hc.resolve()}function fo(ab){var t=z(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function eu(t,aa){return h4(t,t.db+"/"+aa)}function h4(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function iz(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function ev(aj,ac){function ah(ax,aA,az){var ay=ax.ajax||{},aw=jw.extend(hn(am),ay,aA);return iY(aw.method+" "+aw.url),ab._ajax(aw,az)}function ap(aw,ax){return new hc(function(az,ay){ah(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(aw,ax){return a4(aw,bt(function(ay){av().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function av(){if(aj.skipSetup||aj.skip_setup){return hc.resolve()}if(au){return au}var aw={method:"GET",url:t};return au=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(eo(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:t})):hc.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hc.reject(ax)}),au["catch"](function(){au=null}),au}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,ad=fo;aj.getHost&&(ad=aj.getHost);var al=ad(aj.name,aj),t=eu(al,"");aj=hn(aj);var am=aj.ajax||{};if(ab.getUrl=function(){return t},ab.getHeaders=function(){return am.headers||{}},aj.auth||al.auth){var af=aj.auth||al.auth,ak=af.username+":"+af.password,aa=jm(unescape(encodeURIComponent(ak)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=gs;var au;setTimeout(function(){ac(null,ab)}),ab.type=function(){return"http"},ab.id=aq("id",function(aw){ah({},{method:"GET",url:h4(al,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+al.db:eu(al,"");aw(null,ay)})}),ab.request=aq("request",function(aw,ax){aw.url=eu(al,aw.url),ah({},aw,ax)}),ab.compact=aq("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=hn(aw),ah(aw,{url:eu(al,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ab.bulkGet=a4("bulkGet",function(aC,ax){function aA(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:eu(al,"_bulk_get"+iz(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aF(aK){return function(aM,aL){aJ[aK]=aL.results,++aE===aH&&ax(null,{results:iD(aJ)})}}for(var aI=dt,aH=Math.ceil(aC.docs.length/aI),aE=0,aJ=new Array(aH),aD=0;aH>aD;aD++){var aG=fc(aC,["revs","attachments"]);aG.ajax=am,aG.docs=aC.docs.slice(aD*aI,Math.min(aC.docs.length,(aD+1)*aI)),R(aw,aG,aF(aD))}}var aw=this,az=h4(al,""),ay=dr[az];"boolean"!=typeof ay?aA(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(dr[az]=!1,eo(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):ax(aF)}else{dr[az]=!0,ax(null,aE)}}):ay?aA(ax):aB()}),ab._info=function(aw){av().then(function(){ah({},{method:"GET",url:eu(al,"")},function(ay,ax){return ay?aw(ay):(ax.host=eu(al,""),void aw(null,ax))})})["catch"](aw)},ab.get=aq("get",function(aA,ax,aC){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hc.all(aF.map(function(aI){var aH=aD[aI],aG=gm(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(ax,{method:"GET",url:eu(al,aG),binary:!0}).then(function(aJ){return ax.binary?aJ:new hc(function(aK){gF(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?hc.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof ax&&(aC=ax,ax={}),ax=hn(ax);var ay={};ax.revs&&(ay.revs=!0),ax.revs_info&&(ay.revs_info=!0),ax.open_revs&&("all"!==ax.open_revs&&(ax.open_revs=JSON.stringify(ax.open_revs)),ay.open_revs=ax.open_revs),ax.rev&&(ay.rev=ax.rev),ax.conflicts&&(ay.conflicts=ax.conflicts),aA=gm(aA);var az={method:"GET",url:eu(al,aA+iz(ay))};ap(ax,az).then(function(aD){return hc.resolve().then(function(){return ax.attachments?aw(aD):void 0}).then(function(){aC(null,aD)})})["catch"](aC)}),ab.remove=aq("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:eu(al,gm(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=aq("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=eu(al,gm(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=aq("removeAttachment",function(ax,aA,ay,az){var aw=eu(al,gm(ax)+"/"+ag(aA))+"?rev="+ay;ah({},{method:"DELETE",url:aw},az)}),ab.putAttachment=aq("putAttachment",function(aE,aA,ay,ax,aG,az){"function"==typeof aG&&(az=aG,aG=ax,ax=ay,ay=null);var aB=gm(aE)+"/"+ag(aA),aC=eu(al,aB);if(ay&&(aC+="?rev="+ay),"string"==typeof ax){var aw;try{aw=js(ax)}catch(aD){return az(p(ew,"Attachment is not a valid base64 string"))}ax=aw?g9(aw,aG):""}var aF={headers:{"Content-Type":aG},method:"PUT",url:aC,processData:!1,body:ax,timeout:am.timeout||60000};ah({},aF,az)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,av().then(function(){return hc.all(ay.docs.map(ja))}).then(function(){ah(ax,{method:"POST",url:eu(al,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=aq("allDocs",function(aA,ax){"function"==typeof aA&&(ax=aA,aA={}),aA=hn(aA);var aC,aB={},aw="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var az=iz(aB);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=jj?az+="&"+ay:(aw="POST",aC={keys:aA.keys})}ap(aA,{method:aw,url:eu(al,"_all_docs"+az),body:aC}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(iy),ax(null,aD)})["catch"](ax)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:gU;aB=hn(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aI=aB.timeout?{timeout:aB.timeout-5000}:{},aD="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=aD;if(aB.style&&(aI.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aI.include_docs=!0),aB.attachments&&(aI.attachments=!0),aB.continuous&&(aI.feed="longpoll"),aB.conflicts&&(aI.conflicts=!0),aB.descending&&(aI.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aI.heartbeat=aB.heartbeat):aI.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aI.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aI.filter="_view",aI.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var ax in aB.query_params){aB.query_params.hasOwnProperty(ax)&&(aI[ax]=aB.query_params[ax])}}var aJ,aC="GET";if(aB.doc_ids){aI.filter="_doc_ids";var aK=JSON.stringify(aB.doc_ids);aK.length<jj?aI.doc_ids=aK:(aC="POST",aJ={doc_ids:aB.doc_ids})}var az,aA,aF=function(aM,aN){if(!aB.aborted){aI.since=aM,"object"==typeof aI.since&&(aI.since=JSON.stringify(aI.since)),aB.descending?aD&&(aI.limit=aH):aI.limit=!aD||aH>aw?aw:aH;var aL={method:aC,url:eu(al,"_changes"+iz(aI)),timeout:aB.timeout,body:aJ};aA=aM,aB.aborted||av().then(function(){az=ah(aB,aL,aN)})["catch"](aN)}},aE={results:[]},aG=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aE.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=fn(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&iy(aR),ay&&aE.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aA=aL.last_seq);var aO=aD&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||aD&&0>=aH)&&aO?aB.complete(null,aE):setTimeout(function(){aF(aA,aG)},0)}};return aF(aB.since||0,aG),{cancel:function(){aB.aborted=!0,az&&az.abort()}}},ab.revsDiff=aq("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:eu(al,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(aw,ax){ah(aw,{url:eu(al,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function h1(t){t.adapter("http",ev,!1),t.adapter("https",ev,!1)}function iH(){this.promise=new hc(function(t){t()})}function hG(aa){var ah=aa.db,ad=aa.viewName,ag=aa.map,af=aa.reduce,t=aa.temporary,ab=ag.toString()+(af&&af.toString())+"undefined";if(!t&&ah._cachedViews){var ac=ah._cachedViews[ab];if(ac){return hc.resolve(ac)}}return ah.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ad;-1===aq.indexOf("/")&&(aq=ad+"/"+ad);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(t?"temp":es(ab));return fl(ah,"_local/mrviews",al).then(function(){return ah.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ah,adapter:ah.adapter,mapFun:ag,reduceFun:af};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,t||(ah._cachedViews=ah._cachedViews||{},ah._cachedViews[ab]=aq,aq.db.once("destroyed",function(){delete ah._cachedViews[ab]})),aq})})})})}function gI(t,ab,ac,aa,ad,af){return gL("return ("+t.replace(/;\s*$/,"")+");",{emit:ab,sum:ac,log:aa,isArray:ad,toJSON:af})}function i6(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function q(t){return 1===t.length&&/^1-/.test(t[0].rev)}function be(ab,t){try{ab.emit("error",t)}catch(aa){a8("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),a8("error",t)}}function hZ(ac,aa,ab){try{return{output:aa.apply(null,ab)}}catch(t){return be(ac,t),{error:t}}}function jg(ab,t){var aa=gR.collate(ab.key,t.key);return 0!==aa?aa:gR.collate(ab.value,t.value)}function iV(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function iX(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function hv(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=jt(ac.data,ac.content_type)})})}function gw(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&hv(aa),aa}}function fq(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new i(aa)}function hY(aa){for(var ah=0,ad=0,ag=aa.length;ag>ad;ad++){var af=aa[ad];if("number"!=typeof af){if(!Array.isArray(af)){throw fq("_sum")}ah="number"==typeof ah?[ah]:ah;for(var t=0,ab=af.length;ab>t;t++){var ac=af[t];if("number"!=typeof ac){throw fq("_sum")}"undefined"==typeof ah[t]?ah.push(ac):ah[t]+=ac}}else{"number"==typeof ah?ah+=af:ah[0]+=af}}return ah}function iA(t,ab,ac,aa){var ad=ab[t];"undefined"!=typeof ad&&(aa&&(ad=encodeURIComponent(JSON.stringify(ad))),ac.push(t+"="+ad))}function iB(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function jy(t){return t.group_level=iB(t.group_level),t.limit=iB(t.limit),t.skip=iB(t.skip),t}function i5(t){if(t){if("number"!=typeof t){return new r('Invalid value for integer: "'+t+'"')}if(0>t){return new r('Invalid value for positive integer: "'+t+'"')}}}function ex(ac,aa){var ab=ac.descending?"endkey":"startkey",t=ac.descending?"startkey":"endkey";if("undefined"!=typeof ac[ab]&&"undefined"!=typeof ac[t]&&gR.collate(ac[ab],ac[t])>0){throw new r("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(aa.reduce&&ac.reduce!==!1){if(ac.include_docs){throw new r("{include_docs:true} is invalid for reduce")}if(ac.keys&&ac.keys.length>1&&!ac.group&&!ac.group_level){throw new r("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=i5(ac[af]);if(ad){throw ad}})}function i7(t,aj,ac){var af,ad=[],ab="GET";if(iA("reduce",ac,ad),iA("include_docs",ac,ad),iA("attachments",ac,ad),iA("limit",ac,ad),iA("descending",ac,ad),iA("group",ac,ad),iA("group_level",ac,ad),iA("skip",ac,ad),iA("stale",ac,ad),iA("conflicts",ac,ad),iA("startkey",ac,ad,!0),iA("start_key",ac,ad,!0),iA("endkey",ac,ad,!0),iA("end_key",ac,ad,!0),iA("inclusive_end",ac,ad),iA("key",ac,ad,!0),ad=ad.join("&"),ad=""===ad?"":"?"+ad,"undefined"!=typeof ac.keys){var aa=2000,ag="keys="+encodeURIComponent(JSON.stringify(ac.keys));ag.length+ad.length+1<=aa?ad+=("?"===ad[0]?"&":"?")+ag:(ab="POST","string"==typeof aj?af={keys:ac.keys}:aj.keys=ac.keys)}if("string"==typeof aj){var ah=i6(aj);return t.request({method:ab,url:"_design/"+ah[0]+"/_view/"+ah[1]+ad,body:af}).then(gw(ac))}return af=af||{},Object.keys(aj).forEach(function(ak){Array.isArray(aj[ak])?af[ak]=aj[ak]:af[ak]=aj[ak].toString()}),t.request({method:"POST",url:"_temp_view"+ad,body:af}).then(gw(ac))}function ij(ab,t,aa){return new hc(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function ge(t){return new hc(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function gA(t){return function(aa){if(404===aa.status){return t}throw aa}}function gJ(aa,ah,ac){function af(){return q(t)?hc.resolve(ag):ah.db.get(al)["catch"](gA(ag))}function ad(am){return am.keys.length?ah.db.allDocs({keys:am.keys,include_docs:!0}):hc.resolve({rows:[]})}function ab(ay,aw){for(var ap=[],av={},aq=0,am=aw.rows.length;am>aq;aq++){var az=aw.rows[aq],au=az.doc;if(au&&(ap.push(au),av[au._id]=!0,au._deleted=!ak[au._id],!au._deleted)){var ax=ak[au._id];"value" in ax&&(au.value=ax.value)}}var aA=Object.keys(ak);return aA.forEach(function(aD){if(!av[aD]){var aB={_id:aD},aC=ak[aD];"value" in aC&&(aB.value=aC.value),ap.push(aB)}}),ay.keys=hJ(aA.concat(ay.keys)),ap.push(ay),ap}var al="_local/doc_"+aa,ag={_id:al,keys:[]},aj=ac[aa],ak=aj.indexableKeysToKeyValues,t=aj.changes;return af().then(function(am){return ad(am).then(function(ap){return ab(am,ap)})})}function h5(ac,aa,ab){var t="_local/lastSeq";return ac.db.get(t)["catch"](gA({_id:t,seq:0})).then(function(af){var ad=Object.keys(aa);return hc.all(ad.map(function(ag){return gJ(ag,ac,aa)})).then(function(ag){var ah=iD(ag);return af.seq=ab,ah.push(af),ac.db.bulkDocs({docs:ah})})})}function gx(ab){var t="string"==typeof ab?ab:ab.name,aa=hD[t];return aa||(aa=hD[t]=new iH),aa}function hS(t){return ir(gx(t),function(){return gP(t)})()}function gP(t){function aj(am,ak){var al={id:ad._id,key:gR.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gR.normalizeKey(ak)),af.push(al)}function ac(ak,al){return function(){return h5(t,ak,al)}}var af,ad,ab;if("function"==typeof t.mapFun&&2===t.mapFun.length){var aa=t.mapFun;ab=function(ak){return aa(ak,aj)}}else{ab=gI(t.mapFun.toString(),aj,hY,iw,Array.isArray,JSON.parse)}var ag=t.seq||0,ah=new iH;return new hc(function(ap,ak){function al(){ah.finish().then(function(){t.seq=ag,ap()})}function am(){function aq(au){ak(au)}t.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ag,limit:gd}).on("complete",function(ax){var aD=ax.results;if(!aD.length){return al()}for(var au={},aF=0,av=aD.length;av>aF;aF++){var aB=aD[aF];if("_"!==aB.doc._id[0]){af=[],ad=aB.doc,ad._deleted||hZ(t.sourceDB,ab,[ad]),af.sort(jg);for(var ay,aC={},az=0,aw=af.length;aw>az;az++){var aG=af[az],aE=[aG.key,aG.id];0===gR.collate(aG.key,ay)&&aE.push(az);var aA=gR.toIndexableString(aE);aC[aA]=aG,ay=aG.key}au[aB.doc._id]={indexableKeysToKeyValues:aC,changes:aB.changes}}ag=aB.seq}return ah.add(ac(au,ag)),aD.length<gd?al():am()}).on("error",aq)}am()})}function iv(aa,ah,ac){0===ac.group_level&&delete ac.group_level;var af,ad=ac.group||ac.group_level;af=bn[aa.reduceFun]?bn[aa.reduceFun]:gI(aa.reduceFun.toString(),null,hY,iw,Array.isArray,JSON.parse);var ab=[],al=isNaN(ac.group_level)?Number.POSITIVE_INFINITY:ac.group_level;ah.forEach(function(aq){var am=ab[ab.length-1],ap=ad?aq.key:null;return ad&&Array.isArray(ap)&&(ap=ap.slice(0,al)),am&&0===gR.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ab.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ah=[];for(var ag=0,aj=ab.length;aj>ag;ag++){var ak=ab[ag],t=hZ(aa.sourceDB,af,[ak.keys,ak.values,!1]);if(t.error&&t.error instanceof i){throw t.error}ah.push({value:t.error?null:t.output,key:ak.groupKey})}return{rows:iV(ah,ac.limit,ac.skip)}}function U(t,aa){return ir(gx(t),function(){return je(t,aa)})()}function je(t,ad){function aa(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ab=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=gR.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ac(aq){var au;if(au=am?iv(t,aq,ad):{total_rows:ab,offset:ag,rows:aq},ad.include_docs){var av=hJ(aq.map(iX));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:ad.conflicts,attachments:ad.attachments,binary:ad.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=iX(ay),az=ax["$"+aA];az&&(ay.doc=az)}),au})}return au}var ab,am=t.reduceFun&&ad.reduce!==!1,ag=ad.skip||0;if("undefined"==typeof ad.keys||ad.keys.length||(ad.limit=0,delete ad.keys),"undefined"!=typeof ad.keys){var al=ad.keys,af=al.map(function(aq){var au={startkey:gR.toIndexableString([aq]),endkey:gR.toIndexableString([aq,{}])};return aa(au)});return hc.all(af).then(iD).then(ac)}var ah={descending:ad.descending};if(ad.start_key&&(ad.startkey=ad.start_key),ad.end_key&&(ad.endkey=ad.end_key),"undefined"!=typeof ad.startkey&&(ah.startkey=ad.descending?gR.toIndexableString([ad.startkey,{}]):gR.toIndexableString([ad.startkey])),"undefined"!=typeof ad.endkey){var ak=ad.inclusive_end!==!1;ad.descending&&(ak=!ak),ah.endkey=gR.toIndexableString(ak?[ad.endkey,{}]:[ad.endkey])}if("undefined"!=typeof ad.key){var ap=gR.toIndexableString([ad.key]),aj=gR.toIndexableString([ad.key,{}]);ah.descending?(ah.endkey=ap,ah.startkey=aj):(ah.startkey=ap,ah.endkey=aj)}return am||("number"==typeof ad.limit&&(ah.limit=ad.limit),ah.skip=ag),aa(ah).then(ac)}function jv(t){return t.request({method:"POST",url:"_view_cleanup"})}function hg(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ag){var ad=i6(ag),ah="_design/"+ad[0],af=ad[1];aa[ah]=aa[ah]||{},aa[ah][af]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ag){var af={};ag.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){af[au]=af[au]||am})})});var ah=Object.keys(af).filter(function(aj){return !af[aj]}),ad=ah.map(function(aj){return ir(gx(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hc.all(ad).then(function(){return{ok:!0}})})},gA({ok:!0}))}function ae(af,ac,aa){if("http"===af.type()){return i7(af,ac,aa)}if("function"==typeof af._query){return ij(af,ac,aa)}if("string"!=typeof ac){ex(aa,ac);var ad={db:af,viewName:"temp_view/temp_view",map:ac.map,reduce:ac.reduce,temporary:!0};return Q.add(function(){return hG(ad).then(function(ak){function aj(){return ak.db.destroy()}return hz(hS(ak).then(function(){return U(ak,aa)}),aj)})}),Q.finish()}var ah=ac,ab=i6(ah),ag=ab[0],t=ab[1];return af.get("_design/"+ag).then(function(al){var ak=al.views&&al.views[t];if(!ak||"string"!=typeof ak.map){throw new iP("ddoc "+ag+" has no view named "+t)}ex(aa,ak);var aj={db:af,viewName:ah,map:ak.map,reduce:ak.reduce};return hG(aj).then(function(am){return"ok"===aa.stale||"update_after"===aa.stale?("update_after"===aa.stale&&fi.nextTick(function(){hS(am)}),U(am,aa)):hS(am).then(function(){return U(am,aa)})})})}function r(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,r)}catch(aa){}}function iP(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,iP)}catch(aa){}}function i(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,i)}catch(aa){}}function iq(t){return/^1-/.test(t)}function ho(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function gV(ab,t){var aa=Object.keys(t._attachments);return hc.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function ht(t,ab,ac){var aa="http"===ab.type()&&"http"!==t.type(),ad=Object.keys(ac._attachments);return aa?t.get(ac._id).then(function(af){return hc.all(ad.map(function(ag){return ho(af,ac,ag)?ab.getAttachment(ac._id,ag):t.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return gV(ab,ac)}):gV(ab,ac)}function gp(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function gY(al,ag,ab,ad){function ac(){var am=gp(ab);if(am.docs.length){return al.bulkGet(am).then(function(ap){if(ad.cancelled){throw new Error("cancelled")}return hc.all(ap.results.map(function(aq){return hc.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?ht(ag,al,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ak=ak.concat(iD(aq).filter(Boolean))})})}}function aa(am){return am._attachments&&Object.keys(am._attachments).length>0}function aj(am){return al.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ad.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&iq(aq.value.rev)&&!aa(aq.doc)&&(ak.push(aq.doc),delete ab[aq.id])})})}function af(){var am=Object.keys(ab).filter(function(aq){var ap=ab[aq].missing;return 1===ap.length&&iq(ap[0])});return am.length>0?aj(am):void 0}function ah(){return{ok:t,docs:ak}}ab=hn(ab);var ak=[],t=!0;return hc.resolve().then(af).then(ac).then(ah)}function ey(t,ab,ac,aa,ad){return t.get(ab)["catch"](function(af){if(404===af.status){return"http"===t.type()&&eo(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:aa,_id:ab,history:[],replicator:h6,version:en}}throw af}).then(function(af){return ad.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==aa}),af.history.unshift({last_seq:ac,session_id:aa}),af.history=af.history.slice(0,jn),af.version=en,af.replicator=h6,af.session_id=aa,af.last_seq=ac,t.put(af)["catch"](function(ag){if(409===ag.status){return ey(t,ab,ac,aa,ad)}throw ag}))})}function hr(ac,aa,ab,t){this.src=ac,this.target=aa,this.id=ab,this.returnValue=t}function ha(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:gN(t.history,aa.history)}function gN(aa,ah){var ad=aa[0],ag=aa.slice(1),af=ah[0],t=ah.slice(1);if(!ad||0===ah.length){return{last_seq:v,history:[]}}var ab=ad.session_id;if(fY(ab,ah)){return{last_seq:ad.last_seq,history:aa}}var ac=af.session_id;return fY(ac,ag)?{last_seq:af.last_seq,history:t}:gN(ag,t)}function fY(ac,aa){var ab=aa[0],t=aa.slice(1);return ac&&0!==aa.length?ac===ab.session_id?!0:fY(ac,t):!1}function gb(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function jE(ac,aa,ab,t){return ac.retry===!1?(aa.emit("error",ab),void aa.removeAllListeners()):("function"!=typeof ac.back_off_function&&(ac.back_off_function=B),aa.emit("requestError",ab),"active"!==aa.state&&"pending"!==aa.state||(aa.emit("paused",ab),aa.state="stopped",aa.once("active",function(){ac.current_back_off=a6})),ac.current_back_off=ac.current_back_off||a6,ac.current_back_off=ac.back_off_function(ac.current_back_off),void setTimeout(t,ac.current_back_off))}function iL(t){return Object.keys(t).sort(gR.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function br(ad,aa,ag){var t=ag.doc_ids?ag.doc_ids.sort(gR.collate):"",ac=ag.filter?ag.filter.toString():"",ab="",af="";return ag.filter&&ag.query_params&&(ab=JSON.stringify(iL(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hc.all([ad.id(),aa.id()]).then(function(aj){var ah=aj[0]+aj[1]+ac+af+ab+t;return new hc(function(ak){H(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function iF(au,af,aK,aP,aL){function aE(){return ay?hc.resolve():br(au,af,aK).then(function(aS){ah=aS,ay=new hr(au,af,ah,aP)})}function aQ(){if(aa=[],0!==aw.docs.length){var aS=aw.docs;return af.bulkDocs({docs:aS,new_edits:!1}).then(function(aW){if(aP.cancelled){throw aM(),new Error("cancelled")}var aU=[],aX={};aW.forEach(function(aY){aY.error&&(aL.doc_write_failures++,aU.push(aY),aX[aY.id]=aY)}),av=av.concat(aU),aL.docs_written+=aw.docs.length-aU.length;var aT=aU.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aX[aZ._id];aY?aP.emit("denied",hn(aY)):aa.push(aZ)}),aT.length>0){var aV=new Error("bulkDocs error");throw aV.other_errors=aU,aD("target.bulkDocs failed to write docs",aV),new Error("bulkWrite partial failure")}},function(aT){throw aL.doc_write_failures+=aS.length,aT})}}function ad(){if(aw.error){throw new Error("There was a problem getting docs.")}aL.last_seq=aF=aw.seq;var aS=hn(aL);return aa.length&&(aS.docs=aa,aP.emit("change",aS)),aB=!0,ay.writeCheckpoint(aw.seq,aq).then(function(){if(aB=!1,aP.cancelled){throw aM(),new Error("cancelled")}aw=void 0,aI()})["catch"](ag)}function am(){var aS={};return aw.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),af.revsDiff(aS).then(function(aT){if(aP.cancelled){throw aM(),new Error("cancelled")}aw.diffs=aT})}function az(){return gY(au,af,aw.diffs,aP).then(function(aS){aw.error=!aS.ok,aS.docs.forEach(function(aT){delete aw.diffs[aT._id],aL.docs_read++,aw.docs.push(aT)})})}function aH(){if(!aP.cancelled&&!aw){if(0===aG.length){return void ak(!0)}aw=aG.shift(),am().then(az).then(aQ).then(ad).then(aH)["catch"](function(aS){aD("batch processing terminated with error",aS)})}}function ak(aS){return 0===aN.changes.length?void (0!==aG.length||aw||((ab&&aJ.live||aR)&&(aP.state="pending",aP.emit("paused")),aR&&aM())):void ((aS||aR||aN.changes.length>=al)&&(aG.push(aN),aN={seq:0,changes:[],docs:[]},"pending"!==aP.state&&"stopped"!==aP.state||(aP.state="active",aP.emit("active")),aH()))}function aD(aS,aT){aA||(aT.message||(aT.message=aS),aL.ok=!1,aL.status="aborting",aL.errors.push(aT),av=av.concat(aT),aG=[],aN={seq:0,changes:[],docs:[]},aM())}function aM(){if(!(aA||aP.cancelled&&(aL.status="cancelled",aB))){aL.status=aL.status||"complete",aL.end_time=new Date,aL.last_seq=aF,aA=!0;var aS=av.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=av.pop();av.length>0&&(aT.other_errors=av),aT.result=aL,jE(aK,aP,aT,function(){iF(au,af,aK,aP)})}else{aL.errors=av,aP.emit("complete",aL),aP.removeAllListeners()}}}function ap(aS){if(aP.cancelled){return aM()}var aT=fn(aK)(aS);aT&&(aN.seq=aS.seq,aN.changes.push(aS),ak(0===aG.length&&aJ.live))}function t(aS){if(ac=!1,aP.cancelled){return aM()}if(aS.results.length>0){aJ.since=aS.last_seq,aI(),ak(!0)}else{var aT=function(){ab?(aJ.live=!0,aI()):aR=!0,ak(!0)};aw||0!==aS.results.length?aT():(aB=!0,ay.writeCheckpoint(aS.last_seq,aq).then(function(){aB=!1,aL.last_seq=aF=aS.last_seq,aT()})["catch"](ag))}}function aO(aS){return ac=!1,aP.cancelled?aM():void aD("changes rejected",aS)}function aI(){function aU(){aS.cancel()}function aT(){aP.removeListener("cancel",aU)}if(!ac&&!aR&&aG.length<aj){ac=!0,aP._changes&&(aP.removeListener("cancel",aP._abortChanges),aP._changes.cancel()),aP.once("cancel",aU);var aS=au.changes(aJ).on("change",ap);aS.then(aT,aT),aS.then(t)["catch"](aO),aK.retry&&(aP._changes=aS,aP._abortChanges=aU)}}function aC(){aE().then(function(){return aP.cancelled?void aM():ay.getCheckpoint().then(function(aS){aF=aS,aJ={since:aF,limit:al,batch_size:al,style:"all_docs",doc_ids:ax,return_docs:!0},aK.filter&&("string"!=typeof aK.filter?aJ.include_docs=!0:aJ.filter=aK.filter),"heartbeat" in aK&&(aJ.heartbeat=aK.heartbeat),"timeout" in aK&&(aJ.timeout=aK.timeout),aK.query_params&&(aJ.query_params=aK.query_params),aK.view&&(aJ.view=aK.view),aI()})})["catch"](function(aS){aD("getCheckpoint rejected with ",aS)})}function ag(aS){throw aB=!1,aD("writeCheckpoint completed with error",aS),aS}var aw,ah,ay,aG=[],aN={seq:0,changes:[],docs:[]},aB=!1,aR=!1,aA=!1,aF=0,ab=aK.continuous||aK.live||!1,al=aK.batch_size||100,aj=aK.batches_limit||10,ac=!1,ax=aK.doc_ids,av=[],aa=[],aq=w();aL=aL||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aJ={};return aP.ready(au,af),aP.cancelled?void aM():(aP._addedListeners||(aP.once("cancel",aM),"function"==typeof aK.complete&&(aP.once("error",aK.complete),aP.once("complete",function(aS){aK.complete(null,aS)})),aP._addedListeners=!0),void ("undefined"==typeof aK.since?aC():aE().then(function(){return aB=!0,ay.writeCheckpoint(aK.since,aq)}).then(function(){return aB=!1,aP.cancelled?void aM():(aF=aK.since,void aC())})["catch"](ag)))}function fS(){C.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new hc(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function hK(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function gc(ad,aa,ag,t){if("function"==typeof ag&&(t=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw p(hd,"`doc_ids` filter parameter is not a list.")}ag.complete=t,ag=hn(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ac=new fS(ag),ab=hK(ad,ag),af=hK(aa,ag);return iF(ab,af,ag,ac),ac}function iQ(ac,aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"undefined"==typeof ab&&(ab={}),ab=hn(ab),ab.PouchConstructor=ab.PouchConstructor||this,ac=hK(ac,ab),aa=hK(aa,ab),new jo(ac,aa,ab,t)}function jo(af,ap,am,ac){function aq(ay){ah.emit("change",{direction:"pull",change:ay})}function aj(ay){ah.emit("change",{direction:"push",change:ay})}function t(ay){ah.emit("denied",{direction:"push",doc:ay})}function al(ay){ah.emit("denied",{direction:"pull",doc:ay})}function av(){ah.pushPaused=!0,ah.pullPaused&&ah.emit("paused")}function ab(){ah.pullPaused=!0,ah.pushPaused&&ah.emit("paused")}function ag(){ah.pushPaused=!1,ah.pullPaused&&ah.emit("active",{direction:"push"})}function ak(){ah.pullPaused=!1,ah.pushPaused&&ah.emit("active",{direction:"pull"})}function ad(ay){return function(aC,aD){var az="change"===aC&&(aD===aq||aD===aj),aA="denied"===aC&&(aD===al||aD===t),aE="paused"===aC&&(aD===ab||aD===av),aB="active"===aC&&(aD===ak||aD===ag);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ah.removeAllListeners(aC))}}var ah=this;this.canceled=!1;var aa=am.push?jw.extend({},am,am.push):am,aw=am.pull?jw.extend({},am,am.pull):am;this.push=gc(af,ap,aa),this.pull=gc(ap,af,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};am.live&&(this.push.on("complete",ah.pull.cancel.bind(ah.pull)),this.pull.on("complete",ah.push.cancel.bind(ah.push))),this.on("newListener",function(ay){"change"===ay?(ah.pull.on("change",aq),ah.push.on("change",aj)):"denied"===ay?(ah.pull.on("denied",al),ah.push.on("denied",t)):"active"===ay?(ah.pull.on("active",ak),ah.push.on("active",ag)):"paused"===ay&&(ah.pull.on("paused",ab),ah.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ah.pull.removeListener("change",aq),ah.push.removeListener("change",aj)):"denied"===ay?(ah.pull.removeListener("denied",al),ah.push.removeListener("denied",t)):"active"===ay?(ah.pull.removeListener("active",ak),ah.push.removeListener("active",ag)):"paused"===ay&&(ah.pull.removeListener("paused",ab),ah.push.removeListener("paused",av))}),this.pull.on("removeListener",ad("pull")),this.push.on("removeListener",ad("push"));var au=hc.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ah.emit("complete",az),ac&&ac(null,az),ah.removeAllListeners(),az},function(ay){if(ah.cancel(),ac?ac(ay):ah.emit("error",ay),ah.removeAllListeners(),ac){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gf(t){t.replicate=gc,t.sync=iQ}var cr,jw=a(9),id=gD(a(5)),gB=gD(a(8)),ik=gD(a(10)),gt=a(14),bt=gD(a(4)),C=a(1),gL=gD(a(15)),hO=gD(a(16)),fm=gD(a(17)),gR=a(12),hc="function"==typeof Promise?Promise:ik,fV=Function.prototype.toString,g7=fV.call(Object),hl=id("pouchdb:api"),fe=6;if(he()){cr=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),cr=!!localStorage.getItem("_pouch_check_localstorage")}catch(gi){cr=!1}}gB(ce,C.EventEmitter),ce.prototype.addListener=function(ad,aa,ag,t){function ac(){function aj(){af=!1}if(ab._listeners[aa]){if(af){return void (af="waiting")}af=!0;var ah=fc(t,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>t.since&&!t.cancelled&&(t.since=ak.seq,t.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ac()},0),af=!1}).on("error",aj)}}if(!this._listeners[aa]){var ab=this,af=!1;this._listeners[aa]=ac,this.on(ad,ac)}},ce.prototype.removeListener=function(t,aa){aa in this._listeners&&C.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},ce.prototype.notifyLocalWindows=function(t){he()?chrome.storage.local.set({dbName:t}):fZ()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ce.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},gB(gC,Error),gC.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ib=new gC({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),iU=new gC({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),i3=new gC({status:404,error:"not_found",reason:"missing"}),h7=new gC({status:409,error:"conflict",reason:"Document update conflict"}),g1=new gC({status:400,error:"invalid_id",reason:"_id field must contain a string"}),dn=new gC({status:412,error:"missing_id",reason:"_id is required for puts"}),W=new gC({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),g3=new gC({status:412,error:"precondition_failed",reason:"Database not open"}),i8=new gC({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),ew=new gC({status:500,error:"badarg",reason:"Some query argument is invalid"}),gu=new gC({status:400,error:"invalid_request",reason:"Request was invalid"}),S=new gC({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),at=new gC({status:500,error:"doc_validation",reason:"Bad special document member"}),hd=new gC({status:400,error:"bad_request",reason:"Something wrong with the request"}),gW=new gC({status:400,error:"bad_request",reason:"Document must be a JSON object"}),gG=new gC({status:404,error:"not_found",reason:"Database not found"}),jC=new gC({status:500,error:"indexed_db_went_bad",reason:"unknown"}),fr=new gC({status:500,error:"web_sql_went_bad",reason:"unknown"}),ih=new gC({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fj=new gC({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),h3=new gC({status:400,error:"bad_request",reason:"Invalid rev format"}),fT=new gC({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),gv=new gC({status:412,error:"missing_stub"}),ai=new gC({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),fw=[ib,iU,i3,h7,g1,dn,W,g3,i8,ew,gu,S,at,hd,gW,gG,fr,ih,fj,h3,fT,gv,jC,ai],h8=function(ac,aa,ab){var t=fw.filter(function(ad){return ad[ac]===aa});return ab&&t.filter(function(ad){return ad.message===ab})[0]||t[0]},ju=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],iJ="queryKey",de=/(?:^|&)([^&=]*)=?([^&]*)/g,ez=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,gg="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");gB(et,C.EventEmitter),et.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},et.prototype.doChanges=function(t){var ab=this,ac=t.complete;if(t=hn(t),"live" in t&&!("continuous" in t)&&(t.continuous=t.live),t.processChange=jf,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"===t.since){return void this.db.info().then(function(af){return ab.isCancelled?void ac(null,{status:"cancelled"}):(t.since=af.update_seq,void ab.doChanges(t))},ac)}if(t.continuous&&"now"!==t.since&&this.db.info().then(function(af){ab.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),t.view&&!t.filter&&(t.filter="_view"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=h(t.view):t.filter=h(t.filter),"http"!==this.db.type()&&!t.doc_ids)){return this.filterChanges(t)}"descending" in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=ac;var aa=this.db._changes(t);if(aa&&"function"==typeof aa.cancel){var ad=ab.cancel;ab.cancel=bt(function(af){aa.cancel(),ad.apply(this,af)})}},et.prototype.filterChanges=function(t){var ab=this,ac=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var aa=p(hd,"`view` filter parameter not found or invalid.");return ac(aa)}var ad=m(t.view);this.db.get("_design/"+ad[0],function(ah,aj){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(ah){return ac(n(ah))}var ag=aj&&aj.views&&aj.views[ad[1]]&&aj.views[ad[1]].map;return ag?(t.filter=jk(ag),void ab.doChanges(t)):ac(p(i3,aj.views?"missing json key: "+ad[1]:"missing json key: views"))})}else{var af=m(t.filter);if(!af){return ab.doChanges(t)}this.db.get("_design/"+af[0],function(ag,aj){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(ag){return ac(n(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(t.filter=o(ah),void ab.doChanges(t)):ac(p(i3,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},gB(J,C.EventEmitter),J.prototype.post=a4("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(p(gW)):void this.bulkDocs({docs:[ab]},t,co(aa))}),J.prototype.put=a4("put",bt(function(t){function aj(){aa||(a8("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),aa=!0)}var ac,af,ad,ab,aa=!1,ag=t.shift(),ah="_id" in ag;if("object"!=typeof ag||Array.isArray(ag)){return(ab=t.pop())(p(gW))}for(;;){if(ac=t.shift(),af=typeof ac,"string"!==af||ah?"string"!==af||!ah||"_rev" in ag?"object"===af?ad=ac:"function"===af&&(ab=ac):(aj(),ag._rev=ac):(aj(),ag._id=ac,ah=!0),!t.length){break}}return ad=ad||{},Y(ag._id),fU(ag._id)&&"function"==typeof this._putLocal?ag._deleted?this._removeLocal(ag,ab):this._putLocal(ag,ab):void this.bulkDocs({docs:[ag]},ad,co(ab))})),J.prototype.putAttachment=a4("putAttachment",function(ad,aa,ag,t,ac){function ab(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[aa]={content_type:ac,data:t,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof ac&&(ac=t,t=ag,ag=null),"undefined"==typeof ac&&(ac=t,t=ag,ag=null),af.get(ad).then(function(ah){if(ah._rev!==ag){throw p(h7)}return ab(ah)},function(ah){if(ah.reason===i3.message){return ab({_id:ad})}throw ah})}),J.prototype.removeAttachment=a4("removeAttachment",function(t,ab,ac,aa){var ad=this;ad.get(t,function(af,ag){return af?void aa(af):ag._rev!==ac?void aa(p(h7)):ag._attachments?(delete ag._attachments[ab],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ad.put(ag,aa)):aa()})}),J.prototype.remove=a4("remove",function(t,ab,ac,aa){var ad;"string"==typeof ab?(ad={_id:t,_rev:ab},"function"==typeof ac&&(aa=ac,ac={})):(ad=t,"function"==typeof ab?(aa=ab,ac={}):(aa=ac,ac=ab)),ac=ac||{},ac.was_delete=!0;var af={_id:ad._id,_rev:ad._rev||ac.rev};return af._deleted=!0,fU(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ad,aa):void this.bulkDocs({docs:[af]},ac,co(aa))}),J.prototype.revsDiff=a4("revsDiff",function(aa,ah,ad){function ag(ak,aj){ac.has(ak)||ac.set(ak,{missing:[]}),ac.get(ak).missing.push(aj)}function af(aj,ak){var al=aa[aj].slice(0);ao(ak,function(aw,am,ap,av,ax){var aq=am+"-"+ap,au=al.indexOf(aq);-1!==au&&(al.splice(au,1),"available"!==ax.status&&ag(aj,aq))}),al.forEach(function(am){ag(aj,am)})}"function"==typeof ah&&(ad=ah,ah={});var t=Object.keys(aa);if(!t.length){return ad(null,{})}var ab=0,ac=new gt.Map;t.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ac.set(aj,{missing:aa[aj]})}else{if(al){return ad(al)}af(aj,am)}if(++ab===t.length){var ak={};return ac.forEach(function(ap,aq){ak[aq]=ap}),ad(null,ak)}})},this)}),J.prototype.bulkGet=a4("bulkGet",function(t,aa){R(this,t,aa)}),J.prototype.compactDocument=a4("compactDocument",function(ac,aa,ab){var t=this;this._getRevisionTree(ac,function(af,ah){if(af){return ab(af)}var ad=iZ(ah),ag=[],aj=[];Object.keys(ad).forEach(function(ak){ad[ak]>aa&&ag.push(ak)}),ao(ah,function(aq,ak,am,au,ap){var al=ak+"-"+am;"available"===ap.status&&-1!==ag.indexOf(al)&&aj.push(al)}),t._doCompaction(ac,aj,ab)})}),J.prototype.compact=a4("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&hF(aa)}),J.prototype._compact=function(ad,aa){function ag(ah){af.push(ac.compactDocument(ah.id,0))}function t(ah){var aj=ah.last_seq;hc.all(af).then(function(){return fl(ac,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){aa(null,{ok:!0})})["catch"](aa)}var ac=this,ab={return_docs:!1,last_seq:ad.last_seq||0},af=[];ac.changes(ab).on("change",ag).on("complete",t).on("error",aa)},J.prototype.get=a4("get",function(aa,ah,ad){function ag(){var ak=[],aj=af.length;return aj?void af.forEach(function(al){t.get(aa,{rev:al,revs:ah.revs,attachments:ah.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ad(null,ak)})}):ad(null,ak)}if("function"==typeof ah&&(ad=ah,ah={}),"string"!=typeof aa){return ad(p(g1))}if(fU(aa)&&"function"==typeof this._getLocal){return this._getLocal(aa,ad)}var af=[],t=this;if(!ah.open_revs){return this._get(aa,ah,function(ap,aA){if(ap){return ad(ap)}var aB=aA.doc,al=aA.metadata,az=aA.ctx;if(ah.conflicts){var aw=iT(al);aw.length&&(aB._conflicts=aw)}if(g0(al,aB._rev)&&(aB._deleted=!0),ah.revs||ah.revs_info){var aj=M(al.rev_tree),au=ip(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aB._rev.split("-")[1])}),av=au.ids.map(function(aC){return aC.id}).indexOf(aB._rev.split("-")[1])+1,ak=au.ids.length-av;if(au.ids.splice(av,ak),au.ids.reverse(),ah.revs&&(aB._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ah.revs_info){var aq=au.pos+au.ids.length;aB._revs_info=au.ids.map(function(aC){return aq--,{rev:aq+"-"+aC.id,status:aC.opts.status}})}}if(ah.attachments&&aB._attachments){var am=aB._attachments,ax=Object.keys(am).length;if(0===ax){return ad(null,aB)}Object.keys(am).forEach(function(aC){this._getAttachment(aB._id,aC,am[aC],{rev:aB._rev,binary:ah.binary,ctx:az},function(aE,aD){var aF=aB._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--ax||ad(null,aB)})},t)}else{if(aB._attachments){for(var ay in aB._attachments){aB._attachments.hasOwnProperty(ay)&&(aB._attachments[ay].stub=!0)}}ad(null,aB)}})}if("all"===ah.open_revs){this._getRevisionTree(aa,function(ak,aj){return ak?ad(ak):(af=iW(aj).map(function(al){return al.rev}),void ag())})}else{if(!Array.isArray(ah.open_revs)){return ad(p(i8,"function_clause"))}af=ah.open_revs;for(var ab=0;ab<af.length;ab++){var ac=af[ab];if("string"!=typeof ac||!/^\d+-/.test(ac)){return ad(p(h3))}}ag()}}),J.prototype.getAttachment=a4("getAttachment",function(t,ab,ac,aa){var ad=this;ac instanceof Function&&(aa=ac,ac={}),this._get(t,ac,function(af,ag){return af?aa(af):ag.doc._attachments&&ag.doc._attachments[ab]?(ac.ctx=ag.ctx,ac.binary=!0,ad._getAttachment(t,ab,ag.doc._attachments[ab],ac,aa),void 0):aa(p(i3))})}),J.prototype.allDocs=a4("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(p(S,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return go(this,ab,t)}}return this._allDocs(ab,t)}),J.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new et(this,t,aa)},J.prototype.close=a4("close",function(t){return this._closed=!0,this._close(t)}),J.prototype.info=a4("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),J.prototype.id=a4("id",function(t){return this._id(t)}),J.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},J.prototype.bulkDocs=a4("bulkDocs",function(t,ab,ac){if("function"==typeof ab&&(ac=ab,ab={}),ab=ab||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs)){return ac(p(iU))}for(var aa=0;aa<t.docs.length;++aa){if("object"!=typeof t.docs[aa]||Array.isArray(t.docs[aa])){return ac(p(gW))}}var ad;return t.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ad=ad||iu(ag)})}),ad?ac(p(hd,ad)):("new_edits" in ab||("new_edits" in t?ab.new_edits=t.new_edits:ab.new_edits=!0),ab.new_edits||"http"===this.type()||t.docs.sort(jl),hL(t.docs),this._bulkDocs(t,ab,function(af,ag){return af?ac(af):(ab.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ac(null,ag))}))}),J.prototype.registerDependentDatabase=a4("registerDependentDatabase",function(ac,aa){function ab(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ac]?!1:(ad.dependentDbs[ac]=!0,ad)}var t=new this.constructor(ac,this.__opts);fl(this,"_local/_pouch_dependentDbs",ab).then(function(){aa(null,{db:t})})["catch"](aa)}),J.prototype.destroy=a4("destroy",function(t,ab){function ac(){aa._destroy(t,function(ag,af){return ag?ab(ag):(aa._destroyed=!0,aa.emit("destroyed"),void ab(null,af||{ok:!0}))})}"function"==typeof t&&(ab=t,t={});var aa=this,ad="use_prefix" in aa?aa.use_prefix:!0;return"http"===aa.type()?ac():void aa.get("_local/_pouch_dependentDbs",function(af,ah){if(af){return 404!==af.status?ab(af):ac()}var ak=ah.dependentDbs,ag=aa.constructor,aj=Object.keys(ak).map(function(al){var am=ad?al.replace(new RegExp("^"+ag.prefix),""):al;return new ag(am,aa.__opts).destroy()});hc.all(aj).then(ac,ab)})}),hq.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},hq.prototype.fail=function(t){this.failed=t,this.execute()},hq.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},hq.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},gB(jB,J),jB.debug=id,jB.adapters={},jB.preferredAdapters=[],jB.prefix="_pouch_";var hw=new C.EventEmitter;gK(jB),jB.parseAdapter=function(aa,ah){var ad,ag,af=aa.match(/([a-z\-]*):\/\/(.*)/);if(af){if(aa=/http(s?)/.test(af[1])?af[1]+"://"+af[2]:af[2],ad=af[1],!jB.adapters[ad].valid()){throw"Invalid adapter"}return{name:aa,adapter:af[1]}}var t="idb" in jB.adapters&&"websql" in jB.adapters&&fZ()&&localStorage["_pouch__websqldb_"+jB.prefix+aa];if(ah.adapter){ag=ah.adapter}else{if("undefined"!=typeof ah&&ah.db){ag="leveldb"}else{for(var ab=0;ab<jB.preferredAdapters.length;++ab){if(ag=jB.preferredAdapters[ab],ag in jB.adapters){if(t&&"idb"===ag){a8("log",'PouchDB is downgrading "'+aa+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ad=jB.adapters[ag];var ac=ad&&"use_prefix" in ad?ad.use_prefix:!0;return{name:ac?jB.prefix+aa:aa,adapter:ag}},jB.adapter=function(ab,t,aa){t.valid()&&(jB.adapters[ab]=t,aa&&jB.preferredAdapters.push(ab))},jB.plugin=function(t){return"function"==typeof t?t(jB):Object.keys(t).forEach(function(aa){jB.prototype[aa]=t[aa]}),jB},jB.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=jw.extend({},t,ad),void jB.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return gB(aa,jB),aa.preferredAdapters=jB.preferredAdapters.slice(),Object.keys(jB).forEach(function(ab){ab in aa||(aa[ab]=jB[ab])}),aa};var fz="5.4.4";jB.version=fz;var fs,gT=im(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hy=im(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),js=function(t){return atob(t)},jm=function(t){return btoa(t)},fX=fy.setImmediate||fy.setTimeout,hM=32768,g2=5,g8="document-store",x="by-sequence",gr="attach-store",hf="attach-seq-store",fa="meta-store",h9="local-store",jh="detect-blob-support",gh={running:!1,queue:[]},iK=new gt.Map,hk=new ce,gq=new gt.Map;fW.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var K=7,it=gZ("document-store"),i9=gZ("by-sequence"),iM=gZ("attach-store"),hV=gZ("local-store"),hb=gZ("metadata-store"),hP=gZ("attach-seq-store"),V=new gt.Map,ie=new ce,jz=1,hA="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+i9+" (seq, deleted)",iG="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+i9+" (doc_id, rev)",s="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+it+" (winningseq)",i2="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+hP+" (seq)",ia="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+hP+" (digest, seq)",hu=i9+".seq = "+it+".winningseq",hE=i9+".seq AS seq, "+i9+".deleted AS deleted, "+i9+".json AS data, "+i9+".rev AS rev, "+it+".json AS metadata";N.valid=k,N.use_prefix=!0;var jr=hN(),gS=function(){},gU=25,dt=50,dr={},jj=1800,iY=id("pouchdb:http");ev.valid=function(){return !0},iH.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},iH.prototype.finish=function(){return this.promise};var jb=function(t,aa){return aa&&t.then(function(ab){fi.nextTick(function(){aa(null,ab)})},function(ab){fi.nextTick(function(){aa(ab)})}),t},gE=function(t){return bt(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&jb(ab,aa),ab})},hz=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},ir=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},hJ=function(t){for(var ab={},ac=0,aa=t.length;aa>ac;ac++){ab["$"+t[ac]]=!0}var ad=Object.keys(ab),af=new Array(ad.length);for(ac=0,aa=ad.length;aa>ac;ac++){af[ac]=ad[ac].substring(1)}return af},hD={},Q=new iH,gd=50,iw=a8.bind(null,"log"),bn={_sum:function(t,aa){return hY(aa)},_count:function(t,aa){return aa.length},_stats:function(ab,t){function aa(ah){for(var ad=0,af=0,ac=ah.length;ac>af;af++){var ag=ah[af];ad+=ag*ag}return ad}return{sum:hY(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},il=gE(function(){var t=this;return"http"===t.type()?jv(t):"function"==typeof t._viewCleanup?ge(t):hg(t)}),hj=function(t,ab,ac){"function"==typeof ab&&(ac=ab,ab={}),ab=ab?jy(ab):{},"function"==typeof t&&(t={map:t});var aa=this,ad=hc.resolve().then(function(){return ae(aa,t,ab)});return jb(ad,ac),ad};gB(r,Error),gB(iP,Error),gB(i,Error);var hm={query:hj,viewCleanup:il},en=1,h6="pouchdb",jn=5,v=0;hr.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},hr.prototype.updateTarget=function(t,aa){return ey(this.target,this.id,t,aa,this.returnValue)},hr.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?hc.resolve(!0):ey(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(gb(ac)){return aa.readOnlySource=!0,!0}throw ac})};var hC={undefined:function(t,aa){return 0===gR.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return ha(aa,t).last_seq}};hr.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hc.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return v}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hC?hC[ab](aa,ac):v},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:v}).then(function(){return v},function(ac){return gb(ac)?(t.readOnlySource=!0,aa.last_seq):v})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return v})};var a6=0;gB(fS,C.EventEmitter),fS.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},fS.prototype.ready=function(t,ab){function ac(){ad.cancel()}function aa(){t.removeListener("destroyed",ac),ab.removeListener("destroyed",ac)}var ad=this;ad._readyCalled||(ad._readyCalled=!0,t.once("destroyed",ac),ab.once("destroyed",ac),ad.once("complete",aa))},gB(jo,C.EventEmitter),jo.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},jB.plugin(F).plugin(a3).plugin(h1).plugin(hm).plugin(gf),b.exports=jB}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var f=arguments,h=this.useColors;if(f[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+f[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return f}var g="color: "+this.color;f=[f[0],g,"color: inherit"].concat(Array.prototype.slice.call(f,1));var k=0,j=0;return f[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(k++,"%c"===l&&(j=k))}),f.splice(j,0,g),f}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(r,f,u){function b(){return u.colors[s++%u.colors.length]}function a(h){function k(){}function j(){var m=j,w=+new Date,l=w-(o||w);m.diff=l,m.prev=o,m.curr=w,o=w,null==m.useColors&&(m.useColors=u.useColors()),null==m.color&&m.useColors&&(m.color=b());var q=Array.prototype.slice.call(arguments);q[0]=u.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=u.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof u.formatArgs&&(q=u.formatArgs.apply(m,q));var p=j.log||u.log||console.log.bind(console);p.apply(m,q)}k.enabled=!1,j.enabled=!0;var g=u.enabled(h)?j:k;return g.namespace=h,g}function t(j){u.save(j);for(var h=(j||"").split(/[\s,]+/),k=h.length,g=0;k>g;g++){h[g]&&(j=h[g].replace(/\*/g,".*?"),"-"===j[0]?u.skips.push(new RegExp("^"+j.substr(1)+"$")):u.names.push(new RegExp("^"+j+"$")))}}function n(){u.enable("")}function e(g){var j,h;for(j=0,h=u.skips.length;h>j;j++){if(u.skips[j].test(g)){return !1}}for(j=0,h=u.names.length;h>j;j++){if(u.names[j].test(g)){return !0}}return !1}function i(g){return g instanceof Error?g.stack||g.message:g}u=f.exports=a,u.coerce=i,u.disable=n,u.enable=t,u.enabled=e,u.humanize=r(11),u.names=[],u.skips=[],u.formatters={};var o,s=0},{11:11}],7:[function(a,b,e){(function(n){function u(){o=!0;for(var h,j,g=s.length;g;){for(j=s,s=[],h=-1;++h<g;){j[h]()}g=s.length}o=!1}function z(g){1!==s.push(g)||o||y()}var y,r=n.MutationObserver||n.WebKitMutationObserver;if(r){var l=0,f=new r(u),i=n.document.createTextNode("");f.observe(i,{characterData:!0}),y=function(){i.data=l=++l%2}}else{if(n.setImmediate||"undefined"==typeof n.MessageChannel){y="document" in n&&"onreadystatechange" in n.document.createElement("script")?function(){var g=n.document.createElement("script");g.onreadystatechange=function(){u(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},n.document.documentElement.appendChild(g)}:function(){setTimeout(u,0)}}else{var x=new n.MessageChannel;x.port1.onmessage=u,y=function(){x.port2.postMessage(0)}}}var o,s=[];b.exports=z}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(t,u,i){function r(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=m,this.queue=[],this.outcome=void 0,g!==r&&y(this,g)}function b(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function h(j,k,g){n(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function a(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(q,j){function w(A){x||(x=!0,K.reject(q,A))}function g(A){x||(x=!0,K.resolve(q,A))}function k(){j(g,w)}var x=!1,z=o(k);"error"===z.status&&w(z.value)}function o(q,j){var k={};try{k.value=q(j),k.status="success"}catch(g){k.status="error",k.value=g}return k}function f(g){return g instanceof this?g:K.resolve(new this(r),g)}function l(g){var j=new this(r);return K.reject(j,g)}function p(A){function z(E,D){function C(F){g[D]=F,++k!==x||q||(q=!0,K.resolve(j,g))}w.resolve(E).then(C,function(F){q||(q=!0,K.reject(j,F))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(A)){return this.reject(new TypeError("must be an array"))}var x=A.length,q=!1;if(!x){return this.resolve([])}for(var g=new Array(x),k=0,B=-1,j=new this(r);++B<x;){z(A[B],B)}return j}function s(q){function j(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(g,B))},function(B){x||(x=!0,K.reject(g,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(q)){return this.reject(new TypeError("must be an array"))}var k=q.length,x=!1;if(!k){return this.resolve([])}for(var z=-1,g=new this(r);++z<k;){j(q[z])}return g}var n=t(7),K={},L=["REJECTED"],e=["FULFILLED"],m=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(g,j){if("function"!=typeof g&&this.state===e||"function"!=typeof j&&this.state===L){return this}var k=new this.constructor(r);if(this.state!==m){var q=this.state===e?g:j;h(k,q,this.outcome)}else{this.queue.push(new b(k,g,j))}return k},b.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){K.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},K.resolve=function(g,w){var k=o(a,w);if("error"===k.status){return K.reject(g,k.value)}var j=k.value;if(j){y(g,j)}else{g.state=e,g.outcome=w;for(var q=-1,x=g.queue.length;++q<x;){g.queue[q].callFulfilled(w)}}return g},K.reject=function(q,j){q.state=L,q.outcome=j;for(var k=-1,g=q.queue.length;++k<g;){q.queue[k].callRejected(j)}return q},v.resolve=f,v.reject=l,v.all=p,v.race=s},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(n,a,D){function i(q){if(null!==q){switch(typeof q){case"boolean":return q?1:0;case"number":return p(q);case"string":return q.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var g=Array.isArray(q),m=g?q:Object.keys(q),v=-1,j=m.length,k="";if(g){for(;++v<j;){k+=D.toIndexableString(m[v])}}else{for(;++v<j;){var w=m[v];k+=D.toIndexableString(w)+D.toIndexableString(q[w])}}return k}}return""}function b(y,q){var g,k=q,j="1"===y[q];if(j){g=0,q++}else{var z="0"===y[q];q++;var w="",m=y.substring(q,q+l),v=parseInt(m,10)+e;for(z&&(v=-v),q+=l;;){var x=y[q];if("\x00"===x){break}w+=x,q++}w=w.split("."),g=1===w.length?parseInt(w,10):parseFloat(w[0]+"."+w[1]),z&&(g-=10),0!==v&&(g=parseFloat(g+"e"+v))}return{num:g,length:q-k}}function o(m,v){var g=m.pop();if(v.length){var w=v[v.length-1];g===w.element&&(v.pop(),w=v[v.length-1]);var j=w.element,k=w.index;if(Array.isArray(j)){j.push(g)}else{if(k===m.length-2){var q=m.pop();j[q]=g}else{m.push(g)}}}}function r(m,g){for(var q=Math.min(m.length,g.length),k=0;q>k;k++){var j=D.collate(m[k],g[k]);if(0!==j){return j}}return m.length===g.length?0:m.length>g.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(q,g){for(var m=Object.keys(q),v=Object.keys(g),j=Math.min(m.length,v.length),k=0;j>k;k++){var w=D.collate(m[k],v[k]);if(0!==w){return w}if(w=D.collate(q[m[k]],g[v[k]]),0!==w){return w}}return m.length===v.length?0:m.length>v.length?1:-1}function s(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function p(g){if(0===g){return"1"}var w=g.toExponential().split(/e\+?/),k=parseInt(w[1],10),q=0>g,m=q?"0":"2",j=(q?-k:k)-e,y=h.padLeft(j.toString(),"0",l);m+=u+y;var v=Math.abs(parseFloat(w[0]));q&&(v=10-v);var x=v.toFixed(20);return x=x.replace(/\.?0+$/,""),m+=u+x}var e=-324,l=3,u="",h=n(13);D.collate=function(j,m){if(j===m){return 0}j=D.normalizeKey(j),m=D.normalizeKey(m);var k=s(j),g=s(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?r(j,m):f(j,m)},D.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=D.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=D.normalizeKey(m))}}}}}return g},D.toIndexableString=function(g){var j="\x00";return g=D.normalizeKey(g),s(g)+u+i(g)+j},D.parseIndexableString=function(y){for(var q=[],j=[],k=0;;){var w=y[k++];if("\x00"!==w){switch(w){case"1":q.push(null);break;case"2":q.push("1"===y[k]),k++;break;case"3":var m=b(y,k);q.push(m.num),k+=m.length;break;case"4":for(var v="";;){var x=y[k];if("\x00"===x){break}v+=x,k++}v=v.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),q.push(v);break;case"5":var z={element:[],index:q.length};q.push(z.element),j.push(z);break;case"6":var g={element:{},index:q.length};q.push(g.element),j.push(g);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+w)}}else{if(1===q.length){return q.pop()}o(q,j)}}}},{13:13}],13:[function(b,h,a){function e(f,l,m){for(var g="",n=m-f.length;g.length<n;){g+=l}return g}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,o){var r,q=n.length,f=o.length;for(r=0;q>r;r++){if(r===f){return 1}var g=n.charAt(r),i=o.charAt(r);if(g!==i){return i>g?-1:1}}return f>q?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(i,a,b){function j(){this.store={}}function e(g){if(this.store=new j,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}b.Map=j,b.Set=e,j.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},j.prototype.unmangle=function(f){return f.substring(1)},j.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},j.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},j.prototype.has=function(f){var g=this.mangle(f);return g in this.store},j.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},j.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},e.prototype.add=function(f){return this.store.set(f,!0)},e.prototype.has=function(f){return this.store.has(f)},e.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(r,n){var o,p,g,q;p=[],q=[];for(o in n){h.call(n,o)&&(g=n[o],"this"!==o&&(p.push(o),q.push(g)))}return Function.apply(null,f.call(p).concat([r])).apply(n["this"],q)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(t){function Q(j,w,z,k,q,x){return w=O(O(w,j),O(k,x)),O(w<<q|w>>>32-q,z)}function s(j,w,k,q,x,z,A){return Q(w&k|~w&q,j,w,x,z,A)}function p(j,w,k,q,x,z,A){return Q(w&q|k&~q,j,w,x,z,A)}function u(j,w,k,q,x,z,A){return Q(w^k^q,j,w,x,z,A)}function o(j,w,k,q,x,z,A){return Q(k^(w|~q),j,w,x,z,A)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=s(z,k,x,q,w[0],7,-680876936),q=s(q,z,k,x,w[1],12,-389564586),x=s(x,q,z,k,w[2],17,606105819),k=s(k,x,q,z,w[3],22,-1044525330),z=s(z,k,x,q,w[4],7,-176418897),q=s(q,z,k,x,w[5],12,1200080426),x=s(x,q,z,k,w[6],17,-1473231341),k=s(k,x,q,z,w[7],22,-45705983),z=s(z,k,x,q,w[8],7,1770035416),q=s(q,z,k,x,w[9],12,-1958414417),x=s(x,q,z,k,w[10],17,-42063),k=s(k,x,q,z,w[11],22,-1990404162),z=s(z,k,x,q,w[12],7,1804603682),q=s(q,z,k,x,w[13],12,-40341101),x=s(x,q,z,k,w[14],17,-1502002290),k=s(k,x,q,z,w[15],22,1236535329),z=p(z,k,x,q,w[1],5,-165796510),q=p(q,z,k,x,w[6],9,-1069501632),x=p(x,q,z,k,w[11],14,643717713),k=p(k,x,q,z,w[0],20,-373897302),z=p(z,k,x,q,w[5],5,-701558691),q=p(q,z,k,x,w[10],9,38016083),x=p(x,q,z,k,w[15],14,-660478335),k=p(k,x,q,z,w[4],20,-405537848),z=p(z,k,x,q,w[9],5,568446438),q=p(q,z,k,x,w[14],9,-1019803690),x=p(x,q,z,k,w[3],14,-187363961),k=p(k,x,q,z,w[8],20,1163531501),z=p(z,k,x,q,w[13],5,-1444681467),q=p(q,z,k,x,w[2],9,-51403784),x=p(x,q,z,k,w[7],14,1735328473),k=p(k,x,q,z,w[12],20,-1926607734),z=u(z,k,x,q,w[5],4,-378558),q=u(q,z,k,x,w[8],11,-2022574463),x=u(x,q,z,k,w[11],16,1839030562),k=u(k,x,q,z,w[14],23,-35309556),z=u(z,k,x,q,w[1],4,-1530992060),q=u(q,z,k,x,w[4],11,1272893353),x=u(x,q,z,k,w[7],16,-155497632),k=u(k,x,q,z,w[10],23,-1094730640),z=u(z,k,x,q,w[13],4,681279174),q=u(q,z,k,x,w[0],11,-358537222),x=u(x,q,z,k,w[3],16,-722521979),k=u(k,x,q,z,w[6],23,76029189),z=u(z,k,x,q,w[9],4,-640364487),q=u(q,z,k,x,w[12],11,-421815835),x=u(x,q,z,k,w[15],16,530742520),k=u(k,x,q,z,w[2],23,-995338651),z=o(z,k,x,q,w[0],6,-198630844),q=o(q,z,k,x,w[7],10,1126891415),x=o(x,q,z,k,w[14],15,-1416354905),k=o(k,x,q,z,w[5],21,-57434055),z=o(z,k,x,q,w[12],6,1700485571),q=o(q,z,k,x,w[3],10,-1894986606),x=o(x,q,z,k,w[10],15,-1051523),k=o(k,x,q,z,w[1],21,-2054922799),z=o(z,k,x,q,w[8],6,1873313359),q=o(q,z,k,x,w[15],10,-30611744),x=o(x,q,z,k,w[6],15,-1560198380),k=o(k,x,q,z,w[13],21,1309151649),z=o(z,k,x,q,w[4],6,-145523070),q=o(q,z,k,x,w[11],10,-1120210379),x=o(x,q,z,k,w[2],15,718787259),k=o(k,x,q,z,w[9],21,-343485551),j[0]=O(z,j[0]),j[1]=O(k,j[1]),j[2]=O(x,j[2]),j[3]=O(q,j[3])}function y(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function r(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function m(C){var x,A,B,w,k,q,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;z>=x;x+=64){g(j,y(C.substring(x-64,x)))}for(C=C.substring(x-64),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;A>x;x+=1){B[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(B[x>>2]|=128<<(x%4<<3),x>55){for(g(j,B),x=0;16>x;x+=1){B[x]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),q=parseInt(w[1],16)||0,B[14]=k,B[15]=q,g(j,B),j}function v(C){var q,A,B,w,k,x,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(q=64;z>=q;q+=64){g(j,r(C.subarray(q-64,q)))}for(C=z>q-64?C.subarray(q-64):new Uint8Array(0),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=0;A>q;q+=1){B[q>>2]|=C[q]<<(q%4<<3)}if(B[q>>2]|=128<<(q%4<<3),q>55){for(g(j,B),q=0;16>q;q+=1){B[q]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,B[14]=k,B[15]=x,g(j,B),j}function P(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function n(j){var k;for(k=0;k<j.length;k+=1){j[k]=P(j[k])}return j.join("")}function l(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function i(){this.reset()}var O=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==n(m("hello"))&&(O=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(C,k){var w,x,z,A,q=this.byteLength,B=j(C,q),D=q;return k!==t&&(D=j(k,q)),B>D?new ArrayBuffer(0):(w=D-B,x=new ArrayBuffer(w),z=new Uint8Array(x),A=new Uint8Array(this,B,w),z.set(A),x)}}(),i.prototype.append=function(j){return this.appendBinary(l(j)),this},i.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,y(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},i.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},i.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},i.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},i.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},i.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},i.hash=function(j,k){return i.hashBinary(l(j),k)},i.hashBinary=function(j,w){var q=m(j),k=n(q);return w?e(k):k},i.ArrayBuffer=function(){this.reset()},i.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,r(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},i.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},i.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.ArrayBuffer.prototype.getState=function(){var j=i.prototype.getState.call(this);return j.buff=S(j.buff),j},i.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),i.prototype.setState.call(this,j)},i.ArrayBuffer.prototype.destroy=i.prototype.destroy,i.ArrayBuffer.prototype._finish=i.prototype._finish,i.ArrayBuffer.hash=function(j,w){var q=v(new Uint8Array(j)),k=n(q);return w?e(k):k},i})},{}],17:[function(b,h,a){function e(n,o,r){var q=r[r.length-1];n===q.element&&(r.pop(),q=r[r.length-1]);var f=q.element,g=q.index;if(Array.isArray(f)){f.push(n)}else{if(g===o.length-2){var i=o.pop();f[i]=n}else{o.push(n)}}}a.stringify=function(r){var f=[];f.push({obj:r});for(var u,D,F,n,i,E,s,t,l,o,g,C="";u=f.pop();){if(D=u.obj,F=u.prefix||"",n=u.val||"",C+=F,n){C+=n}else{if("object"!=typeof D){C+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){C+="null"}else{if(Array.isArray(D)){for(f.push({val:"]"}),i=D.length-1;i>=0;i--){E=0===i?"":",",f.push({obj:D[i],prefix:E})}f.push({val:"["})}else{s=[];for(t in D){D.hasOwnProperty(t)&&s.push(t)}for(f.push({val:"}"}),i=s.length-1;i>=0;i--){l=s[i],o=D[l],g=i>0?",":"",g+=JSON.stringify(l)+":",f.push({obj:o,prefix:g})}f.push({val:"{"})}}}}}return C},a.parse=function(s){for(var i,B,o,g,u,f,t,A,C,l=[],n=[],D=0;;){if(i=s[D++],"}"!==i&&"]"!==i&&"undefined"!=typeof i){switch(i){case" ":case"	":case"\n":case":":case",":break;case"n":D+=3,e(null,l,n);break;case"t":D+=3,e(!0,l,n);break;case"f":D+=4,e(!1,l,n);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(B="",D--;;){if(o=s[D++],!/[\d\.\-e\+]/.test(o)){D--;break}B+=o}e(parseFloat(B),l,n);break;case'"':for(g="",u=void 0,f=0;;){if(t=s[D++],'"'===t&&("\\"!==u||f%2!==1)){break}g+=t,u=t,"\\"===u?f++:f=0}e(JSON.parse('"'+g+'"'),l,n);break;case"[":A={element:[],index:l.length},l.push(A.element),n.push(A);break;case"{":C={element:{},index:l.length},l.push(C.element),n.push(C);break;default:throw new Error("unexpectedly reached end of input: "+i)}}else{if(1===l.length){return l.pop()}e(l.pop(),l,n)}}}},{}]},{},[3])(3)});