!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(j,g){if(!b[j]){if(!i[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(a){return a(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=b[j]={exports:{}};i[j][0].call(f.exports,function(m){var p=i[j][1][m];return k(p?p:m)},f,f.exports,d,i,b,l)}return b[j].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,r,l,h,j,f;if(this._events||(this._events={}),"error"===g&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[g],i(r)){return !1}if(o(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(m(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(m(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(u,e,r){function a(){h&&o&&(h=!1,o.length?t=o.concat(t):l=-1,t.length&&i())}function i(){if(!h){var g=b(a);h=!0;for(var j=t.length;j;){for(o=t,t=[];++l<j;){o&&o[l].run()}l=-1,j=t.length}o=null,h=!1,s(g)}}function f(g,j){this.fun=g,this.array=j}function B(){}var b,s,n=e.exports={};!function(){try{b=setTimeout}catch(g){b=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(g){s=function(){throw new Error("clearTimeout is not defined")}}}();var o,t=[],h=!1,l=-1;n.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}t.push(new f(j,k)),1!==t.length||h||b(i,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=B,n.addListener=B,n.once=B,n.off=B,n.removeListener=B,n.removeAllListeners=B,n.emit=B,n.binding=function(g){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(g){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],3:[function(a,b,e){(function(g9,g5){function fZ(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fy(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fc(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function ii(ab){if(ab instanceof ArrayBuffer){return fc(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function h0(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&m.call(aa)==gN}function fp(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=fp(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(fy(ac)){return ii(ac)}if(!h0(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=fp(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function gC(aa){var t=!1;return hg(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fU(t){return hg(function(ac){ac=fp(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){g9.nextTick(function(){ad(ag,ah)})});var af=new gi(function(ah,aj){var al;try{var ag=gC(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fS(ab,t){function aa(ad,ag,aj){if(ik.enabled){for(var af=[ad._db_name,ag],ac=0;ac<aj.length-1;ac++){af.push(aj[ac])}ik.apply(null,af);var ah=aj[aj.length-1];aj[aj.length-1]=function(ak,am){var al=[ad._db_name,ag];al=al.concat(ak?["error",ak]:["success",am]),ik.apply(null,al),ah(ak,am)}}}return fU(hg(function(ad){if(this._closed){return gi.reject(new Error("database is closed"))}if(this._destroyed){return gi.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new gi(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function cn(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function ge(t){return t}function jt(t){return[{ok:t}]}function ee(af,aa,ah){function aq(){var av=[];aj.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),ah(null,{results:av})}function ak(){++ab===ap&&aq()}function ag(aw,ax,av){aj[aw]={id:ax,docs:av},ak()}function am(){if(!(au>=al.length)){var av=Math.min(au+hi,al.length),aw=al.slice(au,av);t(aw,au),au+=aw.length}}function t(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=ad[aC],aB=cn(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(ge);var ax=ge;0===aB.open_revs.length&&(delete aB.open_revs,ax=jt),["revs","attachments","binary","ajax"].forEach(function(aD){aD in aa&&(aB[aD]=aa[aD])}),af.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),ag(ay,aC,aE),am()})})}var ac=aa.docs,ad={};ac.forEach(function(av){av.id in ad?ad[av.id].push(av):ad[av.id]=[av]});var ap=Object.keys(ad).length,ab=0,aj=new Array(ap),al=Object.keys(ad),au=0;am()}function ga(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fd(){return et}function fi(t){ga()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function er(){i5.EventEmitter.call(this),this._listeners={},fi(this)}function h2(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function co(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function gl(aa){var t=0;return aa||(t=2000),co(aa,t)}function iu(aa,t){h2("info","The above "+aa+" is totally normal. "+t)}function y(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gM(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=y.prototype,new aa(ab)}function jd(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=h3("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=gW:"doc_validation"===aa?(ad=at,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=ew),ad||(ad=h3("status",ac.status,af)||D),t=gM(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function gX(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return gM(ew,ab)}}function iS(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&gX(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function dt(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function iC(aa){var t;if(aa?"string"!=typeof aa?t=gM(hO):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=gM(u)):t=gM(gB),t){throw t}}function hE(aa,t){return"listenerCount" in aa?aa.listenerCount(t):i5.EventEmitter.listenerCount(aa,t)}function fW(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function go(aa){var t=fW(aa);return t?t.join("/"):null}function R(ab){for(var ad=ez.exec(ab),ag={},ac=14;ac--;){var aa=hM[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[gT]={},ag[hM[12]].replace(de,function(ak,aj,ah){aj&&(ag[gT][aj]=ah)}),ag}function gE(ab,t,aa){return new gi(function(ad,ac){ab.get(t,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=aa(af);return aj?(aj._id=t,aj._rev=ag,void ad(ex(ab,aj,aa))):ad({updated:!1,rev:ag})})})}function ex(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return gE(ab,t._id,aa)})}function eo(t){return 0|Math.random()*t}function a3(t,ab){ab=ab||gL.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=gL[eo(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=gL[3&eo(16)|8];break;default:ac+=gL[eo(16)]}}return ac}function iT(t){for(var al,ah,ak,aj,af=t.rev_tree.slice();aj=af.pop();){var ap=aj.ids,ad=ap[2],am=aj.pos;if(ad.length){for(var aa=0,ac=ad.length;ac>aa;aa++){af.push({pos:am+1,ids:ad[aa]})}}else{var ag=!!ap[1].deleted,ab=ap[0];al&&!(ak!==ag?ak:ah!==am?am>ah:ab>al)||(al=ab,ah=am,ak=ag)}}return ah+"-"+al}function gf(ag,ad){for(var aj,aa=ag.slice();aj=aa.pop();){for(var ak=aj.pos,ah=aj.ids,af=ah[2],ac=ad(0===af.length,ak,ah[0],aj.ctx,ah[1]),ab=0,t=af.length;t>ab;ab++){aa.push({pos:ak+1,ids:af[ab],ctx:ac})}}}function iW(aa,t){return aa.pos-t.pos}function l(t){var ab=[];gf(t,function(af,aj,ag,ad,ah){af&&ab.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),ab.sort(iW).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function jo(ab){for(var ad=iT(ab),ag=l(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function gk(aa){var t=[];return gf(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function bo(t){for(var al,ah=[],ak=t.slice();al=ak.pop();){var aj=al.pos,af=al.ids,ap=af[0],ad=af[1],am=af[2],aa=0===am.length,ac=al.history?al.history.slice():[];ac.push({id:ap,opts:ad}),aa&&ah.push({pos:aj+1-ac.length,ids:ac});for(var ag=0,ab=am.length;ab>ag;ag++){ak.push({pos:aj+1,ids:am[ag],history:ac})}}return ah.reverse()}function fu(aa,t){return aa.pos-t.pos}function h1(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function fg(t,ab,ac){var aa=h1(t,ab,ac);t.splice(aa,0,ab)}function hB(af,ad){for(var ac,ab,t=ad,ah=af.length;ah>t;t++){var aa=af[t],ag=[aa.id,aa.opts,[]];ab?(ab[2].push(ag),ab=ag):ac=ab=ag}return ac}function iP(aa,t){return aa[0]<t[0]?-1:1}function hr(ag,ad){for(var aj=[{tree1:ag,tree2:ad}],aa=!1;aj.length>0;){var ak=aj.pop(),ah=ak.tree1,af=ak.tree2;(ah[1].status||af[1].status)&&(ah[1].status="available"===ah[1].status||"available"===af[1].status?"available":"missing");for(var ac=0;ac<af[2].length;ac++){if(ah[2][0]){for(var ab=!1,t=0;t<ah[2].length;t++){ah[2][t][0]===af[2][ac][0]&&(aj.push({tree1:ah[2][t],tree2:af[2][ac]}),ab=!0)}ab||(aa="new_branch",fg(ah[2],af[2][ac],iP))}else{aa="new_leaf",ah[2][0]=af[2][ac]}}}return{conflicts:aa,tree:ag}}function gs(am,aa,ap){var t,av=[],aj=!1,ac=!1;if(!am.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=am.length;aw>ak;ak++){var aq=am[ak];if(aq.pos===aa.pos&&aq.ids[0]===aa.ids[0]){t=hr(aq.ids,aa.ids),av.push({pos:aq.pos,ids:t.tree}),aj=aj||t.conflicts,ac=!0}else{if(ap!==!0){var ab=aq.pos<aa.pos?aq:aa,al=aq.pos<aa.pos?aa:aq,ad=al.pos-ab.pos,ag=[],ax=[];for(ax.push({ids:ab.ids,diff:ad,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],af=0,ah=az.length;ah>af;af++){ax.push({ids:az[af],diff:ay.diff-1,parent:ay.ids,parentIdx:af})}}else{ay.ids[0]===al.ids[0]&&ag.push(ay)}}var au=ag[0];au?(t=hr(au.ids,al.ids),au.parent[2][au.parentIdx]=t.tree,av.push({pos:ab.pos,ids:ab.ids}),aj=aj||t.conflicts,ac=!0):av.push(aq)}else{av.push(aq)}}}return ac||av.push(aa),av.sort(fu),{tree:av,conflicts:aj||"internal_node"}}function gO(t,al){for(var ah,ak=bo(t),aj={},af=0,ap=ak.length;ap>af;af++){for(var ad=ak[af],am=ad.ids,aa=Math.max(0,am.length-al),ac={pos:ad.pos+aa,ids:hB(am,aa)},ag=0;aa>ag;ag++){var ab=ad.pos+ag+"-"+am[ag].id;aj[ab]=!0}ah=ah?gs(ah,ac,!0).tree:[ac]}return gf(ah,function(au,av,aq){delete aj[av+"-"+aq]}),{tree:ah,revs:Object.keys(aj)}}function iv(ac,t,aa){var ad=gs(ac,t),ab=gO(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function hR(ag,ad){for(var aj,aa=ag.slice(),ak=ad.split("-"),ah=parseInt(ak[0],10),af=ak[1];aj=aa.pop();){if(aj.pos===ah&&aj.ids[0]===af){return !0}for(var ac=aj.ids[2],ab=0,t=ac.length;t>ab;ab++){aa.push({pos:aj.pos+1,ids:ac[ab]})}}return !1}function g0(t){return t.ids}function gz(ac,t){t||(t=iT(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(g0);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function w(t){return/^_local/.test(t)}function jE(t){return jC("return "+t+";",{})}function hU(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function hF(ab,t){try{ab.emit("change",t)}catch(aa){h2("error",'Error in .on("change", function):',aa)}}function iD(ab,ad,ag){function ac(){aa.cancel()}i5.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?fp(ad):{};var t=ad.complete=gC(function(aj,ah){aj?hE(aa,"error")>0&&aa.emit("error",aj):aa.emit("complete",ah),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(hF(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new gi(function(aj,ah){ad.complete=function(al,ak){al?ah(al):aj(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function g6(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=l(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return gz(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=jo(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function di(aa,t){return t>aa?-1:aa>t?1:0}function fq(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function iM(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function E(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=cn(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gA(ac,t){var aa=di(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return di(ad,ab)}function jw(ab){var t={},aa=[];return gf(ab,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(t[ah]=0),void 0!==ag&&aa.push({from:ag,to:ah}),ah}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function im(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return gi.all(ad.map(function(af){var ag=gm.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new gi(function(aj,ah){ac._allDocs(ag,function(ak,al){return ak?ah(ak):(ab.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function ct(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),g9.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&ct(t)})})})}function hn(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function hs(){i5.EventEmitter.call(this)}function gh(){this.isReady=!1,this.failed=!1,this.queue=[]}function iy(t){t&&g5.debug&&h2("error",t)}function fa(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function eu(ab,ad,ag){if(!(this instanceof eu)){return new eu(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=iy}else{var aa=ag;ag=function(){return h2("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=fp(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=eu.prefix,hs.call(ac),ac.taskqueue=new gh;var af=new gi(function(al,aj){ag=function(ap,am){return ap?aj(ap):(delete am.then,void al(am))},ad=fp(ad);var ak,ah;return function(){try{if("string"!=typeof ab){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}var ap=(ad.prefix||"")+ab;if(ak=eu.parseAdapter(ap,ad),ad.originalName=ab,ad.name=ak.name,ad.adapter=ad.adapter||ak.adapter,ac._adapter=ad.adapter,jm("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!eu.adapters[ad.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!eu.adapters[ad.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ac.taskqueue.fail(am)}}(),ah?aj(ah):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void eu.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(fa(ac,ad),ac.emit("created",ac),eu.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function iO(aa){Object.keys(i5.EventEmitter.prototype).forEach(function(ab){"function"==typeof i5.EventEmitter.prototype[ab]&&(aa[ab]=hG[ab].bind(hG))});var t=aa._destructionListeners=new hK.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function jB(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function Y(t){if(!/^\d+\-./.test(t)){return gM(fX)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function a9(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function fv(ag,ad){var aj,aa,ak,ah={status:"available"};if(ag._deleted&&(ah.deleted=!0),ad){if(ag._id||(ag._id=a3()),aa=a3(32,16).toLowerCase(),ag._rev){if(ak=Y(ag._rev),ak.error){return ak}ag._rev_tree=[{pos:ak.prefix,ids:[ak.id,{status:"missing"},[[aa,ah,[]]]]}],aj=ak.prefix+1}else{ag._rev_tree=[{pos:1,ids:[aa,ah,[]]}],aj=1}}else{if(ag._revisions&&(ag._rev_tree=a9(ag._revisions,ah),aj=ag._revisions.start,aa=ag._revisions.ids[0]),!ag._rev_tree){if(ak=Y(ag._rev),ak.error){return ak}aj=ak.prefix,aa=ak.id,ag._rev_tree=[{pos:aj,ids:[aa,ah,[]]}]}}iC(ag._id),ag._rev=aj+"-"+aa;var af={metadata:{},data:{}};for(var ac in ag){if(Object.prototype.hasOwnProperty.call(ag,ac)){var ab="_"===ac[0];if(ab&&!iV[ac]){var t=gM(at,ac);throw t.message=at.message+": "+ac,t}ab&&!gt[ac]?af.metadata[ac.slice(1)]=ag[ac]:af.data[ac]=ag[ac]}}return af}function gd(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function jA(t){return gu(gd(t))}function bn(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function ci(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function O(aa,t){return bn([ci(aa)],{type:t})}function ih(aa,t){return O(iB(aa),t)}function gy(t,ab){if("undefined"==typeof FileReader){return ab(gd((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(gd(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function jq(aa,t){gy(aa,function(ab){t(gu(ab))})}function i3(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function fx(t){return gu(t)}function hH(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function hA(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function a7(ag,ad){function aj(){var aq=ac*ah,al=aq+ah;if(ac++,af>ac){t(ab,ag,aq,al),fm(aj)}else{t(ab,ag,aq,al);var ap=ab.end(!0),am=fx(ap);ad(am),ab.destroy()}}var aa="string"==typeof ag,ak=aa?ag.length:ag.byteLength,ah=Math.min(iU,ak),af=Math.ceil(ak/ah),ac=0,ab=aa?new hx:new hx.ArrayBuffer,t=aa?hA:hH;aj()}function gI(t){return hx.hash(t)}function a8(af,ad,ac){function ab(al){try{return iB(al)}catch(aj){var ak=gM(hl,"Attachment is not a valid base64 string");return{error:ak}}}function t(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ab(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ad?aj.data=O(al,aj.content_type):"base64"===ad?aj.data=gu(al):aj.data=al,a7(al,function(am){aj.digest="md5-"+am,ak()})}else{i3(aj.data,function(am){"binary"===ad?aj.data=gd(am):"base64"===ad&&(aj.data=jA(am)),a7(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ah(){ag++,af.length===ag&&(aa?ac(aa):ac())}if(!af.length){return ac()}var aa,ag=0;af.forEach(function(ak){function am(aq){aa=aq,al++,al===aj.length&&ah()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ah()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&t(ak.data._attachments[ap],am)}})}function hL(az,ah,am,ab,ak,aw,aj,ay){if(hR(ah.rev_tree,am.metadata.rev)){return ab[ak]=am,aw()}var ag=ah.winningRev||iT(ah),au="deleted" in ah?ah.deleted:gz(ah,ag),ad="deleted" in am.metadata?am.metadata.deleted:gz(am.metadata),aq=/^1-/.test(am.metadata.rev);if(au&&!ad&&ay&&aq){var aA=am.data;aA._rev=ag,aA._id=am.metadata.id,am=fv(aA,ay)}var ax=iv(ah.rev_tree,am.metadata.rev_tree[0],az),ac=ay&&(au&&ad||!au&&"new_leaf"!==ax.conflicts||au&&!ad&&"new_branch"===ax.conflicts);if(ac){var t=gM(h5);return ab[ak]=t,aw()}var av=am.metadata.rev;am.metadata.rev_tree=ax.tree,am.stemmedRevs=ax.stemmedRevs||[],ah.rev_map&&(am.metadata.rev_map=ah.rev_map);var aa,af=iT(am.metadata),ap=gz(am.metadata,af),al=au===ap?0:ap>au?-1:1;aa=av===af?ap:gz(am.metadata,av),aj(am,af,ap,aa,!0,al,ak,aw)}function S(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jn(ak,ad,aa,aj,af,aq,ah,ac,au){function am(aw,aA,aC){var ay=iT(aw.metadata),az=gz(aw.metadata,ay);if("was_delete" in ac&&az){return aq[aA]=gM(gW,"deleted"),aC()}var av=ag&&S(aw);if(av){var ax=gM(h5);return aq[aA]=ax,aC()}var aB=az?0:1;ah(aw,ay,az,az,!1,aB,aA,aC)}function ap(){++al===ab&&au&&au()}ak=ak||1000;var ag=ac.new_edits,t=new hK.Map,al=0,ab=ad.length;ad.forEach(function(aw,ay){if(aw._id&&w(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aa[ax](aw,{ctx:af},function(aA,az){aq[ay]=aA||az,ap()})}var av=aw.metadata.id;t.has(av)?(ab--,t.get(av).push([aw,ay])):t.set(av,[[aw,ay]])}),t.forEach(function(ay,aw){function ax(){++az<ay.length?av():ap()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(aj.has(aw)){hL(ak,aj.get(aw),aA,aq,aB,ax,ah,ag)}else{var aD=iv([],aA.metadata.rev_tree[0],ak);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],am(aA,aB,ax)}}var az=0;av()})}function jc(aa){try{return JSON.parse(aa)}catch(t){return i8.parse(aa)}}function fh(t){return t.length<50000?JSON.parse(t):jc(t)}function H(aa){try{return JSON.stringify(aa)}catch(t){return i8.stringify(aa)}}function z(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function iJ(aa){if(!ff.running&&ff.queue.length){ff.running=!0;var t=ff.queue.shift();t.action(function(ac,ab){z(t.callback,this,[ac,ab],aa),ff.running=!1,g9.nextTick(function(){iJ(aa)})})}}function jl(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gM(g3,aa,ab.type))}}function i2(ab,t,aa){return{data:H(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function hz(aa){if(!aa){return null}var t=fh(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function I(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function g4(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:ih(t,ab):bn([""],{type:ab})):t?"string"!=typeof t?gy(t,function(ad){aa(gu(ad))}):aa(t):aa("")}function hv(af,ad,ac,ab){function t(){++ag===aa.length&&ab&&ab()}function ah(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ac.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,t()}}var aa=Object.keys(af._attachments||{});if(!aa.length){return ab&&ab()}var ag=0;aa.forEach(function(aj){ad.attachments&&ad.include_docs?ah(af,aj):(af._attachments[aj].stub=!0,t())})}function ix(aa,t){return gi.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return gi.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new gi(function(aj){g4(ah,af,t,function(ak){ac.doc._attachments[ag]=gm.extend(cn(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function jD(ag,ad,aj){function aa(){t--,t||ak()}function ak(){ah.length&&ah.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ac["delete"](am)}})}var ah=[],af=aj.objectStore(h8),ac=aj.objectStore(gr),ab=aj.objectStore(hQ),t=ag.length;ag.forEach(function(al){var am=af.index("_doc_id_rev"),ap=ad+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return aa()}af["delete"](aq);var au=ab.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];ah.push(ay),ab["delete"](ax.primaryKey),ax["continue"]()}else{aa()}}}})}function hf(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function hN(aj,ax,au,aF,aG,ap,az){function aJ(){var aN=[g2,h8,gr,hp,hQ],aO=hf(aG,aN,"readwrite");return aO.error?az(aO.error):(av=aO.txn,av.onabort=jl(az),av.ontimeout=jl(az),av.oncomplete=aB,ah=av.objectStore(g2),al=av.objectStore(h8),aC=av.objectStore(gr),ak=av.objectStore(hQ),void aM(function(aP){return aP?(aw=!0,az(aP)):void aL()}))}function am(){jn(aj.revs_limit,ac,aF,t,av,ab,ay,au)}function aL(){function aP(){++aN===ac.length&&am()}function aR(aU){var aV=hz(aU.target.result);aV&&t.set(aV.id,aV),aP()}if(ac.length){for(var aN=0,aQ=0,aO=ac.length;aO>aQ;aQ++){var aS=ac[aQ];if(aS._id&&w(aS._id)){aP()}else{var aT=ah.get(aS.metadata.id);aT.onsuccess=aR}}}}function aB(){aw||(ap.notify(aF._meta.name),aF._meta.docCount+=aA,az(null,ab))}function aI(aO,aP){var aN=aC.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=gM(fo,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(ac.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aI(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function ay(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aH(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bc){var ba=aP.stemmedRevs||[];aV&&aF.auto_compaction&&(ba=ba.concat(gk(aP.metadata))),ba&&ba.length&&jD(ba,aP.metadata.id,av),aT.seq=bc.target.result,delete aT.rev;var bb=i2(aT,aW,aU),aZ=ah.put(bb);aZ.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=al.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=al.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ab[aS]={ok:!0,id:aT.id,rev:aW},t.set(aP.metadata.id,aP.metadata),aD(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=al.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aH(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;ag(ba,bb,aV)}})}function aD(aP,aS,aN){function aQ(){++aT===aU.length&&aN()}function aO(aX){var aV=aP.data._attachments[aX].digest,aW=ak.put({seq:aS,digestSeq:aV+"::"+aS});aW.onsuccess=aQ,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aQ()}}var aT=0,aU=Object.keys(aP.data._attachments||{});if(!aU.length){return aN()}for(var aR=0;aR<aU.length;aR++){aO(aU[aR])}}function ag(aO,aQ,aN){var aP=aC.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=aC.put(aU);aR.onsuccess=aN}}for(var av,ah,al,aC,ak,aE,ac=ax.docs,aA=0,aq=0,af=ac.length;af>aq;aq++){var aa=ac[aq];aa._id&&w(aa._id)||(aa=ac[aq]=fv(aa,au.new_edits),aa.error&&!aE&&(aE=aa))}if(aE){return az(aE)}var ab=new Array(ac.length),t=new hK.Map,aw=!1,aK=aF._meta.blobSupport?"blob":"base64";a8(ac,aK,function(aN){return aN?az(aN):void aJ()})}function hT(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function jk(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(gM(g3,ac.name,ac.message))}function ja(ac,t,aa,ad){function ab(aC,ax){function al(aL,aM,aK){var aN=aL.id+"::"+aK;az.get(aN).onsuccess=function(aO){aM.doc=I(aO.target.result),aC.conflicts&&(aM.doc._conflicts=jo(aL)),hv(aM.doc,aC,au)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===aC.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):aC.include_docs&&al(aK,aM,aO)}else{if(!aN&&aq--<=0&&(aJ.push(aM),aC.include_docs&&al(aK,aM,aO),0===--ah)){return}}aL["continue"]()}function aE(aK){ag=t._meta.docCount;var aM=aK.target.result;if(aM){var aL=hz(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function ay(){ax(null,{total_rows:ag,offset:aC.skip,rows:aJ})}function aG(){aC.attachments?ix(aJ,aC.binary).then(ay):ay()}var aj="startkey" in aC?aC.startkey:!1,am="endkey" in aC?aC.endkey:!1,aD="key" in aC?aC.key:!1,aq=aC.skip||0,ah="number"==typeof aC.limit?aC.limit:-1,aA=aC.inclusive_end!==!1,aH="descending" in aC&&aC.descending?"prev":null,aw=hT(aj,am,aA,aD,aH);if(aw&&aw.error){return jk(t,aC,aw.error,ax)}var aB=[g2,h8];aC.attachments&&aB.push(gr);var ak=hf(aa,aB,"readonly");if(ak.error){return ax(ak.error)}var au=ak.txn,aI=au.objectStore(g2),ap=au.objectStore(h8),aF=aH?aI.openCursor(aw,aH):aI.openCursor(aw),az=ap.index("_doc_id_rev"),aJ=[],ag=0;au.oncomplete=aG,aF.onsuccess=aE}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:t._meta.docCount,offset:ah.skip,rows:[]}):void ab(ah,ag)}af(ac,ad)}function ib(t){return new gi(function(ab){var aa=bn([""]);t.objectStore(jf).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function Z(ab,t){var aa=this;ff.queue.push({action:function(ac){jy(aa,ab,ac)},callback:t}),iJ(aa.constructor)}function jy(ag,af,aa){function ap(au){var av=au.createObjectStore(g2,{keyPath:"id"});au.createObjectStore(h8,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gr,{keyPath:"digest"}),au.createObjectStore(gH,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jf),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(hp,{keyPath:"_id"});var aw=au.createObjectStore(hQ,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function am(au,av){var aw=au.objectStore(g2);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=gz(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ab(au){au.createObjectStore(hp,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ah(ax,av){var aw=ax.objectStore(hp),az=ax.objectStore(g2),ay=ax.objectStore(h8),au=az.openCursor();au.onsuccess=function(aJ){var aA=aJ.target.result;if(aA){var aG=aA.value,aD=aG.id,aE=w(aD),aH=iT(aG);if(aE){var aK=aD+"::"+aH,aB=aD+"::",aI=aD+"::~",aL=ay.index("_doc_id_rev"),aC=IDBKeyRange.bound(aB,aI,!1,!1),aF=aL.openCursor(aC);aF.onsuccess=function(aN){if(aF=aN.target.result){var aM=aF.value;aM._doc_id_rev===aK&&aw.put(aM),ay["delete"](aF.primaryKey),aF["continue"]()}else{az["delete"](aA.primaryKey),aA["continue"]()}}}else{aA["continue"]()}}else{av&&av()}}}function al(au){var av=au.createObjectStore(hQ,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(ax,av){var aw=ax.objectStore(h8),az=ax.objectStore(gr),ay=ax.objectStore(hQ),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aD){var aH=aD.target.result;if(!aH){return av()}for(var aI=aH.value,aF=aH.primaryKey,aL=Object.keys(aI._attachments||{}),aJ={},aK=0;aK<aL.length;aK++){var aC=aI._attachments[aL[aK]];aJ[aC.digest]=!0}var aE=Object.keys(aJ);for(aK=0;aK<aE.length;aK++){var aG=aE[aK];ay.put({seq:aF,digestSeq:aG+"::"+aF})}aH["continue"]()}):av()}}function ad(av){function au(az){return az.data?hz(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(h8),ax=av.objectStore(g2),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=i2(az,az.winningRev,az.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=au(aA.value);return az.winningRev=az.winningRev||iT(az),az.seq?aD():void aB()}}}var aq=af.name,ac=null;ag._meta=null,ag.type=function(){return"idb"},ag._id=fU(function(au){au(null,ag._meta.instanceId)}),ag._bulkDocs=function(aw,av,au){hN(af,aw,av,ag,ac,T,au)},ag._get=function(au,az,aA){function aw(){aA(aC,{doc:av,metadata:ax,ctx:ay})}var av,ax,aC,ay=az.ctx;if(!ay){var aB=hf(ac,[g2,h8,gr],"readonly");if(aB.error){return aA(aB.error)}ay=aB.txn}ay.objectStore(g2).get(au).onsuccess=function(aG){if(ax=hz(aG.target.result),!ax){return aC=gM(gW,"missing"),aw()}if(gz(ax)&&!az.rev){return aC=gM(gW,"deleted"),aw()}var aE=ay.objectStore(h8),aD=az.rev||ax.winningRev,aF=ax.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return av=aH.target.result,av&&(av=I(av)),av?void aw():(aC=gM(gW,"missing"),aw())}}},ag._getAttachment=function(au,az,aA,aw,av){var ax;if(aw.ctx){ax=aw.ctx}else{var aC=hf(ac,[g2,h8,gr],"readonly");if(aC.error){return av(aC.error)}ax=aC.txn}var ay=aA.digest,aB=aA.content_type;ax.objectStore(gr).get(ay).onsuccess=function(aE){var aD=aE.target.result.body;g4(aD,aB,aw.binary,function(aF){av(null,aF)})}},ag._info=function(av){if(null===ac||!hD.has(aq)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,aw,au=hf(ac,[h8],"readonly");if(au.error){return av(au.error)}var ay=au.txn,ax=ay.objectStore(h8).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,aw=ag._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:az,idb_attachment_format:ag._meta.blobSupport?"binary":"base64"})}},ag._allDocs=function(av,au){ja(av,ag,ac,au)},ag._changes=function(ax){function az(aS){function aM(){return aN.seq!==aR?aS["continue"]():(au=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aD.get(aU);aT.onsuccess=function(aV){aO(I(aV.target.result))}}function aO(aU){var aT=ax.processChange(aU,aN,ax);aT.seq=aN.seq;var aV=aA(aT);return"object"==typeof aV?ax.complete(aV):(aV&&(av++,aG&&aE.push(aT),ax.attachments&&ax.include_docs?hv(aU,ax,aH,function(){ix([aT],ax.binary).then(function(){ax.onChange(aT)})}):ax.onChange(aT)),void (av!==aB&&aS["continue"]()))}var aQ=I(aS.value),aR=aS.key;if(aJ&&!aJ.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aC.get(aQ._id).onsuccess=function(aT){aN=hz(aT.target.result),ay.set(aQ._id,aN),aM()})}function aw(aN){var aM=aN.target.result;aM&&az(aM)}function aI(){var aM=[g2,h8];ax.attachments&&aM.push(gr);var aN=hf(ac,aM,"readonly");if(aN.error){return ax.complete(aN.error)}aH=aN.txn,aH.onabort=jl(ax.complete),aH.oncomplete=aL,aK=aH.objectStore(h8),aC=aH.objectStore(g2),aD=aK.index("_doc_id_rev");var aO;aO=ax.descending?aK.openCursor(null,"prev"):aK.openCursor(IDBKeyRange.lowerBound(ax.since,!0)),aO.onsuccess=aw}function aL(){function aM(){ax.complete(null,{results:aE,last_seq:au})}!ax.continuous&&ax.attachments?ix(aE).then(aM):aM()}if(ax=fp(ax),ax.continuous){var aF=aq+":"+a3();return T.addListener(aq,aF,ag,ax),T.notify(aq),{cancel:function(){T.removeListener(aq,aF)}}}var aJ=ax.doc_ids&&new hK.Set(ax.doc_ids);ax.since=ax.since||0;var au=ax.since,aB="limit" in ax?ax.limit:-1;0===aB&&(aB=1);var aG;aG="return_docs" in ax?ax.return_docs:"returnDocs" in ax?ax.returnDocs:!0;var aH,aK,aC,aD,aE=[],av=0,aA=iS(ax),ay=new hK.Map;aI()},ag._close=function(au){return null===ac?au(gM(ju)):(ac.close(),hD["delete"](aq),ac=null,void au())},ag._getRevisionTree=function(av,au){var aw=hf(ac,[g2],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(g2).get(av);ay.onsuccess=function(aA){var az=hz(aA.target.result);az?au(null,az.rev_tree):au(gM(gW))}},ag._doCompaction=function(aA,av,aw){var ax=[g2,h8,gr,hQ],az=hf(ac,ax,"readwrite");if(az.error){return aw(az.error)}var au=az.txn,ay=au.objectStore(g2);ay.get(aA).onsuccess=function(aC){var aE=hz(aC.target.result);gf(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),jD(av,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(g2).put(i2(aE,aD,aB))},au.onabort=jl(aw),au.oncomplete=function(){aw()}},ag._getLocal=function(av,au){var aw=hf(ac,[hp],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(hp).get(av);ay.onerror=jl(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(gM(gW))}},ag._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hf(ac,[hp],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=jl(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(hp);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(gM(h5))}}):(au=ax.add(ay),au.onerror=function(aE){av(gM(h5)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ag._removeLocal=function(au,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.ctx;if(!aw){var av=hf(ac,[hp],"readwrite");if(av.error){return aA(av.error)}aw=av.txn,aw.oncomplete=function(){ax&&aA(null,ax)}}var ax,aC=au._id,ay=aw.objectStore(hp),aB=ay.get(aC);aB.onerror=jl(aA),aB.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===au._rev?(ay["delete"](aC),ax={ok:!0,id:aC,rev:"0-0"},az.ctx&&aA(null,ax)):aA(gM(gW))}},ag._destroy=function(aw,au){T.removeAllListeners(aq);var av=f.get(aq);av&&av.result&&(av.result.close(),hD["delete"](aq));var ax=indexedDB.deleteDatabase(aq);ax.onsuccess=function(){f["delete"](aq),fd()&&aq in localStorage&&delete localStorage[aq],au(null,{ok:!0})},ax.onerror=jl(au)};var aj=hD.get(aq);if(aj){return ac=aj.idb,ag._meta=aj.global,void g9.nextTick(function(){aa(null,ag)})}var t;t=af.storage?iI(aq,af.storage):indexedDB.open(aq,gv),f.set(aq,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return ap(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&ab(az),av.oldVersion<4&&al(az);var ay=[am,ah,ak,ad],au=av.oldVersion;ax()},t.onsuccess=function(az){ac=az.target.result,ac.onversionchange=function(){ac.close(),hD["delete"](aq)},ac.onabort=function(aA){h2("error","Database has a global failure",aA.target.error),ac.close(),hD["delete"](aq)};var aw=ac.transaction([gH,jf,g2],"readwrite"),ay=aw.objectStore(gH).get(gH),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(ag._meta={name:aq,instanceId:au,blobSupport:av,docCount:ax},hD.set(aq,{idb:ac,global:ag._meta}),aa(null,ag))},aA=aB.target.result||{id:gH};aq+"_id" in aA?(au=aA[aq+"_id"],aD()):(au=a3(),aA[aq+"_id"]=au,aw.objectStore(gH).put(aA).onsuccess=function(){aD()}),q||(q=ib(aw)),q.then(function(aE){av=aE,aD()});var aC=aw.objectStore(g2).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";h2("error",au),aa(gM(g3,au))}}function iI(ab,t){try{return indexedDB.open(ab,{version:gv,storage:t})}catch(aa){return indexedDB.open(ab,gv)}}function jv(t){t.adapter("idb",Z,!0)}function jx(t){return decodeURIComponent(escape(t))}function hW(t){return 65>t?t-48:t-55}function ji(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hW(t.charCodeAt(ab++))<<4|hW(t.charCodeAt(ab++)))}return aa}function gj(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hW(t.charCodeAt(ab+2))<<12|hW(t.charCodeAt(ab+3))<<8|hW(t.charCodeAt(ab))<<4|hW(t.charCodeAt(ab+1))),ab+=4}return aa}function ig(aa,t){return"UTF-8"===t?jx(ji(aa,0,aa.length)):gj(aa,0,aa.length)}function it(t){return"'"+t+"'"}function hq(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hX(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function iH(t){return delete t._id,delete t._rev,JSON.stringify(t)}function id(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function ft(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function iR(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function iw(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+a6+" WHERE seq IN "+ft(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+a6+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+a6+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new hK.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+a6+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+fl+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(aj){var ah="SELECT seq FROM "+hJ+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ad,aj],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+hJ+" WHERE seq=?",[ak],ac)})})}}function a2(t){return function(ad){h2("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gM(ht,ab,ac))}}function gn(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function js(aj,t,aB,av,au,ay,ad){function ax(){return am?ad(am):(ay.notify(av._name),av._docCount=-1,void ad(null,ac))}function aa(aD,aE){var aC="SELECT count(*) as cnt FROM "+fl+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gM(fo,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function al(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aa(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ak(aD,aK,aP,aF,aH,aN,aI,aL){function aQ(){function aS(bc,bb){function ba(){return ++bg===bd.length&&bb(),!1}function aZ(bj){var bi="INSERT INTO "+a6+" (digest, seq) VALUES (?,?)",bh=[aT._attachments[bj].digest,bc];ap.executeSql(bi,bh,ba,ba)}var bg=0,bd=Object.keys(aT._attachments||{});if(!bd.length){return bb()}for(var bf=0;bf<bd.length;bf++){aZ(bd[bf])}}var aT=aD.data,aY=aF?1:0,aV=aT._id,aR=aT._rev,aX=iH(aT),aW="INSERT INTO "+hJ+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aU=[aV,aR,aX,aY];ap.executeSql(aW,aU,function(ba,bb){var aZ=bb.insertId;aS(aZ,function(){aC(ba,aZ)})},function(){var aZ=iR("seq",hJ,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aV,aR],function(bc,bb){var bf=bb.rows.item(0).seq,bd="UPDATE "+hJ+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aX,aY,aV,aR];bc.executeSql(bd,ba,function(bg){aS(bf,function(){aC(bg,bf)})})}),!1})}function aE(aR){aG||(aR?(aG=aR,aL(aG)):aM===aO.length&&aQ())}function aJ(aR){aM++,aE(aR)}function aC(aU,aV){var aS=aD.metadata.id,aT=aD.stemmedRevs||[];aH&&av.auto_compaction&&(aT=gk(aD.metadata).concat(aT)),aT.length&&iw(aT,aS,aU),aD.metadata.seq=aV,delete aD.metadata.rev;var aR=aH?"UPDATE "+i0+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+hJ+" WHERE doc_id="+i0+".id AND rev=?) WHERE id=?":"INSERT INTO "+i0+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aX=H(aD.metadata),aW=aH?[aX,aV,aK,aS]:[aS,aV,aV,aX];aU.executeSql(aR,aW,function(){ac[aI]={ok:!0,id:aD.metadata.id,rev:aK},ah.set(aS,aD.metadata),aL()})}var aG=null,aM=0;aD.data._id=aD.metadata.id,aD.data._rev=aD.metadata.rev;var aO=Object.keys(aD.data._attachments||{});aF&&(aD.data._deleted=!0),aO.forEach(function(aU){var aS=aD.data._attachments[aU];if(aS.stub){aM++,aE()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aK,10);var aT=aS.digest;aA(aT,aR,aJ)}}),aO.length||aQ()}function af(){jn(aj.revs_limit,aq,av,ah,ap,ac,ak,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&w(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+i0+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=fh(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function aA(aD,aF,aC){var aE="SELECT digest FROM "+fl+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+fl+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,hq(aF)],function(){aC()},function(){return aC(),!1}))})}var ag=aB.new_edits,ab=t.docs,aq=ab.map(function(aC){if(aC._id&&w(aC._id)){return aC}var aD=fv(aC,ag);return aD}),aw=aq.filter(function(aC){return aC.error});if(aw.length){return ad(aw[0])}var ap,am,ac=new Array(aq.length),ah=new hK.Map;a8(aq,"binary",function(aC){return aC?ad(aC):void au.transaction(function(aD){ap=aD,al(function(aE){aE?am=aE:az(af)})},a2(ad),ax)})}function gQ(t){return t.websql(t.name,t.version,t.description,t.size)}function ir(aa){try{return{db:gQ(aa)}}catch(t){return{error:t}}}function ie(aa){var t=gq.get(aa.name);return t||(t=ir(aa),gq.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function hk(aj,ag,t,ac,aa){function ah(){++ab===ad.length&&aa&&aa()}function af(am,ak){var al=am._attachments[ak],ap={binary:ag.binary,ctx:ac};t._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=gm.extend(cn(al,["digest","content_type"]),{data:au}),ah()})}var ad=Object.keys(aj._attachments||{});if(!ad.length){return aa&&aa()}var ab=0;ad.forEach(function(ak){ag.attachments&&ag.include_docs?af(aj,ak):(aj._attachments[ak].stub=!0,ah())})}function a4(ak,aB){function ah(){fd()&&(window.localStorage["_pouch__websqldb_"+aa._name]=!0),aB(null,aa)}function az(aD,aE){aD.executeSql(il),aD.executeSql("ALTER TABLE "+hJ+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(iL),aD.executeSql("ALTER TABLE "+i0+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+i0+" (local, id)");var aF="SELECT "+i0+".winningseq AS seq, "+i0+".json AS metadata FROM "+hJ+" JOIN "+i0+" ON "+hJ+".seq = "+i0+".winningseq";aD.executeSql(aF,[],function(aM,aI){for(var aN=[],aK=[],aJ=0;aJ<aI.rows.length;aJ++){var aH=aI.rows.item(aJ),aG=aH.seq,aL=JSON.parse(aH.metadata);gz(aL)&&aN.push(aG),w(aL.id)&&aK.push(aL.id)}aM.executeSql("UPDATE "+i0+"SET local = 1 WHERE id IN "+ft(aK.length),aK,function(){aM.executeSql("UPDATE "+hJ+" SET deleted = 1 WHERE seq IN "+ft(aN.length),aN,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+i9+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+i0+".id AS id, "+hJ+".json AS data FROM "+hJ+" JOIN "+i0+" ON "+hJ+".seq = "+i0+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+i9+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+i0+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+hJ+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function av(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aN=aI.shift(),aJ=ig(aN.hex,aC),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+hJ+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aH()})}aH()}var aF="ALTER TABLE "+hJ+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+hJ+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(B,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+hJ;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function aj(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+fl;aH.executeSql(aI,[],function(aO,aM){function aJ(){var aP=iR(jr+", "+i0+".id AS id",[i0,hJ],jh,null,i0+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aU){function aZ(bc,bd){var bf=aS[bc]=aS[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aU.rows.length){return aG(ba)}for(var aS={},aX=0;aX<aU.rows.length;aX++){for(var aV=aU.rows.item(aX),aW=id(aV.data,aV.id,aV.rev),aQ=Object.keys(aW._attachments||{}),aY=0;aY<aQ.length;aY++){var aT=aW._attachments[aQ[aY]];aZ(aT.digest,aV.seq)}}var aR=[];if(Object.keys(aS).forEach(function(bc){var bd=aS[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aJ()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+a6+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+a6+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(hV,[],function(aI){aI.executeSql(hh,[],aD)})})}function ag(aE,aF){var aD="ALTER TABLE "+fl+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+i0+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+i0+" SET max_seq=(SELECT MAX(seq) FROM "+hJ+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+i0+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ab(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;aC=2===aG.length?"UTF-8":"UTF-16",aE()})}function am(){for(;af.length>0;){var aD=af.pop();aD(null,al)}}function ac(aD,aH){if(0===aH){var aK="CREATE TABLE IF NOT EXISTS "+J+" (dbid, db_version INTEGER)",aN="CREATE TABLE IF NOT EXISTS "+fl+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aE="CREATE TABLE IF NOT EXISTS "+a6+" (digest, seq INTEGER)",aG="CREATE TABLE IF NOT EXISTS "+i0+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aF="CREATE TABLE IF NOT EXISTS "+hJ+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aL="CREATE TABLE IF NOT EXISTS "+i9+" (id UNIQUE, rev, json)";aD.executeSql(aN),aD.executeSql(aL),aD.executeSql(aE,[],function(){aD.executeSql(hh),aD.executeSql(hV)}),aD.executeSql(aG,[],function(){aD.executeSql(il),aD.executeSql(aF,[],function(){aD.executeSql(iL),aD.executeSql(B),aD.executeSql(aK,[],function(){var aP="INSERT INTO "+J+" (db_version, dbid) VALUES (?,?)";al=a3();var aQ=[o,al];aD.executeSql(aP,aQ,function(){am()})})})})}else{var aJ=function(){var aQ=o>aH;aQ&&aD.executeSql("UPDATE "+J+" SET db_version = "+o);var aP="SELECT dbid FROM "+J;aD.executeSql(aP,[],function(aR,aS){al=aS.rows.item(0).dbid,am()})},aM=[az,aq,av,aj,ag,ap,aJ],aO=aH,aI=function(aP){aM[aO-1](aP,aI),aO++};aI(aD)}}function aw(){ax.transaction(function(aD){ab(aD,function(){ad(aD)})},a2(aB),ah)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+J;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+J,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;ac(aJ,aI)}):aF.executeSql("ALTER TABLE "+J+" ADD COLUMN db_version INTEGER",[],function(){ac(aF,1)}):ac(aF,0)})}function au(aE,aF){if(-1!==aa._docCount){return aF(aa._docCount)}var aD=iR("COUNT("+i0+".id) AS 'num'",[i0,hJ],jh,hJ+".deleted=0");aE.executeSql(aD,[],function(aG,aH){aa._docCount=aH.rows.item(0).num,aF(aa._docCount)})}var aC,aa=this,al=null,ay=gn(ak),af=[];aa._docCount=-1,aa._name=ak.name;var t=gm.extend({},ak,{version:ce,description:ak.name,size:ay}),aA=ie(t);if(aA.error){return a2(aB)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),aw(),aa.type=function(){return"websql"},aa._id=fU(function(aD){aD(null,al)}),aa._info=function(aD){ax.readTransaction(function(aE){au(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+hJ;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:ax._sqlitePlugin,websql_encoding:aC})})})},a2(aD))},aa._bulkDocs=function(aF,aD,aE){js(ak,aF,aD,aa,ax,h6,aE)},aa._get=function(aK,aJ,aM){function aF(){aM(aH,{doc:aE,metadata:aL,ctx:aD})}var aE,aL,aH,aD=aJ.ctx;if(!aD){return ax.readTransaction(function(aN){aa._get(aK,gm.extend({ctx:aN},aJ),aM)})}var aG,aI;aJ.rev?(aG=iR(jr,[i0,hJ],i0+".id="+hJ+".doc_id",[hJ+".doc_id=?",hJ+".rev=?"]),aI=[aK,aJ.rev]):(aG=iR(jr,[i0,hJ],jh,i0+".id=?"),aI=[aK]),aD.executeSql(aG,aI,function(aP,aO){if(!aO.rows.length){return aH=gM(gW,"missing"),aF()}var aN=aO.rows.item(0);return aL=fh(aN.metadata),aN.deleted&&!aJ.rev?(aH=gM(gW,"deleted"),aF()):(aE=id(aN.data,aL.id,aN.rev),void aF())})},aa._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(i0+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(i0+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(i0+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(i0+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(hJ+".deleted = 0"),ax.readTransaction(function(aR){au(aR,function(aT){if(aM=aT,0!==aO){var aS=iR(jr,[i0,hJ],jh,aE,i0+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aV,bb){for(var bc=0,aY=bb.rows.length;aY>bc;bc++){var aW=bb.rows.item(bc),aU=fh(aW.metadata),aZ=aU.id,aX=id(aW.data,aZ,aW.rev),ba=aX._rev,bd={id:aZ,key:aZ,value:{rev:ba}};if(aJ.include_docs&&(bd.doc=aX,bd.doc._rev=ba,aJ.conflicts&&(bd.doc._conflicts=jo(aU)),hk(bd.doc,aJ,aa,aV)),aW.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},a2(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},aa._changes=function(aF){function aE(){var aN=i0+".json AS metadata, "+i0+".max_seq AS maxSeq, "+hJ+".json AS winningDoc, "+hJ+".rev AS winningRev ",aM=i0+" JOIN "+hJ,aO=i0+".id="+hJ+".doc_id AND "+i0+".winningseq="+hJ+".seq",aP=["maxSeq > ?"],aR=[aF.since];aF.doc_ids&&(aP.push(i0+".id IN "+ft(aF.doc_ids.length)),aR=aR.concat(aF.doc_ids));var aL="maxSeq "+(aI?"DESC":"ASC"),aS=iR(aN,aM,aO,aP,aL),aT=iS(aF);aF.view||aF.filter||(aS+=" LIMIT "+aD);var aQ=aF.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(bc,bb){function bd(bg){return function(){aF.onChange(bg)}}for(var aX=0,aY=bb.rows.length;aY>aX;aX++){var ba=bb.rows.item(aX),aZ=fh(ba.metadata);aQ=ba.maxSeq;var bf=id(ba.winningDoc,aZ.id,ba.winningRev),aV=aF.processChange(bf,aZ,aF);aV.seq=ba.maxSeq;var aW=aT(aV);if("object"==typeof aW){return aF.complete(aW)}if(aW&&(aJ++,aG&&aH.push(aV),aF.attachments&&aF.include_docs?hk(bf,aF,aa,bc,bd(aV)):bd(aV)()),aJ===aD){break}}})},a2(aF.complete),function(){aF.continuous||aF.complete(null,{results:aH,last_seq:aQ})})}if(aF=fp(aF),aF.continuous){var aK=aa._name+":"+a3();return h6.addListener(aa._name,aK,aa,aF),h6.notify(aa._name),{cancel:function(){h6.removeListener(aa._name,aK)}}}var aI=aF.descending;aF.since=aF.since&&!aI?aF.since:0;var aD="limit" in aF?aF.limit:-1;0===aD&&(aD=1);var aG;aG="return_docs" in aF?aF.return_docs:"returnDocs" in aF?aF.returnDocs:!0;var aH=[],aJ=0;aE()},aa._close=function(aD){aD()},aa._getAttachment=function(aK,aJ,aM,aF,aE){var aL,aH=aF.ctx,aD=aM.digest,aG=aM.content_type,aI="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+fl+" WHERE digest=?";aH.executeSql(aI,[aD],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hX(aO.body):ig(aO.body,aC);aL=aF.binary?O(aN,aG):gu(aN),aE(null,aL)})},aa._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+i0+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=fh(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(gM(gW))}})})},aa._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+i0+" WHERE id = ?";aH.executeSql(aG,[aE],function(aL,aJ){var aI=fh(aJ.rows.item(0).metadata);gf(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+i0+" SET json = ? WHERE id = ?";aL.executeSql(aK,[H(aI),aE])}),iw(aF,aE,aH)},a2(aD),function(){aD()}):aD()},aa._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+i9+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=id(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(gM(gW))}})})},aa._putLocal=function(aH,aD,aJ){function aL(aO){var aM,aN;aI?(aM="UPDATE "+i9+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aK,aE,aF,aI]):(aM="INSERT INTO "+i9+" (id, rev, json) VALUES (?,?,?)",aN=[aF,aK,aE]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aG={ok:!0,id:aF,rev:aK},aD.ctx&&aJ(null,aG)):aJ(gM(h5))},function(){return aJ(gM(h5)),!1})}"function"==typeof aD&&(aJ=aD,aD={}),delete aH._revisions;var aK,aI=aH._rev,aF=aH._id;aK=aI?aH._rev="0-"+(parseInt(aI.split("-")[1],10)+1):aH._rev="0-1";var aG,aE=iH(aH);aD.ctx?aL(aD.ctx):ax.transaction(aL,a2(aJ),function(){aG&&aJ(null,aG)})},aa._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+i9+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(gM(gW))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,a2(aH),function(){aD&&aH(null,aD)})},aa._destroy=function(aD,aE){h6.removeAllListeners(aa._name),ax.transaction(function(aF){var aG=[i0,hJ,fl,J,i9,a6];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},a2(aE),function(){fd()&&(delete window.localStorage["_pouch__websqldb_"+aa._name],delete window.localStorage[aa._name]),aE(null,{ok:!0})})}}function an(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function ha(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=fd(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=an();return ab&&(localStorage[t]=aa?"1":"0"),aa}function V(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:ha()}function jg(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=gm.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function L(t,ab){var ac=jg(t),aa=gm.extend({websql:ac},t);a4.call(this,aa,ab)}function ip(t){t.adapter("websql",L,!0)}function P(){for(var t={},ab=new gi(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,gi.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function hZ(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?i3(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=P(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function iz(aj,ag){var t,ac,aa=!1,ah=function(){t.abort()},af=function(){aa=!0,t.abort()};t=aj.xhr?new aj.xhr:new XMLHttpRequest;try{t.open(aj.method,aj.url)}catch(ad){ag(ad,{statusCode:413})}t.withCredentials="withCredentials" in aj?aj.withCredentials:!0,"GET"===aj.method?delete aj.headers["Content-Type"]:aj.json&&(aj.headers.Accept="application/json",aj.headers["Content-Type"]=aj.headers["Content-Type"]||"application/json",aj.body&&aj.processData&&"string"!=typeof aj.body&&(aj.body=JSON.stringify(aj.body))),aj.binary&&(t.responseType="arraybuffer"),"body" in aj||(aj.body=null);for(var ab in aj.headers){aj.headers.hasOwnProperty(ab)&&t.setRequestHeader(ab,aj.headers[ab])}return aj.timeout>0&&(ac=setTimeout(af,aj.timeout),t.onprogress=function(){clearTimeout(ac),4!==t.readyState&&(ac=setTimeout(af,aj.timeout))},"undefined"!=typeof t.upload&&(t.upload.onprogress=t.onprogress)),t.onreadystatechange=function(){if(4===t.readyState){var ak={statusCode:t.status};if(t.status>=200&&t.status<300){var am;am=aj.binary?bn([t.response||""],{type:t.getResponseHeader("Content-Type")}):t.responseText,ag(null,ak,am)}else{var ap={};if(aa){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(t.response)}catch(al){}}ag(ap,ak)}}},aj.body&&aj.body instanceof Blob?i3(aj.body,function(ak){t.send(ak)}):t.send(aj.body),{abort:ah}}function ar(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function g(aa,t){return hP||aa.xhr?iz(aa,t):hZ(aa,t)}function i6(){return""}function ev(ac,t){function aa(af,ag,aj){if(!ac.binary&&ac.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?jd(ak):ak})),ac.binary&&iK(af,ag),aj(null,af,ag)}function ad(al,ag){var aj,af;if(al.code&&al.status){var ak=new Error(al.message||al.code);return ak.status=al.status,ag(ak)}if(al.message&&"ETIMEDOUT"===al.message){return ag(al)}try{aj=JSON.parse(al.responseText),af=jd(aj)}catch(ah){af=jd(al)}ag(af)}ac=fp(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=gm.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),g(ac,function(ah,al,af){if(ah){return ah.status=al?al.statusCode:400,ad(ah,t)}var ak,am=al.headers&&al.headers["content-type"],ag=af||i6();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof ag&&(/json/.test(am)||/^[\s]*\{/.test(ag)&&/\}[\s]*$/.test(ag))){try{ag=JSON.parse(ag.toString())}catch(aj){}}al.statusCode>=200&&al.statusCode<300?aa(ag,al,t):(ak=jd(ag),ak.status=al.statusCode,t(ak))})}function ey(ag,ad){var aj=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aa=-1!==aj.indexOf("safari")&&-1===aj.indexOf("chrome"),ak=-1!==aj.indexOf("msie"),ah=-1!==aj.indexOf("edge"),af=aa||(ak||ah)&&"GET"===ag.method,ac="cache" in ag?ag.cache:!0,ab=/^blob:/.test(ag.url);if(!ab&&(af||!ac)){var t=-1!==ag.url.indexOf("?");ag.url+=(t?"&":"?")+"_nonce="+Date.now()}return ev(ag,ad)}function g7(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=ih(ab.data,ab.content_type)})}function gK(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function v(t){return t._attachments&&Object.keys(t._attachments)?gi.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new gi(function(ac){jq(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):gi.resolve()}function gY(ab){var t=R(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function gV(aa,t){return fT(aa,aa.db+"/"+t)}function fT(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function a0(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function r(aq,aj){function ah(ax,ay,aw){var aA=ax.ajax||{},az=gm.extend(fp(am),aA,ay);return jz(az.method+" "+az.url),ab._ajax(az,aw)}function ap(ax,aw){return new gi(function(az,ay){ah(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function ac(ax,aw){return fS(ax,hg(function(ay){ad().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ad(){if(aq.skipSetup||aq.skip_setup){return gi.resolve()}if(t){return t}var aw={method:"GET",url:af};return t=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(iu(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:af})):gi.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:gi.reject(ax)}),t["catch"](function(){t=null}),t}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,ak=gY;aq.getHost&&(ak=aq.getHost);var av=ak(aq.name,aq),af=gV(av,"");aq=fp(aq);var am=aq.ajax||{};if(ab.getUrl=function(){return af},ab.getHeaders=function(){return am.headers||{}},aq.auth||av.auth){var al=aq.auth||av.auth,au=al.username+":"+al.password,aa=gu(unescape(encodeURIComponent(au)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=ey;var t;setTimeout(function(){aj(null,ab)}),ab.type=function(){return"http"},ab.id=ac("id",function(aw){ah({},{method:"GET",url:fT(av,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+av.db:gV(av,"");aw(null,ay)})}),ab.request=ac("request",function(ax,aw){ax.url=gV(av,ax.url),ah({},ax,aw)}),ab.compact=ac("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=fp(ax),ah(ax,{url:gV(av,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ab.bulkGet=fS("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:gV(av,"_bulk_get"+a0(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aD(aK){return function(aM,aL){aH[aK]=aL.results,++aJ===aF&&aA(null,{results:dt(aH)})}}for(var aG=hb,aF=Math.ceil(aC.docs.length/aG),aJ=0,aH=new Array(aF),aI=0;aF>aI;aI++){var aE=cn(aC,["revs","attachments"]);aE.ajax=am,aE.docs=aC.docs.slice(aI*aG,Math.min(aC.docs.length,(aI+1)*aG)),ee(aw,aE,aD(aI))}}var aw=this,az=fT(av,""),ay=p[az];"boolean"!=typeof ay?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(p[az]=!1,iu(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{p[az]=!0,aA(null,aE)}}):ay?aB(aA):ax()}),ab._info=function(aw){ad().then(function(){ah({},{method:"GET",url:gV(av,"")},function(ay,ax){return ay?aw(ay):(ax.host=gV(av,""),void aw(null,ax))})})["catch"](aw)},ab.get=ac("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?gi.all(aF.map(function(aI){var aH=aD[aI],aG=gK(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(aC,{method:"GET",url:gV(av,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:new gi(function(aK){jq(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?gi.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=fp(aC);var ay={};aC.revs&&(ay.revs=!0),aC.revs_info&&(ay.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),ay.open_revs=aC.open_revs),aC.rev&&(ay.rev=aC.rev),aC.conflicts&&(ay.conflicts=aC.conflicts),aA=gK(aA);var az={method:"GET",url:gV(av,aA+a0(ay))};ap(aC,az).then(function(aD){return gi.resolve().then(function(){return aC.attachments?aw(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ab.remove=ac("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:gV(av,gK(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=ac("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=gV(av,gK(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=ac("removeAttachment",function(ax,ay,aA,aw){var az=gV(av,gK(ax)+"/"+ag(ay))+"?rev="+aA;ah({},{method:"DELETE",url:az},aw)}),ab.putAttachment=ac("putAttachment",function(aw,aD,aB,aA,ay,aC){"function"==typeof ay&&(aC=ay,ay=aA,aA=aB,aB=null);var aE=gK(aw)+"/"+ag(aD),aF=gV(av,aE);if(aB&&(aF+="?rev="+aB),"string"==typeof aA){var az;try{az=iB(aA)}catch(aG){return aC(gM(hl,"Attachment is not a valid base64 string"))}aA=az?O(az,ay):""}var ax={headers:{"Content-Type":ay},method:"PUT",url:aF,processData:!1,body:aA,timeout:am.timeout||60000};ah({},ax,aC)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,ad().then(function(){return gi.all(ay.docs.map(v))}).then(function(){ah(ax,{method:"POST",url:gV(av,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=ac("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=fp(aA);var aB,ax={},aw="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var az=a0(ax);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=C?az+="&"+ay:(aw="POST",aB={keys:aA.keys})}ap(aA,{method:aw,url:gV(av,"_all_docs"+az),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(g7),aC(null,aD)})["catch"](aC)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:hm;aB=fp(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aF=aB.timeout?{timeout:aB.timeout-5000}:{},az="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=az;if(aB.style&&(aF.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aF.include_docs=!0),aB.attachments&&(aF.attachments=!0),aB.continuous&&(aF.feed="longpoll"),aB.conflicts&&(aF.conflicts=!0),aB.descending&&(aF.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aF.heartbeat=aB.heartbeat):aF.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aF.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aF.filter="_view",aF.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var aD in aB.query_params){aB.query_params.hasOwnProperty(aD)&&(aF[aD]=aB.query_params[aD])}}var aJ,aC="GET";if(aB.doc_ids){aF.filter="_doc_ids";var aE=JSON.stringify(aB.doc_ids);aE.length<C?aF.doc_ids=aE:(aC="POST",aJ={doc_ids:aB.doc_ids})}var aG,aI,aK=function(aM,aN){if(!aB.aborted){aF.since=aM,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aB.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aw?aw:aH;var aL={method:aC,url:gV(av,"_changes"+a0(aF)),timeout:aB.timeout,body:aJ};aI=aM,aB.aborted||ad().then(function(){aG=ah(aB,aL,aN)})["catch"](aN)}},ax={results:[]},aA=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,ax.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=iS(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&g7(aR),ay&&ax.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aI=aL.last_seq);var aO=az&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||az&&0>=aH)&&aO?aB.complete(null,ax):setTimeout(function(){aK(aI,aA)},0)}};return aK(aB.since||0,aA),{cancel:function(){aB.aborted=!0,aG&&aG.abort()}}},ab.revsDiff=ac("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:gV(av,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(ax,aw){ah(ax,{url:gV(av,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function fe(t){t.adapter("http",r,!1),t.adapter("https",r,!1)}function gF(){this.promise=new gi(function(t){t()})}function iN(af){var ad=af.db,ac=af.viewName,ab=af.map,t=af.reduce,ah=af.temporary,aa=ab.toString()+(t&&t.toString())+"undefined";if(!ah&&ad._cachedViews){var ag=ad._cachedViews[aa];if(ag){return gi.resolve(ag)}}return ad.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ac;-1===aq.indexOf("/")&&(aq=ac+"/"+ac);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ah?"temp":gI(aa));return gE(ad,"_local/mrviews",al).then(function(){return ad.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ad,adapter:ad.adapter,mapFun:ab,reduceFun:t};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ah||(ad._cachedViews=ad._cachedViews||{},ad._cachedViews[aa]=aq,aq.db.once("destroyed",function(){delete ad._cachedViews[aa]})),aq})})})})}function fw(ac,t,aa,ad,ab,af){return jC("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function g8(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function j(t){return 1===t.length&&/^1-/.test(t[0].rev)}function A(ab,t){try{ab.emit("error",t)}catch(aa){h2("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),h2("error",t)}}function i1(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return A(t,aa),{error:aa}}}function ae(ab,t){var aa=he.collate(ab.key,t.key);return 0!==aa?aa:he.collate(ab.value,t.value)}function iQ(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function hd(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function es(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=ih(ac.data,ac.content_type)})})}function M(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&es(aa),aa}}function h(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new X(t)}function s(af){for(var ad=0,ac=0,ab=af.length;ab>ac;ac++){var t=af[ac];if("number"!=typeof t){if(!Array.isArray(t)){throw h("_sum")}ad="number"==typeof ad?[ad]:ad;for(var ah=0,aa=t.length;aa>ah;ah++){var ag=t[ah];if("number"!=typeof ag){throw h("_sum")}"undefined"==typeof ad[ah]?ad.push(ag):ad[ah]+=ag}}else{"number"==typeof ad?ad+=t:ad[0]+=t}}return ad}function W(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function ao(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function x(t){return t.group_level=ao(t.group_level),t.limit=ao(t.limit),t.skip=ao(t.skip),t}function iE(t){if(t){if("number"!=typeof t){return new gG('Invalid value for integer: "'+t+'"')}if(0>t){return new gG('Invalid value for positive integer: "'+t+'"')}}}function gJ(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&he.collate(t[ac],t[aa])>0){throw new gG("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new gG("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new gG("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=iE(t[af]);if(ad){throw ad}})}function F(aj,ag,t){var ac,aa=[],ah="GET";if(W("reduce",t,aa),W("include_docs",t,aa),W("attachments",t,aa),W("limit",t,aa),W("descending",t,aa),W("group",t,aa),W("group_level",t,aa),W("skip",t,aa),W("stale",t,aa),W("conflicts",t,aa),W("startkey",t,aa,!0),W("start_key",t,aa,!0),W("endkey",t,aa,!0),W("end_key",t,aa,!0),W("inclusive_end",t,aa),W("key",t,aa,!0),aa=aa.join("&"),aa=""===aa?"":"?"+aa,"undefined"!=typeof t.keys){var af=2000,ad="keys="+encodeURIComponent(JSON.stringify(t.keys));ad.length+aa.length+1<=af?aa+=("?"===aa[0]?"&":"?")+ad:(ah="POST","string"==typeof ag?ac={keys:t.keys}:ag.keys=t.keys)}if("string"==typeof ag){var ab=g8(ag);return aj.request({method:ah,url:"_design/"+ab[0]+"/_view/"+ab[1]+aa,body:ac}).then(M(t))}return ac=ac||{},Object.keys(ag).forEach(function(ak){Array.isArray(ag[ak])?ac[ak]=ag[ak]:ac[ak]=ag[ak].toString()}),aj.request({method:"POST",url:"_temp_view"+aa,body:ac}).then(M(t))}function cr(ab,t,aa){return new gi(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function k(t){return new gi(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function fY(t){return function(aa){if(404===aa.status){return t}throw aa}}function n(aa,ah,ac){function af(){return j(ab)?gi.resolve(aj):ah.db.get(al)["catch"](fY(aj))}function ag(am){return am.keys.length?ah.db.allDocs({keys:am.keys,include_docs:!0}):gi.resolve({rows:[]})}function ad(ax,au){for(var am=[],ap={},aA=0,az=au.rows.length;az>aA;aA++){var aw=au.rows[aA],aq=aw.doc;if(aq&&(am.push(aq),ap[aq._id]=!0,aq._deleted=!t[aq._id],!aq._deleted)){var av=t[aq._id];"value" in av&&(aq.value=av.value)}}var ay=Object.keys(t);return ay.forEach(function(aD){if(!ap[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),am.push(aB)}}),ax.keys=ic(ay.concat(ax.keys)),am.push(ax),am}var al="_local/doc_"+aa,aj={_id:al,keys:[]},ak=ac[aa],t=ak.indexableKeysToKeyValues,ab=ak.changes;return af().then(function(am){return ag(am).then(function(ap){return ad(am,ap)})})}function iF(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](fY({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return gi.all(ad.map(function(ag){return n(ag,t,ab)})).then(function(ah){var ag=dt(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function br(ab){var t="string"==typeof ab?ab:ab.name,aa=jj[t];return aa||(aa=jj[t]=new gF),aa}function G(t){return iY(br(t),function(){return be(t)})()}function be(aj){function ag(am,ak){var al={id:aa._id,key:he.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=he.normalizeKey(ak)),ac.push(al)}function t(ak,al){return function(){return iF(aj,ak,al)}}var ac,aa,ah;if("function"==typeof aj.mapFun&&2===aj.mapFun.length){var af=aj.mapFun;ah=function(ak){return af(ak,ag)}}else{ah=fw(aj.mapFun.toString(),ag,s,hu,Array.isArray,JSON.parse)}var ad=aj.seq||0,ab=new gF;return new gi(function(ap,ak){function al(){ab.finish().then(function(){aj.seq=ad,ap()})}function am(){function aq(au){ak(au)}aj.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ad,limit:jp}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var ay={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){ac=[],aa=ax.doc,aa._deleted||i1(aj.sourceDB,ah,[aa]),ac.sort(ae);for(var aC,au={},az=0,aG=ac.length;aG>az;az++){var aE=ac[az],aB=[aE.key,aE.id];0===he.collate(aE.key,aC)&&aB.push(az);var aw=he.toIndexableString(aB);au[aw]=aE,aC=aE.key}ay[ax.doc._id]={indexableKeysToKeyValues:au,changes:ax.changes}}ad=ax.seq}return ab.add(t(ay,ad)),aA.length<jp?al():am()}).on("error",aq)}am()})}function a1(aa,ah,ac){0===ac.group_level&&delete ac.group_level;var af,ag=ac.group||ac.group_level;af=en[aa.reduceFun]?en[aa.reduceFun]:fw(aa.reduceFun.toString(),null,s,hu,Array.isArray,JSON.parse);var ad=[],al=isNaN(ac.group_level)?Number.POSITIVE_INFINITY:ac.group_level;ah.forEach(function(aq){var am=ad[ad.length-1],ap=ag?aq.key:null;return ag&&Array.isArray(ap)&&(ap=ap.slice(0,al)),am&&0===he.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ad.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ah=[];for(var aj=0,ak=ad.length;ak>aj;aj++){var t=ad[aj],ab=i1(aa.sourceDB,af,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof X){throw ab.error}ah.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:iQ(ah,ac.limit,ac.skip)}}function fr(aa,t){return iY(br(aa),function(){return a5(aa,t)})()}function a5(t,al){function ah(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return aj=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=he.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function ak(aq){var au;if(au=af?a1(t,aq,al):{total_rows:aj,offset:ap,rows:aq},al.include_docs){var av=ic(aq.map(hd));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:al.conflicts,attachments:al.attachments,binary:al.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=hd(ay),az=aw["$"+aA];az&&(ay.doc=az)}),au})}return au}var aj,af=t.reduceFun&&al.reduce!==!1,ap=al.skip||0;if("undefined"==typeof al.keys||al.keys.length||(al.limit=0,delete al.keys),"undefined"!=typeof al.keys){var ad=al.keys,am=ad.map(function(au){var aq={startkey:he.toIndexableString([au]),endkey:he.toIndexableString([au,{}])};return ah(aq)});return gi.all(am).then(dt).then(ak)}var aa={descending:al.descending};if(al.start_key&&(al.startkey=al.start_key),al.end_key&&(al.endkey=al.end_key),"undefined"!=typeof al.startkey&&(aa.startkey=al.descending?he.toIndexableString([al.startkey,{}]):he.toIndexableString([al.startkey])),"undefined"!=typeof al.endkey){var ac=al.inclusive_end!==!1;al.descending&&(ac=!ac),aa.endkey=he.toIndexableString(ac?[al.endkey,{}]:[al.endkey])}if("undefined"!=typeof al.key){var ag=he.toIndexableString([al.key]),ab=he.toIndexableString([al.key,{}]);aa.descending?(aa.endkey=ag,aa.startkey=ab):(aa.startkey=ag,aa.endkey=ab)}return af||("number"==typeof al.limit&&(aa.limit=al.limit),aa.skip=ap),ah(aa).then(ak)}function N(t){return t.request({method:"POST",url:"_view_cleanup"})}function iZ(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=g8(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return iY(br(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return gi.all(af).then(function(){return{ok:!0}})})},fY({ok:!0}))}function ei(t,ag,af){if("http"===t.type()){return F(t,ag,af)}if("function"==typeof t._query){return cr(t,ag,af)}if("string"!=typeof ag){gJ(af,ag);var ac={db:t,viewName:"temp_view/temp_view",map:ag.map,reduce:ag.reduce,temporary:!0};return U.add(function(){return iN(ac).then(function(ak){function aj(){return ak.db.destroy()}return jb(G(ak).then(function(){return fr(ak,af)}),aj)})}),U.finish()}var ad=ag,aa=g8(ad),ab=aa[0],ah=aa[1];return t.get("_design/"+ab).then(function(al){var ak=al.views&&al.views[ah];if(!ak||"string"!=typeof ak.map){throw new ho("ddoc "+ab+" has no view named "+ah)}gJ(af,ak);var aj={db:t,viewName:ad,map:ak.map,reduce:ak.reduce};return iN(aj).then(function(am){return"ok"===af.stale||"update_after"===af.stale?("update_after"===af.stale&&g9.nextTick(function(){G(am)}),fr(am,af)):G(am).then(function(){return fr(am,af)})})})}function gG(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gG)}catch(t){}}function ho(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,ho)}catch(t){}}function X(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,X)}catch(t){}}function gR(t){return/^1-/.test(t)}function i(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function gg(ab,t){var aa=Object.keys(t._attachments);return gi.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function fj(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return gi.all(ab.map(function(ag){return i(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return gg(t,aa)}):gg(t,aa)}function gD(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function iA(ac,aj,ad,ag){function af(){var am=gD(ad);if(am.docs.length){return ac.bulkGet(am).then(function(ap){if(ag.cancelled){throw new Error("cancelled")}return gi.all(ap.results.map(function(aq){return gi.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?fj(aj,ac,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(dt(aq).filter(Boolean))})})}}function aa(am){return am._attachments&&Object.keys(am._attachments).length>0}function al(am){return ac.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ag.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&gR(aq.value.rev)&&!aa(aq.doc)&&(t.push(aq.doc),delete ad[aq.id])})})}function ah(){var am=Object.keys(ad).filter(function(aq){var ap=ad[aq].missing;return 1===ap.length&&gR(ap[0])});return am.length>0?al(am):void 0}function ak(){return{ok:ab,docs:t}}ad=fp(ad);var t=[],ab=!0;return gi.resolve().then(ah).then(af).then(ak)}function ai(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&iu(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:dr}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,fk),af.version=dr,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return ai(ac,t,aa,ad,ab)}throw ag}))})}function h4(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function g1(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:Q(aa.history,t.history)}function Q(af,ad){var ac=af[0],ab=af.slice(1),t=ad[0],ah=ad.slice(1);if(!ac||0===ad.length){return{last_seq:h9,history:[]}}var aa=ac.session_id;if(fb(aa,ad)){return{last_seq:ac.last_seq,history:af}}var ag=t.session_id;return fb(ag,ab)?{last_seq:t.last_seq,history:ah}:Q(ab,ah)}function fb(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:fb(t,aa):!1}function fs(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function gb(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=gl),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=ia})),t.current_back_off=t.current_back_off||ia,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function gw(t){return Object.keys(t).sort(he.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function ij(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(he.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(gw(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),gi.all([ab.id(),ad.id()]).then(function(ah){var aj=ah[0]+ah[1]+aa+af+t+ac;return new gi(function(ak){a7(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gP(az,al,aP,ac,aQ){function aJ(){return aD?gi.resolve():ij(az,al,aP).then(function(aS){ap=aS,aD=new h4(az,al,ap,ac)})}function ad(){if(ag=[],0!==aB.docs.length){var aS=aB.docs;return al.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(ac.cancelled){throw aR(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(aQ.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),aA=aA.concat(aV),aQ.docs_written+=aB.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?ac.emit("denied",fp(aY)):ag.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,aI("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw aQ.doc_write_failures+=aS.length,aT})}}function ak(){if(aB.error){throw new Error("There was a problem getting docs.")}aQ.last_seq=aK=aB.seq;var aS=fp(aQ);return ag.length&&(aS.docs=ag,ac.emit("change",aS)),aG=!0,aD.writeCheckpoint(aB.seq,ay).then(function(){if(aG=!1,ac.cancelled){throw aR(),new Error("cancelled")}aB=void 0,aN()})["catch"](am)}function aw(){var aS={};return aB.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),al.revsDiff(aS).then(function(aT){if(ac.cancelled){throw aR(),new Error("cancelled")}aB.diffs=aT})}function aE(){return iA(az,al,aB.diffs,ac).then(function(aS){aB.error=!aS.ok,aS.docs.forEach(function(aT){delete aB.diffs[aT._id],aQ.docs_read++,aB.docs.push(aT)})})}function aM(){if(!ac.cancelled&&!aB){if(0===aL.length){return void au(!0)}aB=aL.shift(),aw().then(aE).then(ad).then(ak).then(aM)["catch"](function(aS){aI("batch processing terminated with error",aS)})}}function au(aS){return 0===aa.changes.length?void (0!==aL.length||aB||((ah&&aO.live||af)&&(ac.state="pending",ac.emit("paused")),af&&aR())):void ((aS||af||aa.changes.length>=av)&&(aL.push(aa),aa={seq:0,changes:[],docs:[]},"pending"!==ac.state&&"stopped"!==ac.state||(ac.state="active",ac.emit("active")),aM()))}function aI(aT,aS){aF||(aS.message||(aS.message=aT),aQ.ok=!1,aQ.status="aborting",aQ.errors.push(aS),aA=aA.concat(aS),aL=[],aa={seq:0,changes:[],docs:[]},aR())}function aR(){if(!(aF||ac.cancelled&&(aQ.status="cancelled",aG))){aQ.status=aQ.status||"complete",aQ.end_time=new Date,aQ.last_seq=aK,aF=!0;var aT=aA.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aA.pop();aA.length>0&&(aS.other_errors=aA),aS.result=aQ,gb(aP,ac,aS,function(){gP(az,al,aP,ac)})}else{aQ.errors=aA,ac.emit("complete",aQ),ac.removeAllListeners()}}}function ax(aT){if(ac.cancelled){return aR()}var aS=iS(aP)(aT);aS&&(aa.seq=aT.seq,aa.changes.push(aT),au(0===aL.length&&aO.live))}function t(aT){if(aj=!1,ac.cancelled){return aR()}if(aT.results.length>0){aO.since=aT.last_seq,aN(),au(!0)}else{var aS=function(){ah?(aO.live=!0,aN()):af=!0,au(!0)};aB||0!==aT.results.length?aS():(aG=!0,aD.writeCheckpoint(aT.last_seq,ay).then(function(){aG=!1,aQ.last_seq=aK=aT.last_seq,aS()})["catch"](am))}}function ab(aS){return aj=!1,ac.cancelled?aR():void aI("changes rejected",aS)}function aN(){function aU(){aS.cancel()}function aT(){ac.removeListener("cancel",aU)}if(!aj&&!af&&aL.length<aq){aj=!0,ac._changes&&(ac.removeListener("cancel",ac._abortChanges),ac._changes.cancel()),ac.once("cancel",aU);var aS=az.changes(aO).on("change",ax);aS.then(aT,aT),aS.then(t)["catch"](ab),aP.retry&&(ac._changes=aS,ac._abortChanges=aU)}}function aH(){aJ().then(function(){return ac.cancelled?void aR():aD.getCheckpoint().then(function(aS){aK=aS,aO={since:aK,limit:av,batch_size:av,style:"all_docs",doc_ids:aC,return_docs:!0},aP.filter&&("string"!=typeof aP.filter?aO.include_docs=!0:aO.filter=aP.filter),"heartbeat" in aP&&(aO.heartbeat=aP.heartbeat),"timeout" in aP&&(aO.timeout=aP.timeout),aP.query_params&&(aO.query_params=aP.query_params),aP.view&&(aO.view=aP.view),aN()})})["catch"](function(aS){aI("getCheckpoint rejected with ",aS)})}function am(aS){throw aG=!1,aI("writeCheckpoint completed with error",aS),aS}var aB,ap,aD,aL=[],aa={seq:0,changes:[],docs:[]},aG=!1,af=!1,aF=!1,aK=0,ah=aP.continuous||aP.live||!1,av=aP.batch_size||100,aq=aP.batches_limit||10,aj=!1,aC=aP.doc_ids,aA=[],ag=[],ay=a3();aQ=aQ||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aO={};return ac.ready(az,al),ac.cancelled?void aR():(ac._addedListeners||(ac.once("cancel",aR),"function"==typeof aP.complete&&(ac.once("error",aP.complete),ac.once("complete",function(aS){aP.complete(null,aS)})),ac._addedListeners=!0),void ("undefined"==typeof aP.since?aH():aJ().then(function(){return aG=!0,aD.writeCheckpoint(aP.since,ay)}).then(function(){return aG=!1,ac.cancelled?void aR():(aK=aP.since,void aH())})["catch"](am)))}function gp(){i5.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new gi(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function i7(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function gc(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gM(ew,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=fp(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new gp(ag),t=i7(ab,ag),af=i7(ad,ag);return gP(t,af,ag,aa),aa}function je(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=fp(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=i7(t,ac),ab=i7(ab,ac),new hI(t,ab,ac,aa)}function hI(ag,aq,ap,ad){function t(ay){aj.emit("change",{direction:"pull",change:ay})}function ak(ay){aj.emit("change",{direction:"push",change:ay})}function aa(ay){aj.emit("denied",{direction:"push",doc:ay})}function am(ay){aj.emit("denied",{direction:"pull",doc:ay})}function av(){aj.pushPaused=!0,aj.pullPaused&&aj.emit("paused")}function ac(){aj.pullPaused=!0,aj.pushPaused&&aj.emit("paused")}function ah(){aj.pushPaused=!1,aj.pullPaused&&aj.emit("active",{direction:"push"})}function al(){aj.pullPaused=!1,aj.pushPaused&&aj.emit("active",{direction:"pull"})}function af(ay){return function(aC,aD){var az="change"===aC&&(aD===t||aD===ak),aA="denied"===aC&&(aD===am||aD===aa),aE="paused"===aC&&(aD===ac||aD===av),aB="active"===aC&&(aD===al||aD===ah);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aj.removeAllListeners(aC))}}var aj=this;this.canceled=!1;var ab=ap.push?gm.extend({},ap,ap.push):ap,aw=ap.pull?gm.extend({},ap,ap.pull):ap;this.push=gc(ag,aq,ab),this.pull=gc(aq,ag,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ap.live&&(this.push.on("complete",aj.pull.cancel.bind(aj.pull)),this.pull.on("complete",aj.push.cancel.bind(aj.push))),this.on("newListener",function(ay){"change"===ay?(aj.pull.on("change",t),aj.push.on("change",ak)):"denied"===ay?(aj.pull.on("denied",am),aj.push.on("denied",aa)):"active"===ay?(aj.pull.on("active",al),aj.push.on("active",ah)):"paused"===ay&&(aj.pull.on("paused",ac),aj.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aj.pull.removeListener("change",t),aj.push.removeListener("change",ak)):"denied"===ay?(aj.pull.removeListener("denied",am),aj.push.removeListener("denied",aa)):"active"===ay?(aj.pull.removeListener("active",al),aj.push.removeListener("active",ah)):"paused"===ay&&(aj.pull.removeListener("paused",ac),aj.push.removeListener("paused",av))}),this.pull.on("removeListener",af("pull")),this.push.on("removeListener",af("push"));var au=gi.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aj.emit("complete",az),ad&&ad(null,az),aj.removeAllListeners(),az},function(ay){if(aj.cancel(),ad?ad(ay):aj.emit("error",ay),aj.removeAllListeners(),ad){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function io(t){t.replicate=gc,t.sync=je}var et,gm=a(9),jm=fZ(a(5)),hc=fZ(a(8)),hw=fZ(a(10)),hK=a(14),hg=fZ(a(4)),i5=a(1),jC=fZ(a(15)),hx=fZ(a(16)),i8=fZ(a(17)),he=a(12),gi="function"==typeof Promise?Promise:hw,m=Function.prototype.toString,gN=m.call(Object),ik=jm("pouchdb:api"),hi=6;if(ga()){et=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),et=!!localStorage.getItem("_pouch_check_localstorage")}catch(fn){et=!1}}hc(er,i5.EventEmitter),er.prototype.addListener=function(ab,ad,ag,ac){function aa(){function ah(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var aj=cn(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",ah)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},er.prototype.removeListener=function(aa,t){t in this._listeners&&i5.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},er.prototype.notifyLocalWindows=function(t){ga()?chrome.storage.local.set({dbName:t}):fd()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},er.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hc(y,Error),y.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var iq=new y({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hS=new y({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),gW=new y({status:404,error:"not_found",reason:"missing"}),h5=new y({status:409,error:"conflict",reason:"Document update conflict"}),hO=new y({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gB=new y({status:412,error:"missing_id",reason:"_id is required for puts"}),u=new y({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),ju=new y({status:412,error:"precondition_failed",reason:"Database not open"}),D=new y({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),hl=new y({status:500,error:"badarg",reason:"Some query argument is invalid"}),hy=new y({status:400,error:"invalid_request",reason:"Request was invalid"}),gx=new y({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),at=new y({status:500,error:"doc_validation",reason:"Bad special document member"}),ew=new y({status:400,error:"bad_request",reason:"Something wrong with the request"}),h7=new y({status:400,error:"bad_request",reason:"Document must be a JSON object"}),bt=new y({status:404,error:"not_found",reason:"Database not found"}),g3=new y({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ht=new y({status:500,error:"web_sql_went_bad",reason:"unknown"}),i4=new y({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fV=new y({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),fX=new y({status:400,error:"bad_request",reason:"Invalid rev format"}),iX=new y({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),fo=new y({status:412,error:"missing_stub"}),dn=new y({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[iq,hS,gW,h5,hO,gB,u,ju,D,hl,hy,gx,at,ew,h7,bt,ht,i4,fV,fX,iX,fo,g3,dn],h3=function(t,ab,ac){var aa=hY.filter(function(ad){return ad[t]===ab});return ac&&aa.filter(function(ad){return ad.message===ac})[0]||aa[0]},hM=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gT="queryKey",de=/(?:^|&)([^&=]*)=?([^&]*)/g,ez=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,gL="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hc(iD,i5.EventEmitter),iD.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},iD.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=fp(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=g6,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=go(ac.view):ac.filter=go(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=hg(function(af){ad.cancel(),ab.apply(this,af)})}},iD.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=gM(ew,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=fW(ac.view);this.db.get("_design/"+ab[0],function(ah,aj){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ah){return aa(jd(ah))}var ag=aj&&aj.views&&aj.views[ab[1]]&&aj.views[ab[1]].map;return ag?(ac.filter=hU(ag),void t.doChanges(ac)):aa(gM(gW,aj.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=fW(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(ag,aj){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ag){return aa(jd(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ac.filter=jE(ah),void t.doChanges(ac)):aa(gM(gW,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hc(hs,i5.EventEmitter),hs.prototype.post=fS("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(gM(h7)):void this.bulkDocs({docs:[ab]},t,iM(aa))}),hs.prototype.put=fS("put",hg(function(aj){function ag(){af||(h2("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),af=!0)}var t,ac,aa,ah,af=!1,ad=aj.shift(),ab="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(ah=aj.pop())(gM(h7))}for(;;){if(t=aj.shift(),ac=typeof t,"string"!==ac||ab?"string"!==ac||!ab||"_rev" in ad?"object"===ac?aa=t:"function"===ac&&(ah=t):(ag(),ad._rev=t):(ag(),ad._id=t,ab=!0),!aj.length){break}}return aa=aa||{},iC(ad._id),w(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,ah):this._putLocal(ad,ah):void this.bulkDocs({docs:[ad]},aa,iM(ah))})),hs.prototype.putAttachment=fS("putAttachment",function(ab,ad,ag,ac,aa){function t(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ad]={content_type:aa,data:ac,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw gM(h5)}return t(ah)},function(ah){if(ah.reason===gW.message){return t({_id:ab})}throw ah})}),hs.prototype.removeAttachment=fS("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(gM(h5)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),hs.prototype.remove=fS("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,w(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,iM(ad))}),hs.prototype.revsDiff=fS("revsDiff",function(af,ad,ac){function ab(ak,aj){ag.has(ak)||ag.set(ak,{missing:[]}),ag.get(ak).missing.push(aj)}function t(aj,ak){var al=af[aj].slice(0);gf(ak,function(av,aw,am,aq,ap){var au=aw+"-"+am,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==ap.status&&ab(aj,au))}),al.forEach(function(am){ab(aj,am)})}"function"==typeof ad&&(ac=ad,ad={});var ah=Object.keys(af);if(!ah.length){return ac(null,{})}var aa=0,ag=new hK.Map;ah.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ag.set(aj,{missing:af[aj]})}else{if(al){return ac(al)}t(aj,am)}if(++aa===ah.length){var ak={};return ag.forEach(function(ap,aq){ak[aq]=ap}),ac(null,ak)}})},this)}),hs.prototype.bulkGet=fS("bulkGet",function(aa,t){ee(this,aa,t)}),hs.prototype.compactDocument=fS("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(aj,af){if(aj){return ac(aj)}var ah=jw(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>ab&&ad.push(ak)}),gf(af,function(al,ap,au,am,ak){var aq=ap+"-"+au;"available"===ak.status&&-1!==ad.indexOf(aq)&&ag.push(aq)}),aa._doCompaction(t,ag,ac)})}),hs.prototype.compact=fS("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&ct(aa)}),hs.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(aj){var ah=aj.last_seq;gi.all(af).then(function(){return gE(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},hs.prototype.get=fS("get",function(af,ad,ac){function ab(){var ak=[],aj=t.length;return aj?void t.forEach(function(al){ah.get(af,{rev:al,revs:ad.revs,attachments:ad.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ac(null,ak)})}):ac(null,ak)}if("function"==typeof ad&&(ac=ad,ad={}),"string"!=typeof af){return ac(gM(hO))}if(w(af)&&"function"==typeof this._getLocal){return this._getLocal(af,ac)}var t=[],ah=this;if(!ad.open_revs){return this._get(af,ad,function(ax,aw){if(ax){return ac(ax)}var al=aw.doc,az=aw.metadata,aq=aw.ctx;if(ad.conflicts){var ap=jo(az);ap.length&&(al._conflicts=ap)}if(gz(az,al._rev)&&(al._deleted=!0),ad.revs||ad.revs_info){var au=bo(az.rev_tree),aj=fq(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(al._rev.split("-")[1])}),am=aj.ids.map(function(aC){return aC.id}).indexOf(al._rev.split("-")[1])+1,ay=aj.ids.length-am;if(aj.ids.splice(am,ay),aj.ids.reverse(),ad.revs&&(al._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),ad.revs_info){var aB=aj.pos+aj.ids.length;al._revs_info=aj.ids.map(function(aC){return aB--,{rev:aB+"-"+aC.id,status:aC.opts.status}})}}if(ad.attachments&&al._attachments){var av=al._attachments,aA=Object.keys(av).length;if(0===aA){return ac(null,al)}Object.keys(av).forEach(function(aC){this._getAttachment(al._id,aC,av[aC],{rev:al._rev,binary:ad.binary,ctx:aq},function(aE,aD){var aF=al._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aA||ac(null,al)})},ah)}else{if(al._attachments){for(var ak in al._attachments){al._attachments.hasOwnProperty(ak)&&(al._attachments[ak].stub=!0)}}ac(null,al)}})}if("all"===ad.open_revs){this._getRevisionTree(af,function(ak,aj){return ak?ac(ak):(t=l(aj).map(function(al){return al.rev}),void ab())})}else{if(!Array.isArray(ad.open_revs)){return ac(gM(D,"function_clause"))}t=ad.open_revs;for(var aa=0;aa<t.length;aa++){var ag=t[aa];if("string"!=typeof ag||!/^\d+-/.test(ag)){return ac(gM(fX))}}ab()}}),hs.prototype.getAttachment=fS("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(gM(gW))})}),hs.prototype.allDocs=fS("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(gM(gx,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return im(this,ab,t)}}return this._allDocs(ab,t)}),hs.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new iD(this,aa,t)},hs.prototype.close=fS("close",function(t){return this._closed=!0,this._close(t)}),hs.prototype.info=fS("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),hs.prototype.id=fS("id",function(t){return this._id(t)}),hs.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},hs.prototype.bulkDocs=fS("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(gM(hS))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(gM(h7))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||hn(ag)})}),ab?aa(gM(ew,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(gA),E(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),hs.prototype.registerDependentDatabase=fS("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);gE(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),hs.prototype.destroy=fS("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});gi.all(ag).then(aa,t)})}),gh.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},gh.prototype.fail=function(t){this.failed=t,this.execute()},gh.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},gh.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hc(eu,hs),eu.debug=jm,eu.adapters={},eu.preferredAdapters=[],eu.prefix="_pouch_";var hG=new i5.EventEmitter;iO(eu),eu.parseAdapter=function(af,ad){var ac,ab,t=af.match(/([a-z\-]*):\/\/(.*)/);if(t){if(af=/http(s?)/.test(t[1])?t[1]+"://"+t[2]:t[2],ac=t[1],!eu.adapters[ac].valid()){throw"Invalid adapter"}return{name:af,adapter:t[1]}}var ah="idb" in eu.adapters&&"websql" in eu.adapters&&fd()&&localStorage["_pouch__websqldb_"+eu.prefix+af];if(ad.adapter){ab=ad.adapter}else{if("undefined"!=typeof ad&&ad.db){ab="leveldb"}else{for(var aa=0;aa<eu.preferredAdapters.length;++aa){if(ab=eu.preferredAdapters[aa],ab in eu.adapters){if(ah&&"idb"===ab){h2("log",'PouchDB is downgrading "'+af+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ac=eu.adapters[ab];var ag=ac&&"use_prefix" in ac?ac.use_prefix:!0;return{name:ag?eu.prefix+af:af,adapter:ab}},eu.adapter=function(ab,t,aa){t.valid()&&(eu.adapters[ab]=t,aa&&eu.preferredAdapters.push(ab))},eu.plugin=function(t){return"function"==typeof t?t(eu):Object.keys(t).forEach(function(aa){eu.prototype[aa]=t[aa]}),eu},eu.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=gm.extend({},aa,ad),void eu.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hc(t,eu),t.preferredAdapters=eu.preferredAdapters.slice(),Object.keys(eu).forEach(function(ab){ab in t||(t[ab]=eu[ab])}),t};var fz="5.4.4";eu.version=fz;var q,iV=jB(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=jB(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),iB=function(t){return atob(t)},gu=function(t){return btoa(t)},fm=g5.setImmediate||g5.setTimeout,iU=32768,gv=5,g2="document-store",h8="by-sequence",gr="attach-store",hQ="attach-seq-store",gH="meta-store",hp="local-store",jf="detect-blob-support",ff={running:!1,queue:[]},hD=new hK.Map,T=new er,f=new hK.Map;Z.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var o=7,i0=it("document-store"),hJ=it("by-sequence"),fl=it("attach-store"),i9=it("local-store"),J=it("metadata-store"),a6=it("attach-seq-store"),gq=new hK.Map,h6=new er,ce=1,iL="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+hJ+" (seq, deleted)",B="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+hJ+" (doc_id, rev)",il="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+i0+" (winningseq)",hh="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+a6+" (seq)",hV="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+a6+" (digest, seq)",jh=hJ+".seq = "+i0+".winningseq",jr=hJ+".seq AS seq, "+hJ+".deleted AS deleted, "+hJ+".json AS data, "+hJ+".rev AS rev, "+i0+".json AS metadata";L.valid=V,L.use_prefix=!0;var hP=ar(),iK=function(){},hm=25,hb=50,p={},C=1800,jz=jm("pouchdb:http");r.valid=function(){return !0},gF.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},gF.prototype.finish=function(){return this.promise};var iG=function(aa,t){return t&&aa.then(function(ab){g9.nextTick(function(){t(null,ab)})},function(ab){g9.nextTick(function(){t(ab)})}),aa},gS=function(t){return hg(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&iG(ab,aa),ab})},jb=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},iY=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},ic=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},jj={},U=new gF,jp=50,hu=h2.bind(null,"log"),en={_sum:function(aa,t){return s(t)},_count:function(aa,t){return t.length},_stats:function(ab,t){function aa(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:s(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},K=gS(function(){var t=this;return"http"===t.type()?N(t):"function"==typeof t._viewCleanup?k(t):iZ(t)}),gZ=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?x(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=gi.resolve().then(function(){return ei(ad,ac,t)});return iG(ab,aa),ab};hc(gG,Error),hc(ho,Error),hc(X,Error);var hj={query:gZ,viewCleanup:K},dr=1,gU="pouchdb",fk=5,h9=0;h4.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},h4.prototype.updateTarget=function(aa,t){return ai(this.target,this.id,aa,t,this.returnValue)},h4.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?gi.resolve(!0):ai(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(fs(ac)){return aa.readOnlySource=!0,!0}throw ac})};var hC={undefined:function(aa,t){return 0===he.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return g1(t,aa).last_seq}};h4.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?gi.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return h9}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hC?hC[ab](aa,ac):h9},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:h9}).then(function(){return h9},function(ac){return fs(ac)?(t.readOnlySource=!0,aa.last_seq):h9})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return h9})};var ia=0;hc(gp,i5.EventEmitter),gp.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gp.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},hc(hI,i5.EventEmitter),hI.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},eu.plugin(jv).plugin(ip).plugin(fe).plugin(hj).plugin(io),b.exports=eu}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var g="color: "+this.color;h=[h[0],g,"color: inherit"].concat(Array.prototype.slice.call(h,1));var f=0,j=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),h.splice(j,0,g),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(o,e,t){function a(){return t.colors[r++%t.colors.length]}function u(j){function g(){}function k(){var m=k,w=+new Date,l=w-(n||w);m.diff=l,m.prev=n,m.curr=w,n=w,null==m.useColors&&(m.useColors=t.useColors()),null==m.color&&m.useColors&&(m.color=a());var q=Array.prototype.slice.call(arguments);q[0]=t.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=t.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof t.formatArgs&&(q=t.formatArgs.apply(m,q));var p=k.log||t.log||console.log.bind(console);p.apply(m,q)}g.enabled=!1,k.enabled=!0;var h=t.enabled(j)?k:g;return h.namespace=j,h}function s(k){t.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?t.skips.push(new RegExp("^"+k.substr(1)+"$")):t.names.push(new RegExp("^"+k+"$")))}}function i(){t.enable("")}function b(g){var j,h;for(j=0,h=t.skips.length;h>j;j++){if(t.skips[j].test(g)){return !1}}for(j=0,h=t.names.length;h>j;j++){if(t.names[j].test(g)){return !0}}return !1}function f(g){return g instanceof Error?g.stack||g.message:g}t=e.exports=u,t.coerce=f,t.disable=i,t.enable=s,t.enabled=b,t.humanize=o(11),t.names=[],t.skips=[],t.formatters={};var n,r=0},{11:11}],7:[function(a,b,e){(function(l){function s(){n=!0;for(var h,j,g=r.length;g;){for(j=r,r=[],h=-1;++h<g;){j[h]()}g=r.length}n=!1}function y(g){1!==r.push(g)||n||x()}var x,o=l.MutationObserver||l.WebKitMutationObserver;if(o){var i=0,z=new o(s),f=l.document.createTextNode("");z.observe(f,{characterData:!0}),x=function(){f.data=i=++i%2}}else{if(l.setImmediate||"undefined"==typeof l.MessageChannel){x="document" in l&&"onreadystatechange" in l.document.createElement("script")?function(){var g=l.document.createElement("script");g.onreadystatechange=function(){s(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},l.document.documentElement.appendChild(g)}:function(){setTimeout(s,0)}}else{var u=new l.MessageChannel;u.port1.onmessage=s,x=function(){u.port2.postMessage(0)}}}var n,r=[];b.exports=y}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(n,u,f){function o(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=b,this.queue=[],this.outcome=void 0,g!==o&&y(this,g)}function m(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function a(j,k,g){l(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function h(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=i(j);"error"===z.status&&w(z.value)}function i(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function t(g){return g instanceof this?g:K.resolve(new this(o),g)}function s(g){var j=new this(o);return K.reject(j,g)}function e(A){function z(E,D){function C(F){g[D]=F,++k!==x||q||(q=!0,K.resolve(j,g))}w.resolve(E).then(C,function(F){q||(q=!0,K.reject(j,F))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(A)){return this.reject(new TypeError("must be an array"))}var x=A.length,q=!1;if(!x){return this.resolve([])}for(var g=new Array(x),k=0,B=-1,j=new this(o);++B<x;){z(A[B],B)}return j}function r(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(o);++z<j;){g(k[z])}return q}var l=n(7),K={},L=["REJECTED"],p=["FULFILLED"],b=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===p||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(o);if(this.state!==b){var k=this.state===p?q:g;a(j,k,this.outcome)}else{this.queue.push(new m(j,q,g))}return j},m.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},m.prototype.otherCallFulfilled=function(g){a(this.promise,this.onFulfilled,g)},m.prototype.callRejected=function(g){K.reject(this.promise,g)},m.prototype.otherCallRejected=function(g){a(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=i(h,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=p,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},v.resolve=t,v.reject=s,v.all=e,v.race=r},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function b(g){if(null!==g){switch(typeof g){case"boolean":return g?1:0;case"number":return a(g);case"string":return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var q=Array.isArray(g),j=q?g:Object.keys(g),w=-1,m=j.length,v="";if(q){for(;++w<m;){v+=h.toIndexableString(j[w])}}else{for(;++w<m;){var k=j[w];v+=h.toIndexableString(k)+h.toIndexableString(g[k])}}return v}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+p),m=parseInt(j,10)+t;for(x&&(m=-m),k+=p;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(j,w){var q=j.pop();if(w.length){var v=w[w.length-1];q===v.element&&(w.pop(),v=w[w.length-1]);var m=v.element,g=v.index;if(Array.isArray(m)){m.push(q)}else{if(g===j.length-2){var k=j.pop();m[k]=q}else{j.push(q)}}}}function s(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(g,q){for(var j=Object.keys(g),w=Object.keys(q),m=Math.min(j.length,w.length),v=0;m>v;v++){var k=h.collate(j[v],w[v]);if(0!==k){return k}if(k=h.collate(g[j[v]],q[w[v]]),0!==k){return k}}return j.length===w.length?0:j.length>w.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(g){if(0===g){return"1"}var w=g.toExponential().split(/e\+?/),k=parseInt(w[1],10),q=0>g,m=q?"0":"2",j=(q?-k:k)-t,y=n.padLeft(j.toString(),"0",p);m+=f+y;var v=Math.abs(parseFloat(w[0]));q&&(v=10-v);var x=v.toFixed(20);return x=x.replace(/\.?0+$/,""),m+=f+x}var t=-324,p=3,f="",n=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=h.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=h.normalizeKey(m))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),i(g)+f+b(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(h,b,e){function a(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var o,f=r.length,g=n.length;for(o=0;f>o;o++){if(o===g){return 1}var i=r.charAt(o),q=n.charAt(o);if(i!==q){return q>i?-1:1}}return g>f?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(m){function u(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function P(j,w,k,q,A,z,x){return u(w&k|~w&q,j,w,A,z,x)}function l(j,w,k,q,A,z,x){return u(w&q|k&~q,j,w,A,z,x)}function s(j,w,k,q,A,z,x){return u(w^k^q,j,w,A,z,x)}function Q(j,w,k,q,A,z,x){return u(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=P(z,k,x,q,w[0],7,-680876936),q=P(q,z,k,x,w[1],12,-389564586),x=P(x,q,z,k,w[2],17,606105819),k=P(k,x,q,z,w[3],22,-1044525330),z=P(z,k,x,q,w[4],7,-176418897),q=P(q,z,k,x,w[5],12,1200080426),x=P(x,q,z,k,w[6],17,-1473231341),k=P(k,x,q,z,w[7],22,-45705983),z=P(z,k,x,q,w[8],7,1770035416),q=P(q,z,k,x,w[9],12,-1958414417),x=P(x,q,z,k,w[10],17,-42063),k=P(k,x,q,z,w[11],22,-1990404162),z=P(z,k,x,q,w[12],7,1804603682),q=P(q,z,k,x,w[13],12,-40341101),x=P(x,q,z,k,w[14],17,-1502002290),k=P(k,x,q,z,w[15],22,1236535329),z=l(z,k,x,q,w[1],5,-165796510),q=l(q,z,k,x,w[6],9,-1069501632),x=l(x,q,z,k,w[11],14,643717713),k=l(k,x,q,z,w[0],20,-373897302),z=l(z,k,x,q,w[5],5,-701558691),q=l(q,z,k,x,w[10],9,38016083),x=l(x,q,z,k,w[15],14,-660478335),k=l(k,x,q,z,w[4],20,-405537848),z=l(z,k,x,q,w[9],5,568446438),q=l(q,z,k,x,w[14],9,-1019803690),x=l(x,q,z,k,w[3],14,-187363961),k=l(k,x,q,z,w[8],20,1163531501),z=l(z,k,x,q,w[13],5,-1444681467),q=l(q,z,k,x,w[2],9,-51403784),x=l(x,q,z,k,w[7],14,1735328473),k=l(k,x,q,z,w[12],20,-1926607734),z=s(z,k,x,q,w[5],4,-378558),q=s(q,z,k,x,w[8],11,-2022574463),x=s(x,q,z,k,w[11],16,1839030562),k=s(k,x,q,z,w[14],23,-35309556),z=s(z,k,x,q,w[1],4,-1530992060),q=s(q,z,k,x,w[4],11,1272893353),x=s(x,q,z,k,w[7],16,-155497632),k=s(k,x,q,z,w[10],23,-1094730640),z=s(z,k,x,q,w[13],4,681279174),q=s(q,z,k,x,w[0],11,-358537222),x=s(x,q,z,k,w[3],16,-722521979),k=s(k,x,q,z,w[6],23,76029189),z=s(z,k,x,q,w[9],4,-640364487),q=s(q,z,k,x,w[12],11,-421815835),x=s(x,q,z,k,w[15],16,530742520),k=s(k,x,q,z,w[2],23,-995338651),z=Q(z,k,x,q,w[0],6,-198630844),q=Q(q,z,k,x,w[7],10,1126891415),x=Q(x,q,z,k,w[14],15,-1416354905),k=Q(k,x,q,z,w[5],21,-57434055),z=Q(z,k,x,q,w[12],6,1700485571),q=Q(q,z,k,x,w[3],10,-1894986606),x=Q(x,q,z,k,w[10],15,-1051523),k=Q(k,x,q,z,w[1],21,-2054922799),z=Q(z,k,x,q,w[8],6,1873313359),q=Q(q,z,k,x,w[15],10,-30611744),x=Q(x,q,z,k,w[6],15,-1560198380),k=Q(k,x,q,z,w[13],21,1309151649),z=Q(z,k,x,q,w[4],6,-145523070),q=Q(q,z,k,x,w[11],10,-1120210379),x=Q(x,q,z,k,w[2],15,718787259),k=Q(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function n(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function o(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function v(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,n(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function r(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,o(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function O(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function y(j){var k;for(k=0;k<j.length;k+=1){j[k]=O(j[k])}return j.join("")}function p(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function t(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==y(v("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(C,k){var w,D,x,A,q=this.byteLength,B=j(C,q),z=q;return k!==m&&(z=j(k,q)),B>z?new ArrayBuffer(0):(w=z-B,D=new ArrayBuffer(w),x=new Uint8Array(D),A=new Uint8Array(this,B,w),x.set(A),D)}}(),t.prototype.append=function(j){return this.appendBinary(p(j)),this},t.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,n(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},t.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},t.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},t.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},t.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},t.hash=function(j,k){return t.hashBinary(p(j),k)},t.hashBinary=function(j,w){var q=v(j),k=y(q);return w?e(k):k},t.ArrayBuffer=function(){this.reset()},t.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,o(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},t.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.ArrayBuffer.prototype.getState=function(){var j=t.prototype.getState.call(this);return j.buff=S(j.buff),j},t.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),t.prototype.setState.call(this,j)},t.ArrayBuffer.prototype.destroy=t.prototype.destroy,t.ArrayBuffer.prototype._finish=t.prototype._finish,t.ArrayBuffer.hash=function(j,w){var q=r(new Uint8Array(j)),k=y(q);return w?e(k):k},t})},{}],17:[function(h,b,e){function a(r,n,o){var f=o[o.length-1];r===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,i=f.index;if(Array.isArray(g)){g.push(r)}else{if(i===n.length-2){var q=n.pop();g[q]=r}else{n.push(r)}}}e.stringify=function(D){var f=[];f.push({obj:D});for(var i,l,E,n,s,g,F,t,u,o,r,C="";i=f.pop();){if(l=i.obj,E=i.prefix||"",n=i.val||"",C+=E,n){C+=n}else{if("object"!=typeof l){C+="undefined"==typeof l?null:JSON.stringify(l)}else{if(null===l){C+="null"}else{if(Array.isArray(l)){for(f.push({val:"]"}),s=l.length-1;s>=0;s--){g=0===s?"":",",f.push({obj:l[s],prefix:g})}f.push({val:"["})}else{F=[];for(t in l){l.hasOwnProperty(t)&&F.push(t)}for(f.push({val:"}"}),s=F.length-1;s>=0;s--){u=F[s],o=l[u],r=s>0?",":"",r+=JSON.stringify(u)+":",f.push({obj:o,prefix:r})}f.push({val:"{"})}}}}}return C},e.parse=function(o){for(var s,D,g,t,A,u,l,f,i,B=[],C=[],n=0;;){if(s=o[n++],"}"!==s&&"]"!==s&&"undefined"!=typeof s){switch(s){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,a(null,B,C);break;case"t":n+=3,a(!0,B,C);break;case"f":n+=4,a(!1,B,C);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",n--;;){if(g=o[n++],!/[\d\.\-e\+]/.test(g)){n--;break}D+=g}a(parseFloat(D),B,C);break;case'"':for(t="",A=void 0,u=0;;){if(l=o[n++],'"'===l&&("\\"!==A||u%2!==1)){break}t+=l,A=l,"\\"===A?u++:u=0}a(JSON.parse('"'+t+'"'),B,C);break;case"[":f={element:[],index:B.length},B.push(f.element),C.push(f);break;case"{":i={element:{},index:B.length},B.push(i.element),C.push(i);break;default:throw new Error("unexpectedly reached end of input: "+s)}}else{if(1===B.length){return B.pop()}a(B.pop(),B,C)}}}},{}]},{},[3])(3)});