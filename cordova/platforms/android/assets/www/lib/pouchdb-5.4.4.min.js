!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(f,j){if(!i[f]){if(!l[f]){var n="function"==typeof require&&require;if(!j&&n){return n(f,!0)}if(e){return e(f,!0)}var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var h=i[f]={exports:{}};l[f][0].call(h.exports,function(p){var m=l[f][1][p];return a(m?m:p)},h,h.exports,d,l,i,b)}return i[f].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,j,f,l,h,r;if(this._events||(this._events={}),"error"===k&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(j=this._events[k],p(j)){return !1}if(b(j)){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),j.apply(this,l)}}else{if(i(j)){for(l=Array.prototype.slice.call(arguments,1),r=j.slice(),f=r.length,h=0;f>h;h++){r[h].apply(this,l)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(i(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(e,B,b){function r(){h&&o&&(h=!1,o.length?t=o.concat(t):l=-1,t.length&&f())}function f(){if(!h){var g=u(r);h=!0;for(var j=t.length;j;){for(o=t,t=[];++l<j;){o&&o[l].run()}l=-1,j=t.length}o=null,h=!1,s(g)}}function a(g,j){this.fun=g,this.array=j}function i(){}var u,s,n=B.exports={};!function(){try{u=setTimeout}catch(g){u=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(g){s=function(){throw new Error("clearTimeout is not defined")}}}();var o,t=[],h=!1,l=-1;n.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}t.push(new a(j,k)),1!==t.length||h||u(f,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.binding=function(g){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(g){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],3:[function(e,a,b){(function(gf,jl){function fy(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function gC(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function eu(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function er(t){if(t instanceof ArrayBuffer){return eu(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function fZ(t){var aa=Object.getPrototypeOf(t);if(null===aa){return !0}var ab=aa.constructor;return"function"==typeof ab&&ab instanceof ab&&de.call(ab)==io}function fv(aa){var ac,ad,ab;if(!aa||"object"!=typeof aa){return aa}if(Array.isArray(aa)){for(ac=[],ad=0,ab=aa.length;ab>ad;ad++){ac[ad]=fv(aa[ad])}return ac}if(aa instanceof Date){return aa.toISOString()}if(gC(aa)){return er(aa)}if(!fZ(aa)){return aa}ac={};for(ad in aa){if(Object.prototype.hasOwnProperty.call(aa,ad)){var t=fv(aa[ad]);"undefined"!=typeof t&&(ac[ad]=t)}}return ac}function iz(t){var aa=!1;return hw(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function co(t){return hw(function(ac){ac=fv(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){gf.nextTick(function(){ad(ah,ag)})});var af=new hg(function(al,ag){var aj;try{var ak=iz(function(ap,am){ap?ag(ap):al(am)});ac.push(ak),aj=t.apply(aa,ac),aj&&"function"==typeof aj.then&&al(aj)}catch(ah){ag(ah)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function eo(t,aa){function ab(af,ah,ac){if(hy.enabled){for(var ag=[af._db_name,ah],ad=0;ad<ac.length-1;ad++){ag.push(ac[ad])}hy.apply(null,ag);var aj=ac[ac.length-1];ac[ac.length-1]=function(ak,am){var al=[af._db_name,ah];al=al.concat(ak?["error",ak]:["success",am]),hy.apply(null,al),aj(ak,am)}}}return co(hw(function(ad){if(this._closed){return hg.reject(new Error("database is closed"))}if(this._destroyed){return hg.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new hg(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function fc(aa,ac){for(var ad={},ab=0,t=ac.length;t>ab;ab++){var af=ac[ab];af in aa&&(ad[af]=aa[af])}return ad}function hB(t){return t}function a9(t){return[{ok:t}]}function cn(am,aj,ac){function ag(){var av=[];au.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),ac(null,{results:av})}function af(){++ad===t&&ag()}function aa(ax,av,aw){au[ax]={id:av,docs:aw},af()}function ah(){if(!(ab>=ap.length)){var av=Math.min(ab+gm,ap.length),aw=ap.slice(ab,av);ak(aw,ab),ab+=aw.length}}function ak(av,aw){av.forEach(function(ay,aC){var aA=aw+aC,ax=al[ay],az=fc(ax[0],["atts_since","attachments"]);az.open_revs=ax.map(function(aD){return aD.rev}),az.open_revs=az.open_revs.filter(hB);var aB=hB;0===az.open_revs.length&&(delete az.open_revs,aB=a9),["revs","attachments","binary","ajax"].forEach(function(aD){aD in aj&&(az[aD]=aj[aD])}),am.get(ay,az,function(aD,aF){var aE;aE=aD?[{error:aD}]:aB(aF),aa(aA,ay,aE),ah()})})}var aq=aj.docs,al={};aq.forEach(function(av){av.id in al?al[av.id].push(av):al[av.id]=[av]});var t=Object.keys(al).length,ad=0,au=new Array(t),ap=Object.keys(al),ab=0;ah()}function E(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fU(){return at}function ee(t){E()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fU()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ge(){ij.EventEmitter.call(this),this._listeners={},ee(this)}function iu(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function g9(aa,ac){var ad=600000;aa=parseInt(aa,10)||0,ac=parseInt(ac,10),ac!==ac||aa>=ac?ac=(aa||1)<<1:ac+=1,ac>ad&&(aa=ad>>1,ac=ad);var ab=Math.random(),t=ac-aa;return ~~(t*ab+aa)}function g5(t){var aa=0;return t||(aa=2000),g9(t,aa)}function jd(t,aa){iu("info","The above "+t+" is totally normal. "+aa)}function jk(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gO(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=jk.prototype,new ab(ac)}function fh(aa){var ac,ad,ab,t,af;return ad=aa.error===!0&&"string"==typeof aa.name?aa.name:aa.error,af=aa.reason,ab=gu("name",ad,af),aa.missing||"missing"===af||"deleted"===af||"not_found"===ad?ab=ik:"doc_validation"===ad?(ab=ei,t=af):"bad_request"===ad&&ab.message!==af&&(ab=fo),ab||(ab=gu("status",aa.status,af)||n),ac=gO(ab,af,ad),t&&(ac.message=t),aa.id&&(ac.id=aa.id),aa.status&&(ac.status=aa.status),aa.missing&&(ac.missing=aa.missing),ac}function hn(aa,ac,ad){try{return !aa(ac,ad)}catch(ab){var t="Filter function threw: "+ab.toString();return gO(fo,t)}}function hH(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&hn(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function fx(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function jt(t){var aa;if(t?"string"!=typeof t?aa=gO(gN):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=gO(et)):aa=gO(gR),aa){throw aa}}function ih(t,aa){return"listenerCount" in t?t.listenerCount(aa):ij.EventEmitter.listenerCount(t,aa)}function gz(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function V(t){var aa=gz(t);return aa?aa.join("/"):null}function ix(t){for(var ab=be.exec(t),ag={},aa=14;aa--;){var ad=gL[aa],ac=ab[aa]||"",af=-1!==["user","password"].indexOf(ad);ag[ad]=af?decodeURIComponent(ac):ac}return ag[hY]={},ag[gL[12]].replace(ez,function(ah,ak,aj){ak&&(ag[hY][ak]=aj)}),ag}function jq(t,aa,ab){return new hg(function(ad,ac){t.get(aa,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=ab(ag);return af?(af._id=aa,af._rev=ah,void ad(gk(t,af,ab))):ad({updated:!1,rev:ah})})})}function gk(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return jq(t,aa._id,ab)})}function gl(t){return 0|Math.random()*t}function iC(aa,ac){ac=ac||D.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=D[gl(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=D[3&gl(16)|8];break;default:t+=D[gl(16)]}}return t}function gX(t){for(var ap,ak,am,al,ah=t.rev_tree.slice();al=ah.pop();){var ab=al.ids,ag=ab[2],aa=al.pos;if(ag.length){for(var ac=0,af=ag.length;af>ac;ac++){ah.push({pos:aa+1,ids:ag[ac]})}}else{var aj=!!ab[1].deleted,ad=ab[0];ap&&!(am!==aj?am:ak!==aa?aa>ak:ad>ap)||(ap=ad,ak=aa,am=aj)}}return ak+"-"+ap}function iy(ac,ak){for(var af,ah=ac.slice();af=ah.pop();){for(var ag=af.pos,ad=af.ids,aa=ad[2],aj=ak(0===aa.length,ag,ad[0],af.ctx,ad[1]),t=0,ab=aa.length;ab>t;t++){ah.push({pos:ag+1,ids:aa[t],ctx:aj})}}}function gA(t,aa){return t.pos-aa.pos}function jg(aa){var ac=[];iy(aa,function(aj,ag,ad,ah,af){aj&&ac.push({rev:ag+"-"+ad,pos:ag,opts:af})}),ac.sort(gA).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function iT(t){for(var ab=gX(t),ag=jg(t.rev_tree),aa=[],ad=0,ac=ag.length;ac>ad;ad++){var af=ag[ad];af.rev===ab||af.opts.deleted||aa.push(af.rev)}return aa}function g0(t){var aa=[];return iy(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function jw(t){for(var ap,ak=[],am=t.slice();ap=am.pop();){var al=ap.pos,ah=ap.ids,ab=ah[0],ag=ah[1],aa=ah[2],ac=0===aa.length,af=ap.history?ap.history.slice():[];af.push({id:ab,opts:ag}),ac&&ak.push({pos:al+1-af.length,ids:af});for(var aj=0,ad=aa.length;ad>aj;aj++){am.push({pos:al+1,ids:aa[aj],history:af})}}return ak.reverse()}function hr(t,aa){return t.pos-aa.pos}function fu(aa,ac,ad){for(var ab,t=0,af=aa.length;af>t;){ab=t+af>>>1,ad(aa[ab],ac)<0?t=ab+1:af=ab}return t}function g(aa,ac,t){var ab=fu(aa,ac,t);aa.splice(ab,0,ac)}function iW(t,ac){for(var ag,aa,ah=ac,ad=t.length;ad>ah;ah++){var af=t[ah],ab=[af.id,af.opts,[]];aa?(aa[2].push(ab),aa=ab):ag=aa=ab}return ag}function fi(t,aa){return t[0]<aa[0]?-1:1}function jE(ac,ak){for(var af=[{tree1:ac,tree2:ak}],ah=!1;af.length>0;){var ag=af.pop(),ad=ag.tree1,aa=ag.tree2;(ad[1].status||aa[1].status)&&(ad[1].status="available"===ad[1].status||"available"===aa[1].status?"available":"missing");for(var aj=0;aj<aa[2].length;aj++){if(ad[2][0]){for(var t=!1,ab=0;ab<ad[2].length;ab++){ad[2][ab][0]===aa[2][aj][0]&&(af.push({tree1:ad[2][ab],tree2:aa[2][aj]}),t=!0)}t||(ah="new_branch",g(ad[2],aa[2][aj],fi))}else{ah="new_leaf",ad[2][0]=aa[2][aj]}}}return{conflicts:ah,tree:ac}}function ga(ab,ah,ad){var aj,av=[],aq=!1,ak=!1;if(!ab.length){return{tree:[ah],conflicts:"new_leaf"}}for(var af=0,aw=ab.length;aw>af;af++){var ag=ab[af];if(ag.pos===ah.pos&&ag.ids[0]===ah.ids[0]){aj=jE(ag.ids,ah.ids),av.push({pos:ag.pos,ids:aj.tree}),aq=aq||aj.conflicts,ak=!0}else{if(ad!==!0){var al=ag.pos<ah.pos?ag:ah,t=ag.pos<ah.pos?ah:ag,aa=t.pos-al.pos,ap=[],ax=[];for(ax.push({ids:al.ids,diff:aa,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],am=0,ac=az.length;ac>am;am++){ax.push({ids:az[am],diff:ay.diff-1,parent:ay.ids,parentIdx:am})}}else{ay.ids[0]===t.ids[0]&&ap.push(ay)}}var au=ap[0];au?(aj=jE(au.ids,t.ids),au.parent[2][au.parentIdx]=aj.tree,av.push({pos:al.pos,ids:al.ids}),aq=aq||aj.conflicts,ak=!0):av.push(ag)}else{av.push(ag)}}}return ak||av.push(ah),av.sort(hr),{tree:av,conflicts:aq||"internal_node"}}function v(t,ap){for(var ak,am=jw(t),al={},ah=0,ab=am.length;ab>ah;ah++){for(var ag=am[ah],aa=ag.ids,ac=Math.max(0,aa.length-ap),af={pos:ag.pos+ac,ids:iW(aa,ac)},aj=0;ac>aj;aj++){var ad=ag.pos+aj+"-"+aa[aj].id;al[ad]=!0}ak=ak?ga(ak,af,!0).tree:[af]}return iy(ak,function(av,aq,au){delete al[aq+"-"+au]}),{tree:ak,revs:Object.keys(al)}}function di(aa,ac,ad){var ab=ga(aa,ac),t=v(ab.tree,ad);return{tree:t.tree,stemmedRevs:t.revs,conflicts:ab.conflicts}}function iD(ac,ak){for(var af,ah=ac.slice(),ag=ak.split("-"),ad=parseInt(ag[0],10),aa=ag[1];af=ah.pop();){if(af.pos===ad&&af.ids[0]===aa){return !0}for(var aj=af.ids[2],t=0,ab=aj.length;ab>t;t++){ah.push({pos:af.pos+1,ids:aj[t]})}}return !1}function fd(t){return t.ids}function iv(aa,ac){ac||(ac=gX(aa));for(var ad,ab=ac.substring(ac.indexOf("-")+1),t=aa.rev_tree.map(fd);ad=t.pop();){if(ad[0]===ab){return !!ad[1].deleted}t=t.concat(ad[2])}}function L(t){return/^_local/.test(t)}function P(t){return hc("return "+t+";",{})}function ex(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function a0(t,aa){try{t.emit("change",aa)}catch(ab){iu("error",'Error in .on("change", function):',ab)}}function fq(t,ab,ag){function aa(){ad.cancel()}ij.EventEmitter.call(this);var ad=this;this.db=t,ab=ab?fv(ab):{};var ac=ab.complete=iz(function(ah,aj){ah?ih(ad,"error")>0&&ad.emit("error",ah):ad.emit("complete",aj),ad.removeAllListeners(),t.removeListener("destroyed",aa)});ag&&(ad.on("complete",function(ah){ag(null,ah)}),ad.on("error",ag)),t.once("destroyed",aa),ab.onChange=function(ah){ab.isCancelled||(a0(ad,ah),ad.startSeq&&ad.startSeq<=ah.seq&&(ad.startSeq=!1))};var af=new hg(function(ah,aj){ab.complete=function(al,ak){al?aj(al):ah(ak)}});ad.once("cancel",function(){t.removeListener("destroyed",aa),ab.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ac(null,ah)},ac),t.taskqueue.isReady?ad.doChanges(ab):t.taskqueue.addTask(function(){ad.isCancelled?ad.emit("cancel"):ad.doChanges(ab)})}function g4(aa,ac,ad){var ab=[{rev:aa._rev}];"all_docs"===ad.style&&(ab=jg(ac.rev_tree).map(function(af){return{rev:af.rev}}));var t={id:ac.id,changes:ab,doc:aa};return iv(ac,aa._rev)&&(t.deleted=!0),ad.conflicts&&(t.doc._conflicts=iT(ac),t.doc._conflicts.length||delete t.doc._conflicts),t}function iN(t,aa){return aa>t?-1:t>aa?1:0}function gF(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function iP(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function ar(aa){for(var ac=0;ac<aa.length;ac++){var ad=aa[ac];if(ad._deleted){delete ad._attachments}else{if(ad._attachments){for(var ab=Object.keys(ad._attachments),t=0;t<ab.length;t++){var af=ab[t];ad._attachments[af]=fc(ad._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function an(aa,ac){var ad=iN(aa._id,ac._id);if(0!==ad){return ad}var ab=aa._revisions?aa._revisions.start:0,t=ac._revisions?ac._revisions.start:0;return iN(ab,t)}function ev(t){var aa={},ab=[];return iy(t,function(ah,ac,ag,ad){var af=ac+"-"+ag;return ah&&(aa[af]=0),void 0!==ad&&ab.push({from:ad,to:af}),af}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function hF(aa,ac,ad){var ab="limit" in ac?ac.keys.slice(ac.skip,ac.limit+ac.skip):ac.skip>0?ac.keys.slice(ac.skip):ac.keys;if(ac.descending&&ab.reverse(),!ab.length){return aa._allDocs({limit:0},ad)}var t={offset:ac.skip};return hg.all(ab.map(function(af){var ag=ai.extend({key:af,deleted:"ok"},ac);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hg(function(ah,aj){aa._allDocs(ag,function(ak,al){return ak?aj(ak):(t.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return t.rows=af,t})}function i6(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),gf.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&i6(aa)})})})}function fa(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function iS(){ij.EventEmitter.call(this)}function ib(){this.isReady=!1,this.failed=!1,this.queue=[]}function fW(t){t&&jl.debug&&iu("error",t)}function gh(t,ab){function ag(){ac.emit("destroyed",ad)}function aa(){t.removeListener("destroyed",ag),t.emit("destroyed",t)}var ad=ab.originalName,ac=t.constructor,af=ac._destructionListeners;t.once("destroyed",ag),af.has(ad)||af.set(ad,[]),af.get(ad).push(aa)}function gE(t,ab,ag){if(!(this instanceof gE)){return new gE(t,ab,ag)}var aa=this;if("function"!=typeof ab&&"undefined"!=typeof ab||(ag=ab,ab={}),t&&"object"==typeof t&&(ab=t,t=void 0),"undefined"==typeof ag){ag=fW}else{var ad=ag;ag=function(){return iu("warn","Using a callback for new PouchDB()is deprecated."),ad.apply(null,arguments)}}t=t||ab.name,ab=fv(ab),delete ab.name,this.__opts=ab;var ac=ag;aa.auto_compaction=ab.auto_compaction,aa.prefix=gE.prefix,iS.call(aa),aa.taskqueue=new ib;var af=new hg(function(ah,ak){ag=function(ap,am){return ap?ak(ap):(delete am.then,void ah(am))},ab=fv(ab);var al,aj;return function(){try{if("string"!=typeof t){throw aj=new Error("Missing/invalid DB name"),aj.code=400,aj}var ap=(ab.prefix||"")+t;if(al=gE.parseAdapter(ap,ab),ab.originalName=t,ab.name=al.name,ab.adapter=ab.adapter||al.adapter,aa._adapter=ab.adapter,he("pouchdb:adapter")("Picked adapter: "+ab.adapter),aa._db_name=t,!gE.adapters[ab.adapter]){throw aj=new Error("Adapter is missing"),aj.code=404,aj}if(!gE.adapters[ab.adapter].valid()){throw aj=new Error("Invalid Adapter"),aj.code=404,aj}}catch(am){aa.taskqueue.fail(am)}}(),aj?ak(aj):(aa.adapter=ab.adapter,aa.replicate={},aa.replicate.from=function(aq,am,ap){return aa.constructor.replicate(aq,aa,am,ap)},aa.replicate.to=function(aq,am,ap){return aa.constructor.replicate(aa,aq,am,ap)},aa.sync=function(aq,am,ap){return aa.constructor.sync(aa,aq,am,ap)},aa.replicate.sync=aa.sync,void gE.adapters[ab.adapter].call(aa,ab,function(am){return am?(aa.taskqueue.fail(am),void ag(am)):(gh(aa,ab),aa.emit("created",aa),gE.emit("created",ab.originalName),aa.taskqueue.ready(aa),void ag(null,aa))}))});af.then(function(ah){ac(null,ah)},ac),aa.then=af.then.bind(af),aa["catch"]=af["catch"].bind(af)}function hE(t){Object.keys(ij.EventEmitter.prototype).forEach(function(ab){"function"==typeof ij.EventEmitter.prototype[ab]&&(t[ab]=ht[ab].bind(ht))});var aa=t._destructionListeners=new g1.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function ii(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function gM(aa){if(!/^\d+\-./.test(aa)){return gO(iV)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function hA(t,ab){for(var ag=t.start-t.ids.length+1,aa=t.ids,ad=[aa[0],ab,[]],ac=1,af=aa.length;af>ac;ac++){ad=[aa[ac],{status:"missing"},[ad]]}return[{pos:ag,ids:ad}]}function I(ac,ak){var af,ah,ag,ad={status:"available"};if(ac._deleted&&(ad.deleted=!0),ak){if(ac._id||(ac._id=iC()),ah=iC(32,16).toLowerCase(),ac._rev){if(ag=gM(ac._rev),ag.error){return ag}ac._rev_tree=[{pos:ag.prefix,ids:[ag.id,{status:"missing"},[[ah,ad,[]]]]}],af=ag.prefix+1}else{ac._rev_tree=[{pos:1,ids:[ah,ad,[]]}],af=1}}else{if(ac._revisions&&(ac._rev_tree=hA(ac._revisions,ad),af=ac._revisions.start,ah=ac._revisions.ids[0]),!ac._rev_tree){if(ag=gM(ac._rev),ag.error){return ag}af=ag.prefix,ah=ag.id,ac._rev_tree=[{pos:af,ids:[ah,ad,[]]}]}}jt(ac._id),ac._rev=af+"-"+ah;var aa={metadata:{},data:{}};for(var aj in ac){if(Object.prototype.hasOwnProperty.call(ac,aj)){var t="_"===aj[0];if(t&&!hM[aj]){var ab=gO(ei,aj);throw ab.message=ei.message+": "+aj,ab}t&&!g2[aj]?aa.metadata[aj.slice(1)]=ac[aj]:aa.data[aj]=ac[aj]}}return aa}function h0(aa){for(var ac="",ad=new Uint8Array(aa),ab=ad.byteLength,t=0;ab>t;t++){ac+=String.fromCharCode(ad[t])}return ac}function hz(t){return h3(h0(t))}function hX(aa,ac){aa=aa||[],ac=ac||{};try{return new Blob(aa,ac)}catch(ad){if("TypeError"!==ad.name){throw ad}for(var ab="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,t=new ab,af=0;af<aa.length;af+=1){t.append(aa[af])}return t.getBlob(ac.type)}}function dt(aa){for(var ac=aa.length,ad=new ArrayBuffer(ac),ab=new Uint8Array(ad),t=0;ac>t;t++){ab[t]=aa.charCodeAt(t)}return ad}function hs(t,aa){return hX([dt(t)],{type:aa})}function hL(t,aa){return hs(dn(t),aa)}function Z(aa,ac){if("undefined"==typeof FileReader){return ac(h0((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(h0(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function H(t,aa){Z(t,function(ab){aa(h3(ab))})}function iJ(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function gd(t){return h3(t)}function i3(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function h2(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function y(ac,ak){function af(){var aq=aj*ad,al=aq+ad;if(aj++,aa>aj){ab(t,ac,aq,al),iX(af)}else{ab(t,ac,aq,al);var ap=t.end(!0),am=gd(ap);ak(am),t.destroy()}}var ah="string"==typeof ac,ag=ah?ac.length:ac.byteLength,ad=Math.min(iU,ag),aa=Math.ceil(ag/ad),aj=0,t=ah?new fV:new fV.ArrayBuffer,ab=ah?h2:i3;af()}function jB(t){return fV.hash(t)}function bn(t,ac,ag){function aa(al){try{return dn(al)}catch(aj){var ak=gO(fn,"Attachment is not a valid base64 string");return{error:ak}}}function ah(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=aa(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ac?aj.data=hs(al,aj.content_type):"base64"===ac?aj.data=h3(al):aj.data=al,y(al,function(am){aj.digest="md5-"+am,ak()})}else{iJ(aj.data,function(am){"binary"===ac?aj.data=h0(am):"base64"===ac&&(aj.data=hz(am)),y(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ad(){ab++,t.length===ab&&(af?ag(af):ag())}if(!t.length){return ag()}var af,ab=0;t.forEach(function(ak){function am(aq){af=aq,al++,al===aj.length&&ad()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ad()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ah(ak.data._attachments[ap],am)}})}function jA(ax,ad,az,al,aA,t,af,aw){if(iD(ad.rev_tree,az.metadata.rev)){return al[aA]=az,t()}var am=ad.winningRev||gX(ad),au="deleted" in ad?ad.deleted:iv(ad,am),aa="deleted" in az.metadata?az.metadata.deleted:iv(az.metadata),aq=/^1-/.test(az.metadata.rev);if(au&&!aa&&aw&&aq){var ay=az.data;ay._rev=am,ay._id=az.metadata.id,az=I(ay,aw)}var av=di(ad.rev_tree,az.metadata.rev_tree[0],ax),ak=aw&&(au&&aa||!au&&"new_leaf"!==av.conflicts||au&&!aa&&"new_branch"===av.conflicts);if(ak){var ag=gO(ju);return al[aA]=ag,t()}var ac=az.metadata.rev;az.metadata.rev_tree=av.tree,az.stemmedRevs=av.stemmedRevs||[],ad.rev_map&&(az.metadata.rev_map=ad.rev_map);var aj,ab=gX(az.metadata),ap=iv(az.metadata,ab),ah=au===ap?0:ap>au?-1:1;aj=ac===ab?ap:iv(az.metadata,ac),af(az,ab,ap,aj,!0,ah,aA,t)}function gy(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function hf(af,aq,am,ac,aa,ak,au,al,ab){function t(aC,aw,aA){var av=gX(aC.metadata),ay=iv(aC.metadata,av);if("was_delete" in al&&ay){return ak[aw]=gO(ik,"deleted"),aA()}var ax=aj&&gy(aC);if(ax){var az=gO(ju);return ak[aw]=az,aA()}var aB=ay?0:1;au(aC,av,ay,ay,!1,aB,aw,aA)}function ah(){++ap===ad&&ab&&ab()}af=af||1000;var aj=al.new_edits,ag=new g1.Map,ap=0,ad=aq.length;aq.forEach(function(ay,aw){if(ay._id&&L(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void am[av](ay,{ctx:aa},function(aA,az){ak[aw]=aA||az,ah()})}var ax=ay.metadata.id;ag.has(ax)?(ad--,ag.get(ax).push([ay,aw])):ag.set(ax,[[ay,aw]])}),ag.forEach(function(aw,ay){function az(){++ax<aw.length?av():ah()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(ac.has(ay)){jA(af,ac.get(ay),aA,ak,aB,az,au,aj)}else{var aD=di([],aA.metadata.rev_tree[0],af);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],t(aA,aB,az)}}var ax=0;av()})}function gj(t){try{return JSON.parse(t)}catch(aa){return hx.parse(t)}}function hN(t){return t.length<50000?JSON.parse(t):gj(t)}function Y(t){try{return JSON.stringify(t)}catch(aa){return hx.stringify(t)}}function gI(aa,ac,ad,ab){try{aa.apply(ac,ad)}catch(t){ab.emit("error",t)}}function ig(t){if(!a6.running&&a6.queue.length){a6.running=!0;var aa=a6.queue.shift();aa.action(function(ac,ab){gI(aa.callback,this,[ac,ab],t),a6.running=!1,gf.nextTick(function(){ig(t)})})}}function iI(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gO(gt,aa,ab.type))}}function a7(t,aa,ab){return{data:Y(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function jn(t){if(!t){return null}var aa=hN(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function a8(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function go(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:hL(aa,ac):hX([""],{type:ac})):aa?"string"!=typeof aa?Z(aa,function(ad){ab(h3(ad))}):ab(aa):ab("")}function hq(t,ac,ag,aa){function ah(){++ab===af.length&&aa&&aa()}function ad(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ag.objectStore(ce).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ah()}}var af=Object.keys(t._attachments||{});if(!af.length){return aa&&aa()}var ab=0;af.forEach(function(aj){ac.attachments&&ac.include_docs?ad(t,aj):(t._attachments[aj].stub=!0,ah())})}function hv(t,aa){return hg.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hg.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new hg(function(aj){go(ad,ag,aa,function(ak){ac.doc._attachments[ah]=ai.extend(fc(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function ja(ac,ak,af){function ah(){ab--,ab||ag()}function ag(){ad.length&&ad.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aj["delete"](am)}})}var ad=[],aa=af.objectStore(gv),aj=af.objectStore(ce),t=af.objectStore(a2),ab=ac.length;ac.forEach(function(al){var am=aa.index("_doc_id_rev"),ap=ak+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ah()}aa["delete"](au);var av=t.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ad.push(ax),t["delete"](aw.primaryKey),aw["continue"]()}else{ah()}}}})}function O(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function jy(aj,aG,au,aF,av,ap,ax){function aJ(){var aN=[gW,gv,ce,ie,a2],aO=O(av,aN,"readwrite");return aO.error?ax(aO.error):(al=aO.txn,al.onabort=iI(ax),al.ontimeout=iI(ax),al.oncomplete=az,ag=al.objectStore(gW),ah=al.objectStore(gv),ab=al.objectStore(ce),aB=al.objectStore(a2),void aM(function(aP){return aP?(aq=!0,ax(aP)):void aL()}))}function am(){hf(aj.revs_limit,t,aF,ak,al,aw,ay,au)}function aL(){function aQ(){++aO===t.length&&am()}function aS(aU){var aV=jn(aU.target.result);aV&&ak.set(aV.id,aV),aQ()}if(t.length){for(var aO=0,aR=0,aP=t.length;aP>aR;aR++){var aT=t[aR];if(aT._id&&L(aT._id)){aQ()}else{var aN=ag.get(aT.metadata.id);aN.onsuccess=aS}}}}function az(){aq||(ap.notify(aF._meta.name),aF._meta.docCount+=aA,ax(null,aw))}function aI(aO,aP){var aN=ab.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=gO(fm,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(t.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aI(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function ay(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aH(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bb){var aZ=aP.stemmedRevs||[];aV&&aF.auto_compaction&&(aZ=aZ.concat(g0(aP.metadata))),aZ&&aZ.length&&ja(aZ,aP.metadata.id,al),aT.seq=bb.target.result,delete aT.rev;var ba=a7(aT,aW,aU),bc=ag.put(ba);bc.onsuccess=aN}function aX(ba){ba.preventDefault(),ba.stopPropagation();var bb=ah.index("_doc_id_rev"),aZ=bb.getKey(aR._doc_id_rev);aZ.onsuccess=function(bc){var bd=ah.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aw[aS]={ok:!0,id:aT.id,rev:aW},ak.set(aP.metadata.id,aP.metadata),aD(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ah.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aH(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aY){var bb=aP.data._attachments[aY];if(bb.stub){aO++,aN()}else{var aZ=bb.data;delete bb.data,bb.revpos=parseInt(aW,10);var ba=bb.digest;aC(ba,aZ,aV)}})}function aD(aN,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aW){var aX=aN.data._attachments[aW].digest,aV=aB.put({seq:aQ,digestSeq:aX+"::"+aQ});aV.onsuccess=aO,aV.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aN.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function aC(aO,aQ,aN){var aP=ab.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=ab.put(aS);aT.onsuccess=aN}}for(var al,ag,ah,ab,aB,ac,t=aG.docs,aA=0,aa=0,af=t.length;af>aa;aa++){var aE=t[aa];aE._id&&L(aE._id)||(aE=t[aa]=I(aE,au.new_edits),aE.error&&!ac&&(ac=aE))}if(ac){return ax(ac)}var aw=new Array(t.length),ak=new g1.Map,aq=!1,aK=aF._meta.blobSupport?"blob":"base64";bn(t,aK,function(aN){return aN?ax(aN):void aJ()})}function iL(aa,ac,ad,ab,t){try{if(aa&&ac){return t?IDBKeyRange.bound(ac,aa,!ad,!1):IDBKeyRange.bound(aa,ac,!1,!ad)}if(aa){return t?IDBKeyRange.upperBound(aa):IDBKeyRange.lowerBound(aa)}if(ac){return t?IDBKeyRange.lowerBound(ac,!ad):IDBKeyRange.upperBound(ac,!ad)}if(ab){return IDBKeyRange.only(ab)}}catch(af){return{error:af}}return null}function hD(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(gO(gt,t.name,t.message))}function iO(aa,ac,ad,ab){function t(ax,ak){function aA(aK,aL,aN){var aM=aK.id+"::"+aN;aI.get(aM).onsuccess=function(aO){aL.doc=a8(aO.target.result),ax.conflicts&&(aL.doc._conflicts=iT(aK)),hq(aL.doc,ax,al)}}function av(aN,aL,aM){var aO={id:aM.id,key:aM.id,value:{rev:aL}},aK=aM.deleted;if("ok"===ax.deleted){aF.push(aO),aK?(aO.value.deleted=!0,aO.doc=null):ax.include_docs&&aA(aM,aO,aL)}else{if(!aK&&aj--<=0&&(aF.push(aO),ax.include_docs&&aA(aM,aO,aL),0===--am)){return}}aN["continue"]()}function aD(aN){ag=ac._meta.docCount;var aL=aN.target.result;if(aL){var aK=jn(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function aC(){ak(null,{total_rows:ag,offset:ax.skip,rows:aF})}function aq(){ax.attachments?hv(aF,ax.binary).then(aC):aC()}var aw="startkey" in ax?ax.startkey:!1,aH="endkey" in ax?ax.endkey:!1,au="key" in ax?ax.key:!1,aj=ax.skip||0,am="number"==typeof ax.limit?ax.limit:-1,aG=ax.inclusive_end!==!1,aE="descending" in ax&&ax.descending?"prev":null,ay=iL(aw,aH,aG,au,aE);if(ay&&ay.error){return hD(ac,ax,ay.error,ak)}var ah=[gW,gv];ax.attachments&&ah.push(ce);var aB=O(ad,ah,"readonly");if(aB.error){return ak(aB.error)}var al=aB.txn,ap=al.objectStore(gW),aJ=al.objectStore(gv),az=aE?ap.openCursor(ay,aE):ap.openCursor(ay),aI=aJ.index("_doc_id_rev"),aF=[],ag=0;al.oncomplete=aq,az.onsuccess=aD}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ac._meta.docCount,offset:ag.skip,rows:[]}):void t(ag,ah)}af(aa,ab)}function i2(t){return new hg(function(ab){var aa=hX([""]);t.objectStore(iH).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function z(t,aa){var ab=this;a6.queue.push({action:function(ac){jf(ab,t,ac)},callback:aa}),ig(ab.constructor)}function jf(ag,af,aa){function ap(au){var av=au.createObjectStore(gW,{keyPath:"id"});au.createObjectStore(gv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(ce,{keyPath:"digest"}),au.createObjectStore(iM,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(iH),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(ie,{keyPath:"_id"});var aw=au.createObjectStore(a2,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function am(au,av){var aw=au.objectStore(gW);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=iv(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ab(au){au.createObjectStore(ie,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ah(ay,aw){var ax=ay.objectStore(ie),av=ay.objectStore(gW),az=ay.objectStore(gv),au=av.openCursor();au.onsuccess=function(aE){var aH=aE.target.result;if(aH){var aB=aH.value,aK=aB.id,aL=L(aK),aC=gX(aB);if(aL){var aF=aK+"::"+aC,aI=aK+"::",aD=aK+"::~",aG=az.index("_doc_id_rev"),aJ=IDBKeyRange.bound(aI,aD,!1,!1),aA=aG.openCursor(aJ);aA.onsuccess=function(aN){if(aA=aN.target.result){var aM=aA.value;aM._doc_id_rev===aF&&ax.put(aM),az["delete"](aA.primaryKey),aA["continue"]()}else{av["delete"](aH.primaryKey),aH["continue"]()}}}else{aH["continue"]()}}else{aw&&aw()}}}function al(au){var av=au.createObjectStore(a2,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(ay,aw){var ax=ay.objectStore(gv),av=ay.objectStore(ce),az=ay.objectStore(a2),au=av.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ax.openCursor().onsuccess=function(aE){var aI=aE.target.result;if(!aI){return aw()}for(var aJ=aI.value,aG=aI.primaryKey,aC=Object.keys(aJ._attachments||{}),aK={},aL=0;aL<aC.length;aL++){var aD=aJ._attachments[aC[aL]];aK[aD.digest]=!0}var aF=Object.keys(aK);for(aL=0;aL<aF.length;aL++){var aH=aF[aL];az.put({seq:aG,digestSeq:aH+"::"+aG})}aI["continue"]()}):aw()}}function ad(aw){function av(az){return az.data?jn(az):(az.deleted="1"===az.deletedOrLocal,az)}var ax=aw.objectStore(gv),ay=aw.objectStore(gW),au=ay.openCursor();au.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=ax.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=a7(aD,aD.winningRev,aD.deleted),aF=ay.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=av(aA.value);return aD.winningRev=aD.winningRev||gX(aD),aD.seq?az():void aB()}}}var aq=af.name,ac=null;ag._meta=null,ag.type=function(){return"idb"},ag._id=co(function(au){au(null,ag._meta.instanceId)}),ag._bulkDocs=function(aw,av,au){jy(af,aw,av,ag,ac,ft,au)},ag._get=function(aB,ax,ay){function au(){ay(aA,{doc:aC,metadata:av,ctx:aw})}var aC,av,aA,aw=ax.ctx;if(!aw){var az=O(ac,[gW,gv,ce],"readonly");if(az.error){return ay(az.error)}aw=az.txn}aw.objectStore(gW).get(aB).onsuccess=function(aG){if(av=jn(aG.target.result),!av){return aA=gO(ik,"missing"),au()}if(iv(av)&&!ax.rev){return aA=gO(ik,"deleted"),au()}var aE=aw.objectStore(gv),aD=ax.rev||av.winningRev,aF=av.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aC=aH.target.result,aC&&(aC=a8(aC)),aC?void au():(aA=gO(ik,"missing"),au())}}},ag._getAttachment=function(aB,ax,ay,au,aC){var av;if(au.ctx){av=au.ctx}else{var aA=O(ac,[gW,gv,ce],"readonly");if(aA.error){return aC(aA.error)}av=aA.txn}var aw=ay.digest,az=ay.content_type;av.objectStore(ce).get(aw).onsuccess=function(aE){var aD=aE.target.result.body;go(aD,az,au.binary,function(aF){aC(null,aF)})}},ag._info=function(av){if(null===ac||!iR.has(aq)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var au,ay,ax=O(ac,[gv],"readonly");if(ax.error){return av(ax.error)}var aw=ax.txn,az=aw.objectStore(gv).openCursor(null,"prev");az.onsuccess=function(aB){var aC=aB.target.result;au=aC?aC.key:0,ay=ag._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:au,idb_attachment_format:ag._meta.blobSupport?"binary":"base64"})}},ag._allDocs=function(av,au){iO(av,ag,ac,au)},ag._changes=function(av){function aJ(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aI=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aH.get(aU);aT.onsuccess=function(aV){aO(a8(aV.target.result))}}function aO(aU){var aT=av.processChange(aU,aN,av);aT.seq=aN.seq;var aV=aw(aT);return"object"==typeof aV?av.complete(aV):(aV&&(aK++,aD&&aC.push(aT),av.attachments&&av.include_docs?hq(aU,av,az,function(){hv([aT],av.binary).then(function(){av.onChange(aT)})}):av.onChange(aT)),void (aK!==ax&&aS["continue"]()))}var aQ=a8(aS.value),aR=aS.key;if(aB&&!aB.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aL.get(aQ._id).onsuccess=function(aT){aN=jn(aT.target.result),ay.set(aQ._id,aN),aM()})}function aF(aN){var aM=aN.target.result;aM&&aJ(aM)}function aE(){var aM=[gW,gv];av.attachments&&aM.push(ce);var aN=O(ac,aM,"readonly");if(aN.error){return av.complete(aN.error)}az=aN.txn,az.onabort=iI(av.complete),az.oncomplete=aA,aG=az.objectStore(gv),aL=az.objectStore(gW),aH=aG.index("_doc_id_rev");var aO;aO=av.descending?aG.openCursor(null,"prev"):aG.openCursor(IDBKeyRange.lowerBound(av.since,!0)),aO.onsuccess=aF}function aA(){function aM(){av.complete(null,{results:aC,last_seq:aI})}!av.continuous&&av.attachments?hv(aC).then(aM):aM()}if(av=fv(av),av.continuous){var au=aq+":"+iC();return ft.addListener(aq,au,ag,av),ft.notify(aq),{cancel:function(){ft.removeListener(aq,au)}}}var aB=av.doc_ids&&new g1.Set(av.doc_ids);av.since=av.since||0;var aI=av.since,ax="limit" in av?av.limit:-1;0===ax&&(ax=1);var aD;aD="return_docs" in av?av.return_docs:"returnDocs" in av?av.returnDocs:!0;var az,aG,aL,aH,aC=[],aK=0,aw=hH(av),ay=new g1.Map;aE()},ag._close=function(au){return null===ac?au(gO(hG)):(ac.close(),iR["delete"](aq),ac=null,void au())},ag._getRevisionTree=function(aw,av){var ax=O(ac,[gW],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,au=ay.objectStore(gW).get(aw);au.onsuccess=function(aA){var az=jn(aA.target.result);az?av(null,az.rev_tree):av(gO(ik))}},ag._doCompaction=function(aA,av,ay){var az=[gW,gv,ce,a2],au=O(ac,az,"readwrite");if(au.error){return ay(au.error)}var ax=au.txn,aw=ax.objectStore(gW);aw.get(aA).onsuccess=function(aC){var aE=jn(aC.target.result);iy(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),ja(av,aA,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(gW).put(a7(aE,aD,aB))},ax.onabort=iI(ay),ax.oncomplete=function(){ay()}},ag._getLocal=function(aw,av){var ax=O(ac,[ie],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,au=ay.objectStore(ie).get(aw);au.onerror=iI(av),au.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,av(null,az)):av(gO(ik))}},ag._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=O(ac,[ie],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=iI(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(ie);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(gO(ju))}}):(az=aC.add(aD),az.onerror=function(aE){aA(gO(ju)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ag._removeLocal=function(aB,ax,ay){"function"==typeof ax&&(ay=ax,ax={});var au=ax.ctx;if(!au){var aC=O(ac,[ie],"readwrite");if(aC.error){return ay(aC.error)}au=aC.txn,au.oncomplete=function(){av&&ay(null,av)}}var av,aA=aB._id,aw=au.objectStore(ie),az=aw.get(aA);az.onerror=iI(ay),az.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aB._rev?(aw["delete"](aA),av={ok:!0,id:aA,rev:"0-0"},ax.ctx&&ay(null,av)):ay(gO(ik))}},ag._destroy=function(ax,av){ft.removeAllListeners(aq);var aw=hQ.get(aq);aw&&aw.result&&(aw.result.close(),iR["delete"](aq));var au=indexedDB.deleteDatabase(aq);au.onsuccess=function(){hQ["delete"](aq),fU()&&aq in localStorage&&delete localStorage[aq],av(null,{ok:!0})},au.onerror=iI(av)};var aj=iR.get(aq);if(aj){return ac=aj.idb,ag._meta=aj.global,void gf.nextTick(function(){aa(null,ag)})}var t;t=af.storage?ci(aq,af.storage):indexedDB.open(aq,h8),hQ.set(aq,t),t.onupgradeneeded=function(aw){function ay(){var aA=az[au-1];au++,aA&&aA(ax,ay)}var av=aw.target.result;if(aw.oldVersion<1){return ap(av)}var ax=aw.currentTarget.transaction;aw.oldVersion<3&&ab(av),aw.oldVersion<4&&al(av);var az=[am,ah,ak,ad],au=aw.oldVersion;ay()},t.onsuccess=function(av){ac=av.target.result,ac.onversionchange=function(){ac.close(),iR["delete"](aq)},ac.onabort=function(aA){iu("error","Database has a global failure",aA.target.error),ac.close(),iR["delete"](aq)};var ax=ac.transaction([iM,iH,gW],"readwrite"),az=ax.objectStore(iM).get(iM),aw=null,ay=null,au=null;az.onsuccess=function(aB){var aD=function(){null!==aw&&null!==ay&&null!==au&&(ag._meta={name:aq,instanceId:au,blobSupport:aw,docCount:ay},iR.set(aq,{idb:ac,global:ag._meta}),aa(null,ag))},aA=aB.target.result||{id:iM};aq+"_id" in aA?(au=aA[aq+"_id"],aD()):(au=iC(),aA[aq+"_id"]=au,ax.objectStore(iM).put(aA).onsuccess=function(){aD()}),fX||(fX=i2(ax)),fX.then(function(aE){aw=aE,aD()});var aC=ax.objectStore(gW).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ay=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iu("error",au),aa(gO(gt,au))}}function ci(t,aa){try{return indexedDB.open(t,{version:h8,storage:aa})}catch(ab){return indexedDB.open(t,h8)}}function ji(t){t.adapter("idb",z,!0)}function jh(t){return decodeURIComponent(escape(t))}function id(t){return 65>t?t-48:t-55}function R(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(id(aa.charCodeAt(ac++))<<4|id(aa.charCodeAt(ac++)))}return ab}function hT(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(id(aa.charCodeAt(ac+2))<<12|id(aa.charCodeAt(ac+3))<<8|id(aa.charCodeAt(ac))<<4|id(aa.charCodeAt(ac+1))),ac+=4}return ab}function jc(t,aa){return"UTF-8"===aa?jh(R(t,0,t.length)):hT(t,0,t.length)}function hW(t){return"'"+t+"'"}function jD(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function js(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jx(t){return delete t._id,delete t._rev,JSON.stringify(t)}function gn(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function hk(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function hm(aa,ac,ad,ab,t){return"SELECT "+aa+" FROM "+("string"==typeof ac?ac:ac.join(" JOIN "))+(ad?" ON "+ad:"")+(ab?" WHERE "+("string"==typeof ab?ab:ab.join(" AND ")):"")+(t?" ORDER BY "+t:"")}function jv(t,ab,ag){function aa(){++ac===t.length&&ad()}function ad(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+J+" WHERE seq IN "+hk(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+J+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+J+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new g1.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+J+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+jz+" WHERE digest=?",[az]))})})})}})}}if(t.length){var ac=0,af=[];t.forEach(function(ah){var aj="SELECT seq FROM "+gQ+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ab,ah],function(al,am){if(!am.rows.length){return aa()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+gQ+" WHERE seq=?",[ak],aa)})})}}function iK(t){return function(ad){iu("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gO(hl,ab,ac))}}function h6(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function it(t,ad,av,az,ax,aw,aj){function aB(){return ac?aj(ac):(aw.notify(az._name),az._docCount=-1,void aj(null,ah))}function af(aD,aE){var aC="SELECT count(*) as cnt FROM "+jz+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gO(fm,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aA(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){af(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ab(aE,aL,aQ,aG,aI,aO,aJ,aM){function aC(){function aT(bc,ba){function bb(){return ++bf===bg.length&&ba(),!1}function aZ(bh){var bj="INSERT INTO "+J+" (digest, seq) VALUES (?,?)",bi=[aU._attachments[bh].digest,bc];ap.executeSql(bj,bi,bb,bb)}var bf=0,bg=Object.keys(aU._attachments||{});if(!bg.length){return ba()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aU=aE.data,aR=aG?1:0,aW=aU._id,aS=aU._rev,aY=jx(aU),aX="INSERT INTO "+gQ+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aV=[aW,aS,aY,aR];ap.executeSql(aX,aV,function(aZ,ba){var bb=ba.insertId;aT(bb,function(){aD(aZ,bb)})},function(){var aZ=hm("seq",gQ,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aW,aS],function(bb,bf){var bd=bf.rows.item(0).seq,bc="UPDATE "+gQ+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aY,aR,aW,aS];bb.executeSql(bc,ba,function(bg){aT(bd,function(){aD(bg,bd)})})}),!1})}function aF(aR){aH||(aR?(aH=aR,aM(aH)):aN===aP.length&&aC())}function aK(aR){aN++,aF(aR)}function aD(aX,aR){var aV=aE.metadata.id,aW=aE.stemmedRevs||[];aI&&az.auto_compaction&&(aW=g0(aE.metadata).concat(aW)),aW.length&&jv(aW,aV,aX),aE.metadata.seq=aR,delete aE.metadata.rev;var aU=aI?"UPDATE "+hP+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+gQ+" WHERE doc_id="+hP+".id AND rev=?) WHERE id=?":"INSERT INTO "+hP+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=Y(aE.metadata),aS=aI?[aT,aR,aL,aV]:[aV,aR,aR,aT];aX.executeSql(aU,aS,function(){ah[aJ]={ok:!0,id:aE.metadata.id,rev:aL},am.set(aV,aE.metadata),aM()})}var aH=null,aN=0;aE.data._id=aE.metadata.id,aE.data._rev=aE.metadata.rev;var aP=Object.keys(aE.data._attachments||{});aG&&(aE.data._deleted=!0),aP.forEach(function(aS){var aU=aE.data._attachments[aS];if(aU.stub){aN++,aF()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aL,10);var aR=aU.digest;ay(aR,aT,aK)}}),aP.length||aC()}function ak(){hf(t.revs_limit,aq,az,am,ap,ah,ab,av)}function au(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&L(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hP+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=hN(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function ay(aD,aF,aC){var aE="SELECT digest FROM "+jz+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+jz+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jD(aF)],function(){aC()},function(){return aC(),!1}))})}var al=av.new_edits,ag=ad.docs,aq=ag.map(function(aC){if(aC._id&&L(aC._id)){return aC}var aD=I(aC,al);return aD}),aa=aq.filter(function(aC){return aC.error});if(aa.length){return aj(aa[0])}var ap,ac,ah=new Array(aq.length),am=new g1.Map;bn(aq,"binary",function(aC){return aC?aj(aC):void ax.transaction(function(aD){ap=aD,aA(function(aE){aE?ac=aE:au(ak)})},iK(aj),aB)})}function o(t){return t.websql(t.name,t.version,t.description,t.size)}function i0(t){try{return{db:o(t)}}catch(aa){return{error:aa}}}function hb(t){var aa=ir.get(t.name);return aa||(aa=i0(t),ir.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function fp(af,ac,ah,aa,ag){function ad(){++t===aj.length&&ag&&ag()}function ab(am,ak){var al=am._attachments[ak],ap={binary:ac.binary,ctx:aa};ah._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=ai.extend(fc(al,["digest","content_type"]),{data:aq}),ad()})}var aj=Object.keys(af._attachments||{});if(!aj.length){return ag&&ag()}var t=0;aj.forEach(function(ak){ac.attachments&&ac.include_docs?ab(af,ak):(af._attachments[ak].stub=!0,ad())})}function fS(ap,au){function t(){fU()&&(window.localStorage["_pouch__websqldb_"+ah._name]=!0),au(null,ah)}function aC(aD,aE){aD.executeSql(gr),aD.executeSql("ALTER TABLE "+gQ+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(r),aD.executeSql("ALTER TABLE "+hP+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hP+" (local, id)");var aF="SELECT "+hP+".winningseq AS seq, "+hP+".json AS metadata FROM "+gQ+" JOIN "+hP+" ON "+gQ+".seq = "+hP+".winningseq";aD.executeSql(aF,[],function(aN,aJ){for(var aG=[],aL=[],aK=0;aK<aJ.rows.length;aK++){var aI=aJ.rows.item(aK),aH=aI.seq,aM=JSON.parse(aI.metadata);iv(aM)&&aG.push(aH),L(aM.id)&&aL.push(aM.id)}aN.executeSql("UPDATE "+hP+"SET local = 1 WHERE id IN "+hk(aL.length),aL,function(){aN.executeSql("UPDATE "+gQ+" SET deleted = 1 WHERE seq IN "+hk(aG.length),aG,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hh+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hP+".id AS id, "+gQ+".json AS data FROM "+gQ+" JOIN "+hP+" ON "+gQ+".seq = "+hP+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aH,aK){function aI(){if(!aL.length){return aF(aH)}var aM=aL.shift(),aN=JSON.parse(aM.data)._rev;aH.executeSql("INSERT INTO "+hh+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hP+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+gQ+" WHERE seq=?",[aM.seq],function(){aI()})})})}for(var aL=[],aJ=0;aJ<aK.rows.length;aJ++){aL.push(aK.rows.item(aJ))}aI()})})}function ay(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aL=aH.shift(),aN=jc(aL.hex,ac),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aO=aN.substring(aK+2),aJ="UPDATE "+gQ+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aM,aO,aN],function(){aI()})}aI()}var aF="ALTER TABLE "+gQ+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+gQ+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(gS,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+gQ;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ab(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+jz;aI.executeSql(aH,[],function(aM,aK){function aN(){var aP=hm(i9+", "+hP+".id AS id",[hP,gQ],iw,null,hP+".id ");aP+=" LIMIT "+aJ+" OFFSET "+aO,aO+=aJ,aM.executeSql(aP,[],function(ba,aY){function aU(bc,bd){var bf=aW[bc]=aW[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aY.rows.length){return aG(ba)}for(var aW={},aS=0;aS<aY.rows.length;aS++){for(var aZ=aY.rows.item(aS),aQ=gn(aZ.data,aZ.id,aZ.rev),aV=Object.keys(aQ._attachments||{}),aT=0;aT<aV.length;aT++){var aX=aQ._attachments[aV[aT]];aU(aX.digest,aZ.seq)}}var bb=[];if(Object.keys(aW).forEach(function(bc){var bd=aW[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aN()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+J+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aG(aM)}var aO=0,aJ=10;aN()})}var aF="CREATE TABLE IF NOT EXISTS "+J+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(gq,[],function(aI){aI.executeSql(K,[],aD)})})}function aa(aE,aF){var aD="ALTER TABLE "+jz+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ad(aE,aF){var aD="ALTER TABLE "+hP+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hP+" SET max_seq=(SELECT MAX(seq) FROM "+gQ+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hP+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aj(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ac=2===aG.length?"UTF-8":"UTF-16",aE()})}function ag(){for(;ax.length>0;){var aD=ax.pop();aD(null,av)}}function am(aK,aO){if(0===aO){var aF="CREATE TABLE IF NOT EXISTS "+hV+" (dbid, db_version INTEGER)",aI="CREATE TABLE IF NOT EXISTS "+jz+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aL="CREATE TABLE IF NOT EXISTS "+J+" (digest, seq INTEGER)",aN="CREATE TABLE IF NOT EXISTS "+hP+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aM="CREATE TABLE IF NOT EXISTS "+gQ+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aG="CREATE TABLE IF NOT EXISTS "+hh+" (id UNIQUE, rev, json)";aK.executeSql(aI),aK.executeSql(aG),aK.executeSql(aL,[],function(){aK.executeSql(K),aK.executeSql(gq)}),aK.executeSql(aN,[],function(){aK.executeSql(gr),aK.executeSql(aM,[],function(){aK.executeSql(r),aK.executeSql(gS),aK.executeSql(aF,[],function(){var aP="INSERT INTO "+hV+" (db_version, dbid) VALUES (?,?)";av=iC();var aQ=[jj,av];aK.executeSql(aP,aQ,function(){ag()})})})})}else{var aE=function(){var aQ=jj>aO;aQ&&aK.executeSql("UPDATE "+hV+" SET db_version = "+jj);var aP="SELECT dbid FROM "+hV;aK.executeSql(aP,[],function(aR,aS){av=aS.rows.item(0).dbid,ag()})},aH=[aC,aq,ay,ab,aa,ad,aE],aJ=aO,aD=function(aP){aH[aJ-1](aP,aD),aJ++};aD(aK)}}function az(){al.transaction(function(aD){aj(aD,function(){ak(aD)})},iK(au),t)}function ak(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+hV;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+hV,[],function(aH,aI){var aJ=aI.rows.item(0).db_version;am(aH,aJ)}):aF.executeSql("ALTER TABLE "+hV+" ADD COLUMN db_version INTEGER",[],function(){am(aF,1)}):am(aF,0)})}function aw(aE,aF){if(-1!==ah._docCount){return aF(ah._docCount)}var aD=hm("COUNT("+hP+".id) AS 'num'",[hP,gQ],iw,gQ+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ah._docCount=aH.rows.item(0).num,aF(ah._docCount)})}var ac,ah=this,av=null,aB=h6(ap),ax=[];ah._docCount=-1,ah._name=ap.name;var aA=ai.extend({},ap,{version:T,description:ap.name,size:aB}),af=hb(aA);if(af.error){return iK(au)(af.error)}var al=af.db;"function"!=typeof al.readTransaction&&(al.readTransaction=al.transaction),az(),ah.type=function(){return"websql"},ah._id=co(function(aD){aD(null,av)}),ah._info=function(aD){al.readTransaction(function(aE){aw(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+gQ;aE.executeSql(aG,[],function(aI,aH){var aJ=aH.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aJ,sqlite_plugin:al._sqlitePlugin,websql_encoding:ac})})})},iK(aD))},ah._bulkDocs=function(aF,aD,aE){it(ap,aF,aD,ah,al,hJ,aE)},ah._get=function(aL,aK,aD){function aG(){aD(aI,{doc:aF,metadata:aM,ctx:aE})}var aF,aM,aI,aE=aK.ctx;if(!aE){return al.readTransaction(function(aN){ah._get(aL,ai.extend({ctx:aN},aK),aD)})}var aH,aJ;aK.rev?(aH=hm(i9,[hP,gQ],hP+".id="+gQ+".doc_id",[gQ+".doc_id=?",gQ+".rev=?"]),aJ=[aL,aK.rev]):(aH=hm(i9,[hP,gQ],iw,hP+".id=?"),aJ=[aL]),aE.executeSql(aH,aJ,function(aP,aO){if(!aO.rows.length){return aI=gO(ik,"missing"),aG()}var aN=aO.rows.item(0);return aM=hN(aN.metadata),aN.deleted&&!aK.rev?(aI=gO(ik,"deleted"),aG()):(aF=gn(aN.data,aM.id,aN.rev),void aG())})},ah._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(hP+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(hP+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(hP+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(hP+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(gQ+".deleted = 0"),al.readTransaction(function(aR){aw(aR,function(aS){if(aF=aS,0!==aH){var aT=hm(i9,[hP,gQ],iw,aL,hP+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aZ,aW){for(var aX=0,bc=aW.rows.length;bc>aX;aX++){var ba=aW.rows.item(aX),aY=hN(ba.metadata),aU=aY.id,bb=gn(ba.data,aU,ba.rev),aV=bb._rev,bd={id:aU,key:aU,value:{rev:aV}};if(aQ.include_docs&&(bd.doc=bb,bd.doc._rev=aV,aQ.conflicts&&(bd.doc._conflicts=iT(aY)),fp(bd.doc,aQ,ah,aZ)),ba.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},iK(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ah._changes=function(aG){function aF(){var aN=hP+".json AS metadata, "+hP+".max_seq AS maxSeq, "+gQ+".json AS winningDoc, "+gQ+".rev AS winningRev ",aM=hP+" JOIN "+gQ,aO=hP+".id="+gQ+".doc_id AND "+hP+".winningseq="+gQ+".seq",aP=["maxSeq > ?"],aR=[aG.since];aG.doc_ids&&(aP.push(hP+".id IN "+hk(aG.doc_ids.length)),aR=aR.concat(aG.doc_ids));var aL="maxSeq "+(aJ?"DESC":"ASC"),aS=hm(aN,aM,aO,aP,aL),aT=hH(aG);aG.view||aG.filter||(aS+=" LIMIT "+aE);var aQ=aG.since||0;al.readTransaction(function(aU){aU.executeSql(aS,aR,function(aY,aX){function ba(bg){return function(){aG.onChange(bg)}}for(var bd=0,aV=aX.rows.length;aV>bd;bd++){var aW=aX.rows.item(bd),aZ=hN(aW.metadata);aQ=aW.maxSeq;var bf=gn(aW.winningDoc,aZ.id,aW.winningRev),bb=aG.processChange(bf,aZ,aG);bb.seq=aW.maxSeq;var bc=aT(bb);if("object"==typeof bc){return aG.complete(bc)}if(bc&&(aK++,aH&&aI.push(bb),aG.attachments&&aG.include_docs?fp(bf,aG,ah,aY,ba(bb)):ba(bb)()),aK===aE){break}}})},iK(aG.complete),function(){aG.continuous||aG.complete(null,{results:aI,last_seq:aQ})})}if(aG=fv(aG),aG.continuous){var aD=ah._name+":"+iC();return hJ.addListener(ah._name,aD,ah,aG),hJ.notify(ah._name),{cancel:function(){hJ.removeListener(ah._name,aD)}}}var aJ=aG.descending;aG.since=aG.since&&!aJ?aG.since:0;var aE="limit" in aG?aG.limit:-1;0===aE&&(aE=1);var aH;aH="return_docs" in aG?aG.return_docs:"returnDocs" in aG?aG.returnDocs:!0;var aI=[],aK=0;aF()},ah._close=function(aD){aD()},ah._getAttachment=function(aL,aK,aD,aG,aF){var aM,aI=aG.ctx,aE=aD.digest,aH=aD.content_type,aJ="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+jz+" WHERE digest=?";aI.executeSql(aJ,[aE],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?js(aO.body):jc(aO.body,ac);aM=aG.binary?hs(aN,aH):h3(aN),aF(null,aM)})},ah._getRevisionTree=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hP+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=hN(aJ.rows.item(0).metadata);aE(null,aI.rev_tree)}else{aE(gO(ik))}})})},ah._doCompaction=function(aE,aF,aD){return aF.length?void al.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hP+" WHERE id = ?";aH.executeSql(aG,[aE],function(aI,aK){var aJ=hN(aK.rows.item(0).metadata);iy(aJ.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aL="UPDATE "+hP+" SET json = ? WHERE id = ?";aI.executeSql(aL,[Y(aJ),aE])}),jv(aF,aE,aH)},iK(aD),function(){aD()}):aD()},ah._getLocal=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hh+" WHERE id=?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=aJ.rows.item(0),aK=gn(aI.json,aD,aI.rev);aE(null,aK)}else{aE(gO(ik))}})})},ah._putLocal=function(aI,aE,aK){function aD(aO){var aM,aN;aJ?(aM="UPDATE "+hh+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aL,aF,aG,aJ]):(aM="INSERT INTO "+hh+" (id, rev, json) VALUES (?,?,?)",aN=[aG,aL,aF]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aH={ok:!0,id:aG,rev:aL},aE.ctx&&aK(null,aH)):aK(gO(ju))},function(){return aK(gO(ju)),!1})}"function"==typeof aE&&(aK=aE,aE={}),delete aI._revisions;var aL,aJ=aI._rev,aG=aI._id;aL=aJ?aI._rev="0-"+(parseInt(aJ.split("-")[1],10)+1):aI._rev="0-1";var aH,aF=jx(aI);aE.ctx?aD(aE.ctx):al.transaction(aD,iK(aK),function(){aH&&aK(null,aH)})},ah._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+hh+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(gO(ik))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):al.transaction(aF,iK(aH),function(){aD&&aH(null,aD)})},ah._destroy=function(aD,aE){hJ.removeAllListeners(ah._name),al.transaction(function(aF){var aG=[hP,gQ,jz,hV,hh,J];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},iK(aE),function(){fU()&&(delete window.localStorage["_pouch__websqldb_"+ah._name],delete window.localStorage[ah._name]),aE(null,{ok:!0})})}}function i7(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function hd(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var t=fU(),aa="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[aa]){return"1"===localStorage[aa]}var ab=i7();return t&&(localStorage[aa]=ab?"1":"0"),ab}function ct(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:hd()}function bo(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=ai.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function gK(aa,ac){var t=bo(aa),ab=ai.extend({websql:t},aa);fS.call(this,ab,ac)}function br(t){t.adapter("websql",gK,!0)}function w(){for(var aa={},ac=new hg(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,hg.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function S(t,ab){var ag,aa,ad,ac=new Headers,af={method:t.method,credentials:"include",headers:ac};return t.json&&(ac.set("Accept","application/json"),ac.set("Content-Type",t.headers["Content-Type"]||"application/json")),t.body&&t.body instanceof Blob?iJ(t.body,function(ah){af.body=ah}):t.body&&t.processData&&"string"!=typeof t.body?af.body=JSON.stringify(t.body):"body" in t?af.body=t.body:af.body=null,Object.keys(t.headers).forEach(function(ah){t.headers.hasOwnProperty(ah)&&ac.set(ah,t.headers[ah])}),ag=w(t.url,af),t.timeout>0&&(aa=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+t.url))},t.timeout)),ag.promise.then(function(ah){return ad={statusCode:ah.status},t.timeout>0&&clearTimeout(aa),ad.statusCode>=200&&ad.statusCode<300?t.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ad.statusCode>=200&&ad.statusCode<300?ab(null,ad,ah):ab(ah,ad)})["catch"](function(ah){ab(ah,ad)}),{abort:ag.reject}}function fg(af,ac){var ah,aa,ag=!1,ad=function(){ah.abort()},ab=function(){ag=!0,ah.abort()};ah=af.xhr?new af.xhr:new XMLHttpRequest;try{ah.open(af.method,af.url)}catch(aj){ac(aj,{statusCode:413})}ah.withCredentials="withCredentials" in af?af.withCredentials:!0,"GET"===af.method?delete af.headers["Content-Type"]:af.json&&(af.headers.Accept="application/json",af.headers["Content-Type"]=af.headers["Content-Type"]||"application/json",af.body&&af.processData&&"string"!=typeof af.body&&(af.body=JSON.stringify(af.body))),af.binary&&(ah.responseType="arraybuffer"),"body" in af||(af.body=null);for(var t in af.headers){af.headers.hasOwnProperty(t)&&ah.setRequestHeader(t,af.headers[t])}return af.timeout>0&&(aa=setTimeout(ab,af.timeout),ah.onprogress=function(){clearTimeout(aa),4!==ah.readyState&&(aa=setTimeout(ab,af.timeout))},"undefined"!=typeof ah.upload&&(ah.upload.onprogress=ah.onprogress)),ah.onreadystatechange=function(){if(4===ah.readyState){var ak={statusCode:ah.status};if(ah.status>=200&&ah.status<300){var am;am=af.binary?hX([ah.response||""],{type:ah.getResponseHeader("Content-Type")}):ah.responseText,ac(null,ak,am)}else{var ap={};if(ag){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ah.response)}catch(al){}}ac(ap,ak)}}},af.body&&af.body instanceof Blob?iJ(af.body,function(ak){ah.send(ak)}):ah.send(af.body),{abort:ad}}function h1(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function g6(t,aa){return en||t.xhr?fg(t,aa):S(t,aa)}function fT(){return""}function im(aa,ac){function ad(ag,ah,af){if(!aa.binary&&aa.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?fh(ak):ak})),aa.binary&&p(ag,ah),af(null,ag,ah)}function ab(af,ah){var ak,ag;if(af.code&&af.status){var al=new Error(af.message||af.code);return al.status=af.status,ah(al)}if(af.message&&"ETIMEDOUT"===af.message){return ah(af)}try{ak=JSON.parse(af.responseText),ag=fh(ak)}catch(aj){ag=fh(af)}ah(ag)}aa=fv(aa);var t={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return aa=ai.extend(t,aa),aa.json&&(aa.binary||(aa.headers.Accept="application/json"),aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json"),aa.binary&&(aa.encoding=null,aa.json=!1),aa.processData||(aa.json=!1),g6(aa,function(ag,ak,am){if(ag){return ag.status=ak?ak.statusCode:400,ab(ag,ac)}var aj,al=ak.headers&&ak.headers["content-type"],af=am||fT();if(!aa.binary&&(aa.json||!aa.processData)&&"object"!=typeof af&&(/json/.test(al)||/^[\s]*\{/.test(af)&&/\}[\s]*$/.test(af))){try{af=JSON.parse(af.toString())}catch(ah){}}ak.statusCode>=200&&ak.statusCode<300?ad(af,ak,ac):(aj=fh(af),aj.status=ak.statusCode,ac(aj))})}function g7(ac,ak){var af=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ah=-1!==af.indexOf("safari")&&-1===af.indexOf("chrome"),ag=-1!==af.indexOf("msie"),ad=-1!==af.indexOf("edge"),aa=ah||(ag||ad)&&"GET"===ac.method,aj="cache" in ac?ac.cache:!0,t=/^blob:/.test(ac.url);if(!t&&(aa||!aj)){var ab=-1!==ac.url.indexOf("?");ac.url+=(ab?"&":"?")+"_nonce="+Date.now()}return im(ac,ak)}function fw(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=hL(ab.data,ab.content_type)})}function gs(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function a3(t){return t._attachments&&Object.keys(t._attachments)?hg.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hg(function(ac){H(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hg.resolve()}function gV(t){var aa=ix(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function ha(t,aa){return j(t,t.db+"/"+aa)}function j(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function a4(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function h4(av,aq){function ap(ax,aA,az){var ay=ax.ajax||{},aw=ai.extend(fv(aa),ay,aA);return C(aw.method+" "+aw.url),ah._ajax(aw,az)}function ab(aw,ax){return new hg(function(az,ay){ap(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function ac(aw,ax){return eo(aw,hw(function(ay){aj().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aj(){if(av.skipSetup||av.skip_setup){return hg.resolve()}if(au){return au}var aw={method:"GET",url:t};return au=ab({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(jd(404,"PouchDB is just detecting if the remote exists."),ab({},{method:"PUT",url:t})):hg.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hg.reject(ax)}),au["catch"](function(){au=null}),au}function am(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ah=this,ad=gV;av.getHost&&(ad=av.getHost);var al=ad(av.name,av),t=ha(al,"");av=fv(av);var aa=av.ajax||{};if(ah.getUrl=function(){return t},ah.getHeaders=function(){return aa.headers||{}},av.auth||al.auth){var af=av.auth||al.auth,ak=af.username+":"+af.password,ag=h3(unescape(encodeURIComponent(ak)));aa.headers=aa.headers||{},aa.headers.Authorization="Basic "+ag}ah._ajax=g7;var au;setTimeout(function(){aq(null,ah)}),ah.type=function(){return"http"},ah.id=ac("id",function(aw){ap({},{method:"GET",url:j(al,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+al.db:ha(al,"");aw(null,ay)})}),ah.request=ac("request",function(aw,ax){aw.url=ha(al,aw.url),ap({},aw,ax)}),ah.compact=ac("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=fv(aw),ap(aw,{url:ha(al,"_compact"),method:"POST"},function(){function ay(){ah.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ah.bulkGet=eo("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ap({},{url:ha(al,"_bulk_get"+a4(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aF(aK){return function(aM,aL){aJ[aK]=aL.results,++aE===aH&&aA(null,{results:fx(aJ)})}}for(var aI=iG,aH=Math.ceil(aC.docs.length/aI),aE=0,aJ=new Array(aH),aD=0;aH>aD;aD++){var aG=fc(aC,["revs","attachments"]);aG.ajax=aa,aG.docs=aC.docs.slice(aD*aI,Math.min(aC.docs.length,(aD+1)*aI)),cn(az,aG,aF(aD))}}var az=this,ay=j(al,""),aw=gH[ay];"boolean"!=typeof aw?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(gH[ay]=!1,jd(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{gH[ay]=!0,aA(null,aE)}}):aw?ax(aA):aB()}),ah._info=function(aw){aj().then(function(){ap({},{method:"GET",url:ha(al,"")},function(ay,ax){return ay?aw(ay):(ax.host=ha(al,""),void aw(null,ax))})})["catch"](aw)},ah.get=ac("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hg.all(aF.map(function(aH){var aG=aD[aH],aI=gs(aE._id)+"/"+am(aH)+"?rev="+aE._rev;return ab(aC,{method:"GET",url:ha(al,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:new hg(function(aK){H(aJ,aK)})}).then(function(aJ){delete aG.stub,delete aG.length,aG.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?hg.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=fv(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=gs(aA);var ay={method:"GET",url:ha(al,aA+a4(aw))};ab(aC,ay).then(function(aD){return hg.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ah.remove=ac("remove",function(aB,az,ax,ay){var aA;"string"==typeof az?(aA={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aA=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aw=aA._rev||ax.rev;ap(ax,{method:"DELETE",url:ha(al,gs(aA._id))+"?rev="+aw},ay)}),ah.getAttachment=ac("getAttachment",function(aB,ax,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.rev?"?rev="+az.rev:"",ay=ha(al,gs(aB))+"/"+am(ax)+aw;ap(az,{method:"GET",url:ay,binary:!0},aA)}),ah.removeAttachment=ac("removeAttachment",function(ax,aA,ay,az){var aw=ha(al,gs(ax)+"/"+am(aA))+"?rev="+ay;ap({},{method:"DELETE",url:aw},az)}),ah.putAttachment=ac("putAttachment",function(ax,aE,aC,aB,az,aD){"function"==typeof az&&(aD=az,az=aB,aB=aC,aC=null);var aF=gs(ax)+"/"+am(aE),aG=ha(al,aF);if(aC&&(aG+="?rev="+aC),"string"==typeof aB){var aA;try{aA=dn(aB)}catch(aw){return aD(gO(fn,"Attachment is not a valid base64 string"))}aB=aA?hs(aA,az):""}var ay={headers:{"Content-Type":az},method:"PUT",url:aG,processData:!1,body:aB,timeout:aa.timeout||60000};ap({},ay,aD)}),ah._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,aj().then(function(){return hg.all(ax.docs.map(a3))}).then(function(){ap(aw,{method:"POST",url:ha(al,"_bulk_docs"),body:ax},function(aA,az){return aA?ay(aA):(az.forEach(function(aB){aB.ok=!0}),void ay(null,az))})})["catch"](ay)},ah.allDocs=ac("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=fv(aA);var ax,aB={},az="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var ay=a4(aB);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=ff?ay+="&"+aw:(az="POST",ax={keys:aA.keys})}ab(aA,{method:az,url:ha(al,"_all_docs"+ay),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(fw),aC(null,aD)})["catch"](aC)}),ah._changes=function(ay){var aF="batch_size" in ay?ay.batch_size:B;ay=fv(ay),ay.timeout="timeout" in ay?ay.timeout:"timeout" in aa?aa.timeout:30000;var aH,az=ay.timeout?{timeout:ay.timeout-5000}:{},aw="undefined"!=typeof ay.limit?ay.limit:!1;aH="return_docs" in ay?ay.return_docs:"returnDocs" in ay?ay.returnDocs:!0;var aB=aw;if(ay.style&&(az.style=ay.style),(ay.include_docs||ay.filter&&"function"==typeof ay.filter)&&(az.include_docs=!0),ay.attachments&&(az.attachments=!0),ay.continuous&&(az.feed="longpoll"),ay.conflicts&&(az.conflicts=!0),ay.descending&&(az.descending=!0),"heartbeat" in ay?ay.heartbeat&&(az.heartbeat=ay.heartbeat):az.heartbeat=10000,ay.filter&&"string"==typeof ay.filter&&(az.filter=ay.filter),ay.view&&"string"==typeof ay.view&&(az.filter="_view",az.view=ay.view),ay.query_params&&"object"==typeof ay.query_params){for(var aJ in ay.query_params){ay.query_params.hasOwnProperty(aJ)&&(az[aJ]=ay.query_params[aJ])}}var aD,aI="GET";if(ay.doc_ids){az.filter="_doc_ids";var aK=JSON.stringify(ay.doc_ids);aK.length<ff?az.doc_ids=aK:(aI="POST",aD={doc_ids:ay.doc_ids})}var ax,aA,aC=function(aM,aN){if(!ay.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),ay.descending?aw&&(az.limit=aB):az.limit=!aw||aB>aF?aF:aB;var aL={method:aI,url:ha(al,"_changes"+a4(az)),timeout:ay.timeout,body:aD};aA=aM,ay.aborted||aj().then(function(){ax=ap(ay,aL,aN)})["catch"](aN)}},aE={results:[]},aG=function(aN,aL){if(!ay.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aE.last_seq=aL.last_seq;var aP={};aP.query=ay.query_params,aL.results=aL.results.filter(function(aR){aB--;var aQ=hH(ay)(aR);return aQ&&(ay.include_docs&&ay.attachments&&ay.binary&&fw(aR),aH&&aE.results.push(aR),ay.onChange(aR)),aQ})}else{if(aN){return ay.aborted=!0,void ay.complete(aN)}}aL&&aL.last_seq&&(aA=aL.last_seq);var aO=aw&&0>=aB||aL&&aF>aM||ay.descending;(!ay.continuous||aw&&0>=aB)&&aO?ay.complete(null,aE):setTimeout(function(){aC(aA,aG)},0)}};return aC(ay.since||0,aG),{cancel:function(){ay.aborted=!0,ax&&ax.abort()}}},ah.revsDiff=ac("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),ap(aw,{method:"POST",url:ha(al,"_revs_diff"),body:ax},ay)}),ah._close=function(aw){aw()},ah._destroy=function(aw,ax){ap(aw,{url:ha(al,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function es(t){t.adapter("http",h4,!1),t.adapter("https",h4,!1)}function fb(){this.promise=new hg(function(t){t()})}function fr(t){var ac=t.db,ag=t.viewName,aa=t.map,ah=t.reduce,ad=t.temporary,af=aa.toString()+(ah&&ah.toString())+"undefined";if(!ad&&ac._cachedViews){var ab=ac._cachedViews[af];if(ab){return hg.resolve(ab)}}return ac.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ag;-1===aq.indexOf("/")&&(aq=ag+"/"+ag);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ad?"temp":jB(af));return jq(ac,"_local/mrviews",al).then(function(){return ac.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ac,adapter:ac.adapter,mapFun:aa,reduceFun:ah};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ad||(ac._cachedViews=ac._cachedViews||{},ac._cachedViews[af]=aq,aq.db.once("destroyed",function(){delete ac._cachedViews[af]})),aq})})})})}function gJ(aa,ac,ad,ab,t,af){return hc("return ("+aa.replace(/;\s*$/,"")+");",{emit:ac,sum:ad,log:ab,isArray:t,toJSON:af})}function k(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function l(t){return 1===t.length&&/^1-/.test(t[0].rev)}function fz(t,aa){try{t.emit("error",aa)}catch(ab){iu("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iu("error",aa)}}function gi(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return fz(aa,ab),{error:ab}}}function ey(t,aa){var ab=iZ.collate(t.key,aa.key);return 0!==ab?ab:iZ.collate(t.value,aa.value)}function s(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function i1(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function hR(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=hL(ac.data,ac.content_type)})})}function hi(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&hR(aa),aa}}function hU(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new i8(aa)}function iQ(t){for(var ac=0,ag=0,aa=t.length;aa>ag;ag++){var ah=t[ag];if("number"!=typeof ah){if(!Array.isArray(ah)){throw hU("_sum")}ac="number"==typeof ac?[ac]:ac;for(var ad=0,af=ah.length;af>ad;ad++){var ab=ah[ad];if("number"!=typeof ab){throw hU("_sum")}"undefined"==typeof ac[ad]?ac.push(ab):ac[ad]+=ab}}else{"number"==typeof ac?ac+=ah:ac[0]+=ah}}return ac}function a5(aa,ac,ad,ab){var t=ac[aa];"undefined"!=typeof t&&(ab&&(t=encodeURIComponent(JSON.stringify(t))),ad.push(aa+"="+t))}function hZ(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function jo(t){return t.group_level=hZ(t.group_level),t.limit=hZ(t.limit),t.skip=hZ(t.skip),t}function ao(t){if(t){if("number"!=typeof t){return new W('Invalid value for integer: "'+t+'"')}if(0>t){return new W('Invalid value for positive integer: "'+t+'"')}}}function gY(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&iZ.collate(aa[t],aa[ab])>0){throw new W("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new W("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new W("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=ao(aa[af]);if(ad){throw ad}})}function ip(af,ac,ah){var aa,ag=[],ad="GET";if(a5("reduce",ah,ag),a5("include_docs",ah,ag),a5("attachments",ah,ag),a5("limit",ah,ag),a5("descending",ah,ag),a5("group",ah,ag),a5("group_level",ah,ag),a5("skip",ah,ag),a5("stale",ah,ag),a5("conflicts",ah,ag),a5("startkey",ah,ag,!0),a5("start_key",ah,ag,!0),a5("endkey",ah,ag,!0),a5("end_key",ah,ag,!0),a5("inclusive_end",ah,ag),a5("key",ah,ag,!0),ag=ag.join("&"),ag=""===ag?"":"?"+ag,"undefined"!=typeof ah.keys){var ab=2000,aj="keys="+encodeURIComponent(JSON.stringify(ah.keys));aj.length+ag.length+1<=ab?ag+=("?"===ag[0]?"&":"?")+aj:(ad="POST","string"==typeof ac?aa={keys:ah.keys}:ac.keys=ah.keys)}if("string"==typeof ac){var t=k(ac);return af.request({method:ad,url:"_design/"+t[0]+"/_view/"+t[1]+ag,body:aa}).then(hi(ah))}return aa=aa||{},Object.keys(ac).forEach(function(ak){Array.isArray(ac[ak])?aa[ak]=ac[ak]:aa[ak]=ac[ak].toString()}),af.request({method:"POST",url:"_temp_view"+ag,body:aa}).then(hi(ah))}function hK(t,aa,ab){return new hg(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function fY(t){return new hg(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function h(t){return function(aa){if(404===aa.status){return t}throw aa}}function fe(ag,aa,ah){function ak(){return l(t)?hg.resolve(ac):aa.db.get(af)["catch"](h(ac))}function al(am){return am.keys.length?aa.db.allDocs({keys:am.keys,include_docs:!0}):hg.resolve({rows:[]})}function aj(av,aq){for(var az=[],am={},ay=0,aw=aq.rows.length;aw>ay;ay++){var au=aq.rows[ay],aA=au.doc;if(aA&&(az.push(aA),am[aA._id]=!0,aA._deleted=!ad[aA._id],!aA._deleted)){var ap=ad[aA._id];"value" in ap&&(aA.value=ap.value)}}var ax=Object.keys(ad);return ax.forEach(function(aD){if(!am[aD]){var aB={_id:aD},aC=ad[aD];"value" in aC&&(aB.value=aC.value),az.push(aB)}}),av.keys=gZ(ax.concat(av.keys)),az.push(av),az}var af="_local/doc_"+ag,ac={_id:af,keys:[]},ab=ah[ag],ad=ab.indexableKeysToKeyValues,t=ab.changes;return ak().then(function(am){return al(am).then(function(ap){return aj(am,ap)})})}function i(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](h({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return hg.all(ad.map(function(ag){return fe(ag,aa,ac)})).then(function(ag){var ah=fx(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function iE(t){var aa="string"==typeof t?t:t.name,ab=U[aa];return ab||(ab=U[aa]=new fb),ab}function iq(t){return f(iE(t),function(){return g8(t)})()}function g8(af){function ac(am,ak){var al={id:ag._id,key:iZ.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=iZ.normalizeKey(ak)),aa.push(al)}function ah(ak,al){return function(){return i(af,ak,al)}}var aa,ag,ad;if("function"==typeof af.mapFun&&2===af.mapFun.length){var ab=af.mapFun;ad=function(ak){return ab(ak,ac)}}else{ad=gJ(af.mapFun.toString(),ac,iQ,ia,Array.isArray,JSON.parse)}var aj=af.seq||0,t=new fb;return new hg(function(ap,ak){function al(){t.finish().then(function(){af.seq=aj,ap()})}function am(){function aq(au){ak(au)}af.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:aj,limit:fl}).on("complete",function(aF){var ax=aF.results;if(!ax.length){return al()}for(var au={},aA=0,aD=ax.length;aD>aA;aA++){var av=ax[aA];if("_"!==av.doc._id[0]){aa=[],ag=av.doc,ag._deleted||gi(af.sourceDB,ad,[ag]),aa.sort(ey);for(var aw,aC={},ay=0,aE=aa.length;aE>ay;ay++){var aB=aa[ay],az=[aB.key,aB.id];0===iZ.collate(aB.key,aw)&&az.push(ay);var aG=iZ.toIndexableString(az);aC[aG]=aB,aw=aB.key}au[av.doc._id]={indexableKeysToKeyValues:aC,changes:av.changes}}aj=av.seq}return t.add(ah(au,aj)),ax.length<fl?al():am()}).on("error",aq)}am()})}function F(ag,aa,ah){0===ah.group_level&&delete ah.group_level;var ak,al=ah.group||ah.group_level;ak=jr[ag.reduceFun]?jr[ag.reduceFun]:gJ(ag.reduceFun.toString(),null,iQ,ia,Array.isArray,JSON.parse);var aj=[],af=isNaN(ah.group_level)?Number.POSITIVE_INFINITY:ah.group_level;aa.forEach(function(aq){var am=aj[aj.length-1],ap=al?aq.key:null;return al&&Array.isArray(ap)&&(ap=ap.slice(0,af)),am&&0===iZ.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void aj.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aa=[];for(var ac=0,ab=aj.length;ab>ac;ac++){var ad=aj[ac],t=gi(ag.sourceDB,ak,[ad.keys,ad.values,!1]);if(t.error&&t.error instanceof i8){throw t.error}aa.push({value:t.error?null:t.output,key:ad.groupKey})}return{rows:s(aa,ah.limit,ah.skip)}}function M(t,aa){return f(iE(t),function(){return gG(t,aa)})()}function gG(t,ap){function ak(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return al=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=iZ.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function am(au){var av;if(av=ah?F(t,au,ap):{total_rows:al,offset:ab,rows:au},ap.include_docs){var aq=gZ(au.map(i1));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ap.conflicts,attachments:ap.attachments,binary:ap.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=i1(ay),az=ax["$"+aA];az&&(ay.doc=az)}),av})}return av}var al,ah=t.reduceFun&&ap.reduce!==!1,ab=ap.skip||0;if("undefined"==typeof ap.keys||ap.keys.length||(ap.limit=0,delete ap.keys),"undefined"!=typeof ap.keys){var ag=ap.keys,aa=ag.map(function(aq){var au={startkey:iZ.toIndexableString([aq]),endkey:iZ.toIndexableString([aq,{}])};return ak(au)});return hg.all(aa).then(fx).then(am)}var ac={descending:ap.descending};if(ap.start_key&&(ap.startkey=ap.start_key),ap.end_key&&(ap.endkey=ap.end_key),"undefined"!=typeof ap.startkey&&(ac.startkey=ap.descending?iZ.toIndexableString([ap.startkey,{}]):iZ.toIndexableString([ap.startkey])),"undefined"!=typeof ap.endkey){var af=ap.inclusive_end!==!1;ap.descending&&(af=!af),ac.endkey=iZ.toIndexableString(af?[ap.endkey,{}]:[ap.endkey])}if("undefined"!=typeof ap.key){var aj=iZ.toIndexableString([ap.key]),ad=iZ.toIndexableString([ap.key,{}]);ac.descending?(ac.endkey=aj,ac.startkey=ad):(ac.startkey=aj,ac.endkey=ad)}return ah||("number"==typeof ap.limit&&(ac.limit=ap.limit),ac.skip=ab),ak(ac).then(am)}function x(t){return t.request({method:"POST",url:"_view_cleanup"})}function a1(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=k(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return f(iE(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hg.all(ag).then(function(){return{ok:!0}})})},h({ok:!0}))}function m(ah,ab,t){if("http"===ah.type()){return ip(ah,ab,t)}if("function"==typeof ah._query){return hK(ah,ab,t)}if("string"!=typeof ab){gY(t,ab);var ag={db:ah,viewName:"temp_view/temp_view",map:ab.map,reduce:ab.reduce,temporary:!0};return iY.add(function(){return fr(ag).then(function(ak){function aj(){return ak.db.destroy()}return h9(iq(ak).then(function(){return M(ak,t)}),aj)})}),iY.finish()}var ac=ab,af=k(ac),aa=af[0],ad=af[1];return ah.get("_design/"+aa).then(function(al){var ak=al.views&&al.views[ad];if(!ak||"string"!=typeof ak.map){throw new gD("ddoc "+aa+" has no view named "+ad)}gY(t,ak);var aj={db:ah,viewName:ac,map:ak.map,reduce:ak.reduce};return fr(aj).then(function(am){return"ok"===t.stale||"update_after"===t.stale?("update_after"===t.stale&&gf.nextTick(function(){iq(am)}),M(am,t)):iq(am).then(function(){return M(am,t)})})})}function W(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,W)}catch(aa){}}function gD(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gD)}catch(aa){}}function i8(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,i8)}catch(aa){}}function fj(t){return/^1-/.test(t)}function h5(t,aa,ab){return !t._attachments||!t._attachments[ab]||t._attachments[ab].digest!==aa._attachments[ab].digest}function ho(t,aa){var ab=Object.keys(aa._attachments);return hg.all(ab.map(function(ac){return t.getAttachment(aa._id,ac,{rev:aa._rev})}))}function fs(aa,ac,ad){var ab="http"===ac.type()&&"http"!==aa.type(),t=Object.keys(ad._attachments);return ab?aa.get(ad._id).then(function(af){return hg.all(t.map(function(ag){return h5(af,ad,ag)?ac.getAttachment(ad._id,ag):aa.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return ho(ac,ad)}):ho(ac,ad)}function je(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function gb(ah,ac,aj,al){function ak(){var am=je(aj);if(am.docs.length){return ah.bulkGet(am).then(function(ap){if(al.cancelled){throw new Error("cancelled")}return hg.all(ap.results.map(function(aq){return hg.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?fs(ac,ah,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ad=ad.concat(fx(aq).filter(Boolean))})})}}function ag(am){return am._attachments&&Object.keys(am._attachments).length>0}function af(am){return ah.allDocs({keys:am,include_docs:!0}).then(function(ap){if(al.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&fj(aq.value.rev)&&!ag(aq.doc)&&(ad.push(aq.doc),delete aj[aq.id])})})}function aa(){var am=Object.keys(aj).filter(function(aq){var ap=aj[aq].missing;return 1===ap.length&&fj(ap[0])});return am.length>0?af(am):void 0}function ab(){return{ok:t,docs:ad}}aj=fv(aj);var ad=[],t=!0;return hg.resolve().then(aa).then(ak).then(ab)}function iA(aa,ac,ad,ab,t){return aa.get(ac)["catch"](function(af){if(404===af.status){return"http"===aa.type()&&jd(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ab,_id:ac,history:[],replicator:gU,version:dr}}throw af}).then(function(af){return t.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ab}),af.history.unshift({last_seq:ad,session_id:ab}),af.history=af.history.slice(0,hC),af.version=dr,af.replicator=gU,af.session_id=ab,af.last_seq=ad,aa.put(af)["catch"](function(ag){if(409===ag.status){return iA(aa,ac,ad,ab,t)}throw ag}))})}function X(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function hS(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:gc(t.history,aa.history)}function gc(t,ac){var ag=t[0],aa=t.slice(1),ah=ac[0],ad=ac.slice(1);if(!ag||0===ac.length){return{last_seq:ic,history:[]}}var af=ag.session_id;if(ae(af,ac)){return{last_seq:ag.last_seq,history:t}}var ab=ah.session_id;return ae(ab,aa)?{last_seq:ah.last_seq,history:ad}:gc(aa,ad)}function ae(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:ae(aa,ab):!1}function A(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function Q(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=g5),ac.emit("requestError",t),"active"!==ac.state&&"pending"!==ac.state||(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=hj})),aa.current_back_off=aa.current_back_off||hj,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function cr(t){return Object.keys(t).sort(iZ.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function G(t,ab,ag){var aa=ag.doc_ids?ag.doc_ids.sort(iZ.collate):"",ad=ag.filter?ag.filter.toString():"",ac="",af="";return ag.filter&&ag.query_params&&(ac=JSON.stringify(cr(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hg.all([t.id(),ab.id()]).then(function(aj){var ah=aj[0]+aj[1]+ad+af+ac+aa;return new hg(function(ak){y(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function jC(ah,aP,aD,aI,aE){function ax(){return am?hg.resolve():G(ah,aP,aD).then(function(aS){aR=aS,am=new X(ah,aP,aR,aI)})}function aJ(){if(aL=[],0!==ak.docs.length){var aS=ak.docs;return aP.bulkDocs({docs:aS,new_edits:!1}).then(function(aT){if(aI.cancelled){throw aF(),new Error("cancelled")}var aW=[],aU={};aT.forEach(function(aY){aY.error&&(aE.doc_write_failures++,aW.push(aY),aU[aY.id]=aY)}),aj=aj.concat(aW),aE.docs_written+=ak.docs.length-aW.length;var aV=aW.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aU[aZ._id];aY?aI.emit("denied",fv(aY)):aL.push(aZ)}),aV.length>0){var aX=new Error("bulkDocs error");throw aX.other_errors=aW,aw("target.bulkDocs failed to write docs",aX),new Error("bulkWrite partial failure")}},function(aT){throw aE.doc_write_failures+=aS.length,aT})}}function aO(){if(ak.error){throw new Error("There was a problem getting docs.")}aE.last_seq=ay=ak.seq;var aS=fv(aE);return aL.length&&(aS.docs=aL,aI.emit("change",aS)),au=!0,am.writeCheckpoint(ak.seq,ag).then(function(){if(au=!1,aI.cancelled){throw aF(),new Error("cancelled")}ak=void 0,aB()})["catch"](aQ)}function ad(){var aS={};return ak.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aP.revsDiff(aS).then(function(aT){if(aI.cancelled){throw aF(),new Error("cancelled")}ak.diffs=aT})}function ap(){return gb(ah,aP,ak.diffs,aI).then(function(aS){ak.error=!aS.ok,aS.docs.forEach(function(aT){delete ak.diffs[aT._id],aE.docs_read++,ak.docs.push(aT)})})}function aA(){if(!aI.cancelled&&!ak){if(0===az.length){return void ab(!0)}ak=az.shift(),ad().then(ap).then(aJ).then(aO).then(aA)["catch"](function(aS){aw("batch processing terminated with error",aS)})}}function ab(aS){return 0===aG.changes.length?void (0!==az.length||ak||((aM&&aC.live||aK)&&(aI.state="pending",aI.emit("paused")),aK&&aF())):void ((aS||aK||aG.changes.length>=ac)&&(az.push(aG),aG={seq:0,changes:[],docs:[]},"pending"!==aI.state&&"stopped"!==aI.state||(aI.state="active",aI.emit("active")),aA()))}function aw(aS,aT){aq||(aT.message||(aT.message=aS),aE.ok=!1,aE.status="aborting",aE.errors.push(aT),aj=aj.concat(aT),az=[],aG={seq:0,changes:[],docs:[]},aF())}function aF(){if(!(aq||aI.cancelled&&(aE.status="cancelled",au))){aE.status=aE.status||"complete",aE.end_time=new Date,aE.last_seq=ay,aq=!0;var aS=aj.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aj.pop();aj.length>0&&(aT.other_errors=aj),aT.result=aE,Q(aD,aI,aT,function(){jC(ah,aP,aD,aI)})}else{aE.errors=aj,aI.emit("complete",aE),aI.removeAllListeners()}}}function af(aS){if(aI.cancelled){return aF()}var aT=hH(aD)(aS);aT&&(aG.seq=aS.seq,aG.changes.push(aS),ab(0===az.length&&aC.live))}function t(aS){if(aN=!1,aI.cancelled){return aF()}if(aS.results.length>0){aC.since=aS.last_seq,aB(),ab(!0)}else{var aT=function(){aM?(aC.live=!0,aB()):aK=!0,ab(!0)};ak||0!==aS.results.length?aT():(au=!0,am.writeCheckpoint(aS.last_seq,ag).then(function(){au=!1,aE.last_seq=ay=aS.last_seq,aT()})["catch"](aQ))}}function aH(aS){return aN=!1,aI.cancelled?aF():void aw("changes rejected",aS)}function aB(){function aS(){aT.cancel()}function aU(){aI.removeListener("cancel",aS)}if(!aN&&!aK&&az.length<aa){aN=!0,aI._changes&&(aI.removeListener("cancel",aI._abortChanges),aI._changes.cancel()),aI.once("cancel",aS);var aT=ah.changes(aC).on("change",af);aT.then(aU,aU),aT.then(t)["catch"](aH),aD.retry&&(aI._changes=aT,aI._abortChanges=aS)}}function av(){ax().then(function(){return aI.cancelled?void aF():am.getCheckpoint().then(function(aS){ay=aS,aC={since:ay,limit:ac,batch_size:ac,style:"all_docs",doc_ids:al,return_docs:!0},aD.filter&&("string"!=typeof aD.filter?aC.include_docs=!0:aC.filter=aD.filter),"heartbeat" in aD&&(aC.heartbeat=aD.heartbeat),"timeout" in aD&&(aC.timeout=aD.timeout),aD.query_params&&(aC.query_params=aD.query_params),aD.view&&(aC.view=aD.view),aB()})})["catch"](function(aS){aw("getCheckpoint rejected with ",aS)})}function aQ(aS){throw au=!1,aw("writeCheckpoint completed with error",aS),aS}var ak,aR,am,az=[],aG={seq:0,changes:[],docs:[]},au=!1,aK=!1,aq=!1,ay=0,aM=aD.continuous||aD.live||!1,ac=aD.batch_size||100,aa=aD.batches_limit||10,aN=!1,al=aD.doc_ids,aj=[],aL=[],ag=iC();aE=aE||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aC={};return aI.ready(ah,aP),aI.cancelled?void aF():(aI._addedListeners||(aI.once("cancel",aF),"function"==typeof aD.complete&&(aI.once("error",aD.complete),aI.once("complete",function(aS){aD.complete(null,aS)})),aI._addedListeners=!0),void ("undefined"==typeof aD.since?av():ax().then(function(){return au=!0,am.writeCheckpoint(aD.since,ag)}).then(function(){return au=!1,aI.cancelled?void aF():(ay=aD.since,void av())})["catch"](aQ)))}function jm(){ij.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new hg(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function N(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function iF(t,ab,ag,aa){if("function"==typeof ag&&(aa=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gO(fo,"`doc_ids` filter parameter is not a list.")}ag.complete=aa,ag=fv(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ad=new jm(ag),ac=N(t,ag),af=N(ab,ag);return jC(ac,af,ag,ad),ad}function gP(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=fv(t),t.PouchConstructor=t.PouchConstructor||this,aa=N(aa,t),ac=N(ac,t),new hI(aa,ac,t,ab)}function hI(af,ap,am,ac){function aq(ay){ah.emit("change",{direction:"pull",change:ay})}function aj(ay){ah.emit("change",{direction:"push",change:ay})}function t(ay){ah.emit("denied",{direction:"push",doc:ay})}function al(ay){ah.emit("denied",{direction:"pull",doc:ay})}function av(){ah.pushPaused=!0,ah.pullPaused&&ah.emit("paused")}function ab(){ah.pullPaused=!0,ah.pushPaused&&ah.emit("paused")}function ag(){ah.pushPaused=!1,ah.pullPaused&&ah.emit("active",{direction:"push"})}function ak(){ah.pullPaused=!1,ah.pushPaused&&ah.emit("active",{direction:"pull"})}function ad(ay){return function(aC,az){var aE="change"===aC&&(az===aq||az===aj),aA="denied"===aC&&(az===al||az===t),aD="paused"===aC&&(az===ab||az===av),aB="active"===aC&&(az===ak||az===ag);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ah.removeAllListeners(aC))}}var ah=this;this.canceled=!1;var aa=am.push?ai.extend({},am,am.push):am,aw=am.pull?ai.extend({},am,am.pull):am;this.push=iF(af,ap,aa),this.pull=iF(ap,af,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};am.live&&(this.push.on("complete",ah.pull.cancel.bind(ah.pull)),this.pull.on("complete",ah.push.cancel.bind(ah.push))),this.on("newListener",function(ay){"change"===ay?(ah.pull.on("change",aq),ah.push.on("change",aj)):"denied"===ay?(ah.pull.on("denied",al),ah.push.on("denied",t)):"active"===ay?(ah.pull.on("active",ak),ah.push.on("active",ag)):"paused"===ay&&(ah.pull.on("paused",ab),ah.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ah.pull.removeListener("change",aq),ah.push.removeListener("change",aj)):"denied"===ay?(ah.pull.removeListener("denied",al),ah.push.removeListener("denied",t)):"active"===ay?(ah.pull.removeListener("active",ak),ah.push.removeListener("active",ag)):"paused"===ay&&(ah.pull.removeListener("paused",ab),ah.push.removeListener("paused",av))}),this.pull.on("removeListener",ad("pull")),this.push.on("removeListener",ad("push"));var au=hg.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ah.emit("complete",az),ac&&ac(null,az),ah.removeAllListeners(),az},function(ay){if(ah.cancel(),ac?ac(ay):ah.emit("error",ay),ah.removeAllListeners(),ac){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gg(t){t.replicate=iF,t.sync=gP}var at,ai=e(9),he=fy(e(5)),hO=fy(e(8)),i5=fy(e(10)),g1=e(14),hw=fy(e(4)),ij=e(1),hc=fy(e(15)),fV=fy(e(16)),hx=fy(e(17)),iZ=e(12),hg="function"==typeof Promise?Promise:i5,de=Function.prototype.toString,io=de.call(Object),hy=he("pouchdb:api"),gm=6;if(E()){at=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),at=!!localStorage.getItem("_pouch_check_localstorage")}catch(gw){at=!1}}hO(ge,ij.EventEmitter),ge.prototype.addListener=function(t,ab,ag,aa){function ad(){function aj(){af=!1}if(ac._listeners[ab]){if(af){return void (af="waiting")}af=!0;var ah=fc(aa,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>aa.since&&!aa.cancelled&&(aa.since=ak.seq,aa.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ad()},0),af=!1}).on("error",aj)}}if(!this._listeners[ab]){var ac=this,af=!1;this._listeners[ab]=ad,this.on(t,ad)}},ge.prototype.removeListener=function(t,aa){aa in this._listeners&&ij.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},ge.prototype.notifyLocalWindows=function(t){E()?chrome.storage.local.set({dbName:t}):fU()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ge.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hO(jk,Error),jk.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var gp=new jk({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),g3=new jk({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ik=new jk({status:404,error:"not_found",reason:"missing"}),ju=new jk({status:409,error:"conflict",reason:"Document update conflict"}),gN=new jk({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gR=new jk({status:412,error:"missing_id",reason:"_id is required for puts"}),et=new jk({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hG=new jk({status:412,error:"precondition_failed",reason:"Database not open"}),n=new jk({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),fn=new jk({status:500,error:"badarg",reason:"Some query argument is invalid"}),ew=new jk({status:400,error:"invalid_request",reason:"Request was invalid"}),gT=new jk({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ei=new jk({status:500,error:"doc_validation",reason:"Bad special document member"}),fo=new jk({status:400,error:"bad_request",reason:"Something wrong with the request"}),i4=new jk({status:400,error:"bad_request",reason:"Document must be a JSON object"}),gB=new jk({status:404,error:"not_found",reason:"Database not found"}),gt=new jk({status:500,error:"indexed_db_went_bad",reason:"unknown"}),hl=new jk({status:500,error:"web_sql_went_bad",reason:"unknown"}),bt=new jk({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),q=new jk({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iV=new jk({status:400,error:"bad_request",reason:"Invalid rev format"}),iB=new jk({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),fm=new jk({status:412,error:"missing_stub"}),gx=new jk({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),h7=[gp,g3,ik,ju,gN,gR,et,hG,n,fn,ew,gT,ei,fo,i4,gB,hl,bt,q,iV,iB,fm,gt,gx],gu=function(aa,ac,t){var ab=h7.filter(function(ad){return ad[aa]===ac});return t&&ab.filter(function(ad){return ad.message===t})[0]||ab[0]},gL=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],hY="queryKey",ez=/(?:^|&)([^&=]*)=?([^&]*)/g,be=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,D="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hO(fq,ij.EventEmitter),fq.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fq.prototype.doChanges=function(aa){var ac=this,ad=aa.complete;if(aa=fv(aa),"live" in aa&&!("continuous" in aa)&&(aa.continuous=aa.live),aa.processChange=g4,"latest"===aa.since&&(aa.since="now"),aa.since||(aa.since=0),"now"===aa.since){return void this.db.info().then(function(af){return ac.isCancelled?void ad(null,{status:"cancelled"}):(aa.since=af.update_seq,void ac.doChanges(aa))},ad)}if(aa.continuous&&"now"!==aa.since&&this.db.info().then(function(af){ac.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),aa.view&&!aa.filter&&(aa.filter="_view"),aa.filter&&"string"==typeof aa.filter&&("_view"===aa.filter?aa.view=V(aa.view):aa.filter=V(aa.filter),"http"!==this.db.type()&&!aa.doc_ids)){return this.filterChanges(aa)}"descending" in aa||(aa.descending=!1),aa.limit=0===aa.limit?1:aa.limit,aa.complete=ad;var ab=this.db._changes(aa);if(ab&&"function"==typeof ab.cancel){var t=ac.cancel;ac.cancel=hw(function(af){ab.cancel(),t.apply(this,af)})}},fq.prototype.filterChanges=function(aa){var ac=this,ad=aa.complete;if("_view"===aa.filter){if(!aa.view||"string"!=typeof aa.view){var ab=gO(fo,"`view` filter parameter not found or invalid.");return ad(ab)}var t=gz(aa.view);this.db.get("_design/"+t[0],function(aj,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(aj){return ad(fh(aj))}var ah=ag&&ag.views&&ag.views[t[1]]&&ag.views[t[1]].map;return ah?(aa.filter=ex(ah),void ac.doChanges(aa)):ad(gO(ik,ag.views?"missing json key: "+t[1]:"missing json key: views"))})}else{var af=gz(aa.filter);if(!af){return ac.doChanges(aa)}this.db.get("_design/"+af[0],function(ah,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(ah){return ad(fh(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(aa.filter=P(aj),void ac.doChanges(aa)):ad(gO(ik,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hO(iS,ij.EventEmitter),iS.prototype.post=eo("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(gO(i4)):void this.bulkDocs({docs:[t]},aa,iP(ab))}),iS.prototype.put=eo("put",hw(function(af){function ac(){ab||(iu("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ab=!0)}var ah,aa,ag,ad,ab=!1,aj=af.shift(),t="_id" in aj;if("object"!=typeof aj||Array.isArray(aj)){return(ad=af.pop())(gO(i4))}for(;;){if(ah=af.shift(),aa=typeof ah,"string"!==aa||t?"string"!==aa||!t||"_rev" in aj?"object"===aa?ag=ah:"function"===aa&&(ad=ah):(ac(),aj._rev=ah):(ac(),aj._id=ah,t=!0),!af.length){break}}return ag=ag||{},jt(aj._id),L(aj._id)&&"function"==typeof this._putLocal?aj._deleted?this._removeLocal(aj,ad):this._putLocal(aj,ad):void this.bulkDocs({docs:[aj]},ag,iP(ad))})),iS.prototype.putAttachment=eo("putAttachment",function(t,ab,ag,aa,ad){function ac(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ab]={content_type:ad,data:aa,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof ad&&(ad=aa,aa=ag,ag=null),"undefined"==typeof ad&&(ad=aa,aa=ag,ag=null),af.get(t).then(function(ah){if(ah._rev!==ag){throw gO(ju)}return ac(ah)},function(ah){if(ah.reason===ik.message){return ac({_id:t})}throw ah})}),iS.prototype.removeAttachment=eo("removeAttachment",function(aa,ac,ad,ab){var t=this;t.get(aa,function(af,ag){return af?void ab(af):ag._rev!==ad?void ab(gO(ju)):ag._attachments?(delete ag._attachments[ac],0===Object.keys(ag._attachments).length&&delete ag._attachments,void t.put(ag,ab)):ab()})}),iS.prototype.remove=eo("remove",function(aa,ac,ad,ab){var t;"string"==typeof ac?(t={_id:aa,_rev:ac},"function"==typeof ad&&(ab=ad,ad={})):(t=aa,"function"==typeof ac?(ab=ac,ad={}):(ab=ad,ad=ac)),ad=ad||{},ad.was_delete=!0;var af={_id:t._id,_rev:t._rev||ad.rev};return af._deleted=!0,L(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(t,ab):void this.bulkDocs({docs:[af]},ad,iP(ab))}),iS.prototype.revsDiff=eo("revsDiff",function(t,ac,ag){function aa(ak,aj){ab.has(ak)||ab.set(ak,{missing:[]}),ab.get(ak).missing.push(aj)}function ah(aj,ak){var al=t[aj].slice(0);iy(ak,function(aq,av,aw,ap,am){var ax=av+"-"+aw,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==am.status&&aa(aj,ax))}),al.forEach(function(am){aa(aj,am)})}"function"==typeof ac&&(ag=ac,ac={});var ad=Object.keys(t);if(!ad.length){return ag(null,{})}var af=0,ab=new g1.Map;ad.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ab.set(aj,{missing:t[aj]})}else{if(al){return ag(al)}ah(aj,am)}if(++af===ad.length){var ak={};return ab.forEach(function(ap,aq){ak[aq]=ap}),ag(null,ak)}})},this)}),iS.prototype.bulkGet=eo("bulkGet",function(t,aa){cn(this,t,aa)}),iS.prototype.compactDocument=eo("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(ag,aj){if(ag){return t(ag)}var af=ev(aj),ah=[],ad=[];Object.keys(af).forEach(function(ak){af[ak]>ac&&ah.push(ak)}),iy(aj,function(ak,am,aq,al,au){var ap=am+"-"+aq;"available"===au.status&&-1!==ah.indexOf(ap)&&ad.push(ap)}),ab._doCompaction(aa,ad,t)})}),iS.prototype.compact=eo("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&i6(ab)}),iS.prototype._compact=function(t,ab){function ag(ah){af.push(ad.compactDocument(ah.id,0))}function aa(ah){var aj=ah.last_seq;hg.all(af).then(function(){return jq(ad,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ab(null,{ok:!0})})["catch"](ab)}var ad=this,ac={return_docs:!1,last_seq:t.last_seq||0},af=[];ad.changes(ac).on("change",ag).on("complete",aa).on("error",ab)},iS.prototype.get=eo("get",function(t,ac,ag){function aa(){var ak=[],aj=ah.length;return aj?void ah.forEach(function(al){ad.get(t,{rev:al,revs:ac.revs,attachments:ac.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ag(null,ak)})}):ag(null,ak)}if("function"==typeof ac&&(ag=ac,ac={}),"string"!=typeof t){return ag(gO(gN))}if(L(t)&&"function"==typeof this._getLocal){return this._getLocal(t,ag)}var ah=[],ad=this;if(!ac.open_revs){return this._get(t,ac,function(aq,aA){if(aq){return ag(aq)}var ay=aA.doc,ap=aA.metadata,ax=aA.ctx;if(ac.conflicts){var az=iT(ap);az.length&&(ay._conflicts=az)}if(iv(ap,ay._rev)&&(ay._deleted=!0),ac.revs||ac.revs_info){var aj=jw(ap.rev_tree),au=gF(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ay._rev.split("-")[1])}),aB=au.ids.map(function(aC){return aC.id}).indexOf(ay._rev.split("-")[1])+1,am=au.ids.length-aB;if(au.ids.splice(aB,am),au.ids.reverse(),ac.revs&&(ay._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ac.revs_info){var al=au.pos+au.ids.length;ay._revs_info=au.ids.map(function(aC){return al--,{rev:al+"-"+aC.id,status:aC.opts.status}})}}if(ac.attachments&&ay._attachments){var ak=ay._attachments,aw=Object.keys(ak).length;if(0===aw){return ag(null,ay)}Object.keys(ak).forEach(function(aC){this._getAttachment(ay._id,aC,ak[aC],{rev:ay._rev,binary:ac.binary,ctx:ax},function(aE,aD){var aF=ay._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aw||ag(null,ay)})},ad)}else{if(ay._attachments){for(var av in ay._attachments){ay._attachments.hasOwnProperty(av)&&(ay._attachments[av].stub=!0)}}ag(null,ay)}})}if("all"===ac.open_revs){this._getRevisionTree(t,function(ak,aj){return ak?ag(ak):(ah=jg(aj).map(function(al){return al.rev}),void aa())})}else{if(!Array.isArray(ac.open_revs)){return ag(gO(n,"function_clause"))}ah=ac.open_revs;for(var af=0;af<ah.length;af++){var ab=ah[af];if("string"!=typeof ab||!/^\d+-/.test(ab)){return ag(gO(iV))}}aa()}}),iS.prototype.getAttachment=eo("getAttachment",function(aa,ac,ad,ab){var t=this;ad instanceof Function&&(ab=ad,ad={}),this._get(aa,ad,function(af,ag){return af?ab(af):ag.doc._attachments&&ag.doc._attachments[ac]?(ad.ctx=ag.ctx,ad.binary=!0,t._getAttachment(aa,ac,ag.doc._attachments[ac],ad,ab),void 0):ab(gO(ik))})}),iS.prototype.allDocs=eo("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(gO(gT,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return hF(this,t,aa)}}return this._allDocs(t,aa)}),iS.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new fq(this,t,aa)},iS.prototype.close=eo("close",function(t){return this._closed=!0,this._close(t)}),iS.prototype.info=eo("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),iS.prototype.id=eo("id",function(t){return this._id(t)}),iS.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},iS.prototype.bulkDocs=eo("bulkDocs",function(aa,ac,ad){if("function"==typeof ac&&(ad=ac,ac={}),ac=ac||{},Array.isArray(aa)&&(aa={docs:aa}),!aa||!aa.docs||!Array.isArray(aa.docs)){return ad(gO(g3))}for(var ab=0;ab<aa.docs.length;++ab){if("object"!=typeof aa.docs[ab]||Array.isArray(aa.docs[ab])){return ad(gO(i4))}}var t;return aa.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){t=t||fa(ag)})}),t?ad(gO(fo,t)):("new_edits" in ac||("new_edits" in aa?ac.new_edits=aa.new_edits:ac.new_edits=!0),ac.new_edits||"http"===this.type()||aa.docs.sort(an),ar(aa.docs),this._bulkDocs(aa,ac,function(af,ag){return af?ad(af):(ac.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ad(null,ag))}))}),iS.prototype.registerDependentDatabase=eo("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);jq(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),iS.prototype.destroy=eo("destroy",function(aa,ac){function ad(){ab._destroy(aa,function(ag,af){return ag?ac(ag):(ab._destroyed=!0,ab.emit("destroyed"),void ac(null,af||{ok:!0}))})}"function"==typeof aa&&(ac=aa,aa={});var ab=this,t="use_prefix" in ab?ab.use_prefix:!0;return"http"===ab.type()?ad():void ab.get("_local/_pouch_dependentDbs",function(ag,aj){if(ag){return 404!==ag.status?ac(ag):ad()}var af=aj.dependentDbs,ah=ab.constructor,ak=Object.keys(af).map(function(al){var am=t?al.replace(new RegExp("^"+ah.prefix),""):al;return new ah(am,ab.__opts).destroy()});hg.all(ak).then(ad,ac)})}),ib.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},ib.prototype.fail=function(t){this.failed=t,this.execute()},ib.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ib.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hO(gE,iS),gE.debug=he,gE.adapters={},gE.preferredAdapters=[],gE.prefix="_pouch_";var ht=new ij.EventEmitter;hE(gE),gE.parseAdapter=function(t,ac){var ag,aa,ah=t.match(/([a-z\-]*):\/\/(.*)/);if(ah){if(t=/http(s?)/.test(ah[1])?ah[1]+"://"+ah[2]:ah[2],ag=ah[1],!gE.adapters[ag].valid()){throw"Invalid adapter"}return{name:t,adapter:ah[1]}}var ad="idb" in gE.adapters&&"websql" in gE.adapters&&fU()&&localStorage["_pouch__websqldb_"+gE.prefix+t];if(ac.adapter){aa=ac.adapter}else{if("undefined"!=typeof ac&&ac.db){aa="leveldb"}else{for(var af=0;af<gE.preferredAdapters.length;++af){if(aa=gE.preferredAdapters[af],aa in gE.adapters){if(ad&&"idb"===aa){iu("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ag=gE.adapters[aa];var ab=ag&&"use_prefix" in ag?ag.use_prefix:!0;return{name:ab?gE.prefix+t:t,adapter:aa}},gE.adapter=function(t,aa,ab){aa.valid()&&(gE.adapters[t]=aa,ab&&gE.preferredAdapters.push(t))},gE.plugin=function(t){return"function"==typeof t?t(gE):Object.keys(t).forEach(function(aa){gE.prototype[aa]=t[aa]}),gE},gE.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=ai.extend({},t,ad),void gE.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return hO(aa,gE),aa.preferredAdapters=gE.preferredAdapters.slice(),Object.keys(gE).forEach(function(ab){ab in aa||(aa[ab]=gE[ab])}),aa};var u="5.4.4";gE.version=u;var fX,hM=ii(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),g2=ii(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),dn=function(t){return atob(t)},h3=function(t){return btoa(t)},iX=jl.setImmediate||jl.setTimeout,iU=32768,h8=5,gW="document-store",gv="by-sequence",ce="attach-store",a2="attach-seq-store",iM="meta-store",ie="local-store",iH="detect-blob-support",a6={running:!1,queue:[]},iR=new g1.Map,ft=new ge,hQ=new g1.Map;z.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var jj=7,hP=hW("document-store"),gQ=hW("by-sequence"),jz=hW("attach-store"),hh=hW("local-store"),hV=hW("metadata-store"),J=hW("attach-seq-store"),ir=new g1.Map,hJ=new ge,T=1,r="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+gQ+" (seq, deleted)",gS="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+gQ+" (doc_id, rev)",gr="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hP+" (winningseq)",K="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+J+" (seq)",gq="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+J+" (digest, seq)",iw=gQ+".seq = "+hP+".winningseq",i9=gQ+".seq AS seq, "+gQ+".deleted AS deleted, "+gQ+".json AS data, "+gQ+".rev AS rev, "+hP+".json AS metadata";gK.valid=ct,gK.use_prefix=!0;var en=h1(),p=function(){},B=25,iG=50,gH={},ff=1800,C=he("pouchdb:http");h4.valid=function(){return !0},fb.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},fb.prototype.finish=function(){return this.promise};var jp=function(t,aa){return aa&&t.then(function(ab){gf.nextTick(function(){aa(null,ab)})},function(ab){gf.nextTick(function(){aa(ab)})}),t},il=function(t){return hw(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&jp(ab,aa),ab})},h9=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},f=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},gZ=function(aa){for(var ac={},ad=0,ab=aa.length;ab>ad;ad++){ac["$"+aa[ad]]=!0}var t=Object.keys(ac),af=new Array(t.length);for(ad=0,ab=t.length;ab>ad;ad++){af[ad]=t[ad].substring(1)}return af},U={},iY=new fb,fl=50,ia=iu.bind(null,"log"),jr={_sum:function(t,aa){return iQ(aa)},_count:function(t,aa){return aa.length},_stats:function(t,aa){function ab(ac){for(var af=0,ag=0,ad=ac.length;ad>ag;ag++){var ah=ac[ag];af+=ah*ah}return af}return{sum:iQ(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},fk=il(function(){var t=this;return"http"===t.type()?x(t):"function"==typeof t._viewCleanup?fY(t):a1(t)}),hu=function(aa,ac,ad){"function"==typeof ac&&(ad=ac,ac={}),ac=ac?jo(ac):{},"function"==typeof aa&&(aa={map:aa});var ab=this,t=hg.resolve().then(function(){return m(ab,aa,ac)});return jp(t,ad),t};hO(W,Error),hO(gD,Error),hO(i8,Error);var jb={query:hu,viewCleanup:fk},dr=1,gU="pouchdb",hC=5,ic=0;X.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},X.prototype.updateTarget=function(t,aa){return iA(this.target,this.id,t,aa,this.returnValue)},X.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?hg.resolve(!0):iA(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(A(ac)){return ab.readOnlySource=!0,!0}throw ac})};var hp={undefined:function(t,aa){return 0===iZ.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return hS(aa,t).last_seq}};X.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hg.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ic}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hp?hp[ab](aa,ac):ic},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ic}).then(function(){return ic},function(ac){return A(ac)?(t.readOnlySource=!0,aa.last_seq):ic})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ic})};var hj=0;hO(jm,ij.EventEmitter),jm.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},jm.prototype.ready=function(aa,ac){function ad(){t.cancel()}function ab(){aa.removeListener("destroyed",ad),ac.removeListener("destroyed",ad)}var t=this;t._readyCalled||(t._readyCalled=!0,aa.once("destroyed",ad),ac.once("destroyed",ad),t.once("complete",ab))},hO(hI,ij.EventEmitter),hI.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},gE.plugin(ji).plugin(br).plugin(es).plugin(jb).plugin(gg),a.exports=gE}).call(this,e(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var f="color: "+this.color;k=[k[0],f,"color: inherit"].concat(Array.prototype.slice.call(k,1));var j=0,g=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),k.splice(g,0,f),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(k){function h(){}function g(){var q=g,m=+new Date,p=m-(b||m);q.diff=p,q.prev=b,q.curr=m,b=m,null==q.useColors&&(q.useColors=n.useColors()),null==q.color&&q.useColors&&(q.color=r());var w=Array.prototype.slice.call(arguments);w[0]=n.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=n.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof n.formatArgs&&(w=n.formatArgs.apply(q,w));var v=g.log||n.log||console.log.bind(console);v.apply(q,w)}h.enabled=!1,g.enabled=!0;var j=n.enabled(k)?g:h;return j.namespace=k,j}function i(g){n.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?n.skips.push(new RegExp("^"+g.substr(1)+"$")):n.names.push(new RegExp("^"+g+"$")))}}function a(){n.enable("")}function s(g){var j,h;for(j=0,h=n.skips.length;h>j;j++){if(n.skips[j].test(g)){return !1}}for(j=0,h=n.names.length;h>j;j++){if(n.names[j].test(g)){return !0}}return !1}function u(g){return g instanceof Error?g.stack||g.message:g}n=t.exports=o,n.coerce=u,n.disable=a,n.enable=i,n.enabled=s,n.humanize=e(11),n.names=[],n.skips=[],n.formatters={};var b,f=0},{11:11}],7:[function(e,a,b){(function(y){function l(){z=!0;for(var j,g,h=i.length;h;){for(g=i,i=[],j=-1;++j<h;){g[j]()}h=i.length}z=!1}function r(g){1!==i.push(g)||z||o()}var o,f=y.MutationObserver||y.WebKitMutationObserver;if(f){var x=0,s=new f(l),u=y.document.createTextNode("");s.observe(u,{characterData:!0}),o=function(){u.data=x=++x%2}}else{if(y.setImmediate||"undefined"==typeof y.MessageChannel){o="document" in y&&"onreadystatechange" in y.document.createElement("script")?function(){var g=y.document.createElement("script");g.onreadystatechange=function(){l(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},y.document.documentElement.appendChild(g)}:function(){setTimeout(l,0)}}else{var n=new y.MessageChannel;n.port1.onmessage=l,o=function(){n.port2.postMessage(0)}}}var z,i=[];a.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(e,a,b){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(l,u,t){function i(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=a,this.queue=[],this.outcome=void 0,g!==i&&y(this,g)}function h(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function p(j,k,g){s(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function e(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=f(g);"error"===z.status&&w(z.value)}function f(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function n(g){return g instanceof this?g:K.resolve(new this(i),g)}function r(g){var j=new this(i);return K.reject(j,g)}function b(w){function g(E,D){function C(F){k[D]=F,++q!==B||x||(x=!0,K.resolve(A,k))}z.resolve(E).then(C,function(F){x||(x=!0,K.reject(A,F))})}var z=this;if("[object Array]"!==Object.prototype.toString.call(w)){return this.reject(new TypeError("must be an array"))}var B=w.length,x=!1;if(!B){return this.resolve([])}for(var k=new Array(B),q=0,j=-1,A=new this(i);++j<B;){g(w[j],j)}return A}function o(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(i);++z<g;){q(j[z])}return k}var s=l(7),K={},L=["REJECTED"],m=["FULFILLED"],a=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===m||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(i);if(this.state!==a){var j=this.state===m?k:q;p(g,j,this.outcome)}else{this.queue.push(new h(g,k,q))}return g},h.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){p(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){K.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){p(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=f(e,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=m,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},v.resolve=n,v.reject=r,v.all=b,v.race=o},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(D,h,r){function s(j){if(null!==j){switch(typeof j){case"boolean":return j?1:0;case"number":return i(j);case"string":return j.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var m=Array.isArray(j),v=m?j:Object.keys(j),g=-1,w=v.length,q="";if(m){for(;++g<w;){q+=r.toIndexableString(v[g])}}else{for(;++g<w;){var k=v[g];q+=r.toIndexableString(k)+r.toIndexableString(j[k])}}return q}}return""}function l(q,g){var w,y=g,x="1"===q[g];if(x){w=0,g++}else{var v="0"===q[g];g++;var k="",z=q.substring(g,g+a),j=parseInt(z,10)+e;for(v&&(j=-j),g+=a;;){var m=q[g];if("\x00"===m){break}k+=m,g++}k=k.split("."),w=1===k.length?parseInt(k,10):parseFloat(k[0]+"."+k[1]),v&&(w-=10),0!==j&&(w=parseFloat(w+"e"+j))}return{num:w,length:g-y}}function o(v,g){var m=v.pop();if(g.length){var q=g[g.length-1];m===q.element&&(g.pop(),q=g[g.length-1]);var w=q.element,j=q.index;if(Array.isArray(w)){w.push(m)}else{if(j===v.length-2){var k=v.pop();w[k]=m}else{v.push(m)}}}}function b(k,q){for(var m=Math.min(k.length,q.length),j=0;m>j;j++){var g=r.collate(k[j],q[j]);if(0!==g){return g}}return k.length===q.length?0:k.length>q.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(j,m){for(var v=Object.keys(j),g=Object.keys(m),w=Math.min(v.length,g.length),q=0;w>q;q++){var k=r.collate(v[q],g[q]);if(0!==k){return k}if(k=r.collate(j[v[q]],m[g[q]]),0!==k){return k}}return v.length===g.length?0:v.length>g.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(k){if(0===k){return"1"}var y=k.toExponential().split(/e\+?/),q=parseInt(y[1],10),w=0>k,v=w?"0":"2",m=(w?-q:q)-e,j=p.padLeft(m.toString(),"0",a);v+=u+j;var x=Math.abs(parseFloat(y[0]));w&&(x=10-x);var g=x.toFixed(20);return g=g.replace(/\.?0+$/,""),v+=u+g}var e=-324,a=3,u="",p=D(13);r.collate=function(j,m){if(j===m){return 0}j=r.normalizeKey(j),m=r.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},r.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=r.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=r.normalizeKey(v))}}}}}return g},r.toIndexableString=function(g){var j="\x00";return g=r.normalizeKey(g),n(g)+u+s(g)+j},r.parseIndexableString=function(q){for(var g=[],x=[],y=0;;){var k=q[y++];if("\x00"!==k){switch(k){case"1":g.push(null);break;case"2":g.push("1"===q[y]),y++;break;case"3":var z=l(q,y);g.push(z.num),y+=z.length;break;case"4":for(var j="";;){var m=q[y];if("\x00"===m){break}j+=m,y++}j=j.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),g.push(j);break;case"5":var v={element:[],index:g.length};g.push(v.element),x.push(v);break;case"6":var w={element:{},index:g.length};g.push(w.element),x.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+k)}}else{if(1===g.length){return g.pop()}o(g,x)}}}},{13:13}],13:[function(b,h,a){function e(n,g,l){for(var f="",m=l-n.length;f.length<m;){f+=g}return f}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var g,o=n.length,f=r.length;for(g=0;o>g;g++){if(g===f){return 1}var q=n.charAt(g),i=r.charAt(g);if(q!==i){return i>q?-1:1}}return f>o?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(a,e,i){function b(){this.store={}}function j(g){if(this.store=new b,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}i.Map=b,i.Set=j,b.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},b.prototype.unmangle=function(f){return f.substring(1)},b.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},b.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},b.prototype.has=function(f){var g=this.mangle(f);return g in this.store},b.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},b.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},j.prototype.add=function(f){return this.store.set(f,!0)},j.prototype.has=function(f){return this.store.has(f)},j.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(n,o){var p,q,g,r;q=[],r=[];for(p in o){h.call(o,p)&&(g=o[p],"this"!==p&&(q.push(p),r.push(g)))}return Function.apply(null,f.call(q).concat([n])).apply(o["this"],r)}}).call(this)},{}],16:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(l){function s(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function O(j,A,k,w,q,z,x){return s(A&k|~A&w,j,A,q,z,x)}function y(j,A,k,w,q,z,x){return s(A&w|k&~w,j,A,q,z,x)}function P(j,A,k,w,q,z,x){return s(A^k^w,j,A,q,z,x)}function u(j,A,k,w,q,z,x){return s(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=O(z,j,x,k,w[0],7,-680876936),k=O(k,z,j,x,w[1],12,-389564586),x=O(x,k,z,j,w[2],17,606105819),j=O(j,x,k,z,w[3],22,-1044525330),z=O(z,j,x,k,w[4],7,-176418897),k=O(k,z,j,x,w[5],12,1200080426),x=O(x,k,z,j,w[6],17,-1473231341),j=O(j,x,k,z,w[7],22,-45705983),z=O(z,j,x,k,w[8],7,1770035416),k=O(k,z,j,x,w[9],12,-1958414417),x=O(x,k,z,j,w[10],17,-42063),j=O(j,x,k,z,w[11],22,-1990404162),z=O(z,j,x,k,w[12],7,1804603682),k=O(k,z,j,x,w[13],12,-40341101),x=O(x,k,z,j,w[14],17,-1502002290),j=O(j,x,k,z,w[15],22,1236535329),z=y(z,j,x,k,w[1],5,-165796510),k=y(k,z,j,x,w[6],9,-1069501632),x=y(x,k,z,j,w[11],14,643717713),j=y(j,x,k,z,w[0],20,-373897302),z=y(z,j,x,k,w[5],5,-701558691),k=y(k,z,j,x,w[10],9,38016083),x=y(x,k,z,j,w[15],14,-660478335),j=y(j,x,k,z,w[4],20,-405537848),z=y(z,j,x,k,w[9],5,568446438),k=y(k,z,j,x,w[14],9,-1019803690),x=y(x,k,z,j,w[3],14,-187363961),j=y(j,x,k,z,w[8],20,1163531501),z=y(z,j,x,k,w[13],5,-1444681467),k=y(k,z,j,x,w[2],9,-51403784),x=y(x,k,z,j,w[7],14,1735328473),j=y(j,x,k,z,w[12],20,-1926607734),z=P(z,j,x,k,w[5],4,-378558),k=P(k,z,j,x,w[8],11,-2022574463),x=P(x,k,z,j,w[11],16,1839030562),j=P(j,x,k,z,w[14],23,-35309556),z=P(z,j,x,k,w[1],4,-1530992060),k=P(k,z,j,x,w[4],11,1272893353),x=P(x,k,z,j,w[7],16,-155497632),j=P(j,x,k,z,w[10],23,-1094730640),z=P(z,j,x,k,w[13],4,681279174),k=P(k,z,j,x,w[0],11,-358537222),x=P(x,k,z,j,w[3],16,-722521979),j=P(j,x,k,z,w[6],23,76029189),z=P(z,j,x,k,w[9],4,-640364487),k=P(k,z,j,x,w[12],11,-421815835),x=P(x,k,z,j,w[15],16,530742520),j=P(j,x,k,z,w[2],23,-995338651),z=u(z,j,x,k,w[0],6,-198630844),k=u(k,z,j,x,w[7],10,1126891415),x=u(x,k,z,j,w[14],15,-1416354905),j=u(j,x,k,z,w[5],21,-57434055),z=u(z,j,x,k,w[12],6,1700485571),k=u(k,z,j,x,w[3],10,-1894986606),x=u(x,k,z,j,w[10],15,-1051523),j=u(j,x,k,z,w[1],21,-2054922799),z=u(z,j,x,k,w[8],6,1873313359),k=u(k,z,j,x,w[15],10,-30611744),x=u(x,k,z,j,w[6],15,-1560198380),j=u(j,x,k,z,w[13],21,1309151649),z=u(z,j,x,k,w[4],6,-145523070),k=u(k,z,j,x,w[11],10,-1120210379),x=u(x,k,z,j,w[2],15,718787259),j=u(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function m(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function Q(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function r(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,m(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function o(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,Q(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function v(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function t(j){var k;for(k=0;k<j.length;k+=1){j[k]=v(j[k])}return j.join("")}function n(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function p(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==t(r("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(x,z){var q,w,A,C,D=this.byteLength,k=j(x,D),B=D;return z!==l&&(B=j(z,D)),k>B?new ArrayBuffer(0):(q=B-k,w=new ArrayBuffer(q),A=new Uint8Array(w),C=new Uint8Array(this,k,q),A.set(C),w)}}(),p.prototype.append=function(j){return this.appendBinary(n(j)),this},p.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,m(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},p.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},p.hash=function(j,k){return p.hashBinary(n(j),k)},p.hashBinary=function(q,w){var k=r(q),j=t(k);return w?e(j):j},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,Q(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var j=p.prototype.getState.call(this);return j.buff=S(j.buff),j},p.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),p.prototype.setState.call(this,j)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(q,w){var k=o(new Uint8Array(q)),j=t(k);return w?e(j):j},p})},{}],17:[function(b,h,a){function e(n,r,g){var o=g[g.length-1];n===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,q=o.index;if(Array.isArray(f)){f.push(n)}else{if(q===r.length-2){var i=r.pop();f[i]=n}else{r.push(n)}}}a.stringify=function(f){var D=[];D.push({obj:f});for(var E,s,i,n,l,u,g,r,F,o,C,t="";E=D.pop();){if(s=E.obj,i=E.prefix||"",n=E.val||"",t+=i,n){t+=n}else{if("object"!=typeof s){t+="undefined"==typeof s?null:JSON.stringify(s)}else{if(null===s){t+="null"}else{if(Array.isArray(s)){for(D.push({val:"]"}),l=s.length-1;l>=0;l--){u=0===l?"":",",D.push({obj:s[l],prefix:u})}D.push({val:"["})}else{g=[];for(r in s){s.hasOwnProperty(r)&&g.push(r)}for(D.push({val:"}"}),l=g.length-1;l>=0;l--){F=g[l],o=s[F],C=l>0?",":"",C+=JSON.stringify(F)+":",D.push({obj:o,prefix:C})}D.push({val:"{"})}}}}}return t},a.parse=function(f){for(var o,A,t,l,g,n,D,u,s,i=[],B=[],C=0;;){if(o=f[C++],"}"!==o&&"]"!==o&&"undefined"!=typeof o){switch(o){case" ":case"	":case"\n":case":":case",":break;case"n":C+=3,e(null,i,B);break;case"t":C+=3,e(!0,i,B);break;case"f":C+=4,e(!1,i,B);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(A="",C--;;){if(t=f[C++],!/[\d\.\-e\+]/.test(t)){C--;break}A+=t}e(parseFloat(A),i,B);break;case'"':for(l="",g=void 0,n=0;;){if(D=f[C++],'"'===D&&("\\"!==g||n%2!==1)){break}l+=D,g=D,"\\"===g?n++:n=0}e(JSON.parse('"'+l+'"'),i,B);break;case"[":u={element:[],index:i.length},i.push(u.element),B.push(u);break;case"{":s={element:{},index:i.length},i.push(s.element),B.push(s);break;default:throw new Error("unexpectedly reached end of input: "+o)}}else{if(1===i.length){return i.pop()}e(i.pop(),i,B)}}}},{}]},{},[3])(3)});