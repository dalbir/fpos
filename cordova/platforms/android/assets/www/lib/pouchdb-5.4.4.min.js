!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(c,f,h){function j(i,l){if(!f[i]){if(!c[i]){var k="function"==typeof require&&require;if(!l&&k){return k(i,!0)}if(g){return g(i,!0)}var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var m=f[i]={exports:{}};c[i][0].call(m.exports,function(n){var o=c[i][1][n];return j(o?o:n)},m,m.exports,a,c,f,h)}return f[i].exports}for(var g="function"==typeof require&&require,d=0;d<h.length;d++){j(h[d])}return j}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function g(e){return"number"==typeof e}function h(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!g(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,n,o,q,e,m;if(this._events||(this._events={}),"error"===p&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[p],c(n)){return !1}if(k(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:q=Array.prototype.slice.call(arguments,1),n.apply(this,q)}}else{if(h(n)){for(q=Array.prototype.slice.call(arguments,1),m=n.slice(),o=m.length,e=0;o>e;e++){m[e].apply(this,q)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?h(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,h(this._events[m])&&!this._events[m].warned&&(e=c(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(i,n){function m(){this.removeListener(i,m),e||(e=!0,n.apply(this,arguments))}if(!k(n)){throw TypeError("listener must be a function")}var e=!1;return m.listener=n,this.on(i,m),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(h(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(j,q,p){function k(){v&&y&&(v=!1,y.length?w=y.concat(w):A=-1,w.length&&c())}function c(){if(!v){var f=d(k);v=!0;for(var e=w.length;e;){for(y=w,w=[];++A<e;){y&&y[A].run()}A=-1,e=w.length}y=null,v=!1,m(f)}}function g(f,e){this.fun=f,this.array=e}function x(){}var d,m,z=q.exports={};!function(){try{d=setTimeout}catch(e){d=function(){throw new Error("setTimeout is not defined")}}try{m=clearTimeout}catch(e){m=function(){throw new Error("clearTimeout is not defined")}}}();var y,w=[],v=!1,A=-1;z.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}w.push(new g(f,e)),1!==w.length||v||d(c,0)},g.prototype.run=function(){this.fun.apply(null,this.array)},z.title="browser",z.browser=!0,z.env={},z.argv=[],z.version="",z.versions={},z.on=x,z.addListener=x,z.once=x,z.off=x,z.removeListener=x,z.removeAllListeners=x,z.emit=x,z.binding=function(e){throw new Error("process.binding is not supported")},z.cwd=function(){return"/"},z.chdir=function(e){throw new Error("process.chdir is not supported")},z.umask=function(){return 0}},{}],3:[function(c,f,d){(function(dC,aL){function ed(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function f5(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eE(g){if("function"==typeof g.slice){return g.slice(0)}var i=new ArrayBuffer(g.byteLength),h=new Uint8Array(i),j=new Uint8Array(g);return h.set(j),i}function bJ(i){if(i instanceof ArrayBuffer){return eE(i)}var h=i.size,g=i.type;return"function"==typeof i.slice?i.slice(0,h,g):i.webkitSlice(0,h,g)}function d8(i){var h=Object.getPrototypeOf(i);if(null===h){return !0}var g=h.constructor;return"function"==typeof g&&g instanceof g&&fC.call(g)==e9}function eO(h){var k,j,g;if(!h||"object"!=typeof h){return h}if(Array.isArray(h)){for(k=[],j=0,g=h.length;g>j;j++){k[j]=eO(h[j])}return k}if(h instanceof Date){return h.toISOString()}if(f5(h)){return bJ(h)}if(!d8(h)){return h}k={};for(j in h){if(Object.prototype.hasOwnProperty.call(h,j)){var i=eO(h[j]);"undefined"!=typeof i&&(k[j]=i)}}return k}function f3(h){var g=!1;return cJ(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function dy(g){return cJ(function(j){j=eO(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){dC.nextTick(function(){i(n,m)})});var h=new bz(function(q,p){var n;try{var m=f3(function(r,s){r?p(r):q(s)});j.push(m),n=g.apply(l,j),n&&"function"==typeof n.then&&q(n)}catch(o){p(o)}});return k&&h.then(function(m){k(null,m)},k),h})}function eC(i,h){function g(k,o,m){if(cs.enabled){for(var j=[k._db_name,o],l=0;l<m.length-1;l++){j.push(m[l])}cs.apply(null,j);var n=m[m.length-1];m[m.length-1]=function(r,p){var q=[k._db_name,o];q=q.concat(r?["error",r]:["success",p]),cs.apply(null,q),n(r,p)}}}return dy(cJ(function(j){if(this._closed){return bz.reject(new Error("database is closed"))}if(this._destroyed){return bz.reject(new Error("database is destroyed"))}var k=this;return g(k,i,j),this.taskqueue.isReady?h.apply(this,j):new bz(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[i].apply(k,j))})})}))}function e4(i,l){for(var k={},h=0,j=l.length;j>h;h++){var g=l[h];g in i&&(k[g]=i[g])}return k}function eK(g){return g}function ch(g){return[{ok:g}]}function eB(u,i,q){function k(){var w=[];l.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),q(null,{results:w})}function o(){++s===h&&k()}function r(y,x,w){l[y]={id:x,docs:w},o()}function m(){if(!(j>=n.length)){var x=Math.min(j+aX,n.length),w=n.slice(j,x);g(w,j),j+=w.length}}function g(x,w){x.forEach(function(D,B){var z=w+B,A=p[D],C=e4(A[0],["atts_since","attachments"]);C.open_revs=A.map(function(E){return E.rev}),C.open_revs=C.open_revs.filter(eK);var y=eK;0===C.open_revs.length&&(delete C.open_revs,y=ch),["revs","attachments","binary","ajax"].forEach(function(E){E in i&&(C[E]=i[E])}),u.get(D,C,function(G,E){var F;F=G?[{error:G}]:y(E),r(z,D,F),m()})})}var v=i.docs,p={};v.forEach(function(w){w.id in p?p[w.id].push(w):p[w.id]=[w]});var h=Object.keys(p).length,s=0,l=new Array(h),n=Object.keys(p),j=0;m()}function eM(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function dd(){return fO}function eX(g){eM()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):dd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function fD(){aC.EventEmitter.call(this),this._listeners={},eX(this)}function bS(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function dg(h,k){var j=600000;h=parseInt(h,10)||0,k=parseInt(k,10),k!==k||h>=k?k=(h||1)<<1:k+=1,k>j&&(h=j>>1,k=j);var g=Math.random(),i=k-h;return ~~(i*g+h)}function dY(h){var g=0;return h||(g=2000),dg(h,g)}function dX(h,g){bS("info","The above "+h+" is totally normal. "+g)}function dk(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function av(g,i,h){function j(k){for(var l in g){"function"!=typeof g[l]&&(this[l]=g[l])}void 0!==h&&(this.name=h),void 0!==k&&(this.reason=k)}return j.prototype=dk.prototype,new j(i)}function c1(i){var l,k,h,j,g;return k=i.error===!0&&"string"==typeof i.name?i.name:i.error,g=i.reason,h=dV("name",k,g),i.missing||"missing"===g||"deleted"===g||"not_found"===k?h=eW:"doc_validation"===k?(h=eZ,j=g):"bad_request"===k&&h.message!==g&&(h=ba),h||(h=dV("status",i.status,g)||bW),l=av(h,g,k),j&&(l.message=j),i.id&&(l.id=i.id),i.status&&(l.status=i.status),i.missing&&(l.missing=i.missing),l}function bH(h,k,j){try{return !h(k,j)}catch(g){var i="Filter function threw: "+g.toString();return av(ba,i)}}function bq(i){var h={},g=i.filter&&"function"==typeof i.filter;return h.query=i.query_params,function(k){k.doc||(k.doc={});var l=g&&bH(i.filter,k.doc,h);if("object"==typeof l){return l}if(l){return !1}if(i.include_docs){if(!i.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function j8(g){for(var i=[],h=0,j=g.length;j>h;h++){i=i.concat(g[h])}return i}function cU(h){var g;if(h?"string"!=typeof h?g=av(c6):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=av(dw)):g=av(bw),g){throw g}}function bR(h,g){return"listenerCount" in h?h.listenerCount(g):aC.EventEmitter.listenerCount(h,g)}function eA(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function aU(h){var g=eA(h);return g?g.join("/"):null}function db(k){for(var i=fI.exec(k),g={},j=14;j--;){var l=fG[j],m=i[j]||"",h=-1!==["user","password"].indexOf(l);g[l]=h?decodeURIComponent(m):m}return g[kd]={},g[fG[12]].replace(f7,function(p,n,o){n&&(g[kd][n]=o)}),g}function dj(i,h,g){return new bz(function(j,k){i.get(h,function(l,n){if(l){if(404!==l.status){return k(l)}n={}}var m=n._rev,o=g(n);return o?(o._id=h,o._rev=m,void j(jY(i,o,g))):j({updated:!1,rev:m})})})}function jY(i,h,g){return i.put(h).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return dj(i,h._id,g)})}function c4(g){return 0|Math.random()*g}function eY(g,i){i=i||f1.length;var h="",j=-1;if(g){for(;++j<g;){h+=f1[c4(i)]}return h}for(;++j<36;){switch(j){case 8:case 13:case 18:case 23:h+="-";break;case 19:h+=f1[3&c4(16)|8];break;default:h+=f1[c4(16)]}}return h}function e8(r){for(var s,i,g,h,k=r.rev_tree.slice();h=k.pop();){var p=h.ids,l=p[2],q=h.pos;if(l.length){for(var o=0,m=l.length;m>o;o++){k.push({pos:q+1,ids:l[o]})}}else{var j=!!p[1].deleted,n=p[0];s&&!(g!==j?g:i!==q?q>i:n>s)||(s=n,i=q,g=j)}}return i+"-"+s}function ds(g,i){for(var m,k=g.slice();m=k.pop();){for(var l=m.pos,o=m.ids,h=o[2],j=i(0===h.length,l,o[0],m.ctx,o[1]),p=0,n=h.length;n>p;p++){k.push({pos:l+1,ids:h[p],ctx:j})}}}function a8(h,g){return h.pos-g.pos}function bC(g){var i=[];ds(g,function(l,n,k,m,o){l&&i.push({rev:n+"-"+k,pos:n,opts:o})}),i.sort(a8).reverse();for(var h=0,j=i.length;j>h;h++){delete i[h].pos}return i}function e5(k){for(var i=e8(k),g=bC(k.rev_tree),j=[],l=0,m=g.length;m>l;l++){var h=g[l];h.rev===i||h.opts.deleted||j.push(h.rev)}return j}function aP(h){var g=[];return ds(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function bP(r){for(var s,i=[],g=r.slice();s=g.pop();){var h=s.pos,k=s.ids,p=k[0],l=k[1],q=k[2],o=0===q.length,m=s.history?s.history.slice():[];m.push({id:p,opts:l}),o&&i.push({pos:h+1-m.length,ids:m});for(var j=0,n=q.length;n>j;j++){g.push({pos:h+1,ids:q[j],history:m})}}return i.reverse()}function fM(h,g){return h.pos-g.pos}function ap(i,l,k){for(var h,j=0,g=i.length;g>j;){h=j+g>>>1,k(i[h],l)<0?j=h+1:g=h}return j}function bK(g,i,h){var j=ap(g,i,h);g.splice(j,0,i)}function fH(l,n){for(var i,g,h=n,m=l.length;m>h;h++){var k=l[h],j=[k.id,k.opts,[]];g?(g[2].push(j),g=j):i=g=j}return i}function cI(h,g){return h[0]<g[0]?-1:1}function j4(g,i){for(var m=[{tree1:g,tree2:i}],k=!1;m.length>0;){var l=m.pop(),o=l.tree1,h=l.tree2;(o[1].status||h[1].status)&&(o[1].status="available"===o[1].status||"available"===h[1].status?"available":"missing");for(var j=0;j<h[2].length;j++){if(o[2][0]){for(var p=!1,n=0;n<o[2].length;n++){o[2][n][0]===h[2][j][0]&&(m.push({tree1:o[2][n],tree2:h[2][j]}),p=!0)}p||(k="new_branch",bK(o[2],h[2][j],cI))}else{k="new_leaf",o[2][0]=h[2][j]}}}return{conflicts:k,tree:g}}function aT(x,y,v){var q,k=[],m=!1,w=!1;if(!x.length){return{tree:[y],conflicts:"new_leaf"}}for(var A=0,j=x.length;j>A;A++){var s=x[A];if(s.pos===y.pos&&s.ids[0]===y.ids[0]){q=j4(s.ids,y.ids),k.push({pos:s.pos,ids:q.tree}),m=m||q.conflicts,w=!0}else{if(v!==!0){var p=s.pos<y.pos?s:y,z=s.pos<y.pos?y:s,o=z.pos-p.pos,n=[],i=[];for(i.push({ids:p.ids,diff:o,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],u=0,r=g.length;r>u;u++){i.push({ids:g[u],diff:h.diff-1,parent:h.ids,parentIdx:u})}}else{h.ids[0]===z.ids[0]&&n.push(h)}}var l=n[0];l?(q=j4(l.ids,z.ids),l.parent[2][l.parentIdx]=q.tree,k.push({pos:p.pos,ids:p.ids}),m=m||q.conflicts,w=!0):k.push(s)}else{k.push(s)}}}return w||k.push(y),k.sort(fM),{tree:k,conflicts:m||"internal_node"}}function fB(r,s){for(var i,g=bP(r),h={},k=0,p=g.length;p>k;k++){for(var l=g[k],q=l.ids,o=Math.max(0,q.length-s),m={pos:l.pos+o,ids:fH(q,o)},j=0;o>j;j++){var n=l.pos+j+"-"+q[j].id;h[n]=!0}i=i?aT(i,m,!0).tree:[m]}return ds(i,function(u,w,v){delete h[w+"-"+v]}),{tree:i,revs:Object.keys(h)}}function aA(h,k,j){var g=aT(h,k),i=fB(g.tree,j);return{tree:i.tree,stemmedRevs:i.revs,conflicts:g.conflicts}}function d3(g,i){for(var m,k=g.slice(),l=i.split("-"),o=parseInt(l[0],10),h=l[1];m=k.pop();){if(m.pos===o&&m.ids[0]===h){return !0}for(var j=m.ids[2],p=0,n=j.length;n>p;p++){k.push({pos:m.pos+1,ids:j[p]})}}return !1}function af(g){return g.ids}function dH(h,k){k||(k=e8(h));for(var j,g=k.substring(k.indexOf("-")+1),i=h.rev_tree.map(af);j=i.pop();){if(j[0]===g){return !!j[1].deleted}i=i.concat(j[2])}}function cd(g){return/^_local/.test(g)}function cm(g){return c8("return "+g+";",{})}function aI(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function du(i,h){try{i.emit("change",h)}catch(g){bS("error",'Error in .on("change", function):',g)}}function cE(k,i,g){function j(){l.cancel()}aC.EventEmitter.call(this);var l=this;this.db=k,i=i?eO(i):{};var m=i.complete=f3(function(o,n){o?bR(l,"error")>0&&l.emit("error",o):l.emit("complete",n),l.removeAllListeners(),k.removeListener("destroyed",j)});g&&(l.on("complete",function(n){g(null,n)}),l.on("error",g)),k.once("destroyed",j),i.onChange=function(n){i.isCancelled||(du(l,n),l.startSeq&&l.startSeq<=n.seq&&(l.startSeq=!1))};var h=new bz(function(o,n){i.complete=function(p,q){p?n(p):o(q)}});l.once("cancel",function(){k.removeListener("destroyed",j),i.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){m(null,n)},m),k.taskqueue.isReady?l.doChanges(i):k.taskqueue.addTask(function(){l.isCancelled?l.emit("cancel"):l.doChanges(i)})}function dZ(h,k,j){var g=[{rev:h._rev}];"all_docs"===j.style&&(g=bC(k.rev_tree).map(function(l){return{rev:l.rev}}));var i={id:k.id,changes:g,doc:h};return dH(k,h._rev)&&(i.deleted=!0),j.conflicts&&(i.doc._conflicts=e5(k),i.doc._conflicts.length||delete i.doc._conflicts),i}function bI(h,g){return g>h?-1:h>g?1:0}function fP(i,h){for(var g=0;g<i.length;g++){if(h(i[g],g)===!0){return i[g]}}}function jQ(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function e1(i){for(var l=0;l<i.length;l++){var k=i[l];if(k._deleted){delete k._attachments}else{if(k._attachments){for(var h=Object.keys(k._attachments),j=0;j<h.length;j++){var g=h[j];k._attachments[g]=e4(k._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function ki(h,k){var j=bI(h._id,k._id);if(0!==j){return j}var g=h._revisions?h._revisions.start:0,i=k._revisions?k._revisions.start:0;return bI(g,i)}function cP(i){var h={},g=[];return ds(i,function(l,k,m,j){var n=k+"-"+m;return l&&(h[n]=0),void 0!==j&&g.push({from:j,to:n}),n}),g.reverse(),g.forEach(function(j){void 0===h[j.from]?h[j.from]=1+h[j.to]:h[j.from]=Math.min(h[j.from],1+h[j.to])}),h}function kc(h,k,j){var g="limit" in k?k.keys.slice(k.skip,k.limit+k.skip):k.skip>0?k.keys.slice(k.skip):k.keys;if(k.descending&&g.reverse(),!g.length){return h._allDocs({limit:0},j)}var i={offset:k.skip};return bz.all(g.map(function(m){var l=eD.extend({key:m,deleted:"ok"},k);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new bz(function(o,n){h._allDocs(l,function(q,p){return q?n(q):(i.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return i.rows=l,i})}function ek(g){var i=g._compactionQueue[0],j=i.opts,h=i.callback;g.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(j.last_seq=k.last_seq),g._compact(j,function(l,m){l?h(l):h(null,m),dC.nextTick(function(){g._compactionQueue.shift(),g._compactionQueue.length&&ek(g)})})})}function bc(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function aD(){aC.EventEmitter.call(this)}function dE(){this.isReady=!1,this.failed=!1,this.queue=[]}function eU(g){g&&aL.debug&&bS("error",g)}function e3(k,i){function g(){m.emit("destroyed",l)}function j(){k.removeListener("destroyed",g),k.emit("destroyed",k)}var l=i.originalName,m=k.constructor,h=m._destructionListeners;k.once("destroyed",g),h.has(l)||h.set(l,[]),h.get(l).push(j)}function e(k,i,g){if(!(this instanceof e)){return new e(k,i,g)}var j=this;if("function"!=typeof i&&"undefined"!=typeof i||(g=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),"undefined"==typeof g){g=eU}else{var l=g;g=function(){return bS("warn","Using a callback for new PouchDB()is deprecated."),l.apply(null,arguments)}}k=k||i.name,i=eO(i),delete i.name,this.__opts=i;var m=g;j.auto_compaction=i.auto_compaction,j.prefix=e.prefix,aD.call(j),j.taskqueue=new dE;var h=new bz(function(o,q){g=function(r,s){return r?q(r):(delete s.then,void o(s))},i=eO(i);var p,n;return function(){try{if("string"!=typeof k){throw n=new Error("Missing/invalid DB name"),n.code=400,n}var r=(i.prefix||"")+k;if(p=e.parseAdapter(r,i),i.originalName=k,i.name=p.name,i.adapter=i.adapter||p.adapter,j._adapter=i.adapter,cz("pouchdb:adapter")("Picked adapter: "+i.adapter),j._db_name=k,!e.adapters[i.adapter]){throw n=new Error("Adapter is missing"),n.code=404,n}if(!e.adapters[i.adapter].valid()){throw n=new Error("Invalid Adapter"),n.code=404,n}}catch(s){j.taskqueue.fail(s)}}(),n?q(n):(j.adapter=i.adapter,j.replicate={},j.replicate.from=function(r,u,s){return j.constructor.replicate(r,j,u,s)},j.replicate.to=function(r,u,s){return j.constructor.replicate(j,r,u,s)},j.sync=function(r,u,s){return j.constructor.sync(j,r,u,s)},j.replicate.sync=j.sync,void e.adapters[i.adapter].call(j,i,function(r){return r?(j.taskqueue.fail(r),void g(r)):(e3(j,i),j.emit("created",j),e.emit("created",i.originalName),j.taskqueue.ready(j),void g(null,j))}))});h.then(function(n){m(null,n)},m),j.then=h.then.bind(h),j["catch"]=h["catch"].bind(h)}function dv(h){Object.keys(aC.EventEmitter.prototype).forEach(function(i){"function"==typeof aC.EventEmitter.prototype[i]&&(h[i]=bE[i].bind(bE))});var g=h._destructionListeners=new bb.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function eR(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function aa(g){if(!/^\d+\-./.test(g)){return av(bA)}var i=g.indexOf("-"),h=g.substring(0,i),j=g.substring(i+1);return{prefix:parseInt(h,10),id:j}}function bd(k,i){for(var g=k.start-k.ids.length+1,j=k.ids,l=[j[0],i,[]],m=1,h=j.length;h>m;m++){l=[j[m],{status:"missing"},[l]]}return[{pos:g,ids:l}]}function aQ(g,i){var m,k,l,o={status:"available"};if(g._deleted&&(o.deleted=!0),i){if(g._id||(g._id=eY()),k=eY(32,16).toLowerCase(),g._rev){if(l=aa(g._rev),l.error){return l}g._rev_tree=[{pos:l.prefix,ids:[l.id,{status:"missing"},[[k,o,[]]]]}],m=l.prefix+1}else{g._rev_tree=[{pos:1,ids:[k,o,[]]}],m=1}}else{if(g._revisions&&(g._rev_tree=bd(g._revisions,o),m=g._revisions.start,k=g._revisions.ids[0]),!g._rev_tree){if(l=aa(g._rev),l.error){return l}m=l.prefix,k=l.id,g._rev_tree=[{pos:m,ids:[k,o,[]]}]}}cU(g._id),g._rev=m+"-"+k;var h={metadata:{},data:{}};for(var j in g){if(Object.prototype.hasOwnProperty.call(g,j)){var p="_"===j[0];if(p&&!ck[j]){var n=av(eZ,j);throw n.message=eZ.message+": "+j,n}p&&!cG[j]?h.metadata[j.slice(1)]=g[j]:h.data[j]=g[j]}}return h}function j1(h){for(var k="",j=new Uint8Array(h),g=j.byteLength,i=0;g>i;i++){k+=String.fromCharCode(j[i])}return k}function bM(g){return cD(j1(g))}function fJ(i,l){i=i||[],l=l||{};try{return new Blob(i,l)}catch(k){if("TypeError"!==k.name){throw k}for(var h="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,j=new h,g=0;g<i.length;g+=1){j.append(i[g])}return j.getBlob(l.type)}}function jW(h){for(var k=h.length,j=new ArrayBuffer(k),g=new Uint8Array(j),i=0;k>i;i++){g[i]=h.charCodeAt(i)}return j}function fK(h,g){return fJ([jW(h)],{type:g})}function e0(h,g){return fK(jR(h),g)}function j7(g,i){if("undefined"==typeof FileReader){return i(j1((new FileReaderSync).readAsArrayBuffer(g)))}var h=new FileReader,j="function"==typeof h.readAsBinaryString;h.onloadend=function(k){var l=k.target.result||"";return j?i(l):void i(j1(l))},j?h.readAsBinaryString(g):h.readAsArrayBuffer(g)}function aE(h,g){j7(h,function(i){g(cD(i))})}function fE(i,h){if("undefined"==typeof FileReader){return h((new FileReaderSync).readAsArrayBuffer(i))}var g=new FileReader;g.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);h(k)},g.readAsArrayBuffer(i)}function jN(g){return cD(g)}function jG(g,i,h,j){(h>0||j<i.byteLength)&&(i=new Uint8Array(i,h,Math.min(j,i.byteLength)-h)),g.append(i)}function eh(g,i,h,j){(h>0||j<i.length)&&(i=i.substring(h,j)),g.appendBinary(i)}function dz(g,i){function m(){var q=j*o,u=q+o;if(j++,h>j){n(p,g,q,u),cM(m)}else{n(p,g,q,u);var r=p.end(!0),s=jN(r);i(s),p.destroy()}}var k="string"==typeof g,l=k?g.length:g.byteLength,o=Math.min(bG,l),h=Math.ceil(l/o),j=0,p=k?new aZ:new aZ.ArrayBuffer,n=k?eh:jG;m()}function c9(g){return aZ.hash(g)}function jM(l,n,i){function g(o){try{return jR(o)}catch(q){var p=av(e6,"Attachment is not a valid base64 string");return{error:p}}}function h(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=g(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===n?q.data=fK(o,q.content_type):"base64"===n?q.data=cD(o):q.data=o,dz(o,function(r){q.digest="md5-"+r,p()})}else{fE(q.data,function(r){"binary"===n?q.data=j1(r):"base64"===n&&(q.data=bM(r)),dz(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function m(){j++,l.length===j&&(k?i(k):i())}if(!l.length){return i()}var k,j=0;l.forEach(function(r){function p(u){k=u,q++,q===s.length&&m()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return m()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&h(r.data._attachments[o],p)}})}function bB(w,x,l,B,k,p,v,s){if(d3(x.rev_tree,l.metadata.rev)){return B[k]=l,p()}var j=x.winningRev||e8(x),m="deleted" in x?x.deleted:dH(x,j),A="deleted" in l.metadata?l.metadata.deleted:dH(l.metadata),n=/^1-/.test(l.metadata.rev);if(m&&!A&&s&&n){var z=l.data;z._rev=j,z._id=l.metadata.id,l=aQ(z,s)}var q=aA(x.rev_tree,l.metadata.rev_tree[0],w),i=s&&(m&&A||!m&&"new_leaf"!==q.conflicts||m&&!A&&"new_branch"===q.conflicts);if(i){var h=av(cf);return B[k]=h,p()}var g=l.metadata.rev;l.metadata.rev_tree=q.tree,l.stemmedRevs=q.stemmedRevs||[],x.rev_map&&(l.metadata.rev_map=x.rev_map);var r,y=e8(l.metadata),o=dH(l.metadata,y),u=m===o?0:o>m?-1:1;r=g===y?o:dH(l.metadata,g),v(l,y,o,r,!0,u,k,p)}function eg(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function aO(o,q,i,m,u,k,p,g,j){function l(B,x,C){var z=e8(B.metadata),w=dH(B.metadata,z);if("was_delete" in g&&w){return k[x]=av(eW,"deleted"),C()}var D=r&&eg(B);if(D){var A=av(cf);return k[x]=A,C()}var y=w?0:1;p(B,z,w,w,!1,y,x,C)}function h(){++n===s&&j&&j()}o=o||1000;var r=g.new_edits,v=new bb.Map,n=0,s=q.length;q.forEach(function(y,w){if(y._id&&cd(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void i[x](y,{ctx:u},function(B,A){k[w]=B||A,h()})}var z=y.metadata.id;v.has(z)?(s--,v.get(z).push([y,w])):v.set(z,[[y,w]])}),v.forEach(function(x,z){function y(){++w<x.length?A():h()}function A(){var C=x[w],E=C[0],D=C[1];if(m.has(z)){bB(o,m.get(z),E,k,D,y,p,r)}else{var B=aA([],E.metadata.rev_tree[0],o);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],l(E,D,y)}}var w=0;A()})}function cX(h){try{return JSON.parse(h)}catch(g){return d5.parse(h)}}function jV(g){return g.length<50000?JSON.parse(g):cX(g)}function cO(h){try{return JSON.stringify(h)}catch(g){return d5.stringify(h)}}function j0(h,k,j,g){try{h.apply(k,j)}catch(i){g.emit("error",i)}}function b8(h){if(!bg.running&&bg.queue.length){bg.running=!0;var g=bg.queue.shift();g.action(function(i,j){j0(g.callback,this,[i,j],h),bg.running=!1,dC.nextTick(function(){b8(h)})})}}function eG(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(av(eP,i,h.type))}}function aB(i,h,g){return{data:cO(i),winningRev:h,deletedOrLocal:g?"1":"0",seq:i.seq,id:i.id}}function bk(h){if(!h){return null}var g=jV(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function cp(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function d2(g,i,h,j){h?j(g?"string"!=typeof g?g:e0(g,i):fJ([""],{type:i})):g?"string"!=typeof g?j7(g,function(k){j(cD(k))}):j(g):j("")}function b1(l,n,i,g){function h(){++j===k.length&&g&&g()}function m(s,q){var r=s._attachments[q],p=r.digest,o=i.objectStore(dW).get(p);o.onsuccess=function(u){r.body=u.target.result.body,h()}}var k=Object.keys(l._attachments||{});if(!k.length){return g&&g()}var j=0;k.forEach(function(o){n.attachments&&n.include_docs?m(l,o):(l._attachments[o].stub=!0,h())})}function cR(h,g){return bz.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return bz.all(j.map(function(l){var n=i.doc._attachments[l];if("body" in n){var k=n.body,m=n.content_type;return new bz(function(o){d2(k,m,g,function(p){i.doc._attachments[l]=eD.extend(e4(n,["digest","content_type"]),{data:p}),o()})})}}))}}))}function ay(g,i,m){function k(){n--,n||l()}function l(){o.length&&o.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||j["delete"](q)}})}var o=[],h=m.objectStore(e7),j=m.objectStore(dW),p=m.objectStore(ej),n=g.length;g.forEach(function(s){var r=h.index("_doc_id_rev"),q=i+"::"+s;r.getKey(q).onsuccess=function(w){var v=w.target.result;if("number"!=typeof v){return k()}h["delete"](v);var u=p.index("seq").openCursor(IDBKeyRange.only(v));u.onsuccess=function(y){var x=y.target.result;if(x){var z=x.value.digestSeq.split("::")[0];o.push(z),p["delete"](x.primaryKey),x["continue"]()}else{k()}}}})}function c3(g,i,h){try{return{txn:g.transaction(i,h)}}catch(j){return{error:j}}}function bl(v,k,r,m,x,j,G){function D(){var P=[cA,e7,dW,bj,ej],O=c3(x,P,"readwrite");return O.error?G(O.error):(H=O.txn,H.onabort=eG(G),H.ontimeout=eG(G),H.oncomplete=E,y=H.objectStore(cA),I=H.objectStore(e7),q=H.objectStore(dW),N=H.objectStore(ej),void g(function(Q){return Q?(L=!0,G(Q)):void h()}))}function C(){aO(v.revs_limit,o,m,z,H,w,l,r)}function h(){function U(){++P===o.length&&C()}function S(W){var V=bk(W.target.result);V&&z.set(V.id,V),U()}if(o.length){for(var P=0,T=0,O=o.length;O>T;T++){var R=o[T];if(R._id&&cd(R._id)){U()}else{var Q=y.get(R.metadata.id);Q.onsuccess=S}}}}function E(){L||(j.notify(m._meta.name),m._meta.docCount+=B,G(null,w))}function p(P,O){var Q=q.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=av(bF,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(o.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){p(T,function(U){U&&!P&&(P=U),O()})})}function l(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?n(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ai){var ao=X.stemmedRevs||[];R&&m.auto_compaction&&(ao=ao.concat(aP(X.metadata))),ao&&ao.length&&ay(ao,X.metadata.id,H),T.seq=ai.target.result,delete T.rev;var an=aB(T,Q,S),ae=y.put(an);ae.onsuccess=Z}function P(ae){ae.preventDefault(),ae.stopPropagation();var an=I.index("_doc_id_rev"),ai=an.getKey(V._doc_id_rev);ai.onsuccess=function(ar){var ao=I.put(V,ar.target.result);ao.onsuccess=W}}function Z(){w[U]={ok:!0,id:T.id,rev:Q},z.set(X.metadata.id,X.metadata),u(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=I.put(V);Y.onsuccess=W,Y.onerror=P}function n(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(ai){var Z=W.data._attachments[ai];if(Z.stub){X++,Y()}else{var ae=Z.data;delete Z.data,Z.revpos=parseInt(P,10);var an=Z.digest;A(an,ae,Q)}})}function u(R,O,T){function Q(){++V===U.length&&T()}function S(Y){var X=R.data._attachments[Y].digest,W=N.put({seq:O,digestSeq:X+"::"+O});W.onsuccess=Q,W.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),Q()}}var V=0,U=Object.keys(R.data._attachments||{});if(!U.length){return T()}for(var P=0;P<U.length;P++){S(U[P])}}function A(Q,O,R){var P=q.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=q.put(U);T.onsuccess=R}}for(var H,y,I,q,N,M,o=k.docs,B=0,s=0,J=o.length;J>s;s++){var F=o[s];F._id&&cd(F._id)||(F=o[s]=aQ(F,r.new_edits),F.error&&!M&&(M=F))}if(M){return G(M)}var w=new Array(o.length),z=new bb.Map,L=!1,i=m._meta.blobSupport?"blob":"base64";jM(o,i,function(O){return O?G(O):void D()})}function aM(i,l,k,h,j){try{if(i&&l){return j?IDBKeyRange.bound(l,i,!k,!1):IDBKeyRange.bound(i,l,!1,!k)}if(i){return j?IDBKeyRange.upperBound(i):IDBKeyRange.lowerBound(i)}if(l){return j?IDBKeyRange.lowerBound(l,!k):IDBKeyRange.upperBound(l,!k)}if(h){return IDBKeyRange.only(h)}}catch(g){return{error:g}}return null}function bu(g,i,h,j){return"DataError"===h.name&&0===h.code?j(null,{total_rows:g._meta.docCount,offset:i.skip,rows:[]}):void j(av(eP,h.name,h.message))}function aR(i,l,k,h){function j(H,B){function E(N,M,O){var L=N.id+"::"+O;D.get(L).onsuccess=function(P){M.doc=cp(P.target.result),H.conflicts&&(M.doc._conflicts=e5(N)),b1(M.doc,H,x)}}function v(P,M,L){var O={id:L.id,key:L.id,value:{rev:M}},N=L.deleted;if("ok"===H.deleted){m.push(O),N?(O.value.deleted=!0,O.doc=null):H.include_docs&&E(L,O,M)}else{if(!N&&I--<=0&&(m.push(O),H.include_docs&&E(L,O,M),0===--F)){return}}P["continue"]()}function z(O){K=l._meta.docCount;var M=O.target.result;if(M){var N=bk(M.value),L=N.winningRev;v(M,L,N)}}function q(){B(null,{total_rows:K,offset:H.skip,rows:m})}function C(){H.attachments?cR(m,H.binary).then(q):q()}var o="startkey" in H?H.startkey:!1,r="endkey" in H?H.endkey:!1,s="key" in H?H.key:!1,I=H.skip||0,F="number"==typeof H.limit?H.limit:-1,u=H.inclusive_end!==!1,y="descending" in H&&H.descending?"prev":null,A=aM(o,r,u,s,y);if(A&&A.error){return bu(l,H,A.error,B)}var G=[cA,e7];H.attachments&&G.push(dW);var J=c3(k,G,"readonly");if(J.error){return B(J.error)}var x=J.txn,n=x.objectStore(cA),w=x.objectStore(e7),p=y?n.openCursor(A,y):n.openCursor(A),D=w.index("_doc_id_rev"),m=[],K=0;x.oncomplete=C,p.onsuccess=z}function g(m,n){return 0===m.limit?n(null,{total_rows:l._meta.docCount,offset:m.skip,rows:[]}):void j(m,n)}g(i,h)}function bs(g){return new bz(function(h){var i=fJ([""]);g.objectStore(am).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function t(i,h){var g=this;bg.queue.push({action:function(j){cZ(g,i,j)},callback:h}),b8(g.constructor)}function cZ(n,o,u){function h(x){var w=x.createObjectStore(cA,{keyPath:"id"});x.createObjectStore(e7,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(dW,{keyPath:"digest"}),x.createObjectStore(aW,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(am),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(bj,{keyPath:"_id"});var v=x.createObjectStore(ej,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function i(x,w){var v=x.objectStore(cA);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=dH(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function s(v){v.createObjectStore(bj,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function m(v,x){var w=v.objectStore(bj),y=v.objectStore(cA),z=v.objectStore(e7),A=y.openCursor();A.onsuccess=function(F){var C=F.target.result;if(C){var I=C.value,L=I.id,K=cd(L),H=e8(I);if(K){var E=L+"::"+H,B=L+"::",G=L+"::~",D=z.index("_doc_id_rev"),M=IDBKeyRange.bound(B,G,!1,!1),J=D.openCursor(M);J.onsuccess=function(N){if(J=N.target.result){var O=J.value;O._doc_id_rev===E&&w.put(O),z["delete"](J.primaryKey),J["continue"]()}else{y["delete"](C.primaryKey),C["continue"]()}}}else{C["continue"]()}}else{x&&x()}}}function j(w){var v=w.createObjectStore(ej,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function k(v,x){var w=v.objectStore(e7),y=v.objectStore(dW),z=v.objectStore(ej),A=y.count();A.onsuccess=function(B){var C=B.target.result;return C?void (w.openCursor().onsuccess=function(H){var D=H.target.result;if(!D){return x()}for(var M=D.value,F=D.primaryKey,J=Object.keys(M._attachments||{}),L={},K=0;K<J.length;K++){var I=M._attachments[J[K]];L[I.digest]=!0}var G=Object.keys(L);for(K=0;K<G.length;K++){var E=G[K];z.put({seq:F,digestSeq:E+"::"+F})}D["continue"]()}):x()}}function p(w){function x(A){return A.data?bk(A):(A.deleted="1"===A.deletedOrLocal,A)}var v=w.objectStore(e7),z=w.objectStore(cA),y=z.openCursor();y.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=v.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=aB(B,B.winningRev,B.deleted),F=z.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=x(E.value);return B.winningRev=B.winningRev||e8(B),B.seq?A():void D()}}}var g=o.name,q=null;n._meta=null,n.type=function(){return"idb"},n._id=dy(function(v){v(null,n._meta.instanceId)}),n._bulkDocs=function(v,w,x){bl(o,v,w,n,q,ag,x)},n._get=function(w,A,z){function D(){z(x,{doc:v,metadata:C,ctx:B})}var v,C,x,B=A.ctx;if(!B){var y=c3(q,[cA,e7,dW],"readonly");if(y.error){return z(y.error)}B=y.txn}B.objectStore(cA).get(w).onsuccess=function(E){if(C=bk(E.target.result),!C){return x=av(eW,"missing"),D()}if(dH(C)&&!A.rev){return x=av(eW,"deleted"),D()}var G=B.objectStore(e7),H=A.rev||C.winningRev,F=C.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return v=I.target.result,v&&(v=cp(v)),v?void D():(x=av(eW,"missing"),D())}}},n._getAttachment=function(w,A,z,D,v){var C;if(D.ctx){C=D.ctx}else{var x=c3(q,[cA,e7,dW],"readonly");if(x.error){return v(x.error)}C=x.txn}var B=z.digest,y=z.content_type;C.objectStore(dW).get(B).onsuccess=function(E){var F=E.target.result.body;d2(F,y,D.binary,function(G){v(null,G)})}},n._info=function(A){if(null===q||!cQ.has(g)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var x,z,v=c3(q,[e7],"readonly");if(v.error){return A(v.error)}var w=v.txn,B=w.objectStore(e7).openCursor(null,"prev");B.onsuccess=function(D){var C=D.target.result;x=C?C.key:0,z=n._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:x,idb_attachment_format:n._meta.blobSupport?"binary":"base64"})}},n._allDocs=function(v,w){aR(v,n,q,w)},n._changes=function(L){function C(N){function T(){return S.seq!==O?N["continue"]():(v=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=E.get(U);V.onsuccess=function(W){R(cp(W.target.result))}}function R(V){var W=L.processChange(V,S,L);W.seq=S.seq;var U=A(W);return"object"==typeof U?L.complete(U):(U&&(B++,w&&D.push(W),L.attachments&&L.include_docs?b1(V,L,J,function(){cR([W],L.binary).then(function(){L.onChange(W)})}):L.onChange(W)),void (B!==z&&N["continue"]()))}var P=cp(N.value),O=N.key;if(x&&!x.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (G.get(P._id).onsuccess=function(U){S=bk(U.target.result),y.set(P._id,S),T()})}function I(N){var O=N.target.result;O&&C(O)}function M(){var P=[cA,e7];L.attachments&&P.push(dW);var O=c3(q,P,"readonly");if(O.error){return L.complete(O.error)}J=O.txn,J.onabort=eG(L.complete),J.oncomplete=H,F=J.objectStore(e7),G=J.objectStore(cA),E=F.index("_doc_id_rev");var N;N=L.descending?F.openCursor(null,"prev"):F.openCursor(IDBKeyRange.lowerBound(L.since,!0)),N.onsuccess=I}function H(){function N(){L.complete(null,{results:D,last_seq:v})}!L.continuous&&L.attachments?cR(D).then(N):N()}if(L=eO(L),L.continuous){var K=g+":"+eY();return ag.addListener(g,K,n,L),ag.notify(g),{cancel:function(){ag.removeListener(g,K)}}}var x=L.doc_ids&&new bb.Set(L.doc_ids);L.since=L.since||0;var v=L.since,z="limit" in L?L.limit:-1;0===z&&(z=1);var w;w="return_docs" in L?L.return_docs:"returnDocs" in L?L.returnDocs:!0;var J,F,G,E,D=[],B=0,A=bq(L),y=new bb.Map;M()},n._close=function(v){return null===q?v(av(cY)):(q.close(),cQ["delete"](g),q=null,void v())},n._getRevisionTree=function(w,x){var v=c3(q,[cA],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(cA).get(w);y.onsuccess=function(B){var A=bk(B.target.result);A?x(null,A.rev_tree):x(av(eW))}},n._doCompaction=function(y,A,z){var B=[cA,e7,dW,ej],x=c3(q,B,"readwrite");if(x.error){return z(x.error)}var v=x.txn,w=v.objectStore(cA);w.get(y).onsuccess=function(E){var C=bk(E.target.result);ds(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),ay(A,y,v);var D=C.winningRev,F=C.deleted;v.objectStore(cA).put(aB(C,D,F))},v.onabort=eG(z),v.oncomplete=function(){z()}},n._getLocal=function(w,x){var v=c3(q,[bj],"readonly");if(v.error){return x(v.error)}var z=v.txn,y=z.objectStore(bj).get(w);y.onerror=eG(x),y.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,x(null,A)):x(av(eW))}},n._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=c3(q,[bj],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=eG(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(bj);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(av(cf))}}):(y=v.add(E),y.onerror=function(F){x(av(cf)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},n._removeLocal=function(w,A,z){"function"==typeof A&&(z=A,A={});var D=A.ctx;if(!D){var v=c3(q,[bj],"readwrite");if(v.error){return z(v.error)}D=v.txn,D.oncomplete=function(){C&&z(null,C)}}var C,x=w._id,B=D.objectStore(bj),y=B.get(x);y.onerror=eG(z),y.onsuccess=function(F){var E=F.target.result;E&&E._rev===w._rev?(B["delete"](x),C={ok:!0,id:x,rev:"0-0"},A.ctx&&z(null,C)):z(av(eW))}},n._destroy=function(w,y){ag.removeAllListeners(g);var x=f4.get(g);x&&x.result&&(x.result.close(),cQ["delete"](g));var v=indexedDB.deleteDatabase(g);v.onsuccess=function(){f4["delete"](g),dd()&&g in localStorage&&delete localStorage[g],y(null,{ok:!0})},v.onerror=eG(y)};var l=cQ.get(g);if(l){return q=l.idb,n._meta=l.global,void dC.nextTick(function(){u(null,n)})}var r;r=o.storage?aG(g,o.storage):indexedDB.open(g,dG),f4.set(g,r),r.onupgradeneeded=function(x){function v(){var B=z[A-1];A++,B&&B(w,v)}var y=x.target.result;if(x.oldVersion<1){return h(y)}var w=x.currentTarget.transaction;x.oldVersion<3&&s(y),x.oldVersion<4&&j(y);var z=[i,m,k,p],A=x.oldVersion;v()},r.onsuccess=function(y){q=y.target.result,q.onversionchange=function(){q.close(),cQ["delete"](g)},q.onabort=function(B){bS("error","Database has a global failure",B.target.error),q.close(),cQ["delete"](g)};var w=q.transaction([aW,am,cA],"readwrite"),z=w.objectStore(aW).get(aW),x=null,v=null,A=null;z.onsuccess=function(D){var B=function(){null!==x&&null!==v&&null!==A&&(n._meta={name:g,instanceId:A,blobSupport:x,docCount:v},cQ.set(g,{idb:q,global:n._meta}),u(null,n))},E=D.target.result||{id:aW};g+"_id" in E?(A=E[g+"_id"],B()):(A=eY(),E[g+"_id"]=A,w.objectStore(aW).put(E).onsuccess=function(){B()}),d6||(d6=bs(w)),d6.then(function(F){x=F,B()});var C=w.objectStore(cA).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){v=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";bS("error",v),u(av(eP,v))}}function aG(i,h){try{return indexedDB.open(i,{version:dG,storage:h})}catch(g){return indexedDB.open(i,dG)}}function b4(g){g.adapter("idb",t,!0)}function aS(g){return decodeURIComponent(escape(g))}function aw(g){return 65>g?g-48:g-55}function al(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(aw(g.charCodeAt(i++))<<4|aw(g.charCodeAt(i++)))}return j}function bf(g,i,h){for(var j="";h>i;){j+=String.fromCharCode(aw(g.charCodeAt(i+2))<<12|aw(g.charCodeAt(i+3))<<8|aw(g.charCodeAt(i))<<4|aw(g.charCodeAt(i+1))),i+=4}return j}function bh(h,g){return"UTF-8"===g?aS(al(h,0,h.length)):bf(h,0,h.length)}function cw(g){return"'"+g+"'"}function b5(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cH(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aH(g){return delete g._id,delete g._rev,JSON.stringify(g)}function aV(i,h,g){return i=JSON.parse(i),i._id=h,i._rev=g,i}function dl(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function cy(h,k,j,g,i){return"SELECT "+h+" FROM "+("string"==typeof k?k:k.join(" JOIN "))+(j?" ON "+j:"")+(g?" WHERE "+("string"==typeof g?g:g.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function aJ(k,i,g){function j(){++m===k.length&&l()}function l(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+cv+" WHERE seq IN "+dl(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+cv+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+cv+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new bb.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+cv+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+aq+" WHERE digest=?",[A]))})})})}})}}if(k.length){var m=0,h=[];k.forEach(function(o){var n="SELECT seq FROM "+jT+" WHERE doc_id=? AND rev=?";g.executeSql(n,[i,o],function(q,p){if(!p.rows.length){return j()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+jT+" WHERE seq=?",[r],j)})})}}function cB(g){return function(h){bS("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(av(c2,j,i))}}function c5(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function bY(h,s,g,m,n,B,q){function k(){return w?q(w):(B.notify(m._name),m._docCount=-1,void q(null,r))}function j(E,D){var F="SELECT count(*) as cnt FROM "+aq+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=av(bF,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function x(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){j(I,function(J){J&&!E&&(E=J),D()})})}function z(H,P,K,F,D,M,R,O){function J(){function W(ar,at){function a0(){return ++ao===an.length&&at(),!1}function ai(a2){var a3="INSERT INTO "+cv+" (digest, seq) VALUES (?,?)",a1=[V._attachments[a2].digest,ar];p.executeSql(a3,a1,a0,a0)}var ao=0,an=Object.keys(V._attachments||{});if(!an.length){return at()}for(var ae=0;ae<an.length;ae++){ai(an[ae])}}var V=H.data,Y=F?1:0,T=V._id,X=V._rev,Z=aH(V),S="INSERT INTO "+jT+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",U=[T,X,Z,Y];p.executeSql(S,U,function(ai,ae){var an=ae.insertId;W(an,function(){I(ai,an)})},function(){var ae=cy("seq",jT,null,"doc_id=? AND rev=?");return p.executeSql(ae,[T,X],function(ao,ar){var ai=ar.rows.item(0).seq,an="UPDATE "+jT+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[Z,Y,T,X];ao.executeSql(an,at,function(a0){W(ai,function(){I(a0,ai)})})}),!1})}function G(S){E||(S?(E=S,O(E)):N===L.length&&J())}function Q(S){N++,G(S)}function I(S,Y){var U=H.metadata.id,T=H.stemmedRevs||[];D&&m.auto_compaction&&(T=aP(H.metadata).concat(T)),T.length&&aJ(T,U,S),H.metadata.seq=Y,delete H.metadata.rev;var V=D?"UPDATE "+cN+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+jT+" WHERE doc_id="+cN+".id AND rev=?) WHERE id=?":"INSERT INTO "+cN+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",W=cO(H.metadata),X=D?[W,Y,P,U]:[U,Y,Y,W];S.executeSql(V,X,function(){r[R]={ok:!0,id:H.metadata.id,rev:P},A.set(U,H.metadata),O()})}var E=null,N=0;H.data._id=H.metadata.id,H.data._rev=H.metadata.rev;var L=Object.keys(H.data._attachments||{});F&&(H.data._deleted=!0),L.forEach(function(U){var S=H.data._attachments[U];if(S.stub){N++,G()}else{var T=S.data;delete S.data,S.revpos=parseInt(P,10);var V=S.digest;u(V,T,Q)}}),L.length||J()}function l(){aO(h.revs_limit,o,m,A,p,r,z,g)}function i(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&cd(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+cN+" WHERE id = ?",[H],function(K,J){if(J.rows.length){var I=jV(J.rows.item(0).json);A.set(H,I)}D()})})}function u(F,D,G){var E="SELECT digest FROM "+aq+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+aq+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,b5(D)],function(){G()},function(){return G(),!1}))})}var C=g.new_edits,v=s.docs,o=v.map(function(E){if(E._id&&cd(E._id)){return E}var D=aQ(E,C);return D}),y=o.filter(function(D){return D.error});if(y.length){return q(y[0])}var p,w,r=new Array(o.length),A=new bb.Map;jM(o,"binary",function(D){return D?q(D):void n.transaction(function(E){p=E,x(function(F){F?w=F:i(l)})},cB(q),k)})}function dM(g){return g.websql(g.name,g.version,g.description,g.size)}function a9(h){try{return{db:dM(h)}}catch(g){return{error:g}}}function cK(h){var g=j6.get(h.name);return g||(g=a9(h),j6.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function dL(l,g,j,h,k){function m(){++o===i.length&&k&&k()}function n(q,s){var r=q._attachments[s],p={binary:g.binary,ctx:h};j._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=eD.extend(e4(r,["digest","content_type"]),{data:v}),m()})}var i=Object.keys(l._attachments||{});if(!i.length){return k&&k()}var o=0;i.forEach(function(p){g.attachments&&g.include_docs?n(l,p):(l._attachments[p].stub=!0,m())})}function bV(A,n){function s(){dd()&&(window.localStorage["_pouch__websqldb_"+B._name]=!0),n(null,B)}function o(F,E){F.executeSql(kf),F.executeSql("ALTER TABLE "+jT+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(dQ),F.executeSql("ALTER TABLE "+cN+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+cN+" (local, id)");var G="SELECT "+cN+".winningseq AS seq, "+cN+".json AS metadata FROM "+jT+" JOIN "+cN+" ON "+jT+".seq = "+cN+".winningseq";F.executeSql(G,[],function(O,K){for(var N=[],I=[],J=0;J<K.rows.length;J++){var L=K.rows.item(J),M=L.seq,H=JSON.parse(L.metadata);dH(H)&&N.push(M),cd(H.id)&&I.push(H.id)}O.executeSql("UPDATE "+cN+"SET local = 1 WHERE id IN "+dl(I.length),I,function(){O.executeSql("UPDATE "+jT+" SET deleted = 1 WHERE seq IN "+dl(N.length),N,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+jL+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+cN+".id AS id, "+jT+".json AS data FROM "+jT+" JOIN "+cN+" ON "+jT+".seq = "+cN+".winningseq WHERE local = 1";F.executeSql(H,[],function(M,J){function L(){if(!I.length){return E(M)}var O=I.shift(),N=JSON.parse(O.data)._rev;M.executeSql("INSERT INTO "+jL+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+cN+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+jT+" WHERE seq=?",[O.seq],function(){L()})})})}for(var I=[],K=0;K<J.rows.length;K++){I.push(J.rows.item(K))}L()})})}function j(G,E){function H(J){function I(){if(!J.length){return E(G)}var P=J.shift(),N=bh(P.hex,m),K=N.lastIndexOf("::"),O=N.substring(0,K),M=N.substring(K+2),L="UPDATE "+jT+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(L,[O,M,N],function(){I()})}I()}var F="ALTER TABLE "+jT+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+jT+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(bL,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+jT;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function D(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+aq;I.executeSql(J,[],function(O,K){function N(){var Q=cy(bx+", "+cN+".id AS id",[cN,jT],ax,null,cN+".id ");Q+=" LIMIT "+L+" OFFSET "+M,M+=L,O.executeSql(Q,[],function(ai,R){function V(at,ar){var ao=T[at]=T[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!R.rows.length){return E(ai)}for(var T={},X=0;X<R.rows.length;X++){for(var an=R.rows.item(X),Z=aV(an.data,an.id,an.rev),U=Object.keys(Z._attachments||{}),W=0;W<U.length;W++){var S=Z._attachments[U[W]];V(S.digest,an.seq)}}var ae=[];if(Object.keys(T).forEach(function(ar){var ao=T[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return N()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+cv+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&N()})})})}var P=K.rows.item(0).cnt;if(!P){return E(O)}var M=0,L=10;N()})}var F="CREATE TABLE IF NOT EXISTS "+cv+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(ab,[],function(J){J.executeSql(az,[],H)})})}function w(F,E){var G="ALTER TABLE "+aq+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function v(F,E){var G="ALTER TABLE "+cN+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+cN+" SET max_seq=(SELECT MAX(seq) FROM "+jT+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+cN+" (max_seq)";J.executeSql(K,[],E)})})}function y(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;m=2===H.length?"UTF-8":"UTF-16",E()})}function C(){for(;u.length>0;){var E=u.pop();E(null,g)}}function x(O,K){if(0===K){var H="CREATE TABLE IF NOT EXISTS "+el+" (dbid, db_version INTEGER)",E="CREATE TABLE IF NOT EXISTS "+aq+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",N="CREATE TABLE IF NOT EXISTS "+cv+" (digest, seq INTEGER)",L="CREATE TABLE IF NOT EXISTS "+cN+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",M="CREATE TABLE IF NOT EXISTS "+jT+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",G="CREATE TABLE IF NOT EXISTS "+jL+" (id UNIQUE, rev, json)";O.executeSql(E),O.executeSql(G),O.executeSql(N,[],function(){O.executeSql(az),O.executeSql(ab)}),O.executeSql(L,[],function(){O.executeSql(kf),O.executeSql(M,[],function(){O.executeSql(dQ),O.executeSql(bL),O.executeSql(H,[],function(){var R="INSERT INTO "+el+" (db_version, dbid) VALUES (?,?)";g=eY();var Q=[bX,g];O.executeSql(R,Q,function(){C()})})})})}else{var I=function(){var Q=bX>K;Q&&O.executeSql("UPDATE "+el+" SET db_version = "+bX);var R="SELECT dbid FROM "+el;O.executeSql(R,[],function(T,S){g=S.rows.item(0).dbid,C()})},F=[o,p,j,D,w,v,I],P=K,J=function(Q){F[P-1](Q,J),P++};J(O)}}function h(){l.transaction(function(E){y(E,function(){r(E)})},cB(n),s)}function r(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+el;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+el,[],function(K,J){var I=J.rows.item(0).db_version;x(K,I)}):H.executeSql("ALTER TABLE "+el+" ADD COLUMN db_version INTEGER",[],function(){x(H,1)}):x(H,0)})}function k(F,E){if(-1!==B._docCount){return E(B._docCount)}var G=cy("COUNT("+cN+".id) AS 'num'",[cN,jT],ax,jT+".deleted=0");F.executeSql(G,[],function(I,H){B._docCount=H.rows.item(0).num,E(B._docCount)})}var m,B=this,g=null,q=c5(A),u=[];B._docCount=-1,B._name=A.name;var z=eD.extend({},A,{version:f2,description:A.name,size:q}),i=cK(z);if(i.error){return cB(n)(i.error)}var l=i.db;"function"!=typeof l.readTransaction&&(l.readTransaction=l.transaction),h(),B.type=function(){return"websql"},B._id=dy(function(E){E(null,g)}),B._info=function(E){l.readTransaction(function(F){k(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+jT;F.executeSql(G,[],function(J,K){var I=K.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:I,sqlite_plugin:l._sqlitePlugin,websql_encoding:m})})})},cB(E))},B._bulkDocs=function(E,G,F){bY(A,E,G,B,l,cW,F)},B._get=function(L,M,J){function G(){J(E,{doc:H,metadata:K,ctx:I})}var H,K,E,I=M.ctx;if(!I){return l.readTransaction(function(O){B._get(L,eD.extend({ctx:O},M),J)})}var F,N;M.rev?(F=cy(bx,[cN,jT],cN+".id="+jT+".doc_id",[jT+".doc_id=?",jT+".rev=?"]),N=[L,M.rev]):(F=cy(bx,[cN,jT],ax,cN+".id=?"),N=[L]),I.executeSql(F,N,function(O,P){if(!P.rows.length){return E=av(eW,"missing"),G()}var Q=P.rows.item(0);return K=jV(Q.metadata),Q.deleted&&!M.rev?(E=av(eW,"deleted"),G()):(H=aV(Q.data,K.id,Q.rev),void G())})},B._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(cN+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(cN+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(cN+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(cN+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(jT+".deleted = 0"),l.readTransaction(function(S){k(S,function(U){if(P=U,0!==N){var T=cy(bx,[cN,jT],ax,J,cN+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(ar,X){for(var W=0,ai=X.rows.length;ai>W;W++){var ao=X.rows.item(W),V=jV(ao.metadata),Z=V.id,an=aV(ao.data,Z,ao.rev),Y=an._rev,ae={id:Z,key:Z,value:{rev:Y}};if(E.include_docs&&(ae.doc=an,ae.doc._rev=Y,E.conflicts&&(ae.doc._conflicts=e5(V)),dL(ae.doc,E,B,ar)),ao.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},cB(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},B._changes=function(K){function L(){var S=cN+".json AS metadata, "+cN+".max_seq AS maxSeq, "+jT+".json AS winningDoc, "+jT+".rev AS winningRev ",T=cN+" JOIN "+jT,R=cN+".id="+jT+".doc_id AND "+cN+".winningseq="+jT+".seq",Q=["maxSeq > ?"],O=[K.since];K.doc_ids&&(Q.push(cN+".id IN "+dl(K.doc_ids.length)),O=O.concat(K.doc_ids));var U="maxSeq "+(H?"DESC":"ASC"),N=cy(S,T,R,Q,U),M=bq(K);K.view||K.filter||(N+=" LIMIT "+E);var P=K.since||0;l.readTransaction(function(V){V.executeSql(N,O,function(Y,Z){function X(a0){return function(){K.onChange(a0)}}for(var ao=0,an=Z.rows.length;an>ao;ao++){var ai=Z.rows.item(ao),W=jV(ai.metadata);P=ai.maxSeq;var ae=aV(ai.winningDoc,W.id,ai.winningRev),at=K.processChange(ae,W,K);at.seq=ai.maxSeq;var ar=M(at);if("object"==typeof ar){return K.complete(ar)}if(ar&&(G++,J&&I.push(at),K.attachments&&K.include_docs?dL(ae,K,B,Y,X(at)):X(at)()),G===E){break}}})},cB(K.complete),function(){K.continuous||K.complete(null,{results:I,last_seq:P})})}if(K=eO(K),K.continuous){var F=B._name+":"+eY();return cW.addListener(B._name,F,B,K),cW.notify(B._name),{cancel:function(){cW.removeListener(B._name,F)}}}var H=K.descending;K.since=K.since&&!H?K.since:0;var E="limit" in K?K.limit:-1;0===E&&(E=1);var J;J="return_docs" in K?K.return_docs:"returnDocs" in K?K.returnDocs:!0;var I=[],G=0;L()},B._close=function(E){E()},B._getAttachment=function(L,M,J,G,H){var K,E=G.ctx,I=J.digest,F=J.content_type,N="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+aq+" WHERE digest=?";E.executeSql(N,[I],function(P,O){var Q=O.rows.item(0),R=Q.escaped?cH(Q.body):bh(Q.body,m);K=G.binary?fK(R,F):cD(R),H(null,K)})},B._getRevisionTree=function(F,E){l.readTransaction(function(H){var G="SELECT json AS metadata FROM "+cN+" WHERE id = ?";H.executeSql(G,[F],function(K,I){if(I.rows.length){var J=jV(I.rows.item(0).metadata);E(null,J.rev_tree)}else{E(av(eW))}})})},B._doCompaction=function(F,E,G){return E.length?void l.transaction(function(H){var I="SELECT json AS metadata FROM "+cN+" WHERE id = ?";H.executeSql(I,[F],function(J,L){var M=jV(L.rows.item(0).metadata);ds(M.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var K="UPDATE "+cN+" SET json = ? WHERE id = ?";J.executeSql(K,[cO(M),F])}),aJ(E,F,H)},cB(G),function(){G()}):G()},B._getLocal=function(F,E){l.readTransaction(function(H){var G="SELECT json, rev FROM "+jL+" WHERE id=?";H.executeSql(G,[F],function(J,L){if(L.rows.length){var I=L.rows.item(0),K=aV(I.json,F,I.rev);E(null,K)}else{E(av(eW))}})})},B._putLocal=function(H,L,F){function M(N){var P,O;G?(P="UPDATE "+jL+" SET rev=?, json=? WHERE id=? AND rev=?",O=[E,K,J,G]):(P="INSERT INTO "+jL+" (id, rev, json) VALUES (?,?,?)",O=[J,E,K]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(I={ok:!0,id:J,rev:E},L.ctx&&F(null,I)):F(av(cf))},function(){return F(av(cf)),!1})}"function"==typeof L&&(F=L,L={}),delete H._revisions;var E,G=H._rev,J=H._id;E=G?H._rev="0-"+(parseInt(G.split("-")[1],10)+1):H._rev="0-1";var I,K=aH(H);L.ctx?M(L.ctx):l.transaction(M,cB(F),function(){I&&F(null,I)})},B._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+jL+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(av(eW))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):l.transaction(G,cB(E),function(){I&&E(null,I)})},B._destroy=function(F,E){cW.removeAllListeners(B._name),l.transaction(function(H){var G=[cN,jT,aq,el,jL,cv];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},cB(E),function(){dd()&&(delete window.localStorage["_pouch__websqldb_"+B._name],delete window.localStorage[B._name]),E(null,{ok:!0})})}}function aj(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cj(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var i=dd(),h="_pouch__websqldb_valid_"+navigator.userAgent;if(i&&localStorage[h]){return"1"===localStorage[h]}var g=aj();return i&&(localStorage[h]=g?"1":"0"),g}function eI(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cj()}function bi(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=eD.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function dT(g,i){var h=bi(g),j=eD.extend({websql:h},g);bV.call(this,j,i)}function kk(g){g.adapter("websql",dT,!0)}function aY(){for(var g={},i=new bz(function(k,l){g.resolve=k,g.reject=l}),h=new Array(arguments.length),j=0;j<h.length;j++){h[j]=arguments[j]}return g.promise=i,bz.resolve().then(function(){return fetch.apply(null,h)}).then(function(k){g.resolve(k)})["catch"](function(k){g.reject(k)}),g}function jZ(k,i){var g,j,l,m=new Headers,h={method:k.method,credentials:"include",headers:m};return k.json&&(m.set("Accept","application/json"),m.set("Content-Type",k.headers["Content-Type"]||"application/json")),k.body&&k.body instanceof Blob?fE(k.body,function(n){h.body=n}):k.body&&k.processData&&"string"!=typeof k.body?h.body=JSON.stringify(k.body):"body" in k?h.body=k.body:h.body=null,Object.keys(k.headers).forEach(function(n){k.headers.hasOwnProperty(n)&&m.set(n,k.headers[n])}),g=aY(k.url,h),k.timeout>0&&(j=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+k.url))},k.timeout)),g.promise.then(function(n){return l={statusCode:n.status},k.timeout>0&&clearTimeout(j),l.statusCode>=200&&l.statusCode<300?k.binary?n.blob():n.text():n.json()}).then(function(n){l.statusCode>=200&&l.statusCode<300?i(null,l,n):i(n,l)})["catch"](function(n){i(n,l)}),{abort:g.reject}}function dh(l,g){var j,h,k=!1,m=function(){j.abort()},n=function(){k=!0,j.abort()};j=l.xhr?new l.xhr:new XMLHttpRequest;try{j.open(l.method,l.url)}catch(i){g(i,{statusCode:413})}j.withCredentials="withCredentials" in l?l.withCredentials:!0,"GET"===l.method?delete l.headers["Content-Type"]:l.json&&(l.headers.Accept="application/json",l.headers["Content-Type"]=l.headers["Content-Type"]||"application/json",l.body&&l.processData&&"string"!=typeof l.body&&(l.body=JSON.stringify(l.body))),l.binary&&(j.responseType="arraybuffer"),"body" in l||(l.body=null);for(var o in l.headers){l.headers.hasOwnProperty(o)&&j.setRequestHeader(o,l.headers[o])}return l.timeout>0&&(h=setTimeout(n,l.timeout),j.onprogress=function(){clearTimeout(h),4!==j.readyState&&(h=setTimeout(n,l.timeout))},"undefined"!=typeof j.upload&&(j.upload.onprogress=j.onprogress)),j.onreadystatechange=function(){if(4===j.readyState){var s={statusCode:j.status};if(j.status>=200&&j.status<300){var q;q=l.binary?fJ([j.response||""],{type:j.getResponseHeader("Content-Type")}):j.responseText,g(null,s,q)}else{var p={};if(k){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(j.response)}catch(r){}}g(p,s)}}},l.body&&l.body instanceof Blob?fE(l.body,function(p){j.send(p)}):j.send(l.body),{abort:m}}function ad(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function f0(h,g){return aF||h.xhr?dh(h,g):jZ(h,g)}function jF(){return""}function cV(h,k){function j(n,m,o){if(!h.binary&&h.json&&"string"==typeof n){try{n=JSON.parse(n)}catch(l){return o(l)}}Array.isArray(n)&&(n=n.map(function(p){return p.error||p.missing?c1(p):p})),h.binary&&dx(n,m),o(null,n,m)}function g(m,q){var o,l;if(m.code&&m.status){var n=new Error(m.message||m.code);return n.status=m.status,q(n)}if(m.message&&"ETIMEDOUT"===m.message){return q(m)}try{o=JSON.parse(m.responseText),l=c1(o)}catch(p){l=c1(m)}q(l)}h=eO(h);var i={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return h=eD.extend(i,h),h.json&&(h.binary||(h.headers.Accept="application/json"),h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json"),h.binary&&(h.encoding=null,h.json=!1),h.processData||(h.json=!1),f0(h,function(p,m,r){if(p){return p.status=m?m.statusCode:400,g(p,k)}var n,l=m.headers&&m.headers["content-type"],q=r||jF();if(!h.binary&&(h.json||!h.processData)&&"object"!=typeof q&&(/json/.test(l)||/^[\s]*\{/.test(q)&&/\}[\s]*$/.test(q))){try{q=JSON.parse(q.toString())}catch(o){}}m.statusCode>=200&&m.statusCode<300?j(q,m,k):(n=c1(q),n.status=m.statusCode,k(n))})}function dD(g,i){var m=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",k=-1!==m.indexOf("safari")&&-1===m.indexOf("chrome"),l=-1!==m.indexOf("msie"),o=-1!==m.indexOf("edge"),h=k||(l||o)&&"GET"===g.method,j="cache" in g?g.cache:!0,p=/^blob:/.test(g.url);if(!p&&(h||!j)){var n=-1!==g.url.indexOf("?");g.url+=(n?"&":"?")+"_nonce="+Date.now()}return cV(g,i)}function eL(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=e0(j.data,j.content_type)})}function eS(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function jJ(g){return g._attachments&&Object.keys(g._attachments)?bz.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new bz(function(j){aE(i.data,j)}).then(function(j){i.data=j}):void 0})):bz.resolve()}function dA(i){var h=db(i);(h.user||h.password)&&(h.auth={username:h.user,password:h.password});var g=h.path.replace(/(^\/|\/$)/g,"").split("/");return h.db=g.pop(),-1===h.db.indexOf("%")&&(h.db=encodeURIComponent(h.db)),h.path=g.join("/"),h}function dI(h,g){return f8(h,h.db+"/"+g)}function f8(i,h){var g=i.path?"/":"";return i.protocol+"://"+i.host+(i.port?":"+i.port:"")+"/"+i.path+g+h}function cq(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function eb(o,u){function w(A,y,B){var z=A.ajax||{},x=eD.extend(eO(q),z,y);return cg(x.method+" "+x.url),k._ajax(x,B)}function p(x,y){return new bz(function(z,A){w(x,y,function(C,B){return C?A(C):void z(B)})})}function j(x,y){return eC(x,cJ(function(z){v().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(o.skipSetup||o.skip_setup){return bz.resolve()}if(h){return h}var x={method:"GET",url:s};return h=p({},x)["catch"](function(y){return y&&y.status&&404===y.status?(dX(404,"PouchDB is just detecting if the remote exists."),p({},{method:"PUT",url:s})):bz.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:bz.reject(y)}),h["catch"](function(){h=null}),h}function g(x){return x.split("/").map(encodeURIComponent).join("/")}var k=this,r=dA;o.getHost&&(r=o.getHost);var i=r(o.name,o),s=dI(i,"");o=eO(o);var q=o.ajax||{};if(k.getUrl=function(){return s},k.getHeaders=function(){return q.headers||{}},o.auth||i.auth){var n=o.auth||i.auth,m=n.username+":"+n.password,l=cD(unescape(encodeURIComponent(m)));q.headers=q.headers||{},q.headers.Authorization="Basic "+l}k._ajax=dD;var h;setTimeout(function(){u(null,k)}),k.type=function(){return"http"},k.id=j("id",function(x){w({},{method:"GET",url:f8(i,"")},function(y,A){var z=A&&A.uuid?A.uuid+i.db:dI(i,"");x(null,z)})}),k.request=j("request",function(x,y){x.url=dI(i,x.url),w({},x,y)}),k.compact=j("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=eO(x),w(x,{url:dI(i,"_compact"),method:"POST"},function(){function z(){k.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),k.bulkGet=eC("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),w({},{url:dI(i,"_bulk_get"+cq(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function H(L){return function(M,N){K[L]=N.results,++I===F&&C(null,{results:j8(K)})}}for(var E=jK,F=Math.ceil(y.docs.length/E),I=0,K=new Array(F),J=0;F>J;J++){var G=e4(y,["revs","attachments"]);G.ajax=q,G.docs=y.docs.slice(J*E,Math.min(y.docs.length,(J+1)*E)),eB(z,G,H(J))}}var z=this,D=f8(i,""),x=aN[D];"boolean"!=typeof x?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(aN[D]=!1,dX(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{aN[D]=!0,C(null,F)}}):x?A(C):B()}),k._info=function(x){v().then(function(){w({},{method:"GET",url:dI(i,"")},function(y,z){return y?x(y):(z.host=dI(i,""),void x(null,z))})})["catch"](x)},k.get=j("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?bz.all(E.map(function(I){var J=G[I],H=eS(F._id)+"/"+g(I)+"?rev="+F._rev;return p(y,{method:"GET",url:dI(i,H),binary:!0}).then(function(K){return y.binary?K:new bz(function(L){aE(K,L)})}).then(function(K){delete J.stub,delete J.length,J.data=K})})):void 0}function z(E){return Array.isArray(E)?bz.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=eO(y);var x={};y.revs&&(x.revs=!0),y.revs_info&&(x.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),x.open_revs=y.open_revs),y.rev&&(x.rev=y.rev),y.conflicts&&(x.conflicts=y.conflicts),C=eS(C);var D={method:"GET",url:dI(i,C+cq(x))};p(y,D).then(function(E){return bz.resolve().then(function(){return y.attachments?z(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),k.remove=j("remove",function(B,z,x,C){var y;"string"==typeof z?(y={_id:B,_rev:z},"function"==typeof x&&(C=x,x={})):(y=B,"function"==typeof z?(C=z,x={}):(C=x,x=z));var A=y._rev||x.rev;w(x,{method:"DELETE",url:dI(i,eS(y._id))+"?rev="+A},C)}),k.getAttachment=j("getAttachment",function(B,x,z,y){"function"==typeof z&&(y=z,z={});var A=z.rev?"?rev="+z.rev:"",C=dI(i,eS(B))+"/"+g(x)+A;w(z,{method:"GET",url:C,binary:!0},y)}),k.removeAttachment=j("removeAttachment",function(A,y,z,B){var x=dI(i,eS(A)+"/"+g(y))+"?rev="+z;w({},{method:"DELETE",url:x},B)}),k.putAttachment=j("putAttachment",function(A,E,G,H,y,F){"function"==typeof y&&(F=y,y=H,H=G,G=null);var D=eS(A)+"/"+g(E),C=dI(i,D);if(G&&(C+="?rev="+G),"string"==typeof H){var x;try{x=jR(H)}catch(B){return F(av(e6,"Attachment is not a valid base64 string"))}H=x?fK(x,y):""}var z={headers:{"Content-Type":y},method:"PUT",url:C,processData:!1,body:H,timeout:q.timeout||60000};w({},z,F)}),k._bulkDocs=function(z,x,y){z.new_edits=x.new_edits,v().then(function(){return bz.all(z.docs.map(jJ))}).then(function(){w(x,{method:"POST",url:dI(i,"_bulk_docs"),body:z},function(B,A){return B?y(B):(A.forEach(function(C){C.ok=!0}),void y(null,A))})})["catch"](y)},k.allDocs=j("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=eO(C);var A,B={},z="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var D=cq(B);if("undefined"!=typeof C.keys){var x="keys="+encodeURIComponent(JSON.stringify(C.keys));x.length+D.length+1<=b7?D+="&"+x:(z="POST",A={keys:C.keys})}p(C,{method:z,url:dI(i,"_all_docs"+D),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eL),y(null,E)})["catch"](y)}),k._changes=function(B){var J="batch_size" in B?B.batch_size:c7;B=eO(B),B.timeout="timeout" in B?B.timeout:"timeout" in q?q.timeout:30000;var H,A=B.timeout?{timeout:B.timeout-5000}:{},D="undefined"!=typeof B.limit?B.limit:!1;H="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var L=D;if(B.style&&(A.style=B.style),(B.include_docs||B.filter&&"function"==typeof B.filter)&&(A.include_docs=!0),B.attachments&&(A.attachments=!0),B.continuous&&(A.feed="longpoll"),B.conflicts&&(A.conflicts=!0),B.descending&&(A.descending=!0),"heartbeat" in B?B.heartbeat&&(A.heartbeat=B.heartbeat):A.heartbeat=10000,B.filter&&"string"==typeof B.filter&&(A.filter=B.filter),B.view&&"string"==typeof B.view&&(A.filter="_view",A.view=B.view),B.query_params&&"object"==typeof B.query_params){for(var F in B.query_params){B.query_params.hasOwnProperty(F)&&(A[F]=B.query_params[F])}}var y,x="GET";if(B.doc_ids){A.filter="_doc_ids";var I=JSON.stringify(B.doc_ids);I.length<b7?A.doc_ids=I:(x="POST",y={doc_ids:B.doc_ids})}var G,E,C=function(N,M){if(!B.aborted){A.since=N,"object"==typeof A.since&&(A.since=JSON.stringify(A.since)),B.descending?D&&(A.limit=L):A.limit=!D||L>J?J:L;var O={method:x,url:dI(i,"_changes"+cq(A)),timeout:B.timeout,body:y};E=N,B.aborted||v().then(function(){G=w(B,O,M)})["catch"](M)}},z={results:[]},K=function(O,Q){if(!B.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,z.last_seq=Q.last_seq;var M={};M.query=B.query_params,Q.results=Q.results.filter(function(R){L--;var S=bq(B)(R);return S&&(B.include_docs&&B.attachments&&B.binary&&eL(R),H&&z.results.push(R),B.onChange(R)),S})}else{if(O){return B.aborted=!0,void B.complete(O)}}Q&&Q.last_seq&&(E=Q.last_seq);var N=D&&0>=L||Q&&J>P||B.descending;(!B.continuous||D&&0>=L)&&N?B.complete(null,z):setTimeout(function(){C(E,K)},0)}};return C(B.since||0,K),{cancel:function(){B.aborted=!0,G&&G.abort()}}},k.revsDiff=j("revsDiff",function(z,x,y){"function"==typeof x&&(y=x,x={}),w(x,{method:"POST",url:dI(i,"_revs_diff"),body:z},y)}),k._close=function(x){x()},k._destroy=function(x,y){w(x,{url:dI(i,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function fN(g){g.adapter("http",eb,!1),g.adapter("https",eb,!1)}function jP(){this.promise=new bz(function(g){g()})}function ep(l){var n=l.db,i=l.viewName,g=l.map,h=l.reduce,m=l.temporary,k=g.toString()+(h&&h.toString())+"undefined";if(!m&&n._cachedViews){var j=n._cachedViews[k];if(j){return bz.resolve(j)}}return n.info().then(function(p){function o(u){u.views=u.views||{};var r=i;-1===r.indexOf("/")&&(r=i+"/"+i);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(m?"temp":c9(k));return dj(n,"_local/mrviews",o).then(function(){return n.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:n,adapter:n.adapter,mapFun:g,reduceFun:h};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,m||(n._cachedViews=n._cachedViews||{},n._cachedViews[k]=r,r.db.once("destroyed",function(){delete n._cachedViews[k]})),r})})})})}function eV(i,l,k,h,j,g){return c8("return ("+i.replace(/;\s*$/,"")+");",{emit:l,sum:k,log:h,isArray:j,toJSON:g})}function j3(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function bU(g){return 1===g.length&&/^1-/.test(g[0].rev)}function dR(i,h){try{i.emit("error",h)}catch(g){bS("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),bS("error",h)}}function cF(g,i,h){try{return{output:i.apply(null,h)}}catch(j){return dR(g,j),{error:j}}}function kb(i,h){var g=by.collate(i.key,h.key);return 0!==g?g:by.collate(i.value,h.value)}function km(i,h,g){return g=g||0,"number"==typeof h?i.slice(g,h+g):g>0?i.slice(g):i}function cb(i){var h=i.value,g=h&&"object"==typeof h&&h._id||i.id;return g}function f6(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=e0(k.data,k.content_type)})})}function kj(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&f6(h),h}}function fQ(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new ac(g)}function ef(l){for(var n=0,i=0,g=l.length;g>i;i++){var h=l[i];if("number"!=typeof h){if(!Array.isArray(h)){throw fQ("_sum")}n="number"==typeof n?[n]:n;for(var m=0,k=h.length;k>m;m++){var j=h[m];if("number"!=typeof j){throw fQ("_sum")}"undefined"==typeof n[m]?n.push(j):n[m]+=j}}else{"number"==typeof n?n+=h:n[0]+=h}}return n}function f9(h,k,j,g){var i=k[h];"undefined"!=typeof i&&(g&&(i=encodeURIComponent(JSON.stringify(i))),j.push(h+"="+i))}function jU(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function cl(g){return g.group_level=jU(g.group_level),g.limit=jU(g.limit),g.skip=jU(g.skip),g}function jI(g){if(g){if("number"!=typeof g){return new eT('Invalid value for integer: "'+g+'"')}if(0>g){return new eT('Invalid value for positive integer: "'+g+'"')}}}function eF(g,i){var h=g.descending?"endkey":"startkey",j=g.descending?"startkey":"endkey";if("undefined"!=typeof g[h]&&"undefined"!=typeof g[j]&&by.collate(g[h],g[j])>0){throw new eT("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(i.reduce&&g.reduce!==!1){if(g.include_docs){throw new eT("{include_docs:true} is invalid for reduce")}if(g.keys&&g.keys.length>1&&!g.group&&!g.group_level){throw new eT("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=jI(g[k]);if(l){throw l}})}function e2(l,g,j){var h,k=[],m="GET";if(f9("reduce",j,k),f9("include_docs",j,k),f9("attachments",j,k),f9("limit",j,k),f9("descending",j,k),f9("group",j,k),f9("group_level",j,k),f9("skip",j,k),f9("stale",j,k),f9("conflicts",j,k),f9("startkey",j,k,!0),f9("start_key",j,k,!0),f9("endkey",j,k,!0),f9("end_key",j,k,!0),f9("inclusive_end",j,k),f9("key",j,k,!0),k=k.join("&"),k=""===k?"":"?"+k,"undefined"!=typeof j.keys){var n=2000,i="keys="+encodeURIComponent(JSON.stringify(j.keys));i.length+k.length+1<=n?k+=("?"===k[0]?"&":"?")+i:(m="POST","string"==typeof g?h={keys:j.keys}:g.keys=j.keys)}if("string"==typeof g){var o=j3(g);return l.request({method:m,url:"_design/"+o[0]+"/_view/"+o[1]+k,body:h}).then(kj(j))}return h=h||{},Object.keys(g).forEach(function(p){Array.isArray(g[p])?h[p]=g[p]:h[p]=g[p].toString()}),l.request({method:"POST",url:"_temp_view"+k,body:h}).then(kj(j))}function jO(i,h,g){return new bz(function(j,k){i._query(h,g,function(m,l){return m?k(m):void j(l)})})}function kg(g){return new bz(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function bO(g){return function(h){if(404===h.status){return g}throw h}}function em(k,p,j){function h(){return bU(q)?bz.resolve(n):p.db.get(l)["catch"](bO(n))}function g(r){return r.keys.length?p.db.allDocs({keys:r.keys,include_docs:!0}):bz.resolve({rows:[]})}function i(x,y){for(var s=[],A={},r=0,v=y.rows.length;v>r;r++){var w=y.rows[r],B=w.doc;if(B&&(s.push(B),A[B._id]=!0,B._deleted=!o[B._id],!B._deleted)){var z=o[B._id];"value" in z&&(B.value=z.value)}}var u=Object.keys(o);return u.forEach(function(C){if(!A[C]){var E={_id:C},D=o[C];"value" in D&&(E.value=D.value),s.push(E)}}),x.keys=b3(u.concat(x.keys)),s.push(x),s}var l="_local/doc_"+k,n={_id:l,keys:[]},m=j[k],o=m.indexableKeysToKeyValues,q=m.changes;return h().then(function(r){return g(r).then(function(s){return i(r,s)})})}function ah(g,i,h){var j="_local/lastSeq";return g.db.get(j)["catch"](bO({_id:j,seq:0})).then(function(k){var l=Object.keys(i);return bz.all(l.map(function(m){return em(m,g,i)})).then(function(m){var n=j8(m);return k.seq=h,n.push(k),g.db.bulkDocs({docs:n})})})}function eN(i){var h="string"==typeof i?i:i.name,g=dB[h];return g||(g=dB[h]=new jP),g}function bv(g){return b0(eN(g),function(){return eJ(g)})()}function eJ(l){function g(p,r){var q={id:k._id,key:by.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=by.normalizeKey(r)),h.push(q)}function j(q,p){return function(){return ah(l,q,p)}}var h,k,m;if("function"==typeof l.mapFun&&2===l.mapFun.length){var n=l.mapFun;m=function(p){return n(p,g)}}else{m=eV(l.mapFun.toString(),g,ef,ak,Array.isArray,JSON.parse)}var i=l.seq||0,o=new jP;return new bz(function(p,s){function r(){o.finish().then(function(){l.seq=i,p()})}function q(){function u(v){s(v)}l.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:i,limit:fA}).on("complete",function(C){var x=C.results;if(!x.length){return r()}for(var D={},v=0,F=x.length;F>v;v++){var A=x[v];if("_"!==A.doc._id[0]){h=[],k=A.doc,k._deleted||cF(l.sourceDB,m,[k]),h.sort(kb);for(var z,H={},y=0,E=h.length;E>y;y++){var G=h[y],w=[G.key,G.id];0===by.collate(G.key,z)&&w.push(y);var B=by.toIndexableString(w);H[B]=G,z=G.key}D[A.doc._id]={indexableKeysToKeyValues:H,changes:A.changes}}i=A.seq}return o.add(j(D,i)),x.length<fA?r():q()}).on("error",u)}q()})}function eq(k,p,j){0===j.group_level&&delete j.group_level;var h,g=j.group||j.group_level;h=jS[k.reduceFun]?jS[k.reduceFun]:eV(k.reduceFun.toString(),null,ef,ak,Array.isArray,JSON.parse);var i=[],l=isNaN(j.group_level)?Number.POSITIVE_INFINITY:j.group_level;p.forEach(function(r){var u=i[i.length-1],s=g?r.key:null;return g&&Array.isArray(s)&&(s=s.slice(0,l)),u&&0===by.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void i.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),p=[];for(var n=0,m=i.length;m>n;n++){var o=i[n],q=cF(k.sourceDB,h,[o.keys,o.values,!1]);if(q.error&&q.error instanceof ac){throw q.error}p.push({value:q.error?null:q.output,key:o.groupKey})}return{rows:km(p,j.limit,j.skip)}}function cc(h,g){return b0(eN(h),function(){return dU(h,g)})()}function dU(r,s){function i(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return h=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=by.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function g(v){var u;if(u=k?eq(r,v,s):{total_rows:h,offset:p,rows:v},s.include_docs){var w=b3(v.map(cb));return r.sourceDB.allDocs({keys:w,include_docs:!0,conflicts:s.conflicts,attachments:s.attachments,binary:s.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),v.forEach(function(A){var B=cb(A),z=y["$"+B];z&&(A.doc=z)}),u})}return u}var h,k=r.reduceFun&&s.reduce!==!1,p=s.skip||0;if("undefined"==typeof s.keys||s.keys.length||(s.limit=0,delete s.keys),"undefined"!=typeof s.keys){var l=s.keys,q=l.map(function(v){var u={startkey:by.toIndexableString([v]),endkey:by.toIndexableString([v,{}])};return i(u)});return bz.all(q).then(j8).then(g)}var o={descending:s.descending};if(s.start_key&&(s.startkey=s.start_key),s.end_key&&(s.endkey=s.end_key),"undefined"!=typeof s.startkey&&(o.startkey=s.descending?by.toIndexableString([s.startkey,{}]):by.toIndexableString([s.startkey])),"undefined"!=typeof s.endkey){var m=s.inclusive_end!==!1;s.descending&&(m=!m),o.endkey=by.toIndexableString(m?[s.endkey,{}]:[s.endkey])}if("undefined"!=typeof s.key){var j=by.toIndexableString([s.key]),n=by.toIndexableString([s.key,{}]);o.descending?(o.endkey=j,o.startkey=n):(o.startkey=j,o.endkey=n)}return k||("number"==typeof s.limit&&(o.limit=s.limit),o.skip=p),i(o).then(g)}function fL(g){return g.request({method:"POST",url:"_view_cleanup"})}function cx(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(k){var m=j3(k),n="_design/"+m[0],l=m[1];j[n]=j[n]||{},j[n][l]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(k){var l={};k.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){l[v]=l[v]||s})})});var n=Object.keys(l).filter(function(o){return !l[o]}),m=n.map(function(o){return b0(eN(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return bz.all(m).then(function(){return{ok:!0}})})},bO({ok:!0}))}function kh(h,j,l){if("http"===h.type()){return e2(h,j,l)}if("function"==typeof h._query){return jO(h,j,l)}if("string"!=typeof j){eF(l,j);var i={db:h,viewName:"temp_view/temp_view",map:j.map,reduce:j.reduce,temporary:!0};return bN.add(function(){return ep(i).then(function(o){function p(){return o.db.destroy()}return bD(bv(o).then(function(){return cc(o,l)}),p)})}),bN.finish()}var n=j,k=j3(n),g=k[0],m=k[1];return h.get("_design/"+g).then(function(o){var p=o.views&&o.views[m];if(!p||"string"!=typeof p.map){throw new c0("ddoc "+g+" has no view named "+m)}eF(l,p);var q={db:h,viewName:n,map:p.map,reduce:p.reduce};return ep(q).then(function(r){return"ok"===l.stale||"update_after"===l.stale?("update_after"===l.stale&&dC.nextTick(function(){bv(r)}),cc(r,l)):bv(r).then(function(){return cc(r,l)})})})}function eT(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,eT)}catch(g){}}function c0(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,c0)}catch(g){}}function ac(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,ac)}catch(g){}}function cC(g){return/^1-/.test(g)}function jX(i,h,g){return !i._attachments||!i._attachments[g]||i._attachments[g].digest!==h._attachments[g].digest}function kl(i,h){var g=Object.keys(h._attachments);return bz.all(g.map(function(j){return i.getAttachment(h._id,j,{rev:h._rev})}))}function j2(h,k,j){var g="http"===k.type()&&"http"!==h.type(),i=Object.keys(j._attachments);return g?h.get(j._id).then(function(l){return bz.all(i.map(function(m){return jX(l,j,m)?k.getAttachment(j._id,m):h.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return kl(k,j)}):kl(k,j)}function dq(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function b9(j,n,i,g){function h(){var r=dq(i);if(r.docs.length){return j.bulkGet(r).then(function(s){if(g.cancelled){throw new Error("cancelled")}return bz.all(s.results.map(function(u){return bz.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?j2(n,j,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){o=o.concat(j8(u).filter(Boolean))})})}}function k(r){return r._attachments&&Object.keys(r._attachments).length>0}function l(r){return j.allDocs({keys:r,include_docs:!0}).then(function(s){if(g.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&cC(u.value.rev)&&!k(u.doc)&&(o.push(u.doc),delete i[u.id])})})}function p(){var r=Object.keys(i).filter(function(s){var u=i[s].missing;return 1===u.length&&cC(u[0])});return r.length>0?l(r):void 0}function m(){return{ok:q,docs:o}}i=eO(i);var o=[],q=!0;return bz.resolve().then(p).then(h).then(m)}function j9(h,k,j,g,i){return h.get(k)["catch"](function(l){if(404===l.status){return"http"===h.type()&&dX(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:g,_id:k,history:[],replicator:dK,version:ke}}throw l}).then(function(l){return i.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==g}),l.history.unshift({last_seq:j,session_id:g}),l.history=l.history.slice(0,d9),l.version=ke,l.replicator=dK,l.session_id=g,l.last_seq=j,h.put(l)["catch"](function(m){if(409===m.status){return j9(h,k,j,g,i)}throw m}))})}function fR(g,i,h,j){this.src=g,this.target=i,this.id=h,this.returnValue=j}function aK(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:bQ(h.history,g.history)}function bQ(l,n){var i=l[0],g=l.slice(1),h=n[0],m=n.slice(1);if(!i||0===n.length){return{last_seq:fF,history:[]}}var k=i.session_id;if(da(k,n)){return{last_seq:i.last_seq,history:l}}var j=h.session_id;return da(j,g)?{last_seq:h.last_seq,history:m}:bQ(g,m)}function da(g,i){var h=i[0],j=i.slice(1);return g&&0!==i.length?g===h.session_id?!0:da(g,j):!1}function dm(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function jH(g,i,h,j){return g.retry===!1?(i.emit("error",h),void i.removeAllListeners()):("function"!=typeof g.back_off_function&&(g.back_off_function=dY),i.emit("requestError",h),"active"!==i.state&&"pending"!==i.state||(i.emit("paused",h),i.state="stopped",i.once("active",function(){g.current_back_off=bp})),g.current_back_off=g.current_back_off||bp,g.current_back_off=g.back_off_function(g.current_back_off),void setTimeout(j,g.current_back_off))}function dS(g){return Object.keys(g).sort(by.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function ec(k,i,g){var j=g.doc_ids?g.doc_ids.sort(by.collate):"",l=g.filter?g.filter.toString():"",m="",h="";return g.filter&&g.query_params&&(m=JSON.stringify(dS(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),bz.all([k.id(),i.id()]).then(function(n){var o=n[0]+n[1]+l+h+m+j;return new bz(function(p){dz(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dN(i,r,E,z,D){function K(){return Q?bz.resolve():ec(i,r,E).then(function(T){p=T,Q=new fR(i,r,p,z)})}function y(){if(w=[],0!==g.docs.length){var T=g.docs;return r.bulkDocs({docs:T,new_edits:!1}).then(function(X){if(z.cancelled){throw C(),new Error("cancelled")}var U=[],W={};X.forEach(function(Z){Z.error&&(D.doc_write_failures++,U.push(Z),W[Z.id]=Z)}),h=h.concat(U),D.docs_written+=g.docs.length-U.length;var V=U.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=W[Z._id];ae?z.emit("denied",eO(ae)):w.push(Z)}),V.length>0){var Y=new Error("bulkDocs error");throw Y.other_errors=U,L("target.bulkDocs failed to write docs",Y),new Error("bulkWrite partial failure")}},function(U){throw D.doc_write_failures+=T.length,U})}}function s(){if(g.error){throw new Error("There was a problem getting docs.")}D.last_seq=J=g.seq;var T=eO(D);return w.length&&(T.docs=w,z.emit("change",T)),N=!0,Q.writeCheckpoint(g.seq,j).then(function(){if(N=!1,z.cancelled){throw C(),new Error("cancelled")}g=void 0,G()})["catch"](q)}function l(){var T={};return g.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),r.revsDiff(T).then(function(U){if(z.cancelled){throw C(),new Error("cancelled")}g.diffs=U})}function P(){return b9(i,r,g.diffs,z).then(function(T){g.error=!T.ok,T.docs.forEach(function(U){delete g.diffs[U._id],D.docs_read++,g.docs.push(U)})})}function H(){if(!z.cancelled&&!g){if(0===I.length){return void n(!0)}g=I.shift(),l().then(P).then(y).then(s).then(H)["catch"](function(T){L("batch processing terminated with error",T)})}}function n(T){return 0===B.changes.length?void (0!==I.length||g||((v&&F.live||x)&&(z.state="pending",z.emit("paused")),x&&C())):void ((T||x||B.changes.length>=m)&&(I.push(B),B={seq:0,changes:[],docs:[]},"pending"!==z.state&&"stopped"!==z.state||(z.state="active",z.emit("active")),H()))}function L(U,T){O||(T.message||(T.message=U),D.ok=!1,D.status="aborting",D.errors.push(T),h=h.concat(T),I=[],B={seq:0,changes:[],docs:[]},C())}function C(){if(!(O||z.cancelled&&(D.status="cancelled",N))){D.status=D.status||"complete",D.end_time=new Date,D.last_seq=J,O=!0;var U=h.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=h.pop();h.length>0&&(T.other_errors=h),T.result=D,jH(E,z,T,function(){dN(i,r,E,z)})}else{D.errors=h,z.emit("complete",D),z.removeAllListeners()}}}function k(U){if(z.cancelled){return C()}var T=bq(E)(U);T&&(B.seq=U.seq,B.changes.push(U),n(0===I.length&&F.live))}function S(U){if(u=!1,z.cancelled){return C()}if(U.results.length>0){F.since=U.last_seq,G(),n(!0)}else{var T=function(){v?(F.live=!0,G()):x=!0,n(!0)};g||0!==U.results.length?T():(N=!0,Q.writeCheckpoint(U.last_seq,j).then(function(){N=!1,D.last_seq=J=U.last_seq,T()})["catch"](q))}}function A(T){return u=!1,z.cancelled?C():void L("changes rejected",T)}function G(){function V(){U.cancel()}function T(){z.removeListener("cancel",V)}if(!u&&!x&&I.length<o){u=!0,z._changes&&(z.removeListener("cancel",z._abortChanges),z._changes.cancel()),z.once("cancel",V);var U=i.changes(F).on("change",k);U.then(T,T),U.then(S)["catch"](A),E.retry&&(z._changes=U,z._abortChanges=V)}}function M(){K().then(function(){return z.cancelled?void C():Q.getCheckpoint().then(function(T){J=T,F={since:J,limit:m,batch_size:m,style:"all_docs",doc_ids:R,return_docs:!0},E.filter&&("string"!=typeof E.filter?F.include_docs=!0:F.filter=E.filter),"heartbeat" in E&&(F.heartbeat=E.heartbeat),"timeout" in E&&(F.timeout=E.timeout),E.query_params&&(F.query_params=E.query_params),E.view&&(F.view=E.view),G()})})["catch"](function(T){L("getCheckpoint rejected with ",T)})}function q(T){throw N=!1,L("writeCheckpoint completed with error",T),T}var g,p,Q,I=[],B={seq:0,changes:[],docs:[]},N=!1,x=!1,O=!1,J=0,v=E.continuous||E.live||!1,m=E.batch_size||100,o=E.batches_limit||10,u=!1,R=E.doc_ids,h=[],w=[],j=eY();D=D||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var F={};return z.ready(i,r),z.cancelled?void C():(z._addedListeners||(z.once("cancel",C),"function"==typeof E.complete&&(z.once("error",E.complete),z.once("complete",function(T){E.complete(null,T)})),z._addedListeners=!0),void ("undefined"==typeof E.since?M():K().then(function(){return N=!0,Q.writeCheckpoint(E.since,j)}).then(function(){return N=!1,z.cancelled?void C():(J=E.since,void M())})["catch"](q)))}function au(){aC.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new bz(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function dc(i,h){var g=h.PouchConstructor;return"string"==typeof i?new g(i,h):i}function ca(k,i,g,j){if("function"==typeof g&&(j=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw av(ba,"`doc_ids` filter parameter is not a list.")}g.complete=j,g=eO(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var l=new au(g),m=dc(k,g),h=dc(i,g);return dN(m,h,g,l),l}function cL(g,i,h,j){return"function"==typeof h&&(j=h,h={}),"undefined"==typeof h&&(h={}),h=eO(h),h.PouchConstructor=h.PouchConstructor||this,g=dc(g,h),i=dc(i,h),new d0(g,i,h,j)}function d0(x,p,q,k){function o(z){v.emit("change",{direction:"pull",change:z})}function u(z){v.emit("change",{direction:"push",change:z})}function n(z){v.emit("denied",{direction:"push",doc:z})}function r(z){v.emit("denied",{direction:"pull",doc:z})}function i(){v.pushPaused=!0,v.pullPaused&&v.emit("paused")}function l(){v.pullPaused=!0,v.pushPaused&&v.emit("paused")}function w(){v.pushPaused=!1,v.pullPaused&&v.emit("active",{direction:"push"})}function s(){v.pullPaused=!1,v.pushPaused&&v.emit("active",{direction:"pull"})}function y(z){return function(D,A){var B="change"===D&&(A===o||A===u),F="denied"===D&&(A===r||A===n),C="paused"===D&&(A===l||A===i),E="active"===D&&(A===s||A===w);(B||F||C||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&v.removeAllListeners(D))}}var v=this;this.canceled=!1;var m=q.push?eD.extend({},q,q.push):q,h=q.pull?eD.extend({},q,q.pull):q;this.push=ca(x,p,m),this.pull=ca(p,x,h),this.pushPaused=!0,this.pullPaused=!0;var g={};q.live&&(this.push.on("complete",v.pull.cancel.bind(v.pull)),this.pull.on("complete",v.push.cancel.bind(v.push))),this.on("newListener",function(z){"change"===z?(v.pull.on("change",o),v.push.on("change",u)):"denied"===z?(v.pull.on("denied",r),v.push.on("denied",n)):"active"===z?(v.pull.on("active",s),v.push.on("active",w)):"paused"===z&&(v.pull.on("paused",l),v.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(v.pull.removeListener("change",o),v.push.removeListener("change",u)):"denied"===z?(v.pull.removeListener("denied",r),v.push.removeListener("denied",n)):"active"===z?(v.pull.removeListener("active",s),v.push.removeListener("active",w)):"paused"===z&&(v.pull.removeListener("paused",l),v.push.removeListener("paused",i))}),this.pull.on("removeListener",y("pull")),this.push.on("removeListener",y("push"));var j=bz.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return v.emit("complete",z),k&&k(null,z),v.removeAllListeners(),z},function(z){if(v.cancel(),k?k(z):v.emit("error",z),v.removeAllListeners(),k){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function b2(g){g.replicate=ca,g.sync=cL}var fO,eD=c(9),cz=ed(c(5)),b6=ed(c(8)),cS=ed(c(10)),bb=c(14),cJ=ed(c(4)),aC=c(1),c8=ed(c(15)),aZ=ed(c(16)),d5=ed(c(17)),by=c(12),bz="function"==typeof Promise?Promise:cS,fC=Function.prototype.toString,e9=fC.call(Object),cs=cz("pouchdb:api"),aX=6;if(eM()){fO=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),fO=!!localStorage.getItem("_pouch_check_localstorage")}catch(dO){fO=!1}}b6(fD,aC.EventEmitter),fD.prototype.addListener=function(k,i,g,j){function l(){function n(){h=!1}if(m._listeners[i]){if(h){return void (h="waiting")}h=!0;var o=e4(j,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>j.since&&!j.cancelled&&(j.since=p.seq,j.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){l()},0),h=!1}).on("error",n)}}if(!this._listeners[i]){var m=this,h=!1;this._listeners[i]=l,this.on(k,l)}},fD.prototype.removeListener=function(h,g){g in this._listeners&&aC.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},fD.prototype.notifyLocalWindows=function(g){eM()?chrome.storage.local.set({dbName:g}):dd()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},fD.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},b6(dk,Error),dk.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var dJ=new dk({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),bm=new dk({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),eW=new dk({status:404,error:"not_found",reason:"missing"}),cf=new dk({status:409,error:"conflict",reason:"Document update conflict"}),c6=new dk({status:400,error:"invalid_id",reason:"_id field must contain a string"}),bw=new dk({status:412,error:"missing_id",reason:"_id is required for puts"}),dw=new dk({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),cY=new dk({status:412,error:"precondition_failed",reason:"Database not open"}),bW=new dk({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),e6=new dk({status:500,error:"badarg",reason:"Some query argument is invalid"}),dF=new dk({status:400,error:"invalid_request",reason:"Request was invalid"}),d4=new dk({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),eZ=new dk({status:500,error:"doc_validation",reason:"Bad special document member"}),ba=new dk({status:400,error:"bad_request",reason:"Something wrong with the request"}),eH=new dk({status:400,error:"bad_request",reason:"Document must be a JSON object"}),df=new dk({status:404,error:"not_found",reason:"Database not found"}),eP=new dk({status:500,error:"indexed_db_went_bad",reason:"unknown"}),c2=new dk({status:500,error:"web_sql_went_bad",reason:"unknown"}),ea=new dk({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),eQ=new dk({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),bA=new dk({status:400,error:"bad_request",reason:"Invalid rev format"}),dP=new dk({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),bF=new dk({status:412,error:"missing_stub"}),d1=new dk({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cu=[dJ,bm,eW,cf,c6,bw,dw,cY,bW,e6,dF,d4,eZ,ba,eH,df,c2,ea,eQ,bA,dP,bF,eP,d1],dV=function(g,i,h){var j=cu.filter(function(k){return k[g]===i});return h&&j.filter(function(k){return k.message===h})[0]||j[0]},fG=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],kd="queryKey",f7=/(?:^|&)([^&=]*)=?([^&]*)/g,fI=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f1="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b6(cE,aC.EventEmitter),cE.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},cE.prototype.doChanges=function(h){var k=this,j=h.complete;if(h=eO(h),"live" in h&&!("continuous" in h)&&(h.continuous=h.live),h.processChange=dZ,"latest"===h.since&&(h.since="now"),h.since||(h.since=0),"now"===h.since){return void this.db.info().then(function(l){return k.isCancelled?void j(null,{status:"cancelled"}):(h.since=l.update_seq,void k.doChanges(h))},j)}if(h.continuous&&"now"!==h.since&&this.db.info().then(function(l){k.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),h.view&&!h.filter&&(h.filter="_view"),h.filter&&"string"==typeof h.filter&&("_view"===h.filter?h.view=aU(h.view):h.filter=aU(h.filter),"http"!==this.db.type()&&!h.doc_ids)){return this.filterChanges(h)}"descending" in h||(h.descending=!1),h.limit=0===h.limit?1:h.limit,h.complete=j;var g=this.db._changes(h);if(g&&"function"==typeof g.cancel){var i=k.cancel;k.cancel=cJ(function(l){g.cancel(),i.apply(this,l)})}},cE.prototype.filterChanges=function(i){var l=this,k=i.complete;if("_view"===i.filter){if(!i.view||"string"!=typeof i.view){var h=av(ba,"`view` filter parameter not found or invalid.");return k(h)}var j=eA(i.view);this.db.get("_design/"+j[0],function(n,m){if(l.isCancelled){return k(null,{status:"cancelled"})}if(n){return k(c1(n))}var o=m&&m.views&&m.views[j[1]]&&m.views[j[1]].map;return o?(i.filter=aI(o),void l.doChanges(i)):k(av(eW,m.views?"missing json key: "+j[1]:"missing json key: views"))})}else{var g=eA(i.filter);if(!g){return l.doChanges(i)}this.db.get("_design/"+g[0],function(o,m){if(l.isCancelled){return k(null,{status:"cancelled"})}if(o){return k(c1(o))}var n=m&&m.filters&&m.filters[g[1]];return n?(i.filter=cm(n),void l.doChanges(i)):k(av(eW,m&&m.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},b6(aD,aC.EventEmitter),aD.prototype.post=eC("post",function(i,h,g){return"function"==typeof h&&(g=h,h={}),"object"!=typeof i||Array.isArray(i)?g(av(eH)):void this.bulkDocs({docs:[i]},h,jQ(g))}),aD.prototype.put=eC("put",cJ(function(l){function g(){n||(bS("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),n=!0)}var j,h,k,m,n=!1,i=l.shift(),o="_id" in i;if("object"!=typeof i||Array.isArray(i)){return(m=l.pop())(av(eH))}for(;;){if(j=l.shift(),h=typeof j,"string"!==h||o?"string"!==h||!o||"_rev" in i?"object"===h?k=j:"function"===h&&(m=j):(g(),i._rev=j):(g(),i._id=j,o=!0),!l.length){break}}return k=k||{},cU(i._id),cd(i._id)&&"function"==typeof this._putLocal?i._deleted?this._removeLocal(i,m):this._putLocal(i,m):void this.bulkDocs({docs:[i]},k,jQ(m))})),aD.prototype.putAttachment=eC("putAttachment",function(k,i,g,j,l){function m(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[i]={content_type:l,data:j,revpos:++n},h.put(o)}var h=this;return"function"==typeof l&&(l=j,j=g,g=null),"undefined"==typeof l&&(l=j,j=g,g=null),h.get(k).then(function(n){if(n._rev!==g){throw av(cf)}return m(n)},function(n){if(n.reason===eW.message){return m({_id:k})}throw n})}),aD.prototype.removeAttachment=eC("removeAttachment",function(h,k,j,g){var i=this;i.get(h,function(m,l){return m?void g(m):l._rev!==j?void g(av(cf)):l._attachments?(delete l._attachments[k],0===Object.keys(l._attachments).length&&delete l._attachments,void i.put(l,g)):g()})}),aD.prototype.remove=eC("remove",function(i,l,k,h){var j;"string"==typeof l?(j={_id:i,_rev:l},"function"==typeof k&&(h=k,k={})):(j=i,"function"==typeof l?(h=l,k={}):(h=k,k=l)),k=k||{},k.was_delete=!0;var g={_id:j._id,_rev:j._rev||k.rev};return g._deleted=!0,cd(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(j,h):void this.bulkDocs({docs:[g]},k,jQ(h))}),aD.prototype.revsDiff=eC("revsDiff",function(l,n,i){function g(o,p){j.has(o)||j.set(o,{missing:[]}),j.get(o).missing.push(p)}function h(q,p){var o=l[q].slice(0);ds(p,function(s,r,x,v,w){var y=r+"-"+x,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==w.status&&g(q,y))}),o.forEach(function(r){g(q,r)})}"function"==typeof n&&(i=n,n={});var m=Object.keys(l);if(!m.length){return i(null,{})}var k=0,j=new bb.Map;m.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){j.set(o,{missing:l[o]})}else{if(q){return i(q)}h(o,p)}if(++k===m.length){var r={};return j.forEach(function(u,s){r[s]=u}),i(null,r)}})},this)}),aD.prototype.bulkGet=eC("bulkGet",function(h,g){eB(this,h,g)}),aD.prototype.compactDocument=eC("compactDocument",function(g,i,h){var j=this;this._getRevisionTree(g,function(n,l){if(n){return h(n)}var o=cP(l),m=[],k=[];Object.keys(o).forEach(function(p){o[p]>i&&m.push(p)}),ds(l,function(v,s,q,u,p){var r=s+"-"+q;"available"===p.status&&-1!==m.indexOf(r)&&k.push(r)}),j._doCompaction(g,k,h)})}),aD.prototype.compact=eC("compact",function(i,h){"function"==typeof i&&(h=i,i={});var g=this;i=i||{},g._compactionQueue=g._compactionQueue||[],g._compactionQueue.push({opts:i,callback:h}),1===g._compactionQueue.length&&ek(g)}),aD.prototype._compact=function(k,i){function g(n){h.push(l.compactDocument(n.id,0))}function j(o){var n=o.last_seq;bz.all(h).then(function(){return dj(l,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){i(null,{ok:!0})})["catch"](i)}var l=this,m={return_docs:!1,last_seq:k.last_seq||0},h=[];l.changes(m).on("change",g).on("complete",j).on("error",i)},aD.prototype.get=eC("get",function(l,n,i){function g(){var o=[],p=h.length;return p?void h.forEach(function(q){m.get(l,{rev:q,revs:n.revs,attachments:n.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||i(null,o)})}):i(null,o)}if("function"==typeof n&&(i=n,n={}),"string"!=typeof l){return i(av(c6))}if(cd(l)&&"function"==typeof this._getLocal){return this._getLocal(l,i)}var h=[],m=this;if(!n.open_revs){return this._get(l,n,function(C,B){if(C){return i(C)}var v=B.doc,u=B.metadata,y=B.ctx;if(n.conflicts){var s=e5(u);s.length&&(v._conflicts=s)}if(dH(u,v._rev)&&(v._deleted=!0),n.revs||n.revs_info){var r=bP(u.rev_tree),A=fP(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(v._rev.split("-")[1])}),w=A.ids.map(function(D){return D.id}).indexOf(v._rev.split("-")[1])+1,o=A.ids.length-w;if(A.ids.splice(w,o),A.ids.reverse(),n.revs&&(v._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),n.revs_info){var p=A.pos+A.ids.length;v._revs_info=A.ids.map(function(D){return p--,{rev:p+"-"+D.id,status:D.opts.status}})}}if(n.attachments&&v._attachments){var q=v._attachments,x=Object.keys(q).length;if(0===x){return i(null,v)}Object.keys(q).forEach(function(D){this._getAttachment(v._id,D,q[D],{rev:v._rev,binary:n.binary,ctx:y},function(F,G){var E=v._attachments[D];E.data=G,delete E.stub,delete E.length,--x||i(null,v)})},m)}else{if(v._attachments){for(var z in v._attachments){v._attachments.hasOwnProperty(z)&&(v._attachments[z].stub=!0)}}i(null,v)}})}if("all"===n.open_revs){this._getRevisionTree(l,function(o,p){return o?i(o):(h=bC(p).map(function(q){return q.rev}),void g())})}else{if(!Array.isArray(n.open_revs)){return i(av(bW,"function_clause"))}h=n.open_revs;for(var k=0;k<h.length;k++){var j=h[k];if("string"!=typeof j||!/^\d+-/.test(j)){return i(av(bA))}}g()}}),aD.prototype.getAttachment=eC("getAttachment",function(h,k,j,g){var i=this;j instanceof Function&&(g=j,j={}),this._get(h,j,function(m,l){return m?g(m):l.doc._attachments&&l.doc._attachments[k]?(j.ctx=l.ctx,j.binary=!0,i._getAttachment(h,k,l.doc._attachments[k],j,g),void 0):g(av(eW))})}),aD.prototype.allDocs=eC("allDocs",function(i,h){if("function"==typeof i&&(h=i,i={}),i.skip="undefined"!=typeof i.skip?i.skip:0,i.start_key&&(i.startkey=i.start_key),i.end_key&&(i.endkey=i.end_key),"keys" in i){if(!Array.isArray(i.keys)){return h(new TypeError("options.keys must be an array"))}var g=["startkey","endkey","key"].filter(function(j){return j in i})[0];if(g){return void h(av(d4,"Query parameter `"+g+"` is not compatible with multi-get"))}if("http"!==this.type()){return kc(this,i,h)}}return this._allDocs(i,h)}),aD.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new cE(this,h,g)},aD.prototype.close=eC("close",function(g){return this._closed=!0,this._close(g)}),aD.prototype.info=eC("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),aD.prototype.id=eC("id",function(g){return this._id(g)}),aD.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},aD.prototype.bulkDocs=eC("bulkDocs",function(h,k,j){if("function"==typeof k&&(j=k,k={}),k=k||{},Array.isArray(h)&&(h={docs:h}),!h||!h.docs||!Array.isArray(h.docs)){return j(av(bm))}for(var g=0;g<h.docs.length;++g){if("object"!=typeof h.docs[g]||Array.isArray(h.docs[g])){return j(av(eH))}}var i;return h.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){i=i||bc(m)})}),i?j(av(ba,i)):("new_edits" in k||("new_edits" in h?k.new_edits=h.new_edits:k.new_edits=!0),k.new_edits||"http"===this.type()||h.docs.sort(ki),e1(h.docs),this._bulkDocs(h,k,function(m,l){return m?j(m):(k.new_edits||(l=l.filter(function(n){return n.error})),void j(null,l))}))}),aD.prototype.registerDependentDatabase=eC("registerDependentDatabase",function(g,i){function h(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[g]?!1:(k.dependentDbs[g]=!0,k)}var j=new this.constructor(g,this.__opts);dj(this,"_local/_pouch_dependentDbs",h).then(function(){i(null,{db:j})})["catch"](i)}),aD.prototype.destroy=eC("destroy",function(h,k){function j(){g._destroy(h,function(l,m){return l?k(l):(g._destroyed=!0,g.emit("destroyed"),void k(null,m||{ok:!0}))})}"function"==typeof h&&(k=h,h={});var g=this,i="use_prefix" in g?g.use_prefix:!0;return"http"===g.type()?j():void g.get("_local/_pouch_dependentDbs",function(o,m){if(o){return 404!==o.status?k(o):j()}var p=m.dependentDbs,n=g.constructor,l=Object.keys(p).map(function(r){var q=i?r.replace(new RegExp("^"+n.prefix),""):r;return new n(q,g.__opts).destroy()});bz.all(l).then(j,k)})}),dE.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},dE.prototype.fail=function(g){this.failed=g,this.execute()},dE.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},dE.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},b6(e,aD),e.debug=cz,e.adapters={},e.preferredAdapters=[],e.prefix="_pouch_";var bE=new aC.EventEmitter;dv(e),e.parseAdapter=function(l,n){var i,g,h=l.match(/([a-z\-]*):\/\/(.*)/);if(h){if(l=/http(s?)/.test(h[1])?h[1]+"://"+h[2]:h[2],i=h[1],!e.adapters[i].valid()){throw"Invalid adapter"}return{name:l,adapter:h[1]}}var m="idb" in e.adapters&&"websql" in e.adapters&&dd()&&localStorage["_pouch__websqldb_"+e.prefix+l];if(n.adapter){g=n.adapter}else{if("undefined"!=typeof n&&n.db){g="leveldb"}else{for(var k=0;k<e.preferredAdapters.length;++k){if(g=e.preferredAdapters[k],g in e.adapters){if(m&&"idb"===g){bS("log",'PouchDB is downgrading "'+l+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}i=e.adapters[g];var j=i&&"use_prefix" in i?i.use_prefix:!0;return{name:j?e.prefix+l:l,adapter:g}},e.adapter=function(i,h,g){h.valid()&&(e.adapters[i]=h,g&&e.preferredAdapters.push(i))},e.plugin=function(g){return"function"==typeof g?g(e):Object.keys(g).forEach(function(h){e.prototype[h]=g[h]}),e},e.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=eD.extend({},h,i),void e.call(this,k,i,j)):new g(k,i,j)}return b6(g,e),g.preferredAdapters=e.preferredAdapters.slice(),Object.keys(e).forEach(function(i){i in g||(g[i]=e[i])}),g};var ka="5.4.4";e.version=ka;var d6,ck=eR(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cG=eR(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),jR=function(g){return atob(g)},cD=function(g){return btoa(g)},cM=aL.setImmediate||aL.setTimeout,bG=32768,dG=5,cA="document-store",e7="by-sequence",dW="attach-store",ej="attach-seq-store",aW="meta-store",bj="local-store",am="detect-blob-support",bg={running:!1,queue:[]},cQ=new bb.Map,ag=new fD,f4=new bb.Map;t.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var bX=7,cN=cw("document-store"),jT=cw("by-sequence"),aq=cw("attach-store"),jL=cw("local-store"),el=cw("metadata-store"),cv=cw("attach-seq-store"),j6=new bb.Map,cW=new fD,f2=1,dQ="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+jT+" (seq, deleted)",bL="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+jT+" (doc_id, rev)",kf="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+cN+" (winningseq)",az="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+cv+" (seq)",ab="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+cv+" (digest, seq)",ax=jT+".seq = "+cN+".winningseq",bx=jT+".seq AS seq, "+jT+".deleted AS deleted, "+jT+".json AS data, "+jT+".rev AS rev, "+cN+".json AS metadata";dT.valid=eI,dT.use_prefix=!0;var aF=ad(),dx=function(){},c7=25,jK=50,aN={},b7=1800,cg=cz("pouchdb:http");eb.valid=function(){return !0},jP.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},jP.prototype.finish=function(){return this.promise};var cT=function(h,g){return g&&h.then(function(i){dC.nextTick(function(){g(null,i)})},function(i){dC.nextTick(function(){g(i)})}),h},bT=function(g){return cJ(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&cT(i,j),i})},bD=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},b0=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},b3=function(i){for(var l={},k=0,h=i.length;h>k;k++){l["$"+i[k]]=!0}var j=Object.keys(l),g=new Array(j.length);for(k=0,h=j.length;h>k;k++){g[k]=j[k].substring(1)}return g},dB={},bN=new jP,fA=50,ak=bS.bind(null,"log"),jS={_sum:function(h,g){return ef(g)},_count:function(h,g){return g.length},_stats:function(i,h){function g(k){for(var n=0,m=0,j=k.length;j>m;m++){var l=k[m];n+=l*l}return n}return{sum:ef(h),min:Math.min.apply(null,h),max:Math.max.apply(null,h),count:h.length,sumsqr:g(h)}}},d7=bT(function(){var g=this;return"http"===g.type()?fL(g):"function"==typeof g._viewCleanup?kg(g):cx(g)}),j5=function(h,k,j){"function"==typeof k&&(j=k,k={}),k=k?cl(k):{},"function"==typeof h&&(h={map:h});var g=this,i=bz.resolve().then(function(){return kh(g,h,k)});return cT(i,j),i};b6(eT,Error),b6(c0,Error),b6(ac,Error);var bZ={query:j5,viewCleanup:d7},ke=1,dK="pouchdb",d9=5,fF=0;fR.prototype.writeCheckpoint=function(i,h){var g=this;return this.updateTarget(i,h).then(function(){return g.updateSource(i,h)})},fR.prototype.updateTarget=function(h,g){return j9(this.target,this.id,h,g,this.returnValue)},fR.prototype.updateSource=function(i,h){var g=this;return this.readOnlySource?bz.resolve(!0):j9(this.src,this.id,i,h,this.returnValue)["catch"](function(j){if(dm(j)){return g.readOnlySource=!0,!0}throw j})};var dp={undefined:function(h,g){return 0===by.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return aK(g,h).last_seq}};fR.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?bz.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return fF}var j;return j=h.version?h.version.toString():"undefined",j in dp?dp[j](h,i):fF},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:fF}).then(function(){return fF},function(j){return dm(j)?(g.readOnlySource=!0,h.last_seq):fF})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return fF})};var bp=0;b6(au,aC.EventEmitter),au.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},au.prototype.ready=function(h,k){function j(){i.cancel()}function g(){h.removeListener("destroyed",j),k.removeListener("destroyed",j)}var i=this;i._readyCalled||(i._readyCalled=!0,h.once("destroyed",j),k.once("destroyed",j),i.once("complete",g))},b6(d0,aC.EventEmitter),d0.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},e.plugin(b4).plugin(kk).plugin(fN).plugin(bZ).plugin(b2),f.exports=e}).call(this,c(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var i="color: "+this.color;n=[n[0],i,"color: inherit"].concat(Array.prototype.slice.call(n,1));var o=0,p=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(o++,"%c"===q&&(p=o))}),n.splice(p,0,i),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(j,p,d){function v(){return d.colors[h++%d.colors.length]}function c(f){function n(){}function e(){var s=e,u=+new Date,t=u-(k||u);s.diff=t,s.prev=k,s.curr=u,k=u,null==s.useColors&&(s.useColors=d.useColors()),null==s.color&&s.useColors&&(s.color=v());var o=Array.prototype.slice.call(arguments);o[0]=d.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var x=0;o[0]=o[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}x++;var w=d.formatters[B];if("function"==typeof w){var C=o[x];D=w.call(s,C),o.splice(x,1),x--}return D}),"function"==typeof d.formatArgs&&(o=d.formatArgs.apply(s,o));var r=e.log||d.log||console.log.bind(console);r.apply(s,o)}n.enabled=!1,e.enabled=!0;var i=d.enabled(f)?e:n;return i.namespace=f,i}function g(e){d.save(e);for(var f=(e||"").split(/[\s,]+/),n=f.length,i=0;n>i;i++){f[i]&&(e=f[i].replace(/\*/g,".*?"),"-"===e[0]?d.skips.push(new RegExp("^"+e.substr(1)+"$")):d.names.push(new RegExp("^"+e+"$")))}}function l(){d.enable("")}function q(i){var e,f;for(e=0,f=d.skips.length;f>e;e++){if(d.skips[e].test(i)){return !1}}for(e=0,f=d.names.length;f>e;e++){if(d.names[e].test(i)){return !0}}return !1}function m(e){return e instanceof Error?e.stack||e.message:e}d=p.exports=c,d.coerce=m,d.disable=l,d.enable=g,d.enabled=q,d.humanize=j(11),d.names=[],d.skips=[],d.formatters={};var k,h=0},{11:11}],7:[function(c,f,d){(function(p){function h(){m=!0;for(var n,l,i=j.length;i;){for(l=j,j=[],n=-1;++n<i;){l[n]()}i=j.length}m=!1}function w(i){1!==j.push(i)||m||e()}var e,k=p.MutationObserver||p.WebKitMutationObserver;if(k){var q=0,v=new k(h),t=p.document.createTextNode("");v.observe(t,{characterData:!0}),e=function(){t.data=q=++q%2}}else{if(p.setImmediate||"undefined"==typeof p.MessageChannel){e="document" in p&&"onreadystatechange" in p.document.createElement("script")?function(){var i=p.document.createElement("script");i.onreadystatechange=function(){h(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},p.document.documentElement.appendChild(i)}:function(){setTimeout(h,0)}}else{var g=new p.MessageChannel;g.port1.onmessage=h,e=function(){g.port2.postMessage(0)}}}var m,j=[];f.exports=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(c,f,d){"function"==typeof Object.create?f.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(c,f,d){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(A,k,w){function B(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=z,this.queue=[],this.outcome=void 0,e!==B&&g(this,e)}function H(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function C(f,e,h){E(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function I(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(h,l){function f(o){e||(e=!0,d.reject(h,o))}function m(o){e||(e=!0,d.resolve(h,o))}function i(){l(m,f)}var e=!1,n=D(i);"error"===n.status&&f(n.value)}function D(e,h){var f={};try{f.value=e(h),f.status="success"}catch(i){f.status="error",f.value=i}return f}function x(e){return e instanceof this?e:d.resolve(new this(B),e)}function G(f){var e=new this(B);return d.reject(e,f)}function J(l){function p(r,s){function t(u){n[s]=u,++m!==e||i||(i=!0,d.resolve(f,n))}h.resolve(r).then(t,function(u){i||(i=!0,d.reject(f,u))})}var h=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var e=l.length,i=!1;if(!e){return this.resolve([])}for(var n=new Array(e),m=0,o=-1,f=new this(B);++o<e;){p(l[o],o)}return f}function q(h){function l(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(m,p))},function(p){e||(e=!0,d.reject(m,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var i=h.length,e=!1;if(!i){return this.resolve([])}for(var n=-1,m=new this(B);++n<i;){l(h[n])}return m}var E=A(7),d={},c=["REJECTED"],F=["FULFILLED"],z=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(i,h){if("function"!=typeof i&&this.state===F||"function"!=typeof h&&this.state===c){return this}var f=new this.constructor(B);if(this.state!==z){var e=this.state===F?i:h;C(f,e,this.outcome)}else{this.queue.push(new H(f,i,h))}return f},H.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},H.prototype.otherCallFulfilled=function(e){C(this.promise,this.onFulfilled,e)},H.prototype.callRejected=function(e){d.reject(this.promise,e)},H.prototype.otherCallRejected=function(e){C(this.promise,this.onRejected,e)},d.resolve=function(m,f){var i=D(I,f);if("error"===i.status){return d.reject(m,i.value)}var l=i.value;if(l){g(m,l)}else{m.state=F,m.outcome=f;for(var h=-1,e=m.queue.length;++h<e;){m.queue[h].callFulfilled(f)}}return m},d.reject=function(e,h){e.state=c,e.outcome=h;for(var f=-1,i=e.queue.length;++f<i;){e.queue[f].callRejected(h)}return e},j.resolve=x,j.reject=G,j.all=J,j.race=q},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(j,d,m){function y(i){if(null!==i){switch(typeof i){case"boolean":return i?1:0;case"number":return z(i);case"string":return i.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var f=Array.isArray(i),o=f?i:Object.keys(i),l=-1,n=o.length,e="";if(f){for(;++l<n;){e+=m.toIndexableString(o[l])}}else{for(;++l<n;){var h=o[l];e+=m.toIndexableString(h)+m.toIndexableString(i[h])}}return e}}return""}function c(h,o){var e,r=o,s="1"===h[o];if(s){e=0,o++}else{var f="0"===h[o];o++;var l="",p=h.substring(o,o+g),n=parseInt(p,10)+B;for(f&&(n=-n),o+=g;;){var i=h[o];if("\x00"===i){break}l+=i,o++}l=l.split("."),e=1===l.length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),f&&(e-=10),0!==n&&(e=parseFloat(e+"e"+n))}return{num:e,length:o-r}}function v(o,l){var f=o.pop();if(l.length){var e=l[l.length-1];f===e.element&&(l.pop(),e=l[l.length-1]);var n=e.element,i=e.index;if(Array.isArray(n)){n.push(f)}else{if(i===o.length-2){var h=o.pop();n[h]=f}else{o.push(f)}}}}function C(l,h){for(var i=Math.min(l.length,h.length),e=0;i>e;e++){var f=m.collate(l[e],h[e]);if(0!==f){return f}}return l.length===h.length?0:l.length>h.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(i,f){for(var o=Object.keys(i),l=Object.keys(f),n=Math.min(o.length,l.length),e=0;n>e;e++){var h=m.collate(o[e],l[e]);if(0!==h){return h}if(h=m.collate(i[o[e]],f[l[e]]),0!==h){return h}}return o.length===l.length?0:o.length>l.length?1:-1}function q(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function z(o){if(0===o){return"1"}var e=o.toExponential().split(/e\+?/),l=parseInt(e[1],10),h=0>o,i=h?"0":"2",n=(h?-l:l)-B,p=k.padLeft(n.toString(),"0",g);i+=w+p;var f=Math.abs(parseFloat(e[0]));h&&(f=10-f);var r=f.toFixed(20);return r=r.replace(/\.?0+$/,""),i+=w+r}var B=-324,g=3,w="",k=j(13);m.collate=function(h,e){if(h===e){return 0}h=m.normalizeKey(h),e=m.normalizeKey(e);var f=q(h),i=q(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},m.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var f=0;i>f;f++){l[f]=m.normalizeKey(h[f])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var e in h){if(h.hasOwnProperty(e)){var n=h[e];"undefined"!=typeof n&&(l[e]=m.normalizeKey(n))}}}}}return l},m.toIndexableString=function(f){var e="\x00";return f=m.normalizeKey(f),q(f)+w+y(f)+e},m.parseIndexableString=function(h){for(var o=[],s=[],r=0;;){var l=h[r++];if("\x00"!==l){switch(l){case"1":o.push(null);break;case"2":o.push("1"===h[r]),r++;break;case"3":var p=c(h,r);o.push(p.num),r+=p.length;break;case"4":for(var n="";;){var i=h[r];if("\x00"===i){break}n+=i,r++}n=n.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),o.push(n);break;case"5":var f={element:[],index:o.length};o.push(f.element),s.push(f);break;case"6":var e={element:{},index:o.length};o.push(e.element),s.push(e);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+l)}}else{if(1===o.length){return o.pop()}v(o,s)}}}},{13:13}],13:[function(f,c,g){function d(i,e,k){for(var h="",j=k-i.length;h.length<j;){h+=e}return h}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var l,h=j.length,m=p.length;for(l=0;h>l;l++){if(l===m){return 1}var e=j.charAt(l),k=p.charAt(l);if(e!==k){return k>e?-1:1}}return m>h?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(c,g,f){function h(){this.store={}}function d(i){if(this.store=new h,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}f.Map=h,f.Set=d,h.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},h.prototype.unmangle=function(e){return e.substring(1)},h.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},h.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},h.prototype.has=function(i){var e=this.mangle(i);return e in this.store},h.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},h.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},d.prototype.add=function(e){return this.store.set(e,!0)},d.prototype.has=function(e){return this.store.has(e)},d.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(c,f,d){(function(){var e={}.hasOwnProperty,g=[].slice;f.exports=function(j,i){var m,l,k,h;l=[],h=[];for(m in i){e.call(i,m)&&(k=i[m],"this"!==m&&(l.push(m),h.push(k)))}return Function.apply(null,g.call(l).concat([j])).apply(i["this"],h)}}).call(this)},{}],16:[function(e,d,c){!function(g){if("object"==typeof c){d.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(z){function A(i,h,n,m,l,g){return h=K(K(h,i),K(m,g)),K(h<<l|h>>>32-l,n)}function G(m,n,l,h,i,o,g){return A(n&l|~n&h,m,n,i,o,g)}function C(m,n,l,h,i,o,g){return A(n&h|l&~h,m,n,i,o,g)}function E(m,n,l,h,i,o,g){return A(n^l^h,m,n,i,o,g)}function x(m,n,l,h,i,o,g){return A(l^(n|~h),m,n,i,o,g)}function M(i,h){var n=i[0],m=i[1],g=i[2],l=i[3];n=G(n,m,g,l,h[0],7,-680876936),l=G(l,n,m,g,h[1],12,-389564586),g=G(g,l,n,m,h[2],17,606105819),m=G(m,g,l,n,h[3],22,-1044525330),n=G(n,m,g,l,h[4],7,-176418897),l=G(l,n,m,g,h[5],12,1200080426),g=G(g,l,n,m,h[6],17,-1473231341),m=G(m,g,l,n,h[7],22,-45705983),n=G(n,m,g,l,h[8],7,1770035416),l=G(l,n,m,g,h[9],12,-1958414417),g=G(g,l,n,m,h[10],17,-42063),m=G(m,g,l,n,h[11],22,-1990404162),n=G(n,m,g,l,h[12],7,1804603682),l=G(l,n,m,g,h[13],12,-40341101),g=G(g,l,n,m,h[14],17,-1502002290),m=G(m,g,l,n,h[15],22,1236535329),n=C(n,m,g,l,h[1],5,-165796510),l=C(l,n,m,g,h[6],9,-1069501632),g=C(g,l,n,m,h[11],14,643717713),m=C(m,g,l,n,h[0],20,-373897302),n=C(n,m,g,l,h[5],5,-701558691),l=C(l,n,m,g,h[10],9,38016083),g=C(g,l,n,m,h[15],14,-660478335),m=C(m,g,l,n,h[4],20,-405537848),n=C(n,m,g,l,h[9],5,568446438),l=C(l,n,m,g,h[14],9,-1019803690),g=C(g,l,n,m,h[3],14,-187363961),m=C(m,g,l,n,h[8],20,1163531501),n=C(n,m,g,l,h[13],5,-1444681467),l=C(l,n,m,g,h[2],9,-51403784),g=C(g,l,n,m,h[7],14,1735328473),m=C(m,g,l,n,h[12],20,-1926607734),n=E(n,m,g,l,h[5],4,-378558),l=E(l,n,m,g,h[8],11,-2022574463),g=E(g,l,n,m,h[11],16,1839030562),m=E(m,g,l,n,h[14],23,-35309556),n=E(n,m,g,l,h[1],4,-1530992060),l=E(l,n,m,g,h[4],11,1272893353),g=E(g,l,n,m,h[7],16,-155497632),m=E(m,g,l,n,h[10],23,-1094730640),n=E(n,m,g,l,h[13],4,681279174),l=E(l,n,m,g,h[0],11,-358537222),g=E(g,l,n,m,h[3],16,-722521979),m=E(m,g,l,n,h[6],23,76029189),n=E(n,m,g,l,h[9],4,-640364487),l=E(l,n,m,g,h[12],11,-421815835),g=E(g,l,n,m,h[15],16,530742520),m=E(m,g,l,n,h[2],23,-995338651),n=x(n,m,g,l,h[0],6,-198630844),l=x(l,n,m,g,h[7],10,1126891415),g=x(g,l,n,m,h[14],15,-1416354905),m=x(m,g,l,n,h[5],21,-57434055),n=x(n,m,g,l,h[12],6,1700485571),l=x(l,n,m,g,h[3],10,-1894986606),g=x(g,l,n,m,h[10],15,-1051523),m=x(m,g,l,n,h[1],21,-2054922799),n=x(n,m,g,l,h[8],6,1873313359),l=x(l,n,m,g,h[15],10,-30611744),g=x(g,l,n,m,h[6],15,-1560198380),m=x(m,g,l,n,h[13],21,1309151649),n=x(n,m,g,l,h[4],6,-145523070),l=x(l,n,m,g,h[11],10,-1120210379),g=x(g,l,n,m,h[2],15,718787259),m=x(m,g,l,n,h[9],21,-343485551),i[0]=K(n,i[0]),i[1]=K(m,i[1]),i[2]=K(g,i[2]),i[3]=K(l,i[3])}function J(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g.charCodeAt(i)+(g.charCodeAt(i+1)<<8)+(g.charCodeAt(i+2)<<16)+(g.charCodeAt(i+3)<<24)}return h}function w(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g[i]+(g[i+1]<<8)+(g[i+2]<<16)+(g[i+3]<<24)}return h}function B(g){var m,i,h,n,p,o,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;l>=m;m+=64){M(r,J(g.substring(m-64,m)))}for(g=g.substring(m-64),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;i>m;m+=1){h[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(h[m>>2]|=128<<(m%4<<3),m>55){for(M(r,h),m=0;16>m;m+=1){h[m]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),o=parseInt(n[1],16)||0,h[14]=p,h[15]=o,M(r,h),r}function D(g){var o,i,h,n,p,m,l=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(o=64;l>=o;o+=64){M(r,w(g.subarray(o-64,o)))}for(g=l>o-64?g.subarray(o-64):new Uint8Array(0),i=g.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;i>o;o+=1){h[o>>2]|=g[o]<<(o%4<<3)}if(h[o>>2]|=128<<(o%4<<3),o>55){for(M(r,h),o=0;16>o;o+=1){h[o]=0}}return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,h[14]=p,h[15]=m,M(r,h),r}function q(g){var i,h="";for(i=0;4>i;i+=1){h+=L[g>>8*i+4&15]+L[g>>8*i&15]}return h}function F(h){var g;for(g=0;g<h.length;g+=1){h[g]=q(h[g])}return h.join("")}function I(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(i,h){var n,m=i.length,l=new ArrayBuffer(m),g=new Uint8Array(l);for(n=0;m>n;n+=1){g[n]=i.charCodeAt(n)}return h?g:l}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(h,g,i){var l=new Uint8Array(h.byteLength+g.byteLength);return l.set(new Uint8Array(h)),l.set(new Uint8Array(g),h.byteLength),i?l:l.buffer}function N(h){var g,i=[],l=h.length;for(g=0;l-1>g;g+=2){i.push(parseInt(h.substr(g,2),16))}return String.fromCharCode.apply(String,i)}function H(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==F(B("hello"))&&(K=function(h,g){var i=(65535&h)+(65535&g),l=(h>>16)+(g>>16)+(i>>16);return l<<16|65535&i}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(n,m){var p,o,l,h,s=this.byteLength,r=g(n,s),i=s;return m!==z&&(i=g(m,s)),r>i?new ArrayBuffer(0):(p=i-r,o=new ArrayBuffer(p),l=new Uint8Array(o),h=new Uint8Array(this,r,p),l.set(h),o)}}(),H.prototype.append=function(g){return this.appendBinary(I(g)),this},H.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var i,h=this._buff.length;for(i=64;h>=i;i+=64){M(this._hash,J(this._buff.substring(i-64,i)))}return this._buff=this._buff.substring(i-64),this},H.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m.charCodeAt(h)<<(h%4<<3)}return this._finish(g,l),n=F(this._hash),i&&(n=N(n)),this.reset(),n},H.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},H.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},H.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},H.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},H.prototype._finish=function(i,h){var n,m,l,g=h;if(i[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,i),g=0;16>g;g+=1){i[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(n[2],16),l=parseInt(n[1],16)||0,i[14]=m,i[15]=l,M(this._hash,i)},H.hash=function(h,g){return H.hashBinary(I(h),g)},H.hashBinary=function(h,g){var i=B(h),l=F(i);return g?N(l):l},H.ArrayBuffer=function(){this.reset()},H.ArrayBuffer.prototype.append=function(h){var g,i=f(this._buff.buffer,h,!0),l=i.length;for(this._length+=h.byteLength,g=64;l>=g;g+=64){M(this._hash,w(i.subarray(g-64,g)))}return this._buff=l>g-64?new Uint8Array(i.buffer.slice(g-64)):new Uint8Array(0),this},H.ArrayBuffer.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m[h]<<(h%4<<3)}return this._finish(g,l),n=F(this._hash),i&&(n=N(n)),this.reset(),n},H.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},H.ArrayBuffer.prototype.getState=function(){var g=H.prototype.getState.call(this);return g.buff=j(g.buff),g},H.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),H.prototype.setState.call(this,g)},H.ArrayBuffer.prototype.destroy=H.prototype.destroy,H.ArrayBuffer.prototype._finish=H.prototype._finish,H.ArrayBuffer.hash=function(h,g){var i=D(new Uint8Array(h)),l=F(i);return g?N(l):l},H})},{}],17:[function(f,c,g){function d(j,p,l){var h=l[l.length-1];j===h.element&&(l.pop(),h=l[l.length-1]);var m=h.element,e=h.index;if(Array.isArray(m)){m.push(j)}else{if(e===p.length-2){var k=p.pop();m[k]=j}else{p.push(j)}}}g.stringify=function(x){var w=[];w.push({obj:x});for(var z,q,A,m,h,B,p,j,v,k,y,e="";z=w.pop();){if(q=z.obj,A=z.prefix||"",m=z.val||"",e+=A,m){e+=m}else{if("object"!=typeof q){e+="undefined"==typeof q?null:JSON.stringify(q)}else{if(null===q){e+="null"}else{if(Array.isArray(q)){for(w.push({val:"]"}),h=q.length-1;h>=0;h--){B=0===h?"":",",w.push({obj:q[h],prefix:B})}w.push({val:"["})}else{p=[];for(j in q){q.hasOwnProperty(j)&&p.push(j)}for(w.push({val:"}"}),h=p.length-1;h>=0;h--){v=p[h],k=q[v],y=h>0?",":"",y+=JSON.stringify(v)+":",w.push({obj:k,prefix:y})}w.push({val:"{"})}}}}}return e},g.parse=function(h){for(var p,v,q,e,y,r,m,j,x,w=[],k=[],z=0;;){if(p=h[z++],"}"!==p&&"]"!==p&&"undefined"!=typeof p){switch(p){case" ":case"	":case"\n":case":":case",":break;case"n":z+=3,d(null,w,k);break;case"t":z+=3,d(!0,w,k);break;case"f":z+=4,d(!1,w,k);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(v="",z--;;){if(q=h[z++],!/[\d\.\-e\+]/.test(q)){z--;break}v+=q}d(parseFloat(v),w,k);break;case'"':for(e="",y=void 0,r=0;;){if(m=h[z++],'"'===m&&("\\"!==y||r%2!==1)){break}e+=m,y=m,"\\"===y?r++:r=0}d(JSON.parse('"'+e+'"'),w,k);break;case"[":j={element:[],index:w.length},w.push(j.element),k.push(j);break;case"{":x={element:{},index:w.length},w.push(x.element),k.push(x);break;default:throw new Error("unexpectedly reached end of input: "+p)}}else{if(1===w.length){return w.pop()}d(w.pop(),w,k)}}}},{}]},{},[3])(3)});