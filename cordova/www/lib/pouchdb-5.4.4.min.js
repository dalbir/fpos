!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(f,j){if(!l[f]){if(!b[f]){var n="function"==typeof require&&require;if(!j&&n){return n(f,!0)}if(k){return k(f,!0)}var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var h=l[f]={exports:{}};b[f][0].call(h.exports,function(m){var p=b[f][1][m];return e(p?p:m)},h,h.exports,d,b,l,i)}return l[f].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,j,f,l,h,r;if(this._events||(this._events={}),"error"===g&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(j=this._events[g],m(j)){return !1}if(o(j)){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),j.apply(this,l)}}else{if(p(j)){for(l=Array.prototype.slice.call(arguments,1),r=j.slice(),f=r.length,h=0;f>h;h++){r[h].apply(this,l)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(p(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(a,t,n){function b(){B&&s&&(B=!1,s.length?u=s.concat(u):e=-1,u.length&&l())}function l(){if(!B){var g=i(b);B=!0;for(var j=u.length;j;){for(s=u,u=[];++e<j;){s&&s[e].run()}e=-1,j=u.length}s=null,B=!1,f(g)}}function h(g,j){this.fun=g,this.array=j}function r(){}var i,f,o=t.exports={};!function(){try{i=setTimeout}catch(g){i=function(){throw new Error("setTimeout is not defined")}}try{f=clearTimeout}catch(g){f=function(){throw new Error("clearTimeout is not defined")}}}();var s,u=[],B=!1,e=-1;o.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}u.push(new h(j,k)),1!==u.length||B||i(l,0)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(g){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(g){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(b,e,a){(function(di,fU){function fd(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fi(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function g4(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function hE(aa){if(aa instanceof ArrayBuffer){return g4(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function cn(aa){var ab=Object.getPrototypeOf(aa);if(null===ab){return !0}var t=ab.constructor;return"function"==typeof t&&t instanceof t&&ez.call(t)==jm}function jd(aa){var ac,ad,ab;if(!aa||"object"!=typeof aa){return aa}if(Array.isArray(aa)){for(ac=[],ad=0,ab=aa.length;ab>ad;ad++){ac[ad]=jd(aa[ad])}return ac}if(aa instanceof Date){return aa.toISOString()}if(fi(aa)){return hE(aa)}if(!cn(aa)){return aa}ac={};for(ad in aa){if(Object.prototype.hasOwnProperty.call(aa,ad)){var t=jd(aa[ad]);"undefined"!=typeof t&&(ac[ad]=t)}}return ac}function fS(aa){var t=!1;return h5(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fZ(t){return h5(function(ac){ac=jd(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){di.nextTick(function(){ad(ag,ah)})});var af=new hS(function(al,ag){var aj;try{var ak=fS(function(ap,am){ap?ag(ap):al(am)});ac.push(ak),aj=t.apply(aa,ac),aj&&"function"==typeof aj.then&&al(aj)}catch(ah){ag(ah)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function iv(aa,ab){function t(ag,aj,ad){if(g3.enabled){for(var ah=[ag._db_name,aj],af=0;af<ad.length-1;af++){ah.push(ad[af])}g3.apply(null,ah);var ac=ad[ad.length-1];ad[ad.length-1]=function(ak,am){var al=[ag._db_name,aj];al=al.concat(ak?["error",ak]:["success",am]),g3.apply(null,al),ac(ak,am)}}}return fZ(h5(function(ad){if(this._closed){return hS.reject(new Error("database is closed"))}if(this._destroyed){return hS.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new hS(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function ga(aa,ac){for(var ad={},ab=0,t=ac.length;t>ab;ab++){var af=ac[ab];af in aa&&(ad[af]=aa[af])}return ad}function gC(t){return t}function h0(t){return[{ok:t}]}function ee(ag,af,am){function t(){var av=[];aj.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),am(null,{results:av})}function aq(){++ab===ap&&t()}function ak(av,aw,ax){aj[av]={id:aw,docs:ax},aq()}function aa(){if(!(au>=al.length)){var av=Math.min(au+hx,al.length),aw=al.slice(au,av);ac(aw,au),au+=aw.length}}function ac(av,aw){av.forEach(function(aA,ay){var aC=aw+ay,aB=ad[aA],ax=ga(aB[0],["atts_since","attachments"]);ax.open_revs=aB.map(function(aD){return aD.rev}),ax.open_revs=ax.open_revs.filter(gC);var az=gC;0===ax.open_revs.length&&(delete ax.open_revs,az=h0),["revs","attachments","binary","ajax"].forEach(function(aD){aD in af&&(ax[aD]=af[aD])}),ag.get(aA,ax,function(aD,aF){var aE;aE=aD?[{error:aD}]:az(aF),ak(aC,aA,aE),aa()})})}var ah=af.docs,ad={};ah.forEach(function(av){av.id in ad?ad[av.id].push(av):ad[av.id]=[av]});var ap=Object.keys(ad).length,ab=0,aj=new Array(ap),al=Object.keys(ad),au=0;aa()}function gX(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gf(){return ei}function ge(t){gX()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gf()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function fy(){hc.EventEmitter.call(this),this._listeners={},ge(this)}function go(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function fc(aa,ac){var ad=600000;aa=parseInt(aa,10)||0,ac=parseInt(ac,10),ac!==ac||aa>=ac?ac=(aa||1)<<1:ac+=1,ac>ad&&(aa=ad>>1,ac=ad);var ab=Math.random(),t=ac-aa;return ~~(t*ab+aa)}function jt(aa){var t=0;return aa||(t=2000),fc(aa,t)}function iC(aa,t){go("info","The above "+aa+" is totally normal. "+t)}function gd(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function er(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=gd.prototype,new aa(ab)}function ih(aa){var ac,ad,ab,t,af;return ad=aa.error===!0&&"string"==typeof aa.name?aa.name:aa.error,af=aa.reason,ab=h3("name",ad,af),aa.missing||"missing"===af||"deleted"===af||"not_found"===ad?ab=gB:"doc_validation"===ad?(ab=m,t=af):"bad_request"===ad&&ab.message!==af&&(ab=hl),ab||(ab=h3("status",aa.status,af)||hw),ac=er(ab,af,ad),t&&(ac.message=t),aa.id&&(ac.id=aa.id),aa.status&&(ac.status=aa.status),aa.missing&&(ac.missing=aa.missing),ac}function h2(aa,ac,ad){try{return !aa(ac,ad)}catch(ab){var t="Filter function threw: "+ab.toString();return er(hl,t)}}function hn(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&h2(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function H(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function iS(aa){var t;if(aa?"string"!=typeof aa?t=er(gp):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=er(at)):t=er(fn),t){throw t}}function fW(aa,t){return"listenerCount" in aa?aa.listenerCount(t):hc.EventEmitter.listenerCount(aa,t)}function gM(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function hs(aa){var t=gM(aa);return t?t.join("/"):null}function hH(t){for(var ab=fz.exec(t),ag={},aa=14;aa--;){var ad=fo[aa],ac=ab[aa]||"",af=-1!==["user","password"].indexOf(ad);ag[ad]=af?decodeURIComponent(ac):ac}return ag[ew]={},ag[fo[12]].replace(be,function(aj,ah,ak){ah&&(ag[ew][ah]=ak)}),ag}function jB(aa,ab,t){return new hS(function(ad,ac){aa.get(ab,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=t(af);return aj?(aj._id=ab,aj._rev=ag,void ad(jo(aa,aj,t))):ad({updated:!1,rev:ag})})})}function jo(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return jB(aa,ab._id,t)})}function gl(t){return 0|Math.random()*t}function gO(t,ab){ab=ab||fm.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=fm[gl(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=fm[3&gl(16)|8];break;default:ac+=fm[gl(16)]}}return ac}function hB(t){for(var ab,am,aa,ap,ak=t.rev_tree.slice();ap=ak.pop();){var ad=ap.ids,aj=ad[2],ac=ap.pos;if(aj.length){for(var af=0,ah=aj.length;ah>af;af++){ak.push({pos:ac+1,ids:aj[af]})}}else{var al=!!ad[1].deleted,ag=ad[0];ab&&!(aa!==al?aa:am!==ac?ac>am:ag>ab)||(ab=ag,am=ac,aa=al)}}return am+"-"+ab}function fa(ag,ad){for(var aj,aa=ag.slice();aj=aa.pop();){for(var ak=aj.pos,ah=aj.ids,af=ah[2],ac=ad(0===af.length,ak,ah[0],aj.ctx,ah[1]),ab=0,t=af.length;t>ab;ab++){aa.push({pos:ak+1,ids:af[ab],ctx:ac})}}}function fT(aa,t){return aa.pos-t.pos}function hR(t){var ab=[];fa(t,function(aj,ag,ad,ah,af){aj&&ab.push({rev:ag+"-"+ad,pos:ag,opts:af})}),ab.sort(fT).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function gs(t){for(var ab=hB(t),ag=hR(t.rev_tree),aa=[],ad=0,ac=ag.length;ac>ad;ad++){var af=ag[ad];af.rev===ab||af.opts.deleted||aa.push(af.rev)}return aa}function iT(aa){var t=[];return fa(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function hF(t){for(var ab,am=[],aa=t.slice();ab=aa.pop();){var ap=ab.pos,ak=ab.ids,ad=ak[0],aj=ak[1],ac=ak[2],af=0===ac.length,ah=ab.history?ab.history.slice():[];ah.push({id:ad,opts:aj}),af&&am.push({pos:ap+1-ah.length,ids:ah});for(var al=0,ag=ac.length;ag>al;al++){aa.push({pos:ap+1,ids:ac[al],history:ah})}}return am.reverse()}function V(aa,t){return aa.pos-t.pos}function a3(aa,ac,ad){for(var ab,t=0,af=aa.length;af>t;){ab=t+af>>>1,ad(aa[ab],ac)<0?t=ab+1:af=ab}return t}function fq(t,ab,ac){var aa=a3(t,ab,ac);t.splice(aa,0,ab)}function g(af,ad){for(var ac,ab,t=ad,ah=af.length;ah>t;t++){var aa=af[t],ag=[aa.id,aa.opts,[]];ab?(ab[2].push(ag),ab=ag):ac=ab=ag}return ac}function ex(aa,t){return aa[0]<t[0]?-1:1}function ct(ag,ad){for(var aj=[{tree1:ag,tree2:ad}],aa=!1;aj.length>0;){var ak=aj.pop(),ah=ak.tree1,af=ak.tree2;(ah[1].status||af[1].status)&&(ah[1].status="available"===ah[1].status||"available"===af[1].status?"available":"missing");for(var ac=0;ac<af[2].length;ac++){if(ah[2][0]){for(var ab=!1,t=0;t<ah[2].length;t++){ah[2][t][0]===af[2][ac][0]&&(aj.push({tree1:ah[2][t],tree2:af[2][ac]}),ab=!0)}ab||(aa="new_branch",fq(ah[2],af[2][ac],ex))}else{aa="new_leaf",ah[2][0]=af[2][ac]}}}return{conflicts:aa,tree:ag}}function bo(al,ah,am){var aq,av=[],ag=!1,ak=!1;if(!al.length){return{tree:[ah],conflicts:"new_leaf"}}for(var af=0,aw=al.length;aw>af;af++){var ap=al[af];if(ap.pos===ah.pos&&ap.ids[0]===ah.ids[0]){aq=ct(ap.ids,ah.ids),av.push({pos:ap.pos,ids:aq.tree}),ag=ag||aq.conflicts,ak=!0}else{if(am!==!0){var t=ap.pos<ah.pos?ap:ah,aj=ap.pos<ah.pos?ah:ap,ab=aj.pos-t.pos,ad=[],ax=[];for(ax.push({ids:t.ids,diff:ab,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],aa=0,ac=az.length;ac>aa;aa++){ax.push({ids:az[aa],diff:ay.diff-1,parent:ay.ids,parentIdx:aa})}}else{ay.ids[0]===aj.ids[0]&&ad.push(ay)}}var au=ad[0];au?(aq=ct(au.ids,aj.ids),au.parent[2][au.parentIdx]=aq.tree,av.push({pos:t.pos,ids:t.ids}),ag=ag||aq.conflicts,ak=!0):av.push(ap)}else{av.push(ap)}}}return ak||av.push(ah),av.sort(V),{tree:av,conflicts:ag||"internal_node"}}function L(t,ab){for(var am,aa=hF(t),ap={},ak=0,ad=aa.length;ad>ak;ak++){for(var aj=aa[ak],ac=aj.ids,af=Math.max(0,ac.length-ab),ah={pos:aj.pos+af,ids:g(ac,af)},al=0;af>al;al++){var ag=aj.pos+al+"-"+ac[al].id;ap[ag]=!0}am=am?bo(am,ah,!0).tree:[ah]}return fa(am,function(aq,au,av){delete ap[au+"-"+av]}),{tree:am,revs:Object.keys(ap)}}function iP(aa,ac,ad){var ab=bo(aa,ac),t=L(ab.tree,ad);return{tree:t.tree,stemmedRevs:t.revs,conflicts:ab.conflicts}}function h1(ag,ad){for(var aj,aa=ag.slice(),ak=ad.split("-"),ah=parseInt(ak[0],10),af=ak[1];aj=aa.pop();){if(aj.pos===ah&&aj.ids[0]===af){return !0}for(var ac=aj.ids[2],ab=0,t=ac.length;t>ab;ab++){aa.push({pos:aj.pos+1,ids:ac[ab]})}}return !1}function co(t){return t.ids}function jE(aa,ac){ac||(ac=hB(aa));for(var ad,ab=ac.substring(ac.indexOf("-")+1),t=aa.rev_tree.map(co);ad=t.pop();){if(ad[0]===ab){return !!ad[1].deleted}t=t.concat(ad[2])}}function gz(t){return/^_local/.test(t)}function i6(t){return je("return "+t+";",{})}function w(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function gk(aa,ab){try{aa.emit("change",ab)}catch(t){go("error",'Error in .on("change", function):',t)}}function fu(t,ab,ag){function aa(){ad.cancel()}hc.EventEmitter.call(this);var ad=this;this.db=t,ab=ab?jd(ab):{};var ac=ab.complete=fS(function(aj,ah){aj?fW(ad,"error")>0&&ad.emit("error",aj):ad.emit("complete",ah),ad.removeAllListeners(),t.removeListener("destroyed",aa)});ag&&(ad.on("complete",function(ah){ag(null,ah)}),ad.on("error",ag)),t.once("destroyed",aa),ab.onChange=function(ah){ab.isCancelled||(gk(ad,ah),ad.startSeq&&ad.startSeq<=ah.seq&&(ad.startSeq=!1))};var af=new hS(function(aj,ah){ab.complete=function(al,ak){al?ah(al):aj(ak)}});ad.once("cancel",function(){t.removeListener("destroyed",aa),ab.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ac(null,ah)},ac),t.taskqueue.isReady?ad.doChanges(ab):t.taskqueue.addTask(function(){ad.isCancelled?ad.emit("cancel"):ad.doChanges(ab)})}function g0(aa,ac,ad){var ab=[{rev:aa._rev}];"all_docs"===ad.style&&(ab=hR(ac.rev_tree).map(function(af){return{rev:af.rev}}));var t={id:ac.id,changes:ab,doc:aa};return jE(ac,aa._rev)&&(t.deleted=!0),ad.conflicts&&(t.doc._conflicts=gs(ac),t.doc._conflicts.length||delete t.doc._conflicts),t}function a9(aa,t){return t>aa?-1:aa>t?1:0}function a0(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function hU(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function iW(aa){for(var ac=0;ac<aa.length;ac++){var ad=aa[ac];if(ad._deleted){delete ad._attachments}else{if(ad._attachments){for(var ab=Object.keys(ad._attachments),t=0;t<ab.length;t++){var af=ab[t];ad._attachments[af]=ga(ad._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function iM(aa,ac){var ad=a9(aa._id,ac._id);if(0!==ad){return ad}var ab=aa._revisions?aa._revisions.start:0,t=ac._revisions?ac._revisions.start:0;return a9(ab,t)}function hr(aa){var ab={},t=[];return fa(aa,function(ah,ac,ag,ad){var af=ac+"-"+ag;return ah&&(ab[af]=0),void 0!==ad&&t.push({from:ad,to:af}),af}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function l(aa,ac,ad){var ab="limit" in ac?ac.keys.slice(ac.skip,ac.limit+ac.skip):ac.skip>0?ac.keys.slice(ac.skip):ac.keys;if(ac.descending&&ab.reverse(),!ab.length){return aa._allDocs({limit:0},ad)}var t={offset:ac.skip};return hS.all(ab.map(function(af){var ag=Q.extend({key:af,deleted:"ok"},ac);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hS(function(aj,ah){aa._allDocs(ag,function(ak,al){return ak?ah(ak):(t.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return t.rows=af,t})}function jw(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),di.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&jw(t)})})})}function gE(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function ii(){hc.EventEmitter.call(this)}function hA(){this.isReady=!1,this.failed=!1,this.queue=[]}function gh(t){t&&fU.debug&&go("error",t)}function g5(t,ab){function ag(){ac.emit("destroyed",ad)}function aa(){t.removeListener("destroyed",ag),t.emit("destroyed",t)}var ad=ab.originalName,ac=t.constructor,af=ac._destructionListeners;t.once("destroyed",ag),af.has(ad)||af.set(ad,[]),af.get(ad).push(aa)}function fv(t,ab,ag){if(!(this instanceof fv)){return new fv(t,ab,ag)}var aa=this;if("function"!=typeof ab&&"undefined"!=typeof ab||(ag=ab,ab={}),t&&"object"==typeof t&&(ab=t,t=void 0),"undefined"==typeof ag){ag=gh}else{var ad=ag;ag=function(){return go("warn","Using a callback for new PouchDB()is deprecated."),ad.apply(null,arguments)}}t=t||ab.name,ab=jd(ab),delete ab.name,this.__opts=ab;var ac=ag;aa.auto_compaction=ab.auto_compaction,aa.prefix=fv.prefix,ii.call(aa),aa.taskqueue=new hA;var af=new hS(function(al,aj){ag=function(ap,am){return ap?aj(ap):(delete am.then,void al(am))},ab=jd(ab);var ak,ah;return function(){try{if("string"!=typeof t){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}var ap=(ab.prefix||"")+t;if(ak=fv.parseAdapter(ap,ab),ab.originalName=t,ab.name=ak.name,ab.adapter=ab.adapter||ak.adapter,aa._adapter=ab.adapter,hg("pouchdb:adapter")("Picked adapter: "+ab.adapter),aa._db_name=t,!fv.adapters[ab.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!fv.adapters[ab.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){aa.taskqueue.fail(am)}}(),ah?aj(ah):(aa.adapter=ab.adapter,aa.replicate={},aa.replicate.from=function(aq,am,ap){return aa.constructor.replicate(aq,aa,am,ap)},aa.replicate.to=function(aq,am,ap){return aa.constructor.replicate(aa,aq,am,ap)},aa.sync=function(aq,am,ap){return aa.constructor.sync(aa,aq,am,ap)},aa.replicate.sync=aa.sync,void fv.adapters[ab.adapter].call(aa,ab,function(am){return am?(aa.taskqueue.fail(am),void ag(am)):(g5(aa,ab),aa.emit("created",aa),fv.emit("created",ab.originalName),aa.taskqueue.ready(aa),void ag(null,aa))}))});af.then(function(ah){ac(null,ah)},ac),aa.then=af.then.bind(af),aa["catch"]=af["catch"].bind(af)}function iu(aa){Object.keys(hc.EventEmitter.prototype).forEach(function(ab){"function"==typeof hc.EventEmitter.prototype[ab]&&(aa[ab]=iB[ab].bind(iB))});var t=aa._destructionListeners=new ju.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function g9(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hv(t){if(!/^\d+\-./.test(t)){return er(gT)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function bn(t,ab){for(var ag=t.start-t.ids.length+1,aa=t.ids,ad=[aa[0],ab,[]],ac=1,af=aa.length;af>ac;ac++){ad=[aa[ac],{status:"missing"},[ad]]}return[{pos:ag,ids:ad}]}function gI(ag,ad){var aj,aa,ak,ah={status:"available"};if(ag._deleted&&(ah.deleted=!0),ad){if(ag._id||(ag._id=gO()),aa=gO(32,16).toLowerCase(),ag._rev){if(ak=hv(ag._rev),ak.error){return ak}ag._rev_tree=[{pos:ak.prefix,ids:[ak.id,{status:"missing"},[[aa,ah,[]]]]}],aj=ak.prefix+1}else{ag._rev_tree=[{pos:1,ids:[aa,ah,[]]}],aj=1}}else{if(ag._revisions&&(ag._rev_tree=bn(ag._revisions,ah),aj=ag._revisions.start,aa=ag._revisions.ids[0]),!ag._rev_tree){if(ak=hv(ag._rev),ak.error){return ak}aj=ak.prefix,aa=ak.id,ag._rev_tree=[{pos:aj,ids:[aa,ah,[]]}]}}iS(ag._id),ag._rev=aj+"-"+aa;var af={metadata:{},data:{}};for(var ac in ag){if(Object.prototype.hasOwnProperty.call(ag,ac)){var ab="_"===ac[0];if(ab&&!bt[ac]){var t=er(m,ac);throw t.message=m.message+": "+ac,t}ab&&!gt[ac]?af.metadata[ac.slice(1)]=ag[ac]:af.data[ac]=ag[ac]}}return af}function O(aa){for(var ac="",ad=new Uint8Array(aa),ab=ad.byteLength,t=0;ab>t;t++){ac+=String.fromCharCode(ad[t])}return ac}function hN(t){return h8(O(t))}function iy(aa,ac){aa=aa||[],ac=ac||{};try{return new Blob(aa,ac)}catch(ad){if("TypeError"!==ad.name){throw ad}for(var ab="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,t=new ab,af=0;af<aa.length;af+=1){t.append(aa[af])}return t.getBlob(ac.type)}}function R(aa){for(var ac=aa.length,ad=new ArrayBuffer(ac),ab=new Uint8Array(ad),t=0;ac>t;t++){ab[t]=aa.charCodeAt(t)}return ad}function jA(aa,t){return iy([R(aa)],{type:t})}function eu(aa,t){return jA(hG(aa),t)}function gy(t,ab){if("undefined"==typeof FileReader){return ab(O((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(O(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function hz(aa,t){gy(aa,function(ab){t(h8(ab))})}function ja(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function Y(t){return h8(t)}function ci(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function fp(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function fx(ag,ad){function aj(){var aq=ac*ah,al=aq+ah;if(ac++,af>ac){t(ab,ag,aq,al),gL(aj)}else{t(ab,ag,aq,al);var ap=ab.end(!0),am=Y(ap);ad(am),ab.destroy()}}var aa="string"==typeof ag,ak=aa?ag.length:ag.byteLength,ah=Math.min(iU,ak),af=Math.ceil(ak/ah),ac=0,ab=aa?new ij:new ij.ArrayBuffer,t=aa?fp:ci;aj()}function fh(t){return ij.hash(t)}function a8(af,ad,ac){function ab(al){try{return hG(al)}catch(aj){var ak=er(gW,"Attachment is not a valid base64 string");return{error:ak}}}function t(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ab(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ad?aj.data=jA(al,aj.content_type):"base64"===ad?aj.data=h8(al):aj.data=al,fx(al,function(am){aj.digest="md5-"+am,ak()})}else{ja(aj.data,function(am){"binary"===ad?aj.data=O(am):"base64"===ad&&(aj.data=hN(am)),fx(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ah(){ag++,af.length===ag&&(aa?ac(aa):ac())}if(!af.length){return ac()}var aa,ag=0;af.forEach(function(ak){function am(aq){aa=aq,al++,al===aj.length&&ah()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ah()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&t(ak.data._attachments[ap],am)}})}function iJ(ak,al,ac,af,t,az,aa,am){if(h1(al.rev_tree,ac.metadata.rev)){return af[t]=ac,az()}var av=al.winningRev||hB(al),au="deleted" in al?al.deleted:jE(al,av),ah="deleted" in ac.metadata?ac.metadata.deleted:jE(ac.metadata),aq=/^1-/.test(ac.metadata.rev);if(au&&!ah&&am&&aq){var ag=ac.data;ag._rev=av,ag._id=ac.metadata.id,ac=gI(ag,am)}var aA=iP(al.rev_tree,ac.metadata.rev_tree[0],ak),aw=am&&(au&&ah||!au&&"new_leaf"!==aA.conflicts||au&&!ah&&"new_branch"===aA.conflicts);if(aw){var ax=er(hi);return af[t]=ax,az()}var ay=ac.metadata.rev;ac.metadata.rev_tree=aA.tree,ac.stemmedRevs=aA.stemmedRevs||[],al.rev_map&&(ac.metadata.rev_map=al.rev_map);var ad,aj=hB(ac.metadata),ap=jE(ac.metadata,aj),ab=au===ap?0:ap>au?-1:1;ad=ay===aj?ap:jE(ac.metadata,ay),aa(ac,aj,ap,ad,!0,ab,t,az)}function S(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ix(aq,ah,af,am,ak,ac,aj,ad,au){function ap(aA,aC,aw){var ay=hB(aA.metadata),az=jE(aA.metadata,ay);if("was_delete" in ad&&az){return ac[aC]=er(gB,"deleted"),aw()}var av=ag&&S(aA);if(av){var ax=er(hi);return ac[aC]=ax,aw()}var aB=az?0:1;aj(aA,ay,az,az,!1,aB,aC,aw)}function aa(){++al===ab&&au&&au()}aq=aq||1000;var ag=ad.new_edits,t=new ju.Map,al=0,ab=ah.length;ah.forEach(function(aw,ay){if(aw._id&&gz(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void af[ax](aw,{ctx:ak},function(aA,az){ac[ay]=aA||az,aa()})}var av=aw.metadata.id;t.has(av)?(ab--,t.get(av).push([aw,ay])):t.set(av,[[aw,ay]])}),t.forEach(function(ay,aw){function ax(){++az<ay.length?av():aa()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(am.has(aw)){iJ(aq,am.get(aw),aA,ac,aB,ax,aj,ag)}else{var aD=iP([],aA.metadata.rev_tree[0],aq);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ap(aA,aB,ax)}}var az=0;av()})}function hX(aa){try{return JSON.parse(aa)}catch(t){return i5.parse(aa)}}function hL(t){return t.length<50000?JSON.parse(t):hX(t)}function i3(aa){try{return JSON.stringify(aa)}catch(t){return i5.stringify(aa)}}function z(aa,ac,ad,ab){try{aa.apply(ac,ad)}catch(t){ab.emit("error",t)}}function iO(aa){if(!gq.running&&gq.queue.length){gq.running=!0;var t=gq.queue.shift();t.action(function(ac,ab){z(t.callback,this,[ac,ab],aa),gq.running=!1,di.nextTick(function(){iO(aa)})})}}function jD(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(er(fV,aa,ab.type))}}function dt(aa,ab,t){return{data:i3(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function jq(aa){if(!aa){return null}var t=hL(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function I(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function jl(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:eu(t,ab):iy([""],{type:ab})):t?"string"!=typeof t?gy(t,function(ad){aa(h8(ad))}):aa(t):aa("")}function hf(af,ad,ac,ab){function t(){++ag===aa.length&&ab&&ab()}function ah(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ac.objectStore(ff).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,t()}}var aa=Object.keys(af._attachments||{});if(!aa.length){return ab&&ab()}var ag=0;aa.forEach(function(aj){ad.attachments&&ad.include_docs?ah(af,aj):(af._attachments[aj].stub=!0,t())})}function jn(aa,t){return hS.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hS.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new hS(function(aj){jl(ah,af,t,function(ak){ac.doc._attachments[ag]=Q.extend(ga(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function jk(ag,ad,aj){function aa(){t--,t||ak()}function ak(){ah.length&&ah.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ac["delete"](am)}})}var ah=[],af=aj.objectStore(g2),ac=aj.objectStore(ff),ab=aj.objectStore(h6),t=ag.length;ag.forEach(function(al){var am=af.index("_doc_id_rev"),ap=ad+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return aa()}af["delete"](av);var aq=ab.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];ah.push(aw),ab["delete"](ay.primaryKey),ay["continue"]()}else{aa()}}}})}function a7(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function ji(ap,al,az,aG,aj,aJ,aI){function ax(){var aN=[gv,g2,ff,hJ,h6],aO=a7(aj,aN,"readwrite");return aO.error?aI(aO.error):(ah=aO.txn,ah.onabort=jD(aI),ah.ontimeout=jD(aI),ah.oncomplete=am,aC=ah.objectStore(gv),ag=ah.objectStore(g2),ak=ah.objectStore(ff),av=ah.objectStore(h6),void aM(function(aP){return aP?(aw=!0,aI(aP)):void aL()}))}function ay(){ix(ap.revs_limit,ac,aG,t,ah,ab,aH,az)}function aL(){function aO(){++aT===ac.length&&ay()}function aQ(aU){var aV=jq(aU.target.result);aV&&t.set(aV.id,aV),aO()}if(ac.length){for(var aT=0,aP=0,aN=ac.length;aN>aP;aP++){var aR=ac[aP];if(aR._id&&gz(aR._id)){aO()}else{var aS=aC.get(aR.metadata.id);aS.onsuccess=aQ}}}}function am(){aw||(aJ.notify(aG._meta.name),aG._meta.docCount+=aA,aI(null,ab))}function aD(aO,aP){var aN=ak.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=er(hM,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(ac.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aD(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aH(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aF(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bc){var ba=aP.stemmedRevs||[];aV&&aG.auto_compaction&&(ba=ba.concat(iT(aP.metadata))),ba&&ba.length&&jk(ba,aP.metadata.id,ah),aT.seq=bc.target.result,delete aT.rev;var bb=dt(aT,aW,aU),aZ=aC.put(bb);aZ.onsuccess=aN}function aX(aZ){aZ.preventDefault(),aZ.stopPropagation();var ba=ag.index("_doc_id_rev"),bb=ba.getKey(aR._doc_id_rev);bb.onsuccess=function(bc){var bd=ag.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ab[aS]={ok:!0,id:aT.id,rev:aW},t.set(aP.metadata.id,aP.metadata),au(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ag.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aF(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(bb){var aZ=aP.data._attachments[bb];if(aZ.stub){aO++,aN()}else{var aY=aZ.data;delete aZ.data,aZ.revpos=parseInt(aW,10);var ba=aZ.digest;aB(ba,aY,aV)}})}function au(aP,aS,aN){function aQ(){++aT===aU.length&&aN()}function aO(aV){var aW=aP.data._attachments[aV].digest,aX=av.put({seq:aS,digestSeq:aW+"::"+aS});aX.onsuccess=aQ,aX.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aQ()}}var aT=0,aU=Object.keys(aP.data._attachments||{});if(!aU.length){return aN()}for(var aR=0;aR<aU.length;aR++){aO(aU[aR])}}function aB(aO,aQ,aN){var aP=ak.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=ak.put(aU);aR.onsuccess=aN}}for(var ah,aC,ag,ak,av,aE,ac=al.docs,aA=0,aq=0,af=ac.length;af>aq;aq++){var aa=ac[aq];aa._id&&gz(aa._id)||(aa=ac[aq]=gI(aa,az.new_edits),aa.error&&!aE&&(aE=aa))}if(aE){return aI(aE)}var ab=new Array(ac.length),t=new ju.Map,aw=!1,aK=aG._meta.blobSupport?"blob":"base64";a8(ac,aK,function(aN){return aN?aI(aN):void ax()})}function it(aa,ac,ad,ab,t){try{if(aa&&ac){return t?IDBKeyRange.bound(ac,aa,!ad,!1):IDBKeyRange.bound(aa,ac,!1,!ad)}if(aa){return t?IDBKeyRange.upperBound(aa):IDBKeyRange.lowerBound(aa)}if(ac){return t?IDBKeyRange.lowerBound(ac,!ad):IDBKeyRange.upperBound(ac,!ad)}if(ab){return IDBKeyRange.only(ab)}}catch(af){return{error:af}}return null}function hD(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(er(fV,ac.name,ac.message))}function i2(aa,ac,ad,ab){function t(aD,aj){function ax(aL,aM,aK){var aN=aL.id+"::"+aK;aI.get(aN).onsuccess=function(aO){aM.doc=I(aO.target.result),aD.conflicts&&(aM.doc._conflicts=gs(aL)),hf(aM.doc,aD,au)}}function av(aN,aL,aM){var aO={id:aM.id,key:aM.id,value:{rev:aL}},aK=aM.deleted;if("ok"===aD.deleted){aF.push(aO),aK?(aO.value.deleted=!0,aO.doc=null):aD.include_docs&&ax(aM,aO,aL)}else{if(!aK&&aA--<=0&&(aF.push(aO),aD.include_docs&&ax(aM,aO,aL),0===--aC)){return}}aN["continue"]()}function am(aK){ag=ac._meta.docCount;var aM=aK.target.result;if(aM){var aL=jq(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aq(){aj(null,{total_rows:ag,offset:aD.skip,rows:aF})}function al(){aD.attachments?jn(aF,aD.binary).then(aq):aq()}var aG="startkey" in aD?aD.startkey:!1,ak="endkey" in aD?aD.endkey:!1,aH="key" in aD?aD.key:!1,aA=aD.skip||0,aC="number"==typeof aD.limit?aD.limit:-1,aB=aD.inclusive_end!==!1,ah="descending" in aD&&aD.descending?"prev":null,aE=it(aG,ak,aB,aH,ah);if(aE&&aE.error){return hD(ac,aD,aE.error,aj)}var ay=[gv,g2];aD.attachments&&ay.push(ff);var aw=a7(ad,ay,"readonly");if(aw.error){return aj(aw.error)}var au=aw.txn,ap=au.objectStore(gv),aJ=au.objectStore(g2),az=ah?ap.openCursor(aE,ah):ap.openCursor(aE),aI=aJ.index("_doc_id_rev"),aF=[],ag=0;au.oncomplete=al,az.onsuccess=am}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ac._meta.docCount,offset:ah.skip,rows:[]}):void t(ah,ag)}af(aa,ab)}function jy(t){return new hS(function(ab){var aa=iy([""]);t.objectStore(jx).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function Z(aa,ab){var t=this;gq.queue.push({action:function(ac){iI(t,aa,ac)},callback:ab}),iO(t.constructor)}function iI(ad,ac,ap){function al(au){var av=au.createObjectStore(gv,{keyPath:"id"});au.createObjectStore(g2,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(ff,{keyPath:"digest"}),au.createObjectStore(E,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jx),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(hJ,{keyPath:"_id"});var aw=au.createObjectStore(h6,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(au,av){var aw=au.objectStore(gv);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=jE(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function aq(au){au.createObjectStore(hJ,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function af(ay,aw){var ax=ay.objectStore(hJ),av=ay.objectStore(gv),az=ay.objectStore(g2),au=av.openCursor();au.onsuccess=function(aF){var aI=aF.target.result;if(aI){var aC=aI.value,aL=aC.id,aA=gz(aL),aD=hB(aC);if(aA){var aG=aL+"::"+aD,aJ=aL+"::",aE=aL+"::~",aH=az.index("_doc_id_rev"),aK=IDBKeyRange.bound(aJ,aE,!1,!1),aB=aH.openCursor(aK);aB.onsuccess=function(aN){if(aB=aN.target.result){var aM=aB.value;aM._doc_id_rev===aG&&ax.put(aM),az["delete"](aB.primaryKey),aB["continue"]()}else{av["delete"](aI.primaryKey),aI["continue"]()}}}else{aI["continue"]()}}else{aw&&aw()}}}function aj(au){var av=au.createObjectStore(h6,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ah(ay,aw){var ax=ay.objectStore(g2),av=ay.objectStore(ff),az=ay.objectStore(h6),au=av.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ax.openCursor().onsuccess=function(aJ){var aD=aJ.target.result;if(!aD){return aw()}for(var aE=aD.value,aL=aD.primaryKey,aH=Object.keys(aE._attachments||{}),aF={},aG=0;aG<aH.length;aG++){var aI=aE._attachments[aH[aG]];aF[aI.digest]=!0}var aK=Object.keys(aF);for(aG=0;aG<aK.length;aG++){var aC=aK[aG];az.put({seq:aL,digestSeq:aC+"::"+aL})}aD["continue"]()}):aw()}}function ab(aw){function av(az){return az.data?jq(az):(az.deleted="1"===az.deletedOrLocal,az)}var ax=aw.objectStore(g2),ay=aw.objectStore(gv),au=ay.openCursor();au.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=ax.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=dt(az,az.winningRev,az.deleted),aF=ay.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=av(aA.value);return az.winningRev=az.winningRev||hB(az),az.seq?aD():void aB()}}}var am=ac.name,aa=null;ad._meta=null,ad.type=function(){return"idb"},ad._id=fZ(function(au){au(null,ad._meta.instanceId)}),ad._bulkDocs=function(aw,av,au){ji(ac,aw,av,ad,aa,hm,au)},ad._get=function(az,av,aw){function aB(){aw(ay,{doc:aA,metadata:aC,ctx:au})}var aA,aC,ay,au=av.ctx;if(!au){var ax=a7(aa,[gv,g2,ff],"readonly");if(ax.error){return aw(ax.error)}au=ax.txn}au.objectStore(gv).get(az).onsuccess=function(aG){if(aC=jq(aG.target.result),!aC){return ay=er(gB,"missing"),aB()}if(jE(aC)&&!av.rev){return ay=er(gB,"deleted"),aB()}var aE=au.objectStore(g2),aD=av.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=I(aA)),aA?void aB():(ay=er(gB,"missing"),aB())}}},ad._getAttachment=function(az,av,aw,aB,aA){var aC;if(aB.ctx){aC=aB.ctx}else{var ay=a7(aa,[gv,g2,ff],"readonly");if(ay.error){return aA(ay.error)}aC=ay.txn}var au=aw.digest,ax=aw.content_type;aC.objectStore(ff).get(au).onsuccess=function(aE){var aD=aE.target.result.body;jl(aD,ax,aB.binary,function(aF){aA(null,aF)})}},ad._info=function(av){if(null===aa||!gQ.has(am)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var ax,aw,az=a7(aa,[g2],"readonly");if(az.error){return av(az.error)}var ay=az.txn,au=ay.objectStore(g2).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,aw=ad._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:ax,idb_attachment_format:ad._meta.blobSupport?"binary":"base64"})}},ad._allDocs=function(av,au){i2(av,ad,aa,au)},ad._changes=function(aK){function aB(aS){function aM(){return aN.seq!==aR?aS["continue"]():(au=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=az.get(aU);aT.onsuccess=function(aV){aO(I(aV.target.result))}}function aO(aU){var aT=aK.processChange(aU,aN,aK);aT.seq=aN.seq;var aV=aA(aT);return"object"==typeof aV?aK.complete(aV):(aV&&(aG++,aH&&aE.push(aT),aK.attachments&&aK.include_docs?hf(aU,aK,aJ,function(){jn([aT],aK.binary).then(function(){aK.onChange(aT)})}):aK.onChange(aT)),void (aG!==av&&aS["continue"]()))}var aQ=I(aS.value),aR=aS.key;if(ax&&!ax.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aC.get(aQ._id).onsuccess=function(aT){aN=jq(aT.target.result),ay.set(aQ._id,aN),aM()})}function aw(aN){var aM=aN.target.result;aM&&aB(aM)}function aI(){var aM=[gv,g2];aK.attachments&&aM.push(ff);var aN=a7(aa,aM,"readonly");if(aN.error){return aK.complete(aN.error)}aJ=aN.txn,aJ.onabort=jD(aK.complete),aJ.oncomplete=aL,aD=aJ.objectStore(g2),aC=aJ.objectStore(gv),az=aD.index("_doc_id_rev");var aO;aO=aK.descending?aD.openCursor(null,"prev"):aD.openCursor(IDBKeyRange.lowerBound(aK.since,!0)),aO.onsuccess=aw}function aL(){function aM(){aK.complete(null,{results:aE,last_seq:au})}!aK.continuous&&aK.attachments?jn(aE).then(aM):aM()}if(aK=jd(aK),aK.continuous){var aF=am+":"+gO();return hm.addListener(am,aF,ad,aK),hm.notify(am),{cancel:function(){hm.removeListener(am,aF)}}}var ax=aK.doc_ids&&new ju.Set(aK.doc_ids);aK.since=aK.since||0;var au=aK.since,av="limit" in aK?aK.limit:-1;0===av&&(av=1);var aH;aH="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aJ,aD,aC,az,aE=[],aG=0,aA=hn(aK),ay=new ju.Map;aI()},ad._close=function(au){return null===aa?au(er(iX)):(aa.close(),gQ["delete"](am),aa=null,void au())},ad._getRevisionTree=function(aw,av){var ax=a7(aa,[gv],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,au=ay.objectStore(gv).get(aw);au.onsuccess=function(aA){var az=jq(aA.target.result);az?av(null,az.rev_tree):av(er(gB))}},ad._doCompaction=function(aA,av,aw){var au=[gv,g2,ff,h6],ax=a7(aa,au,"readwrite");if(ax.error){return aw(ax.error)}var az=ax.txn,ay=az.objectStore(gv);ay.get(aA).onsuccess=function(aC){var aE=jq(aC.target.result);fa(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),jk(av,aA,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(gv).put(dt(aE,aD,aB))},az.onabort=jD(aw),az.oncomplete=function(){aw()}},ad._getLocal=function(aw,av){var ax=a7(aa,[hJ],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,au=ay.objectStore(hJ).get(aw);au.onerror=jD(av),au.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,av(null,az)):av(er(gB))}},ad._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=a7(aa,[hJ],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=jD(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(hJ);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(er(hi))}}):(au=ax.add(ay),au.onerror=function(aE){av(er(hi)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ad._removeLocal=function(az,av,aw){"function"==typeof av&&(aw=av,av={});var aB=av.ctx;if(!aB){var aA=a7(aa,[hJ],"readwrite");if(aA.error){return aw(aA.error)}aB=aA.txn,aB.oncomplete=function(){aC&&aw(null,aC)}}var aC,ay=az._id,au=aB.objectStore(hJ),ax=au.get(ay);ax.onerror=jD(aw),ax.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===az._rev?(au["delete"](ay),aC={ok:!0,id:ay,rev:"0-0"},av.ctx&&aw(null,aC)):aw(er(gB))}},ad._destroy=function(aw,au){hm.removeAllListeners(am);var av=a6.get(am);av&&av.result&&(av.result.close(),gQ["delete"](am));var ax=indexedDB.deleteDatabase(am);ax.onsuccess=function(){a6["delete"](am),gf()&&am in localStorage&&delete localStorage[am],au(null,{ok:!0})},ax.onerror=jD(au)};var ag=gQ.get(am);if(ag){return aa=ag.idb,ad._meta=ag.global,void di.nextTick(function(){ap(null,ad)})}var t;t=ac.storage?y(am,ac.storage):indexedDB.open(am,gu),a6.set(am,t),t.onupgradeneeded=function(aw){function ay(){var aA=az[au-1];au++,aA&&aA(ax,ay)}var av=aw.target.result;if(aw.oldVersion<1){return al(av)}var ax=aw.currentTarget.transaction;aw.oldVersion<3&&aq(av),aw.oldVersion<4&&aj(av);var az=[ak,af,ah,ab],au=aw.oldVersion;ay()},t.onsuccess=function(av){aa=av.target.result,aa.onversionchange=function(){aa.close(),gQ["delete"](am)},aa.onabort=function(aA){go("error","Database has a global failure",aA.target.error),aa.close(),gQ["delete"](am)};var ax=aa.transaction([E,jx,gv],"readwrite"),az=ax.objectStore(E).get(E),aw=null,ay=null,au=null;az.onsuccess=function(aB){var aD=function(){null!==aw&&null!==ay&&null!==au&&(ad._meta={name:am,instanceId:au,blobSupport:aw,docCount:ay},gQ.set(am,{idb:aa,global:ad._meta}),ap(null,ad))},aA=aB.target.result||{id:E};am+"_id" in aA?(au=aA[am+"_id"],aD()):(au=gO(),aA[am+"_id"]=au,ax.objectStore(E).put(aA).onsuccess=function(){aD()}),i4||(i4=jy(ax)),i4.then(function(aE){aw=aE,aD()});var aC=ax.objectStore(gv).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ay=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";go("error",au),ap(er(fV,au))}}function y(aa,ab){try{return indexedDB.open(aa,{version:gu,storage:ab})}catch(t){return indexedDB.open(aa,gu)}}function iH(t){t.adapter("idb",Z,!0)}function iw(t){return decodeURIComponent(escape(t))}function jc(t){return 65>t?t-48:t-55}function hq(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(jc(t.charCodeAt(ab++))<<4|jc(t.charCodeAt(ab++)))}return aa}function js(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(jc(t.charCodeAt(ab+2))<<12|jc(t.charCodeAt(ab+3))<<8|jc(t.charCodeAt(ab))<<4|jc(t.charCodeAt(ab+1))),ab+=4}return aa}function hk(aa,t){return"UTF-8"===t?iw(hq(aa,0,aa.length)):js(aa,0,aa.length)}function ig(t){return"'"+t+"'"}function ib(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function id(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jh(t){return delete t._id,delete t._rev,JSON.stringify(t)}function gj(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function gr(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function il(aa,ac,ad,ab,t){return"SELECT "+aa+" FROM "+("string"==typeof ac?ac:ac.join(" JOIN "))+(ad?" ON "+ad:"")+(ab?" WHERE "+("string"==typeof ab?ab:ab.join(" AND ")):"")+(t?" ORDER BY "+t:"")}function jf(t,ab,ag){function aa(){++ac===t.length&&ad()}function ad(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+a2+" WHERE seq IN "+gr(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+a2+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+a2+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new ju.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+a2+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+gZ+" WHERE digest=?",[az]))})})})}})}}if(t.length){var ac=0,af=[];t.forEach(function(aj){var ah="SELECT seq FROM "+gS+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ab,aj],function(al,am){if(!am.rows.length){return aa()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+gS+" WHERE seq=?",[ak],aa)})})}}function en(t){return function(ad){go("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(er(gx,ab,ac))}}function hT(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function gn(ag,al,av,az,ax,ab,aA){function aB(){return ah?aA(ah):(ab.notify(az._name),az._docCount=-1,void aA(null,am))}function aw(aD,aE){var aC="SELECT count(*) as cnt FROM "+gZ+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=er(hM,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function af(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aw(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ad(aO,aG,aL,aQ,aD,aJ,aE,aH){function aM(){function aS(bc,bb){function ba(){return ++bd===bf.length&&bb(),!1}function aZ(bi){var bh="INSERT INTO "+a2+" (digest, seq) VALUES (?,?)",bj=[aT._attachments[bi].digest,bc];ap.executeSql(bh,bj,ba,ba)}var bd=0,bf=Object.keys(aT._attachments||{});if(!bf.length){return bb()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aT=aO.data,aY=aQ?1:0,aV=aT._id,aR=aT._rev,aX=jh(aT),aW="INSERT INTO "+gS+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aU=[aV,aR,aX,aY];ap.executeSql(aW,aU,function(bb,aZ){var ba=aZ.insertId;aS(ba,function(){aN(bb,ba)})},function(){var aZ=il("seq",gS,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aV,aR],function(bc,bb){var bf=bb.rows.item(0).seq,bd="UPDATE "+gS+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aX,aY,aV,aR];bc.executeSql(bd,ba,function(bg){aS(bf,function(){aN(bg,bf)})})}),!1})}function aP(aR){aC||(aR?(aC=aR,aH(aC)):aI===aK.length&&aM())}function aF(aR){aI++,aP(aR)}function aN(aR,aS){var aW=aO.metadata.id,aX=aO.stemmedRevs||[];aD&&az.auto_compaction&&(aX=iT(aO.metadata).concat(aX)),aX.length&&jf(aX,aW,aR),aO.metadata.seq=aS,delete aO.metadata.rev;var aV=aD?"UPDATE "+jz+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+gS+" WHERE doc_id="+jz+".id AND rev=?) WHERE id=?":"INSERT INTO "+jz+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aU=i3(aO.metadata),aT=aD?[aU,aS,aG,aW]:[aW,aS,aS,aU];aR.executeSql(aV,aT,function(){am[aE]={ok:!0,id:aO.metadata.id,rev:aG},ac.set(aW,aO.metadata),aH()})}var aC=null,aI=0;aO.data._id=aO.metadata.id,aO.data._rev=aO.metadata.rev;var aK=Object.keys(aO.data._attachments||{});aQ&&(aO.data._deleted=!0),aK.forEach(function(aU){var aS=aO.data._attachments[aU];if(aS.stub){aI++,aP()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aG,10);var aT=aS.digest;ak(aT,aR,aF)}}),aK.length||aM()}function t(){ix(ag.revs_limit,aq,az,ac,ap,am,ad,av)}function au(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&gz(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+jz+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=hL(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function ak(aD,aF,aC){var aE="SELECT digest FROM "+gZ+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+gZ+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,ib(aF)],function(){aC()},function(){return aC(),!1}))})}var aa=av.new_edits,aj=al.docs,aq=aj.map(function(aC){if(aC._id&&gz(aC._id)){return aC}var aD=gI(aC,aa);return aD}),ay=aq.filter(function(aC){return aC.error});if(ay.length){return aA(ay[0])}var ap,ah,am=new Array(aq.length),ac=new ju.Map;a8(aq,"binary",function(aC){return aC?aA(aC):void ax.transaction(function(aD){ap=aD,af(function(aE){aE?ah=aE:au(t)})},en(aA),aB)})}function ie(t){return t.websql(t.name,t.version,t.description,t.size)}function hQ(aa){try{return{db:ie(aa)}}catch(t){return{error:t}}}function J(aa){var t=ft.get(aa.name);return t||(t=hQ(aa),ft.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function hW(ah,af,aa,ad,t){function aj(){++ab===ac.length&&t&&t()}function ag(am,ak){var al=am._attachments[ak],ap={binary:af.binary,ctx:ad};aa._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=Q.extend(ga(al,["digest","content_type"]),{data:au}),aj()})}var ac=Object.keys(ah._attachments||{});if(!ac.length){return t&&t()}var ab=0;ac.forEach(function(ak){af.attachments&&af.include_docs?ag(ah,ak):(ah._attachments[ak].stub=!0,aj())})}function gA(ad,ay){function aa(){gf()&&(window.localStorage["_pouch__websqldb_"+ag._name]=!0),ay(null,ag)}function aw(aD,aE){aD.executeSql(gH),aD.executeSql("ALTER TABLE "+gS+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(f),aD.executeSql("ALTER TABLE "+jz+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+jz+" (local, id)");var aF="SELECT "+jz+".winningseq AS seq, "+jz+".json AS metadata FROM "+gS+" JOIN "+jz+" ON "+gS+".seq = "+jz+".winningseq";aD.executeSql(aF,[],function(aM,aI){for(var aN=[],aK=[],aJ=0;aJ<aI.rows.length;aJ++){var aH=aI.rows.item(aJ),aG=aH.seq,aL=JSON.parse(aH.metadata);jE(aL)&&aN.push(aG),gz(aL.id)&&aK.push(aL.id)}aM.executeSql("UPDATE "+jz+"SET local = 1 WHERE id IN "+gr(aK.length),aK,function(){aM.executeSql("UPDATE "+gS+" SET deleted = 1 WHERE seq IN "+gr(aN.length),aN,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hV+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+jz+".id AS id, "+gS+".json AS data FROM "+gS+" JOIN "+jz+" ON "+gS+".seq = "+jz+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aH,aK){function aI(){if(!aL.length){return aF(aH)}var aM=aL.shift(),aN=JSON.parse(aM.data)._rev;aH.executeSql("INSERT INTO "+hV+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+jz+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+gS+" WHERE seq=?",[aM.seq],function(){aI()})})})}for(var aL=[],aJ=0;aJ<aK.rows.length;aJ++){aL.push(aK.rows.item(aJ))}aI()})})}function aC(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aJ=aI.shift(),aL=hk(aJ.hex,ab),aO=aL.lastIndexOf("::"),aK=aL.substring(0,aO),aM=aL.substring(aO+2),aN="UPDATE "+gS+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aN,[aK,aM,aL],function(){aH()})}aH()}var aF="ALTER TABLE "+gS+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+gS+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(ir,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+gS;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function t(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+gZ;aH.executeSql(aI,[],function(aK,aO){function aL(){var aP=il(K+", "+jz+".id AS id",[jz,gS],jv,null,jz+".id ");aP+=" LIMIT "+aN+" OFFSET "+aM,aM+=aN,aK.executeSql(aP,[],function(ba,aT){function aY(bc,bd){var bf=aQ[bc]=aQ[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aT.rows.length){return aG(ba)}for(var aQ={},aW=0;aW<aT.rows.length;aW++){for(var aU=aT.rows.item(aW),aV=gj(aU.data,aU.id,aU.rev),aZ=Object.keys(aV._attachments||{}),aX=0;aX<aZ.length;aX++){var aS=aV._attachments[aZ[aX]];aY(aS.digest,aU.seq)}}var aR=[];if(Object.keys(aQ).forEach(function(bc){var bd=aQ[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aL()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+a2+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aL()})})})}var aJ=aO.rows.item(0).cnt;if(!aJ){return aG(aK)}var aM=0,aN=10;aL()})}var aF="CREATE TABLE IF NOT EXISTS "+a2+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(T,[],function(aI){aI.executeSql(hp,[],aD)})})}function am(aE,aF){var aD="ALTER TABLE "+gZ+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ak(aE,aF){var aD="ALTER TABLE "+jz+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+jz+" SET max_seq=(SELECT MAX(seq) FROM "+gS+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+jz+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ah(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ab=2===aG.length?"UTF-8":"UTF-16",aE()})}function ac(){for(;ax.length>0;){var aD=ax.pop();aD(null,az)}}function aj(aL,aD){if(0===aD){var aG="CREATE TABLE IF NOT EXISTS "+i0+" (dbid, db_version INTEGER)",aJ="CREATE TABLE IF NOT EXISTS "+gZ+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aM="CREATE TABLE IF NOT EXISTS "+a2+" (digest, seq INTEGER)",aO="CREATE TABLE IF NOT EXISTS "+jz+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aN="CREATE TABLE IF NOT EXISTS "+gS+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aH="CREATE TABLE IF NOT EXISTS "+hV+" (id UNIQUE, rev, json)";aL.executeSql(aJ),aL.executeSql(aH),aL.executeSql(aM,[],function(){aL.executeSql(hp),aL.executeSql(T)}),aL.executeSql(aO,[],function(){aL.executeSql(gH),aL.executeSql(aN,[],function(){aL.executeSql(f),aL.executeSql(ir),aL.executeSql(aG,[],function(){var aP="INSERT INTO "+i0+" (db_version, dbid) VALUES (?,?)";az=gO();var aQ=[hb,az];aL.executeSql(aP,aQ,function(){ac()})})})})}else{var aF=function(){var aQ=hb>aD;aQ&&aL.executeSql("UPDATE "+i0+" SET db_version = "+hb);var aP="SELECT dbid FROM "+i0;aL.executeSql(aP,[],function(aR,aS){az=aS.rows.item(0).dbid,ac()})},aI=[aw,aq,aC,t,am,ak,aF],aK=aD,aE=function(aP){aI[aK-1](aP,aE),aK++};aE(aL)}}function au(){al.transaction(function(aD){ah(aD,function(){ap(aD)})},en(ay),aa)}function ap(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+i0;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+i0,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;aj(aI,aH)}):aF.executeSql("ALTER TABLE "+i0+" ADD COLUMN db_version INTEGER",[],function(){aj(aF,1)}):aj(aF,0)})}function aB(aE,aF){if(-1!==ag._docCount){return aF(ag._docCount)}var aD=il("COUNT("+jz+".id) AS 'num'",[jz,gS],jv,gS+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ag._docCount=aH.rows.item(0).num,aF(ag._docCount)})}var ab,ag=this,az=null,av=hT(ad),ax=[];ag._docCount=-1,ag._name=ad.name;var aA=Q.extend({},ad,{version:iR,description:ad.name,size:av}),af=J(aA);if(af.error){return en(ay)(af.error)}var al=af.db;"function"!=typeof al.readTransaction&&(al.readTransaction=al.transaction),au(),ag.type=function(){return"websql"},ag._id=fZ(function(aD){aD(null,az)}),ag._info=function(aD){al.readTransaction(function(aE){aB(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+gS;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:al._sqlitePlugin,websql_encoding:ab})})})},en(aD))},ag._bulkDocs=function(aF,aD,aE){gn(ad,aF,aD,ag,al,B,aE)},ag._get=function(aG,aF,aI){function aL(){aI(aD,{doc:aK,metadata:aH,ctx:aJ})}var aK,aH,aD,aJ=aF.ctx;if(!aJ){return al.readTransaction(function(aN){ag._get(aG,Q.extend({ctx:aN},aF),aI)})}var aM,aE;aF.rev?(aM=il(K,[jz,gS],jz+".id="+gS+".doc_id",[gS+".doc_id=?",gS+".rev=?"]),aE=[aG,aF.rev]):(aM=il(K,[jz,gS],jv,jz+".id=?"),aE=[aG]),aJ.executeSql(aM,aE,function(aP,aO){if(!aO.rows.length){return aD=er(gB,"missing"),aL()}var aN=aO.rows.item(0);return aH=hL(aN.metadata),aN.deleted&&!aF.rev?(aD=er(gB,"deleted"),aL()):(aK=gj(aN.data,aH.id,aN.rev),void aL())})},ag._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(jz+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(jz+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(jz+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(jz+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(gS+".deleted = 0"),al.readTransaction(function(aR){aB(aR,function(aT){if(aM=aT,0!==aO){var aS=il(K,[jz,gS],jv,aE,jz+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aU,ba){for(var bb=0,aX=ba.rows.length;aX>bb;bb++){var aV=ba.rows.item(bb),bc=hL(aV.metadata),aY=bc.id,aW=gj(aV.data,aY,aV.rev),aZ=aW._rev,bd={id:aY,key:aY,value:{rev:aZ}};if(aJ.include_docs&&(bd.doc=aW,bd.doc._rev=aZ,aJ.conflicts&&(bd.doc._conflicts=gs(bc)),hW(bd.doc,aJ,ag,aU)),aV.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},en(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},ag._changes=function(aF){function aE(){var aN=jz+".json AS metadata, "+jz+".max_seq AS maxSeq, "+gS+".json AS winningDoc, "+gS+".rev AS winningRev ",aM=jz+" JOIN "+gS,aO=jz+".id="+gS+".doc_id AND "+jz+".winningseq="+gS+".seq",aP=["maxSeq > ?"],aR=[aF.since];aF.doc_ids&&(aP.push(jz+".id IN "+gr(aF.doc_ids.length)),aR=aR.concat(aF.doc_ids));var aL="maxSeq "+(aI?"DESC":"ASC"),aS=il(aN,aM,aO,aP,aL),aT=hn(aF);aF.view||aF.filter||(aS+=" LIMIT "+aD);var aQ=aF.since||0;al.readTransaction(function(aU){aU.executeSql(aS,aR,function(bc,bb){function bd(bg){return function(){aF.onChange(bg)}}for(var aX=0,aY=bb.rows.length;aY>aX;aX++){var ba=bb.rows.item(aX),aZ=hL(ba.metadata);aQ=ba.maxSeq;var bf=gj(ba.winningDoc,aZ.id,ba.winningRev),aV=aF.processChange(bf,aZ,aF);aV.seq=ba.maxSeq;var aW=aT(aV);if("object"==typeof aW){return aF.complete(aW)}if(aW&&(aJ++,aG&&aH.push(aV),aF.attachments&&aF.include_docs?hW(bf,aF,ag,bc,bd(aV)):bd(aV)()),aJ===aD){break}}})},en(aF.complete),function(){aF.continuous||aF.complete(null,{results:aH,last_seq:aQ})})}if(aF=jd(aF),aF.continuous){var aK=ag._name+":"+gO();return B.addListener(ag._name,aK,ag,aF),B.notify(ag._name),{cancel:function(){B.removeListener(ag._name,aK)}}}var aI=aF.descending;aF.since=aF.since&&!aI?aF.since:0;var aD="limit" in aF?aF.limit:-1;0===aD&&(aD=1);var aG;aG="return_docs" in aF?aF.return_docs:"returnDocs" in aF?aF.returnDocs:!0;var aH=[],aJ=0;aE()},ag._close=function(aD){aD()},ag._getAttachment=function(aG,aF,aI,aL,aK){var aH,aD=aL.ctx,aJ=aI.digest,aM=aI.content_type,aE="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+gZ+" WHERE digest=?";aD.executeSql(aE,[aJ],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?id(aO.body):hk(aO.body,ab);aH=aL.binary?jA(aN,aM):h8(aN),aK(null,aH)})},ag._getRevisionTree=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+jz+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=hL(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(er(gB))}})})},ag._doCompaction=function(aE,aF,aD){return aF.length?void al.transaction(function(aH){var aG="SELECT json AS metadata FROM "+jz+" WHERE id = ?";aH.executeSql(aG,[aE],function(aL,aJ){var aI=hL(aJ.rows.item(0).metadata);fa(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+jz+" SET json = ? WHERE id = ?";aL.executeSql(aK,[i3(aI),aE])}),jf(aF,aE,aH)},en(aD),function(){aD()}):aD()},ag._getLocal=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hV+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=gj(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(er(gB))}})})},ag._putLocal=function(aJ,aF,aL){function aE(aO){var aM,aN;aK?(aM="UPDATE "+hV+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aD,aG,aH,aK]):(aM="INSERT INTO "+hV+" (id, rev, json) VALUES (?,?,?)",aN=[aH,aD,aG]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aI={ok:!0,id:aH,rev:aD},aF.ctx&&aL(null,aI)):aL(er(hi))},function(){return aL(er(hi)),!1})}"function"==typeof aF&&(aL=aF,aF={}),delete aJ._revisions;var aD,aK=aJ._rev,aH=aJ._id;aD=aK?aJ._rev="0-"+(parseInt(aK.split("-")[1],10)+1):aJ._rev="0-1";var aI,aG=jh(aJ);aF.ctx?aE(aF.ctx):al.transaction(aE,en(aL),function(){aI&&aL(null,aI)})},ag._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+hV+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(er(gB))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):al.transaction(aF,en(aH),function(){aD&&aH(null,aD)})},ag._destroy=function(aD,aE){B.removeAllListeners(ag._name),al.transaction(function(aF){var aG=[jz,gS,gZ,i0,hV,a2];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},en(aE),function(){gf()&&(delete window.localStorage["_pouch__websqldb_"+ag._name],delete window.localStorage[ag._name]),aE(null,{ok:!0})})}}function P(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function ha(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var aa=gf(),ab="_pouch__websqldb_valid_"+navigator.userAgent;if(aa&&localStorage[ab]){return"1"===localStorage[ab]}var t=P();return aa&&(localStorage[ab]=t?"1":"0"),t}function a4(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:ha()}function iD(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=Q.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function fg(t,ab){var ac=iD(t),aa=Q.extend({websql:ac},t);gA.call(this,aa,ab)}function fr(t){t.adapter("websql",fg,!0)}function g6(){for(var t={},ab=new hS(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,hS.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function an(t,ab){var ag,aa,ad,ac=new Headers,af={method:t.method,credentials:"include",headers:ac};return t.json&&(ac.set("Accept","application/json"),ac.set("Content-Type",t.headers["Content-Type"]||"application/json")),t.body&&t.body instanceof Blob?ja(t.body,function(ah){af.body=ah}):t.body&&t.processData&&"string"!=typeof t.body?af.body=JSON.stringify(t.body):"body" in t?af.body=t.body:af.body=null,Object.keys(t.headers).forEach(function(ah){t.headers.hasOwnProperty(ah)&&ac.set(ah,t.headers[ah])}),ag=g6(t.url,af),t.timeout>0&&(aa=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+t.url))},t.timeout)),ag.promise.then(function(ah){return ad={statusCode:ah.status},t.timeout>0&&clearTimeout(aa),ad.statusCode>=200&&ad.statusCode<300?t.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ad.statusCode>=200&&ad.statusCode<300?ab(null,ad,ah):ab(ah,ad)})["catch"](function(ah){ab(ah,ad)}),{abort:ag.reject}}function iN(ah,af){var aa,ad,t=!1,aj=function(){aa.abort()},ag=function(){t=!0,aa.abort()};aa=ah.xhr?new ah.xhr:new XMLHttpRequest;try{aa.open(ah.method,ah.url)}catch(ac){af(ac,{statusCode:413})}aa.withCredentials="withCredentials" in ah?ah.withCredentials:!0,"GET"===ah.method?delete ah.headers["Content-Type"]:ah.json&&(ah.headers.Accept="application/json",ah.headers["Content-Type"]=ah.headers["Content-Type"]||"application/json",ah.body&&ah.processData&&"string"!=typeof ah.body&&(ah.body=JSON.stringify(ah.body))),ah.binary&&(aa.responseType="arraybuffer"),"body" in ah||(ah.body=null);for(var ab in ah.headers){ah.headers.hasOwnProperty(ab)&&aa.setRequestHeader(ab,ah.headers[ab])}return ah.timeout>0&&(ad=setTimeout(ag,ah.timeout),aa.onprogress=function(){clearTimeout(ad),4!==aa.readyState&&(ad=setTimeout(ag,ah.timeout))},"undefined"!=typeof aa.upload&&(aa.upload.onprogress=aa.onprogress)),aa.onreadystatechange=function(){if(4===aa.readyState){var ak={statusCode:aa.status};if(aa.status>=200&&aa.status<300){var am;am=ah.binary?iy([aa.response||""],{type:aa.getResponseHeader("Content-Type")}):aa.responseText,af(null,ak,am)}else{var ap={};if(t){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(aa.response)}catch(al){}}af(ap,ak)}}},ah.body&&ah.body instanceof Blob?ja(ah.body,function(ak){aa.send(ak)}):aa.send(ah.body),{abort:aj}}function iz(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function gF(aa,t){return C||aa.xhr?iN(aa,t):an(aa,t)}function ev(){return""}function r(aa,ac){function ad(af,ag,aj){if(!aa.binary&&aa.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?ih(ak):ak})),aa.binary&&jr(af,ag),aj(null,af,ag)}function ab(ag,aj){var al,ah;if(ag.code&&ag.status){var af=new Error(ag.message||ag.code);return af.status=ag.status,aj(af)}if(ag.message&&"ETIMEDOUT"===ag.message){return aj(ag)}try{al=JSON.parse(ag.responseText),ah=ih(al)}catch(ak){ah=ih(ag)}aj(ah)}aa=jd(aa);var t={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return aa=Q.extend(t,aa),aa.json&&(aa.binary||(aa.headers.Accept="application/json"),aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json"),aa.binary&&(aa.encoding=null,aa.json=!1),aa.processData||(aa.json=!1),gF(aa,function(aj,am,ag){if(aj){return aj.status=am?am.statusCode:400,ab(aj,ac)}var al,af=am.headers&&am.headers["content-type"],ah=ag||ev();if(!aa.binary&&(aa.json||!aa.processData)&&"object"!=typeof ah&&(/json/.test(af)||/^[\s]*\{/.test(ah)&&/\}[\s]*$/.test(ah))){try{ah=JSON.parse(ah.toString())}catch(ak){}}am.statusCode>=200&&am.statusCode<300?ad(ah,am,ac):(al=ih(ah),al.status=am.statusCode,ac(al))})}function fw(ag,ad){var aj=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aa=-1!==aj.indexOf("safari")&&-1===aj.indexOf("chrome"),ak=-1!==aj.indexOf("msie"),ah=-1!==aj.indexOf("edge"),af=aa||(ak||ah)&&"GET"===ag.method,ac="cache" in ag?ag.cache:!0,ab=/^blob:/.test(ag.url);if(!ab&&(af||!ac)){var t=-1!==ag.url.indexOf("?");ag.url+=(t?"&":"?")+"_nonce="+Date.now()}return r(ag,ad)}function ey(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=eu(ab.data,ab.content_type)})}function jg(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function eo(t){return t._attachments&&Object.keys(t._attachments)?hS.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hS(function(ac){hz(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hS.resolve()}function gY(aa){var ab=hH(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function gV(aa,t){return im(aa,aa.db+"/"+t)}function im(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function ip(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function v(aj,ac){function ab(ax,ay,aw){var aA=ax.ajax||{},az=Q.extend(jd(ag),aA,ay);return jb(az.method+" "+az.url),ap._ajax(az,aw)}function ah(ax,aw){return new hS(function(az,ay){ab(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function ak(ax,aw){return iv(ax,h5(function(ay){aq().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aq(){if(aj.skipSetup||aj.skip_setup){return hS.resolve()}if(af){return af}var aw={method:"GET",url:al};return af=ah({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(iC(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:al})):hS.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hS.reject(ax)}),af["catch"](function(){af=null}),af}function aa(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ap=this,au=gY;aj.getHost&&(au=aj.getHost);var ad=au(aj.name,aj),al=gV(ad,"");aj=jd(aj);var ag=aj.ajax||{};if(ap.getUrl=function(){return al},ap.getHeaders=function(){return ag.headers||{}},aj.auth||ad.auth){var av=aj.auth||ad.auth,t=av.username+":"+av.password,am=h8(unescape(encodeURIComponent(t)));ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+am}ap._ajax=fw;var af;setTimeout(function(){ac(null,ap)}),ap.type=function(){return"http"},ap.id=ak("id",function(aw){ab({},{method:"GET",url:im(ad,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ad.db:gV(ad,"");aw(null,ay)})}),ap.request=ak("request",function(ax,aw){ax.url=gV(ad,ax.url),ab({},ax,aw)}),ap.compact=ak("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=jd(ax),ab(ax,{url:gV(ad,"_compact"),method:"POST"},function(){function ay(){ap.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ap.bulkGet=iv("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ab({},{url:gV(ad,"_bulk_get"+ip(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aI(aK){return function(aM,aL){aF[aK]=aL.results,++aH===aD&&aA(null,{results:H(aF)})}}for(var aE=hu,aD=Math.ceil(aC.docs.length/aE),aH=0,aF=new Array(aD),aG=0;aD>aG;aG++){var aJ=ga(aC,["revs","attachments"]);aJ.ajax=ag,aJ.docs=aC.docs.slice(aG*aE,Math.min(aC.docs.length,(aG+1)*aE)),ee(ay,aJ,aI(aG))}}var ay=this,aw=im(ad,""),az=i9[aw];"boolean"!=typeof az?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(i9[aw]=!1,iC(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{i9[aw]=!0,aA(null,aE)}}):az?aB(aA):ax()}),ap._info=function(aw){aq().then(function(){ab({},{method:"GET",url:gV(ad,"")},function(ay,ax){return ay?aw(ay):(ax.host=gV(ad,""),void aw(null,ax))})})["catch"](aw)},ap.get=ak("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hS.all(aF.map(function(aG){var aI=aD[aG],aH=jg(aE._id)+"/"+aa(aG)+"?rev="+aE._rev;return ah(aC,{method:"GET",url:gV(ad,aH),binary:!0}).then(function(aJ){return aC.binary?aJ:new hS(function(aK){hz(aJ,aK)})}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?hS.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=jd(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=jg(aA);var aw={method:"GET",url:gV(ad,aA+ip(az))};ah(aC,aw).then(function(aD){return hS.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ap.remove=ak("remove",function(ax,aB,az,aw){var ay;"string"==typeof aB?(ay={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(ay=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var aA=ay._rev||az.rev;ab(az,{method:"DELETE",url:gV(ad,jg(ay._id))+"?rev="+aA},aw)}),ap.getAttachment=ak("getAttachment",function(ax,az,aB,ay){"function"==typeof aB&&(ay=aB,aB={});var aA=aB.rev?"?rev="+aB.rev:"",aw=gV(ad,jg(ax))+"/"+aa(az)+aA;ab(aB,{method:"GET",url:aw,binary:!0},ay)}),ap.removeAttachment=ak("removeAttachment",function(ax,ay,aA,aw){var az=gV(ad,jg(ax)+"/"+aa(ay))+"?rev="+aA;ab({},{method:"DELETE",url:az},aw)}),ap.putAttachment=ak("putAttachment",function(aA,aw,aF,aE,aC,aG){"function"==typeof aC&&(aG=aC,aC=aE,aE=aF,aF=null);var ax=jg(aA)+"/"+aa(aw),ay=gV(ad,ax);if(aF&&(ay+="?rev="+aF),"string"==typeof aE){var aD;try{aD=hG(aE)}catch(az){return aG(er(gW,"Attachment is not a valid base64 string"))}aE=aD?jA(aD,aC):""}var aB={headers:{"Content-Type":aC},method:"PUT",url:ay,processData:!1,body:aE,timeout:ag.timeout||60000};ab({},aB,aG)}),ap._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,aq().then(function(){return hS.all(aw.docs.map(eo))}).then(function(){ab(ay,{method:"POST",url:gV(ad,"_bulk_docs"),body:aw},function(aA,az){return aA?ax(aA):(az.forEach(function(aB){aB.ok=!0}),void ax(null,az))})})["catch"](ax)},ap.allDocs=ak("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=jd(aA);var aB,ax={},ay="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var aw=ip(ax);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=h9?aw+="&"+az:(ay="POST",aB={keys:aA.keys})}ah(aA,{method:ay,url:gV(ad,"_all_docs"+aw),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ey),aC(null,aD)})["catch"](aC)}),ap._changes=function(aH){var az="batch_size" in aH?aH.batch_size:iL;aH=jd(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ag?ag.timeout:30000;var aB,aw=aH.timeout?{timeout:aH.timeout-5000}:{},aF="undefined"!=typeof aH.limit?aH.limit:!1;aB="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var ay=aF;if(aH.style&&(aw.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aw.include_docs=!0),aH.attachments&&(aw.attachments=!0),aH.continuous&&(aw.feed="longpoll"),aH.conflicts&&(aw.conflicts=!0),aH.descending&&(aw.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aw.heartbeat=aH.heartbeat):aw.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aw.filter=aH.filter),aH.view&&"string"==typeof aH.view&&(aw.filter="_view",aw.view=aH.view),aH.query_params&&"object"==typeof aH.query_params){for(var aD in aH.query_params){aH.query_params.hasOwnProperty(aD)&&(aw[aD]=aH.query_params[aD])}}var aJ,aK="GET";if(aH.doc_ids){aw.filter="_doc_ids";var ax=JSON.stringify(aH.doc_ids);ax.length<h9?aw.doc_ids=ax:(aK="POST",aJ={doc_ids:aH.doc_ids})}var aA,aC,aE=function(aM,aN){if(!aH.aborted){aw.since=aM,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aH.descending?aF&&(aw.limit=ay):aw.limit=!aF||ay>az?az:ay;var aL={method:aK,url:gV(ad,"_changes"+ip(aw)),timeout:aH.timeout,body:aJ};aC=aM,aH.aborted||aq().then(function(){aA=ab(aH,aL,aN)})["catch"](aN)}},aG={results:[]},aI=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aG.last_seq=aL.last_seq;var aP={};aP.query=aH.query_params,aL.results=aL.results.filter(function(aR){ay--;var aQ=hn(aH)(aR);return aQ&&(aH.include_docs&&aH.attachments&&aH.binary&&ey(aR),aB&&aG.results.push(aR),aH.onChange(aR)),aQ})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(aC=aL.last_seq);var aO=aF&&0>=ay||aL&&az>aM||aH.descending;(!aH.continuous||aF&&0>=ay)&&aO?aH.complete(null,aG):setTimeout(function(){aE(aC,aI)},0)}};return aE(aH.since||0,aI),{cancel:function(){aH.aborted=!0,aA&&aA.abort()}}},ap.revsDiff=ak("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),ab(ay,{method:"POST",url:gV(ad,"_revs_diff"),body:aw},ax)}),ap._close=function(aw){aw()},ap._destroy=function(ax,aw){ab(ax,{url:gV(ad,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function fb(t){t.adapter("http",v,!1),t.adapter("https",v,!1)}function j(){this.promise=new hS(function(t){t()})}function ar(af){var ad=af.db,ac=af.viewName,ab=af.map,t=af.reduce,ah=af.temporary,aa=ab.toString()+(t&&t.toString())+"undefined";if(!ah&&ad._cachedViews){var ag=ad._cachedViews[aa];if(ag){return hS.resolve(ag)}}return ad.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ac;-1===aq.indexOf("/")&&(aq=ac+"/"+ac);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ah?"temp":fh(aa));return jB(ad,"_local/mrviews",al).then(function(){return ad.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ad,adapter:ad.adapter,mapFun:ab,reduceFun:t};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ah||(ad._cachedViews=ad._cachedViews||{},ad._cachedViews[aa]=aq,aq.db.once("destroyed",function(){delete ad._cachedViews[aa]})),aq})})})})}function fY(aa,ac,ad,ab,t,af){return je("return ("+aa.replace(/;\s*$/,"")+");",{emit:ac,sum:ad,log:ab,isArray:t,toJSON:af})}function n(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function i1(t){return 1===t.length&&/^1-/.test(t[0].rev)}function u(aa,ab){try{aa.emit("error",ab)}catch(t){go("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),go("error",ab)}}function fj(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return u(t,aa),{error:aa}}}function g7(aa,ab){var t=gm.collate(aa.key,ab.key);return 0!==t?t:gm.collate(aa.value,ab.value)}function br(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function hZ(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function ae(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=eu(ac.data,ac.content_type)})})}function i7(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&ae(aa),aa}}function iE(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new hI(t)}function hd(af){for(var ad=0,ac=0,ab=af.length;ab>ac;ac++){var t=af[ac];if("number"!=typeof t){if(!Array.isArray(t)){throw iE("_sum")}ad="number"==typeof ad?[ad]:ad;for(var ah=0,aa=t.length;aa>ah;ah++){var ag=t[ah];if("number"!=typeof ag){throw iE("_sum")}"undefined"==typeof ad[ah]?ad.push(ag):ad[ah]+=ag}}else{"number"==typeof ad?ad+=t:ad[0]+=t}}return ad}function gw(aa,ac,ad,ab){var t=ac[aa];"undefined"!=typeof t&&(ab&&(t=encodeURIComponent(JSON.stringify(t))),ad.push(aa+"="+t))}function g8(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function gK(t){return t.group_level=g8(t.group_level),t.limit=g8(t.limit),t.skip=g8(t.skip),t}function A(t){if(t){if("number"!=typeof t){return new es('Invalid value for integer: "'+t+'"')}if(0>t){return new es('Invalid value for positive integer: "'+t+'"')}}}function h(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&gm.collate(t[ac],t[aa])>0){throw new es("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new es("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new es("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=A(t[af]);if(ad){throw ad}})}function iQ(ah,af,aa){var ad,t=[],aj="GET";if(gw("reduce",aa,t),gw("include_docs",aa,t),gw("attachments",aa,t),gw("limit",aa,t),gw("descending",aa,t),gw("group",aa,t),gw("group_level",aa,t),gw("skip",aa,t),gw("stale",aa,t),gw("conflicts",aa,t),gw("startkey",aa,t,!0),gw("start_key",aa,t,!0),gw("endkey",aa,t,!0),gw("end_key",aa,t,!0),gw("inclusive_end",aa,t),gw("key",aa,t,!0),t=t.join("&"),t=""===t?"":"?"+t,"undefined"!=typeof aa.keys){var ag=2000,ac="keys="+encodeURIComponent(JSON.stringify(aa.keys));ac.length+t.length+1<=ag?t+=("?"===t[0]?"&":"?")+ac:(aj="POST","string"==typeof af?ad={keys:aa.keys}:af.keys=aa.keys)}if("string"==typeof af){var ab=n(af);return ah.request({method:aj,url:"_design/"+ab[0]+"/_view/"+ab[1]+t,body:ad}).then(i7(aa))}return ad=ad||{},Object.keys(af).forEach(function(ak){Array.isArray(af[ak])?ad[ak]=af[ak]:ad[ak]=af[ak].toString()}),ah.request({method:"POST",url:"_temp_view"+t,body:ad}).then(i7(aa))}function a1(aa,ab,t){return new hS(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function cr(t){return new hS(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function ao(t){return function(aa){if(404===aa.status){return t}throw aa}}function F(al,ag,aa){function ad(){return i1(ab)?hS.resolve(ah):ag.db.get(ak)["catch"](ao(ah))}function af(am){return am.keys.length?ag.db.allDocs({keys:am.keys,include_docs:!0}):hS.resolve({rows:[]})}function ac(au,ap){for(var ay=[],aA={},az=0,ax=ap.rows.length;ax>az;az++){var av=ap.rows[az],am=av.doc;if(am&&(ay.push(am),aA[am._id]=!0,am._deleted=!t[am._id],!am._deleted)){var aq=t[am._id];"value" in aq&&(am.value=aq.value)}}var aw=Object.keys(t);return aw.forEach(function(aD){if(!aA[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),ay.push(aB)}}),au.keys=U(aw.concat(au.keys)),ay.push(au),ay}var ak="_local/doc_"+al,ah={_id:ak,keys:[]},aj=aa[al],t=aj.indexableKeysToKeyValues,ab=aj.changes;return ad().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function x(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](ao({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return hS.all(ad.map(function(ag){return F(ag,t,ab)})).then(function(ah){var ag=H(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function M(aa){var ab="string"==typeof aa?aa:aa.name,t=iG[ab];return t||(t=iG[ab]=new j),t}function gg(t){return fl(M(t),function(){return W(t)})()}function W(ah){function af(am,ak){var al={id:t._id,key:gm.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gm.normalizeKey(ak)),ad.push(al)}function aa(ak,al){return function(){return x(ah,ak,al)}}var ad,t,aj;if("function"==typeof ah.mapFun&&2===ah.mapFun.length){var ag=ah.mapFun;aj=function(ak){return ag(ak,af)}}else{aj=fY(ah.mapFun.toString(),af,hd,hC,Array.isArray,JSON.parse)}var ac=ah.seq||0,ab=new j;return new hS(function(ap,ak){function al(){ab.finish().then(function(){ah.seq=ac,ap()})}function am(){function aq(au){ak(au)}ah.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ac,limit:ic}).on("complete",function(aF){var ax=aF.results;if(!ax.length){return al()}for(var aC={},aA=0,aD=ax.length;aD>aA;aA++){var av=ax[aA];if("_"!==av.doc._id[0]){ad=[],t=av.doc,t._deleted||fj(ah.sourceDB,aj,[t]),ad.sort(g7);for(var au,ay={},aw=0,aE=ad.length;aE>aw;aw++){var aB=ad[aw],az=[aB.key,aB.id];0===gm.collate(aB.key,au)&&az.push(aw);var aG=gm.toIndexableString(az);ay[aG]=aB,au=aB.key}aC[av.doc._id]={indexableKeysToKeyValues:ay,changes:av.changes}}ac=av.seq}return ab.add(aa(aC,ac)),ax.length<ic?al():am()}).on("error",aq)}am()})}function gJ(al,ag,aa){0===aa.group_level&&delete aa.group_level;var ad,af=aa.group||aa.group_level;ad=hh[al.reduceFun]?hh[al.reduceFun]:fY(al.reduceFun.toString(),null,hd,hC,Array.isArray,JSON.parse);var ac=[],ak=isNaN(aa.group_level)?Number.POSITIVE_INFINITY:aa.group_level;ag.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&(ap=ap.slice(0,ak)),am&&0===gm.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ac.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ag=[];for(var ah=0,aj=ac.length;aj>ah;ah++){var t=ac[ah],ab=fj(al.sourceDB,ad,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof hI){throw ab.error}ag.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:br(ag,aa.limit,aa.skip)}}function k(aa,t){return fl(M(aa),function(){return fe(aa,t)})()}function fe(t,ab){function am(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ap=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=gm.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function aa(av){var aq;if(aq=ak?gJ(t,av,ab):{total_rows:ap,offset:ad,rows:av},ab.include_docs){var au=U(av.map(hZ));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:ab.conflicts,attachments:ab.attachments,binary:ab.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=hZ(ay),az=aw["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ap,ak=t.reduceFun&&ab.reduce!==!1,ad=ab.skip||0;if("undefined"==typeof ab.keys||ab.keys.length||(ab.limit=0,delete ab.keys),"undefined"!=typeof ab.keys){var aj=ab.keys,ac=aj.map(function(au){var aq={startkey:gm.toIndexableString([au]),endkey:gm.toIndexableString([au,{}])};return am(aq)});return hS.all(ac).then(H).then(aa)}var af={descending:ab.descending};if(ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"undefined"!=typeof ab.startkey&&(af.startkey=ab.descending?gm.toIndexableString([ab.startkey,{}]):gm.toIndexableString([ab.startkey])),"undefined"!=typeof ab.endkey){var ah=ab.inclusive_end!==!1;ab.descending&&(ah=!ah),af.endkey=gm.toIndexableString(ah?[ab.endkey,{}]:[ab.endkey])}if("undefined"!=typeof ab.key){var al=gm.toIndexableString([ab.key]),ag=gm.toIndexableString([ab.key,{}]);af.descending?(af.endkey=al,af.startkey=ag):(af.startkey=al,af.endkey=ag)}return ak||("number"==typeof ab.limit&&(af.limit=ab.limit),af.skip=ad),am(af).then(aa)}function gR(t){return t.request({method:"POST",url:"_view_cleanup"})}function ai(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=n(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return fl(M(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hS.all(af).then(function(){return{ok:!0}})})},ao({ok:!0}))}function de(t,ag,af){if("http"===t.type()){return iQ(t,ag,af)}if("function"==typeof t._query){return a1(t,ag,af)}if("string"!=typeof ag){h(af,ag);var ac={db:t,viewName:"temp_view/temp_view",map:ag.map,reduce:ag.reduce,temporary:!0};return jp.add(function(){return ar(ac).then(function(ak){function aj(){return ak.db.destroy()}return ce(gg(ak).then(function(){return k(ak,af)}),aj)})}),jp.finish()}var ad=ag,aa=n(ad),ab=aa[0],ah=aa[1];return t.get("_design/"+ab).then(function(al){var ak=al.views&&al.views[ah];if(!ak||"string"!=typeof ak.map){throw new i("ddoc "+ab+" has no view named "+ah)}h(af,ak);var aj={db:t,viewName:ad,map:ak.map,reduce:ak.reduce};return ar(aj).then(function(am){return"ok"===af.stale||"update_after"===af.stale?("update_after"===af.stale&&di.nextTick(function(){gg(am)}),k(am,af)):gg(am).then(function(){return k(am,af)})})})}function es(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,es)}catch(t){}}function i(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,i)}catch(t){}}function hI(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,hI)}catch(t){}}function X(t){return/^1-/.test(t)}function fs(aa,ab,t){return !aa._attachments||!aa._attachments[t]||aa._attachments[t].digest!==ab._attachments[t].digest}function iF(aa,ab){var t=Object.keys(ab._attachments);return hS.all(t.map(function(ac){return aa.getAttachment(ab._id,ac,{rev:ab._rev})}))}function h4(aa,ac,ad){var ab="http"===ac.type()&&"http"!==aa.type(),t=Object.keys(ad._attachments);return ab?aa.get(ad._id).then(function(af){return hS.all(t.map(function(ag){return fs(af,ad,ag)?ac.getAttachment(ad._id,ag):aa.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return iF(ac,ad)}):iF(ac,ad)}function hO(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function N(aa,ah,ac,af){function ad(){var am=hO(ac);if(am.docs.length){return aa.bulkGet(am).then(function(ap){if(af.cancelled){throw new Error("cancelled")}return hS.all(ap.results.map(function(aq){return hS.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?h4(ah,aa,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(H(aq).filter(Boolean))})})}}function al(am){return am._attachments&&Object.keys(am._attachments).length>0}function ak(am){return aa.allDocs({keys:am,include_docs:!0}).then(function(ap){if(af.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&X(aq.value.rev)&&!al(aq.doc)&&(t.push(aq.doc),delete ac[aq.id])})})}function ag(){var am=Object.keys(ac).filter(function(aq){var ap=ac[aq].missing;return 1===ap.length&&X(ap[0])});return am.length>0?ak(am):void 0}function aj(){return{ok:ab,docs:t}}ac=jd(ac);var t=[],ab=!0;return hS.resolve().then(ag).then(ad).then(aj)}function i8(aa,ac,ad,ab,t){return aa.get(ac)["catch"](function(af){if(404===af.status){return"http"===aa.type()&&iC(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ab,_id:ac,history:[],replicator:gU,version:p}}throw af}).then(function(af){return t.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ab}),af.history.unshift({last_seq:ad,session_id:ab}),af.history=af.history.slice(0,fk),af.version=p,af.replicator=gU,af.session_id=ab,af.last_seq=ad,aa.put(af)["catch"](function(ag){if(409===ag.status){return i8(aa,ac,ad,ab,t)}throw ag}))})}function iZ(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function hK(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:gb(aa.history,t.history)}function gb(af,ad){var ac=af[0],ab=af.slice(1),t=ad[0],ah=ad.slice(1);if(!ac||0===ad.length){return{last_seq:jj,history:[]}}var aa=ac.session_id;if(s(aa,ad)){return{last_seq:ac.last_seq,history:af}}var ag=t.session_id;return s(ag,ab)?{last_seq:t.last_seq,history:ah}:gb(ab,ah)}function s(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:s(t,aa):!1}function gG(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function iA(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=jt),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=ia})),t.current_back_off=t.current_back_off||ia,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function G(t){return Object.keys(t).sort(gm.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function ho(t,ab,ag){var aa=ag.doc_ids?ag.doc_ids.sort(gm.collate):"",ad=ag.filter?ag.filter.toString():"",ac="",af="";return ag.filter&&ag.query_params&&(ac=JSON.stringify(G(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hS.all([t.id(),ab.id()]).then(function(ah){var aj=ah[0]+ah[1]+ad+af+ac+aa;return new hS(function(ak){fx(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gD(aD,au,ab,ah,ac){function aN(){return aH?hS.resolve():ho(aD,au,ab).then(function(aS){aw=aS,aH=new iZ(aD,au,aw,ah)})}function aj(){if(al=[],0!==aF.docs.length){var aS=aF.docs;return au.bulkDocs({docs:aS,new_edits:!1}).then(function(aT){if(ah.cancelled){throw ad(),new Error("cancelled")}var aW=[],aU={};aT.forEach(function(aY){aY.error&&(ac.doc_write_failures++,aW.push(aY),aU[aY.id]=aY)}),aE=aE.concat(aW),ac.docs_written+=aF.docs.length-aW.length;var aV=aW.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aU[aZ._id];aY?ah.emit("denied",jd(aY)):al.push(aZ)}),aV.length>0){var aX=new Error("bulkDocs error");throw aX.other_errors=aW,aM("target.bulkDocs failed to write docs",aX),new Error("bulkWrite partial failure")}},function(aT){throw ac.doc_write_failures+=aS.length,aT})}}function aq(){if(aF.error){throw new Error("There was a problem getting docs.")}ac.last_seq=aO=aF.seq;var aS=jd(ac);return al.length&&(aS.docs=al,ah.emit("change",aS)),aK=!0,aH.writeCheckpoint(aF.seq,aC).then(function(){if(aK=!1,ah.cancelled){throw ad(),new Error("cancelled")}aF=void 0,aR()})["catch"](av)}function aA(){var aS={};return aF.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),au.revsDiff(aS).then(function(aT){if(ah.cancelled){throw ad(),new Error("cancelled")}aF.diffs=aT})}function aI(){return N(aD,au,aF.diffs,ah).then(function(aS){aF.error=!aS.ok,aS.docs.forEach(function(aT){delete aF.diffs[aT._id],ac.docs_read++,aF.docs.push(aT)})})}function aQ(){if(!ah.cancelled&&!aF){if(0===aP.length){return void ay(!0)}aF=aP.shift(),aA().then(aI).then(aj).then(aq).then(aQ)["catch"](function(aS){aM("batch processing terminated with error",aS)})}}function ay(aS){return 0===af.changes.length?void (0!==aP.length||aF||((am&&aa.live||ak)&&(ah.state="pending",ah.emit("paused")),ak&&ad())):void ((aS||ak||af.changes.length>=az)&&(aP.push(af),af={seq:0,changes:[],docs:[]},"pending"!==ah.state&&"stopped"!==ah.state||(ah.state="active",ah.emit("active")),aQ()))}function aM(aT,aS){aJ||(aS.message||(aS.message=aT),ac.ok=!1,ac.status="aborting",ac.errors.push(aS),aE=aE.concat(aS),aP=[],af={seq:0,changes:[],docs:[]},ad())}function ad(){if(!(aJ||ah.cancelled&&(ac.status="cancelled",aK))){ac.status=ac.status||"complete",ac.end_time=new Date,ac.last_seq=aO,aJ=!0;var aT=aE.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aE.pop();aE.length>0&&(aS.other_errors=aE),aS.result=ac,iA(ab,ah,aS,function(){gD(aD,au,ab,ah)})}else{ac.errors=aE,ah.emit("complete",ac),ah.removeAllListeners()}}}function aB(aT){if(ah.cancelled){return ad()}var aS=hn(ab)(aT);aS&&(af.seq=aT.seq,af.changes.push(aT),ay(0===aP.length&&aa.live))}function t(aT){if(ap=!1,ah.cancelled){return ad()}if(aT.results.length>0){aa.since=aT.last_seq,aR(),ay(!0)}else{var aS=function(){am?(aa.live=!0,aR()):ak=!0,ay(!0)};aF||0!==aT.results.length?aS():(aK=!0,aH.writeCheckpoint(aT.last_seq,aC).then(function(){aK=!1,ac.last_seq=aO=aT.last_seq,aS()})["catch"](av))}}function ag(aS){return ap=!1,ah.cancelled?ad():void aM("changes rejected",aS)}function aR(){function aT(){aU.cancel()}function aS(){ah.removeListener("cancel",aT)}if(!ap&&!ak&&aP.length<ax){ap=!0,ah._changes&&(ah.removeListener("cancel",ah._abortChanges),ah._changes.cancel()),ah.once("cancel",aT);var aU=aD.changes(aa).on("change",aB);aU.then(aS,aS),aU.then(t)["catch"](ag),ab.retry&&(ah._changes=aU,ah._abortChanges=aT)}}function aL(){aN().then(function(){return ah.cancelled?void ad():aH.getCheckpoint().then(function(aS){aO=aS,aa={since:aO,limit:az,batch_size:az,style:"all_docs",doc_ids:aG,return_docs:!0},ab.filter&&("string"!=typeof ab.filter?aa.include_docs=!0:aa.filter=ab.filter),"heartbeat" in ab&&(aa.heartbeat=ab.heartbeat),"timeout" in ab&&(aa.timeout=ab.timeout),ab.query_params&&(aa.query_params=ab.query_params),ab.view&&(aa.view=ab.view),aR()})})["catch"](function(aS){aM("getCheckpoint rejected with ",aS)})}function av(aS){throw aK=!1,aM("writeCheckpoint completed with error",aS),aS}var aF,aw,aH,aP=[],af={seq:0,changes:[],docs:[]},aK=!1,ak=!1,aJ=!1,aO=0,am=ab.continuous||ab.live||!1,az=ab.batch_size||100,ax=ab.batches_limit||10,ap=!1,aG=ab.doc_ids,aE=[],al=[],aC=gO();ac=ac||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aa={};return ah.ready(aD,au),ah.cancelled?void ad():(ah._addedListeners||(ah.once("cancel",ad),"function"==typeof ab.complete&&(ah.once("error",ab.complete),ah.once("complete",function(aS){ab.complete(null,aS)})),ah._addedListeners=!0),void ("undefined"==typeof ab.since?aL():aN().then(function(){return aK=!0,aH.writeCheckpoint(ab.since,aC)}).then(function(){return aK=!1,ah.cancelled?void ad():(aO=ab.since,void aL())})["catch"](av)))}function gi(){hc.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hS(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function a5(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function gP(t,ab,ag,aa){if("function"==typeof ag&&(aa=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw er(hl,"`doc_ids` filter parameter is not a list.")}ag.complete=aa,ag=jd(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ad=new gi(ag),ac=a5(t,ag),af=a5(ab,ag);return gD(ac,af,ag,ad),ad}function gN(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=jd(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=a5(t,ac),ab=a5(ab,ac),new gc(t,ab,ac,aa)}function gc(t,ah,ag,ap){function aj(ay){ab.emit("change",{direction:"pull",change:ay})}function ac(ay){ab.emit("change",{direction:"push",change:ay})}function ak(ay){ab.emit("denied",{direction:"push",doc:ay})}function af(ay){ab.emit("denied",{direction:"pull",doc:ay})}function av(){ab.pushPaused=!0,ab.pullPaused&&ab.emit("paused")}function am(){ab.pullPaused=!0,ab.pushPaused&&ab.emit("paused")}function aa(){ab.pushPaused=!1,ab.pullPaused&&ab.emit("active",{direction:"push"})}function ad(){ab.pullPaused=!1,ab.pushPaused&&ab.emit("active",{direction:"pull"})}function aq(ay){return function(aC,aE){var aD="change"===aC&&(aE===aj||aE===ac),aA="denied"===aC&&(aE===af||aE===ak),az="paused"===aC&&(aE===am||aE===av),aB="active"===aC&&(aE===ad||aE===aa);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ab.removeAllListeners(aC))}}var ab=this;this.canceled=!1;var al=ag.push?Q.extend({},ag,ag.push):ag,aw=ag.pull?Q.extend({},ag,ag.pull):ag;this.push=gP(t,ah,al),this.pull=gP(ah,t,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ag.live&&(this.push.on("complete",ab.pull.cancel.bind(ab.pull)),this.pull.on("complete",ab.push.cancel.bind(ab.push))),this.on("newListener",function(ay){"change"===ay?(ab.pull.on("change",aj),ab.push.on("change",ac)):"denied"===ay?(ab.pull.on("denied",af),ab.push.on("denied",ak)):"active"===ay?(ab.pull.on("active",ad),ab.push.on("active",aa)):"paused"===ay&&(ab.pull.on("paused",am),ab.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ab.pull.removeListener("change",aj),ab.push.removeListener("change",ac)):"denied"===ay?(ab.pull.removeListener("denied",af),ab.push.removeListener("denied",ak)):"active"===ay?(ab.pull.removeListener("active",ad),ab.push.removeListener("active",aa)):"paused"===ay&&(ab.pull.removeListener("paused",am),ab.push.removeListener("paused",av))}),this.pull.on("removeListener",aq("pull")),this.push.on("removeListener",aq("push"));var au=hS.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ab.emit("complete",az),ap&&ap(null,az),ab.removeAllListeners(),az},function(ay){if(ab.cancel(),ap?ap(ay):ab.emit("error",ay),ab.removeAllListeners(),ap){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function he(t){t.replicate=gP,t.sync=gN}var ei,Q=b(9),hg=fd(b(5)),iq=fd(b(8)),jC=fd(b(10)),ju=b(14),h5=fd(b(4)),hc=b(1),je=fd(b(15)),ij=fd(b(16)),i5=fd(b(17)),gm=b(12),hS="function"==typeof Promise?Promise:jC,ez=Function.prototype.toString,jm=ez.call(Object),g3=hg("pouchdb:api"),hx=6;if(gX()){ei=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),ei=!!localStorage.getItem("_pouch_check_localstorage")}catch(ik){ei=!1}}iq(fy,hc.EventEmitter),fy.prototype.addListener=function(t,ab,ag,aa){function ad(){function ah(){af=!1}if(ac._listeners[ab]){if(af){return void (af="waiting")}af=!0;var aj=ga(aa,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>aa.since&&!aa.cancelled&&(aa.since=ak.seq,aa.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ad()},0),af=!1}).on("error",ah)}}if(!this._listeners[ab]){var ac=this,af=!1;this._listeners[ab]=ad,this.on(t,ad)}},fy.prototype.removeListener=function(aa,t){t in this._listeners&&hc.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},fy.prototype.notifyLocalWindows=function(t){gX()?chrome.storage.local.set({dbName:t}):gf()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},fy.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},iq(gd,Error),gd.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var io=new gd({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),g1=new gd({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),gB=new gd({status:404,error:"not_found",reason:"missing"}),hi=new gd({status:409,error:"conflict",reason:"Document update conflict"}),gp=new gd({status:400,error:"invalid_id",reason:"_id field must contain a string"}),fn=new gd({status:412,error:"missing_id",reason:"_id is required for puts"}),at=new gd({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),iX=new gd({status:412,error:"precondition_failed",reason:"Database not open"}),hw=new gd({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),gW=new gd({status:500,error:"badarg",reason:"Some query argument is invalid"}),h7=new gd({status:400,error:"invalid_request",reason:"Request was invalid"}),q=new gd({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),m=new gd({status:500,error:"doc_validation",reason:"Bad special document member"}),hl=new gd({status:400,error:"bad_request",reason:"Something wrong with the request"}),dn=new gd({status:400,error:"bad_request",reason:"Document must be a JSON object"}),iV=new gd({status:404,error:"not_found",reason:"Database not found"}),fV=new gd({status:500,error:"indexed_db_went_bad",reason:"unknown"}),gx=new gd({status:500,error:"web_sql_went_bad",reason:"unknown"}),fX=new gd({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),hy=new gd({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),gT=new gd({status:400,error:"bad_request",reason:"Invalid rev format"}),D=new gd({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),hM=new gd({status:412,error:"missing_stub"}),ht=new gd({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[io,g1,gB,hi,gp,fn,at,iX,hw,gW,h7,q,m,hl,dn,iV,gx,fX,hy,gT,D,hM,fV,ht],h3=function(t,ab,ac){var aa=hY.filter(function(ad){return ad[t]===ab});return ac&&aa.filter(function(ad){return ad.message===ac})[0]||aa[0]},fo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ew="queryKey",be=/(?:^|&)([^&=]*)=?([^&]*)/g,fz=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fm="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");iq(fu,hc.EventEmitter),fu.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fu.prototype.doChanges=function(aa){var ac=this,ad=aa.complete;if(aa=jd(aa),"live" in aa&&!("continuous" in aa)&&(aa.continuous=aa.live),aa.processChange=g0,"latest"===aa.since&&(aa.since="now"),aa.since||(aa.since=0),"now"===aa.since){return void this.db.info().then(function(af){return ac.isCancelled?void ad(null,{status:"cancelled"}):(aa.since=af.update_seq,void ac.doChanges(aa))},ad)}if(aa.continuous&&"now"!==aa.since&&this.db.info().then(function(af){ac.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),aa.view&&!aa.filter&&(aa.filter="_view"),aa.filter&&"string"==typeof aa.filter&&("_view"===aa.filter?aa.view=hs(aa.view):aa.filter=hs(aa.filter),"http"!==this.db.type()&&!aa.doc_ids)){return this.filterChanges(aa)}"descending" in aa||(aa.descending=!1),aa.limit=0===aa.limit?1:aa.limit,aa.complete=ad;var ab=this.db._changes(aa);if(ab&&"function"==typeof ab.cancel){var t=ac.cancel;ac.cancel=h5(function(af){ab.cancel(),t.apply(this,af)})}},fu.prototype.filterChanges=function(aa){var ac=this,ad=aa.complete;if("_view"===aa.filter){if(!aa.view||"string"!=typeof aa.view){var ab=er(hl,"`view` filter parameter not found or invalid.");return ad(ab)}var t=gM(aa.view);this.db.get("_design/"+t[0],function(ag,ah){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(ag){return ad(ih(ag))}var aj=ah&&ah.views&&ah.views[t[1]]&&ah.views[t[1]].map;return aj?(aa.filter=w(aj),void ac.doChanges(aa)):ad(er(gB,ah.views?"missing json key: "+t[1]:"missing json key: views"))})}else{var af=gM(aa.filter);if(!af){return ac.doChanges(aa)}this.db.get("_design/"+af[0],function(aj,ah){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(aj){return ad(ih(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(aa.filter=i6(ag),void ac.doChanges(aa)):ad(er(gB,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},iq(ii,hc.EventEmitter),ii.prototype.post=iv("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(er(dn)):void this.bulkDocs({docs:[aa]},ab,hU(t))}),ii.prototype.put=iv("put",h5(function(ah){function af(){ag||(go("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ag=!0)}var aa,ad,t,aj,ag=!1,ac=ah.shift(),ab="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(aj=ah.pop())(er(dn))}for(;;){if(aa=ah.shift(),ad=typeof aa,"string"!==ad||ab?"string"!==ad||!ab||"_rev" in ac?"object"===ad?t=aa:"function"===ad&&(aj=aa):(af(),ac._rev=aa):(af(),ac._id=aa,ab=!0),!ah.length){break}}return t=t||{},iS(ac._id),gz(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,aj):this._putLocal(ac,aj):void this.bulkDocs({docs:[ac]},t,hU(aj))})),ii.prototype.putAttachment=iv("putAttachment",function(t,ab,ag,aa,ad){function ac(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ab]={content_type:ad,data:aa,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof ad&&(ad=aa,aa=ag,ag=null),"undefined"==typeof ad&&(ad=aa,aa=ag,ag=null),af.get(t).then(function(ah){if(ah._rev!==ag){throw er(hi)}return ac(ah)},function(ah){if(ah.reason===gB.message){return ac({_id:t})}throw ah})}),ii.prototype.removeAttachment=iv("removeAttachment",function(aa,ac,ad,ab){var t=this;t.get(aa,function(af,ag){return af?void ab(af):ag._rev!==ad?void ab(er(hi)):ag._attachments?(delete ag._attachments[ac],0===Object.keys(ag._attachments).length&&delete ag._attachments,void t.put(ag,ab)):ab()})}),ii.prototype.remove=iv("remove",function(aa,ac,ad,ab){var t;"string"==typeof ac?(t={_id:aa,_rev:ac},"function"==typeof ad&&(ab=ad,ad={})):(t=aa,"function"==typeof ac?(ab=ac,ad={}):(ab=ad,ad=ac)),ad=ad||{},ad.was_delete=!0;var af={_id:t._id,_rev:t._rev||ad.rev};return af._deleted=!0,gz(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(t,ab):void this.bulkDocs({docs:[af]},ad,hU(ab))}),ii.prototype.revsDiff=iv("revsDiff",function(af,ad,ac){function ab(ak,aj){ag.has(ak)||ag.set(ak,{missing:[]}),ag.get(ak).missing.push(aj)}function t(aj,ak){var al=af[aj].slice(0);fa(ak,function(aq,av,aw,ap,am){var au=av+"-"+aw,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==am.status&&ab(aj,au))}),al.forEach(function(am){ab(aj,am)})}"function"==typeof ad&&(ac=ad,ad={});var ah=Object.keys(af);if(!ah.length){return ac(null,{})}var aa=0,ag=new ju.Map;ah.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ag.set(aj,{missing:af[aj]})}else{if(al){return ac(al)}t(aj,am)}if(++aa===ah.length){var ak={};return ag.forEach(function(ap,aq){ak[aq]=ap}),ac(null,ak)}})},this)}),ii.prototype.bulkGet=iv("bulkGet",function(aa,t){ee(this,aa,t)}),ii.prototype.compactDocument=iv("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ag,aj){if(ag){return ac(ag)}var af=hr(aj),ah=[],ad=[];Object.keys(af).forEach(function(ak){af[ak]>ab&&ah.push(ak)}),fa(aj,function(au,al,ap,ak,aq){var am=al+"-"+ap;"available"===aq.status&&-1!==ah.indexOf(am)&&ad.push(am)}),aa._doCompaction(t,ad,ac)})}),ii.prototype.compact=iv("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&jw(t)}),ii.prototype._compact=function(t,ab){function ag(ah){af.push(ad.compactDocument(ah.id,0))}function aa(aj){var ah=aj.last_seq;hS.all(af).then(function(){return jB(ad,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ab(null,{ok:!0})})["catch"](ab)}var ad=this,ac={return_docs:!1,last_seq:t.last_seq||0},af=[];ad.changes(ac).on("change",ag).on("complete",aa).on("error",ab)},ii.prototype.get=iv("get",function(af,ad,ac){function ab(){var ak=[],aj=t.length;return aj?void t.forEach(function(al){ah.get(af,{rev:al,revs:ad.revs,attachments:ad.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ac(null,ak)})}):ac(null,ak)}if("function"==typeof ad&&(ac=ad,ad={}),"string"!=typeof af){return ac(er(gp))}if(gz(af)&&"function"==typeof this._getLocal){return this._getLocal(af,ac)}var t=[],ah=this;if(!ad.open_revs){return this._get(af,ad,function(aw,az){if(aw){return ac(aw)}var ap=az.doc,ax=az.metadata,al=az.ctx;if(ad.conflicts){var aq=gs(ax);aq.length&&(ap._conflicts=aq)}if(jE(ax,ap._rev)&&(ap._deleted=!0),ad.revs||ad.revs_info){var au=hF(ax.rev_tree),aj=a0(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ap._rev.split("-")[1])}),am=aj.ids.map(function(aC){return aC.id}).indexOf(ap._rev.split("-")[1])+1,ay=aj.ids.length-am;if(aj.ids.splice(am,ay),aj.ids.reverse(),ad.revs&&(ap._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),ad.revs_info){var aB=aj.pos+aj.ids.length;ap._revs_info=aj.ids.map(function(aC){return aB--,{rev:aB+"-"+aC.id,status:aC.opts.status}})}}if(ad.attachments&&ap._attachments){var av=ap._attachments,aA=Object.keys(av).length;if(0===aA){return ac(null,ap)}Object.keys(av).forEach(function(aC){this._getAttachment(ap._id,aC,av[aC],{rev:ap._rev,binary:ad.binary,ctx:al},function(aE,aD){var aF=ap._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aA||ac(null,ap)})},ah)}else{if(ap._attachments){for(var ak in ap._attachments){ap._attachments.hasOwnProperty(ak)&&(ap._attachments[ak].stub=!0)}}ac(null,ap)}})}if("all"===ad.open_revs){this._getRevisionTree(af,function(ak,aj){return ak?ac(ak):(t=hR(aj).map(function(al){return al.rev}),void ab())})}else{if(!Array.isArray(ad.open_revs)){return ac(er(hw,"function_clause"))}t=ad.open_revs;for(var aa=0;aa<t.length;aa++){var ag=t[aa];if("string"!=typeof ag||!/^\d+-/.test(ag)){return ac(er(gT))}}ab()}}),ii.prototype.getAttachment=iv("getAttachment",function(aa,ac,ad,ab){var t=this;ad instanceof Function&&(ab=ad,ad={}),this._get(aa,ad,function(af,ag){return af?ab(af):ag.doc._attachments&&ag.doc._attachments[ac]?(ad.ctx=ag.ctx,ad.binary=!0,t._getAttachment(aa,ac,ag.doc._attachments[ac],ad,ab),void 0):ab(er(gB))})}),ii.prototype.allDocs=iv("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(er(q,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return l(this,aa,ab)}}return this._allDocs(aa,ab)}),ii.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new fu(this,aa,t)},ii.prototype.close=iv("close",function(t){return this._closed=!0,this._close(t)}),ii.prototype.info=iv("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),ii.prototype.id=iv("id",function(t){return this._id(t)}),ii.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},ii.prototype.bulkDocs=iv("bulkDocs",function(aa,ac,ad){if("function"==typeof ac&&(ad=ac,ac={}),ac=ac||{},Array.isArray(aa)&&(aa={docs:aa}),!aa||!aa.docs||!Array.isArray(aa.docs)){return ad(er(g1))}for(var ab=0;ab<aa.docs.length;++ab){if("object"!=typeof aa.docs[ab]||Array.isArray(aa.docs[ab])){return ad(er(dn))}}var t;return aa.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){t=t||gE(ag)})}),t?ad(er(hl,t)):("new_edits" in ac||("new_edits" in aa?ac.new_edits=aa.new_edits:ac.new_edits=!0),ac.new_edits||"http"===this.type()||aa.docs.sort(iM),iW(aa.docs),this._bulkDocs(aa,ac,function(af,ag){return af?ad(af):(ac.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ad(null,ag))}))}),ii.prototype.registerDependentDatabase=iv("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);jB(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),ii.prototype.destroy=iv("destroy",function(aa,ac){function ad(){ab._destroy(aa,function(ag,af){return ag?ac(ag):(ab._destroyed=!0,ab.emit("destroyed"),void ac(null,af||{ok:!0}))})}"function"==typeof aa&&(ac=aa,aa={});var ab=this,t="use_prefix" in ab?ab.use_prefix:!0;return"http"===ab.type()?ad():void ab.get("_local/_pouch_dependentDbs",function(ag,aj){if(ag){return 404!==ag.status?ac(ag):ad()}var af=aj.dependentDbs,ah=ab.constructor,ak=Object.keys(af).map(function(al){var am=t?al.replace(new RegExp("^"+ah.prefix),""):al;return new ah(am,ab.__opts).destroy()});hS.all(ak).then(ad,ac)})}),hA.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},hA.prototype.fail=function(t){this.failed=t,this.execute()},hA.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},hA.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},iq(fv,ii),fv.debug=hg,fv.adapters={},fv.preferredAdapters=[],fv.prefix="_pouch_";var iB=new hc.EventEmitter;iu(fv),fv.parseAdapter=function(af,ad){var ac,ab,t=af.match(/([a-z\-]*):\/\/(.*)/);if(t){if(af=/http(s?)/.test(t[1])?t[1]+"://"+t[2]:t[2],ac=t[1],!fv.adapters[ac].valid()){throw"Invalid adapter"}return{name:af,adapter:t[1]}}var ah="idb" in fv.adapters&&"websql" in fv.adapters&&gf()&&localStorage["_pouch__websqldb_"+fv.prefix+af];if(ad.adapter){ab=ad.adapter}else{if("undefined"!=typeof ad&&ad.db){ab="leveldb"}else{for(var aa=0;aa<fv.preferredAdapters.length;++aa){if(ab=fv.preferredAdapters[aa],ab in fv.adapters){if(ah&&"idb"===ab){go("log",'PouchDB is downgrading "'+af+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ac=fv.adapters[ab];var ag=ac&&"use_prefix" in ac?ac.use_prefix:!0;return{name:ag?fv.prefix+af:af,adapter:ab}},fv.adapter=function(aa,ab,t){ab.valid()&&(fv.adapters[aa]=ab,t&&fv.preferredAdapters.push(aa))},fv.plugin=function(t){return"function"==typeof t?t(fv):Object.keys(t).forEach(function(aa){fv.prototype[aa]=t[aa]}),fv},fv.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=Q.extend({},aa,ad),void fv.call(this,ab,ad,ac)):new t(ab,ad,ac)}return iq(t,fv),t.preferredAdapters=fv.preferredAdapters.slice(),Object.keys(fv).forEach(function(ab){ab in t||(t[ab]=fv[ab])}),t};var et="5.4.4";fv.version=et;var i4,bt=g9(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=g9(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),hG=function(t){return atob(t)},h8=function(t){return btoa(t)},gL=fU.setImmediate||fU.setTimeout,iU=32768,gu=5,gv="document-store",g2="by-sequence",ff="attach-store",h6="attach-seq-store",E="meta-store",hJ="local-store",jx="detect-blob-support",gq={running:!1,queue:[]},gQ=new ju.Map,hm=new fy,a6=new ju.Map;Z.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var hb=7,jz=ig("document-store"),gS=ig("by-sequence"),gZ=ig("attach-store"),hV=ig("local-store"),i0=ig("metadata-store"),a2=ig("attach-seq-store"),ft=new ju.Map,B=new fy,iR=1,f="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+gS+" (seq, deleted)",ir="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+gS+" (doc_id, rev)",gH="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+jz+" (winningseq)",hp="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+a2+" (seq)",T="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+a2+" (digest, seq)",jv=gS+".seq = "+jz+".winningseq",K=gS+".seq AS seq, "+gS+".deleted AS deleted, "+gS+".json AS data, "+gS+".rev AS rev, "+jz+".json AS metadata";fg.valid=a4,fg.use_prefix=!0;var C=iz(),jr=function(){},iL=25,hu=50,i9={},h9=1800,jb=hg("pouchdb:http");v.valid=function(){return !0},j.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},j.prototype.finish=function(){return this.promise};var dr=function(aa,t){return t&&aa.then(function(ab){di.nextTick(function(){t(null,ab)})},function(ab){di.nextTick(function(){t(ab)})}),aa},o=function(t){return h5(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&dr(ab,aa),ab})},ce=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},fl=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},U=function(aa){for(var ac={},ad=0,ab=aa.length;ab>ad;ad++){ac["$"+aa[ad]]=!0}var t=Object.keys(ac),af=new Array(t.length);for(ad=0,ab=t.length;ab>ad;ad++){af[ad]=t[ad].substring(1)}return af},iG={},jp=new j,ic=50,hC=go.bind(null,"log"),hh={_sum:function(aa,t){return hd(t)},_count:function(aa,t){return t.length},_stats:function(aa,ab){function t(ac){for(var af=0,ag=0,ad=ac.length;ad>ag;ag++){var ah=ac[ag];af+=ah*ah}return af}return{sum:hd(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},hj=o(function(){var t=this;return"http"===t.type()?gR(t):"function"==typeof t._viewCleanup?cr(t):ai(t)}),iK=function(aa,ac,ad){"function"==typeof ac&&(ad=ac,ac={}),ac=ac?gK(ac):{},"function"==typeof aa&&(aa={map:aa});var ab=this,t=hS.resolve().then(function(){return de(ab,aa,ac)});return dr(t,ad),t};iq(es,Error),iq(i,Error),iq(hI,Error);var iY={query:iK,viewCleanup:hj},p=1,gU="pouchdb",fk=5,jj=0;iZ.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},iZ.prototype.updateTarget=function(aa,t){return i8(this.target,this.id,aa,t,this.returnValue)},iZ.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?hS.resolve(!0):i8(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(gG(ac)){return t.readOnlySource=!0,!0}throw ac})};var hP={undefined:function(aa,t){return 0===gm.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return hK(t,aa).last_seq}};iZ.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hS.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return jj}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hP?hP[ab](aa,ac):jj},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:jj}).then(function(){return jj},function(ac){return gG(ac)?(t.readOnlySource=!0,aa.last_seq):jj})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return jj})};var ia=0;iq(gi,hc.EventEmitter),gi.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gi.prototype.ready=function(aa,ac){function ad(){t.cancel()}function ab(){aa.removeListener("destroyed",ad),ac.removeListener("destroyed",ad)}var t=this;t._readyCalled||(t._readyCalled=!0,aa.once("destroyed",ad),ac.once("destroyed",ad),t.once("complete",ab))},iq(gc,hc.EventEmitter),gc.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},fv.plugin(iH).plugin(fr).plugin(fb).plugin(iY).plugin(he),e.exports=fv}).call(this,b(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var j="color: "+this.color;h=[h[0],j,"color: inherit"].concat(Array.prototype.slice.call(h,1));var g=0,f=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),h.splice(f,0,j),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(b,s,i){function o(){return i.colors[e++%i.colors.length]}function n(j){function g(){}function k(){var w=k,q=+new Date,v=q-(a||q);w.diff=v,w.prev=a,w.curr=q,a=q,null==w.useColors&&(w.useColors=i.useColors()),null==w.color&&w.useColors&&(w.color=o());var m=Array.prototype.slice.call(arguments);m[0]=i.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=i.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof i.formatArgs&&(m=i.formatArgs.apply(w,m));var l=k.log||i.log||console.log.bind(console);l.apply(w,m)}g.enabled=!1,k.enabled=!0;var h=i.enabled(j)?k:g;return h.namespace=j,h}function f(k){i.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?i.skips.push(new RegExp("^"+k.substr(1)+"$")):i.names.push(new RegExp("^"+k+"$")))}}function u(){i.enable("")}function r(g){var j,h;for(j=0,h=i.skips.length;h>j;j++){if(i.skips[j].test(g)){return !1}}for(j=0,h=i.names.length;h>j;j++){if(i.names[j].test(g)){return !0}}return !1}function t(g){return g instanceof Error?g.stack||g.message:g}i=s.exports=n,i.coerce=t,i.disable=u,i.enable=f,i.enabled=r,i.humanize=b(11),i.names=[],i.skips=[],i.formatters={};var a,e=0},{11:11}],7:[function(b,e,a){(function(x){function i(){y=!0;for(var g,h,j=f.length;j;){for(h=f,f=[],g=-1;++g<j;){h[g]()}j=f.length}y=!1}function o(g){1!==f.push(g)||y||n()}var n,z=x.MutationObserver||x.WebKitMutationObserver;if(z){var u=0,r=new z(i),s=x.document.createTextNode("");r.observe(s,{characterData:!0}),n=function(){s.data=u=++u%2}}else{if(x.setImmediate||"undefined"==typeof x.MessageChannel){n="document" in x&&"onreadystatechange" in x.document.createElement("script")?function(){var g=x.document.createElement("script");g.onreadystatechange=function(){i(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},x.document.documentElement.appendChild(g)}:function(){setTimeout(i,0)}}else{var l=new x.MessageChannel;l.port1.onmessage=i,n=function(){l.port2.postMessage(0)}}}var y,f=[];e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(b,e,a){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(n,u,f){function o(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=p,this.queue=[],this.outcome=void 0,g!==o&&y(this,g)}function e(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function m(j,k,g){l(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function b(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=i(j);"error"===z.status&&w(z.value)}function i(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function t(g){return g instanceof this?g:K.resolve(new this(o),g)}function s(g){var j=new this(o);return K.reject(j,g)}function a(z){function k(E,D){function C(F){q[D]=F,++x!==j||B||(B=!0,K.resolve(w,q))}g.resolve(E).then(C,function(F){B||(B=!0,K.reject(w,F))})}var g=this;if("[object Array]"!==Object.prototype.toString.call(z)){return this.reject(new TypeError("must be an array"))}var j=z.length,B=!1;if(!j){return this.resolve([])}for(var q=new Array(j),x=0,A=-1,w=new this(o);++A<j;){k(z[A],A)}return w}function r(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(o);++z<j;){g(k[z])}return q}var l=n(7),K={},L=["REJECTED"],h=["FULFILLED"],p=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===h||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(o);if(this.state!==p){var k=this.state===h?q:g;m(j,k,this.outcome)}else{this.queue.push(new e(j,q,g))}return j},e.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},e.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},e.prototype.callRejected=function(g){K.reject(this.promise,g)},e.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=i(b,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=h,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},v.resolve=t,v.reject=s,v.all=a,v.race=r},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(D,h,r){function b(v){if(null!==v){switch(typeof v){case"boolean":return v?1:0;case"number":return a(v);case"string":return v.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var w=Array.isArray(v),q=w?v:Object.keys(v),j=-1,g=q.length,m="";if(w){for(;++j<g;){m+=r.toIndexableString(q[j])}}else{for(;++j<g;){var k=q[j];m+=r.toIndexableString(k)+r.toIndexableString(v[k])}}return m}}return""}function l(q,g){var w,y=g,x="1"===q[g];if(x){w=0,g++}else{var v="0"===q[g];g++;var k="",z=q.substring(g,g+p),j=parseInt(z,10)+t;for(v&&(j=-j),g+=p;;){var m=q[g];if("\x00"===m){break}k+=m,g++}k=k.split("."),w=1===k.length?parseInt(k,10):parseFloat(k[0]+"."+k[1]),v&&(w-=10),0!==j&&(w=parseFloat(w+"e"+j))}return{num:w,length:g-y}}function o(q,j){var w=q.pop();if(j.length){var m=j[j.length-1];w===m.element&&(j.pop(),m=j[j.length-1]);var g=m.element,v=m.index;if(Array.isArray(g)){g.push(w)}else{if(v===q.length-2){var k=q.pop();g[k]=w}else{q.push(w)}}}}function s(k,q){for(var m=Math.min(k.length,q.length),j=0;m>j;j++){var g=r.collate(k[j],q[j]);if(0!==g){return g}}return k.length===q.length?0:k.length>q.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(v,w){for(var q=Object.keys(v),j=Object.keys(w),g=Math.min(q.length,j.length),m=0;g>m;m++){var k=r.collate(q[m],j[m]);if(0!==k){return k}if(k=r.collate(v[q[m]],w[j[m]]),0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(q){if(0===q){return"1"}var j=q.toExponential().split(/e\+?/),w=parseInt(j[1],10),y=0>q,x=y?"0":"2",v=(y?-w:w)-t,m=n.padLeft(v.toString(),"0",p);x+=f+m;var g=Math.abs(parseFloat(j[0]));y&&(g=10-g);var k=g.toFixed(20);return k=k.replace(/\.?0+$/,""),x+=f+k}var t=-324,p=3,f="",n=D(13);r.collate=function(j,m){if(j===m){return 0}j=r.normalizeKey(j),m=r.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},r.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=r.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=r.normalizeKey(q))}}}}}return g},r.toIndexableString=function(g){var j="\x00";return g=r.normalizeKey(g),i(g)+f+b(g)+j},r.parseIndexableString=function(q){for(var g=[],x=[],y=0;;){var k=q[y++];if("\x00"!==k){switch(k){case"1":g.push(null);break;case"2":g.push("1"===q[y]),y++;break;case"3":var z=l(q,y);g.push(z.num),y+=z.length;break;case"4":for(var j="";;){var m=q[y];if("\x00"===m){break}j+=m,y++}j=j.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),g.push(j);break;case"5":var v={element:[],index:g.length};g.push(v.element),x.push(v);break;case"6":var w={element:{},index:g.length};g.push(w.element),x.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+k)}}else{if(1===g.length){return g.pop()}o(g,x)}}}},{13:13}],13:[function(h,b,e){function a(n,g,l){for(var f="",m=l-n.length;f.length<m;){f+=g}return f}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var f,g=r.length,o=n.length;for(f=0;g>f;f++){if(f===o){return 1}var i=r.charAt(f),q=n.charAt(f);if(i!==q){return q>i?-1:1}}return o>g?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(a,e,i){function b(){this.store={}}function j(g){if(this.store=new b,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}i.Map=b,i.Set=j,b.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},b.prototype.unmangle=function(f){return f.substring(1)},b.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},b.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},b.prototype.has=function(f){var g=this.mangle(f);return g in this.store},b.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},b.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},j.prototype.add=function(f){return this.store.set(f,!0)},j.prototype.has=function(f){return this.store.has(f)},j.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(n,o){var p,q,g,r;q=[],r=[];for(p in o){h.call(o,p)&&(g=o[p],"this"!==p&&(q.push(p),r.push(g)))}return Function.apply(null,f.call(q).concat([n])).apply(o["this"],r)}}).call(this)},{}],16:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(y){function u(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function P(j,q,k,A,w,z,x){return u(q&k|~q&A,j,q,w,z,x)}function t(j,q,k,A,w,z,x){return u(q&A|k&~A,j,q,w,z,x)}function s(j,q,k,A,w,z,x){return u(q^k^A,j,q,w,z,x)}function Q(j,q,k,A,w,z,x){return u(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=P(z,q,x,j,w[0],7,-680876936),j=P(j,z,q,x,w[1],12,-389564586),x=P(x,j,z,q,w[2],17,606105819),q=P(q,x,j,z,w[3],22,-1044525330),z=P(z,q,x,j,w[4],7,-176418897),j=P(j,z,q,x,w[5],12,1200080426),x=P(x,j,z,q,w[6],17,-1473231341),q=P(q,x,j,z,w[7],22,-45705983),z=P(z,q,x,j,w[8],7,1770035416),j=P(j,z,q,x,w[9],12,-1958414417),x=P(x,j,z,q,w[10],17,-42063),q=P(q,x,j,z,w[11],22,-1990404162),z=P(z,q,x,j,w[12],7,1804603682),j=P(j,z,q,x,w[13],12,-40341101),x=P(x,j,z,q,w[14],17,-1502002290),q=P(q,x,j,z,w[15],22,1236535329),z=t(z,q,x,j,w[1],5,-165796510),j=t(j,z,q,x,w[6],9,-1069501632),x=t(x,j,z,q,w[11],14,643717713),q=t(q,x,j,z,w[0],20,-373897302),z=t(z,q,x,j,w[5],5,-701558691),j=t(j,z,q,x,w[10],9,38016083),x=t(x,j,z,q,w[15],14,-660478335),q=t(q,x,j,z,w[4],20,-405537848),z=t(z,q,x,j,w[9],5,568446438),j=t(j,z,q,x,w[14],9,-1019803690),x=t(x,j,z,q,w[3],14,-187363961),q=t(q,x,j,z,w[8],20,1163531501),z=t(z,q,x,j,w[13],5,-1444681467),j=t(j,z,q,x,w[2],9,-51403784),x=t(x,j,z,q,w[7],14,1735328473),q=t(q,x,j,z,w[12],20,-1926607734),z=s(z,q,x,j,w[5],4,-378558),j=s(j,z,q,x,w[8],11,-2022574463),x=s(x,j,z,q,w[11],16,1839030562),q=s(q,x,j,z,w[14],23,-35309556),z=s(z,q,x,j,w[1],4,-1530992060),j=s(j,z,q,x,w[4],11,1272893353),x=s(x,j,z,q,w[7],16,-155497632),q=s(q,x,j,z,w[10],23,-1094730640),z=s(z,q,x,j,w[13],4,681279174),j=s(j,z,q,x,w[0],11,-358537222),x=s(x,j,z,q,w[3],16,-722521979),q=s(q,x,j,z,w[6],23,76029189),z=s(z,q,x,j,w[9],4,-640364487),j=s(j,z,q,x,w[12],11,-421815835),x=s(x,j,z,q,w[15],16,530742520),q=s(q,x,j,z,w[2],23,-995338651),z=Q(z,q,x,j,w[0],6,-198630844),j=Q(j,z,q,x,w[7],10,1126891415),x=Q(x,j,z,q,w[14],15,-1416354905),q=Q(q,x,j,z,w[5],21,-57434055),z=Q(z,q,x,j,w[12],6,1700485571),j=Q(j,z,q,x,w[3],10,-1894986606),x=Q(x,j,z,q,w[10],15,-1051523),q=Q(q,x,j,z,w[1],21,-2054922799),z=Q(z,q,x,j,w[8],6,1873313359),j=Q(j,z,q,x,w[15],10,-30611744),x=Q(x,j,z,q,w[6],15,-1560198380),q=Q(q,x,j,z,w[13],21,1309151649),z=Q(z,q,x,j,w[4],6,-145523070),j=Q(j,z,q,x,w[11],10,-1120210379),x=Q(x,j,z,q,w[2],15,718787259),q=Q(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function l(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function o(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function v(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,l(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function r(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,o(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function O(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function p(j){var k;for(k=0;k<j.length;k+=1){j[k]=O(j[k])}return j.join("")}function m(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function n(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(v("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(B,w){var D,k,C,x,A=this.byteLength,z=j(B,A),q=A;return w!==y&&(q=j(w,A)),z>q?new ArrayBuffer(0):(D=q-z,k=new ArrayBuffer(D),C=new Uint8Array(k),x=new Uint8Array(this,z,D),C.set(x),k)}}(),n.prototype.append=function(j){return this.appendBinary(m(j)),this},n.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,l(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},n.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},n.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},n.hash=function(j,k){return n.hashBinary(m(j),k)},n.hashBinary=function(k,w){var j=v(k),q=p(j);return w?e(q):q},n.ArrayBuffer=function(){this.reset()},n.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,o(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var j=n.prototype.getState.call(this);return j.buff=S(j.buff),j},n.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),n.prototype.setState.call(this,j)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(k,w){var j=r(new Uint8Array(k)),q=p(j);return w?e(q):q},n})},{}],17:[function(h,b,e){function a(r,n,f){var g=f[f.length-1];r===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,i=g.index;if(Array.isArray(o)){o.push(r)}else{if(i===n.length-2){var q=n.pop();o[q]=r}else{n.push(r)}}}e.stringify=function(E){var D=[];D.push({obj:E});for(var i,s,f,n,F,u,l,C,g,o,t,r="";i=D.pop();){if(s=i.obj,f=i.prefix||"",n=i.val||"",r+=f,n){r+=n}else{if("object"!=typeof s){r+="undefined"==typeof s?null:JSON.stringify(s)}else{if(null===s){r+="null"}else{if(Array.isArray(s)){for(D.push({val:"]"}),F=s.length-1;F>=0;F--){u=0===F?"":",",D.push({obj:s[F],prefix:u})}D.push({val:"["})}else{l=[];for(C in s){s.hasOwnProperty(C)&&l.push(C)}for(D.push({val:"}"}),F=l.length-1;F>=0;F--){g=l[F],o=s[g],t=F>0?",":"",t+=JSON.stringify(g)+":",D.push({obj:o,prefix:t})}D.push({val:"{"})}}}}}return r},e.parse=function(o){for(var s,A,t,l,g,u,D,f,i,B=[],C=[],n=0;;){if(s=o[n++],"}"!==s&&"]"!==s&&"undefined"!=typeof s){switch(s){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,a(null,B,C);break;case"t":n+=3,a(!0,B,C);break;case"f":n+=4,a(!1,B,C);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(A="",n--;;){if(t=o[n++],!/[\d\.\-e\+]/.test(t)){n--;break}A+=t}a(parseFloat(A),B,C);break;case'"':for(l="",g=void 0,u=0;;){if(D=o[n++],'"'===D&&("\\"!==g||u%2!==1)){break}l+=D,g=D,"\\"===g?u++:u=0}a(JSON.parse('"'+l+'"'),B,C);break;case"[":f={element:[],index:B.length},B.push(f.element),C.push(f);break;case"{":i={element:{},index:B.length},B.push(i.element),C.push(i);break;default:throw new Error("unexpectedly reached end of input: "+s)}}else{if(1===B.length){return B.pop()}a(B.pop(),B,C)}}}},{}]},{},[3])(3)});