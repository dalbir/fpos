!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(g,n){if(!b[g]){if(!i[g]){var f="function"==typeof require&&require;if(!n&&f){return f(g,!0)}if(a){return a(g,!0)}var h=new Error("Cannot find module '"+g+"'");throw h.code="MODULE_NOT_FOUND",h}var j=b[g]={exports:{}};i[g][0].call(j.exports,function(m){var p=i[g][1][m];return k(p?p:m)},j,j.exports,d,i,b,l)}return b[g].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,f,h,j,r,l;if(this._events||(this._events={}),"error"===g&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(f=this._events[g],i(f)){return !1}if(o(f)){switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:j=Array.prototype.slice.call(arguments,1),f.apply(this,j)}}else{if(m(f)){for(j=Array.prototype.slice.call(arguments,1),l=f.slice(),h=l.length,r=0;h>r;r++){l[r].apply(this,j)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(m(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(B,n,u){function r(){b&&l&&(b=!1,l.length?o=l.concat(o):h=-1,o.length&&a())}function a(){if(!b){var g=s(r);b=!0;for(var j=o.length;j;){for(l=o,o=[];++h<j;){l&&l[h].run()}h=-1,j=o.length}l=null,b=!1,e(g)}}function t(g,j){this.fun=g,this.array=j}function f(){}var s,e,i=n.exports={};!function(){try{s=setTimeout}catch(g){s=function(){throw new Error("setTimeout is not defined")}}try{e=clearTimeout}catch(g){e=function(){throw new Error("clearTimeout is not defined")}}}();var l,o=[],b=!1,h=-1;i.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}o.push(new t(j,k)),1!==o.length||b||s(a,0)},t.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.binding=function(g){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(g){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],3:[function(a,b,e){(function(ga,jB){function ee(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fZ(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fa(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function gE(ab){if(ab instanceof ArrayBuffer){return fa(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function fy(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&be.call(aa)==i5}function g5(t){var ab,ac,aa;if(!t||"object"!=typeof t){return t}if(Array.isArray(t)){for(ab=[],ac=0,aa=t.length;aa>ac;ac++){ab[ac]=g5(t[ac])}return ab}if(t instanceof Date){return t.toISOString()}if(fZ(t)){return gE(t)}if(!fy(t)){return t}ab={};for(ac in t){if(Object.prototype.hasOwnProperty.call(t,ac)){var ad=g5(t[ac]);"undefined"!=typeof ad&&(ab[ac]=ad)}}return ab}function jo(aa){var t=!1;return he(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fi(t){return he(function(ac){ac=g5(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){ga.nextTick(function(){ad(ag,ah)})});var af=new je(function(ak,al){var ah;try{var aj=jo(function(ap,am){ap?al(ap):ak(am)});ac.push(aj),ah=t.apply(aa,ac),ah&&"function"==typeof ah.then&&ak(ah)}catch(ag){al(ag)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gs(ab,t){function aa(ad,ag,aj){if(hl.enabled){for(var af=[ad._db_name,ag],ac=0;ac<aj.length-1;ac++){af.push(aj[ac])}hl.apply(null,af);var ah=aj[aj.length-1];aj[aj.length-1]=function(ak,am){var al=[ad._db_name,ag];al=al.concat(ak?["error",ak]:["success",am]),hl.apply(null,al),ah(ak,am)}}}return fi(he(function(ad){if(this._closed){return je.reject(new Error("database is closed"))}if(this._destroyed){return je.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new je(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function ge(t,ab){for(var ac={},aa=0,ad=ab.length;ad>aa;aa++){var af=ab[aa];af in t&&(ac[af]=t[af])}return ac}function fc(t){return t}function g4(t){return[{ok:t}]}function fd(ah,ad,aq){function ab(){var av=[];al.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aq(null,{results:av})}function aa(){++t===au&&ab()}function am(aw,ax,av){al[aw]={id:ax,docs:av},aa()}function ac(){if(!(ap>=aj.length)){var av=Math.min(ap+iF,aj.length),aw=aj.slice(ap,av);af(aw,ap),ap+=aw.length}}function af(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=ag[aC],aB=ge(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(fc);var ax=fc;0===aB.open_revs.length&&(delete aB.open_revs,ax=g4),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ad&&(aB[aD]=ad[aD])}),ah.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),am(ay,aC,aE),ac()})})}var ak=ad.docs,ag={};ak.forEach(function(av){av.id in ag?ag[av.id].push(av):ag[av.id]=[av]});var au=Object.keys(ag).length,t=0,al=new Array(au),aj=Object.keys(ag),ap=0;ac()}function r(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function er(){return m}function co(t){r()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):er()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function fU(){h5.EventEmitter.call(this),this._listeners={},co(this)}function jd(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function fq(t,ab){var ac=600000;t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1,ab>ac&&(t=ac>>1,ab=ac);var aa=Math.random(),ad=ab-t;return ~~(ad*aa+t)}function gM(aa){var t=0;return aa||(t=2000),fq(aa,t)}function jt(aa,t){jd("info","The above "+aa+" is totally normal. "+t)}function jA(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function hB(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=jA.prototype,new aa(ab)}function a9(t){var ab,ac,aa,ad,af;return ac=t.error===!0&&"string"==typeof t.name?t.name:t.error,af=t.reason,aa=h3("name",ac,af),t.missing||"missing"===af||"deleted"===af||"not_found"===ac?aa=h7:"doc_validation"===ac?(aa=de,ad=af):"bad_request"===ac&&aa.message!==af&&(aa=hG),aa||(aa=h3("status",t.status,af)||fb),ab=hB(aa,af,ac),ad&&(ab.message=ad),t.id&&(ab.id=t.id),t.status&&(ab.status=t.status),t.missing&&(ab.missing=t.missing),ab}function iu(t,ab,ac){try{return !t(ab,ac)}catch(aa){var ad="Filter function threw: "+aa.toString();return hB(hG,ad)}}function gd(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&iu(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function dt(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function ii(aa){var t;if(aa?"string"!=typeof aa?t=hB(hw):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=hB(ei)):t=hB(gx),t){throw t}}function h0(aa,t){return"listenerCount" in aa?aa.listenerCount(t):h5.EventEmitter.listenerCount(aa,t)}function gO(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function E(aa){var t=gO(aa);return t?t.join("/"):null}function jk(ad){for(var aa=u.exec(ad),ag={},t=14;t--;){var ac=dn[t],ab=aa[t]||"",af=-1!==["user","password"].indexOf(ac);ag[ac]=af?decodeURIComponent(ab):ab}return ag[gt]={},ag[dn[12]].replace(fz,function(ak,aj,ah){aj&&(ag[gt][aj]=ah)}),ag}function ib(ab,t,aa){return new je(function(ad,ac){ab.get(t,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=aa(af);return aj?(aj._id=t,aj._rev=ag,void ad(iv(ab,aj,aa))):ad({updated:!1,rev:ag})})})}function iv(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return ib(ab,t._id,aa)})}function iC(t){return 0|Math.random()*t}function gX(t,ab){ab=ab||q.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=q[iC(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=q[3&iC(16)|8];break;default:ac+=q[iC(16)]}}return ac}function g9(t){for(var al,ah,ak,aj,af=t.rev_tree.slice();aj=af.pop();){var ap=aj.ids,ad=ap[2],am=aj.pos;if(ad.length){for(var aa=0,ac=ad.length;ac>aa;aa++){af.push({pos:am+1,ids:ad[aa]})}}else{var ag=!!ap[1].deleted,ab=ap[0];al&&!(ak!==ag?ak:ah!==am?am>ah:ab>al)||(al=ab,ah=am,ak=ag)}}return ah+"-"+al}function jl(aa,aj){for(var ad,ag=aa.slice();ad=ag.pop();){for(var af=ad.pos,ac=ad.ids,ak=ac[2],ah=aj(0===ak.length,af,ac[0],ad.ctx,ac[1]),ab=0,t=ak.length;t>ab;ab++){ag.push({pos:af+1,ids:ak[ab],ctx:ah})}}}function fS(aa,t){return aa.pos-t.pos}function jw(t){var ab=[];jl(t,function(ah,af,aj,ag,ad){ah&&ab.push({rev:af+"-"+aj,pos:af,opts:ad})}),ab.sort(fS).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function iP(ad){for(var aa=g9(ad),ag=jw(ad.rev_tree),t=[],ac=0,ab=ag.length;ab>ac;ac++){var af=ag[ac];af.rev===aa||af.opts.deleted||t.push(af.rev)}return t}function di(aa){var t=[];return jl(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function iz(t){for(var al,ah=[],ak=t.slice();al=ak.pop();){var aj=al.pos,af=al.ids,ap=af[0],ad=af[1],am=af[2],aa=0===am.length,ac=al.history?al.history.slice():[];ac.push({id:ap,opts:ad}),aa&&ah.push({pos:aj+1-ac.length,ids:ac});for(var ag=0,ab=am.length;ab>ag;ag++){ak.push({pos:aj+1,ids:am[ag],history:ac})}}return ah.reverse()}function iM(aa,t){return aa.pos-t.pos}function g0(t,ab,ac){for(var aa,ad=0,af=t.length;af>ad;){aa=ad+af>>>1,ac(t[aa],ab)<0?ad=aa+1:af=aa}return ad}function L(t,ab,ac){var aa=g0(t,ab,ac);t.splice(aa,0,ab)}function i1(ac,aa){for(var af,ah,ag=aa,ab=ac.length;ab>ag;ag++){var ad=ac[ag],t=[ad.id,ad.opts,[]];ah?(ah[2].push(t),ah=t):af=ah=t}return af}function cn(aa,t){return aa[0]<t[0]?-1:1}function hR(aa,aj){for(var ad=[{tree1:aa,tree2:aj}],ag=!1;ad.length>0;){var af=ad.pop(),ac=af.tree1,ak=af.tree2;(ac[1].status||ak[1].status)&&(ac[1].status="available"===ac[1].status||"available"===ak[1].status?"available":"missing");for(var ah=0;ah<ak[2].length;ah++){if(ac[2][0]){for(var ab=!1,t=0;t<ac[2].length;t++){ac[2][t][0]===ak[2][ah][0]&&(ad.push({tree1:ac[2][t],tree2:ak[2][ah]}),ab=!0)}ab||(ag="new_branch",L(ac[2],ak[2][ah],cn))}else{ag="new_leaf",ac[2][0]=ak[2][ah]}}}return{conflicts:ag,tree:aa}}function ex(t,af,ab){var ag,av=[],ap=!1,ah=!1;if(!t.length){return{tree:[af],conflicts:"new_leaf"}}for(var ac=0,aw=t.length;aw>ac;ac++){var ad=t[ac];if(ad.pos===af.pos&&ad.ids[0]===af.ids[0]){ag=hR(ad.ids,af.ids),av.push({pos:ad.pos,ids:ag.tree}),ap=ap||ag.conflicts,ah=!0}else{if(ab!==!0){var aj=ad.pos<af.pos?ad:af,aq=ad.pos<af.pos?af:ad,al=aq.pos-aj.pos,am=[],ax=[];for(ax.push({ids:aj.ids,diff:al,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ak=0,aa=az.length;aa>ak;ak++){ax.push({ids:az[ak],diff:ay.diff-1,parent:ay.ids,parentIdx:ak})}}else{ay.ids[0]===aq.ids[0]&&am.push(ay)}}var au=am[0];au?(ag=hR(au.ids,aq.ids),au.parent[2][au.parentIdx]=ag.tree,av.push({pos:aj.pos,ids:aj.ids}),ap=ap||ag.conflicts,ah=!0):av.push(ad)}else{av.push(ad)}}}return ah||av.push(af),av.sort(iM),{tree:av,conflicts:ap||"internal_node"}}function a0(t,al){for(var ah,ak=iz(t),aj={},af=0,ap=ak.length;ap>af;af++){for(var ad=ak[af],am=ad.ids,aa=Math.max(0,am.length-al),ac={pos:ad.pos+aa,ids:i1(am,aa)},ag=0;aa>ag;ag++){var ab=ad.pos+ag+"-"+am[ag].id;aj[ab]=!0}ah=ah?ex(ah,ac,!0).tree:[ac]}return jl(ah,function(au,av,aq){delete aj[av+"-"+aq]}),{tree:ah,revs:Object.keys(aj)}}function bo(t,ab,ac){var aa=ex(t,ab),ad=a0(aa.tree,ac);return{tree:ad.tree,stemmedRevs:ad.revs,conflicts:aa.conflicts}}function g6(aa,aj){for(var ad,ag=aa.slice(),af=aj.split("-"),ac=parseInt(af[0],10),ak=af[1];ad=ag.pop();){if(ad.pos===ac&&ad.ids[0]===ak){return !0}for(var ah=ad.ids[2],ab=0,t=ah.length;t>ab;ab++){ag.push({pos:ad.pos+1,ids:ah[ab]})}}return !1}function gf(t){return t.ids}function jg(t,ab){ab||(ab=g9(t));for(var ac,aa=ab.substring(ab.indexOf("-")+1),ad=t.rev_tree.map(gf);ac=ad.pop();){if(ac[0]===aa){return !!ac[1].deleted}ad=ad.concat(ac[2])}}function V(t){return/^_local/.test(t)}function v(t){return g1("return "+t+";",{})}function fu(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function iN(ab,t){try{ab.emit("change",t)}catch(aa){jd("error",'Error in .on("change", function):',aa)}}function gz(ad,aa,ag){function t(){ac.cancel()}h5.EventEmitter.call(this);var ac=this;this.db=ad,aa=aa?g5(aa):{};var ab=aa.complete=jo(function(aj,ah){aj?h0(ac,"error")>0&&ac.emit("error",aj):ac.emit("complete",ah),ac.removeAllListeners(),ad.removeListener("destroyed",t)});ag&&(ac.on("complete",function(ah){ag(null,ah)}),ac.on("error",ag)),ad.once("destroyed",t),aa.onChange=function(ah){aa.isCancelled||(iN(ac,ah),ac.startSeq&&ac.startSeq<=ah.seq&&(ac.startSeq=!1))};var af=new je(function(aj,ah){aa.complete=function(al,ak){al?ah(al):aj(ak)}});ac.once("cancel",function(){ad.removeListener("destroyed",t),aa.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ab(null,ah)},ab),ad.taskqueue.isReady?ac.doChanges(aa):ad.taskqueue.addTask(function(){ac.isCancelled?ac.emit("cancel"):ac.doChanges(aa)})}function gC(t,ab,ac){var aa=[{rev:t._rev}];"all_docs"===ac.style&&(aa=jw(ab.rev_tree).map(function(af){return{rev:af.rev}}));var ad={id:ab.id,changes:aa,doc:t};return jg(ab,t._rev)&&(ad.deleted=!0),ac.conflicts&&(ad.doc._conflicts=iP(ab),ad.doc._conflicts.length||delete ad.doc._conflicts),ad}function ip(aa,t){return t>aa?-1:aa>t?1:0}function an(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function iD(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function l(t){for(var ab=0;ab<t.length;ab++){var ac=t[ab];if(ac._deleted){delete ac._attachments}else{if(ac._attachments){for(var aa=Object.keys(ac._attachments),ad=0;ad<aa.length;ad++){var af=aa[ad];ac._attachments[af]=ge(ac._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function j(t,ab){var ac=ip(t._id,ab._id);if(0!==ac){return ac}var aa=t._revisions?t._revisions.start:0,ad=ab._revisions?ab._revisions.start:0;return ip(aa,ad)}function fg(ab){var t={},aa=[];return jl(ab,function(ag,ah,af,ac){var ad=ah+"-"+af;return ag&&(t[ad]=0),void 0!==ac&&aa.push({from:ac,to:ad}),ad}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function fT(t,ab,ac){var aa="limit" in ab?ab.keys.slice(ab.skip,ab.limit+ab.skip):ab.skip>0?ab.keys.slice(ab.skip):ab.keys;if(ab.descending&&aa.reverse(),!aa.length){return t._allDocs({limit:0},ac)}var ad={offset:ab.skip};return je.all(aa.map(function(af){var ag=i.extend({key:af,deleted:"ok"},ab);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new je(function(aj,ah){t._allDocs(ag,function(ak,al){return ak?ah(ak):(ad.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ad.rows=af,ad})}function h1(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),ga.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&h1(t)})})})}function fW(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function iO(){h5.EventEmitter.call(this)}function hL(){this.isReady=!1,this.failed=!1,this.queue=[]}function fh(t){t&&jB.debug&&jd("error",t)}function ih(ad,aa){function ag(){ab.emit("destroyed",ac)}function t(){ad.removeListener("destroyed",ag),ad.emit("destroyed",ad)}var ac=aa.originalName,ab=ad.constructor,af=ab._destructionListeners;ad.once("destroyed",ag),af.has(ac)||af.set(ac,[]),af.get(ac).push(t)}function gh(ad,aa,ag){if(!(this instanceof gh)){return new gh(ad,aa,ag)}var t=this;if("function"!=typeof aa&&"undefined"!=typeof aa||(ag=aa,aa={}),ad&&"object"==typeof ad&&(aa=ad,ad=void 0),"undefined"==typeof ag){ag=fh}else{var ac=ag;ag=function(){return jd("warn","Using a callback for new PouchDB()is deprecated."),ac.apply(null,arguments)}}ad=ad||aa.name,aa=g5(aa),delete aa.name,this.__opts=aa;var ab=ag;t.auto_compaction=aa.auto_compaction,t.prefix=gh.prefix,iO.call(t),t.taskqueue=new hL;var af=new je(function(al,aj){ag=function(ap,am){return ap?aj(ap):(delete am.then,void al(am))},aa=g5(aa);var ak,ah;return function(){try{if("string"!=typeof ad){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}var ap=(aa.prefix||"")+ad;if(ak=gh.parseAdapter(ap,aa),aa.originalName=ad,aa.name=ak.name,aa.adapter=aa.adapter||ak.adapter,t._adapter=aa.adapter,hc("pouchdb:adapter")("Picked adapter: "+aa.adapter),t._db_name=ad,!gh.adapters[aa.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!gh.adapters[aa.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){t.taskqueue.fail(am)}}(),ah?aj(ah):(t.adapter=aa.adapter,t.replicate={},t.replicate.from=function(aq,am,ap){return t.constructor.replicate(aq,t,am,ap)},t.replicate.to=function(aq,am,ap){return t.constructor.replicate(t,aq,am,ap)},t.sync=function(aq,am,ap){return t.constructor.sync(t,aq,am,ap)},t.replicate.sync=t.sync,void gh.adapters[aa.adapter].call(t,aa,function(am){return am?(t.taskqueue.fail(am),void ag(am)):(ih(t,aa),t.emit("created",t),gh.emit("created",aa.originalName),t.taskqueue.ready(t),void ag(null,t))}))});af.then(function(ah){ab(null,ah)},ab),t.then=af.then.bind(af),t["catch"]=af["catch"].bind(af)}function fv(aa){Object.keys(h5.EventEmitter.prototype).forEach(function(ab){"function"==typeof h5.EventEmitter.prototype[ab]&&(aa[ab]=iV[ab].bind(iV))});var t=aa._destructionListeners=new gp.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function h2(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hn(t){if(!/^\d+\-./.test(t)){return hB(iX)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function eu(ad,aa){for(var ag=ad.start-ad.ids.length+1,t=ad.ids,ac=[t[0],aa,[]],ab=1,af=t.length;af>ab;ab++){ac=[t[ab],{status:"missing"},[ac]]}return[{pos:ag,ids:ac}]}function S(aa,aj){var ad,ag,af,ac={status:"available"};if(aa._deleted&&(ac.deleted=!0),aj){if(aa._id||(aa._id=gX()),ag=gX(32,16).toLowerCase(),aa._rev){if(af=hn(aa._rev),af.error){return af}aa._rev_tree=[{pos:af.prefix,ids:[af.id,{status:"missing"},[[ag,ac,[]]]]}],ad=af.prefix+1}else{aa._rev_tree=[{pos:1,ids:[ag,ac,[]]}],ad=1}}else{if(aa._revisions&&(aa._rev_tree=eu(aa._revisions,ac),ad=aa._revisions.start,ag=aa._revisions.ids[0]),!aa._rev_tree){if(af=hn(aa._rev),af.error){return af}ad=af.prefix,ag=af.id,aa._rev_tree=[{pos:ad,ids:[ag,ac,[]]}]}}ii(aa._id),aa._rev=ad+"-"+ag;var ak={metadata:{},data:{}};for(var ah in aa){if(Object.prototype.hasOwnProperty.call(aa,ah)){var ab="_"===ah[0];if(ab&&!iB[ah]){var t=hB(de,ah);throw t.message=de.message+": "+ah,t}ab&&!gu[ah]?ak.metadata[ah.slice(1)]=aa[ah]:ak.data[ah]=aa[ah]}}return ak}function hE(t){for(var ab="",ac=new Uint8Array(t),aa=ac.byteLength,ad=0;aa>ad;ad++){ab+=String.fromCharCode(ac[ad])}return ab}function hq(t){return gv(hE(t))}function go(t,ab){t=t||[],ab=ab||{};try{return new Blob(t,ab)}catch(ac){if("TypeError"!==ac.name){throw ac}for(var aa="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ad=new aa,af=0;af<t.length;af+=1){ad.append(t[af])}return ad.getBlob(ab.type)}}function ci(t){for(var ab=t.length,ac=new ArrayBuffer(ab),aa=new Uint8Array(ac),ad=0;ab>ad;ad++){aa[ad]=t.charCodeAt(ad)}return ac}function iS(aa,t){return go([ci(aa)],{type:t})}function iy(aa,t){return iS(bt(aa),t)}function I(t,ab){if("undefined"==typeof FileReader){return ab(hE((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(hE(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function R(aa,t){I(aa,function(ab){t(gv(ab))})}function jn(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function fx(t){return gv(t)}function hH(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function gl(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function a7(aa,aj){function ad(){var aq=ah*ac,al=aq+ac;if(ah++,ak>ah){t(ab,aa,aq,al),i4(ad)}else{t(ab,aa,aq,al);var ap=ab.end(!0),am=fx(ap);aj(am),ab.destroy()}}var ag="string"==typeof aa,af=ag?aa.length:aa.byteLength,ac=Math.min(iU,af),ak=Math.ceil(af/ac),ah=0,ab=ag?new ew:new ew.ArrayBuffer,t=ag?gl:hH;ad()}function hA(t){return ew.hash(t)}function Z(ac,aa,af){function ah(al){try{return bt(al)}catch(aj){var ak=hB(hy,"Attachment is not a valid base64 string");return{error:ak}}}function ag(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ah(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===aa?aj.data=iS(al,aj.content_type):"base64"===aa?aj.data=gv(al):aj.data=al,a7(al,function(am){aj.digest="md5-"+am,ak()})}else{jn(aj.data,function(am){"binary"===aa?aj.data=hE(am):"base64"===aa&&(aj.data=hq(am)),a7(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ab(){t++,ac.length===t&&(ad?af(ad):af())}if(!ac.length){return af()}var ad,t=0;ac.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ab()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ab()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ag(ak.data._attachments[ap],am)}})}function hv(ay,aa,aA,ah,am,av,ab,ax){if(g6(aa.rev_tree,aA.metadata.rev)){return ah[am]=aA,av()}var ak=aa.winningRev||g9(aa),au="deleted" in aa?aa.deleted:jg(aa,ak),aj="deleted" in aA.metadata?aA.metadata.deleted:jg(aA.metadata),aq=/^1-/.test(aA.metadata.rev);if(au&&!aj&&ax&&aq){var az=aA.data;az._rev=ak,az._id=aA.metadata.id,aA=S(az,ax)}var aw=bo(aa.rev_tree,aA.metadata.rev_tree[0],ay),ag=ax&&(au&&aj||!au&&"new_leaf"!==aw.conflicts||au&&!aj&&"new_branch"===aw.conflicts);if(ag){var ac=hB(io);return ah[am]=ac,av()}var t=aA.metadata.rev;aA.metadata.rev_tree=aw.tree,aA.stemmedRevs=aw.stemmedRevs||[],aa.rev_map&&(aA.metadata.rev_map=aa.rev_map);var af,al=g9(aA.metadata),ap=jg(aA.metadata,al),ad=au===ap?0:ap>au?-1:1;af=t===al?ap:jg(aA.metadata,t),ab(aA,al,ap,af,!0,ad,am,av)}function gI(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ja(aa,ak,ah,aq,am,af,al,ag,ap){function au(aw,aA,aC){var ay=g9(aw.metadata),az=jg(aw.metadata,ay);if("was_delete" in ag&&az){return af[aA]=hB(h7,"deleted"),aC()}var av=ad&&gI(aw);if(av){var ax=hB(io);return af[aA]=ax,aC()}var aB=az?0:1;al(aw,ay,az,az,!1,aB,aA,aC)}function ac(){++aj===t&&ap&&ap()}aa=aa||1000;var ad=ag.new_edits,ab=new gp.Map,aj=0,t=ak.length;ak.forEach(function(aw,ay){if(aw._id&&V(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void ah[ax](aw,{ctx:am},function(aA,az){af[ay]=aA||az,ac()})}var av=aw.metadata.id;ab.has(av)?(t--,ab.get(av).push([aw,ay])):ab.set(av,[[aw,ay]])}),ab.forEach(function(ay,aw){function ax(){++az<ay.length?av():ac()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(aq.has(aw)){hv(aa,aq.get(aw),aA,af,aB,ax,al,ad)}else{var aD=bo([],aA.metadata.rev_tree[0],aa);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],au(aA,aB,ax)}}var az=0;av()})}function it(aa){try{return JSON.parse(aa)}catch(t){return hg.parse(aa)}}function hf(t){return t.length<50000?JSON.parse(t):it(t)}function H(aa){try{return JSON.stringify(aa)}catch(t){return hg.stringify(aa)}}function bn(t,ab,ac,aa){try{t.apply(ab,ac)}catch(ad){aa.emit("error",ad)}}function hX(aa){if(!i0.running&&i0.queue.length){i0.running=!0;var t=i0.queue.shift();t.action(function(ac,ab){bn(t.callback,this,[ac,ab],aa),i0.running=!1,ga.nextTick(function(){hX(aa)})})}}function ji(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(hB(hY,aa,ab.type))}}function i3(ab,t,aa){return{data:H(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function jD(aa){if(!aa){return null}var t=hf(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function gy(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function hs(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:iy(t,ab):go([""],{type:ab})):t?"string"!=typeof t?I(t,function(ad){aa(gv(ad))}):aa(t):aa("")}function iJ(ac,aa,af,ah){function ag(){++t===ad.length&&ah&&ah()}function ab(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=af.objectStore(J).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ag()}}var ad=Object.keys(ac._attachments||{});if(!ad.length){return ah&&ah()}var t=0;ad.forEach(function(aj){aa.attachments&&aa.include_docs?ab(ac,aj):(ac._attachments[aj].stub=!0,ag())})}function i2(aa,t){return je.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return je.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new je(function(aj){hs(ah,af,t,function(ak){ac.doc._attachments[ag]=i.extend(ge(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function jq(aa,aj,ad){function ag(){t--,t||af()}function af(){ac.length&&ac.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ah["delete"](am)}})}var ac=[],ak=ad.objectStore(h8),ah=ad.objectStore(J),ab=ad.objectStore(iR),t=aa.length;aa.forEach(function(al){var am=ak.index("_doc_id_rev"),ap=aj+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return ag()}ak["delete"](aq);var au=ab.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];ac.push(ay),ab["delete"](ax.primaryKey),ax["continue"]()}else{ag()}}}})}function Y(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function iI(am,aB,ap,au,az,ay,aF){function aH(){var aN=[g2,h8,J,hV,iR],aO=Y(az,aN,"readwrite");return aO.error?aF(aO.error):(av=aO.txn,av.onabort=ji(aF),av.ontimeout=ji(aF),av.oncomplete=aJ,ah=av.objectStore(g2),al=av.objectStore(h8),aa=av.objectStore(J),aC=av.objectStore(iR),void aM(function(aP){return aP?(ac=!0,aF(aP)):void aL()}))}function ax(){ja(am.revs_limit,aw,au,aq,av,aE,aI,ap)}function aL(){function aR(){++aP===aw.length&&ax()}function aT(aU){var aV=jD(aU.target.result);aV&&aq.set(aV.id,aV),aR()}if(aw.length){for(var aP=0,aS=0,aQ=aw.length;aQ>aS;aS++){var aN=aw[aS];if(aN._id&&V(aN._id)){aR()}else{var aO=ah.get(aN.metadata.id);aO.onsuccess=aT}}}}function aJ(){ac||(ay.notify(au._meta.name),au._meta.docCount+=aA,aF(null,aE))}function aG(aO,aP){var aN=aa.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=hB(ht,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aw.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aG(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aI(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aD(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bc){var ba=aP.stemmedRevs||[];aV&&au.auto_compaction&&(ba=ba.concat(di(aP.metadata))),ba&&ba.length&&jq(ba,aP.metadata.id,av),aT.seq=bc.target.result,delete aT.rev;var bb=i3(aT,aW,aU),aZ=ah.put(bb);aZ.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=al.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=al.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aE[aS]={ok:!0,id:aT.id,rev:aW},aq.set(aP.metadata.id,aP.metadata),aj(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=al.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aD(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;ag(ba,bb,aV)}})}function aj(aP,aS,aN){function aQ(){++aT===aU.length&&aN()}function aO(aX){var aV=aP.data._attachments[aX].digest,aW=aC.put({seq:aS,digestSeq:aV+"::"+aS});aW.onsuccess=aQ,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aQ()}}var aT=0,aU=Object.keys(aP.data._attachments||{});if(!aU.length){return aN()}for(var aR=0;aR<aU.length;aR++){aO(aU[aR])}}function ag(aO,aQ,aN){var aP=aa.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=aa.put(aU);aR.onsuccess=aN}}for(var av,ah,al,aa,aC,ab,aw=aB.docs,aA=0,t=0,af=aw.length;af>t;t++){var ak=aw[t];ak._id&&V(ak._id)||(ak=aw[t]=S(ak,ap.new_edits),ak.error&&!ab&&(ab=ak))}if(ab){return aF(ab)}var aE=new Array(aw.length),aq=new gp.Map,ac=!1,aK=au._meta.blobSupport?"blob":"base64";Z(aw,aK,function(aN){return aN?aF(aN):void aH()})}function id(t,ab,ac,aa,ad){try{if(t&&ab){return ad?IDBKeyRange.bound(ab,t,!ac,!1):IDBKeyRange.bound(t,ab,!1,!ac)}if(t){return ad?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t)}if(ab){return ad?IDBKeyRange.lowerBound(ab,!ac):IDBKeyRange.upperBound(ab,!ac)}if(aa){return IDBKeyRange.only(aa)}}catch(af){return{error:af}}return null}function ft(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(hB(hY,ac.name,ac.message))}function ix(t,ab,ac,aa){function ad(aE,aq){function ay(aL,aM,aK){var aN=aL.id+"::"+aK;aF.get(aN).onsuccess=function(aO){aM.doc=gy(aO.target.result),aE.conflicts&&(aM.doc._conflicts=iP(aL)),iJ(aM.doc,aE,au)}}function av(aO,aM,aN){var aK={id:aN.id,key:aN.id,value:{rev:aM}},aL=aN.deleted;if("ok"===aE.deleted){ap.push(aK),aL?(aK.value.deleted=!0,aK.doc=null):aE.include_docs&&ay(aN,aK,aM)}else{if(!aL&&al--<=0&&(ap.push(aK),aE.include_docs&&ay(aN,aK,aM),0===--aw)){return}}aO["continue"]()}function ah(aK){ag=ab._meta.docCount;var aM=aK.target.result;if(aM){var aL=jD(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aG(){aq(null,{total_rows:ag,offset:aE.skip,rows:ap})}function aB(){aE.attachments?i2(ap,aE.binary).then(aG):aG()}var aA="startkey" in aE?aE.startkey:!1,aC="endkey" in aE?aE.endkey:!1,am="key" in aE?aE.key:!1,al=aE.skip||0,aw="number"==typeof aE.limit?aE.limit:-1,ax=aE.inclusive_end!==!1,ak="descending" in aE&&aE.descending?"prev":null,aH=id(aA,aC,ax,am,ak);if(aH&&aH.error){return ft(ab,aE,aH.error,aq)}var aj=[g2,h8];aE.attachments&&aj.push(J);var aD=Y(ac,aj,"readonly");if(aD.error){return aq(aD.error)}var au=aD.txn,az=au.objectStore(g2),aI=au.objectStore(h8),aJ=ak?az.openCursor(aH,ak):az.openCursor(aH),aF=aI.index("_doc_id_rev"),ap=[],ag=0;au.oncomplete=aB,aJ.onsuccess=ah}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ab._meta.docCount,offset:ah.skip,rows:[]}):void ad(ah,ag)}af(t,aa)}function hz(t){return new je(function(ab){var aa=go([""]);t.objectStore(jf).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function a8(ab,t){var aa=this;i0.queue.push({action:function(ac){jv(aa,ab,ac)},callback:t}),hX(aa.constructor)}function jv(ac,ab,am){function ak(au){var av=au.createObjectStore(g2,{keyPath:"id"});au.createObjectStore(h8,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(J,{keyPath:"digest"}),au.createObjectStore(im,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jf),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(hV,{keyPath:"_id"});var aw=au.createObjectStore(iR,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function aj(au,av){var aw=au.objectStore(g2);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=jg(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ap(au){au.createObjectStore(hV,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ad(aw,az){var av=aw.objectStore(hV),ay=aw.objectStore(g2),ax=aw.objectStore(h8),au=ay.openCursor();au.onsuccess=function(aJ){var aA=aJ.target.result;if(aA){var aG=aA.value,aD=aG.id,aE=V(aD),aH=g9(aG);if(aE){var aK=aD+"::"+aH,aB=aD+"::",aI=aD+"::~",aL=ax.index("_doc_id_rev"),aC=IDBKeyRange.bound(aB,aI,!1,!1),aF=aL.openCursor(aC);aF.onsuccess=function(aN){if(aF=aN.target.result){var aM=aF.value;aM._doc_id_rev===aK&&av.put(aM),ax["delete"](aF.primaryKey),aF["continue"]()}else{ay["delete"](aA.primaryKey),aA["continue"]()}}}else{aA["continue"]()}}else{az&&az()}}}function ah(au){var av=au.createObjectStore(iR,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ag(aw,az){var av=aw.objectStore(h8),ay=aw.objectStore(J),ax=aw.objectStore(iR),au=ay.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (av.openCursor().onsuccess=function(aH){var aL=aH.target.result;if(!aL){return az()}for(var aC=aL.value,aJ=aL.primaryKey,aF=Object.keys(aC._attachments||{}),aD={},aE=0;aE<aF.length;aE++){var aG=aC._attachments[aF[aE]];aD[aG.digest]=!0}var aI=Object.keys(aD);for(aE=0;aE<aI.length;aE++){var aK=aI[aE];ax.put({seq:aJ,digestSeq:aK+"::"+aJ})}aL["continue"]()}):az()}}function aa(au){function ay(az){return az.data?jD(az):(az.deleted="1"===az.deletedOrLocal,az)}var av=au.objectStore(h8),aw=au.objectStore(g2),ax=aw.openCursor();ax.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=av.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=i3(az,az.winningRev,az.deleted),aF=aw.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=ay(aA.value);return az.winningRev=az.winningRev||g9(az),az.seq?aD():void aB()}}}var al=ab.name,aq=null;ac._meta=null,ac.type=function(){return"idb"},ac._id=fi(function(au){au(null,ac._meta.instanceId)}),ac._bulkDocs=function(aw,av,au){iI(ab,aw,av,ac,aq,gS,au)},ac._get=function(ax,aC,au){function az(){au(aw,{doc:ay,metadata:aA,ctx:aB})}var ay,aA,aw,aB=aC.ctx;if(!aB){var av=Y(aq,[g2,h8,J],"readonly");if(av.error){return au(av.error)}aB=av.txn}aB.objectStore(g2).get(ax).onsuccess=function(aG){if(aA=jD(aG.target.result),!aA){return aw=hB(h7,"missing"),az()}if(jg(aA)&&!aC.rev){return aw=hB(h7,"deleted"),az()}var aE=aB.objectStore(h8),aD=aC.rev||aA.winningRev,aF=aA.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return ay=aH.target.result,ay&&(ay=gy(ay)),ay?void az():(aw=hB(h7,"missing"),az())}}},ac._getAttachment=function(ax,aC,au,az,ay){var aA;if(az.ctx){aA=az.ctx}else{var aw=Y(aq,[g2,h8,J],"readonly");if(aw.error){return ay(aw.error)}aA=aw.txn}var aB=au.digest,av=au.content_type;aA.objectStore(J).get(aB).onsuccess=function(aE){var aD=aE.target.result.body;hs(aD,av,az.binary,function(aF){ay(null,aF)})}},ac._info=function(av){if(null===aq||!iL.has(al)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,aw,au=Y(aq,[h8],"readonly");if(au.error){return av(au.error)}var ay=au.txn,ax=ay.objectStore(h8).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,aw=ac._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:az,idb_attachment_format:ac._meta.blobSupport?"binary":"base64"})}},ac._allDocs=function(av,au){ix(av,ac,aq,au)},ac._changes=function(aG){function ax(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aL=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aJ.get(aU);aT.onsuccess=function(aV){aO(gy(aV.target.result))}}function aO(aU){var aT=aG.processChange(aU,aN,aG);aT.seq=aN.seq;var aV=aI(aT);return"object"==typeof aV?aG.complete(aV):(aV&&(aD++,az&&aw.push(aT),aG.attachments&&aG.include_docs?iJ(aU,aG,aB,function(){i2([aT],aG.binary).then(function(){aG.onChange(aT)})}):aG.onChange(aT)),void (aD!==aK&&aS["continue"]()))}var aQ=gy(aS.value),aR=aS.key;if(av&&!av.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aF.get(aQ._id).onsuccess=function(aT){aN=jD(aT.target.result),ay.set(aQ._id,aN),aM()})}function aE(aN){var aM=aN.target.result;aM&&ax(aM)}function aA(){var aM=[g2,h8];aG.attachments&&aM.push(J);var aN=Y(aq,aM,"readonly");if(aN.error){return aG.complete(aN.error)}aB=aN.txn,aB.onabort=ji(aG.complete),aB.oncomplete=au,aH=aB.objectStore(h8),aF=aB.objectStore(g2),aJ=aH.index("_doc_id_rev");var aO;aO=aG.descending?aH.openCursor(null,"prev"):aH.openCursor(IDBKeyRange.lowerBound(aG.since,!0)),aO.onsuccess=aE}function au(){function aM(){aG.complete(null,{results:aw,last_seq:aL})}!aG.continuous&&aG.attachments?i2(aw).then(aM):aM()}if(aG=g5(aG),aG.continuous){var aC=al+":"+gX();return gS.addListener(al,aC,ac,aG),gS.notify(al),{cancel:function(){gS.removeListener(al,aC)}}}var av=aG.doc_ids&&new gp.Set(aG.doc_ids);aG.since=aG.since||0;var aL=aG.since,aK="limit" in aG?aG.limit:-1;0===aK&&(aK=1);var az;az="return_docs" in aG?aG.return_docs:"returnDocs" in aG?aG.returnDocs:!0;var aB,aH,aF,aJ,aw=[],aD=0,aI=gd(aG),ay=new gp.Map;aA()},ac._close=function(au){return null===aq?au(hB(fX)):(aq.close(),iL["delete"](al),aq=null,void au())},ac._getRevisionTree=function(au,ay){var av=Y(aq,[g2],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(g2).get(au);ax.onsuccess=function(aA){var az=jD(aA.target.result);az?ay(null,az.rev_tree):ay(hB(h7))}},ac._doCompaction=function(aA,av,aw){var ax=[g2,h8,J,iR],az=Y(aq,ax,"readwrite");if(az.error){return aw(az.error)}var au=az.txn,ay=au.objectStore(g2);ay.get(aA).onsuccess=function(aC){var aE=jD(aC.target.result);jl(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),jq(av,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(g2).put(i3(aE,aD,aB))},au.onabort=ji(aw),au.oncomplete=function(){aw()}},ac._getLocal=function(au,ay){var av=Y(aq,[hV],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(hV).get(au);ax.onerror=ji(ay),ax.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ay(null,az)):ay(hB(h7))}},ac._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=Y(aq,[hV],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=ji(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(hV);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(hB(io))}}):(au=ax.add(ay),au.onerror=function(aE){av(hB(io)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ac._removeLocal=function(ax,aC,au){"function"==typeof aC&&(au=aC,aC={});var az=aC.ctx;if(!az){var ay=Y(aq,[hV],"readwrite");if(ay.error){return au(ay.error)}az=ay.txn,az.oncomplete=function(){aA&&au(null,aA)}}var aA,aw=ax._id,aB=az.objectStore(hV),av=aB.get(aw);av.onerror=ji(au),av.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ax._rev?(aB["delete"](aw),aA={ok:!0,id:aw,rev:"0-0"},aC.ctx&&au(null,aA)):au(hB(h7))}},ac._destroy=function(aw,au){gS.removeAllListeners(al);var av=hD.get(al);av&&av.result&&(av.result.close(),iL["delete"](al));var ax=indexedDB.deleteDatabase(al);ax.onsuccess=function(){hD["delete"](al),er()&&al in localStorage&&delete localStorage[al],au(null,{ok:!0})},ax.onerror=ji(au)};var af=iL.get(al);if(af){return aq=af.idb,ac._meta=af.global,void ga.nextTick(function(){am(null,ac)})}var t;t=ab.storage?O(al,ab.storage):indexedDB.open(al,g3),hD.set(al,t),t.onupgradeneeded=function(az){function aw(){var aA=ax[au-1];au++,aA&&aA(av,aw)}var ay=az.target.result;if(az.oldVersion<1){return ak(ay)}var av=az.currentTarget.transaction;az.oldVersion<3&&ap(ay),az.oldVersion<4&&ah(ay);var ax=[aj,ad,ag,aa],au=az.oldVersion;aw()},t.onsuccess=function(ay){aq=ay.target.result,aq.onversionchange=function(){aq.close(),iL["delete"](al)},aq.onabort=function(aA){jd("error","Database has a global failure",aA.target.error),aq.close(),iL["delete"](al)};var av=aq.transaction([im,jf,g2],"readwrite"),ax=av.objectStore(im).get(im),az=null,aw=null,au=null;ax.onsuccess=function(aB){var aD=function(){null!==az&&null!==aw&&null!==au&&(ac._meta={name:al,instanceId:au,blobSupport:az,docCount:aw},iL.set(al,{idb:aq,global:ac._meta}),am(null,ac))},aA=aB.target.result||{id:im};al+"_id" in aA?(au=aA[al+"_id"],aD()):(au=gX(),aA[al+"_id"]=au,av.objectStore(im).put(aA).onsuccess=function(){aD()}),fm||(fm=hz(av)),fm.then(function(aE){az=aE,aD()});var aC=av.objectStore(g2).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){aw=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";jd("error",au),am(hB(hY,au))}}function O(ab,t){try{return indexedDB.open(ab,{version:g3,storage:t})}catch(aa){return indexedDB.open(ab,g3)}}function jy(t){t.adapter("idb",a8,!0)}function jx(t){return decodeURIComponent(escape(t))}function hT(t){return 65>t?t-48:t-55}function y(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hT(t.charCodeAt(ab++))<<4|hT(t.charCodeAt(ab++)))}return aa}function hW(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(hT(t.charCodeAt(ab+2))<<12|hT(t.charCodeAt(ab+3))<<8|hT(t.charCodeAt(ab))<<4|hT(t.charCodeAt(ab+1))),ab+=4}return aa}function js(aa,t){return"UTF-8"===t?jx(y(aa,0,aa.length)):hW(aa,0,aa.length)}function gj(t){return"'"+t+"'"}function hN(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function ig(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function iH(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hk(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function ie(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function ir(t,ab,ac,aa,ad){return"SELECT "+t+" FROM "+("string"==typeof ab?ab:ab.join(" JOIN "))+(ac?" ON "+ac:"")+(aa?" WHERE "+("string"==typeof aa?aa:aa.join(" AND ")):"")+(ad?" ORDER BY "+ad:"")}function iw(ad,aa,ag){function t(){++ab===ad.length&&ac()}function ac(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+T+" WHERE seq IN "+ie(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+T+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+T+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new gp.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+T+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+iK+" WHERE digest=?",[az]))})})})}})}}if(ad.length){var ab=0,af=[];ad.forEach(function(aj){var ah="SELECT seq FROM "+gr+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[aa,aj],function(al,am){if(!am.rows.length){return t()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+gr+" WHERE seq=?",[ak],t)})})}}function jp(t){return function(ad){jd("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(hB(ik,ab,ac))}}function gQ(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function jc(aw,t,ax,aB,az,ay,ad){function au(){return am?ad(am):(ay.notify(aB._name),aB._docCount=-1,void ad(null,ac))}function aa(aD,aE){var aC="SELECT count(*) as cnt FROM "+iK+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=hB(ht,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function al(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aa(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ak(aM,aE,aJ,aO,aQ,aH,aC,aF){function aK(){function aW(bc,bb){function ba(){return ++bg===bd.length&&bb(),!1}function aZ(bj){var bi="INSERT INTO "+T+" (digest, seq) VALUES (?,?)",bh=[aX._attachments[bj].digest,bc];ap.executeSql(bi,bh,ba,ba)}var bg=0,bd=Object.keys(aX._attachments||{});if(!bd.length){return bb()}for(var bf=0;bf<bd.length;bf++){aZ(bd[bf])}}var aX=aM.data,aU=aO?1:0,aR=aX._id,aV=aX._rev,aT=iH(aX),aS="INSERT INTO "+gr+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aY=[aR,aV,aT,aU];ap.executeSql(aS,aY,function(ba,bb){var aZ=bb.insertId;aW(aZ,function(){aL(ba,aZ)})},function(){var aZ=ir("seq",gr,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aR,aV],function(bc,bb){var bf=bb.rows.item(0).seq,bd="UPDATE "+gr+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aT,aU,aR,aV];bc.executeSql(bd,ba,function(bg){aW(bf,function(){aL(bg,bf)})})}),!1})}function aN(aR){aP||(aR?(aP=aR,aF(aP)):aG===aI.length&&aK())}function aD(aR){aG++,aN(aR)}function aL(aT,aU){var aR=aM.metadata.id,aS=aM.stemmedRevs||[];aQ&&aB.auto_compaction&&(aS=di(aM.metadata).concat(aS)),aS.length&&iw(aS,aR,aT),aM.metadata.seq=aU,delete aM.metadata.rev;var aX=aQ?"UPDATE "+hu+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+gr+" WHERE doc_id="+hu+".id AND rev=?) WHERE id=?":"INSERT INTO "+hu+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aW=H(aM.metadata),aV=aQ?[aW,aU,aE,aR]:[aR,aU,aU,aW];aT.executeSql(aX,aV,function(){ac[aC]={ok:!0,id:aM.metadata.id,rev:aE},ah.set(aR,aM.metadata),aF()})}var aP=null,aG=0;aM.data._id=aM.metadata.id,aM.data._rev=aM.metadata.rev;var aI=Object.keys(aM.data._attachments||{});aO&&(aM.data._deleted=!0),aI.forEach(function(aU){var aS=aM.data._attachments[aU];if(aS.stub){aG++,aN()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aE,10);var aT=aS.digest;aA(aT,aR,aD)}}),aI.length||aK()}function af(){ja(aw.revs_limit,aq,aB,ah,ap,ac,ak,ax)}function av(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&V(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hu+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=hf(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function aA(aD,aF,aC){var aE="SELECT digest FROM "+iK+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iK+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,hN(aF)],function(){aC()},function(){return aC(),!1}))})}var ag=ax.new_edits,ab=t.docs,aq=ab.map(function(aC){if(aC._id&&V(aC._id)){return aC}var aD=S(aC,ag);return aD}),aj=aq.filter(function(aC){return aC.error});if(aj.length){return ad(aj[0])}var ap,am,ac=new Array(aq.length),ah=new gp.Map;Z(aq,"binary",function(aC){return aC?ad(aC):void az.transaction(function(aD){ap=aD,al(function(aE){aE?am=aE:av(af)})},jp(ad),au)})}function ff(t){return t.websql(t.name,t.version,t.description,t.size)}function hm(aa){try{return{db:ff(aa)}}catch(t){return{error:t}}}function gZ(aa){var t=i9.get(aa.name);return t||(t=hm(aa),i9.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function gn(ad,aa,ag,aj,af){function ac(){++ab===ah.length&&af&&af()}function t(am,ak){var al=am._attachments[ak],ap={binary:aa.binary,ctx:aj};ag._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=i.extend(ge(al,["digest","content_type"]),{data:au}),ac()})}var ah=Object.keys(ad._attachments||{});if(!ah.length){return af&&af()}var ab=0;ah.forEach(function(ak){aa.attachments&&aa.include_docs?t(ad,ak):(ad._attachments[ak].stub=!0,ac())})}function gA(ak,aw){function ax(){er()&&(window.localStorage["_pouch__websqldb_"+ab._name]=!0),aw(null,ab)}function av(aD,aE){aD.executeSql(hQ),aD.executeSql("ALTER TABLE "+gr+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(fp),aD.executeSql("ALTER TABLE "+hu+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hu+" (local, id)");var aF="SELECT "+hu+".winningseq AS seq, "+hu+".json AS metadata FROM "+gr+" JOIN "+hu+" ON "+gr+".seq = "+hu+".winningseq";aD.executeSql(aF,[],function(aI,aM){for(var aJ=[],aG=[],aN=0;aN<aM.rows.length;aN++){var aL=aM.rows.item(aN),aK=aL.seq,aH=JSON.parse(aL.metadata);jg(aH)&&aJ.push(aK),V(aH.id)&&aG.push(aH.id)}aI.executeSql("UPDATE "+hu+"SET local = 1 WHERE id IN "+ie(aG.length),aG,function(){aI.executeSql("UPDATE "+gr+" SET deleted = 1 WHERE seq IN "+ie(aJ.length),aJ,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+jj+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hu+".id AS id, "+gr+".json AS data FROM "+gr+" JOIN "+hu+" ON "+gr+".seq = "+hu+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aK,aI){function aL(){if(!aJ.length){return aF(aK)}var aM=aJ.shift(),aN=JSON.parse(aM.data)._rev;aK.executeSql("INSERT INTO "+jj+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hu+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+gr+" WHERE seq=?",[aM.seq],function(){aL()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aL()})})}function aB(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aN=aI.shift(),aJ=js(aN.hex,am),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+gr+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aH()})}aH()}var aF="ALTER TABLE "+gr+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+gr+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(gH,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+gr;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function aj(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+iK;aH.executeSql(aI,[],function(aO,aM){function aJ(){var aP=ir(gq+", "+hu+".id AS id",[hu,gr],jh,null,hu+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aX){function aT(bc,bd){var bf=aV[bc]=aV[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aX.rows.length){return aG(ba)}for(var aV={},aQ=0;aQ<aX.rows.length;aQ++){for(var aY=aX.rows.item(aQ),aZ=hk(aY.data,aY.id,aY.rev),aU=Object.keys(aZ._attachments||{}),aS=0;aS<aU.length;aS++){var aW=aZ._attachments[aU[aS]];aT(aW.digest,aY.seq)}}var aR=[];if(Object.keys(aV).forEach(function(bc){var bd=aV[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aJ()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+T+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+T+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(hJ,[],function(aI){aI.executeSql(U,[],aD)})})}function ah(aE,aF){var aD="ALTER TABLE "+iK+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+hu+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hu+" SET max_seq=(SELECT MAX(seq) FROM "+gr+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hu+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ac(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;am=2===aG.length?"UTF-8":"UTF-16",aE()})}function aa(){for(;aA.length>0;){var aD=aA.pop();aD(null,ay)}}function ag(aD,aH){if(0===aH){var aK="CREATE TABLE IF NOT EXISTS "+h6+" (dbid, db_version INTEGER)",aN="CREATE TABLE IF NOT EXISTS "+iK+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aE="CREATE TABLE IF NOT EXISTS "+T+" (digest, seq INTEGER)",aG="CREATE TABLE IF NOT EXISTS "+hu+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aF="CREATE TABLE IF NOT EXISTS "+gr+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aL="CREATE TABLE IF NOT EXISTS "+jj+" (id UNIQUE, rev, json)";aD.executeSql(aN),aD.executeSql(aL),aD.executeSql(aE,[],function(){aD.executeSql(U),aD.executeSql(hJ)}),aD.executeSql(aG,[],function(){aD.executeSql(hQ),aD.executeSql(aF,[],function(){aD.executeSql(fp),aD.executeSql(gH),aD.executeSql(aK,[],function(){var aP="INSERT INTO "+h6+" (db_version, dbid) VALUES (?,?)";ay=gX();var aQ=[jz,ay];aD.executeSql(aP,aQ,function(){aa()})})})})}else{var aJ=function(){var aQ=jz>aH;aQ&&aD.executeSql("UPDATE "+h6+" SET db_version = "+jz);var aP="SELECT dbid FROM "+h6;aD.executeSql(aP,[],function(aR,aS){ay=aS.rows.item(0).dbid,aa()})},aM=[av,aq,aB,aj,ah,ap,aJ],aO=aH,aI=function(aP){aM[aO-1](aP,aI),aO++};aI(aD)}}function aC(){af.transaction(function(aD){ac(aD,function(){ad(aD)})},jp(aw),ax)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+h6;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+h6,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;ag(aJ,aI)}):aF.executeSql("ALTER TABLE "+h6+" ADD COLUMN db_version INTEGER",[],function(){ag(aF,1)}):ag(aF,0)})}function az(aE,aF){if(-1!==ab._docCount){return aF(ab._docCount)}var aD=ir("COUNT("+hu+".id) AS 'num'",[hu,gr],jh,gr+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ab._docCount=aH.rows.item(0).num,aF(ab._docCount)})}var am,ab=this,ay=null,au=gQ(ak),aA=[];ab._docCount=-1,ab._name=ak.name;var al=i.extend({},ak,{version:B,description:ak.name,size:au}),t=gZ(al);if(t.error){return jp(aw)(t.error)}var af=t.db;"function"!=typeof af.readTransaction&&(af.readTransaction=af.transaction),aC(),ab.type=function(){return"websql"},ab._id=fi(function(aD){aD(null,ay)}),ab._info=function(aD){af.readTransaction(function(aE){az(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+gr;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:af._sqlitePlugin,websql_encoding:am})})})},jp(aD))},ab._bulkDocs=function(aF,aD,aE){jc(ak,aF,aD,ab,af,il,aE)},ab._get=function(aE,aD,aG){function aJ(){aG(aL,{doc:aI,metadata:aF,ctx:aH})}var aI,aF,aL,aH=aD.ctx;if(!aH){return af.readTransaction(function(aN){ab._get(aE,i.extend({ctx:aN},aD),aG)})}var aK,aM;aD.rev?(aK=ir(gq,[hu,gr],hu+".id="+gr+".doc_id",[gr+".doc_id=?",gr+".rev=?"]),aM=[aE,aD.rev]):(aK=ir(gq,[hu,gr],jh,hu+".id=?"),aM=[aE]),aH.executeSql(aK,aM,function(aP,aO){if(!aO.rows.length){return aL=hB(h7,"missing"),aJ()}var aN=aO.rows.item(0);return aF=hf(aN.metadata),aN.deleted&&!aD.rev?(aL=hB(h7,"deleted"),aJ()):(aI=hk(aN.data,aF.id,aN.rev),void aJ())})},ab._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(hu+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(hu+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(hu+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(hu+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(gr+".deleted = 0"),af.readTransaction(function(aR){az(aR,function(aT){if(aM=aT,0!==aO){var aS=ir(gq,[hu,gr],jh,aE,hu+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aY,aV){for(var aW=0,bb=aV.rows.length;bb>aW;aW++){var aZ=aV.rows.item(aW),aX=hf(aZ.metadata),bc=aX.id,ba=hk(aZ.data,bc,aZ.rev),aU=ba._rev,bd={id:bc,key:bc,value:{rev:aU}};if(aJ.include_docs&&(bd.doc=ba,bd.doc._rev=aU,aJ.conflicts&&(bd.doc._conflicts=iP(aX)),gn(bd.doc,aJ,ab,aY)),aZ.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},jp(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},ab._changes=function(aJ){function aI(){var aN=hu+".json AS metadata, "+hu+".max_seq AS maxSeq, "+gr+".json AS winningDoc, "+gr+".rev AS winningRev ",aM=hu+" JOIN "+gr,aO=hu+".id="+gr+".doc_id AND "+hu+".winningseq="+gr+".seq",aP=["maxSeq > ?"],aR=[aJ.since];aJ.doc_ids&&(aP.push(hu+".id IN "+ie(aJ.doc_ids.length)),aR=aR.concat(aJ.doc_ids));var aL="maxSeq "+(aE?"DESC":"ASC"),aS=ir(aN,aM,aO,aP,aL),aT=gd(aJ);aJ.view||aJ.filter||(aS+=" LIMIT "+aH);var aQ=aJ.since||0;af.readTransaction(function(aU){aU.executeSql(aS,aR,function(aX,aW){function aY(bg){return function(){aJ.onChange(bg)}}for(var bc=0,bd=aW.rows.length;bd>bc;bc++){var aV=aW.rows.item(bc),aZ=hf(aV.metadata);aQ=aV.maxSeq;var bf=hk(aV.winningDoc,aZ.id,aV.winningRev),ba=aJ.processChange(bf,aZ,aJ);ba.seq=aV.maxSeq;var bb=aT(ba);if("object"==typeof bb){return aJ.complete(bb)}if(bb&&(aF++,aK&&aD.push(ba),aJ.attachments&&aJ.include_docs?gn(bf,aJ,ab,aX,aY(ba)):aY(ba)()),aF===aH){break}}})},jp(aJ.complete),function(){aJ.continuous||aJ.complete(null,{results:aD,last_seq:aQ})})}if(aJ=g5(aJ),aJ.continuous){var aG=ab._name+":"+gX();return il.addListener(ab._name,aG,ab,aJ),il.notify(ab._name),{cancel:function(){il.removeListener(ab._name,aG)}}}var aE=aJ.descending;aJ.since=aJ.since&&!aE?aJ.since:0;var aH="limit" in aJ?aJ.limit:-1;0===aH&&(aH=1);var aK;aK="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aD=[],aF=0;aI()},ab._close=function(aD){aD()},ab._getAttachment=function(aE,aD,aG,aJ,aI){var aF,aL=aJ.ctx,aH=aG.digest,aK=aG.content_type,aM="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iK+" WHERE digest=?";aL.executeSql(aM,[aH],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?ig(aO.body):js(aO.body,am);aF=aJ.binary?iS(aN,aK):gv(aN),aI(null,aF)})},ab._getRevisionTree=function(aD,aE){af.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hu+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=hf(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(hB(h7))}})})},ab._doCompaction=function(aE,aF,aD){return aF.length?void af.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hu+" WHERE id = ?";aH.executeSql(aG,[aE],function(aL,aJ){var aI=hf(aJ.rows.item(0).metadata);jl(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+hu+" SET json = ? WHERE id = ?";aL.executeSql(aK,[H(aI),aE])}),iw(aF,aE,aH)},jp(aD),function(){aD()}):aD()},ab._getLocal=function(aD,aE){af.readTransaction(function(aF){var aG="SELECT json, rev FROM "+jj+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=hk(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(hB(h7))}})})},ab._putLocal=function(aK,aG,aD){function aF(aO){var aM,aN;aL?(aM="UPDATE "+jj+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aE,aH,aI,aL]):(aM="INSERT INTO "+jj+" (id, rev, json) VALUES (?,?,?)",aN=[aI,aE,aH]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aJ={ok:!0,id:aI,rev:aE},aG.ctx&&aD(null,aJ)):aD(hB(io))},function(){return aD(hB(io)),!1})}"function"==typeof aG&&(aD=aG,aG={}),delete aK._revisions;var aE,aL=aK._rev,aI=aK._id;aE=aL?aK._rev="0-"+(parseInt(aL.split("-")[1],10)+1):aK._rev="0-1";var aJ,aH=iH(aK);aG.ctx?aF(aG.ctx):af.transaction(aF,jp(aD),function(){aJ&&aD(null,aJ)})},ab._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+jj+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(hB(h7))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):af.transaction(aF,jp(aH),function(){aD&&aH(null,aD)})},ab._destroy=function(aD,aE){il.removeAllListeners(ab._name),af.transaction(function(aF){var aG=[hu,gr,iK,h6,jj,T];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},jp(aE),function(){er()&&(delete window.localStorage["_pouch__websqldb_"+ab._name],delete window.localStorage[ab._name]),aE(null,{ok:!0})})}}function h4(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function ha(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=er(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=h4();return ab&&(localStorage[t]=aa?"1":"0"),aa}function ar(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:ha()}function w(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=i.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function ct(t,ab){var ac=w(t),aa=i.extend({websql:ac},t);gA.call(this,aa,ab)}function A(t){t.adapter("websql",ct,!0)}function a3(){for(var t={},ab=new je(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,je.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function z(ad,aa){var ag,t,ac,ab=new Headers,af={method:ad.method,credentials:"include",headers:ab};return ad.json&&(ab.set("Accept","application/json"),ab.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?jn(ad.body,function(ah){af.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?af.body=JSON.stringify(ad.body):"body" in ad?af.body=ad.body:af.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&ab.set(ah,ad.headers[ah])}),ag=a3(ad.url,af),ad.timeout>0&&(t=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ag.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?aa(null,ac,ah):aa(ah,ac)})["catch"](function(ah){aa(ah,ac)}),{abort:ag.reject}}function a4(ad,aa){var ag,aj,af=!1,ac=function(){ag.abort()},t=function(){af=!0,ag.abort()};ag=ad.xhr?new ad.xhr:new XMLHttpRequest;try{ag.open(ad.method,ad.url)}catch(ah){aa(ah,{statusCode:413})}ag.withCredentials="withCredentials" in ad?ad.withCredentials:!0,"GET"===ad.method?delete ad.headers["Content-Type"]:ad.json&&(ad.headers.Accept="application/json",ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json",ad.body&&ad.processData&&"string"!=typeof ad.body&&(ad.body=JSON.stringify(ad.body))),ad.binary&&(ag.responseType="arraybuffer"),"body" in ad||(ad.body=null);for(var ab in ad.headers){ad.headers.hasOwnProperty(ab)&&ag.setRequestHeader(ab,ad.headers[ab])}return ad.timeout>0&&(aj=setTimeout(t,ad.timeout),ag.onprogress=function(){clearTimeout(aj),4!==ag.readyState&&(aj=setTimeout(t,ad.timeout))},"undefined"!=typeof ag.upload&&(ag.upload.onprogress=ag.onprogress)),ag.onreadystatechange=function(){if(4===ag.readyState){var ak={statusCode:ag.status};if(ag.status>=200&&ag.status<300){var am;am=ad.binary?go([ag.response||""],{type:ag.getResponseHeader("Content-Type")}):ag.responseText,aa(null,ak,am)}else{var ap={};if(af){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ag.response)}catch(al){}}aa(ap,ak)}}},ad.body&&ad.body instanceof Blob?jn(ad.body,function(ak){ag.send(ak)}):ag.send(ad.body),{abort:ac}}function gk(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function eo(aa,t){return dr||aa.xhr?a4(aa,t):z(aa,t)}function gK(){return""}function g(t,ab){function ac(af,ag,aj){if(!t.binary&&t.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?a9(ak):ak})),t.binary&&fl(af,ag),aj(null,af,ag)}function aa(al,ag){var aj,af;if(al.code&&al.status){var ak=new Error(al.message||al.code);return ak.status=al.status,ag(ak)}if(al.message&&"ETIMEDOUT"===al.message){return ag(al)}try{aj=JSON.parse(al.responseText),af=a9(aj)}catch(ah){af=a9(al)}ag(af)}t=g5(t);var ad={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return t=i.extend(ad,t),t.json&&(t.binary||(t.headers.Accept="application/json"),t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json"),t.binary&&(t.encoding=null,t.json=!1),t.processData||(t.json=!1),eo(t,function(af,aj,al){if(af){return af.status=aj?aj.statusCode:400,aa(af,ab)}var ah,ak=aj.headers&&aj.headers["content-type"],am=al||gK();if(!t.binary&&(t.json||!t.processData)&&"object"!=typeof am&&(/json/.test(ak)||/^[\s]*\{/.test(am)&&/\}[\s]*$/.test(am))){try{am=JSON.parse(am.toString())}catch(ag){}}aj.statusCode>=200&&aj.statusCode<300?ac(am,aj,ab):(ah=a9(am),ah.status=aj.statusCode,ab(ah))})}function ey(aa,aj){var ad=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ag=-1!==ad.indexOf("safari")&&-1===ad.indexOf("chrome"),af=-1!==ad.indexOf("msie"),ac=-1!==ad.indexOf("edge"),ak=ag||(af||ac)&&"GET"===aa.method,ah="cache" in aa?aa.cache:!0,ab=/^blob:/.test(aa.url);if(!ab&&(ak||!ah)){var t=-1!==aa.url.indexOf("?");aa.url+=(t?"&":"?")+"_nonce="+Date.now()}return g(aa,aj)}function g7(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=iy(ab.data,ab.content_type)})}function hU(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function iT(t){return t._attachments&&Object.keys(t._attachments)?je.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new je(function(ac){R(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):je.resolve()}function gY(ab){var t=jk(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function gV(aa,t){return P(aa,aa.db+"/"+t)}function P(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function iW(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function gF(al,aj){function ah(ax,ay,aw){var aA=ax.ajax||{},az=i.extend(g5(am),aA,ay);return p(az.method+" "+az.url),ab._ajax(az,aw)}function ap(ax,aw){return new je(function(az,ay){ah(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(ax,aw){return gs(ax,he(function(ay){ac().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ac(){if(al.skipSetup||al.skip_setup){return je.resolve()}if(ak){return ak}var aw={method:"GET",url:au};return ak=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(jt(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:au})):je.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:je.reject(ax)}),ak["catch"](function(){ak=null}),ak}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,av=gY;al.getHost&&(av=al.getHost);var af=av(al.name,al),au=gV(af,"");al=g5(al);var am=al.ajax||{};if(ab.getUrl=function(){return au},ab.getHeaders=function(){return am.headers||{}},al.auth||af.auth){var t=al.auth||af.auth,ad=t.username+":"+t.password,aa=gv(unescape(encodeURIComponent(ad)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=ey;var ak;setTimeout(function(){aj(null,ab)}),ab.type=function(){return"http"},ab.id=aq("id",function(aw){ah({},{method:"GET",url:P(af,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+af.db:gV(af,"");aw(null,ay)})}),ab.request=aq("request",function(ax,aw){ax.url=gV(af,ax.url),ah({},ax,aw)}),ab.compact=aq("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=g5(ax),ah(ax,{url:gV(af,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ab.bulkGet=gs("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:gV(af,"_bulk_get"+iW(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aH(aK){return function(aM,aL){aE[aK]=aL.results,++aG===aJ&&aA(null,{results:dt(aE)})}}for(var aD=jb,aJ=Math.ceil(aC.docs.length/aD),aG=0,aE=new Array(aJ),aF=0;aJ>aF;aF++){var aI=ge(aC,["revs","attachments"]);aI.ajax=am,aI.docs=aC.docs.slice(aF*aD,Math.min(aC.docs.length,(aF+1)*aD)),fd(aw,aI,aH(aF))}}var aw=this,az=P(af,""),ay=a6[az];"boolean"!=typeof ay?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(a6[az]=!1,jt(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{a6[az]=!0,aA(null,aE)}}):ay?aB(aA):ax()}),ab._info=function(aw){ac().then(function(){ah({},{method:"GET",url:gV(af,"")},function(ay,ax){return ay?aw(ay):(ax.host=gV(af,""),void aw(null,ax))})})["catch"](aw)},ab.get=aq("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?je.all(aF.map(function(aI){var aH=aD[aI],aG=hU(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(aC,{method:"GET",url:gV(af,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:new je(function(aK){R(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?je.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=g5(aC);var ay={};aC.revs&&(ay.revs=!0),aC.revs_info&&(ay.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),ay.open_revs=aC.open_revs),aC.rev&&(ay.rev=aC.rev),aC.conflicts&&(ay.conflicts=aC.conflicts),aA=hU(aA);var az={method:"GET",url:gV(af,aA+iW(ay))};ap(aC,az).then(function(aD){return je.resolve().then(function(){return aC.attachments?aw(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ab.remove=aq("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:gV(af,hU(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=aq("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=gV(af,hU(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=aq("removeAttachment",function(ax,ay,aA,aw){var az=gV(af,hU(ax)+"/"+ag(ay))+"?rev="+aA;ah({},{method:"DELETE",url:az},aw)}),ab.putAttachment=aq("putAttachment",function(aC,ay,aw,aG,aE,ax){"function"==typeof aE&&(ax=aE,aE=aG,aG=aw,aw=null);var az=hU(aC)+"/"+ag(ay),aA=gV(af,az);if(aw&&(aA+="?rev="+aw),"string"==typeof aG){var aF;try{aF=bt(aG)}catch(aB){return ax(hB(hy,"Attachment is not a valid base64 string"))}aG=aF?iS(aF,aE):""}var aD={headers:{"Content-Type":aE},method:"PUT",url:aA,processData:!1,body:aG,timeout:am.timeout||60000};ah({},aD,ax)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,ac().then(function(){return je.all(ay.docs.map(iT))}).then(function(){ah(ax,{method:"POST",url:gV(af,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=g5(aA);var aB,ax={},aw="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var az=iW(ax);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=a2?az+="&"+ay:(aw="POST",aB={keys:aA.keys})}ap(aA,{method:aw,url:gV(af,"_all_docs"+az),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(g7),aC(null,aD)})["catch"](aC)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:o;aB=g5(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aF=aB.timeout?{timeout:aB.timeout-5000}:{},az="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=az;if(aB.style&&(aF.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aF.include_docs=!0),aB.attachments&&(aF.attachments=!0),aB.continuous&&(aF.feed="longpoll"),aB.conflicts&&(aF.conflicts=!0),aB.descending&&(aF.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aF.heartbeat=aB.heartbeat):aF.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aF.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aF.filter="_view",aF.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var aD in aB.query_params){aB.query_params.hasOwnProperty(aD)&&(aF[aD]=aB.query_params[aD])}}var aJ,aA="GET";if(aB.doc_ids){aF.filter="_doc_ids";var aC=JSON.stringify(aB.doc_ids);aC.length<a2?aF.doc_ids=aC:(aA="POST",aJ={doc_ids:aB.doc_ids})}var aE,aG,aI=function(aM,aN){if(!aB.aborted){aF.since=aM,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aB.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aw?aw:aH;var aL={method:aA,url:gV(af,"_changes"+iW(aF)),timeout:aB.timeout,body:aJ};aG=aM,aB.aborted||ac().then(function(){aE=ah(aB,aL,aN)})["catch"](aN)}},aK={results:[]},ax=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aK.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=gd(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&g7(aR),ay&&aK.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aG=aL.last_seq);var aO=az&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||az&&0>=aH)&&aO?aB.complete(null,aK):setTimeout(function(){aI(aG,ax)},0)}};return aI(aB.since||0,ax),{cancel:function(){aB.aborted=!0,aE&&aE.abort()}}},ab.revsDiff=aq("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:gV(af,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(ax,aw){ah(ax,{url:gV(af,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function gJ(t){t.adapter("http",gF,!1),t.adapter("https",gF,!1)}function fY(){this.promise=new je(function(t){t()})}function gD(ac){var aa=ac.db,af=ac.viewName,ah=ac.map,ag=ac.reduce,ab=ac.temporary,ad=ah.toString()+(ag&&ag.toString())+"undefined";if(!ab&&aa._cachedViews){var t=aa._cachedViews[ad];if(t){return je.resolve(t)}}return aa.info().then(function(ak){function al(am){am.views=am.views||{};var aq=af;-1===aq.indexOf("/")&&(aq=af+"/"+af);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ab?"temp":hA(ad));return ib(aa,"_local/mrviews",al).then(function(){return aa.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:aa,adapter:aa.adapter,mapFun:ah,reduceFun:ag};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ab||(aa._cachedViews=aa._cachedViews||{},aa._cachedViews[ad]=aq,aq.db.once("destroyed",function(){delete aa._cachedViews[ad]})),aq})})})})}function br(t,ab,ac,aa,ad,af){return g1("return ("+t.replace(/;\s*$/,"")+");",{emit:ab,sum:ac,log:aa,isArray:ad,toJSON:af})}function es(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function ev(t){return 1===t.length&&/^1-/.test(t[0].rev)}function et(ab,t){try{ab.emit("error",t)}catch(aa){jd("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),jd("error",t)}}function ij(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return et(t,aa),{error:aa}}}function fw(ab,t){var aa=ho.collate(ab.key,t.key);return 0!==aa?aa:ho.collate(ab.value,t.value)}function ao(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function hr(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function hF(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=iy(ac.data,ac.content_type)})})}function jm(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&hF(aa),aa}}function hZ(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new gi(t)}function iE(ac){for(var aa=0,af=0,ah=ac.length;ah>af;af++){var ag=ac[af];if("number"!=typeof ag){if(!Array.isArray(ag)){throw hZ("_sum")}aa="number"==typeof aa?[aa]:aa;for(var ab=0,ad=ag.length;ad>ab;ab++){var t=ag[ab];if("number"!=typeof t){throw hZ("_sum")}"undefined"==typeof aa[ab]?aa.push(t):aa[ab]+=t}}else{"number"==typeof aa?aa+=ag:aa[0]+=ag}}return aa}function iZ(t,ab,ac,aa){var ad=ab[t];"undefined"!=typeof ad&&(aa&&(ad=encodeURIComponent(JSON.stringify(ad))),ac.push(t+"="+ad))}function gG(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function jE(t){return t.group_level=gG(t.group_level),t.limit=gG(t.limit),t.skip=gG(t.skip),t}function k(t){if(t){if("number"!=typeof t){return new F('Invalid value for integer: "'+t+'"')}if(0>t){return new F('Invalid value for positive integer: "'+t+'"')}}}function hd(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&ho.collate(t[ac],t[aa])>0){throw new F("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new F("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new F("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=k(t[af]);if(ad){throw ad}})}function i6(ad,aa,ag){var aj,af=[],ac="GET";if(iZ("reduce",ag,af),iZ("include_docs",ag,af),iZ("attachments",ag,af),iZ("limit",ag,af),iZ("descending",ag,af),iZ("group",ag,af),iZ("group_level",ag,af),iZ("skip",ag,af),iZ("stale",ag,af),iZ("conflicts",ag,af),iZ("startkey",ag,af,!0),iZ("start_key",ag,af,!0),iZ("endkey",ag,af,!0),iZ("end_key",ag,af,!0),iZ("inclusive_end",ag,af),iZ("key",ag,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ag.keys){var t=2000,ah="keys="+encodeURIComponent(JSON.stringify(ag.keys));ah.length+af.length+1<=t?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?aj={keys:ag.keys}:aa.keys=ag.keys)}if("string"==typeof aa){var ab=es(aa);return ad.request({method:ac,url:"_design/"+ab[0]+"/_view/"+ab[1]+af,body:aj}).then(jm(ag))}return aj=aj||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?aj[ak]=aa[ak]:aj[ak]=aa[ak].toString()}),ad.request({method:"POST",url:"_temp_view"+af,body:aj}).then(jm(ag))}function iq(ab,t,aa){return new je(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function fr(t){return new je(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function M(t){return function(aa){if(404===aa.status){return t}throw aa}}function ae(af,al,ag){function aj(){return ev(ab)?je.resolve(aa):al.db.get(ad)["catch"](M(aa))}function ak(am){return am.keys.length?al.db.allDocs({keys:am.keys,include_docs:!0}):je.resolve({rows:[]})}function ah(az,ax){for(var aq=[],au={},ap=0,aA=ax.rows.length;aA>ap;ap++){var ay=ax.rows[ap],av=ay.doc;if(av&&(aq.push(av),au[av._id]=!0,av._deleted=!ac[av._id],!av._deleted)){var aw=ac[av._id];"value" in aw&&(av.value=aw.value)}}var am=Object.keys(ac);return am.forEach(function(aD){if(!au[aD]){var aB={_id:aD},aC=ac[aD];"value" in aC&&(aB.value=aC.value),aq.push(aB)}}),az.keys=en(am.concat(az.keys)),aq.push(az),aq}var ad="_local/doc_"+af,aa={_id:ad,keys:[]},t=ag[af],ac=t.indexableKeysToKeyValues,ab=t.changes;return aj().then(function(am){return ak(am).then(function(ap){return ah(am,ap)})})}function N(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](M({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return je.all(ad.map(function(ag){return ae(ag,t,ab)})).then(function(ah){var ag=dt(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function g8(ab){var t="string"==typeof ab?ab:ab.name,aa=C[t];return aa||(aa=C[t]=new fY),aa}function i7(t){return K(g8(t),function(){return fe(t)})()}function fe(ad){function aa(am,ak){var al={id:af._id,key:ho.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=ho.normalizeKey(ak)),aj.push(al)}function ag(ak,al){return function(){return N(ad,ak,al)}}var aj,af,ac;if("function"==typeof ad.mapFun&&2===ad.mapFun.length){var t=ad.mapFun;ac=function(ak){return t(ak,aa)}}else{ac=br(ad.mapFun.toString(),aa,iE,hC,Array.isArray,JSON.parse)}var ah=ad.seq||0,ab=new fY;return new je(function(ap,ak){function al(){ab.finish().then(function(){ad.seq=ah,ap()})}function am(){function aq(au){ak(au)}ad.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:hp}).on("complete",function(ax){var aD=ax.results;if(!aD.length){return al()}for(var ay={},aF=0,av=aD.length;av>aF;aF++){var aA=aD[aF];if("_"!==aA.doc._id[0]){aj=[],af=aA.doc,af._deleted||ij(ad.sourceDB,ac,[af]),aj.sort(fw);for(var aB,au={},aC=0,aw=aj.length;aw>aC;aC++){var aG=aj[aC],aE=[aG.key,aG.id];0===ho.collate(aG.key,aB)&&aE.push(aC);var az=ho.toIndexableString(aE);au[az]=aG,aB=aG.key}ay[aA.doc._id]={indexableKeysToKeyValues:au,changes:aA.changes}}ah=aA.seq}return ab.add(ag(ay,ah)),aD.length<hp?al():am()}).on("error",aq)}am()})}function s(af,al,ag){0===ag.group_level&&delete ag.group_level;var aj,ak=ag.group||ag.group_level;aj=ic[af.reduceFun]?ic[af.reduceFun]:br(af.reduceFun.toString(),null,iE,hC,Array.isArray,JSON.parse);var ah=[],ad=isNaN(ag.group_level)?Number.POSITIVE_INFINITY:ag.group_level;al.forEach(function(aq){var am=ah[ah.length-1],ap=ak?aq.key:null;return ak&&Array.isArray(ap)&&(ap=ap.slice(0,ad)),am&&0===ho.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ah.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),al=[];for(var aa=0,t=ah.length;t>aa;aa++){var ac=ah[aa],ab=ij(af.sourceDB,aj,[ac.keys,ac.values,!1]);if(ab.error&&ab.error instanceof gi){throw ab.error}al.push({value:ab.error?null:ab.output,key:ac.groupKey})}return{rows:ao(al,ag.limit,ag.skip)}}function W(aa,t){return K(g8(aa),function(){return a1(aa,t)})()}function a1(t,al){function ah(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return aj=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=ho.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function ak(aq){var au;if(au=af?s(t,aq,al):{total_rows:aj,offset:ap,rows:aq},al.include_docs){var av=en(aq.map(hr));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:al.conflicts,attachments:al.attachments,binary:al.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=hr(ay),az=aw["$"+aA];az&&(ay.doc=az)}),au})}return au}var aj,af=t.reduceFun&&al.reduce!==!1,ap=al.skip||0;if("undefined"==typeof al.keys||al.keys.length||(al.limit=0,delete al.keys),"undefined"!=typeof al.keys){var ad=al.keys,am=ad.map(function(au){var aq={startkey:ho.toIndexableString([au]),endkey:ho.toIndexableString([au,{}])};return ah(aq)});return je.all(am).then(dt).then(ak)}var aa={descending:al.descending};if(al.start_key&&(al.startkey=al.start_key),al.end_key&&(al.endkey=al.end_key),"undefined"!=typeof al.startkey&&(aa.startkey=al.descending?ho.toIndexableString([al.startkey,{}]):ho.toIndexableString([al.startkey])),"undefined"!=typeof al.endkey){var ac=al.inclusive_end!==!1;al.descending&&(ac=!ac),aa.endkey=ho.toIndexableString(ac?[al.endkey,{}]:[al.endkey])}if("undefined"!=typeof al.key){var ag=ho.toIndexableString([al.key]),ab=ho.toIndexableString([al.key,{}]);aa.descending?(aa.endkey=ag,aa.startkey=ab):(aa.startkey=ag,aa.endkey=ab)}return af||("number"==typeof al.limit&&(aa.limit=al.limit),aa.skip=ap),ah(aa).then(ak)}function a5(t){return t.request({method:"POST",url:"_view_cleanup"})}function iQ(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=es(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return K(g8(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return je.all(af).then(function(){return{ok:!0}})})},M({ok:!0}))}function ez(ag,t,ac){if("http"===ag.type()){return i6(ag,t,ac)}if("function"==typeof ag._query){return iq(ag,t,ac)}if("string"!=typeof t){hd(ac,t);var af={db:ag,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return hh.add(function(){return gD(af).then(function(ak){function aj(){return ak.db.destroy()}return hb(i7(ak).then(function(){return W(ak,ac)}),aj)})}),hh.finish()}var aa=t,ad=es(aa),ah=ad[0],ab=ad[1];return ag.get("_design/"+ah).then(function(al){var ak=al.views&&al.views[ab];if(!ak||"string"!=typeof ak.map){throw new gb("ddoc "+ah+" has no view named "+ab)}hd(ac,ak);var aj={db:ag,viewName:aa,map:ak.map,reduce:ak.reduce};return gD(aj).then(function(am){return"ok"===ac.stale||"update_after"===ac.stale?("update_after"===ac.stale&&ga.nextTick(function(){i7(am)}),W(am,ac)):i7(am).then(function(){return W(am,ac)})})})}function F(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,F)}catch(t){}}function gb(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gb)}catch(t){}}function gi(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gi)}catch(t){}}function cr(t){return/^1-/.test(t)}function gP(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function iA(ab,t){var aa=Object.keys(t._attachments);return je.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function gN(t,ab,ac){var aa="http"===ab.type()&&"http"!==t.type(),ad=Object.keys(ac._attachments);return aa?t.get(ac._id).then(function(af){return je.all(ad.map(function(ag){return gP(af,ac,ag)?ab.getAttachment(ac._id,ag):t.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return iA(ab,ac)}):iA(ab,ac)}function ju(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function fj(ag,aa,ah,ak){function aj(){var am=ju(ah);if(am.docs.length){return ag.bulkGet(am).then(function(ap){if(ak.cancelled){throw new Error("cancelled")}return je.all(ap.results.map(function(aq){return je.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?gN(aa,ag,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ac=ac.concat(dt(aq).filter(Boolean))})})}}function af(am){return am._attachments&&Object.keys(am._attachments).length>0}function ad(am){return ag.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ak.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&cr(aq.value.rev)&&!af(aq.doc)&&(ac.push(aq.doc),delete ah[aq.id])})})}function al(){var am=Object.keys(ah).filter(function(aq){var ap=ah[aq].missing;return 1===ap.length&&cr(ap[0])});return am.length>0?ad(am):void 0}function t(){return{ok:ab,docs:ac}}ah=g5(ah);var ac=[],ab=!0;return je.resolve().then(al).then(aj).then(t)}function gR(t,ab,ac,aa,ad){return t.get(ab)["catch"](function(af){if(404===af.status){return"http"===t.type()&&jt(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:aa,_id:ab,history:[],replicator:gU,version:ce}}throw af}).then(function(af){return ad.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==aa}),af.history.unshift({last_seq:ac,session_id:aa}),af.history=af.history.slice(0,fk),af.version=ce,af.replicator=gU,af.session_id=aa,af.last_seq=ac,t.put(af)["catch"](function(ag){if(409===ag.status){return gR(t,ab,ac,aa,ad)}throw ag}))})}function G(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function hO(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:fs(aa.history,t.history)}function fs(ac,aa){var af=ac[0],ah=ac.slice(1),ag=aa[0],ab=aa.slice(1);if(!af||0===aa.length){return{last_seq:hP,history:[]}}var ad=af.session_id;if(h(ad,aa)){return{last_seq:af.last_seq,history:ac}}var t=ag.session_id;return h(t,ah)?{last_seq:ag.last_seq,history:ab}:fs(ah,ab)}function h(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:h(t,aa):!1}function n(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function x(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=gM),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=ia})),t.current_back_off=t.current_back_off||ia,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function ai(t){return Object.keys(t).sort(ho.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function Q(ad,aa,ag){var t=ag.doc_ids?ag.doc_ids.sort(ho.collate):"",ac=ag.filter?ag.filter.toString():"",ab="",af="";return ag.filter&&ag.query_params&&(ab=JSON.stringify(ai(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),je.all([ad.id(),aa.id()]).then(function(ah){var aj=ah[0]+ah[1]+ac+af+ab+t;return new je(function(ak){a7(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function hK(aF,aw,ad,ak,af){function aP(){return aJ?je.resolve():Q(aF,aw,ad).then(function(aS){ay=aS,aJ=new G(aF,aw,ay,ak)})}function al(){if(ap=[],0!==aH.docs.length){var aS=aH.docs;return aw.bulkDocs({docs:aS,new_edits:!1}).then(function(aW){if(ak.cancelled){throw ag(),new Error("cancelled")}var aU=[],aX={};aW.forEach(function(aY){aY.error&&(af.doc_write_failures++,aU.push(aY),aX[aY.id]=aY)}),aG=aG.concat(aU),af.docs_written+=aH.docs.length-aU.length;var aT=aU.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aX[aZ._id];aY?ak.emit("denied",g5(aY)):ap.push(aZ)}),aT.length>0){var aV=new Error("bulkDocs error");throw aV.other_errors=aU,aO("target.bulkDocs failed to write docs",aV),new Error("bulkWrite partial failure")}},function(aT){throw af.doc_write_failures+=aS.length,aT})}}function av(){if(aH.error){throw new Error("There was a problem getting docs.")}af.last_seq=aQ=aH.seq;var aS=g5(af);return ap.length&&(aS.docs=ap,ak.emit("change",aS)),aM=!0,aJ.writeCheckpoint(aH.seq,aE).then(function(){if(aM=!1,ak.cancelled){throw ag(),new Error("cancelled")}aH=void 0,ab()})["catch"](ax)}function aC(){var aS={};return aH.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aw.revsDiff(aS).then(function(aT){if(ak.cancelled){throw ag(),new Error("cancelled")}aH.diffs=aT})}function aK(){return fj(aF,aw,aH.diffs,ak).then(function(aS){aH.error=!aS.ok,aS.docs.forEach(function(aT){delete aH.diffs[aT._id],af.docs_read++,aH.docs.push(aT)})})}function aa(){if(!ak.cancelled&&!aH){if(0===aR.length){return void aA(!0)}aH=aR.shift(),aC().then(aK).then(al).then(av).then(aa)["catch"](function(aS){aO("batch processing terminated with error",aS)})}}function aA(aS){return 0===ah.changes.length?void (0!==aR.length||aH||((aq&&ac.live||am)&&(ak.state="pending",ak.emit("paused")),am&&ag())):void ((aS||am||ah.changes.length>=aB)&&(aR.push(ah),ah={seq:0,changes:[],docs:[]},"pending"!==ak.state&&"stopped"!==ak.state||(ak.state="active",ak.emit("active")),aa()))}function aO(aT,aS){aL||(aS.message||(aS.message=aT),af.ok=!1,af.status="aborting",af.errors.push(aS),aG=aG.concat(aS),aR=[],ah={seq:0,changes:[],docs:[]},ag())}function ag(){if(!(aL||ak.cancelled&&(af.status="cancelled",aM))){af.status=af.status||"complete",af.end_time=new Date,af.last_seq=aQ,aL=!0;var aT=aG.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aG.pop();aG.length>0&&(aS.other_errors=aG),aS.result=af,x(ad,ak,aS,function(){hK(aF,aw,ad,ak)})}else{af.errors=aG,ak.emit("complete",af),ak.removeAllListeners()}}}function aD(aT){if(ak.cancelled){return ag()}var aS=gd(ad)(aT);aS&&(ah.seq=aT.seq,ah.changes.push(aT),aA(0===aR.length&&ac.live))}function t(aT){if(au=!1,ak.cancelled){return ag()}if(aT.results.length>0){ac.since=aT.last_seq,ab(),aA(!0)}else{var aS=function(){aq?(ac.live=!0,ab()):am=!0,aA(!0)};aH||0!==aT.results.length?aS():(aM=!0,aJ.writeCheckpoint(aT.last_seq,aE).then(function(){aM=!1,af.last_seq=aQ=aT.last_seq,aS()})["catch"](ax))}}function aj(aS){return au=!1,ak.cancelled?ag():void aO("changes rejected",aS)}function ab(){function aU(){aS.cancel()}function aT(){ak.removeListener("cancel",aU)}if(!au&&!am&&aR.length<az){au=!0,ak._changes&&(ak.removeListener("cancel",ak._abortChanges),ak._changes.cancel()),ak.once("cancel",aU);var aS=aF.changes(ac).on("change",aD);aS.then(aT,aT),aS.then(t)["catch"](aj),ad.retry&&(ak._changes=aS,ak._abortChanges=aU)}}function aN(){aP().then(function(){return ak.cancelled?void ag():aJ.getCheckpoint().then(function(aS){aQ=aS,ac={since:aQ,limit:aB,batch_size:aB,style:"all_docs",doc_ids:aI,return_docs:!0},ad.filter&&("string"!=typeof ad.filter?ac.include_docs=!0:ac.filter=ad.filter),"heartbeat" in ad&&(ac.heartbeat=ad.heartbeat),"timeout" in ad&&(ac.timeout=ad.timeout),ad.query_params&&(ac.query_params=ad.query_params),ad.view&&(ac.view=ad.view),ab()})})["catch"](function(aS){aO("getCheckpoint rejected with ",aS)})}function ax(aS){throw aM=!1,aO("writeCheckpoint completed with error",aS),aS}var aH,ay,aJ,aR=[],ah={seq:0,changes:[],docs:[]},aM=!1,am=!1,aL=!1,aQ=0,aq=ad.continuous||ad.live||!1,aB=ad.batch_size||100,az=ad.batches_limit||10,au=!1,aI=ad.doc_ids,aG=[],ap=[],aE=gX();af=af||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var ac={};return ak.ready(aF,aw),ak.cancelled?void ag():(ak._addedListeners||(ak.once("cancel",ag),"function"==typeof ad.complete&&(ak.once("error",ad.complete),ak.once("complete",function(aS){ad.complete(null,aS)})),ak._addedListeners=!0),void ("undefined"==typeof ad.since?aN():aP().then(function(){return aM=!0,aJ.writeCheckpoint(ad.since,aE)}).then(function(){return aM=!1,ak.cancelled?void ag():(aQ=ad.since,void aN())})["catch"](ax)))}function jC(){h5.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new je(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function X(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function i8(ad,aa,ag,t){if("function"==typeof ag&&(t=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw hB(hG,"`doc_ids` filter parameter is not a list.")}ag.complete=t,ag=g5(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ac=new jC(ag),ab=X(ad,ag),af=X(aa,ag);return hK(ab,af,ag,ac),ac}function hI(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=g5(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=X(t,ac),ab=X(ab,ac),new gg(t,ab,ac,aa)}function gg(ad,am,al,ab){function ap(ay){ag.emit("change",{direction:"pull",change:ay})}function ah(ay){ag.emit("change",{direction:"push",change:ay})}function aq(ay){ag.emit("denied",{direction:"push",doc:ay})}function ak(ay){ag.emit("denied",{direction:"pull",doc:ay})}function av(){ag.pushPaused=!0,ag.pullPaused&&ag.emit("paused")}function aa(){ag.pullPaused=!0,ag.pushPaused&&ag.emit("paused")}function af(){ag.pushPaused=!1,ag.pullPaused&&ag.emit("active",{direction:"push"})}function aj(){ag.pullPaused=!1,ag.pushPaused&&ag.emit("active",{direction:"pull"})}function ac(ay){return function(aC,aD){var az="change"===aC&&(aD===ap||aD===ah),aA="denied"===aC&&(aD===ak||aD===aq),aE="paused"===aC&&(aD===aa||aD===av),aB="active"===aC&&(aD===aj||aD===af);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ag.removeAllListeners(aC))}}var ag=this;this.canceled=!1;var t=al.push?i.extend({},al,al.push):al,aw=al.pull?i.extend({},al,al.pull):al;this.push=i8(ad,am,t),this.pull=i8(am,ad,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};al.live&&(this.push.on("complete",ag.pull.cancel.bind(ag.pull)),this.pull.on("complete",ag.push.cancel.bind(ag.push))),this.on("newListener",function(ay){"change"===ay?(ag.pull.on("change",ap),ag.push.on("change",ah)):"denied"===ay?(ag.pull.on("denied",ak),ag.push.on("denied",aq)):"active"===ay?(ag.pull.on("active",aj),ag.push.on("active",af)):"paused"===ay&&(ag.pull.on("paused",aa),ag.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ag.pull.removeListener("change",ap),ag.push.removeListener("change",ah)):"denied"===ay?(ag.pull.removeListener("denied",ak),ag.push.removeListener("denied",aq)):"active"===ay?(ag.pull.removeListener("active",aj),ag.push.removeListener("active",af)):"paused"===ay&&(ag.pull.removeListener("paused",aa),ag.push.removeListener("paused",av))}),this.pull.on("removeListener",ac("pull")),this.push.on("removeListener",ac("push"));var au=je.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ag.emit("complete",az),ab&&ab(null,az),ag.removeAllListeners(),az},function(ay){if(ag.cancel(),ab?ab(ay):ag.emit("error",ay),ag.removeAllListeners(),ab){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gc(t){t.replicate=i8,t.sync=hI}var m,i=a(9),hc=ee(a(5)),hi=ee(a(8)),hS=ee(a(10)),gp=a(14),he=ee(a(4)),h5=a(1),g1=ee(a(15)),ew=ee(a(16)),hg=ee(a(17)),ho=a(12),je="function"==typeof Promise?Promise:hS,be=Function.prototype.toString,i5=be.call(Object),hl=hc("pouchdb:api"),iF=6;if(r()){m=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),m=!!localStorage.getItem("_pouch_check_localstorage")}catch(gm){m=!1}}hi(fU,h5.EventEmitter),fU.prototype.addListener=function(ad,aa,ag,t){function ac(){function ah(){af=!1}if(ab._listeners[aa]){if(af){return void (af="waiting")}af=!0;var aj=ge(t,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>t.since&&!t.cancelled&&(t.since=ak.seq,t.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ac()},0),af=!1}).on("error",ah)}}if(!this._listeners[aa]){var ab=this,af=!1;this._listeners[aa]=ac,this.on(ad,ac)}},fU.prototype.removeListener=function(aa,t){t in this._listeners&&h5.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},fU.prototype.notifyLocalWindows=function(t){r()?chrome.storage.local.set({dbName:t}):er()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},fU.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hi(jA,Error),jA.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hx=new jA({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),gw=new jA({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),h7=new jA({status:404,error:"not_found",reason:"missing"}),io=new jA({status:409,error:"conflict",reason:"Document update conflict"}),hw=new jA({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gx=new jA({status:412,error:"missing_id",reason:"_id is required for puts"}),ei=new jA({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),fX=new jA({status:412,error:"precondition_failed",reason:"Database not open"}),fb=new jA({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),hy=new jA({status:500,error:"badarg",reason:"Some query argument is invalid"}),fn=new jA({status:400,error:"invalid_request",reason:"Request was invalid"}),gL=new jA({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),de=new jA({status:500,error:"doc_validation",reason:"Bad special document member"}),hG=new jA({status:400,error:"bad_request",reason:"Something wrong with the request"}),hM=new jA({status:400,error:"bad_request",reason:"Document must be a JSON object"}),fV=new jA({status:404,error:"not_found",reason:"Database not found"}),hY=new jA({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ik=new jA({status:500,error:"web_sql_went_bad",reason:"unknown"}),D=new jA({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fo=new jA({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iX=new jA({status:400,error:"bad_request",reason:"Invalid rev format"}),gT=new jA({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),ht=new jA({status:412,error:"missing_stub"}),gB=new jA({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gW=[hx,gw,h7,io,hw,gx,ei,fX,fb,hy,fn,gL,de,hG,hM,fV,ik,D,fo,iX,gT,ht,hY,gB],h3=function(t,ab,ac){var aa=gW.filter(function(ad){return ad[t]===ab});return ac&&aa.filter(function(ad){return ad.message===ac})[0]||aa[0]},dn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gt="queryKey",fz=/(?:^|&)([^&=]*)=?([^&]*)/g,u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hi(gz,h5.EventEmitter),gz.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},gz.prototype.doChanges=function(t){var ab=this,ac=t.complete;if(t=g5(t),"live" in t&&!("continuous" in t)&&(t.continuous=t.live),t.processChange=gC,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"===t.since){return void this.db.info().then(function(af){return ab.isCancelled?void ac(null,{status:"cancelled"}):(t.since=af.update_seq,void ab.doChanges(t))},ac)}if(t.continuous&&"now"!==t.since&&this.db.info().then(function(af){ab.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),t.view&&!t.filter&&(t.filter="_view"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=E(t.view):t.filter=E(t.filter),"http"!==this.db.type()&&!t.doc_ids)){return this.filterChanges(t)}"descending" in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=ac;var aa=this.db._changes(t);if(aa&&"function"==typeof aa.cancel){var ad=ab.cancel;ab.cancel=he(function(af){aa.cancel(),ad.apply(this,af)})}},gz.prototype.filterChanges=function(t){var ab=this,ac=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var aa=hB(hG,"`view` filter parameter not found or invalid.");return ac(aa)}var ad=gO(t.view);this.db.get("_design/"+ad[0],function(ah,aj){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(ah){return ac(a9(ah))}var ag=aj&&aj.views&&aj.views[ad[1]]&&aj.views[ad[1]].map;return ag?(t.filter=fu(ag),void ab.doChanges(t)):ac(hB(h7,aj.views?"missing json key: "+ad[1]:"missing json key: views"))})}else{var af=gO(t.filter);if(!af){return ab.doChanges(t)}this.db.get("_design/"+af[0],function(ag,aj){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(ag){return ac(a9(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(t.filter=v(ah),void ab.doChanges(t)):ac(hB(h7,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hi(iO,h5.EventEmitter),iO.prototype.post=gs("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(hB(hM)):void this.bulkDocs({docs:[ab]},t,iD(aa))}),iO.prototype.put=gs("put",he(function(ad){function aa(){t||(jd("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),t=!0)}var ag,aj,af,ac,t=!1,ah=ad.shift(),ab="_id" in ah;if("object"!=typeof ah||Array.isArray(ah)){return(ac=ad.pop())(hB(hM))}for(;;){if(ag=ad.shift(),aj=typeof ag,"string"!==aj||ab?"string"!==aj||!ab||"_rev" in ah?"object"===aj?af=ag:"function"===aj&&(ac=ag):(aa(),ah._rev=ag):(aa(),ah._id=ag,ab=!0),!ad.length){break}}return af=af||{},ii(ah._id),V(ah._id)&&"function"==typeof this._putLocal?ah._deleted?this._removeLocal(ah,ac):this._putLocal(ah,ac):void this.bulkDocs({docs:[ah]},af,iD(ac))})),iO.prototype.putAttachment=gs("putAttachment",function(ad,aa,ag,t,ac){function ab(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[aa]={content_type:ac,data:t,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof ac&&(ac=t,t=ag,ag=null),"undefined"==typeof ac&&(ac=t,t=ag,ag=null),af.get(ad).then(function(ah){if(ah._rev!==ag){throw hB(io)}return ab(ah)},function(ah){if(ah.reason===h7.message){return ab({_id:ad})}throw ah})}),iO.prototype.removeAttachment=gs("removeAttachment",function(t,ab,ac,aa){var ad=this;ad.get(t,function(af,ag){return af?void aa(af):ag._rev!==ac?void aa(hB(io)):ag._attachments?(delete ag._attachments[ab],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ad.put(ag,aa)):aa()})}),iO.prototype.remove=gs("remove",function(t,ab,ac,aa){var ad;"string"==typeof ab?(ad={_id:t,_rev:ab},"function"==typeof ac&&(aa=ac,ac={})):(ad=t,"function"==typeof ab?(aa=ab,ac={}):(aa=ac,ac=ab)),ac=ac||{},ac.was_delete=!0;var af={_id:ad._id,_rev:ad._rev||ac.rev};return af._deleted=!0,V(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ad,aa):void this.bulkDocs({docs:[af]},ac,iD(aa))}),iO.prototype.revsDiff=gs("revsDiff",function(ac,aa,af){function ah(ak,aj){t.has(ak)||t.set(ak,{missing:[]}),t.get(ak).missing.push(aj)}function ag(aj,ak){var al=ac[aj].slice(0);jl(ak,function(aw,am,ap,av,aq){var au=am+"-"+ap,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==aq.status&&ah(aj,au))}),al.forEach(function(am){ah(aj,am)})}"function"==typeof aa&&(af=aa,aa={});var ab=Object.keys(ac);if(!ab.length){return af(null,{})}var ad=0,t=new gp.Map;ab.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){t.set(aj,{missing:ac[aj]})}else{if(al){return af(al)}ag(aj,am)}if(++ad===ab.length){var ak={};return t.forEach(function(ap,aq){ak[aq]=ap}),af(null,ak)}})},this)}),iO.prototype.bulkGet=gs("bulkGet",function(aa,t){fd(this,aa,t)}),iO.prototype.compactDocument=gs("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(af,ah){if(af){return ac(af)}var ad=fg(ah),ag=[],aj=[];Object.keys(ad).forEach(function(ak){ad[ak]>ab&&ag.push(ak)}),jl(ah,function(al,ap,au,am,ak){var aq=ap+"-"+au;"available"===ak.status&&-1!==ag.indexOf(aq)&&aj.push(aq)}),aa._doCompaction(t,aj,ac)})}),iO.prototype.compact=gs("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&h1(aa)}),iO.prototype._compact=function(ad,aa){function ag(ah){af.push(ac.compactDocument(ah.id,0))}function t(aj){var ah=aj.last_seq;je.all(af).then(function(){return ib(ac,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){aa(null,{ok:!0})})["catch"](aa)}var ac=this,ab={return_docs:!1,last_seq:ad.last_seq||0},af=[];ac.changes(ab).on("change",ag).on("complete",t).on("error",aa)},iO.prototype.get=gs("get",function(ac,aa,af){function ah(){var ak=[],aj=ag.length;return aj?void ag.forEach(function(al){ab.get(ac,{rev:al,revs:aa.revs,attachments:aa.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||af(null,ak)})}):af(null,ak)}if("function"==typeof aa&&(af=aa,aa={}),"string"!=typeof ac){return af(hB(hw))}if(V(ac)&&"function"==typeof this._getLocal){return this._getLocal(ac,af)}var ag=[],ab=this;if(!aa.open_revs){return this._get(ac,aa,function(aB,ay){if(aB){return af(aB)}var al=ay.doc,az=ay.metadata,aq=ay.ctx;if(aa.conflicts){var ap=iP(az);ap.length&&(al._conflicts=ap)}if(jg(az,al._rev)&&(al._deleted=!0),aa.revs||aa.revs_info){var au=iz(az.rev_tree),aj=an(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(al._rev.split("-")[1])}),aA=aj.ids.map(function(aC){return aC.id}).indexOf(al._rev.split("-")[1])+1,ax=aj.ids.length-aA;if(aj.ids.splice(aA,ax),aj.ids.reverse(),aa.revs&&(al._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),aa.revs_info){var aw=aj.pos+aj.ids.length;al._revs_info=aj.ids.map(function(aC){return aw--,{rev:aw+"-"+aC.id,status:aC.opts.status}})}}if(aa.attachments&&al._attachments){var av=al._attachments,am=Object.keys(av).length;if(0===am){return af(null,al)}Object.keys(av).forEach(function(aC){this._getAttachment(al._id,aC,av[aC],{rev:al._rev,binary:aa.binary,ctx:aq},function(aE,aD){var aF=al._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--am||af(null,al)})},ab)}else{if(al._attachments){for(var ak in al._attachments){al._attachments.hasOwnProperty(ak)&&(al._attachments[ak].stub=!0)}}af(null,al)}})}if("all"===aa.open_revs){this._getRevisionTree(ac,function(ak,aj){return ak?af(ak):(ag=jw(aj).map(function(al){return al.rev}),void ah())})}else{if(!Array.isArray(aa.open_revs)){return af(hB(fb,"function_clause"))}ag=aa.open_revs;for(var ad=0;ad<ag.length;ad++){var t=ag[ad];if("string"!=typeof t||!/^\d+-/.test(t)){return af(hB(iX))}}ah()}}),iO.prototype.getAttachment=gs("getAttachment",function(t,ab,ac,aa){var ad=this;ac instanceof Function&&(aa=ac,ac={}),this._get(t,ac,function(af,ag){return af?aa(af):ag.doc._attachments&&ag.doc._attachments[ab]?(ac.ctx=ag.ctx,ac.binary=!0,ad._getAttachment(t,ab,ag.doc._attachments[ab],ac,aa),void 0):aa(hB(h7))})}),iO.prototype.allDocs=gs("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(hB(gL,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return fT(this,ab,t)}}return this._allDocs(ab,t)}),iO.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new gz(this,aa,t)},iO.prototype.close=gs("close",function(t){return this._closed=!0,this._close(t)}),iO.prototype.info=gs("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),iO.prototype.id=gs("id",function(t){return this._id(t)}),iO.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},iO.prototype.bulkDocs=gs("bulkDocs",function(t,ab,ac){if("function"==typeof ab&&(ac=ab,ab={}),ab=ab||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs)){return ac(hB(gw))}for(var aa=0;aa<t.docs.length;++aa){if("object"!=typeof t.docs[aa]||Array.isArray(t.docs[aa])){return ac(hB(hM))}}var ad;return t.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ad=ad||fW(ag)})}),ad?ac(hB(hG,ad)):("new_edits" in ab||("new_edits" in t?ab.new_edits=t.new_edits:ab.new_edits=!0),ab.new_edits||"http"===this.type()||t.docs.sort(j),l(t.docs),this._bulkDocs(t,ab,function(af,ag){return af?ac(af):(ab.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ac(null,ag))}))}),iO.prototype.registerDependentDatabase=gs("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);ib(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),iO.prototype.destroy=gs("destroy",function(t,ab){function ac(){aa._destroy(t,function(ag,af){return ag?ab(ag):(aa._destroyed=!0,aa.emit("destroyed"),void ab(null,af||{ok:!0}))})}"function"==typeof t&&(ab=t,t={});var aa=this,ad="use_prefix" in aa?aa.use_prefix:!0;return"http"===aa.type()?ac():void aa.get("_local/_pouch_dependentDbs",function(af,ah){if(af){return 404!==af.status?ab(af):ac()}var ak=ah.dependentDbs,ag=aa.constructor,aj=Object.keys(ak).map(function(al){var am=ad?al.replace(new RegExp("^"+ag.prefix),""):al;return new ag(am,aa.__opts).destroy()});je.all(aj).then(ac,ab)})}),hL.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},hL.prototype.fail=function(t){this.failed=t,this.execute()},hL.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},hL.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hi(gh,iO),gh.debug=hc,gh.adapters={},gh.preferredAdapters=[],gh.prefix="_pouch_";var iV=new h5.EventEmitter;fv(gh),gh.parseAdapter=function(ac,aa){var af,ah,ag=ac.match(/([a-z\-]*):\/\/(.*)/);if(ag){if(ac=/http(s?)/.test(ag[1])?ag[1]+"://"+ag[2]:ag[2],af=ag[1],!gh.adapters[af].valid()){throw"Invalid adapter"}return{name:ac,adapter:ag[1]}}var ab="idb" in gh.adapters&&"websql" in gh.adapters&&er()&&localStorage["_pouch__websqldb_"+gh.prefix+ac];if(aa.adapter){ah=aa.adapter}else{if("undefined"!=typeof aa&&aa.db){ah="leveldb"}else{for(var ad=0;ad<gh.preferredAdapters.length;++ad){if(ah=gh.preferredAdapters[ad],ah in gh.adapters){if(ab&&"idb"===ah){jd("log",'PouchDB is downgrading "'+ac+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}af=gh.adapters[ah];var t=af&&"use_prefix" in af?af.use_prefix:!0;return{name:t?gh.prefix+ac:ac,adapter:ah}},gh.adapter=function(ab,t,aa){t.valid()&&(gh.adapters[ab]=t,aa&&gh.preferredAdapters.push(ab))},gh.plugin=function(t){return"function"==typeof t?t(gh):Object.keys(t).forEach(function(aa){gh.prototype[aa]=t[aa]}),gh},gh.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=i.extend({},aa,ad),void gh.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hi(t,gh),t.preferredAdapters=gh.preferredAdapters.slice(),Object.keys(gh).forEach(function(ab){ab in t||(t[ab]=gh[ab])}),t};var at="5.4.4";gh.version=at;var fm,iB=h2(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gu=h2(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),bt=function(t){return atob(t)},gv=function(t){return btoa(t)},i4=jB.setImmediate||jB.setTimeout,iU=32768,g3=5,g2="document-store",h8="by-sequence",J="attach-store",iR="attach-seq-store",im="meta-store",hV="local-store",jf="detect-blob-support",i0={running:!1,queue:[]},iL=new gp.Map,gS=new fU,hD=new gp.Map;a8.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var jz=7,hu=gj("document-store"),gr=gj("by-sequence"),iK=gj("attach-store"),jj=gj("local-store"),h6=gj("metadata-store"),T=gj("attach-seq-store"),i9=new gp.Map,il=new fU,B=1,fp="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+gr+" (seq, deleted)",gH="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+gr+" (doc_id, rev)",hQ="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hu+" (winningseq)",U="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+T+" (seq)",hJ="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+T+" (digest, seq)",jh=gr+".seq = "+hu+".winningseq",gq=gr+".seq AS seq, "+gr+".deleted AS deleted, "+gr+".json AS data, "+gr+".rev AS rev, "+hu+".json AS metadata";ct.valid=ar,ct.use_prefix=!0;var dr=gk(),fl=function(){},o=25,jb=50,a6={},a2=1800,p=hc("pouchdb:http");gF.valid=function(){return !0},fY.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},fY.prototype.finish=function(){return this.promise};var h9=function(aa,t){return t&&aa.then(function(ab){ga.nextTick(function(){t(null,ab)})},function(ab){ga.nextTick(function(){t(ab)})}),aa},f=function(t){return he(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&h9(ab,aa),ab})},hb=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},K=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},en=function(t){for(var ab={},ac=0,aa=t.length;aa>ac;ac++){ab["$"+t[ac]]=!0}var ad=Object.keys(ab),af=new Array(ad.length);for(ac=0,aa=ad.length;aa>ac;ac++){af[ac]=ad[ac].substring(1)}return af},C={},hh=new fY,hp=50,hC=jd.bind(null,"log"),ic={_sum:function(aa,t){return iE(t)},_count:function(aa,t){return t.length},_stats:function(ab,t){function aa(ah){for(var ad=0,af=0,ac=ah.length;ac>af;af++){var ag=ah[af];ad+=ag*ag}return ad}return{sum:iE(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},hj=f(function(){var t=this;return"http"===t.type()?a5(t):"function"==typeof t._viewCleanup?fr(t):iQ(t)}),iY=function(t,ab,ac){"function"==typeof ab&&(ac=ab,ab={}),ab=ab?jE(ab):{},"function"==typeof t&&(t={map:t});var aa=this,ad=je.resolve().then(function(){return ez(aa,t,ab)});return h9(ad,ac),ad};hi(F,Error),hi(gb,Error),hi(gi,Error);var jr={query:iY,viewCleanup:hj},ce=1,gU="pouchdb",fk=5,hP=0;G.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},G.prototype.updateTarget=function(aa,t){return gR(this.target,this.id,aa,t,this.returnValue)},G.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?je.resolve(!0):gR(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(n(ac)){return aa.readOnlySource=!0,!0}throw ac})};var iG={undefined:function(aa,t){return 0===ho.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return hO(t,aa).last_seq}};G.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?je.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return hP}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in iG?iG[ab](aa,ac):hP},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:hP}).then(function(){return hP},function(ac){return n(ac)?(t.readOnlySource=!0,aa.last_seq):hP})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return hP})};var ia=0;hi(jC,h5.EventEmitter),jC.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},jC.prototype.ready=function(t,ab){function ac(){ad.cancel()}function aa(){t.removeListener("destroyed",ac),ab.removeListener("destroyed",ac)}var ad=this;ad._readyCalled||(ad._readyCalled=!0,t.once("destroyed",ac),ab.once("destroyed",ac),ad.once("complete",aa))},hi(gg,h5.EventEmitter),gg.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},gh.plugin(jy).plugin(A).plugin(gJ).plugin(jr).plugin(gc),b.exports=gh}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var g="color: "+this.color;h=[h[0],g,"color: inherit"].concat(Array.prototype.slice.call(h,1));var f=0,j=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),h.splice(j,0,g),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(i,a,r){function t(){return r.colors[n++%r.colors.length]}function s(j){function g(){}function k(){var m=k,w=+new Date,l=w-(f||w);m.diff=l,m.prev=f,m.curr=w,f=w,null==m.useColors&&(m.useColors=r.useColors()),null==m.color&&m.useColors&&(m.color=t());var q=Array.prototype.slice.call(arguments);q[0]=r.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=r.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof r.formatArgs&&(q=r.formatArgs.apply(m,q));var p=k.log||r.log||console.log.bind(console);p.apply(m,q)}g.enabled=!1,k.enabled=!0;var h=r.enabled(j)?k:g;return h.namespace=j,h}function o(k){r.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?r.skips.push(new RegExp("^"+k.substr(1)+"$")):r.names.push(new RegExp("^"+k+"$")))}}function e(){r.enable("")}function u(g){var j,h;for(j=0,h=r.skips.length;h>j;j++){if(r.skips[j].test(g)){return !1}}for(j=0,h=r.names.length;h>j;j++){if(r.names[j].test(g)){return !0}}return !1}function b(g){return g instanceof Error?g.stack||g.message:g}r=a.exports=s,r.coerce=b,r.disable=e,r.enable=o,r.enabled=u,r.humanize=i(11),r.names=[],r.skips=[],r.formatters={};var f,n=0},{11:11}],7:[function(a,b,e){(function(f){function o(){i=!0;for(var h,j,g=n.length;g;){for(j=n,n=[],h=-1;++h<g;){j[h]()}g=n.length}i=!1}function u(g){1!==n.push(g)||i||s()}var s,l=f.MutationObserver||f.WebKitMutationObserver;if(l){var z=0,x=new l(o),y=f.document.createTextNode("");x.observe(y,{characterData:!0}),s=function(){y.data=z=++z%2}}else{if(f.setImmediate||"undefined"==typeof f.MessageChannel){s="document" in f&&"onreadystatechange" in f.document.createElement("script")?function(){var g=f.document.createElement("script");g.onreadystatechange=function(){o(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},f.document.documentElement.appendChild(g)}:function(){setTimeout(o,0)}}else{var r=new f.MessageChannel;r.port1.onmessage=o,s=function(){r.port2.postMessage(0)}}}var i,n=[];b.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(o,u,s){function n(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=b,this.queue=[],this.outcome=void 0,g!==n&&y(this,g)}function m(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function a(j,k,g){i(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function h(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=l(j);"error"===z.status&&w(z.value)}function l(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function r(g){return g instanceof this?g:K.resolve(new this(n),g)}function f(g){var j=new this(n);return K.reject(j,g)}function e(g){function q(E,D){function C(F){x[D]=F,++B!==A||j||(j=!0,K.resolve(z,x))}k.resolve(E).then(C,function(F){j||(j=!0,K.reject(z,F))})}var k=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var A=g.length,j=!1;if(!A){return this.resolve([])}for(var x=new Array(A),B=0,w=-1,z=new this(n);++w<A;){q(g[w],w)}return z}function t(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(n);++z<j;){g(k[z])}return q}var i=o(7),K={},L=["REJECTED"],p=["FULFILLED"],b=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===p||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(n);if(this.state!==b){var k=this.state===p?q:g;a(j,k,this.outcome)}else{this.queue.push(new m(j,q,g))}return j},m.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},m.prototype.otherCallFulfilled=function(g){a(this.promise,this.onFulfilled,g)},m.prototype.callRejected=function(g){K.reject(this.promise,g)},m.prototype.otherCallRejected=function(g){a(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=l(h,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=p,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},v.resolve=r,v.reject=f,v.all=e,v.race=t},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(r,D,o){function b(g){if(null!==g){switch(typeof g){case"boolean":return g?1:0;case"number":return a(g);case"string":return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var q=Array.isArray(g),j=q?g:Object.keys(g),w=-1,m=j.length,v="";if(q){for(;++w<m;){v+=o.toIndexableString(j[w])}}else{for(;++w<m;){var k=j[w];v+=o.toIndexableString(k)+o.toIndexableString(g[k])}}return v}}return""}function h(y,q){var g,k=q,j="1"===y[q];if(j){g=0,q++}else{var z="0"===y[q];q++;var w="",m=y.substring(q,q+p),v=parseInt(m,10)+t;for(z&&(v=-v),q+=p;;){var x=y[q];if("\x00"===x){break}w+=x,q++}w=w.split("."),g=1===w.length?parseInt(w,10):parseFloat(w[0]+"."+w[1]),z&&(g-=10),0!==v&&(g=parseFloat(g+"e"+v))}return{num:g,length:q-k}}function l(j,w){var q=j.pop();if(w.length){var v=w[w.length-1];q===v.element&&(w.pop(),v=w[w.length-1]);var m=v.element,g=v.index;if(Array.isArray(m)){m.push(q)}else{if(g===j.length-2){var k=j.pop();m[k]=q}else{j.push(q)}}}}function s(m,g){for(var q=Math.min(m.length,g.length),k=0;q>k;k++){var j=o.collate(m[k],g[k]);if(0!==j){return j}}return m.length===g.length?0:m.length>g.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(g,q){for(var j=Object.keys(g),w=Object.keys(q),m=Math.min(j.length,w.length),v=0;m>v;v++){var k=o.collate(j[v],w[v]);if(0!==k){return k}if(k=o.collate(g[j[v]],q[w[v]]),0!==k){return k}}return j.length===w.length?0:j.length>w.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(w){if(0===w){return"1"}var m=w.toExponential().split(/e\+?/),y=parseInt(m[1],10),j=0>w,g=j?"0":"2",x=(j?-y:y)-t,v=n.padLeft(x.toString(),"0",p);g+=f+v;var k=Math.abs(parseFloat(m[0]));j&&(k=10-k);var q=k.toFixed(20);return q=q.replace(/\.?0+$/,""),g+=f+q}var t=-324,p=3,f="",n=r(13);o.collate=function(j,m){if(j===m){return 0}j=o.normalizeKey(j),m=o.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},o.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=o.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=o.normalizeKey(m))}}}}}return g},o.toIndexableString=function(g){var j="\x00";return g=o.normalizeKey(g),i(g)+f+b(g)+j},o.parseIndexableString=function(y){for(var q=[],j=[],k=0;;){var w=y[k++];if("\x00"!==w){switch(w){case"1":q.push(null);break;case"2":q.push("1"===y[k]),k++;break;case"3":var m=h(y,k);q.push(m.num),k+=m.length;break;case"4":for(var v="";;){var x=y[k];if("\x00"===x){break}v+=x,k++}v=v.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),q.push(v);break;case"5":var z={element:[],index:q.length};q.push(z.element),j.push(z);break;case"6":var g={element:{},index:q.length};q.push(g.element),j.push(g);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+w)}}else{if(1===q.length){return q.pop()}l(q,j)}}}},{13:13}],13:[function(h,b,e){function a(f,l,m){for(var g="",n=m-f.length;g.length<n;){g+=l}return g}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var o,f=r.length,g=n.length;for(o=0;f>o;o++){if(o===g){return 1}var i=r.charAt(o),q=n.charAt(o);if(i!==q){return q>i?-1:1}}return g>f?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(i,a,b){function j(){this.store={}}function e(g){if(this.store=new j,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}b.Map=j,b.Set=e,j.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},j.prototype.unmangle=function(f){return f.substring(1)},j.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},j.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},j.prototype.has=function(f){var g=this.mangle(f);return g in this.store},j.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},j.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},e.prototype.add=function(f){return this.store.set(f,!0)},e.prototype.has=function(f){return this.store.has(f)},e.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(g,n){var o,p,q,r;p=[],r=[];for(o in n){h.call(n,o)&&(q=n[o],"this"!==o&&(p.push(o),r.push(q)))}return Function.apply(null,f.call(p).concat([g])).apply(n["this"],r)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(m){function v(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function o(j,w,k,q,A,z,x){return v(w&k|~w&q,j,w,A,z,x)}function l(j,w,k,q,A,z,x){return v(w&q|k&~q,j,w,A,z,x)}function r(j,w,k,q,A,z,x){return v(w^k^q,j,w,A,z,x)}function O(j,w,k,q,A,z,x){return v(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=o(z,k,x,q,w[0],7,-680876936),q=o(q,z,k,x,w[1],12,-389564586),x=o(x,q,z,k,w[2],17,606105819),k=o(k,x,q,z,w[3],22,-1044525330),z=o(z,k,x,q,w[4],7,-176418897),q=o(q,z,k,x,w[5],12,1200080426),x=o(x,q,z,k,w[6],17,-1473231341),k=o(k,x,q,z,w[7],22,-45705983),z=o(z,k,x,q,w[8],7,1770035416),q=o(q,z,k,x,w[9],12,-1958414417),x=o(x,q,z,k,w[10],17,-42063),k=o(k,x,q,z,w[11],22,-1990404162),z=o(z,k,x,q,w[12],7,1804603682),q=o(q,z,k,x,w[13],12,-40341101),x=o(x,q,z,k,w[14],17,-1502002290),k=o(k,x,q,z,w[15],22,1236535329),z=l(z,k,x,q,w[1],5,-165796510),q=l(q,z,k,x,w[6],9,-1069501632),x=l(x,q,z,k,w[11],14,643717713),k=l(k,x,q,z,w[0],20,-373897302),z=l(z,k,x,q,w[5],5,-701558691),q=l(q,z,k,x,w[10],9,38016083),x=l(x,q,z,k,w[15],14,-660478335),k=l(k,x,q,z,w[4],20,-405537848),z=l(z,k,x,q,w[9],5,568446438),q=l(q,z,k,x,w[14],9,-1019803690),x=l(x,q,z,k,w[3],14,-187363961),k=l(k,x,q,z,w[8],20,1163531501),z=l(z,k,x,q,w[13],5,-1444681467),q=l(q,z,k,x,w[2],9,-51403784),x=l(x,q,z,k,w[7],14,1735328473),k=l(k,x,q,z,w[12],20,-1926607734),z=r(z,k,x,q,w[5],4,-378558),q=r(q,z,k,x,w[8],11,-2022574463),x=r(x,q,z,k,w[11],16,1839030562),k=r(k,x,q,z,w[14],23,-35309556),z=r(z,k,x,q,w[1],4,-1530992060),q=r(q,z,k,x,w[4],11,1272893353),x=r(x,q,z,k,w[7],16,-155497632),k=r(k,x,q,z,w[10],23,-1094730640),z=r(z,k,x,q,w[13],4,681279174),q=r(q,z,k,x,w[0],11,-358537222),x=r(x,q,z,k,w[3],16,-722521979),k=r(k,x,q,z,w[6],23,76029189),z=r(z,k,x,q,w[9],4,-640364487),q=r(q,z,k,x,w[12],11,-421815835),x=r(x,q,z,k,w[15],16,530742520),k=r(k,x,q,z,w[2],23,-995338651),z=O(z,k,x,q,w[0],6,-198630844),q=O(q,z,k,x,w[7],10,1126891415),x=O(x,q,z,k,w[14],15,-1416354905),k=O(k,x,q,z,w[5],21,-57434055),z=O(z,k,x,q,w[12],6,1700485571),q=O(q,z,k,x,w[3],10,-1894986606),x=O(x,q,z,k,w[10],15,-1051523),k=O(k,x,q,z,w[1],21,-2054922799),z=O(z,k,x,q,w[8],6,1873313359),q=O(q,z,k,x,w[15],10,-30611744),x=O(x,q,z,k,w[6],15,-1560198380),k=O(k,x,q,z,w[13],21,1309151649),z=O(z,k,x,q,w[4],6,-145523070),q=O(q,z,k,x,w[11],10,-1120210379),x=O(x,q,z,k,w[2],15,718787259),k=O(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function n(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function P(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function u(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,n(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function s(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,P(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function Q(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function y(j){var k;for(k=0;k<j.length;k+=1){j[k]=Q(j[k])}return j.join("")}function p(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function t(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==y(u("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(k,q){var A,D,x,B,C=this.byteLength,w=j(k,C),z=C;return q!==m&&(z=j(q,C)),w>z?new ArrayBuffer(0):(A=z-w,D=new ArrayBuffer(A),x=new Uint8Array(D),B=new Uint8Array(this,w,A),x.set(B),D)}}(),t.prototype.append=function(j){return this.appendBinary(p(j)),this},t.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,n(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},t.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},t.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},t.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},t.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},t.hash=function(j,k){return t.hashBinary(p(j),k)},t.hashBinary=function(j,w){var q=u(j),k=y(q);return w?e(k):k},t.ArrayBuffer=function(){this.reset()},t.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,P(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},t.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=y(this._hash),j&&(z=e(z)),this.reset(),z},t.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},t.ArrayBuffer.prototype.getState=function(){var j=t.prototype.getState.call(this);return j.buff=S(j.buff),j},t.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),t.prototype.setState.call(this,j)},t.ArrayBuffer.prototype.destroy=t.prototype.destroy,t.ArrayBuffer.prototype._finish=t.prototype._finish,t.ArrayBuffer.hash=function(j,w){var q=s(new Uint8Array(j)),k=y(q);return w?e(k):k},t})},{}],17:[function(h,b,e){function a(r,n,o){var f=o[o.length-1];r===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,i=f.index;if(Array.isArray(g)){g.push(r)}else{if(i===n.length-2){var q=n.pop();g[q]=r}else{n.push(r)}}}e.stringify=function(E){var s=[];s.push({obj:E});for(var l,g,f,n,i,D,F,t,u,o,r,C="";l=s.pop();){if(g=l.obj,f=l.prefix||"",n=l.val||"",C+=f,n){C+=n}else{if("object"!=typeof g){C+="undefined"==typeof g?null:JSON.stringify(g)}else{if(null===g){C+="null"}else{if(Array.isArray(g)){for(s.push({val:"]"}),i=g.length-1;i>=0;i--){D=0===i?"":",",s.push({obj:g[i],prefix:D})}s.push({val:"["})}else{F=[];for(t in g){g.hasOwnProperty(t)&&F.push(t)}for(s.push({val:"}"}),i=F.length-1;i>=0;i--){u=F[i],o=g[u],r=i>0?",":"",r+=JSON.stringify(u)+":",s.push({obj:o,prefix:r})}s.push({val:"{"})}}}}}return C},e.parse=function(C){for(var n,l,A,g,D,i,t,B,u,f=[],o=[],s=0;;){if(n=C[s++],"}"!==n&&"]"!==n&&"undefined"!=typeof n){switch(n){case" ":case"	":case"\n":case":":case",":break;case"n":s+=3,a(null,f,o);break;case"t":s+=3,a(!0,f,o);break;case"f":s+=4,a(!1,f,o);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(l="",s--;;){if(A=C[s++],!/[\d\.\-e\+]/.test(A)){s--;break}l+=A}a(parseFloat(l),f,o);break;case'"':for(g="",D=void 0,i=0;;){if(t=C[s++],'"'===t&&("\\"!==D||i%2!==1)){break}g+=t,D=t,"\\"===D?i++:i=0}a(JSON.parse('"'+g+'"'),f,o);break;case"[":B={element:[],index:f.length},f.push(B.element),o.push(B);break;case"{":u={element:{},index:f.length},f.push(u.element),o.push(u);break;default:throw new Error("unexpectedly reached end of input: "+n)}}else{if(1===f.length){return f.pop()}a(f.pop(),f,o)}}}},{}]},{},[3])(3)});