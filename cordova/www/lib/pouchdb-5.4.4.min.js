!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(j,g){if(!l[j]){if(!b[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(k){return k(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=l[j]={exports:{}};b[j][0].call(f.exports,function(p){var m=b[j][1][p];return e(m?m:p)},f,f.exports,d,b,l,i)}return l[j].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,r,l,h,j,f;if(this._events||(this._events={}),"error"===k&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[k],m(r)){return !1}if(b(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(p(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(p(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(r,l,a){function e(){f&&n&&(f=!1,n.length?B=n.concat(B):i=-1,B.length&&u())}function u(){if(!f){var g=t(e);f=!0;for(var j=B.length;j;){for(n=B,B=[];++i<j;){n&&n[i].run()}i=-1,j=B.length}n=null,f=!1,o(g)}}function s(g,j){this.fun=g,this.array=j}function h(){}var t,o,b=l.exports={};!function(){try{t=setTimeout}catch(g){t=function(){throw new Error("setTimeout is not defined")}}try{o=clearTimeout}catch(g){o=function(){throw new Error("clearTimeout is not defined")}}}();var n,B=[],f=!1,i=-1;b.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}B.push(new s(j,k)),1!==B.length||f||t(u,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=h,b.addListener=h,b.once=h,b.off=h,b.removeListener=h,b.removeAllListeners=h,b.emit=h,b.binding=function(g){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(g){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],3:[function(b,e,a){(function(a3,gh){function fc(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function ge(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fy(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function gM(aa){if(aa instanceof ArrayBuffer){return fy(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function fU(aa){var ab=Object.getPrototypeOf(aa);if(null===ab){return !0}var t=ab.constructor;return"function"==typeof t&&t instanceof t&&ei.call(t)==iq}function h2(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=h2(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(ge(ac)){return gM(ac)}if(!fU(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=h2(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function hB(t){var aa=!1;return he(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function co(t){return he(function(ac){ac=h2(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){a3.nextTick(function(){ad(ah,ag)})});var af=new jm(function(ah,aj){var al;try{var ag=hB(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function iz(aa,ab){function t(ac,af,ah){if(fV.enabled){for(var ad=[ac._db_name,af],aj=0;aj<ah.length-1;aj++){ad.push(ah[aj])}fV.apply(null,ad);var ag=ah[ah.length-1];ah[ah.length-1]=function(ak,am){var al=[ac._db_name,af];al=al.concat(ak?["error",ak]:["success",am]),fV.apply(null,al),ag(ak,am)}}}return co(he(function(ad){if(this._closed){return jm.reject(new Error("database is closed"))}if(this._destroyed){return jm.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new jm(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function fZ(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function ee(t){return t}function g5(t){return[{ok:t}]}function a9(aj,ah,aq){function af(){var av=[];au.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aq(null,{results:av})}function aa(){++ad===t&&af()}function am(av,aw,ax){au[av]={id:aw,docs:ax},aa()}function ac(){if(!(ab>=ap.length)){var av=Math.min(ab+ju,ap.length),aw=ap.slice(ab,av);ag(aw,ab),ab+=aw.length}}function ag(av,aw){av.forEach(function(aA,ay){var aC=aw+ay,aB=al[aA],ax=fZ(aB[0],["atts_since","attachments"]);ax.open_revs=aB.map(function(aD){return aD.rev}),ax.open_revs=ax.open_revs.filter(ee);var az=ee;0===ax.open_revs.length&&(delete ax.open_revs,az=g5),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ah&&(ax[aD]=ah[aD])}),aj.get(aA,ax,function(aD,aF){var aE;aE=aD?[{error:aD}]:az(aF),am(aC,aA,aE),ac()})})}var ak=ah.docs,al={};ak.forEach(function(av){av.id in al?al[av.id].push(av):al[av.id]=[av]});var t=Object.keys(al).length,ad=0,au=new Array(t),ap=Object.keys(al),ab=0;ac()}function gz(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gf(){return u}function gC(t){gz()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gf()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function fi(){hx.EventEmitter.call(this),this._listeners={},gC(this)}function iO(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function er(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function gl(t){var aa=0;return t||(aa=2000),er(t,aa)}function fp(t,aa){iO("info","The above "+t+" is totally normal. "+aa)}function ci(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function ih(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=ci.prototype,new ab(ac)}function fv(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=gu("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=fn:"doc_validation"===aa?(ad=et,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=gW),ad||(ad=gu("status",ac.status,af)||iB),t=ih(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function gX(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return ih(gW,ab)}}function jt(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&gX(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function a7(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function jd(t){var aa;if(t?"string"!=typeof t?aa=ih(je):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=ih(fz)):aa=ih(ik),aa){throw aa}}function g4(t,aa){return"listenerCount" in t?t.listenerCount(aa):hx.EventEmitter.listenerCount(t,aa)}function jl(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function iu(t){var aa=jl(t);return aa?aa.join("/"):null}function dt(ab){for(var ad=de.exec(ab),ag={},ac=14;ac--;){var aa=fm[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[iV]={},ag[fm[12]].replace(m,function(aj,ah,ak){ah&&(ag[iV][ah]=ak)}),ag}function fa(aa,ab,t){return new jm(function(ad,ac){aa.get(ab,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=t(ag);return af?(af._id=ab,af._rev=ah,void ad(hF(aa,af,t))):ad({updated:!1,rev:ah})})})}function hF(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return fa(aa,ab._id,t)})}function g9(t){return 0|Math.random()*t}function fu(aa,ac){ac=ac||iX.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=iX[g9(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=iX[3&g9(16)|8];break;default:t+=iX[g9(16)]}}return t}function g0(t){for(var aj,af,ah,ag,ac=t.rev_tree.slice();ag=ac.pop();){var al=ag.ids,ab=al[2],ak=ag.pos;if(ab.length){for(var am=0,aa=ab.length;aa>am;am++){ac.push({pos:ak+1,ids:ab[am]})}}else{var ad=!!al[1].deleted,ap=al[0];aj&&!(ah!==ad?ah:af!==ak?ak>af:ap>aj)||(aj=ap,af=ak,ah=ad)}}return af+"-"+aj}function cn(ac,ak){for(var af,ah=ac.slice();af=ah.pop();){for(var ag=af.pos,ad=af.ids,aa=ad[2],aj=ak(0===aa.length,ag,ad[0],af.ctx,ad[1]),t=0,ab=aa.length;ab>t;t++){ah.push({pos:ag+1,ids:aa[t],ctx:aj})}}}function ar(t,aa){return t.pos-aa.pos}function gA(aa){var ac=[];cn(aa,function(af,aj,ag,ad,ah){af&&ac.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),ac.sort(ar).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function gk(ab){for(var ad=g0(ab),ag=gA(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function g6(t){var aa=[];return cn(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function ga(t){for(var aj,af=[],ah=t.slice();aj=ah.pop();){var ag=aj.pos,ac=aj.ids,al=ac[0],ab=ac[1],ak=ac[2],am=0===ak.length,aa=aj.history?aj.history.slice():[];aa.push({id:al,opts:ab}),am&&af.push({pos:ag+1-aa.length,ids:aa});for(var ad=0,ap=ak.length;ap>ad;ad++){ah.push({pos:ag+1,ids:ak[ad],history:aa})}}return af.reverse()}function fq(t,aa){return t.pos-aa.pos}function iD(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function gK(aa,ac,t){var ab=iD(aa,ac,t);aa.splice(ab,0,ac)}function E(t,ac){for(var ag,aa,ah=ac,ad=t.length;ad>ah;ah++){var af=t[ah],ab=[af.id,af.opts,[]];aa?(aa[2].push(ab),aa=ab):ag=aa=ab}return ag}function di(t,aa){return t[0]<aa[0]?-1:1}function ev(ac,ak){for(var af=[{tree1:ac,tree2:ak}],ah=!1;af.length>0;){var ag=af.pop(),ad=ag.tree1,aa=ag.tree2;(ad[1].status||aa[1].status)&&(ad[1].status="available"===ad[1].status||"available"===aa[1].status?"available":"missing");for(var aj=0;aj<aa[2].length;aj++){if(ad[2][0]){for(var t=!1,ab=0;ab<ad[2].length;ab++){ad[2][ab][0]===aa[2][aj][0]&&(af.push({tree1:ad[2][ab],tree2:aa[2][aj]}),t=!0)}t||(ah="new_branch",gK(ad[2],aa[2][aj],di))}else{ah="new_leaf",ad[2][0]=aa[2][aj]}}}return{conflicts:ah,tree:ac}}function iT(ad,aa,ag){var al,av=[],t=!1,ac=!1;if(!ad.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=ad.length;aw>ak;ak++){var aj=ad[ak];if(aj.pos===aa.pos&&aj.ids[0]===aa.ids[0]){al=ev(aj.ids,aa.ids),av.push({pos:aj.pos,ids:al.tree}),t=t||al.conflicts,ac=!0}else{if(ag!==!0){var am=aj.pos<aa.pos?aj:aa,ab=aj.pos<aa.pos?aa:aj,ap=ab.pos-am.pos,aq=[],ax=[];for(ax.push({ids:am.ids,diff:ap,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],af=0,ah=az.length;ah>af;af++){ax.push({ids:az[af],diff:ay.diff-1,parent:ay.ids,parentIdx:af})}}else{ay.ids[0]===ab.ids[0]&&aq.push(ay)}}var au=aq[0];au?(al=ev(au.ids,ab.ids),au.parent[2][au.parentIdx]=al.tree,av.push({pos:am.pos,ids:am.ids}),t=t||al.conflicts,ac=!0):av.push(aj)}else{av.push(aj)}}}return ac||av.push(aa),av.sort(fq),{tree:av,conflicts:t||"internal_node"}}function r(t,aj){for(var af,ah=ga(t),ag={},ac=0,al=ah.length;al>ac;ac++){for(var ab=ah[ac],ak=ab.ids,am=Math.max(0,ak.length-aj),aa={pos:ab.pos+am,ids:E(ak,am)},ad=0;am>ad;ad++){var ap=ab.pos+ad+"-"+ak[ad].id;ag[ap]=!0}af=af?iT(af,aa,!0).tree:[aa]}return cn(af,function(aq,au,av){delete ag[au+"-"+av]}),{tree:af,revs:Object.keys(ag)}}function eo(ac,t,aa){var ad=iT(ac,t),ab=r(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function jg(ac,ak){for(var af,ah=ac.slice(),ag=ak.split("-"),ad=parseInt(ag[0],10),aa=ag[1];af=ah.pop();){if(af.pos===ad&&af.ids[0]===aa){return !0}for(var aj=af.ids[2],t=0,ab=aj.length;ab>t;t++){ah.push({pos:af.pos+1,ids:aj[t]})}}return !1}function fd(t){return t.ids}function fS(ac,t){t||(t=g0(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(fd);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function ex(t){return/^_local/.test(t)}function iv(t){return i5("return "+t+";",{})}function iP(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jw(aa,ab){try{aa.emit("change",ab)}catch(t){iO("error",'Error in .on("change", function):',t)}}function bo(ab,ad,ag){function ac(){aa.cancel()}hx.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?h2(ad):{};var t=ad.complete=hB(function(ah,aj){ah?g4(aa,"error")>0&&aa.emit("error",ah):aa.emit("complete",aj),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(jw(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new jm(function(ah,aj){ad.complete=function(al,ak){al?aj(al):ah(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function w(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=gA(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return fS(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=gk(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function gO(t,aa){return aa>t?-1:t>aa?1:0}function g(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function an(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function iM(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=fZ(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function L(ac,t){var aa=gO(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return gO(ad,ab)}function i6(aa){var ab={},t=[];return cn(aa,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(ab[ah]=0),void 0!==ag&&t.push({from:ag,to:ah}),ah}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function a4(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return jm.all(ad.map(function(af){var ag=iZ.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new jm(function(ah,aj){ac._allDocs(ag,function(ak,al){return ak?aj(ak):(ab.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function jE(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),a3.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&jE(aa)})})})}function h0(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function iC(){hx.EventEmitter.call(this)}function fW(){this.isReady=!1,this.failed=!1,this.queue=[]}function hE(t){t&&gh.debug&&iO("error",t)}function iy(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function hn(ab,ad,ag){if(!(this instanceof hn)){return new hn(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=hE}else{var aa=ag;ag=function(){return iO("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=h2(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=hn.prefix,iC.call(ac),ac.taskqueue=new fW;var af=new jm(function(ah,ak){ag=function(ap,am){return ap?ak(ap):(delete am.then,void ah(am))},ad=h2(ad);var al,aj;return function(){try{if("string"!=typeof ab){throw aj=new Error("Missing/invalid DB name"),aj.code=400,aj}var ap=(ad.prefix||"")+ab;if(al=hn.parseAdapter(ap,ad),ad.originalName=ab,ad.name=al.name,ad.adapter=ad.adapter||al.adapter,ac._adapter=ad.adapter,io("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!hn.adapters[ad.adapter]){throw aj=new Error("Adapter is missing"),aj.code=404,aj}if(!hn.adapters[ad.adapter].valid()){throw aj=new Error("Invalid Adapter"),aj.code=404,aj}}catch(am){ac.taskqueue.fail(am)}}(),aj?ak(aj):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void hn.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(iy(ac,ad),ac.emit("created",ac),hn.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function ii(t){Object.keys(hx.EventEmitter.prototype).forEach(function(ab){"function"==typeof hx.EventEmitter.prototype[ab]&&(t[ab]=dn[ab].bind(dn))});var aa=t._destructionListeners=new hS.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function hs(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function gd(aa){if(!/^\d+\-./.test(aa)){return ih(bt)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function S(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function gE(ac,ak){var af,ah,ag,ad={status:"available"};if(ac._deleted&&(ad.deleted=!0),ak){if(ac._id||(ac._id=fu()),ah=fu(32,16).toLowerCase(),ac._rev){if(ag=gd(ac._rev),ag.error){return ag}ac._rev_tree=[{pos:ag.prefix,ids:[ag.id,{status:"missing"},[[ah,ad,[]]]]}],af=ag.prefix+1}else{ac._rev_tree=[{pos:1,ids:[ah,ad,[]]}],af=1}}else{if(ac._revisions&&(ac._rev_tree=S(ac._revisions,ad),af=ac._revisions.start,ah=ac._revisions.ids[0]),!ac._rev_tree){if(ag=gd(ac._rev),ag.error){return ag}af=ag.prefix,ah=ag.id,ac._rev_tree=[{pos:af,ids:[ah,ad,[]]}]}}jd(ac._id),ac._rev=af+"-"+ah;var aa={metadata:{},data:{}};for(var aj in ac){if(Object.prototype.hasOwnProperty.call(ac,aj)){var t="_"===aj[0];if(t&&!fo[aj]){var ab=ih(et,aj);throw ab.message=et.message+": "+aj,ab}t&&!hY[aj]?aa.metadata[aj.slice(1)]=ac[aj]:aa.data[aj]=ac[aj]}}return aa}function R(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function jq(t){return h3(R(t))}function hA(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function i3(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function hH(t,aa){return hA([i3(t)],{type:aa})}function fh(t,aa){return hH(ht(t),aa)}function Z(aa,ac){if("undefined"==typeof FileReader){return ac(R((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(R(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function jn(t,aa){Z(t,function(ab){aa(h3(ab))})}function hL(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function y(t){return h3(t)}function H(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function iS(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function O(ac,ak){function af(){var aq=aj*ad,al=aq+ad;if(aj++,aa>aj){ab(t,ac,aq,al),D(af)}else{ab(t,ac,aq,al);var ap=t.end(!0),am=y(ap);ak(am),t.destroy()}}var ah="string"==typeof ac,ag=ah?ac.length:ac.byteLength,ad=Math.min(iU,ag),aa=Math.ceil(ag/ad),aj=0,t=ah?new hw:new hw.ArrayBuffer,ab=ah?iS:H;af()}function I(t){return hw.hash(t)}function bn(t,ac,ag){function aa(al){try{return ht(al)}catch(aj){var ak=ih(gB,"Attachment is not a valid base64 string");return{error:ak}}}function ah(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=aa(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ac?aj.data=hH(al,aj.content_type):"base64"===ac?aj.data=h3(al):aj.data=al,O(al,function(am){aj.digest="md5-"+am,ak()})}else{hL(aj.data,function(am){"binary"===ac?aj.data=R(am):"base64"===ac&&(aj.data=jq(am)),O(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ad(){ab++,t.length===ab&&(af?ag(af):ag())}if(!t.length){return ag()}var af,ab=0;t.forEach(function(ak){function am(aq){af=aq,al++,al===aj.length&&ad()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ad()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ah(ak.data._attachments[ap],am)}})}function hN(t,aa,aw,ah,ax,ak,ab,ac){if(jg(aa.rev_tree,aw.metadata.rev)){return ah[ax]=aw,ak()}var ay=aa.winningRev||g0(aa),au="deleted" in aa?aa.deleted:fS(aa,ay),aj="deleted" in aw.metadata?aw.metadata.deleted:fS(aw.metadata),aq=/^1-/.test(aw.metadata.rev);if(au&&!aj&&ac&&aq){var av=aw.data;av._rev=ay,av._id=aw.metadata.id,aw=gE(av,ac)}var ag=eo(aa.rev_tree,aw.metadata.rev_tree[0],t),az=ac&&(au&&aj||!au&&"new_leaf"!==ag.conflicts||au&&!aj&&"new_branch"===ag.conflicts);if(az){var aA=ih(hK);return ah[ax]=aA,ak()}var am=aw.metadata.rev;aw.metadata.rev_tree=ag.tree,aw.stemmedRevs=ag.stemmedRevs||[],aa.rev_map&&(aw.metadata.rev_map=aa.rev_map);var af,al=g0(aw.metadata),ap=fS(aw.metadata,al),ad=au===ap?0:ap>au?-1:1;af=am===al?ap:fS(aw.metadata,am),ab(aw,al,ap,af,!0,ad,ax,ak)}function gy(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function hv(aa,al,ah,au,am,af,aq,ak,ab){function t(aA,aC,aw){var av=g0(aA.metadata),ay=fS(aA.metadata,av);if("was_delete" in ak&&ay){return af[aC]=ih(fn,"deleted"),aw()}var ax=aj&&gy(aA);if(ax){var az=ih(hK);return af[aC]=az,aw()}var aB=ay?0:1;aq(aA,av,ay,ay,!1,aB,aC,aw)}function ac(){++ap===ad&&ab&&ab()}aa=aa||1000;var aj=ak.new_edits,ag=new hS.Map,ap=0,ad=al.length;al.forEach(function(ay,aw){if(ay._id&&ex(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void ah[av](ay,{ctx:am},function(aA,az){af[aw]=aA||az,ac()})}var ax=ay.metadata.id;ag.has(ax)?(ad--,ag.get(ax).push([ay,aw])):ag.set(ax,[[ay,aw]])}),ag.forEach(function(aw,ay){function az(){++ax<aw.length?av():ac()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(au.has(ay)){hN(aa,au.get(ay),aA,af,aB,az,aq,aj)}else{var aD=eo([],aA.metadata.rev_tree[0],aa);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],t(aA,aB,az)}}var ax=0;av()})}function id(t){try{return JSON.parse(t)}catch(aa){return hi.parse(t)}}function jB(t){return t.length<50000?JSON.parse(t):id(t)}function fx(t){try{return JSON.stringify(t)}catch(aa){return hi.stringify(t)}}function gI(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function jA(t){if(!f.running&&f.queue.length){f.running=!0;var aa=f.queue.shift();aa.action(function(ac,ab){gI(aa.callback,this,[ac,ab],t),f.running=!1,a3.nextTick(function(){jA(t)})})}}function ja(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(ih(hy,aa,ab.type))}}function Y(aa,ab,t){return{data:fx(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function ix(t){if(!t){return null}var aa=jB(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function a8(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function eu(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:fh(aa,ac):hA([""],{type:ac})):aa?"string"!=typeof aa?Z(aa,function(ad){ab(h3(ad))}):ab(aa):ab("")}function ib(t,ac,ag,aa){function ah(){++ab===af.length&&aa&&aa()}function ad(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ag.objectStore(iL).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ah()}}var af=Object.keys(t._attachments||{});if(!af.length){return aa&&aa()}var ab=0;af.forEach(function(aj){ac.attachments&&ac.include_docs?ad(t,aj):(t._attachments[aj].stub=!0,ah())})}function hf(t,aa){return jm.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return jm.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new jm(function(aj){eu(ad,ag,aa,function(ak){ac.doc._attachments[ah]=iZ.extend(fZ(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function i2(ac,ak,af){function ah(){ab--,ab||ag()}function ag(){ad.length&&ad.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aj["delete"](am)}})}var ad=[],aa=af.objectStore(g2),aj=af.objectStore(iL),t=af.objectStore(hQ),ab=ac.length;ac.forEach(function(al){var am=aa.index("_doc_id_rev"),ap=ak+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return ah()}aa["delete"](av);var aq=t.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];ad.push(aw),t["delete"](ay.primaryKey),ay["continue"]()}else{ah()}}}})}function hq(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function ji(aG,aJ,aD,aH,aF,aj,aC){function ap(){var aN=[gv,g2,iL,K,hQ],aO=hq(aF,aN,"readwrite");return aO.error?aC(aO.error):(aB=aO.txn,aB.onabort=ja(aC),aB.ontimeout=ja(aC),aB.oncomplete=au,al=aB.objectStore(gv),av=aB.objectStore(g2),ag=aB.objectStore(iL),ab=aB.objectStore(hQ),void aM(function(aP){return aP?(aq=!0,aC(aP)):void aL()}))}function az(){hv(aG.revs_limit,t,aH,ak,aB,aw,am,aD)}function aL(){function aR(){++aP===t.length&&az()}function aT(aU){var aV=ix(aU.target.result);aV&&ak.set(aV.id,aV),aR()}if(t.length){for(var aP=0,aS=0,aQ=t.length;aQ>aS;aS++){var aN=t[aS];if(aN._id&&ex(aN._id)){aR()}else{var aO=al.get(aN.metadata.id);aO.onsuccess=aT}}}}function au(){aq||(aj.notify(aH._meta.name),aH._meta.docCount+=aA,aC(null,aw))}function ax(aO,aP){var aN=ag.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=ih(gL,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(t.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){ax(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function am(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ay(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bb){var aZ=aP.stemmedRevs||[];aV&&aH.auto_compaction&&(aZ=aZ.concat(g6(aP.metadata))),aZ&&aZ.length&&i2(aZ,aP.metadata.id,aB),aT.seq=bb.target.result,delete aT.rev;var ba=Y(aT,aW,aU),bc=al.put(ba);bc.onsuccess=aN}function aX(aZ){aZ.preventDefault(),aZ.stopPropagation();var ba=av.index("_doc_id_rev"),bb=ba.getKey(aR._doc_id_rev);bb.onsuccess=function(bc){var bd=av.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aw[aS]={ok:!0,id:aT.id,rev:aW},ak.set(aP.metadata.id,aP.metadata),aI(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=av.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ay(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(bb){var aZ=aP.data._attachments[bb];if(aZ.stub){aO++,aN()}else{var aY=aZ.data;delete aZ.data,aZ.revpos=parseInt(aW,10);var ba=aZ.digest;ah(ba,aY,aV)}})}function aI(aN,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aV){var aW=aN.data._attachments[aV].digest,aX=ab.put({seq:aQ,digestSeq:aW+"::"+aQ});aX.onsuccess=aO,aX.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aN.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function ah(aO,aQ,aN){var aP=ag.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=ag.put(aS);aT.onsuccess=aN}}for(var aB,al,av,ag,ab,ac,t=aJ.docs,aA=0,aa=0,af=t.length;af>aa;aa++){var aE=t[aa];aE._id&&ex(aE._id)||(aE=t[aa]=gE(aE,aD.new_edits),aE.error&&!ac&&(ac=aE))}if(ac){return aC(ac)}var aw=new Array(t.length),ak=new hS.Map,aq=!1,aK=aH._meta.blobSupport?"blob":"base64";bn(t,aK,function(aN){return aN?aC(aN):void ap()})}function ig(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function go(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(ih(hy,t.name,t.message))}function iJ(ac,t,aa,ad){function ab(am,aA){function aq(aK,aL,aN){var aM=aK.id+"::"+aN;az.get(aM).onsuccess=function(aO){aL.doc=a8(aO.target.result),am.conflicts&&(aL.doc._conflicts=gk(aK)),ib(aL.doc,am,al)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===am.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):am.include_docs&&aq(aK,aM,aO)}else{if(!aN&&aC--<=0&&(aJ.push(aM),am.include_docs&&aq(aK,aM,aO),0===--aE)){return}}aL["continue"]()}function ay(aN){ag=t._meta.docCount;var aL=aN.target.result;if(aL){var aK=ix(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function ah(){aA(null,{total_rows:ag,offset:am.skip,rows:aJ})}function aw(){am.attachments?hf(aJ,am.binary).then(ah):ah()}var ak="startkey" in am?am.startkey:!1,aD="endkey" in am?am.endkey:!1,ax="key" in am?am.key:!1,aC=am.skip||0,aE="number"==typeof am.limit?am.limit:-1,aj=am.inclusive_end!==!1,au="descending" in am&&am.descending?"prev":null,aB=ig(ak,aD,aj,ax,au);if(aB&&aB.error){return go(t,am,aB.error,aA)}var aG=[gv,g2];am.attachments&&aG.push(iL);var aH=hq(aa,aG,"readonly");if(aH.error){return aA(aH.error)}var al=aH.txn,aI=al.objectStore(gv),ap=al.objectStore(g2),aF=au?aI.openCursor(aB,au):aI.openCursor(aB),az=ap.index("_doc_id_rev"),aJ=[],ag=0;al.oncomplete=aw,aF.onsuccess=ay}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:t._meta.docCount,offset:ag.skip,rows:[]}):void ab(ag,ah)}af(ac,ad)}function jD(t){return new jm(function(ab){var aa=hA([""]);t.objectStore(jv).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function z(aa,ab){var t=this;f.queue.push({action:function(ac){iI(t,aa,ac)},callback:ab}),jA(t.constructor)}function iI(aj,ah,ac){function aa(au){var av=au.createObjectStore(gv,{keyPath:"id"});au.createObjectStore(g2,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(iL,{keyPath:"digest"}),au.createObjectStore(gr,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jv),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(K,{keyPath:"_id"});var aw=au.createObjectStore(hQ,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function aq(au,av){var aw=au.objectStore(gv);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=fS(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ad(au){au.createObjectStore(K,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ak(ax,av){var aw=ax.objectStore(K),az=ax.objectStore(gv),ay=ax.objectStore(g2),au=az.openCursor();au.onsuccess=function(aI){var aL=aI.target.result;if(aL){var aF=aL.value,aC=aF.id,aD=ex(aC),aG=g0(aF);if(aD){var aJ=aC+"::"+aG,aA=aC+"::",aH=aC+"::~",aK=ay.index("_doc_id_rev"),aB=IDBKeyRange.bound(aA,aH,!1,!1),aE=aK.openCursor(aB);aE.onsuccess=function(aN){if(aE=aN.target.result){var aM=aE.value;aM._doc_id_rev===aJ&&aw.put(aM),ay["delete"](aE.primaryKey),aE["continue"]()}else{az["delete"](aL.primaryKey),aL["continue"]()}}}else{aL["continue"]()}}else{av&&av()}}}function ap(au){var av=au.createObjectStore(hQ,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function am(ax,av){var aw=ax.objectStore(g2),az=ax.objectStore(iL),ay=ax.objectStore(hQ),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aI){var aC=aI.target.result;if(!aC){return av()}for(var aD=aC.value,aK=aC.primaryKey,aG=Object.keys(aD._attachments||{}),aE={},aF=0;aF<aG.length;aF++){var aH=aD._attachments[aG[aF]];aE[aH.digest]=!0}var aJ=Object.keys(aE);for(aF=0;aF<aJ.length;aF++){var aL=aJ[aF];ay.put({seq:aK,digestSeq:aL+"::"+aK})}aC["continue"]()}):av()}}function ag(av){function au(az){return az.data?ix(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(g2),ax=av.objectStore(gv),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=Y(aD,aD.winningRev,aD.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=au(aA.value);return aD.winningRev=aD.winningRev||g0(aD),aD.seq?az():void aB()}}}var ab=ah.name,af=null;aj._meta=null,aj.type=function(){return"idb"},aj._id=co(function(au){au(null,aj._meta.instanceId)}),aj._bulkDocs=function(aw,av,au){ji(ah,aw,av,aj,af,gq,au)},aj._get=function(aw,aB,aC){function ay(){aC(av,{doc:ax,metadata:az,ctx:aA})}var ax,az,av,aA=aB.ctx;if(!aA){var au=hq(af,[gv,g2,iL],"readonly");if(au.error){return aC(au.error)}aA=au.txn}aA.objectStore(gv).get(aw).onsuccess=function(aG){if(az=ix(aG.target.result),!az){return av=ih(fn,"missing"),ay()}if(fS(az)&&!aB.rev){return av=ih(fn,"deleted"),ay()}var aE=aA.objectStore(g2),aD=aB.rev||az.winningRev,aF=az.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return ax=aH.target.result,ax&&(ax=a8(ax)),ax?void ay():(av=ih(fn,"missing"),ay())}}},aj._getAttachment=function(aw,aB,aC,ay,ax){var az;if(ay.ctx){az=ay.ctx}else{var av=hq(af,[gv,g2,iL],"readonly");if(av.error){return ax(av.error)}az=av.txn}var aA=aC.digest,au=aC.content_type;az.objectStore(iL).get(aA).onsuccess=function(aE){var aD=aE.target.result.body;eu(aD,au,ay.binary,function(aF){ax(null,aF)})}},aj._info=function(av){if(null===af||!hD.has(ab)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var ax,ay,az=hq(af,[g2],"readonly");if(az.error){return av(az.error)}var aw=az.txn,au=aw.objectStore(g2).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,ay=aj._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:ax,idb_attachment_format:aj._meta.blobSupport?"binary":"base64"})}},aj._allDocs=function(av,au){iJ(av,aj,af,au)},aj._changes=function(aB){function aH(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aI=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aG.get(aU);aT.onsuccess=function(aV){aO(a8(aV.target.result))}}function aO(aU){var aT=aB.processChange(aU,aN,aB);aT.seq=aN.seq;var aV=aw(aT);return"object"==typeof aV?aB.complete(aV):(aV&&(ax++,aK&&aC.push(aT),aB.attachments&&aB.include_docs?ib(aU,aB,aD,function(){hf([aT],aB.binary).then(function(){aB.onChange(aT)})}):aB.onChange(aT)),void (ax!==aJ&&aS["continue"]()))}var aQ=a8(aS.value),aR=aS.key;if(az&&!az.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aL.get(aQ._id).onsuccess=function(aT){aN=ix(aT.target.result),ay.set(aQ._id,aN),aM()})}function aF(aN){var aM=aN.target.result;aM&&aH(aM)}function aE(){var aM=[gv,g2];aB.attachments&&aM.push(iL);var aN=hq(af,aM,"readonly");if(aN.error){return aB.complete(aN.error)}aD=aN.txn,aD.onabort=ja(aB.complete),aD.oncomplete=aA,av=aD.objectStore(g2),aL=aD.objectStore(gv),aG=av.index("_doc_id_rev");var aO;aO=aB.descending?av.openCursor(null,"prev"):av.openCursor(IDBKeyRange.lowerBound(aB.since,!0)),aO.onsuccess=aF}function aA(){function aM(){aB.complete(null,{results:aC,last_seq:aI})}!aB.continuous&&aB.attachments?hf(aC).then(aM):aM()}if(aB=h2(aB),aB.continuous){var au=ab+":"+fu();return gq.addListener(ab,au,aj,aB),gq.notify(ab),{cancel:function(){gq.removeListener(ab,au)}}}var az=aB.doc_ids&&new hS.Set(aB.doc_ids);aB.since=aB.since||0;var aI=aB.since,aJ="limit" in aB?aB.limit:-1;0===aJ&&(aJ=1);var aK;aK="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aD,av,aL,aG,aC=[],ax=0,aw=jt(aB),ay=new hS.Map;aE()},aj._close=function(au){return null===af?au(ih(g1)):(af.close(),hD["delete"](ab),af=null,void au())},aj._getRevisionTree=function(av,au){var aw=hq(af,[gv],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(gv).get(av);ay.onsuccess=function(aA){var az=ix(aA.target.result);az?au(null,az.rev_tree):au(ih(fn))}},aj._doCompaction=function(aA,av,ay){var au=[gv,g2,iL,hQ],ax=hq(af,au,"readwrite");if(ax.error){return ay(ax.error)}var az=ax.txn,aw=az.objectStore(gv);aw.get(aA).onsuccess=function(aC){var aE=ix(aC.target.result);cn(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),i2(av,aA,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(gv).put(Y(aE,aD,aB))},az.onabort=ja(ay),az.oncomplete=function(){ay()}},aj._getLocal=function(av,au){var aw=hq(af,[K],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(K).get(av);ay.onerror=ja(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(ih(fn))}},aj._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=hq(af,[K],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=ja(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(K);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(ih(hK))}}):(az=aC.add(aD),az.onerror=function(aE){aA(ih(hK)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},aj._removeLocal=function(aw,aB,aC){"function"==typeof aB&&(aC=aB,aB={});var ay=aB.ctx;if(!ay){var ax=hq(af,[K],"readwrite");if(ax.error){return aC(ax.error)}ay=ax.txn,ay.oncomplete=function(){az&&aC(null,az)}}var az,av=aw._id,aA=ay.objectStore(K),au=aA.get(av);au.onerror=ja(aC),au.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aw._rev?(aA["delete"](av),az={ok:!0,id:av,rev:"0-0"},aB.ctx&&aC(null,az)):aC(ih(fn))}},aj._destroy=function(ax,av){gq.removeAllListeners(ab);var aw=ir.get(ab);aw&&aw.result&&(aw.result.close(),hD["delete"](ab));var au=indexedDB.deleteDatabase(ab);au.onsuccess=function(){ir["delete"](ab),gf()&&ab in localStorage&&delete localStorage[ab],av(null,{ok:!0})},au.onerror=ja(av)};var al=hD.get(ab);if(al){return af=al.idb,aj._meta=al.global,void a3.nextTick(function(){ac(null,aj)})}var t;t=ah.storage?hz(ab,ah.storage):indexedDB.open(ab,h8),ir.set(ab,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return aa(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&ad(az),av.oldVersion<4&&ap(az);var ay=[aq,ak,am,ag],au=av.oldVersion;ax()},t.onsuccess=function(az){af=az.target.result,af.onversionchange=function(){af.close(),hD["delete"](ab)},af.onabort=function(aA){iO("error","Database has a global failure",aA.target.error),af.close(),hD["delete"](ab)};var aw=af.transaction([gr,jv,gv],"readwrite"),ay=aw.objectStore(gr).get(gr),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(aj._meta={name:ab,instanceId:au,blobSupport:av,docCount:ax},hD.set(ab,{idb:af,global:aj._meta}),ac(null,aj))},aA=aB.target.result||{id:gr};ab+"_id" in aA?(au=aA[ab+"_id"],aD()):(au=fu(),aA[ab+"_id"]=au,aw.objectStore(gr).put(aA).onsuccess=function(){aD()}),gT||(gT=jD(aw)),gT.then(function(aE){av=aE,aD()});var aC=aw.objectStore(gv).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iO("error",au),ac(ih(hy,au))}}function hz(aa,ab){try{return indexedDB.open(aa,{version:h8,storage:ab})}catch(t){return indexedDB.open(aa,h8)}}function iw(t){t.adapter("idb",z,!0)}function iH(t){return decodeURIComponent(escape(t))}function hX(t){return 65>t?t-48:t-55}function jy(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(hX(aa.charCodeAt(ac++))<<4|hX(aa.charCodeAt(ac++)))}return ab}function gn(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(hX(aa.charCodeAt(ac+2))<<12|hX(aa.charCodeAt(ac+3))<<8|hX(aa.charCodeAt(ac))<<4|hX(aa.charCodeAt(ac+1))),ac+=4}return ab}function hW(t,aa){return"UTF-8"===aa?iH(jy(t,0,t.length)):gn(t,0,t.length)}function hk(t){return"'"+t+"'"}function jk(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function gj(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jf(t){return delete t._id,delete t._rev,JSON.stringify(t)}function js(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function ft(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function T(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function jh(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+ie+" WHERE seq IN "+ft(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+ie+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+ie+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new hS.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+ie+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+ce+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(ah){var aj="SELECT seq FROM "+i0+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ad,ah],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+i0+" WHERE seq=?",[ak],ac)})})}}function J(t){return function(ad){iO("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(ih(ew,ab,ac))}}function it(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function hT(ag,ak,aB,av,au,aa,ab){function ax(){return ah?ab(ah):(aa.notify(av._name),av._docCount=-1,void ab(null,am))}function al(aD,aE){var aC="SELECT count(*) as cnt FROM "+ce+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=ih(gL,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ad(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){al(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ay(aI,aP,aF,aK,aM,aD,aN,aQ){function aG(){function aT(bc,ba){function bb(){return ++bd===bf.length&&ba(),!1}function aZ(bi){var bh="INSERT INTO "+ie+" (digest, seq) VALUES (?,?)",bj=[aU._attachments[bi].digest,bc];ap.executeSql(bh,bj,bb,bb)}var bd=0,bf=Object.keys(aU._attachments||{});if(!bf.length){return ba()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aU=aI.data,aR=aK?1:0,aW=aU._id,aS=aU._rev,aY=jf(aU),aX="INSERT INTO "+i0+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aV=[aW,aS,aY,aR];ap.executeSql(aX,aV,function(bb,aZ){var ba=aZ.insertId;aT(ba,function(){aH(bb,ba)})},function(){var aZ=T("seq",i0,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aW,aS],function(bb,bf){var bd=bf.rows.item(0).seq,bc="UPDATE "+i0+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aY,aR,aW,aS];bb.executeSql(bc,ba,function(bg){aT(bd,function(){aH(bg,bd)})})}),!1})}function aJ(aR){aL||(aR?(aL=aR,aQ(aL)):aC===aE.length&&aG())}function aO(aR){aC++,aJ(aR)}function aH(aT,aU){var aR=aI.metadata.id,aS=aI.stemmedRevs||[];aM&&av.auto_compaction&&(aS=g6(aI.metadata).concat(aS)),aS.length&&jh(aS,aR,aT),aI.metadata.seq=aU,delete aI.metadata.rev;var aX=aM?"UPDATE "+hV+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+i0+" WHERE doc_id="+hV+".id AND rev=?) WHERE id=?":"INSERT INTO "+hV+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aW=fx(aI.metadata),aV=aM?[aW,aU,aP,aR]:[aR,aU,aU,aW];aT.executeSql(aX,aV,function(){am[aN]={ok:!0,id:aI.metadata.id,rev:aP},ac.set(aR,aI.metadata),aQ()})}var aL=null,aC=0;aI.data._id=aI.metadata.id,aI.data._rev=aI.metadata.rev;var aE=Object.keys(aI.data._attachments||{});aK&&(aI.data._deleted=!0),aE.forEach(function(aS){var aU=aI.data._attachments[aS];if(aU.stub){aC++,aJ()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aP,10);var aR=aU.digest;aj(aR,aT,aO)}}),aE.length||aG()}function aA(){hv(ag.revs_limit,aq,av,ac,ap,am,ay,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&ex(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hV+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=jB(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function aj(aD,aF,aC){var aE="SELECT digest FROM "+ce+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+ce+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jk(aF)],function(){aC()},function(){return aC(),!1}))})}var t=aB.new_edits,aw=ak.docs,aq=aw.map(function(aC){if(aC._id&&ex(aC._id)){return aC}var aD=gE(aC,t);return aD}),af=aq.filter(function(aC){return aC.error});if(af.length){return ab(af[0])}var ap,ah,am=new Array(aq.length),ac=new hS.Map;bn(aq,"binary",function(aC){return aC?ab(aC):void au.transaction(function(aD){ap=aD,ad(function(aE){aE?ah=aE:az(aA)})},J(ab),ax)})}function gQ(t){return t.websql(t.name,t.version,t.description,t.size)}function gS(t){try{return{db:gQ(t)}}catch(aa){return{error:aa}}}function o(t){var aa=a6.get(t.name);return aa||(aa=gS(t),a6.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function jc(ad,ab,ag,aj,ah){function af(){++t===aa.length&&ah&&ah()}function ac(am,ak){var al=am._attachments[ak],ap={binary:ab.binary,ctx:aj};ag._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=iZ.extend(fZ(al,["digest","content_type"]),{data:aq}),af()})}var aa=Object.keys(ad._attachments||{});if(!aa.length){return ah&&ah()}var t=0;aa.forEach(function(ak){ab.attachments&&ab.include_docs?ac(ad,ak):(ad._attachments[ak].stub=!0,af())})}function ct(ad,aw){function aj(){gf()&&(window.localStorage["_pouch__websqldb_"+ab._name]=!0),aw(null,ab)}function av(aD,aE){aD.executeSql(hm),aD.executeSql("ALTER TABLE "+i0+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(B),aD.executeSql("ALTER TABLE "+hV+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hV+" (local, id)");var aF="SELECT "+hV+".winningseq AS seq, "+hV+".json AS metadata FROM "+i0+" JOIN "+hV+" ON "+i0+".seq = "+hV+".winningseq";aD.executeSql(aF,[],function(aN,aJ){for(var aG=[],aL=[],aK=0;aK<aJ.rows.length;aK++){var aI=aJ.rows.item(aK),aH=aI.seq,aM=JSON.parse(aI.metadata);fS(aM)&&aG.push(aH),ex(aM.id)&&aL.push(aM.id)}aN.executeSql("UPDATE "+hV+"SET local = 1 WHERE id IN "+ft(aL.length),aL,function(){aN.executeSql("UPDATE "+i0+" SET deleted = 1 WHERE seq IN "+ft(aG.length),aG,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+gH+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hV+".id AS id, "+i0+".json AS data FROM "+i0+" JOIN "+hV+" ON "+i0+".seq = "+hV+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+gH+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hV+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+i0+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function aB(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aJ=aH.shift(),aL=hW(aJ.hex,al),aO=aL.lastIndexOf("::"),aK=aL.substring(0,aO),aM=aL.substring(aO+2),aN="UPDATE "+i0+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aN,[aK,aM,aL],function(){aI()})}aI()}var aF="ALTER TABLE "+i0+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+i0+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(hJ,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+i0;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function am(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+ce;aI.executeSql(aH,[],function(aK,aO){function aL(){var aP=T(p+", "+hV+".id AS id",[hV,i0],jx,null,hV+".id ");aP+=" LIMIT "+aN+" OFFSET "+aM,aM+=aN,aK.executeSql(aP,[],function(ba,aZ){function aV(bc,bd){var bf=aX[bc]=aX[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aZ.rows.length){return aG(ba)}for(var aX={},aT=0;aT<aZ.rows.length;aT++){for(var aQ=aZ.rows.item(aT),aS=js(aQ.data,aQ.id,aQ.rev),aW=Object.keys(aS._attachments||{}),aU=0;aU<aW.length;aU++){var aY=aS._attachments[aW[aU]];aV(aY.digest,aQ.seq)}}var bb=[];if(Object.keys(aX).forEach(function(bc){var bd=aX[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aL()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+ie+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aL()})})})}var aJ=aO.rows.item(0).cnt;if(!aJ){return aG(aK)}var aM=0,aN=10;aL()})}var aF="CREATE TABLE IF NOT EXISTS "+ie+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(ff,[],function(aI){aI.executeSql(jr,[],aD)})})}function ah(aE,aF){var aD="ALTER TABLE "+ce+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ak(aE,aF){var aD="ALTER TABLE "+hV+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hV+" SET max_seq=(SELECT MAX(seq) FROM "+i0+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hV+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ac(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;al=2===aG.length?"UTF-8":"UTF-16",aE()})}function aa(){for(;af.length>0;){var aD=af.pop();aD(null,ay)}}function ag(aO,aG){if(0===aG){var aJ="CREATE TABLE IF NOT EXISTS "+i9+" (dbid, db_version INTEGER)",aM="CREATE TABLE IF NOT EXISTS "+ce+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aD="CREATE TABLE IF NOT EXISTS "+ie+" (digest, seq INTEGER)",aF="CREATE TABLE IF NOT EXISTS "+hV+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aE="CREATE TABLE IF NOT EXISTS "+i0+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aK="CREATE TABLE IF NOT EXISTS "+gH+" (id UNIQUE, rev, json)";aO.executeSql(aM),aO.executeSql(aK),aO.executeSql(aD,[],function(){aO.executeSql(jr),aO.executeSql(ff)}),aO.executeSql(aF,[],function(){aO.executeSql(hm),aO.executeSql(aE,[],function(){aO.executeSql(B),aO.executeSql(hJ),aO.executeSql(aJ,[],function(){var aP="INSERT INTO "+i9+" (db_version, dbid) VALUES (?,?)";ay=fu();var aQ=[dr,ay];aO.executeSql(aP,aQ,function(){aa()})})})})}else{var aI=function(){var aQ=dr>aG;aQ&&aO.executeSql("UPDATE "+i9+" SET db_version = "+dr);var aP="SELECT dbid FROM "+i9;aO.executeSql(aP,[],function(aR,aS){ay=aS.rows.item(0).dbid,aa()})},aL=[av,aq,aB,am,ah,ak,aI],aN=aG,aH=function(aP){aL[aN-1](aP,aH),aN++};aH(aO)}}function aC(){ax.transaction(function(aD){ac(aD,function(){ap(aD)})},J(aw),aj)}function ap(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+i9;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+i9,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;ag(aI,aH)}):aF.executeSql("ALTER TABLE "+i9+" ADD COLUMN db_version INTEGER",[],function(){ag(aF,1)}):ag(aF,0)})}function az(aE,aF){if(-1!==ab._docCount){return aF(ab._docCount)}var aD=T("COUNT("+hV+".id) AS 'num'",[hV,i0],jx,i0+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ab._docCount=aH.rows.item(0).num,aF(ab._docCount)})}var al,ab=this,ay=null,au=it(ad),af=[];ab._docCount=-1,ab._name=ad.name;var t=iZ.extend({},ad,{version:h9,description:ad.name,size:au}),aA=o(t);if(aA.error){return J(aw)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),aC(),ab.type=function(){return"websql"},ab._id=co(function(aD){aD(null,ay)}),ab._info=function(aD){ax.readTransaction(function(aE){az(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+i0;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:ax._sqlitePlugin,websql_encoding:al})})})},J(aD))},ab._bulkDocs=function(aF,aD,aE){hT(ad,aF,aD,ab,ax,a2,aE)},ab._get=function(aF,aE,aH){function aK(){aH(aM,{doc:aJ,metadata:aG,ctx:aI})}var aJ,aG,aM,aI=aE.ctx;if(!aI){return ax.readTransaction(function(aN){ab._get(aF,iZ.extend({ctx:aN},aE),aH)})}var aL,aD;aE.rev?(aL=T(p,[hV,i0],hV+".id="+i0+".doc_id",[i0+".doc_id=?",i0+".rev=?"]),aD=[aF,aE.rev]):(aL=T(p,[hV,i0],jx,hV+".id=?"),aD=[aF]),aI.executeSql(aL,aD,function(aP,aO){if(!aO.rows.length){return aM=ih(fn,"missing"),aK()}var aN=aO.rows.item(0);return aG=jB(aN.metadata),aN.deleted&&!aE.rev?(aM=ih(fn,"deleted"),aK()):(aJ=js(aN.data,aG.id,aN.rev),void aK())})},ab._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(hV+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(hV+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(hV+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(hV+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(i0+".deleted = 0"),ax.readTransaction(function(aR){az(aR,function(aS){if(aF=aS,0!==aH){var aT=T(p,[hV,i0],jx,aL,hV+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(ba,aX){for(var aY=0,aU=aX.rows.length;aU>aY;aY++){var bb=aX.rows.item(aY),aZ=jB(bb.metadata),aV=aZ.id,bc=js(bb.data,aV,bb.rev),aW=bc._rev,bd={id:aV,key:aV,value:{rev:aW}};if(aQ.include_docs&&(bd.doc=bc,bd.doc._rev=aW,aQ.conflicts&&(bd.doc._conflicts=gk(aZ)),jc(bd.doc,aQ,ab,ba)),bb.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},J(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ab._changes=function(aG){function aF(){var aN=hV+".json AS metadata, "+hV+".max_seq AS maxSeq, "+i0+".json AS winningDoc, "+i0+".rev AS winningRev ",aM=hV+" JOIN "+i0,aO=hV+".id="+i0+".doc_id AND "+hV+".winningseq="+i0+".seq",aP=["maxSeq > ?"],aR=[aG.since];aG.doc_ids&&(aP.push(hV+".id IN "+ft(aG.doc_ids.length)),aR=aR.concat(aG.doc_ids));var aL="maxSeq "+(aJ?"DESC":"ASC"),aS=T(aN,aM,aO,aP,aL),aT=jt(aG);aG.view||aG.filter||(aS+=" LIMIT "+aE);var aQ=aG.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(aY,aX){function ba(bg){return function(){aG.onChange(bg)}}for(var bd=0,aV=aX.rows.length;aV>bd;bd++){var aW=aX.rows.item(bd),aZ=jB(aW.metadata);aQ=aW.maxSeq;var bf=js(aW.winningDoc,aZ.id,aW.winningRev),bb=aG.processChange(bf,aZ,aG);bb.seq=aW.maxSeq;var bc=aT(bb);if("object"==typeof bc){return aG.complete(bc)}if(bc&&(aK++,aH&&aI.push(bb),aG.attachments&&aG.include_docs?jc(bf,aG,ab,aY,ba(bb)):ba(bb)()),aK===aE){break}}})},J(aG.complete),function(){aG.continuous||aG.complete(null,{results:aI,last_seq:aQ})})}if(aG=h2(aG),aG.continuous){var aD=ab._name+":"+fu();return a2.addListener(ab._name,aD,ab,aG),a2.notify(ab._name),{cancel:function(){a2.removeListener(ab._name,aD)}}}var aJ=aG.descending;aG.since=aG.since&&!aJ?aG.since:0;var aE="limit" in aG?aG.limit:-1;0===aE&&(aE=1);var aH;aH="return_docs" in aG?aG.return_docs:"returnDocs" in aG?aG.returnDocs:!0;var aI=[],aK=0;aF()},ab._close=function(aD){aD()},ab._getAttachment=function(aF,aE,aH,aK,aJ){var aG,aM=aK.ctx,aI=aH.digest,aL=aH.content_type,aD="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+ce+" WHERE digest=?";aM.executeSql(aD,[aI],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?gj(aO.body):hW(aO.body,al);aG=aK.binary?hH(aN,aL):h3(aN),aJ(null,aG)})},ab._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hV+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=jB(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(ih(fn))}})})},ab._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hV+" WHERE id = ?";aH.executeSql(aG,[aE],function(aI,aK){var aJ=jB(aK.rows.item(0).metadata);cn(aJ.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aL="UPDATE "+hV+" SET json = ? WHERE id = ?";aI.executeSql(aL,[fx(aJ),aE])}),jh(aF,aE,aH)},J(aD),function(){aD()}):aD()},ab._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+gH+" WHERE id=?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=aJ.rows.item(0),aK=js(aI.json,aD,aI.rev);aE(null,aK)}else{aE(ih(fn))}})})},ab._putLocal=function(aG,aL,aI){function aK(aO){var aM,aN;aH?(aM="UPDATE "+gH+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aJ,aD,aE,aH]):(aM="INSERT INTO "+gH+" (id, rev, json) VALUES (?,?,?)",aN=[aE,aJ,aD]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aF={ok:!0,id:aE,rev:aJ},aL.ctx&&aI(null,aF)):aI(ih(hK))},function(){return aI(ih(hK)),!1})}"function"==typeof aL&&(aI=aL,aL={}),delete aG._revisions;var aJ,aH=aG._rev,aE=aG._id;aJ=aH?aG._rev="0-"+(parseInt(aH.split("-")[1],10)+1):aG._rev="0-1";var aF,aD=jf(aG);aL.ctx?aK(aL.ctx):ax.transaction(aK,J(aI),function(){aF&&aI(null,aF)})},ab._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+gH+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(ih(fn))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,J(aH),function(){aD&&aH(null,aD)})},ab._destroy=function(aD,aE){a2.removeAllListeners(ab._name),ax.transaction(function(aF){var aG=[hV,i0,ce,i9,gH,ie];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},J(aE),function(){gf()&&(delete window.localStorage["_pouch__websqldb_"+ab._name],delete window.localStorage[ab._name]),aE(null,{ok:!0})})}}function iN(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function hd(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var aa=gf(),ab="_pouch__websqldb_valid_"+navigator.userAgent;if(aa&&localStorage[ab]){return"1"===localStorage[ab]}var t=iN();return aa&&(localStorage[ab]=t?"1":"0"),t}function hr(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:hd()}function gs(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=iZ.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function i1(aa,ac){var t=gs(aa),ab=iZ.extend({websql:t},aa);ct.call(this,ab,ac)}function j(t){t.adapter("websql",i1,!0)}function hU(){for(var aa={},ac=new jm(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,jm.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function v(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?hL(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=hU(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function h1(ad,ab){var ag,aj,ah=!1,af=function(){ag.abort()},ac=function(){ah=!0,ag.abort()};ag=ad.xhr?new ad.xhr:new XMLHttpRequest;try{ag.open(ad.method,ad.url)}catch(aa){ab(aa,{statusCode:413})}ag.withCredentials="withCredentials" in ad?ad.withCredentials:!0,"GET"===ad.method?delete ad.headers["Content-Type"]:ad.json&&(ad.headers.Accept="application/json",ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json",ad.body&&ad.processData&&"string"!=typeof ad.body&&(ad.body=JSON.stringify(ad.body))),ad.binary&&(ag.responseType="arraybuffer"),"body" in ad||(ad.body=null);for(var t in ad.headers){ad.headers.hasOwnProperty(t)&&ag.setRequestHeader(t,ad.headers[t])}return ad.timeout>0&&(aj=setTimeout(ac,ad.timeout),ag.onprogress=function(){clearTimeout(aj),4!==ag.readyState&&(aj=setTimeout(ac,ad.timeout))},"undefined"!=typeof ag.upload&&(ag.upload.onprogress=ag.onprogress)),ag.onreadystatechange=function(){if(4===ag.readyState){var ak={statusCode:ag.status};if(ag.status>=200&&ag.status<300){var am;am=ad.binary?hA([ag.response||""],{type:ag.getResponseHeader("Content-Type")}):ag.responseText,ab(null,ak,am)}else{var ap={};if(ah){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ag.response)}catch(al){}}ab(ap,ak)}}},ad.body&&ad.body instanceof Blob?hL(ad.body,function(ak){ag.send(ak)}):ag.send(ad.body),{abort:af}}function hR(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function P(t,aa){return hp||t.xhr?h1(t,aa):v(t,aa)}function iW(){return""}function fT(ac,t){function aa(ag,ah,af){if(!ac.binary&&ac.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?fv(ak):ak})),ac.binary&&hu(ag,ah),af(null,ag,ah)}function ad(ak,af){var ah,al;if(ak.code&&ak.status){var aj=new Error(ak.message||ak.code);return aj.status=ak.status,af(aj)}if(ak.message&&"ETIMEDOUT"===ak.message){return af(ak)}try{ah=JSON.parse(ak.responseText),al=fv(ah)}catch(ag){al=fv(ak)}af(al)}ac=h2(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=iZ.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),P(ac,function(af,aj,al){if(af){return af.status=aj?aj.statusCode:400,ad(af,t)}var ah,ak=aj.headers&&aj.headers["content-type"],am=al||iW();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof am&&(/json/.test(ak)||/^[\s]*\{/.test(am)&&/\}[\s]*$/.test(am))){try{am=JSON.parse(am.toString())}catch(ag){}}aj.statusCode>=200&&aj.statusCode<300?aa(am,aj,t):(ah=fv(am),ah.status=aj.statusCode,t(ah))})}function fw(ac,ak){var af=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ah=-1!==af.indexOf("safari")&&-1===af.indexOf("chrome"),ag=-1!==af.indexOf("msie"),ad=-1!==af.indexOf("edge"),aa=ah||(ag||ad)&&"GET"===ac.method,aj="cache" in ac?ac.cache:!0,t=/^blob:/.test(ac.url);if(!t&&(aa||!aj)){var ab=-1!==ac.url.indexOf("?");ac.url+=(ab?"&":"?")+"_nonce="+Date.now()}return fT(ac,ak)}function ey(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=fh(ab.data,ab.content_type)})}function jo(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function hZ(t){return t._attachments&&Object.keys(t._attachments)?jm.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new jm(function(ac){jn(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):jm.resolve()}function gV(aa){var ab=dt(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function ha(t,aa){return V(t,t.db+"/"+aa)}function V(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function gF(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function im(aj,ac){function ab(ax,aA,az){var ay=ax.ajax||{},aw=iZ.extend(h2(ag),ay,aA);return hP(aw.method+" "+aw.url),ap._ajax(aw,az)}function ah(aw,ax){return new jm(function(az,ay){ab(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function al(aw,ax){return iz(aw,he(function(ay){aq().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aq(){if(aj.skipSetup||aj.skip_setup){return jm.resolve()}if(ak){return ak}var aw={method:"GET",url:au};return ak=ah({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(fp(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:au})):jm.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:jm.reject(ax)}),ak["catch"](function(){ak=null}),ak}function aa(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ap=this,av=gV;aj.getHost&&(av=aj.getHost);var af=av(aj.name,aj),au=ha(af,"");aj=h2(aj);var ag=aj.ajax||{};if(ap.getUrl=function(){return au},ap.getHeaders=function(){return ag.headers||{}},aj.auth||af.auth){var t=aj.auth||af.auth,ad=t.username+":"+t.password,am=h3(unescape(encodeURIComponent(ad)));ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+am}ap._ajax=fw;var ak;setTimeout(function(){ac(null,ap)}),ap.type=function(){return"http"},ap.id=al("id",function(aw){ab({},{method:"GET",url:V(af,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+af.db:ha(af,"");aw(null,ay)})}),ap.request=al("request",function(aw,ax){aw.url=ha(af,aw.url),ab({},aw,ax)}),ap.compact=al("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=h2(aw),ab(aw,{url:ha(af,"_compact"),method:"POST"},function(){function ay(){ap.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ap.bulkGet=iz("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ab({},{url:ha(af,"_bulk_get"+gF(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aH(aK){return function(aM,aL){aE[aK]=aL.results,++aG===aJ&&aA(null,{results:a7(aE)})}}for(var aD=jj,aJ=Math.ceil(aC.docs.length/aD),aG=0,aE=new Array(aJ),aF=0;aJ>aF;aF++){var aI=fZ(aC,["revs","attachments"]);aI.ajax=ag,aI.docs=aC.docs.slice(aF*aD,Math.min(aC.docs.length,(aF+1)*aD)),a9(ay,aI,aH(aF))}}var ay=this,aw=V(af,""),az=il[aw];"boolean"!=typeof az?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(il[aw]=!1,fp(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{il[aw]=!0,aA(null,aE)}}):az?ax(aA):aB()}),ap._info=function(aw){aq().then(function(){ab({},{method:"GET",url:ha(af,"")},function(ay,ax){return ay?aw(ay):(ax.host=ha(af,""),void aw(null,ax))})})["catch"](aw)},ap.get=al("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?jm.all(aF.map(function(aG){var aI=aD[aG],aH=jo(aE._id)+"/"+aa(aG)+"?rev="+aE._rev;return ah(aC,{method:"GET",url:ha(af,aH),binary:!0}).then(function(aJ){return aC.binary?aJ:new jm(function(aK){jn(aJ,aK)})}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?jm.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=h2(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=jo(aA);var aw={method:"GET",url:ha(af,aA+gF(az))};ah(aC,aw).then(function(aD){return jm.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ap.remove=al("remove",function(ax,aB,az,aw){var ay;"string"==typeof aB?(ay={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(ay=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var aA=ay._rev||az.rev;ab(az,{method:"DELETE",url:ha(af,jo(ay._id))+"?rev="+aA},aw)}),ap.getAttachment=al("getAttachment",function(ax,az,aB,ay){"function"==typeof aB&&(ay=aB,aB={});var aA=aB.rev?"?rev="+aB.rev:"",aw=ha(af,jo(ax))+"/"+aa(az)+aA;ab(aB,{method:"GET",url:aw,binary:!0},ay)}),ap.removeAttachment=al("removeAttachment",function(ax,aA,ay,az){var aw=ha(af,jo(ax)+"/"+aa(aA))+"?rev="+ay;ab({},{method:"DELETE",url:aw},az)}),ap.putAttachment=al("putAttachment",function(aE,aA,ay,ax,aG,az){"function"==typeof aG&&(az=aG,aG=ax,ax=ay,ay=null);var aB=jo(aE)+"/"+aa(aA),aC=ha(af,aB);if(ay&&(aC+="?rev="+ay),"string"==typeof ax){var aw;try{aw=ht(ax)}catch(aD){return az(ih(gB,"Attachment is not a valid base64 string"))}ax=aw?hH(aw,aG):""}var aF={headers:{"Content-Type":aG},method:"PUT",url:aC,processData:!1,body:ax,timeout:ag.timeout||60000};ab({},aF,az)}),ap._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,aq().then(function(){return jm.all(aw.docs.map(hZ))}).then(function(){ab(ay,{method:"POST",url:ha(af,"_bulk_docs"),body:aw},function(aA,az){return aA?ax(aA):(az.forEach(function(aB){aB.ok=!0}),void ax(null,az))})})["catch"](ax)},ap.allDocs=al("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=h2(aA);var ax,aB={},ay="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var aw=gF(aB);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=en?aw+="&"+az:(ay="POST",ax={keys:aA.keys})}ah(aA,{method:ay,url:ha(af,"_all_docs"+aw),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ey),aC(null,aD)})["catch"](aC)}),ap._changes=function(aH){var az="batch_size" in aH?aH.batch_size:h6;aH=h2(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ag?ag.timeout:30000;var aB,aw=aH.timeout?{timeout:aH.timeout-5000}:{},aF="undefined"!=typeof aH.limit?aH.limit:!1;aB="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var ay=aF;if(aH.style&&(aw.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aw.include_docs=!0),aH.attachments&&(aw.attachments=!0),aH.continuous&&(aw.feed="longpoll"),aH.conflicts&&(aw.conflicts=!0),aH.descending&&(aw.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aw.heartbeat=aH.heartbeat):aw.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aw.filter=aH.filter),aH.view&&"string"==typeof aH.view&&(aw.filter="_view",aw.view=aH.view),aH.query_params&&"object"==typeof aH.query_params){for(var aJ in aH.query_params){aH.query_params.hasOwnProperty(aJ)&&(aw[aJ]=aH.query_params[aJ])}}var aD,aA="GET";if(aH.doc_ids){aw.filter="_doc_ids";var aC=JSON.stringify(aH.doc_ids);aC.length<en?aw.doc_ids=aC:(aA="POST",aD={doc_ids:aH.doc_ids})}var aE,aG,aI=function(aM,aN){if(!aH.aborted){aw.since=aM,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aH.descending?aF&&(aw.limit=ay):aw.limit=!aF||ay>az?az:ay;var aL={method:aA,url:ha(af,"_changes"+gF(aw)),timeout:aH.timeout,body:aD};aG=aM,aH.aborted||aq().then(function(){aE=ab(aH,aL,aN)})["catch"](aN)}},aK={results:[]},ax=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aK.last_seq=aL.last_seq;var aP={};aP.query=aH.query_params,aL.results=aL.results.filter(function(aR){ay--;var aQ=jt(aH)(aR);return aQ&&(aH.include_docs&&aH.attachments&&aH.binary&&ey(aR),aB&&aK.results.push(aR),aH.onChange(aR)),aQ})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(aG=aL.last_seq);var aO=aF&&0>=ay||aL&&az>aM||aH.descending;(!aH.continuous||aF&&0>=ay)&&aO?aH.complete(null,aK):setTimeout(function(){aI(aG,ax)},0)}};return aI(aH.since||0,ax),{cancel:function(){aH.aborted=!0,aE&&aE.abort()}}},ap.revsDiff=al("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),ab(ay,{method:"POST",url:ha(af,"_revs_diff"),body:aw},ax)}),ap._close=function(aw){aw()},ap._destroy=function(aw,ax){ab(aw,{url:ha(af,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function gG(t){t.adapter("http",im,!1),t.adapter("https",im,!1)}function a0(){this.promise=new jm(function(t){t()})}function fg(t){var ac=t.db,ag=t.viewName,aa=t.map,ah=t.reduce,ad=t.temporary,af=aa.toString()+(ah&&ah.toString())+"undefined";if(!ad&&ac._cachedViews){var ab=ac._cachedViews[af];if(ab){return jm.resolve(ab)}}return ac.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ag;-1===aq.indexOf("/")&&(aq=ag+"/"+ag);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ad?"temp":I(af));return fa(ac,"_local/mrviews",al).then(function(){return ac.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ac,adapter:ac.adapter,mapFun:aa,reduceFun:ah};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ad||(ac._cachedViews=ac._cachedViews||{},ac._cachedViews[af]=aq,aq.db.once("destroyed",function(){delete ac._cachedViews[af]})),aq})})})})}function a1(ac,t,aa,ad,ab,af){return i5("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function fr(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function ip(t){return 1===t.length&&/^1-/.test(t[0].rev)}function ez(aa,ab){try{aa.emit("error",ab)}catch(t){iO("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iO("error",ab)}}function l(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return ez(aa,ab),{error:ab}}}function g7(aa,ab){var t=gi.collate(aa.key,ab.key);return 0!==t?t:gi.collate(aa.value,ab.value)}function fb(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function iQ(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function W(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=fh(ac.data,ac.content_type)})})}function gb(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&W(aa),aa}}function gY(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new fj(aa)}function ae(t){for(var ac=0,ag=0,aa=t.length;aa>ag;ag++){var ah=t[ag];if("number"!=typeof ah){if(!Array.isArray(ah)){throw gY("_sum")}ac="number"==typeof ac?[ac]:ac;for(var ad=0,af=ah.length;af>ad;ad++){var ab=ah[ad];if("number"!=typeof ab){throw gY("_sum")}"undefined"==typeof ac[ad]?ac.push(ab):ac[ad]+=ab}}else{"number"==typeof ac?ac+=ah:ac[0]+=ah}}return ac}function g8(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function h(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function i(t){return t.group_level=h(t.group_level),t.limit=h(t.limit),t.skip=h(t.skip),t}function fY(t){if(t){if("number"!=typeof t){return new A('Invalid value for integer: "'+t+'"')}if(0>t){return new A('Invalid value for positive integer: "'+t+'"')}}}function F(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&gi.collate(aa[t],aa[ab])>0){throw new A("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new A("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new A("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=fY(aa[af]);if(ad){throw ad}})}function fe(ad,ab,ag){var aj,ah=[],af="GET";if(g8("reduce",ag,ah),g8("include_docs",ag,ah),g8("attachments",ag,ah),g8("limit",ag,ah),g8("descending",ag,ah),g8("group",ag,ah),g8("group_level",ag,ah),g8("skip",ag,ah),g8("stale",ag,ah),g8("conflicts",ag,ah),g8("startkey",ag,ah,!0),g8("start_key",ag,ah,!0),g8("endkey",ag,ah,!0),g8("end_key",ag,ah,!0),g8("inclusive_end",ag,ah),g8("key",ag,ah,!0),ah=ah.join("&"),ah=""===ah?"":"?"+ah,"undefined"!=typeof ag.keys){var ac=2000,aa="keys="+encodeURIComponent(JSON.stringify(ag.keys));aa.length+ah.length+1<=ac?ah+=("?"===ah[0]?"&":"?")+aa:(af="POST","string"==typeof ab?aj={keys:ag.keys}:ab.keys=ag.keys)}if("string"==typeof ab){var t=fr(ab);return ad.request({method:af,url:"_design/"+t[0]+"/_view/"+t[1]+ah,body:aj}).then(gb(ag))}return aj=aj||{},Object.keys(ab).forEach(function(ak){Array.isArray(ab[ak])?aj[ak]=ab[ak]:aj[ak]=ab[ak].toString()}),ad.request({method:"POST",url:"_temp_view"+ah,body:aj}).then(gb(ag))}function i7(aa,ab,t){return new jm(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function M(t){return new jm(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function gJ(t){return function(aa){if(404===aa.status){return t}throw aa}}function k(ah,ac,aj){function al(){return ip(t)?jm.resolve(ad):ac.db.get(ag)["catch"](gJ(ad))}function aa(am){return am.keys.length?ac.db.allDocs({keys:am.keys,include_docs:!0}):jm.resolve({rows:[]})}function ak(aw,av){for(var aA=[],aq={},am=0,ay=av.rows.length;ay>am;am++){var ax=av.rows[am],ap=ax.doc;if(ap&&(aA.push(ap),aq[ap._id]=!0,ap._deleted=!ab[ap._id],!ap._deleted)){var au=ab[ap._id];"value" in au&&(ap.value=au.value)}}var az=Object.keys(ab);return az.forEach(function(aD){if(!aq[aD]){var aB={_id:aD},aC=ab[aD];"value" in aC&&(aB.value=aC.value),aA.push(aB)}}),aw.keys=fl(az.concat(aw.keys)),aA.push(aw),aA}var ag="_local/doc_"+ah,ad={_id:ag,keys:[]},af=aj[ah],ab=af.indexableKeysToKeyValues,t=af.changes;return al().then(function(am){return aa(am).then(function(ap){return ak(am,ap)})})}function ho(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](gJ({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return jm.all(ad.map(function(ag){return k(ag,aa,ac)})).then(function(ag){var ah=a7(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function s(aa){var ab="string"==typeof aa?aa:aa.name,t=ic[ab];return t||(t=ic[ab]=new a0),t}function cr(t){return jb(s(t),function(){return ao(t)})()}function ao(ad){function ab(am,ak){var al={id:ah._id,key:gi.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gi.normalizeKey(ak)),aj.push(al)}function ag(ak,al){return function(){return ho(ad,ak,al)}}var aj,ah,af;if("function"==typeof ad.mapFun&&2===ad.mapFun.length){var ac=ad.mapFun;af=function(ak){return ac(ak,ab)}}else{af=a1(ad.mapFun.toString(),ab,ae,iG,Array.isArray,JSON.parse)}var aa=ad.seq||0,t=new a0;return new jm(function(ap,ak){function al(){t.finish().then(function(){ad.seq=aa,ap()})}function am(){function aq(au){ak(au)}ad.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:aa,limit:iY}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var aC={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){aj=[],ah=ax.doc,ah._deleted||l(ad.sourceDB,af,[ah]),aj.sort(g7);for(var au,ay={},az=0,aG=aj.length;aG>az;az++){var aE=aj[az],aB=[aE.key,aE.id];0===gi.collate(aE.key,au)&&aB.push(az);var aw=gi.toIndexableString(aB);ay[aw]=aE,au=aE.key}aC[ax.doc._id]={indexableKeysToKeyValues:ay,changes:ax.changes}}aa=ax.seq}return t.add(ag(aC,aa)),aA.length<iY?al():am()}).on("error",aq)}am()})}function n(ah,ac,aj){0===aj.group_level&&delete aj.group_level;var al,aa=aj.group||aj.group_level;al=iK[ah.reduceFun]?iK[ah.reduceFun]:a1(ah.reduceFun.toString(),null,ae,iG,Array.isArray,JSON.parse);var ak=[],ag=isNaN(aj.group_level)?Number.POSITIVE_INFINITY:aj.group_level;ac.forEach(function(aq){var am=ak[ak.length-1],ap=aa?aq.key:null;return aa&&Array.isArray(ap)&&(ap=ap.slice(0,ag)),am&&0===gi.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ak.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ac=[];for(var ad=0,af=ak.length;af>ad;ad++){var ab=ak[ad],t=l(ah.sourceDB,al,[ab.keys,ab.values,!1]);if(t.error&&t.error instanceof fj){throw t.error}ac.push({value:t.error?null:t.output,key:ab.groupKey})}return{rows:fb(ac,aj.limit,aj.skip)}}function br(t,aa){return jb(s(t),function(){return N(t,aa)})()}function N(t,aj){function af(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ag=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=gi.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ah(av){var aq;if(aq=ac?n(t,av,aj):{total_rows:ag,offset:al,rows:av},aj.include_docs){var au=fl(av.map(iQ));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:aj.conflicts,attachments:aj.attachments,binary:aj.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=iQ(ay),az=ax["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ag,ac=t.reduceFun&&aj.reduce!==!1,al=aj.skip||0;if("undefined"==typeof aj.keys||aj.keys.length||(aj.limit=0,delete aj.keys),"undefined"!=typeof aj.keys){var ab=aj.keys,ak=ab.map(function(aq){var au={startkey:gi.toIndexableString([aq]),endkey:gi.toIndexableString([aq,{}])};return af(au)});return jm.all(ak).then(a7).then(ah)}var am={descending:aj.descending};if(aj.start_key&&(aj.startkey=aj.start_key),aj.end_key&&(aj.endkey=aj.end_key),"undefined"!=typeof aj.startkey&&(am.startkey=aj.descending?gi.toIndexableString([aj.startkey,{}]):gi.toIndexableString([aj.startkey])),"undefined"!=typeof aj.endkey){var aa=aj.inclusive_end!==!1;aj.descending&&(aa=!aa),am.endkey=gi.toIndexableString(aa?[aj.endkey,{}]:[aj.endkey])}if("undefined"!=typeof aj.key){var ad=gi.toIndexableString([aj.key]),ap=gi.toIndexableString([aj.key,{}]);am.descending?(am.endkey=ad,am.startkey=ap):(am.startkey=ad,am.endkey=ap)}return ac||("number"==typeof aj.limit&&(am.limit=aj.limit),am.skip=al),af(am).then(ah)}function iE(t){return t.request({method:"POST",url:"_view_cleanup"})}function X(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=fr(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return jb(s(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return jm.all(ag).then(function(){return{ok:!0}})})},gJ({ok:!0}))}function at(ah,ab,t){if("http"===ah.type()){return fe(ah,ab,t)}if("function"==typeof ah._query){return i7(ah,ab,t)}if("string"!=typeof ab){F(t,ab);var ag={db:ah,viewName:"temp_view/temp_view",map:ab.map,reduce:ab.reduce,temporary:!0};return gZ.add(function(){return fg(ag).then(function(ak){function aj(){return ak.db.destroy()}return C(cr(ak).then(function(){return br(ak,t)}),aj)})}),gZ.finish()}var ac=ab,af=fr(ac),aa=af[0],ad=af[1];return ah.get("_design/"+aa).then(function(al){var ak=al.views&&al.views[ad];if(!ak||"string"!=typeof ak.map){throw new G("ddoc "+aa+" has no view named "+ad)}F(t,ak);var aj={db:ah,viewName:ac,map:ak.map,reduce:ak.reduce};return fg(aj).then(function(am){return"ok"===t.stale||"update_after"===t.stale?("update_after"===t.stale&&a3.nextTick(function(){cr(am)}),br(am,t)):cr(am).then(function(){return br(am,t)})})})}function A(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,A)}catch(aa){}}function G(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,G)}catch(aa){}}function fj(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fj)}catch(aa){}}function x(t){return/^1-/.test(t)}function gg(aa,ab,t){return !aa._attachments||!aa._attachments[t]||aa._attachments[t].digest!==ab._attachments[t].digest}function gD(aa,ab){var t=Object.keys(ab._attachments);return jm.all(t.map(function(ac){return aa.getAttachment(ab._id,ac,{rev:ab._rev})}))}function fs(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return jm.all(ab.map(function(ag){return gg(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return gD(t,aa)}):gD(t,aa)}function jC(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function Q(aj,ad,ak,aa){function al(){var am=jC(ak);if(am.docs.length){return aj.bulkGet(am).then(function(ap){if(aa.cancelled){throw new Error("cancelled")}return jm.all(ap.results.map(function(aq){return jm.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?fs(ad,aj,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ab=ab.concat(a7(aq).filter(Boolean))})})}}function ah(am){return am._attachments&&Object.keys(am._attachments).length>0}function ag(am){return aj.allDocs({keys:am,include_docs:!0}).then(function(ap){if(aa.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&x(aq.value.rev)&&!ah(aq.doc)&&(ab.push(aq.doc),delete ak[aq.id])})})}function ac(){var am=Object.keys(ak).filter(function(aq){var ap=ak[aq].missing;return 1===ap.length&&x(ap[0])});return am.length>0?ag(am):void 0}function af(){return{ok:t,docs:ab}}ak=h2(ak);var ab=[],t=!0;return jm.resolve().then(ac).then(al).then(af)}function h4(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&fp(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:jp}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,hC),af.version=jp,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return h4(ac,t,aa,ad,ab)}throw ag}))})}function gR(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function h5(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:ai(t.history,aa.history)}function ai(t,ac){var ag=t[0],aa=t.slice(1),ah=ac[0],ad=ac.slice(1);if(!ag||0===ac.length){return{last_seq:ia,history:[]}}var af=ag.session_id;if(es(af,ac)){return{last_seq:ag.last_seq,history:t}}var ab=ah.session_id;return es(ab,aa)?{last_seq:ah.last_seq,history:ad}:ai(aa,ad)}function es(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:es(aa,ab):!1}function iF(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function gm(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=gl),ac.emit("requestError",t),"active"!==ac.state&&"pending"!==ac.state||(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=hj})),aa.current_back_off=aa.current_back_off||hj,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function a5(t){return Object.keys(t).sort(gi.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function gw(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(gi.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(a5(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),jm.all([ab.id(),ad.id()]).then(function(aj){var ah=aj[0]+aj[1]+aa+af+t+ac;return new jm(function(ak){O(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gP(ac,aL,az,aE,aA){function aq(){return ah?jm.resolve():gw(ac,aL,az).then(function(aS){aN=aS,ah=new gR(ac,aL,aN,aE)})}function aF(){if(aH=[],0!==af.docs.length){var aS=af.docs;return aL.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(aE.cancelled){throw aB(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(aA.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),ad=ad.concat(aV),aA.docs_written+=af.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?aE.emit("denied",h2(aY)):aH.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,ap("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw aA.doc_write_failures+=aS.length,aT})}}function aK(){if(af.error){throw new Error("There was a problem getting docs.")}aA.last_seq=au=af.seq;var aS=h2(aA);return aH.length&&(aS.docs=aH,aE.emit("change",aS)),al=!0,ah.writeCheckpoint(af.seq,ab).then(function(){if(al=!1,aE.cancelled){throw aB(),new Error("cancelled")}af=void 0,ax()})["catch"](aM)}function aR(){var aS={};return af.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aL.revsDiff(aS).then(function(aT){if(aE.cancelled){throw aB(),new Error("cancelled")}af.diffs=aT})}function aj(){return Q(ac,aL,af.diffs,aE).then(function(aS){af.error=!aS.ok,aS.docs.forEach(function(aT){delete af.diffs[aT._id],aA.docs_read++,af.docs.push(aT)})})}function aw(){if(!aE.cancelled&&!af){if(0===av.length){return void aP(!0)}af=av.shift(),aR().then(aj).then(aF).then(aK).then(aw)["catch"](function(aS){ap("batch processing terminated with error",aS)})}}function aP(aS){return 0===aC.changes.length?void (0!==av.length||af||((aI&&ay.live||aG)&&(aE.state="pending",aE.emit("paused")),aG&&aB())):void ((aS||aG||aC.changes.length>=aQ)&&(av.push(aC),aC={seq:0,changes:[],docs:[]},"pending"!==aE.state&&"stopped"!==aE.state||(aE.state="active",aE.emit("active")),aw()))}function ap(aS,aT){ak||(aT.message||(aT.message=aS),aA.ok=!1,aA.status="aborting",aA.errors.push(aT),ad=ad.concat(aT),av=[],aC={seq:0,changes:[],docs:[]},aB())}function aB(){if(!(ak||aE.cancelled&&(aA.status="cancelled",al))){aA.status=aA.status||"complete",aA.end_time=new Date,aA.last_seq=au,ak=!0;var aS=ad.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=ad.pop();ad.length>0&&(aT.other_errors=ad),aT.result=aA,gm(az,aE,aT,function(){gP(ac,aL,az,aE)})}else{aA.errors=ad,aE.emit("complete",aA),aE.removeAllListeners()}}}function aa(aS){if(aE.cancelled){return aB()}var aT=jt(az)(aS);aT&&(aC.seq=aS.seq,aC.changes.push(aS),aP(0===av.length&&ay.live))}function t(aS){if(aJ=!1,aE.cancelled){return aB()}if(aS.results.length>0){ay.since=aS.last_seq,ax(),aP(!0)}else{var aT=function(){aI?(ay.live=!0,ax()):aG=!0,aP(!0)};af||0!==aS.results.length?aT():(al=!0,ah.writeCheckpoint(aS.last_seq,ab).then(function(){al=!1,aA.last_seq=au=aS.last_seq,aT()})["catch"](aM))}}function aD(aS){return aJ=!1,aE.cancelled?aB():void ap("changes rejected",aS)}function ax(){function aT(){aU.cancel()}function aS(){aE.removeListener("cancel",aT)}if(!aJ&&!aG&&av.length<aO){aJ=!0,aE._changes&&(aE.removeListener("cancel",aE._abortChanges),aE._changes.cancel()),aE.once("cancel",aT);var aU=ac.changes(ay).on("change",aa);aU.then(aS,aS),aU.then(t)["catch"](aD),az.retry&&(aE._changes=aU,aE._abortChanges=aT)}}function am(){aq().then(function(){return aE.cancelled?void aB():ah.getCheckpoint().then(function(aS){au=aS,ay={since:au,limit:aQ,batch_size:aQ,style:"all_docs",doc_ids:ag,return_docs:!0},az.filter&&("string"!=typeof az.filter?ay.include_docs=!0:ay.filter=az.filter),"heartbeat" in az&&(ay.heartbeat=az.heartbeat),"timeout" in az&&(ay.timeout=az.timeout),az.query_params&&(ay.query_params=az.query_params),az.view&&(ay.view=az.view),ax()})})["catch"](function(aS){ap("getCheckpoint rejected with ",aS)})}function aM(aS){throw al=!1,ap("writeCheckpoint completed with error",aS),aS}var af,aN,ah,av=[],aC={seq:0,changes:[],docs:[]},al=!1,aG=!1,ak=!1,au=0,aI=az.continuous||az.live||!1,aQ=az.batch_size||100,aO=az.batches_limit||10,aJ=!1,ag=az.doc_ids,ad=[],aH=[],ab=fu();aA=aA||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var ay={};return aE.ready(ac,aL),aE.cancelled?void aB():(aE._addedListeners||(aE.once("cancel",aB),"function"==typeof az.complete&&(aE.once("error",az.complete),aE.once("complete",function(aS){az.complete(null,aS)})),aE._addedListeners=!0),void ("undefined"==typeof az.since?am():aq().then(function(){return al=!0,ah.writeCheckpoint(az.since,ab)}).then(function(){return al=!1,aE.cancelled?void aB():(au=az.since,void am())})["catch"](aM)))}function gN(){hx.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new jm(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function iA(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function gc(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw ih(gW,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=h2(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new gN(ag),t=iA(ab,ag),af=iA(ad,ag);return gP(t,af,ag,aa),aa}function hc(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=h2(t),t.PouchConstructor=t.PouchConstructor||this,aa=iA(aa,t),ac=iA(ac,t),new hI(aa,ac,t,ab)}function hI(am,ad,ac,ak){function af(ay){aq.emit("change",{direction:"pull",change:ay})}function t(ay){aq.emit("change",{direction:"push",change:ay})}function ag(ay){aq.emit("denied",{direction:"push",doc:ay})}function ab(ay){aq.emit("denied",{direction:"pull",doc:ay})}function av(){aq.pushPaused=!0,aq.pullPaused&&aq.emit("paused")}function aj(){aq.pullPaused=!0,aq.pushPaused&&aq.emit("paused")}function ap(){aq.pushPaused=!1,aq.pullPaused&&aq.emit("active",{direction:"push"})}function aa(){aq.pullPaused=!1,aq.pushPaused&&aq.emit("active",{direction:"pull"})}function al(ay){return function(aC,aE){var aD="change"===aC&&(aE===af||aE===t),aA="denied"===aC&&(aE===ab||aE===ag),az="paused"===aC&&(aE===aj||aE===av),aB="active"===aC&&(aE===aa||aE===ap);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aq.removeAllListeners(aC))}}var aq=this;this.canceled=!1;var ah=ac.push?iZ.extend({},ac,ac.push):ac,aw=ac.pull?iZ.extend({},ac,ac.pull):ac;this.push=gc(am,ad,ah),this.pull=gc(ad,am,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ac.live&&(this.push.on("complete",aq.pull.cancel.bind(aq.pull)),this.pull.on("complete",aq.push.cancel.bind(aq.push))),this.on("newListener",function(ay){"change"===ay?(aq.pull.on("change",af),aq.push.on("change",t)):"denied"===ay?(aq.pull.on("denied",ab),aq.push.on("denied",ag)):"active"===ay?(aq.pull.on("active",aa),aq.push.on("active",ap)):"paused"===ay&&(aq.pull.on("paused",aj),aq.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aq.pull.removeListener("change",af),aq.push.removeListener("change",t)):"denied"===ay?(aq.pull.removeListener("denied",ab),aq.push.removeListener("denied",ag)):"active"===ay?(aq.pull.removeListener("active",aa),aq.push.removeListener("active",ap)):"paused"===ay&&(aq.pull.removeListener("paused",aj),aq.push.removeListener("paused",av))}),this.pull.on("removeListener",al("pull")),this.push.on("removeListener",al("push"));var au=jm.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aq.emit("complete",az),ak&&ak(null,az),aq.removeAllListeners(),az},function(ay){if(aq.cancel(),ak?ak(ay):aq.emit("error",ay),aq.removeAllListeners(),ak){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gp(t){t.replicate=gc,t.sync=hc}var u,iZ=b(9),io=fc(b(5)),ij=fc(b(8)),i8=fc(b(10)),hS=b(14),he=fc(b(4)),hx=b(1),i5=fc(b(15)),hw=fc(b(16)),hi=fc(b(17)),gi=b(12),jm="function"==typeof Promise?Promise:i8,ei=Function.prototype.toString,iq=ei.call(Object),fV=io("pouchdb:api"),ju=6;if(gz()){u=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),u=!!localStorage.getItem("_pouch_check_localstorage")}catch(g3){u=!1}}ij(fi,hx.EventEmitter),fi.prototype.addListener=function(ab,ad,ag,ac){function aa(){function aj(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var ah=fZ(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",aj)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},fi.prototype.removeListener=function(t,aa){aa in this._listeners&&hx.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},fi.prototype.notifyLocalWindows=function(t){gz()?chrome.storage.local.set({dbName:t}):gf()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},fi.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},ij(ci,Error),ci.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hO=new ci({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hg=new ci({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),fn=new ci({status:404,error:"not_found",reason:"missing"}),hK=new ci({status:409,error:"conflict",reason:"Document update conflict"}),je=new ci({status:400,error:"invalid_id",reason:"_id field must contain a string"}),ik=new ci({status:412,error:"missing_id",reason:"_id is required for puts"}),fz=new ci({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),g1=new ci({status:412,error:"precondition_failed",reason:"Database not open"}),iB=new ci({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),gB=new ci({status:500,error:"badarg",reason:"Some query argument is invalid"}),gx=new ci({status:400,error:"invalid_request",reason:"Request was invalid"}),hl=new ci({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),et=new ci({status:500,error:"doc_validation",reason:"Bad special document member"}),gW=new ci({status:400,error:"bad_request",reason:"Something wrong with the request"}),q=new ci({status:400,error:"bad_request",reason:"Document must be a JSON object"}),hM=new ci({status:404,error:"not_found",reason:"Database not found"}),hy=new ci({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ew=new ci({status:500,error:"web_sql_went_bad",reason:"unknown"}),fX=new ci({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),h7=new ci({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),bt=new ci({status:400,error:"bad_request",reason:"Invalid rev format"}),hG=new ci({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),gL=new ci({status:412,error:"missing_stub"}),i4=new ci({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gt=[hO,hg,fn,hK,je,ik,fz,g1,iB,gB,gx,hl,et,gW,q,hM,ew,fX,h7,bt,hG,gL,hy,i4],gu=function(aa,ac,t){var ab=gt.filter(function(ad){return ad[aa]===ac});return t&&ab.filter(function(ad){return ad.message===t})[0]||ab[0]},fm=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],iV="queryKey",m=/(?:^|&)([^&=]*)=?([^&]*)/g,de=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,iX="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");ij(bo,hx.EventEmitter),bo.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},bo.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=h2(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=w,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=iu(ac.view):ac.filter=iu(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=he(function(af){ad.cancel(),ab.apply(this,af)})}},bo.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=ih(gW,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=jl(ac.view);this.db.get("_design/"+ab[0],function(ag,ah){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ag){return aa(fv(ag))}var aj=ah&&ah.views&&ah.views[ab[1]]&&ah.views[ab[1]].map;return aj?(ac.filter=iP(aj),void t.doChanges(ac)):aa(ih(fn,ah.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=jl(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(aj,ah){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(aj){return aa(fv(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(ac.filter=iv(ag),void t.doChanges(ac)):aa(ih(fn,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},ij(iC,hx.EventEmitter),iC.prototype.post=iz("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(ih(q)):void this.bulkDocs({docs:[aa]},ab,an(t))}),iC.prototype.put=iz("put",he(function(ad){function ab(){ac||(iO("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ac=!0)}var ag,aj,ah,af,ac=!1,aa=ad.shift(),t="_id" in aa;if("object"!=typeof aa||Array.isArray(aa)){return(af=ad.pop())(ih(q))}for(;;){if(ag=ad.shift(),aj=typeof ag,"string"!==aj||t?"string"!==aj||!t||"_rev" in aa?"object"===aj?ah=ag:"function"===aj&&(af=ag):(ab(),aa._rev=ag):(ab(),aa._id=ag,t=!0),!ad.length){break}}return ah=ah||{},jd(aa._id),ex(aa._id)&&"function"==typeof this._putLocal?aa._deleted?this._removeLocal(aa,af):this._putLocal(aa,af):void this.bulkDocs({docs:[aa]},ah,an(af))})),iC.prototype.putAttachment=iz("putAttachment",function(ab,ad,ag,ac,aa){function t(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ad]={content_type:aa,data:ac,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw ih(hK)}return t(ah)},function(ah){if(ah.reason===fn.message){return t({_id:ab})}throw ah})}),iC.prototype.removeAttachment=iz("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(ih(hK)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),iC.prototype.remove=iz("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,ex(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,an(ad))}),iC.prototype.revsDiff=iz("revsDiff",function(t,ac,ag){function aa(ak,aj){ab.has(ak)||ab.set(ak,{missing:[]}),ab.get(ak).missing.push(aj)}function ah(aj,ak){var al=t[aj].slice(0);cn(ak,function(av,aw,am,aq,ap){var ax=aw+"-"+am,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==ap.status&&aa(aj,ax))}),al.forEach(function(am){aa(aj,am)})}"function"==typeof ac&&(ag=ac,ac={});var ad=Object.keys(t);if(!ad.length){return ag(null,{})}var af=0,ab=new hS.Map;ad.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ab.set(aj,{missing:t[aj]})}else{if(al){return ag(al)}ah(aj,am)}if(++af===ad.length){var ak={};return ab.forEach(function(ap,aq){ak[aq]=ap}),ag(null,ak)}})},this)}),iC.prototype.bulkGet=iz("bulkGet",function(t,aa){a9(this,t,aa)}),iC.prototype.compactDocument=iz("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(aj,af){if(aj){return t(aj)}var ah=i6(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>ac&&ad.push(ak)}),cn(af,function(am,aq,ak,ap,al){var au=aq+"-"+ak;"available"===al.status&&-1!==ad.indexOf(au)&&ag.push(au)}),ab._doCompaction(aa,ag,t)})}),iC.prototype.compact=iz("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&jE(t)}),iC.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(ah){var aj=ah.last_seq;jm.all(af).then(function(){return fa(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},iC.prototype.get=iz("get",function(t,ac,ag){function aa(){var ak=[],aj=ah.length;return aj?void ah.forEach(function(al){ad.get(t,{rev:al,revs:ac.revs,attachments:ac.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ag(null,ak)})}):ag(null,ak)}if("function"==typeof ac&&(ag=ac,ac={}),"string"!=typeof t){return ag(ih(je))}if(ex(t)&&"function"==typeof this._getLocal){return this._getLocal(t,ag)}var ah=[],ad=this;if(!ac.open_revs){return this._get(t,ac,function(ap,aq){if(ap){return ag(ap)}var ax=aq.doc,aA=aq.metadata,az=aq.ctx;if(ac.conflicts){var ay=gk(aA);ay.length&&(ax._conflicts=ay)}if(fS(aA,ax._rev)&&(ax._deleted=!0),ac.revs||ac.revs_info){var aj=ga(aA.rev_tree),au=g(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ax._rev.split("-")[1])}),aB=au.ids.map(function(aC){return aC.id}).indexOf(ax._rev.split("-")[1])+1,am=au.ids.length-aB;if(au.ids.splice(aB,am),au.ids.reverse(),ac.revs&&(ax._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ac.revs_info){var al=au.pos+au.ids.length;ax._revs_info=au.ids.map(function(aC){return al--,{rev:al+"-"+aC.id,status:aC.opts.status}})}}if(ac.attachments&&ax._attachments){var ak=ax._attachments,aw=Object.keys(ak).length;if(0===aw){return ag(null,ax)}Object.keys(ak).forEach(function(aC){this._getAttachment(ax._id,aC,ak[aC],{rev:ax._rev,binary:ac.binary,ctx:az},function(aE,aD){var aF=ax._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aw||ag(null,ax)})},ad)}else{if(ax._attachments){for(var av in ax._attachments){ax._attachments.hasOwnProperty(av)&&(ax._attachments[av].stub=!0)}}ag(null,ax)}})}if("all"===ac.open_revs){this._getRevisionTree(t,function(ak,aj){return ak?ag(ak):(ah=gA(aj).map(function(al){return al.rev}),void aa())})}else{if(!Array.isArray(ac.open_revs)){return ag(ih(iB,"function_clause"))}ah=ac.open_revs;for(var af=0;af<ah.length;af++){var ab=ah[af];if("string"!=typeof ab||!/^\d+-/.test(ab)){return ag(ih(bt))}}aa()}}),iC.prototype.getAttachment=iz("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(ih(fn))})}),iC.prototype.allDocs=iz("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(ih(hl,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return a4(this,aa,ab)}}return this._allDocs(aa,ab)}),iC.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new bo(this,t,aa)},iC.prototype.close=iz("close",function(t){return this._closed=!0,this._close(t)}),iC.prototype.info=iz("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),iC.prototype.id=iz("id",function(t){return this._id(t)}),iC.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},iC.prototype.bulkDocs=iz("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(ih(hg))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(ih(q))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||h0(ag)})}),ab?aa(ih(gW,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(L),iM(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),iC.prototype.registerDependentDatabase=iz("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);fa(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),iC.prototype.destroy=iz("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});jm.all(ag).then(aa,t)})}),fW.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},fW.prototype.fail=function(t){this.failed=t,this.execute()},fW.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},fW.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},ij(hn,iC),hn.debug=io,hn.adapters={},hn.preferredAdapters=[],hn.prefix="_pouch_";var dn=new hx.EventEmitter;ii(hn),hn.parseAdapter=function(t,ac){var ag,aa,ah=t.match(/([a-z\-]*):\/\/(.*)/);if(ah){if(t=/http(s?)/.test(ah[1])?ah[1]+"://"+ah[2]:ah[2],ag=ah[1],!hn.adapters[ag].valid()){throw"Invalid adapter"}return{name:t,adapter:ah[1]}}var ad="idb" in hn.adapters&&"websql" in hn.adapters&&gf()&&localStorage["_pouch__websqldb_"+hn.prefix+t];if(ac.adapter){aa=ac.adapter}else{if("undefined"!=typeof ac&&ac.db){aa="leveldb"}else{for(var af=0;af<hn.preferredAdapters.length;++af){if(aa=hn.preferredAdapters[af],aa in hn.adapters){if(ad&&"idb"===aa){iO("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ag=hn.adapters[aa];var ab=ag&&"use_prefix" in ag?ag.use_prefix:!0;return{name:ab?hn.prefix+t:t,adapter:aa}},hn.adapter=function(aa,ab,t){ab.valid()&&(hn.adapters[aa]=ab,t&&hn.preferredAdapters.push(aa))},hn.plugin=function(t){return"function"==typeof t?t(hn):Object.keys(t).forEach(function(aa){hn.prototype[aa]=t[aa]}),hn},hn.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=iZ.extend({},t,ad),void hn.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return ij(aa,hn),aa.preferredAdapters=hn.preferredAdapters.slice(),Object.keys(hn).forEach(function(ab){ab in aa||(aa[ab]=hn[ab])}),aa};var be="5.4.4";hn.version=be;var gT,fo=hs(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hY=hs(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),ht=function(t){return atob(t)},h3=function(t){return btoa(t)},D=gh.setImmediate||gh.setTimeout,iU=32768,h8=5,gv="document-store",g2="by-sequence",iL="attach-store",hQ="attach-seq-store",gr="meta-store",K="local-store",jv="detect-blob-support",f={running:!1,queue:[]},hD=new hS.Map,gq=new fi,ir=new hS.Map;z.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var dr=7,hV=hk("document-store"),i0=hk("by-sequence"),ce=hk("attach-store"),gH=hk("local-store"),i9=hk("metadata-store"),ie=hk("attach-seq-store"),a6=new hS.Map,a2=new fi,h9=1,B="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+i0+" (seq, deleted)",hJ="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+i0+" (doc_id, rev)",hm="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hV+" (winningseq)",jr="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+ie+" (seq)",ff="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+ie+" (digest, seq)",jx=i0+".seq = "+hV+".winningseq",p=i0+".seq AS seq, "+i0+".deleted AS deleted, "+i0+".json AS data, "+i0+".rev AS rev, "+hV+".json AS metadata";i1.valid=hr,i1.use_prefix=!0;var hp=hR(),hu=function(){},h6=25,jj=50,il={},en=1800,hP=io("pouchdb:http");im.valid=function(){return !0},a0.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},a0.prototype.finish=function(){return this.promise};var U=function(t,aa){return aa&&t.then(function(ab){a3.nextTick(function(){aa(null,ab)})},function(ab){a3.nextTick(function(){aa(ab)})}),t},iR=function(t){return he(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&U(ab,aa),ab})},C=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},jb=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},fl=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},ic={},gZ=new a0,iY=50,iG=iO.bind(null,"log"),iK={_sum:function(t,aa){return ae(aa)},_count:function(t,aa){return aa.length},_stats:function(aa,ab){function t(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:ae(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},hb=iR(function(){var t=this;return"http"===t.type()?iE(t):"function"==typeof t._viewCleanup?M(t):X(t)}),fk=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?i(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=jm.resolve().then(function(){return at(ad,ac,t)});return U(ab,aa),ab};ij(A,Error),ij(G,Error),ij(fj,Error);var jz={query:fk,viewCleanup:hb},jp=1,gU="pouchdb",hC=5,ia=0;gR.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},gR.prototype.updateTarget=function(t,aa){return h4(this.target,this.id,t,aa,this.returnValue)},gR.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?jm.resolve(!0):h4(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(iF(ac)){return t.readOnlySource=!0,!0}throw ac})};var hh={undefined:function(t,aa){return 0===gi.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return h5(aa,t).last_seq}};gR.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?jm.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ia}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hh?hh[ab](aa,ac):ia},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ia}).then(function(){return ia},function(ac){return iF(ac)?(t.readOnlySource=!0,aa.last_seq):ia})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ia})};var hj=0;ij(gN,hx.EventEmitter),gN.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gN.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},ij(hI,hx.EventEmitter),hI.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},hn.plugin(iw).plugin(j).plugin(gG).plugin(jz).plugin(gp),e.exports=hn}).call(this,b(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var j="color: "+this.color;k=[k[0],j,"color: inherit"].concat(Array.prototype.slice.call(k,1));var g=0,f=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),k.splice(f,0,j),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(r,f,u){function b(){return u.colors[s++%u.colors.length]}function a(k){function h(){}function g(){var w=g,q=+new Date,v=q-(o||q);w.diff=v,w.prev=o,w.curr=q,o=q,null==w.useColors&&(w.useColors=u.useColors()),null==w.color&&w.useColors&&(w.color=b());var m=Array.prototype.slice.call(arguments);m[0]=u.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=u.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof u.formatArgs&&(m=u.formatArgs.apply(w,m));var l=g.log||u.log||console.log.bind(console);l.apply(w,m)}h.enabled=!1,g.enabled=!0;var j=u.enabled(k)?g:h;return j.namespace=k,j}function t(g){u.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?u.skips.push(new RegExp("^"+g.substr(1)+"$")):u.names.push(new RegExp("^"+g+"$")))}}function n(){u.enable("")}function e(g){var j,h;for(j=0,h=u.skips.length;h>j;j++){if(u.skips[j].test(g)){return !1}}for(j=0,h=u.names.length;h>j;j++){if(u.names[j].test(g)){return !0}}return !1}function i(g){return g instanceof Error?g.stack||g.message:g}u=f.exports=a,u.coerce=i,u.disable=n,u.enable=t,u.enabled=e,u.humanize=r(11),u.names=[],u.skips=[],u.formatters={};var o,s=0},{11:11}],7:[function(b,e,a){(function(n){function u(){o=!0;for(var g,h,j=s.length;j;){for(h=s,s=[],g=-1;++g<j;){h[g]()}j=s.length}o=!1}function z(g){1!==s.push(g)||o||y()}var y,r=n.MutationObserver||n.WebKitMutationObserver;if(r){var l=0,f=new r(u),i=n.document.createTextNode("");f.observe(i,{characterData:!0}),y=function(){i.data=l=++l%2}}else{if(n.setImmediate||"undefined"==typeof n.MessageChannel){y="document" in n&&"onreadystatechange" in n.document.createElement("script")?function(){var g=n.document.createElement("script");g.onreadystatechange=function(){u(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},n.document.documentElement.appendChild(g)}:function(){setTimeout(u,0)}}else{var x=new n.MessageChannel;x.port1.onmessage=u,y=function(){x.port2.postMessage(0)}}}var o,s=[];e.exports=z}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(b,e,a){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(l,u,t){function i(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=e,this.queue=[],this.outcome=void 0,g!==i&&y(this,g)}function p(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function b(j,k,g){s(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function m(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=f(g);"error"===z.status&&w(z.value)}function f(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function n(g){return g instanceof this?g:K.resolve(new this(i),g)}function r(g){var j=new this(i);return K.reject(j,g)}function h(j){function w(E,D){function C(F){z[D]=F,++g!==q||k||(k=!0,K.resolve(B,z))}A.resolve(E).then(C,function(F){k||(k=!0,K.reject(B,F))})}var A=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var q=j.length,k=!1;if(!q){return this.resolve([])}for(var z=new Array(q),g=0,x=-1,B=new this(i);++x<q;){w(j[x],x)}return B}function o(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(i);++z<g;){q(j[z])}return k}var s=l(7),K={},L=["REJECTED"],a=["FULFILLED"],e=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===a||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(i);if(this.state!==e){var j=this.state===a?k:q;b(g,j,this.outcome)}else{this.queue.push(new p(g,k,q))}return g},p.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},p.prototype.otherCallFulfilled=function(g){b(this.promise,this.onFulfilled,g)},p.prototype.callRejected=function(g){K.reject(this.promise,g)},p.prototype.otherCallRejected=function(g){b(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=f(m,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=a,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},v.resolve=n,v.reject=r,v.all=h,v.race=o},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function s(w){if(null!==w){switch(typeof w){case"boolean":return w?1:0;case"number":return i(w);case"string":return w.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var v=Array.isArray(w),g=v?w:Object.keys(w),m=-1,q=g.length,j="";if(v){for(;++m<q;){j+=h.toIndexableString(g[m])}}else{for(;++m<q;){var k=g[m];j+=h.toIndexableString(k)+h.toIndexableString(w[k])}}return j}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+a),m=parseInt(j,10)+e;for(x&&(m=-m),k+=a;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(g,m){var v=g.pop();if(m.length){var j=m[m.length-1];v===j.element&&(m.pop(),j=m[m.length-1]);var q=j.element,w=j.index;if(Array.isArray(q)){q.push(v)}else{if(w===g.length-2){var k=g.pop();q[k]=v}else{g.push(v)}}}}function b(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(w,v){for(var g=Object.keys(w),m=Object.keys(v),q=Math.min(g.length,m.length),j=0;q>j;j++){var k=h.collate(g[j],m[j]);if(0!==k){return k}if(k=h.collate(w[g[j]],v[m[j]]),0!==k){return k}}return g.length===m.length?0:g.length>m.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(x){if(0===x){return"1"}var q=x.toExponential().split(/e\+?/),g=parseInt(q[1],10),k=0>x,j=k?"0":"2",y=(k?-g:g)-e,w=p.padLeft(y.toString(),"0",a);j+=u+w;var m=Math.abs(parseFloat(q[0]));k&&(m=10-m);var v=m.toFixed(20);return v=v.replace(/\.?0+$/,""),j+=u+v}var e=-324,a=3,u="",p=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=h.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=h.normalizeKey(q))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),n(g)+u+s(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(b,h,a){function e(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var f,g=n.length,o=r.length;for(f=0;g>f;f++){if(f===o){return 1}var q=n.charAt(f),i=r.charAt(f);if(q!==i){return i>q?-1:1}}return o>g?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(n){function s(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function O(j,q,k,A,w,z,x){return s(q&k|~q&A,j,q,w,z,x)}function m(j,q,k,A,w,z,x){return s(q&A|k&~A,j,q,w,z,x)}function P(j,q,k,A,w,z,x){return s(q^k^A,j,q,w,z,x)}function u(j,q,k,A,w,z,x){return s(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=O(z,q,x,j,w[0],7,-680876936),j=O(j,z,q,x,w[1],12,-389564586),x=O(x,j,z,q,w[2],17,606105819),q=O(q,x,j,z,w[3],22,-1044525330),z=O(z,q,x,j,w[4],7,-176418897),j=O(j,z,q,x,w[5],12,1200080426),x=O(x,j,z,q,w[6],17,-1473231341),q=O(q,x,j,z,w[7],22,-45705983),z=O(z,q,x,j,w[8],7,1770035416),j=O(j,z,q,x,w[9],12,-1958414417),x=O(x,j,z,q,w[10],17,-42063),q=O(q,x,j,z,w[11],22,-1990404162),z=O(z,q,x,j,w[12],7,1804603682),j=O(j,z,q,x,w[13],12,-40341101),x=O(x,j,z,q,w[14],17,-1502002290),q=O(q,x,j,z,w[15],22,1236535329),z=m(z,q,x,j,w[1],5,-165796510),j=m(j,z,q,x,w[6],9,-1069501632),x=m(x,j,z,q,w[11],14,643717713),q=m(q,x,j,z,w[0],20,-373897302),z=m(z,q,x,j,w[5],5,-701558691),j=m(j,z,q,x,w[10],9,38016083),x=m(x,j,z,q,w[15],14,-660478335),q=m(q,x,j,z,w[4],20,-405537848),z=m(z,q,x,j,w[9],5,568446438),j=m(j,z,q,x,w[14],9,-1019803690),x=m(x,j,z,q,w[3],14,-187363961),q=m(q,x,j,z,w[8],20,1163531501),z=m(z,q,x,j,w[13],5,-1444681467),j=m(j,z,q,x,w[2],9,-51403784),x=m(x,j,z,q,w[7],14,1735328473),q=m(q,x,j,z,w[12],20,-1926607734),z=P(z,q,x,j,w[5],4,-378558),j=P(j,z,q,x,w[8],11,-2022574463),x=P(x,j,z,q,w[11],16,1839030562),q=P(q,x,j,z,w[14],23,-35309556),z=P(z,q,x,j,w[1],4,-1530992060),j=P(j,z,q,x,w[4],11,1272893353),x=P(x,j,z,q,w[7],16,-155497632),q=P(q,x,j,z,w[10],23,-1094730640),z=P(z,q,x,j,w[13],4,681279174),j=P(j,z,q,x,w[0],11,-358537222),x=P(x,j,z,q,w[3],16,-722521979),q=P(q,x,j,z,w[6],23,76029189),z=P(z,q,x,j,w[9],4,-640364487),j=P(j,z,q,x,w[12],11,-421815835),x=P(x,j,z,q,w[15],16,530742520),q=P(q,x,j,z,w[2],23,-995338651),z=u(z,q,x,j,w[0],6,-198630844),j=u(j,z,q,x,w[7],10,1126891415),x=u(x,j,z,q,w[14],15,-1416354905),q=u(q,x,j,z,w[5],21,-57434055),z=u(z,q,x,j,w[12],6,1700485571),j=u(j,z,q,x,w[3],10,-1894986606),x=u(x,j,z,q,w[10],15,-1051523),q=u(q,x,j,z,w[1],21,-2054922799),z=u(z,q,x,j,w[8],6,1873313359),j=u(j,z,q,x,w[15],10,-30611744),x=u(x,j,z,q,w[6],15,-1560198380),q=u(q,x,j,z,w[13],21,1309151649),z=u(z,q,x,j,w[4],6,-145523070),j=u(j,z,q,x,w[11],10,-1120210379),x=u(x,j,z,q,w[2],15,718787259),q=u(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function p(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function Q(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function r(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,p(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function o(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,Q(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function v(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function l(j){var k;for(k=0;k<j.length;k+=1){j[k]=v(j[k])}return j.join("")}function t(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function y(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==l(r("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(A,B){var z,C,k,D,w=this.byteLength,x=j(A,w),q=w;return B!==n&&(q=j(B,w)),x>q?new ArrayBuffer(0):(z=q-x,C=new ArrayBuffer(z),k=new Uint8Array(C),D=new Uint8Array(this,x,z),k.set(D),C)}}(),y.prototype.append=function(j){return this.appendBinary(t(j)),this},y.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,p(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},y.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},y.hash=function(j,k){return y.hashBinary(t(j),k)},y.hashBinary=function(k,w){var j=r(k),q=l(j);return w?e(q):q},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,Q(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var j=y.prototype.getState.call(this);return j.buff=S(j.buff),j},y.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),y.prototype.setState.call(this,j)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(k,w){var j=o(new Uint8Array(k)),q=l(j);return w?e(q):q},y})},{}],17:[function(b,h,a){function e(n,r,f){var g=f[f.length-1];n===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,q=g.index;if(Array.isArray(o)){o.push(n)}else{if(q===r.length-2){var i=r.pop();o[i]=n}else{r.push(n)}}}a.stringify=function(f){var F=[];F.push({obj:f});for(var l,E,i,n,s,g,u,C,D,o,t,r="";l=F.pop();){if(E=l.obj,i=l.prefix||"",n=l.val||"",r+=i,n){r+=n}else{if("object"!=typeof E){r+="undefined"==typeof E?null:JSON.stringify(E)}else{if(null===E){r+="null"}else{if(Array.isArray(E)){for(F.push({val:"]"}),s=E.length-1;s>=0;s--){g=0===s?"":",",F.push({obj:E[s],prefix:g})}F.push({val:"["})}else{u=[];for(C in E){E.hasOwnProperty(C)&&u.push(C)}for(F.push({val:"}"}),s=u.length-1;s>=0;s--){D=u[s],o=E[D],t=s>0?",":"",t+=JSON.stringify(D)+":",F.push({obj:o,prefix:t})}F.push({val:"{"})}}}}}return r},a.parse=function(f){for(var o,D,g,t,A,n,l,u,s,i=[],B=[],C=0;;){if(o=f[C++],"}"!==o&&"]"!==o&&"undefined"!=typeof o){switch(o){case" ":case"	":case"\n":case":":case",":break;case"n":C+=3,e(null,i,B);break;case"t":C+=3,e(!0,i,B);break;case"f":C+=4,e(!1,i,B);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",C--;;){if(g=f[C++],!/[\d\.\-e\+]/.test(g)){C--;break}D+=g}e(parseFloat(D),i,B);break;case'"':for(t="",A=void 0,n=0;;){if(l=f[C++],'"'===l&&("\\"!==A||n%2!==1)){break}t+=l,A=l,"\\"===A?n++:n=0}e(JSON.parse('"'+t+'"'),i,B);break;case"[":u={element:[],index:i.length},i.push(u.element),B.push(u);break;case"{":s={element:{},index:i.length},i.push(s.element),B.push(s);break;default:throw new Error("unexpectedly reached end of input: "+o)}}else{if(1===i.length){return i.pop()}e(i.pop(),i,B)}}}},{}]},{},[3])(3)});