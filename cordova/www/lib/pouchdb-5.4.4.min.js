!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(e,k){if(!c[e]){if(!h[e]){var i="function"==typeof require&&require;if(!k&&i){return i(e,!0)}if(d){return d(e,!0)}var m=new Error("Cannot find module '"+e+"'");throw m.code="MODULE_NOT_FOUND",m}var l=c[e]={exports:{}};h[e][0].call(l.exports,function(o){var n=h[e][1][o];return g(n?n:o)},l,l.exports,a,h,c,f)}return c[e].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,l,f){function k(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}l.exports=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},k.prototype.emit=function(i){var p,o,e,n,m,q;if(this._events||(this._events={}),"error"===i&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(p=arguments[1],p instanceof Error){throw p}throw TypeError('Uncaught, unspecified "error" event.')}if(o=this._events[i],g(o)){return !1}if(d(o)){switch(arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),o.apply(this,n)}}else{if(c(o)){for(n=Array.prototype.slice.call(arguments,1),q=o.slice(),e=q.length,m=0;e>m;m++){q[m].apply(this,n)}}}return !0},k.prototype.addListener=function(m,i){var e;if(!d(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,d(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?k.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},k.prototype.on=k.prototype.addListener,k.prototype.once=function(e,m){function i(){this.removeListener(e,i),n||(n=!0,m.apply(this,arguments))}if(!d(m)){throw TypeError("listener must be a function")}var n=!1;return i.listener=m,this.on(e,i),this},k.prototype.removeListener=function(m,p){var o,n,e,i;if(!d(p)){throw TypeError("listener must be a function")}if(!this._events||!this._events[m]){return this}if(o=this._events[m],e=o.length,n=-1,o===p||d(o.listener)&&o.listener===p){delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,p)}else{if(c(o)){for(i=e;i-->0;){if(o[i]===p||o[i].listener&&o[i].listener===p){n=i;break}}if(0>n){return this}1===o.length?(o.length=0,delete this._events[m]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",m,p)}}return this},k.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],d(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},k.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?d(this._events[i])?[this._events[i]]:this._events[i].slice():[]},k.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(d(e)){return 1}if(e){return e.length}}return 0},k.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(A,v,c){function z(){y&&p&&(y=!1,p.length?k=p.concat(k):w=-1,k.length&&m())}function m(){if(!y){var f=g(z);y=!0;for(var e=k.length;e;){for(p=k,k=[];++w<e;){p&&p[w].run()}w=-1,e=k.length}p=null,y=!1,d(f)}}function x(f,e){this.fun=f,this.array=e}function j(){}var g,d,q=v.exports={};!function(){try{g=setTimeout}catch(e){g=function(){throw new Error("setTimeout is not defined")}}try{d=clearTimeout}catch(e){d=function(){throw new Error("clearTimeout is not defined")}}}();var p,k=[],y=!1,w=-1;q.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}k.push(new x(f,e)),1!==k.length||y||g(m,0)},x.prototype.run=function(){this.fun.apply(null,this.array)},q.title="browser",q.browser=!0,q.env={},q.argv=[],q.version="",q.versions={},q.on=j,q.addListener=j,q.once=j,q.off=j,q.removeListener=j,q.removeAllListeners=j,q.emit=j,q.binding=function(e){throw new Error("process.binding is not supported")},q.cwd=function(){return"/"},q.chdir=function(e){throw new Error("process.chdir is not supported")},q.umask=function(){return 0}},{}],3:[function(d,c,f){(function(eO,bc){function ed(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function f5(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eE(j){if("function"==typeof j.slice){return j.slice(0)}var h=new ArrayBuffer(j.byteLength),g=new Uint8Array(h),i=new Uint8Array(j);return g.set(i),h}function dY(h){if(h instanceof ArrayBuffer){return eE(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function e3(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&ka.call(i)==aC}function aU(i){var g,k,h;if(!i||"object"!=typeof i){return i}if(Array.isArray(i)){for(g=[],k=0,h=i.length;h>k;k++){g[k]=aU(i[k])}return g}if(i instanceof Date){return i.toISOString()}if(f5(i)){return dY(i)}if(!e3(i)){return i}g={};for(k in i){if(Object.prototype.hasOwnProperty.call(i,k)){var j=aU(i[k]);"undefined"!=typeof j&&(g[k]=j)}}return g}function f3(g){var h=!1;return dO(function(i){if(h){throw new Error("once called more than once")}h=!0,g.apply(this,i)})}function dy(g){return dO(function(j){j=aU(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(m,n){eO.nextTick(function(){i(m,n)})});var h=new cL(function(m,q){var o;try{var n=f3(function(r,s){r?q(r):m(s)});j.push(n),o=g.apply(l,j),o&&"function"==typeof o.then&&m(o)}catch(p){q(p)}});return k&&h.then(function(m){k(null,m)},k),h})}function eC(h,g){function i(j,n,l){if(cs.enabled){for(var o=[j._db_name,n],k=0;k<l.length-1;k++){o.push(l[k])}cs.apply(null,o);var m=l[l.length-1];l[l.length-1]=function(r,p){var q=[j._db_name,n];q=q.concat(r?["error",r]:["success",p]),cs.apply(null,q),m(r,p)}}}return dy(dO(function(j){if(this._closed){return cL.reject(new Error("database is closed"))}if(this._destroyed){return cL.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new cL(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function e4(j,h){for(var l={},i=0,k=h.length;k>i;i++){var g=h[i];g in j&&(l[g]=j[g])}return l}function eK(g){return g}function dC(g){return[{ok:g}]}function ds(g,k,u){function l(){var w=[];j.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),u(null,{results:w})}function m(){++p===v&&l()}function q(x,w,y){j[x]={id:w,docs:y},m()}function o(){if(!(s>=h.length)){var x=Math.min(s+by,h.length),w=h.slice(s,x);i(w,s),s+=w.length}}function i(x,w){x.forEach(function(z,D){var B=w+D,y=n[z],A=e4(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(eK);var C=eK;0===A.open_revs.length&&(delete A.open_revs,C=dC),["revs","attachments","binary","ajax"].forEach(function(E){E in k&&(A[E]=k[E])}),g.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),q(B,z,F),o()})})}var r=k.docs,n={};r.forEach(function(w){w.id in n?n[w.id].push(w):n[w.id]=[w]});var v=Object.keys(n).length,p=0,j=new Array(v),h=Object.keys(n),s=0;o()}function e8(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function eB(){return f7}function eX(g){e8()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):eB()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function fD(){cf.EventEmitter.call(this),this._listeners={},eX(this)}function c1(g){if("undefined"!==console&&g in console){var h=Array.prototype.slice.call(arguments,1);console[g].apply(console,h)}}function dg(i,g){var k=600000;i=parseInt(i,10)||0,g=parseInt(g,10),g!==g||i>=g?g=(i||1)<<1:g+=1,g>k&&(i=k>>1,g=k);var h=Math.random(),j=g-i;return ~~(j*h+i)}function aL(g){var h=0;return g||(h=2000),dg(g,h)}function ch(g,h){c1("info","The above "+g+" is totally normal. "+h)}function eR(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function dX(j,h,g){function i(k){for(var l in j){"function"!=typeof j[l]&&(this[l]=j[l])}void 0!==g&&(this.name=g),void 0!==k&&(this.reason=k)}return i.prototype=eR.prototype,new i(h)}function bH(j){var h,l,i,k,g;return l=j.error===!0&&"string"==typeof j.name?j.name:j.error,g=j.reason,i=cD("name",l,g),j.missing||"missing"===g||"deleted"===g||"not_found"===l?i=b2:"doc_validation"===l?(i=fI,k=g):"bad_request"===l&&i.message!==g&&(i=ba),i||(i=cD("status",j.status,g)||bW),h=dX(i,g,l),k&&(h.message=k),j.id&&(h.id=j.id),j.status&&(h.status=j.status),j.missing&&(h.missing=j.missing),h}function bS(i,g,k){try{return !i(g,k)}catch(h){var j="Filter function threw: "+h.toString();return dX(ba,j)}}function d2(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&bS(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function aQ(j){for(var h=[],g=0,i=j.length;i>g;g++){h=h.concat(j[g])}return h}function bJ(g){var h;if(g?"string"!=typeof g?h=dX(cS):/^_/.test(g)&&!/^_(design|local)/.test(g)&&(h=dX(fC)):h=dX(bw),h){throw h}}function eA(g,h){return"listenerCount" in g?g.listenerCount(h):cf.EventEmitter.listenerCount(g,h)}function av(g){if(!g){return null}var h=g.split("/");return 2===h.length?h:1===h.length?[g,g]:null}function bq(g){var h=av(g);return h?h.join("/"):null}function cU(l){for(var j=fO.exec(l),g={},k=14;k--;){var m=cM[k],i=j[k]||"",h=-1!==["user","password"].indexOf(m);g[m]=h?decodeURIComponent(i):i}return g[ck]={},g[cM[12]].replace(dw,function(o,p,n){p&&(g[ck][p]=n)}),g}function db(h,g,i){return new cL(function(j,k){h.get(g,function(o,m){if(o){if(404!==o.status){return k(o)}m={}}var l=m._rev,n=i(m);return n?(n._id=g,n._rev=l,void j(c4(h,n,i))):j({updated:!1,rev:l})})})}function c4(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return db(h,g._id,i)})}function d3(g){return 0|Math.random()*g}function bi(j,h){h=h||dP.length;var g="",i=-1;if(j){for(;++i<j;){g+=dP[d3(h)]}return g}for(;++i<36;){switch(i){case 8:case 13:case 18:case 23:g+="-";break;case 19:g+=dP[3&d3(16)|8];break;default:g+=dP[d3(16)]}}return g}function cP(r){for(var p,g,q,s,i=r.rev_tree.slice();s=i.pop();){var n=s.ids,j=n[2],o=s.pos;if(j.length){for(var m=0,k=j.length;k>m;m++){i.push({pos:o+1,ids:j[m]})}}else{var h=!!n[1].deleted,l=n[0];p&&!(q!==h?q:g!==o?o>g:l>p)||(p=l,g=o,q=h)}}return g+"-"+p}function dd(j,l){for(var h,o=j.slice();h=o.pop();){for(var g=h.pos,i=h.ids,k=i[2],m=l(0===k.length,g,i[0],h.ctx,i[1]),n=0,p=k.length;p>n;n++){o.push({pos:g+1,ids:k[n],ctx:m})}}}function dH(g,h){return g.pos-h.pos}function cm(j){var h=[];dd(j,function(m,o,l,n,k){m&&h.push({rev:o+"-"+l,pos:o,opts:k})}),h.sort(dH).reverse();for(var g=0,i=h.length;i>g;g++){delete h[g].pos}return h}function bI(l){for(var j=cP(l),g=cm(l.rev_tree),k=[],m=0,i=g.length;i>m;m++){var h=g[m];h.rev===j||h.opts.deleted||k.push(h.rev)}return k}function fB(g){var h=[];return dd(g.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(h.push(i+"-"+k),j.status="missing")}),h}function aP(r){for(var p,g=[],q=r.slice();p=q.pop();){var s=p.pos,i=p.ids,n=i[0],j=i[1],o=i[2],m=0===o.length,k=p.history?p.history.slice():[];k.push({id:n,opts:j}),m&&g.push({pos:s+1-k.length,ids:k});for(var h=0,l=o.length;l>h;h++){q.push({pos:s+1,ids:o[h],history:k})}}return g.reverse()}function aT(g,h){return g.pos-h.pos}function du(j,h,l){for(var i,k=0,g=j.length;g>k;){i=k+g>>>1,l(j[i],h)<0?k=i+1:g=i}return k}function eI(j,h,g){var i=du(j,h,g);j.splice(i,0,h)}function dZ(h,i){for(var j,k,m=i,n=h.length;n>m;m++){var l=h[m],g=[l.id,l.opts,[]];k?(k[2].push(g),k=g):j=k=g}return j}function dh(g,h){return g[0]<h[0]?-1:1}function fH(j,l){for(var h=[{tree1:j,tree2:l}],o=!1;h.length>0;){var g=h.pop(),i=g.tree1,k=g.tree2;(i[1].status||k[1].status)&&(i[1].status="available"===i[1].status||"available"===k[1].status?"available":"missing");for(var m=0;m<k[2].length;m++){if(i[2][0]){for(var n=!1,p=0;p<i[2].length;p++){i[2][p][0]===k[2][m][0]&&(h.push({tree1:i[2][p],tree2:k[2][m]}),n=!0)}n||(o="new_branch",eI(i[2],k[2][m],dh))}else{o="new_leaf",i[2][0]=k[2][m]}}}return{conflicts:o,tree:j}}function ki(m,A,z){var v,k=[],o=!1,y=!1;if(!m.length){return{tree:[A],conflicts:"new_leaf"}}for(var r=0,j=m.length;j>r;r++){var x=m[r];if(x.pos===A.pos&&x.ids[0]===A.ids[0]){v=fH(x.ids,A.ids),k.push({pos:x.pos,ids:v.tree}),o=o||v.conflicts,y=!0}else{if(z!==!0){var s=x.pos<A.pos?x:A,n=x.pos<A.pos?A:x,q=n.pos-s.pos,p=[],i=[];for(i.push({ids:s.ids,diff:q,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],w=0,u=g.length;u>w;w++){i.push({ids:g[w],diff:h.diff-1,parent:h.ids,parentIdx:w})}}else{h.ids[0]===n.ids[0]&&p.push(h)}}var l=p[0];l?(v=fH(l.ids,n.ids),l.parent[2][l.parentIdx]=v.tree,k.push({pos:s.pos,ids:s.ids}),o=o||v.conflicts,y=!0):k.push(x)}else{k.push(x)}}}return y||k.push(A),k.sort(aT),{tree:k,conflicts:o||"internal_node"}}function cE(r,p){for(var g,q=aP(r),s={},i=0,n=q.length;n>i;i++){for(var j=q[i],o=j.ids,m=Math.max(0,o.length-p),k={pos:j.pos+m,ids:dZ(o,m)},h=0;m>h;h++){var l=j.pos+h+"-"+o[h].id;s[l]=!0}g=g?ki(g,k,!0).tree:[k]}return dd(g,function(w,v,u){delete s[v+"-"+u]}),{tree:g,revs:Object.keys(s)}}function eS(i,g,k){var h=ki(i,g),j=cE(h.tree,k);return{tree:j.tree,stemmedRevs:j.revs,conflicts:h.conflicts}}function cd(j,l){for(var h,o=j.slice(),g=l.split("-"),i=parseInt(g[0],10),k=g[1];h=o.pop();){if(h.pos===i&&h.ids[0]===k){return !0}for(var m=h.ids[2],n=0,p=m.length;p>n;n++){o.push({pos:h.pos+1,ids:m[n]})}}return !1}function aI(g){return g.ids}function cI(i,g){g||(g=cP(i));for(var k,h=g.substring(g.indexOf("-")+1),j=i.rev_tree.map(aI);k=j.pop();){if(k[0]===h){return !!k[1].deleted}j=j.concat(k[2])}}function aA(g){return/^_local/.test(g)}function bP(g){return aK("return "+g+";",{})}function eM(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function eY(h,g){try{h.emit("change",g)}catch(i){c1("error",'Error in .on("change", function):',i)}}function e5(l,j,g){function k(){m.cancel()}cf.EventEmitter.call(this);var m=this;this.db=l,j=j?aU(j):{};var i=j.complete=f3(function(n,o){n?eA(m,"error")>0&&m.emit("error",n):m.emit("complete",o),m.removeAllListeners(),l.removeListener("destroyed",k)});g&&(m.on("complete",function(n){g(null,n)}),m.on("error",g)),l.once("destroyed",k),j.onChange=function(n){j.isCancelled||(eY(m,n),m.startSeq&&m.startSeq<=n.seq&&(m.startSeq=!1))};var h=new cL(function(n,o){j.complete=function(p,q){p?o(p):n(q)}});m.once("cancel",function(){l.removeListener("destroyed",k),j.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){i(null,n)},i),l.taskqueue.isReady?m.doChanges(j):l.taskqueue.addTask(function(){m.isCancelled?m.emit("cancel"):m.doChanges(j)})}function eb(i,g,k){var h=[{rev:i._rev}];"all_docs"===k.style&&(h=cm(g.rev_tree).map(function(l){return{rev:l.rev}}));var j={id:g.id,changes:h,doc:i};return cI(g,i._rev)&&(j.deleted=!0),k.conflicts&&(j.doc._conflicts=bI(g),j.doc._conflicts.length||delete j.doc._conflicts),j}function ap(g,h){return h>g?-1:g>h?1:0}function jJ(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function jY(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function bV(j){for(var h=0;h<j.length;h++){var l=j[h];if(l._deleted){delete l._attachments}else{if(l._attachments){for(var i=Object.keys(l._attachments),k=0;k<i.length;k++){var g=i[k];l._attachments[g]=e4(l._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function j4(i,g){var k=ap(i._id,g._id);if(0!==k){return k}var h=i._revisions?i._revisions.start:0,j=g._revisions?g._revisions.start:0;return ap(h,j)}function fM(h){var g={},i=[];return dd(h,function(m,l,n,k){var j=l+"-"+n;return m&&(g[j]=0),void 0!==k&&i.push({from:k,to:j}),j}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function ad(i,g,k){var h="limit" in g?g.keys.slice(g.skip,g.limit+g.skip):g.skip>0?g.keys.slice(g.skip):g.keys;if(g.descending&&h.reverse(),!h.length){return i._allDocs({limit:0},k)}var j={offset:g.skip};return cL.all(h.map(function(m){var l=dm.extend({key:m,deleted:"ok"},g);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new cL(function(n,o){i._allDocs(l,function(q,p){return q?o(q):(j.total_rows=p.total_rows,void n(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return j.rows=l,j})}function f0(j){var h=j._compactionQueue[0],i=h.opts,g=h.callback;j.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(i.last_seq=k.last_seq),j._compact(i,function(l,m){l?g(l):g(null,m),eO.nextTick(function(){j._compactionQueue.shift(),j._compactionQueue.length&&f0(j)})})})}function eG(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function bd(){cf.EventEmitter.call(this)}function eh(){this.isReady=!1,this.failed=!1,this.queue=[]}function dE(g){g&&bc.debug&&c1("error",g)}function aD(l,j){function g(){i.emit("destroyed",m)}function k(){l.removeListener("destroyed",g),l.emit("destroyed",l)}var m=j.originalName,i=l.constructor,h=i._destructionListeners;l.once("destroyed",g),h.has(m)||h.set(m,[]),h.get(m).push(k)}function jN(l,j,g){if(!(this instanceof jN)){return new jN(l,j,g)}var k=this;if("function"!=typeof j&&"undefined"!=typeof j||(g=j,j={}),l&&"object"==typeof l&&(j=l,l=void 0),"undefined"==typeof g){g=dE}else{var m=g;g=function(){return c1("warn","Using a callback for new PouchDB()is deprecated."),m.apply(null,arguments)}}l=l||j.name,j=aU(j),delete j.name,this.__opts=j;var i=g;k.auto_compaction=j.auto_compaction,k.prefix=jN.prefix,bd.call(k),k.taskqueue=new eh;var h=new cL(function(n,p){g=function(r,s){return r?p(r):(delete s.then,void n(s))},j=aU(j);var o,q;return function(){try{if("string"!=typeof l){throw q=new Error("Missing/invalid DB name"),q.code=400,q}var r=(j.prefix||"")+l;if(o=jN.parseAdapter(r,j),j.originalName=l,j.name=o.name,j.adapter=j.adapter||o.adapter,k._adapter=j.adapter,b6("pouchdb:adapter")("Picked adapter: "+j.adapter),k._db_name=l,!jN.adapters[j.adapter]){throw q=new Error("Adapter is missing"),q.code=404,q}if(!jN.adapters[j.adapter].valid()){throw q=new Error("Invalid Adapter"),q.code=404,q}}catch(s){k.taskqueue.fail(s)}}(),q?p(q):(k.adapter=j.adapter,k.replicate={},k.replicate.from=function(r,u,s){return k.constructor.replicate(r,k,u,s)},k.replicate.to=function(r,u,s){return k.constructor.replicate(k,r,u,s)},k.sync=function(r,u,s){return k.constructor.sync(k,r,u,s)},k.replicate.sync=k.sync,void jN.adapters[j.adapter].call(k,j,function(r){return r?(k.taskqueue.fail(r),void g(r)):(aD(k,j),k.emit("created",k),jN.emit("created",j.originalName),k.taskqueue.ready(k),void g(null,k))}))});h.then(function(n){i(null,n)},i),k.then=h.then.bind(h),k["catch"]=h["catch"].bind(h)}function dk(g){Object.keys(cf.EventEmitter.prototype).forEach(function(i){"function"==typeof cf.EventEmitter.prototype[i]&&(g[i]=d1[i].bind(d1))});var h=g._destructionListeners=new au.Map;g.on("destroyed",function(i){h.get(i).forEach(function(j){j()}),h["delete"](i)})}function d8(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function dv(j){if(!/^\d+\-./.test(j)){return dX(df)}var h=j.indexOf("-"),g=j.substring(0,h),i=j.substring(h+1);return{prefix:parseInt(g,10),id:i}}function eU(l,j){for(var g=l.start-l.ids.length+1,k=l.ids,m=[k[0],j,[]],i=1,h=k.length;h>i;i++){m=[k[i],{status:"missing"},[m]]}return[{pos:g,ids:m}]}function c9(j,l){var h,o,g,i={status:"available"};if(j._deleted&&(i.deleted=!0),l){if(j._id||(j._id=bi()),o=bi(32,16).toLowerCase(),j._rev){if(g=dv(j._rev),g.error){return g}j._rev_tree=[{pos:g.prefix,ids:[g.id,{status:"missing"},[[o,i,[]]]]}],h=g.prefix+1}else{j._rev_tree=[{pos:1,ids:[o,i,[]]}],h=1}}else{if(j._revisions&&(j._rev_tree=eU(j._revisions,i),h=j._revisions.start,o=j._revisions.ids[0]),!j._rev_tree){if(g=dv(j._rev),g.error){return g}h=g.prefix,o=g.id,j._rev_tree=[{pos:h,ids:[o,i,[]]}]}}bJ(j._id),j._rev=h+"-"+o;var k={metadata:{},data:{}};for(var m in j){if(Object.prototype.hasOwnProperty.call(j,m)){var n="_"===m[0];if(n&&!bF[m]){var p=dX(fI,m);throw p.message=fI.message+": "+m,p}n&&!cu[m]?k.metadata[m.slice(1)]=j[m]:k.data[m]=j[m]}}return k}function jG(i){for(var g="",k=new Uint8Array(i),h=k.byteLength,j=0;h>j;j++){g+=String.fromCharCode(k[j])}return g}function aE(g){return dV(jG(g))}function eg(j,h){j=j||[],h=h||{};try{return new Blob(j,h)}catch(l){if("TypeError"!==l.name){throw l}for(var i="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,k=new i,g=0;g<j.length;g+=1){k.append(j[g])}return k.getBlob(h.type)}}function j8(i){for(var g=i.length,k=new ArrayBuffer(g),h=new Uint8Array(k),j=0;g>j;j++){h[j]=i.charCodeAt(j)}return k}function jW(g,h){return eg([j8(g)],{type:h})}function e(g,h){return jW(c2(g),h)}function t(j,h){if("undefined"==typeof FileReader){return h(jG((new FileReaderSync).readAsArrayBuffer(j)))}var g=new FileReader,i="function"==typeof g.readAsBinaryString;g.onloadend=function(k){var l=k.target.result||"";return i?h(l):void h(jG(l))},i?g.readAsBinaryString(j):g.readAsArrayBuffer(j)}function aO(g,h){t(g,function(i){h(dV(i))})}function dz(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function bR(g){return dV(g)}function e0(j,h,g,i){(g>0||i<h.byteLength)&&(h=new Uint8Array(h,g,Math.min(i,h.byteLength)-g)),j.append(h)}function j1(j,h,g,i){(g>0||i<h.length)&&(h=h.substring(g,i)),j.appendBinary(h)}function dj(j,l){function h(){var q=m*i,u=q+i;if(m++,k>m){p(n,j,q,u),eQ(h)}else{p(n,j,q,u);var r=n.end(!0),s=bR(r);l(s),n.destroy()}}var o="string"==typeof j,g=o?j.length:j.byteLength,i=Math.min(bG,g),k=Math.ceil(g/i),m=0,n=o?new bb:new bb.ArrayBuffer,p=o?j1:e0;h()}function fK(g){return bb.hash(g)}function fJ(h,i,j){function k(o){try{return c2(o)}catch(q){var p=dX(e6,"Attachment is not a valid base64 string");return{error:p}}}function m(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=k(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===i?q.data=jW(o,q.content_type):"base64"===i?q.data=dV(o):q.data=o,dj(o,function(r){q.digest="md5-"+r,p()})}else{dz(q.data,function(r){"binary"===i?q.data=jG(r):"base64"===i&&(q.data=aE(r)),dj(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function n(){g++,h.length===g&&(l?j(l):j())}if(!h.length){return j()}var l,g=0;h.forEach(function(r){function p(u){l=u,q++,q===s.length&&n()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return n()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&m(r.data._attachments[o],p)}})}function bl(w,y,l,r,k,p,x,s){if(cd(y.rev_tree,l.metadata.rev)){return r[k]=l,p()}var j=y.winningRev||cP(y),m="deleted" in y?y.deleted:cI(y,j),B="deleted" in l.metadata?l.metadata.deleted:cI(l.metadata),n=/^1-/.test(l.metadata.rev);if(m&&!B&&s&&n){var z=l.data;z._rev=j,z._id=l.metadata.id,l=c9(z,s)}var q=eS(y.rev_tree,l.metadata.rev_tree[0],w),i=s&&(m&&B||!m&&"new_leaf"!==q.conflicts||m&&!B&&"new_branch"===q.conflicts);if(i){var h=dX(eW);return r[k]=h,p()}var g=l.metadata.rev;l.metadata.rev_tree=q.tree,l.stemmedRevs=q.stemmedRevs||[],y.rev_map&&(l.metadata.rev_map=y.rev_map);var u,A=cP(l.metadata),o=cI(l.metadata,A),v=m===o?0:o>m?-1:1;u=g===A?o:cI(l.metadata,g),x(l,A,o,u,!0,v,k,p)}function j7(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function b1(q,u,k,n,g,m,o,i,s){function j(C,B,x){var D=cP(C.metadata),z=cI(C.metadata,D);if("was_delete" in i&&z){return m[B]=dX(b2,"deleted"),x()}var A=l&&j7(C);if(A){var w=dX(eW);return m[B]=w,x()}var y=z?0:1;o(C,D,z,z,!1,y,B,x)}function v(){++h===p&&s&&s()}q=q||1000;var l=i.new_edits,r=new au.Map,h=0,p=u.length;u.forEach(function(w,y){if(w._id&&aA(w._id)){var z=w._deleted?"_removeLocal":"_putLocal";return void k[z](w,{ctx:g},function(B,A){m[y]=B||A,v()})}var x=w.metadata.id;r.has(x)?(p--,r.get(x).push([w,y])):r.set(x,[[w,y]])}),r.forEach(function(z,x){function w(){++y<z.length?A():v()}function A(){var C=z[y],E=C[0],D=C[1];if(n.has(x)){bl(q,n.get(x),E,m,D,w,o,l)}else{var B=eS([],E.metadata.rev_tree[0],q);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],j(E,D,w)}}var y=0;A()})}function cX(g){try{return JSON.parse(g)}catch(h){return cJ.parse(g)}}function cp(g){return g.length<50000?JSON.parse(g):cX(g)}function aa(g){try{return JSON.stringify(g)}catch(h){return cJ.stringify(g)}}function jV(i,g,k,h){try{i.apply(g,k)}catch(j){h.emit("error",j)}}function bM(g){if(!a9.running&&a9.queue.length){a9.running=!0;var h=a9.queue.shift();h.action(function(i,j){jV(h.callback,this,[i,j],g),a9.running=!1,eO.nextTick(function(){bM(g)})})}}function fE(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(dX(eP,i,h.type))}}function bB(h,g,i){return{data:aa(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function cO(g){if(!g){return null}var h=cp(g.data);return h.winningRev=g.winningRev,h.deleted="1"===g.deletedOrLocal,h.seq=g.seq,h}function jM(g){if(!g){return g}var h=g._doc_id_rev.lastIndexOf(":");return g._id=g._doc_id_rev.substring(0,h-1),g._rev=g._doc_id_rev.substring(h+1),delete g._doc_id_rev,g}function cR(j,h,g,i){g?i(j?"string"!=typeof j?j:e(j,h):eg([""],{type:h})):j?"string"!=typeof j?t(j,function(k){i(dV(k))}):i(j):i("")}function bs(h,i,j,k){function m(){++g===l.length&&k&&k()}function n(s,q){var r=s._attachments[q],p=r.digest,o=j.objectStore(cK).get(p);o.onsuccess=function(u){r.body=u.target.result.body,m()}}var l=Object.keys(h._attachments||{});if(!l.length){return k&&k()}var g=0;l.forEach(function(o){i.attachments&&i.include_docs?n(h,o):(h._attachments[o].stub=!0,m())})}function c3(g,h){return cL.all(g.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return cL.all(j.map(function(k){var m=i.doc._attachments[k];if("body" in m){var n=m.body,l=m.content_type;return new cL(function(o){cR(n,l,h,function(p){i.doc._attachments[k]=dm.extend(e4(m,["digest","content_type"]),{data:p}),o()})})}}))}}))}function aB(j,l,h){function o(){p--,p||g()}function g(){i.length&&i.forEach(function(q){var r=n.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||m["delete"](q)}})}var i=[],k=h.objectStore(dG),m=h.objectStore(cK),n=h.objectStore(jT),p=j.length;j.forEach(function(s){var r=k.index("_doc_id_rev"),q=l+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return o()}k["delete"](u);var w=n.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];i.push(x),n["delete"](y.primaryKey),y["continue"]()}else{o()}}}})}function cZ(j,h,g){try{return{txn:j.transaction(h,g)}}catch(i){return{error:i}}}function bk(n,v,k,x,l,m,p){function H(){var P=[e7,dG,cK,dQ,jT],O=cZ(l,P,"readwrite");return O.error?p(O.error):(I=O.txn,I.onabort=fE(p),I.ontimeout=fE(p),I.oncomplete=C,A=I.objectStore(e7),y=I.objectStore(dG),E=I.objectStore(cK),w=I.objectStore(jT),void g(function(Q){return Q?(s=!0,p(Q)):void h()}))}function u(){b1(n.revs_limit,z,x,N,I,L,r,k)}function h(){function Q(){++S===z.length&&u()}function O(W){var V=cO(W.target.result);V&&N.set(V.id,V),Q()}if(z.length){for(var S=0,P=0,R=z.length;R>P;P++){var U=z[P];if(U._id&&aA(U._id)){Q()}else{var T=A.get(U.metadata.id);T.onsuccess=O}}}}function C(){s||(m.notify(x._meta.name),x._meta.docCount+=B,p(null,L))}function j(P,O){var Q=E.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=dX(f1,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(z.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){j(T,function(U){U&&!P&&(P=U),O()})})}function r(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?G(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(an){var ae=X.stemmedRevs||[];R&&x.auto_compaction&&(ae=ae.concat(fB(X.metadata))),ae&&ae.length&&aB(ae,X.metadata.id,I),T.seq=an.target.result,delete T.rev;var ao=bB(T,Q,S),ai=A.put(ao);ai.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=y.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=y.put(V,ar.target.result);ao.onsuccess=W}}function Z(){L[U]={ok:!0,id:T.id,rev:Q},N.set(X.metadata.id,X.metadata),D(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=y.put(V);Y.onsuccess=W,Y.onerror=P}function G(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;q(an,ai,Q)}})}function D(T,Q,V){function S(){++P===O.length&&V()}function U(W){var Y=T.data._attachments[W].digest,X=w.put({seq:Q,digestSeq:Y+"::"+Q});X.onsuccess=S,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),S()}}var P=0,O=Object.keys(T.data._attachments||{});if(!O.length){return V()}for(var R=0;R<O.length;R++){U(O[R])}}function q(Q,O,R){var P=E.count(Q);P.onsuccess=function(T){var U=T.target.result;if(U){return R()}var S={digest:Q,body:O},V=E.put(S);V.onsuccess=R}}for(var I,A,y,E,w,o,z=v.docs,B=0,F=0,J=z.length;J>F;F++){var M=z[F];M._id&&aA(M._id)||(M=z[F]=c9(M,k.new_edits),M.error&&!o&&(o=M))}if(o){return p(o)}var L=new Array(z.length),N=new au.Map,s=!1,i=x._meta.blobSupport?"blob":"base64";fJ(z,i,function(O){return O?p(O):void H()})}function aM(j,h,l,i,k){try{if(j&&h){return k?IDBKeyRange.bound(h,j,!l,!1):IDBKeyRange.bound(j,h,!1,!l)}if(j){return k?IDBKeyRange.upperBound(j):IDBKeyRange.lowerBound(j)}if(h){return k?IDBKeyRange.lowerBound(h,!l):IDBKeyRange.upperBound(h,!l)}if(i){return IDBKeyRange.only(i)}}catch(g){return{error:g}}return null}function aR(j,h,g,i){return"DataError"===g.name&&0===g.code?i(null,{total_rows:j._meta.docCount,offset:h.skip,rows:[]}):void i(dX(eP,g.name,g.message))}function b8(j,h,l,i){function k(o,A){function J(O,N,L){var M=O.id+"::"+L;m.get(M).onsuccess=function(P){N.doc=jM(P.target.result),o.conflicts&&(N.doc._conflicts=bI(O)),bs(N.doc,o,G)}}function v(O,L,P){var N={id:P.id,key:P.id,value:{rev:L}},M=P.deleted;if("ok"===o.deleted){n.push(N),M?(N.value.deleted=!0,N.doc=null):o.include_docs&&J(P,N,L)}else{if(!M&&C--<=0&&(n.push(N),o.include_docs&&J(P,N,L),0===--B)){return}}O["continue"]()}function y(L){K=h._meta.docCount;var N=L.target.result;if(N){var O=cO(N.value),M=O.winningRev;v(N,M,O)}}function s(){A(null,{total_rows:K,offset:o.skip,rows:n})}function u(){o.attachments?c3(n,o.binary).then(s):s()}var I="startkey" in o?o.startkey:!1,F="endkey" in o?o.endkey:!1,z="key" in o?o.key:!1,C=o.skip||0,B="number"==typeof o.limit?o.limit:-1,E=o.inclusive_end!==!1,r="descending" in o&&o.descending?"prev":null,x=aM(I,F,E,z,r);if(x&&x.error){return aR(h,o,x.error,A)}var H=[e7,dG];o.attachments&&H.push(cK);var q=cZ(l,H,"readonly");if(q.error){return A(q.error)}var G=q.txn,p=G.objectStore(e7),D=G.objectStore(dG),w=r?p.openCursor(x,r):p.openCursor(x),m=D.index("_doc_id_rev"),n=[],K=0;G.oncomplete=u,w.onsuccess=y}function g(n,m){return 0===n.limit?m(null,{total_rows:h._meta.docCount,offset:n.skip,rows:[]}):void k(n,m)}g(j,i)}function ay(g){return new cL(function(h){var i=eg([""]);g.objectStore(aH).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function j0(h,g){var i=this;a9.queue.push({action:function(j){bu(i,h,j)},callback:g}),bM(i.constructor)}function bu(h,i,m){function o(x){var w=x.createObjectStore(e7,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(cK,{keyPath:"digest"}),x.createObjectStore(ag,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aH),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(dQ,{keyPath:"_id"});var v=x.createObjectStore(jT,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function p(x,w){var v=x.objectStore(e7);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=cI(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function l(v){v.createObjectStore(dQ,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function g(x,z){var y=x.objectStore(dQ),v=x.objectStore(e7),w=x.objectStore(dG),A=v.openCursor();A.onsuccess=function(K){var H=K.target.result;if(H){var B=H.value,E=B.id,D=aA(E),M=cP(B);if(D){var J=E+"::"+M,G=E+"::",L=E+"::~",I=w.index("_doc_id_rev"),F=IDBKeyRange.bound(G,L,!1,!1),C=I.openCursor(F);C.onsuccess=function(N){if(C=N.target.result){var O=C.value;O._doc_id_rev===J&&y.put(O),w["delete"](C.primaryKey),C["continue"]()}else{v["delete"](H.primaryKey),H["continue"]()}}}else{H["continue"]()}}else{z&&z()}}}function q(w){var v=w.createObjectStore(jT,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function s(x,z){var y=x.objectStore(dG),v=x.objectStore(cK),w=x.objectStore(jT),A=v.count();A.onsuccess=function(B){var C=B.target.result;return C?void (y.openCursor().onsuccess=function(E){var K=E.target.result;if(!K){return z()}for(var J=K.value,M=K.primaryKey,G=Object.keys(J._attachments||{}),I={},H=0;H<G.length;H++){var F=J._attachments[G[H]];I[F.digest]=!0}var D=Object.keys(I);for(H=0;H<D.length;H++){var L=D[H];w.put({seq:M,digestSeq:L+"::"+M})}K["continue"]()}):z()}}function j(y){function z(A){return A.data?cO(A):(A.deleted="1"===A.deletedOrLocal,A)}var x=y.objectStore(dG),w=y.objectStore(e7),v=w.openCursor();v.onsuccess=function(C){function D(){var H=A.id+"::",F=A.id+"::￿",G=x.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,B()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function B(){var G=bB(A,A.winningRev,A.deleted),F=w.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var A=z(E.value);return A.winningRev=A.winningRev||cP(A),A.seq?B():void D()}}}var n=i.name,k=null;h._meta=null,h.type=function(){return"idb"},h._id=dy(function(v){v(null,h._meta.instanceId)}),h._bulkDocs=function(v,w,x){bk(i,v,w,h,k,aW,x)},h._get=function(v,z,y){function C(){y(w,{doc:D,metadata:B,ctx:A})}var D,B,w,A=z.ctx;if(!A){var x=cZ(k,[e7,dG,cK],"readonly");if(x.error){return y(x.error)}A=x.txn}A.objectStore(e7).get(v).onsuccess=function(E){if(B=cO(E.target.result),!B){return w=dX(b2,"missing"),C()}if(cI(B)&&!z.rev){return w=dX(b2,"deleted"),C()}var G=A.objectStore(dG),H=z.rev||B.winningRev,F=B.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return D=I.target.result,D&&(D=jM(D)),D?void C():(w=dX(b2,"missing"),C())}}},h._getAttachment=function(v,z,y,C,D){var B;if(C.ctx){B=C.ctx}else{var w=cZ(k,[e7,dG,cK],"readonly");if(w.error){return D(w.error)}B=w.txn}var A=y.digest,x=y.content_type;B.objectStore(cK).get(A).onsuccess=function(E){var F=E.target.result.body;cR(F,x,C.binary,function(G){D(null,G)})}},h._info=function(A){if(null===k||!c7.has(n)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,w,B=cZ(k,[dG],"readonly");if(B.error){return A(B.error)}var z=B.txn,x=z.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,w=h._meta.docCount},z.oncomplete=function(){A(null,{doc_count:w,update_seq:v,idb_attachment_format:h._meta.blobSupport?"binary":"base64"})}},h._allDocs=function(v,w){b8(v,h,k,w)},h._changes=function(E){function B(N){function T(){return S.seq!==O?N["continue"]():(M=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=z.get(U);V.onsuccess=function(W){R(jM(W.target.result))}}function R(V){var W=E.processChange(V,S,E);W.seq=S.seq;var U=I(W);return"object"==typeof U?E.complete(U):(U&&(J++,x&&G.push(W),E.attachments&&E.include_docs?bs(V,E,L,function(){c3([W],E.binary).then(function(){E.onChange(W)})}):E.onChange(W)),void (J!==w&&N["continue"]()))}var P=jM(N.value),O=N.key;if(F&&!F.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (H.get(P._id).onsuccess=function(U){S=cO(U.target.result),y.set(P._id,S),T()})}function K(N){var O=N.target.result;O&&B(O)}function D(){var P=[e7,dG];E.attachments&&P.push(cK);var O=cZ(k,P,"readonly");if(O.error){return E.complete(O.error)}L=O.txn,L.onabort=fE(E.complete),L.oncomplete=A,C=L.objectStore(dG),H=L.objectStore(e7),z=C.index("_doc_id_rev");var N;N=E.descending?C.openCursor(null,"prev"):C.openCursor(IDBKeyRange.lowerBound(E.since,!0)),N.onsuccess=K}function A(){function N(){E.complete(null,{results:G,last_seq:M})}!E.continuous&&E.attachments?c3(G).then(N):N()}if(E=aU(E),E.continuous){var v=n+":"+bi();return aW.addListener(n,v,h,E),aW.notify(n),{cancel:function(){aW.removeListener(n,v)}}}var F=E.doc_ids&&new au.Set(E.doc_ids);E.since=E.since||0;var M=E.since,w="limit" in E?E.limit:-1;0===w&&(w=1);var x;x="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var L,C,H,z,G=[],J=0,I=d2(E),y=new au.Map;D()},h._close=function(v){return null===k?v(dX(bz)):(k.close(),c7["delete"](n),k=null,void v())},h._getRevisionTree=function(y,z){var x=cZ(k,[e7],"readonly");if(x.error){return z(x.error)}var w=x.txn,v=w.objectStore(e7).get(y);v.onsuccess=function(B){var A=cO(B.target.result);A?z(null,A.rev_tree):z(dX(b2))}},h._doCompaction=function(y,A,w){var x=[e7,dG,cK,jT],v=cZ(k,x,"readwrite");if(v.error){return w(v.error)}var B=v.txn,z=B.objectStore(e7);z.get(y).onsuccess=function(E){var C=cO(E.target.result);dd(C.rev_tree,function(I,K,H,J,G){var L=K+"-"+H;-1!==A.indexOf(L)&&(G.status="missing")}),aB(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(e7).put(bB(C,D,F))},B.onabort=fE(w),B.oncomplete=function(){w()}},h._getLocal=function(y,z){var x=cZ(k,[dQ],"readonly");if(x.error){return z(x.error)}var w=x.txn,v=w.objectStore(dQ).get(y);v.onerror=fE(z),v.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,z(null,A)):z(dX(b2))}},h._putLocal=function(z,E,C){"function"==typeof E&&(C=E,E={}),delete z._revisions;var x=z._rev,y=z._id;x?z._rev="0-"+(parseInt(x.split("-")[1],10)+1):z._rev="0-1";var w,B=E.ctx;if(!B){var v=cZ(k,[dQ],"readwrite");if(v.error){return C(v.error)}B=v.txn,B.onerror=fE(C),B.oncomplete=function(){w&&C(null,w)}}var D,A=B.objectStore(dQ);x?(D=A.get(y),D.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===x){var F=A.put(z);F.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)}}else{C(dX(eW))}}):(D=A.add(z),D.onerror=function(F){C(dX(eW)),F.preventDefault(),F.stopPropagation()},D.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)})},h._removeLocal=function(v,z,y){"function"==typeof z&&(y=z,z={});var C=z.ctx;if(!C){var D=cZ(k,[dQ],"readwrite");if(D.error){return y(D.error)}C=D.txn,C.oncomplete=function(){B&&y(null,B)}}var B,w=v._id,A=C.objectStore(dQ),x=A.get(w);x.onerror=fE(y),x.onsuccess=function(F){var E=F.target.result;E&&E._rev===v._rev?(A["delete"](w),B={ok:!0,id:w,rev:"0-0"},z.ctx&&y(null,B)):y(dX(b2))}},h._destroy=function(v,x){aW.removeAllListeners(n);var w=cW.get(n);w&&w.result&&(w.result.close(),c7["delete"](n));var y=indexedDB.deleteDatabase(n);y.onsuccess=function(){cW["delete"](n),eB()&&n in localStorage&&delete localStorage[n],x(null,{ok:!0})},y.onerror=fE(x)};var u=c7.get(n);if(u){return k=u.idb,h._meta=u.global,void eO.nextTick(function(){m(null,h)})}var r;r=i.storage?b4(n,i.storage):indexedDB.open(n,cA),cW.set(n,r),r.onupgradeneeded=function(z){function x(){var B=w[A-1];A++,B&&B(y,x)}var v=z.target.result;if(z.oldVersion<1){return o(v)}var y=z.currentTarget.transaction;z.oldVersion<3&&l(v),z.oldVersion<4&&q(v);var w=[p,g,s,j],A=z.oldVersion;x()},r.onsuccess=function(v){k=v.target.result,k.onversionchange=function(){k.close(),c7["delete"](n)},k.onabort=function(B){c1("error","Database has a global failure",B.target.error),k.close(),c7["delete"](n)};var y=k.transaction([ag,aH,e7],"readwrite"),w=y.objectStore(ag).get(ag),z=null,x=null,A=null;w.onsuccess=function(D){var B=function(){null!==z&&null!==x&&null!==A&&(h._meta={name:n,instanceId:A,blobSupport:z,docCount:x},c7.set(n,{idb:k,global:h._meta}),m(null,h))},E=D.target.result||{id:ag};n+"_id" in E?(A=E[n+"_id"],B()):(A=bi(),E[n+"_id"]=A,y.objectStore(ag).put(E).onsuccess=function(){B()}),kd||(kd=ay(y)),kd.then(function(F){z=F,B()});var C=y.objectStore(e7).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){x=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";c1("error",v),m(dX(eP,v))}}function b4(h,g){try{return indexedDB.open(h,{version:cA,storage:g})}catch(i){return indexedDB.open(h,cA)}}function al(g){g.adapter("idb",j0,!0)}function aq(g){return decodeURIComponent(escape(g))}function aw(g){return 65>g?g-48:g-55}function aG(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(aw(j.charCodeAt(h++))<<4|aw(j.charCodeAt(h++)))}return i}function bf(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(aw(j.charCodeAt(h+2))<<12|aw(j.charCodeAt(h+3))<<8|aw(j.charCodeAt(h))<<4|aw(j.charCodeAt(h+1))),h+=4}return i}function bh(g,h){return"UTF-8"===h?aq(aG(g,0,g.length)):bf(g,0,g.length)}function cw(g){return"'"+g+"'"}function am(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cH(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aS(g){return delete g._id,delete g._rev,JSON.stringify(g)}function aV(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function dM(g){for(var h="(";g--;){h+="?",g&&(h+=",")}return h+")"}function cy(i,g,k,h,j){return"SELECT "+i+" FROM "+("string"==typeof g?g:g.join(" JOIN "))+(k?" ON "+k:"")+(h?" WHERE "+("string"==typeof h?h:h.join(" AND ")):"")+(j?" ORDER BY "+j:"")}function b5(l,j,g){function k(){++i===l.length&&m()}function m(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+bL+" WHERE seq IN "+dM(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+bL+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(u){var v="SELECT digest FROM "+bL+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";u.executeSql(v,s,function(x,y){for(var w=new au.Set,z=0;z<y.rows.length;z++){w.add(y.rows.item(z).digest)}s.forEach(function(A){w.has(A)||(x.executeSql("DELETE FROM "+bL+" WHERE digest=?",[A]),x.executeSql("DELETE FROM "+aJ+" WHERE digest=?",[A]))})})})}})}}if(l.length){var i=0,h=[];l.forEach(function(n){var o="SELECT seq FROM "+ej+" WHERE doc_id=? AND rev=?";g.executeSql(o,[j,n],function(q,p){if(!p.rows.length){return k()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+ej+" WHERE seq=?",[r],k)})})}}function dl(g){return function(h){c1("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(dX(d6,j,i))}}function c5(g){if("size" in g){return 1000000*g.size}var h="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return h?5000000:1}function bY(j,q,n,k,m,x,h){function i(){return r?h(r):(x.notify(k._name),k._docCount=-1,void h(null,A))}function l(E,D){var F="SELECT count(*) as cnt FROM "+aJ+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=dX(f1,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function s(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){l(I,function(J){J&&!E&&(E=J),D()})})}function u(J,R,M,H,F,O,E,Q){function L(){function V(ar,a0){function at(){return ++ae===ao.length&&a0(),!1}function ai(a1){var a2="INSERT INTO "+bL+" (digest, seq) VALUES (?,?)",a3=[U._attachments[a1].digest,ar];p.executeSql(a2,a3,at,at)}var ae=0,ao=Object.keys(U._attachments||{});if(!ao.length){return a0()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var U=J.data,X=H?1:0,S=U._id,W=U._rev,Y=aS(U),Z="INSERT INTO "+ej+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",T=[S,W,Y,X];p.executeSql(Z,T,function(an,ai){var ae=ai.insertId;V(ae,function(){K(an,ae)})},function(){var ae=cy("seq",ej,null,"doc_id=? AND rev=?");return p.executeSql(ae,[S,W],function(ar,ai){var an=ai.rows.item(0).seq,ao="UPDATE "+ej+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[Y,X,S,W];ar.executeSql(ao,at,function(a0){V(an,function(){K(a0,an)})})}),!1})}function I(S){G||(S?(G=S,Q(G)):P===N.length&&L())}function D(S){P++,I(S)}function K(U,T){var W=J.metadata.id,V=J.stemmedRevs||[];F&&k.auto_compaction&&(V=fB(J.metadata).concat(V)),V.length&&b5(V,W,U),J.metadata.seq=T,delete J.metadata.rev;var X=F?"UPDATE "+bX+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+ej+" WHERE doc_id="+bX+".id AND rev=?) WHERE id=?":"INSERT INTO "+bX+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Y=aa(J.metadata),S=F?[Y,T,R,W]:[W,T,T,Y];U.executeSql(X,S,function(){A[E]={ok:!0,id:J.metadata.id,rev:R},w.set(W,J.metadata),Q()})}var G=null,P=0;J.data._id=J.metadata.id,J.data._rev=J.metadata.rev;var N=Object.keys(J.data._attachments||{});H&&(J.data._deleted=!0),N.forEach(function(S){var U=J.data._attachments[S];if(U.stub){P++,I()}else{var V=U.data;delete U.data,U.revpos=parseInt(R,10);var T=U.digest;B(T,V,D)}}),N.length||L()}function z(){b1(j.revs_limit,o,k,w,p,A,u,n)}function g(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&aA(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+bX+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=cp(I.rows.item(0).json);w.set(H,K)}D()})})}function B(F,D,G){var E="SELECT digest FROM "+aJ+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+aJ+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,am(D)],function(){G()},function(){return G(),!1}))})}var y=n.new_edits,C=q.docs,o=C.map(function(E){if(E._id&&aA(E._id)){return E}var D=c9(E,y);return D}),v=o.filter(function(D){return D.error});if(v.length){return h(v[0])}var p,r,A=new Array(o.length),w=new au.Map;fJ(o,"binary",function(D){return D?h(D):void m.transaction(function(E){p=E,s(function(F){F?r=F:g(z)})},dl(h),i)})}function dW(g){return g.websql(g.name,g.version,g.description,g.size)}function cB(g){try{return{db:dW(g)}}catch(h){return{error:h}}}function cQ(g){var h=dx.get(g.name);return h||(h=cB(g),dx.set(g.name,h),h.db&&(h.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),h}function jL(g,i,o,l,n){function h(){++m===k.length&&n&&n()}function j(q,s){var r=q._attachments[s],p={binary:i.binary,ctx:l};o._getAttachment(q._id,s,r,p,function(v,u){q._attachments[s]=dm.extend(e4(r,["digest","content_type"]),{data:u}),h()})}var k=Object.keys(g._attachments||{});if(!k.length){return n&&n()}var m=0;k.forEach(function(p){i.attachments&&i.include_docs?j(g,p):(g._attachments[p].stub=!0,h())})}function fP(v,m){function C(){eB()&&(window.localStorage["_pouch__websqldb_"+x._name]=!0),m(null,x)}function n(F,E){F.executeSql(ab),F.executeSql("ALTER TABLE "+ej+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(j6),F.executeSql("ALTER TABLE "+bX+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+bX+" (local, id)");var G="SELECT "+bX+".winningseq AS seq, "+bX+".json AS metadata FROM "+ej+" JOIN "+bX+" ON "+ej+".seq = "+bX+".winningseq";F.executeSql(G,[],function(N,J){for(var M=[],H=[],I=0;I<J.rows.length;I++){var K=J.rows.item(I),L=K.seq,O=JSON.parse(K.metadata);cI(O)&&M.push(L),aA(O.id)&&H.push(O.id)}N.executeSql("UPDATE "+bX+"SET local = 1 WHERE id IN "+dM(H.length),H,function(){N.executeSql("UPDATE "+ej+" SET deleted = 1 WHERE seq IN "+dM(M.length),M,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+dL+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+bX+".id AS id, "+ej+".json AS data FROM "+ej+" JOIN "+bX+" ON "+ej+".seq = "+bX+".winningseq WHERE local = 1";F.executeSql(H,[],function(J,L){function I(){if(!K.length){return E(J)}var O=K.shift(),N=JSON.parse(O.data)._rev;J.executeSql("INSERT INTO "+dL+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+bX+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+ej+" WHERE seq=?",[O.seq],function(){I()})})})}for(var K=[],M=0;M<L.rows.length;M++){K.push(L.rows.item(M))}I()})})}function h(G,E){function H(I){function J(){if(!I.length){return E(G)}var L=I.shift(),P=bh(L.hex,k),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+ej+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){J()})}J()}var F="ALTER TABLE "+ej+" ADD COLUMN doc_id";G.executeSql(F,[],function(I){var J="ALTER TABLE "+ej+" ADD COLUMN rev";I.executeSql(J,[],function(K){K.executeSql(cv,[],function(M){var L="SELECT hex(doc_id_rev) as hex FROM "+ej;M.executeSql(L,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function B(G,E){function H(J){var I="SELECT COUNT(*) AS cnt FROM "+aJ;J.executeSql(I,[],function(K,M){function P(){var Q=cy(jK+", "+bX+".id AS id",[bX,ej],cg,null,bX+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,T){function X(at,ar){var ao=V[at]=V[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!T.rows.length){return E(ai)}for(var V={},an=0;an<T.rows.length;an++){for(var S=T.rows.item(an),R=aV(S.data,S.id,S.rev),W=Object.keys(R._attachments||{}),Z=0;Z<W.length;Z++){var U=R._attachments[W[Z]];X(U.digest,S.seq)}}var Y=[];if(Object.keys(V).forEach(function(ar){var ao=V[ar];ao.forEach(function(at){Y.push([ar,at])})}),!Y.length){return P()}var ae=0;Y.forEach(function(ao){var ar="INSERT INTO "+bL+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++ae===Y.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+bL+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(kf,[],function(J){J.executeSql(el,[],H)})})}function D(F,E){var G="ALTER TABLE "+aJ+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+bX+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+bX+" SET max_seq=(SELECT MAX(seq) FROM "+ej+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+bX+" (max_seq)";J.executeSql(K,[],E)})})}function w(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;k=2===H.length?"UTF-8":"UTF-16",E()})}function y(){for(;z.length>0;){var E=z.pop();E(null,o)}}function s(H,P){if(0===P){var M="CREATE TABLE IF NOT EXISTS "+bT+" (dbid, db_version INTEGER)",J="CREATE TABLE IF NOT EXISTS "+aJ+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",G="CREATE TABLE IF NOT EXISTS "+bL+" (digest, seq INTEGER)",E="CREATE TABLE IF NOT EXISTS "+bX+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",F="CREATE TABLE IF NOT EXISTS "+ej+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",L="CREATE TABLE IF NOT EXISTS "+dL+" (id UNIQUE, rev, json)";H.executeSql(J),H.executeSql(L),H.executeSql(G,[],function(){H.executeSql(el),H.executeSql(kf)}),H.executeSql(E,[],function(){H.executeSql(ab),H.executeSql(F,[],function(){H.executeSql(j6),H.executeSql(cv),H.executeSql(M,[],function(){var R="INSERT INTO "+bT+" (db_version, dbid) VALUES (?,?)";o=bi();var Q=[cN,o];H.executeSql(R,Q,function(){y()})})})})}else{var N=function(){var Q=cN>P;Q&&H.executeSql("UPDATE "+bT+" SET db_version = "+cN);var R="SELECT dbid FROM "+bT;H.executeSql(R,[],function(T,S){o=S.rows.item(0).dbid,y()})},K=[n,p,h,B,D,r,N],I=P,O=function(Q){K[I-1](Q,O),I++};O(H)}}function g(){i.transaction(function(E){w(E,function(){A(E)})},dl(m),C)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+bT;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+bT,[],function(J,I){var K=I.rows.item(0).db_version;s(J,K)}):H.executeSql("ALTER TABLE "+bT+" ADD COLUMN db_version INTEGER",[],function(){s(H,1)}):s(H,0)})}function j(F,E){if(-1!==x._docCount){return E(x._docCount)}var G=cy("COUNT("+bX+".id) AS 'num'",[bX,ej],cg,ej+".deleted=0");F.executeSql(G,[],function(I,H){x._docCount=H.rows.item(0).num,E(x._docCount)})}var k,x=this,o=null,u=c5(v),z=[];x._docCount=-1,x._name=v.name;var l=dm.extend({},v,{version:aF,description:v.name,size:u}),q=cQ(l);if(q.error){return dl(m)(q.error)}var i=q.db;"function"!=typeof i.readTransaction&&(i.readTransaction=i.transaction),g(),x.type=function(){return"websql"},x._id=dy(function(E){E(null,o)}),x._info=function(E){i.readTransaction(function(F){j(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+ej;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:i._sqlitePlugin,websql_encoding:k})})})},dl(E))},x._bulkDocs=function(E,G,F){bY(v,E,G,x,i,f4,F)},x._get=function(I,J,G){function N(){G(L,{doc:E,metadata:H,ctx:F})}var E,H,L,F=J.ctx;if(!F){return i.readTransaction(function(O){x._get(I,dm.extend({ctx:O},J),G)})}var M,K;J.rev?(M=cy(jK,[bX,ej],bX+".id="+ej+".doc_id",[ej+".doc_id=?",ej+".rev=?"]),K=[I,J.rev]):(M=cy(jK,[bX,ej],cg,bX+".id=?"),K=[I]),F.executeSql(M,K,function(O,P){if(!P.rows.length){return L=dX(b2,"missing"),N()}var Q=P.rows.item(0);return H=cp(Q.metadata),Q.deleted&&!J.rev?(L=dX(b2,"deleted"),N()):(E=aV(Q.data,H.id,Q.rev),void N())})},x._allDocs=function(L,H){var I,P=[],R="startkey" in L?L.startkey:!1,M="endkey" in L?L.endkey:!1,F="key" in L?L.key:!1,J="descending" in L?L.descending:!1,G="limit" in L?L.limit:-1,E="skip" in L?L.skip:0,O=L.inclusive_end!==!1,K=[],Q=[];if(F!==!1){Q.push(bX+".id = ?"),K.push(F)}else{if(R!==!1||M!==!1){if(R!==!1&&(Q.push(bX+".id "+(J?"<=":">=")+" ?"),K.push(R)),M!==!1){var N=J?">":"<";O&&(N+="="),Q.push(bX+".id "+N+" ?"),K.push(M)}F!==!1&&(Q.push(bX+".id = ?"),K.push(F))}}"ok"!==L.deleted&&Q.push(ej+".deleted = 0"),i.readTransaction(function(S){j(S,function(T){if(I=T,0!==G){var U=cy(jK,[bX,ej],cg,Q,bX+".id "+(J?"DESC":"ASC"));U+=" LIMIT "+G+" OFFSET "+E,S.executeSql(U,K,function(W,Z){for(var Y=0,ao=Z.rows.length;ao>Y;Y++){var V=Z.rows.item(Y),X=cp(V.metadata),an=X.id,ar=aV(V.data,an,V.rev),ai=ar._rev,ae={id:an,key:an,value:{rev:ai}};if(L.include_docs&&(ae.doc=ar,ae.doc._rev=ai,L.conflicts&&(ae.doc._conflicts=bI(X)),jL(ae.doc,L,x,W)),V.deleted){if("ok"!==L.deleted){continue}ae.value.deleted=!0,ae.doc=null}P.push(ae)}})}})},dl(H),function(){H(null,{total_rows:I,offset:L.skip,rows:P})})},x._changes=function(J){function K(){var S=bX+".json AS metadata, "+bX+".max_seq AS maxSeq, "+ej+".json AS winningDoc, "+ej+".rev AS winningRev ",T=bX+" JOIN "+ej,R=bX+".id="+ej+".doc_id AND "+bX+".winningseq="+ej+".seq",Q=["maxSeq > ?"],O=[J.since];J.doc_ids&&(Q.push(bX+".id IN "+dM(J.doc_ids.length)),O=O.concat(J.doc_ids));var U="maxSeq "+(G?"DESC":"ASC"),N=cy(S,T,R,Q,U),M=d2(J);J.view||J.filter||(N+=" LIMIT "+L);var P=J.since||0;i.readTransaction(function(V){V.executeSql(N,O,function(an,ao){function ai(a0){return function(){J.onChange(a0)}}for(var X=0,at=ao.rows.length;at>X;X++){var ar=ao.rows.item(X),W=cp(ar.metadata);P=ar.maxSeq;var ae=aV(ar.winningDoc,W.id,ar.winningRev),Z=J.processChange(ae,W,J);Z.seq=ar.maxSeq;var Y=M(Z);if("object"==typeof Y){return J.complete(Y)}if(Y&&(F++,I&&H.push(Z),J.attachments&&J.include_docs?jL(ae,J,x,an,ai(Z)):ai(Z)()),F===L){break}}})},dl(J.complete),function(){J.continuous||J.complete(null,{results:H,last_seq:P})})}if(J=aU(J),J.continuous){var E=x._name+":"+bi();return f4.addListener(x._name,E,x,J),f4.notify(x._name),{cancel:function(){f4.removeListener(x._name,E)}}}var G=J.descending;J.since=J.since&&!G?J.since:0;var L="limit" in J?J.limit:-1;0===L&&(L=1);var I;I="return_docs" in J?J.return_docs:"returnDocs" in J?J.returnDocs:!0;var H=[],F=0;K()},x._close=function(E){E()},x._getAttachment=function(I,J,G,N,E){var H,L=N.ctx,F=G.digest,M=G.content_type,K="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+aJ+" WHERE digest=?";L.executeSql(K,[F],function(P,O){var Q=O.rows.item(0),R=Q.escaped?cH(Q.body):bh(Q.body,k);H=N.binary?jW(R,M):dV(R),E(null,H)})},x._getRevisionTree=function(F,E){i.readTransaction(function(H){var G="SELECT json AS metadata FROM "+bX+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=cp(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(dX(b2))}})})},x._doCompaction=function(F,E,G){return E.length?void i.transaction(function(H){var I="SELECT json AS metadata FROM "+bX+" WHERE id = ?";H.executeSql(I,[F],function(M,K){var L=cp(K.rows.item(0).metadata);dd(L.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var J="UPDATE "+bX+" SET json = ? WHERE id = ?";M.executeSql(J,[aa(L),F])}),b5(E,F,H)},dl(G),function(){G()}):G()},x._getLocal=function(F,E){i.readTransaction(function(H){var G="SELECT json, rev FROM "+dL+" WHERE id=?";H.executeSql(G,[F],function(I,K){if(K.rows.length){var L=K.rows.item(0),J=aV(L.json,F,L.rev);E(null,J)}else{E(dX(b2))}})})},x._putLocal=function(M,H,K){function I(N){var P,O;L?(P="UPDATE "+dL+" SET rev=?, json=? WHERE id=? AND rev=?",O=[J,G,F,L]):(P="INSERT INTO "+dL+" (id, rev, json) VALUES (?,?,?)",O=[F,J,G]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(E={ok:!0,id:F,rev:J},H.ctx&&K(null,E)):K(dX(eW))},function(){return K(dX(eW)),!1})}"function"==typeof H&&(K=H,H={}),delete M._revisions;var J,L=M._rev,F=M._id;J=L?M._rev="0-"+(parseInt(L.split("-")[1],10)+1):M._rev="0-1";var E,G=aS(M);H.ctx?I(H.ctx):i.transaction(I,dl(K),function(){E&&K(null,E)})},x._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+dL+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(dX(b2))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):i.transaction(G,dl(E),function(){I&&E(null,I)})},x._destroy=function(F,E){f4.removeAllListeners(x._name),i.transaction(function(H){var G=[bX,ej,aJ,bT,dL,bL];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},dl(E),function(){eB()&&(delete window.localStorage["_pouch__websqldb_"+x._name],delete window.localStorage[x._name]),E(null,{ok:!0})})}}function bU(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cb(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=eB(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=bU();return h&&(localStorage[g]=i?"1":"0"),i}function af(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cb()}function ek(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=dm.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function cV(j,h){var g=ek(j),i=dm.extend({websql:g},j);fP.call(this,i,h)}function jF(g){g.adapter("websql",cV,!0)}function cF(){for(var j={},h=new cL(function(k,l){j.resolve=k,j.reject=l}),g=new Array(arguments.length),i=0;i<g.length;i++){g[i]=arguments[i]}return j.promise=h,cL.resolve().then(function(){return fetch.apply(null,g)}).then(function(k){j.resolve(k)})["catch"](function(k){j.reject(k)}),j}function fN(l,j){var g,k,m,i=new Headers,h={method:l.method,credentials:"include",headers:i};return l.json&&(i.set("Accept","application/json"),i.set("Content-Type",l.headers["Content-Type"]||"application/json")),l.body&&l.body instanceof Blob?dz(l.body,function(n){h.body=n}):l.body&&l.processData&&"string"!=typeof l.body?h.body=JSON.stringify(l.body):"body" in l?h.body=l.body:h.body=null,Object.keys(l.headers).forEach(function(n){l.headers.hasOwnProperty(n)&&i.set(n,l.headers[n])}),g=cF(l.url,h),l.timeout>0&&(k=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+l.url))},l.timeout)),g.promise.then(function(n){return m={statusCode:n.status},l.timeout>0&&clearTimeout(k),m.statusCode>=200&&m.statusCode<300?l.binary?n.blob():n.text():n.json()}).then(function(n){m.statusCode>=200&&m.statusCode<300?j(null,m,n):j(n,m)})["catch"](function(n){j(n,m)}),{abort:g.reject}}function bK(g,i){var o,l,n=!1,h=function(){o.abort()},j=function(){n=!0,o.abort()};o=g.xhr?new g.xhr:new XMLHttpRequest;try{o.open(g.method,g.url)}catch(k){i(k,{statusCode:413})}o.withCredentials="withCredentials" in g?g.withCredentials:!0,"GET"===g.method?delete g.headers["Content-Type"]:g.json&&(g.headers.Accept="application/json",g.headers["Content-Type"]=g.headers["Content-Type"]||"application/json",g.body&&g.processData&&"string"!=typeof g.body&&(g.body=JSON.stringify(g.body))),g.binary&&(o.responseType="arraybuffer"),"body" in g||(g.body=null);for(var m in g.headers){g.headers.hasOwnProperty(m)&&o.setRequestHeader(m,g.headers[m])}return g.timeout>0&&(l=setTimeout(j,g.timeout),o.onprogress=function(){clearTimeout(l),4!==o.readyState&&(l=setTimeout(j,g.timeout))},"undefined"!=typeof o.upload&&(o.upload.onprogress=o.onprogress)),o.onreadystatechange=function(){if(4===o.readyState){var s={statusCode:o.status};if(o.status>=200&&o.status<300){var q;q=g.binary?eg([o.response||""],{type:o.getResponseHeader("Content-Type")}):o.responseText,i(null,s,q)}else{var p={};if(n){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(o.response)}catch(r){}}i(p,s)}}},g.body&&g.body instanceof Blob?dz(g.body,function(p){o.send(p)}):o.send(g.body),{abort:h}}function dT(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function bC(g,h){return jS||g.xhr?bK(g,h):fN(g,h)}function jZ(){return""}function e1(i,g){function k(m,l,n){if(!i.binary&&i.json&&"string"==typeof m){try{m=JSON.parse(m)}catch(o){return n(o)}}Array.isArray(m)&&(m=m.map(function(p){return p.error||p.missing?bH(p):p})),i.binary&&aN(m,l),n(null,m,l)}function h(l,p){var n,q;if(l.code&&l.status){var m=new Error(l.message||l.code);return m.status=l.status,p(m)}if(l.message&&"ETIMEDOUT"===l.message){return p(l)}try{n=JSON.parse(l.responseText),q=bH(n)}catch(o){q=bH(l)}p(q)}i=aU(i);var j={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return i=dm.extend(j,i),i.json&&(i.binary||(i.headers.Accept="application/json"),i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),i.binary&&(i.encoding=null,i.json=!1),i.processData||(i.json=!1),bC(i,function(m,q,o){if(m){return m.status=q?q.statusCode:400,h(m,g)}var r,p=q.headers&&q.headers["content-type"],n=o||jZ();if(!i.binary&&(i.json||!i.processData)&&"object"!=typeof n&&(/json/.test(p)||/^[\s]*\{/.test(n)&&/\}[\s]*$/.test(n))){try{n=JSON.parse(n.toString())}catch(l){}}q.statusCode>=200&&q.statusCode<300?k(n,q,g):(r=bH(n),r.status=q.statusCode,g(r))})}function eL(j,l){var h=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",o=-1!==h.indexOf("safari")&&-1===h.indexOf("chrome"),g=-1!==h.indexOf("msie"),i=-1!==h.indexOf("edge"),k=o||(g||i)&&"GET"===j.method,m="cache" in j?j.cache:!0,n=/^blob:/.test(j.url);if(!n&&(k||!m)){var p=-1!==j.url.indexOf("?");j.url+=(p?"&":"?")+"_nonce="+Date.now()}return e1(j,l)}function eV(g){var h=g.doc&&g.doc._attachments;h&&Object.keys(h).forEach(function(i){var j=h[i];j.data=e(j.data,j.content_type)})}function kc(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function f8(g){return g._attachments&&Object.keys(g._attachments)?cL.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new cL(function(j){aO(i.data,j)}).then(function(j){i.data=j}):void 0})):cL.resolve()}function dI(h){var g=cU(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function cj(g,h){return jQ(g,g.db+"/"+h)}function jQ(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function ep(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function a8(h,j){function p(A,z,x){var y=A.ajax||{},B=dm.extend(aU(l),y,z);return b7(B.method+" "+B.url),w._ajax(B,x)}function k(y,x){return new cL(function(z,A){p(y,x,function(C,B){return C?A(C):void z(B)})})}function v(y,x){return eC(y,dO(function(z){o().then(function(){return x.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function o(){if(h.skipSetup||h.skip_setup){return cL.resolve()}if(i){return i}var x={method:"GET",url:u};return i=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(ch(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:u})):cL.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:cL.reject(y)}),i["catch"](function(){i=null}),i}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,s=dI;h.getHost&&(s=h.getHost);var m=s(h.name,h),u=cj(m,"");h=aU(h);var l=h.ajax||{};if(w.getUrl=function(){return u},w.getHeaders=function(){return l.headers||{}},h.auth||m.auth){var r=h.auth||m.auth,n=r.username+":"+r.password,g=dV(unescape(encodeURIComponent(n)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var i;setTimeout(function(){j(null,w)}),w.type=function(){return"http"},w.id=v("id",function(x){p({},{method:"GET",url:jQ(m,"")},function(y,A){var z=A&&A.uuid?A.uuid+m.db:cj(m,"");x(null,z)})}),w.request=v("request",function(y,x){y.url=cj(m,y.url),p({},y,x)}),w.compact=v("compact",function(y,x){"function"==typeof y&&(x=y,y={}),y=aU(y),p(y,{url:cj(m,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?x(null,{ok:!0}):setTimeout(z,y.interval||200)})}z()})}),w.bulkGet=eC("bulkGet",function(y,C){function B(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:cj(m,"_bulk_get"+ep(E)),method:"POST",body:{docs:y.docs}},F)}function A(){function G(L){return function(M,N){J[L]=N.results,++H===E&&C(null,{results:aQ(J)})}}for(var K=cT,E=Math.ceil(y.docs.length/K),H=0,J=new Array(E),I=0;E>I;I++){var F=e4(y,["revs","attachments"]);F.ajax=l,F.docs=y.docs.slice(I*K,Math.min(y.docs.length,(I+1)*K)),ds(D,F,G(I))}}var D=this,x=jQ(m,""),z=dB[x];"boolean"!=typeof z?B(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(dB[x]=!1,ch(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),A()):C(E)}else{dB[x]=!0,C(null,F)}}):z?B(C):A()}),w._info=function(x){o().then(function(){p({},{method:"GET",url:cj(m,"")},function(y,z){return y?x(y):(z.host=cj(m,""),void x(null,z))})})["catch"](x)},w.get=v("get",function(C,y,B){function A(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?cL.all(E.map(function(J){var H=G[J],I=kc(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:cj(m,I),binary:!0}).then(function(K){return y.binary?K:new cL(function(L){aO(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?cL.all(E.map(function(F){return F.ok?A(F.ok):void 0})):A(E)}"function"==typeof y&&(B=y,y={}),y=aU(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=kc(C);var x={method:"GET",url:cj(m,C+ep(z))};k(y,x).then(function(E){return cL.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){B(null,E)})})["catch"](B)}),w.remove=v("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:cj(m,kc(C._id))+"?rev="+y},A)}),w.getAttachment=v("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=cj(m,kc(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=v("removeAttachment",function(A,z,y,x){var B=cj(m,kc(A)+"/"+q(z))+"?rev="+y;p({},{method:"DELETE",url:B},x)}),w.putAttachment=v("putAttachment",function(A,E,G,H,y,F){"function"==typeof y&&(F=y,y=H,H=G,G=null);var D=kc(A)+"/"+q(E),C=cj(m,D);if(G&&(C+="?rev="+G),"string"==typeof H){var x;try{x=c2(H)}catch(B){return F(dX(e6,"Attachment is not a valid base64 string"))}H=x?jW(x,y):""}var z={headers:{"Content-Type":y},method:"PUT",url:C,processData:!1,body:H,timeout:l.timeout||60000};p({},z,F)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,o().then(function(){return cL.all(x.docs.map(f8))}).then(function(){p(y,{method:"POST",url:cj(m,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=v("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=aU(C);var B,A={},D="GET";C.conflicts&&(A.conflicts=!0),C.descending&&(A.descending=!0),C.include_docs&&(A.include_docs=!0),C.attachments&&(A.attachments=!0),C.key&&(A.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(A.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(A.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(A.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(A.limit=C.limit),"undefined"!=typeof C.skip&&(A.skip=C.skip);var x=ep(A);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=az?x+="&"+z:(D="POST",B={keys:C.keys})}k(C,{method:D,url:cj(m,"_all_docs"+x),body:B}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:bg;H=aU(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var y in H.query_params){H.query_params.hasOwnProperty(y)&&(D[y]=H.query_params[y])}}var F,z="GET";if(H.doc_ids){D.filter="_doc_ids";var K=JSON.stringify(H.doc_ids);K.length<az?D.doc_ids=K:(z="POST",F={doc_ids:H.doc_ids})}var x,I,G=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:z,url:cj(m,"_changes"+ep(D)),timeout:H.timeout,body:F};I=N,H.aborted||o().then(function(){x=p(H,O,M)})["catch"](M)}},E={results:[]},C=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,E.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=d2(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&E.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(I=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,E):setTimeout(function(){G(I,C)},0)}};return G(H.since||0,C),{cancel:function(){H.aborted=!0,x&&x.abort()}}},w.revsDiff=v("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:cj(m,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(y,x){p(y,{url:cj(m,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?x(z):void x(null,A)})}}function aj(g){g.adapter("http",a8,!1),g.adapter("https",a8,!1)}function cq(){this.promise=new cL(function(g){g()})}function kk(h){var i=h.db,j=h.viewName,k=h.map,m=h.reduce,n=h.temporary,l=k.toString()+(m&&m.toString())+"undefined";if(!n&&i._cachedViews){var g=i._cachedViews[l];if(g){return cL.resolve(g)}}return i.info().then(function(p){function o(u){u.views=u.views||{};var r=j;-1===r.indexOf("/")&&(r=j+"/"+j);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(n?"temp":fK(l));return db(i,"_local/mrviews",o).then(function(){return i.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:i,adapter:i.adapter,mapFun:k,reduceFun:m};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,n||(i._cachedViews=i._cachedViews||{},i._cachedViews[l]=r,r.db.once("destroyed",function(){delete i._cachedViews[l]})),r})})})})}function dD(j,h,l,i,k,g){return aK("return ("+j.replace(/;\s*$/,"")+");",{emit:h,sum:l,log:i,isArray:k,toJSON:g})}function eF(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function aY(g){return 1===g.length&&/^1-/.test(g[0].rev)}function dA(h,g){try{h.emit("error",g)}catch(i){c1("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),c1("error",g)}}function eN(j,h,g){try{return{output:h.apply(null,g)}}catch(i){return dA(j,i),{error:i}}}function dR(h,g){var i=c6.collate(h.key,g.key);return 0!==i?i:c6.collate(h.value,g.value)}function kg(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function kb(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function jI(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=e(k.data,k.content_type)})})}function ah(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&jI(h),h}}function em(g){var h="builtin "+g+" function requires map values to be numbers or number arrays";return new dq(h)}function eT(h){for(var i=0,j=0,k=h.length;k>j;j++){var m=h[j];if("number"!=typeof m){if(!Array.isArray(m)){throw em("_sum")}i="number"==typeof i?[i]:i;for(var n=0,l=m.length;l>n;n++){var g=m[n];if("number"!=typeof g){throw em("_sum")}"undefined"==typeof i[n]?i.push(g):i[n]+=g}}else{"number"==typeof i?i+=m:i[0]+=m}}return i}function bO(i,g,k,h){var j=g[i];"undefined"!=typeof j&&(h&&(j=encodeURIComponent(JSON.stringify(j))),k.push(i+"="+j))}function eq(g){if("undefined"!=typeof g){var h=Number(g);return isNaN(h)||h!==parseInt(g,10)?g:h}}function km(g){return g.group_level=eq(g.group_level),g.limit=eq(g.limit),g.skip=eq(g.skip),g}function f6(g){if(g){if("number"!=typeof g){return new ef('Invalid value for integer: "'+g+'"')}if(0>g){return new ef('Invalid value for positive integer: "'+g+'"')}}}function j3(j,h){var g=j.descending?"endkey":"startkey",i=j.descending?"startkey":"endkey";if("undefined"!=typeof j[g]&&"undefined"!=typeof j[i]&&c6.collate(j[g],j[i])>0){throw new ef("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(h.reduce&&j.reduce!==!1){if(j.include_docs){throw new ef("{include_docs:true} is invalid for reduce")}if(j.keys&&j.keys.length>1&&!j.group&&!j.group_level){throw new ef("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=f6(j[k]);if(l){throw l}})}function cc(g,i,o){var l,n=[],h="GET";if(bO("reduce",o,n),bO("include_docs",o,n),bO("attachments",o,n),bO("limit",o,n),bO("descending",o,n),bO("group",o,n),bO("group_level",o,n),bO("skip",o,n),bO("stale",o,n),bO("conflicts",o,n),bO("startkey",o,n,!0),bO("start_key",o,n,!0),bO("endkey",o,n,!0),bO("end_key",o,n,!0),bO("inclusive_end",o,n),bO("key",o,n,!0),n=n.join("&"),n=""===n?"":"?"+n,"undefined"!=typeof o.keys){var j=2000,k="keys="+encodeURIComponent(JSON.stringify(o.keys));k.length+n.length+1<=j?n+=("?"===n[0]?"&":"?")+k:(h="POST","string"==typeof i?l={keys:o.keys}:i.keys=o.keys)}if("string"==typeof i){var m=eF(i);return g.request({method:h,url:"_design/"+m[0]+"/_view/"+m[1]+n,body:l}).then(ah(o))}return l=l||{},Object.keys(i).forEach(function(p){Array.isArray(i[p])?l[p]=i[p]:l[p]=i[p].toString()}),g.request({method:"POST",url:"_temp_view"+n,body:l}).then(ah(o))}function b9(h,g,i){return new cL(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function kl(g){return new cL(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function f9(g){return function(h){if(404===h.status){return g}throw h}}function fQ(m,h,l){function j(){return aY(o)?cL.resolve(g):h.db.get(n)["catch"](f9(g))}function i(r){return r.keys.length?h.db.allDocs({keys:r.keys,include_docs:!0}):cL.resolve({rows:[]})}function k(s,u){for(var y=[],w={},z=0,B=u.rows.length;B>z;z++){var r=u.rows[z],x=r.doc;if(x&&(y.push(x),w[x._id]=!0,x._deleted=!q[x._id],!x._deleted)){var v=q[x._id];"value" in v&&(x.value=v.value)}}var A=Object.keys(q);return A.forEach(function(C){if(!w[C]){var E={_id:C},D=q[C];"value" in D&&(E.value=D.value),y.push(E)}}),s.keys=j5(A.concat(s.keys)),y.push(s),y}var n="_local/doc_"+m,g={_id:n,keys:[]},p=l[m],q=p.indexableKeysToKeyValues,o=p.changes;return j().then(function(r){return i(r).then(function(s){return k(r,s)})})}function kj(j,h,g){var i="_local/lastSeq";return j.db.get(i)["catch"](f9({_id:i,seq:0})).then(function(k){var l=Object.keys(h);return cL.all(l.map(function(m){return fQ(m,j,h)})).then(function(n){var m=aQ(n);return k.seq=g,m.push(k),j.db.bulkDocs({docs:m})})})}function jP(h){var g="string"==typeof h?h:h.name,i=bN[g];return i||(i=bN[g]=new cq),i}function ec(g){return f2(jP(g),function(){return e2(g)})()}function e2(g){function i(p,r){var q={id:n._id,key:c6.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=c6.normalizeKey(r)),l.push(q)}function o(q,p){return function(){return kj(g,q,p)}}var l,n,h;if("function"==typeof g.mapFun&&2===g.mapFun.length){var j=g.mapFun;h=function(p){return j(p,i)}}else{h=dD(g.mapFun.toString(),i,eT,ke,Array.isArray,JSON.parse)}var k=g.seq||0,m=new cq;return new cL(function(p,s){function r(){m.finish().then(function(){g.seq=k,p()})}function q(){function u(v){s(v)}g.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:k,limit:ax}).on("complete",function(x){var F=x.results;if(!F.length){return r()}for(var H={},C=0,A=F.length;A>C;C++){var v=F[C];if("_"!==v.doc._id[0]){l=[],n=v.doc,n._deleted||eN(g.sourceDB,h,[n]),l.sort(dR);for(var D,z={},G=0,y=l.length;y>G;G++){var B=l[G],E=[B.key,B.id];0===c6.collate(B.key,D)&&E.push(G);var w=c6.toIndexableString(E);z[w]=B,D=B.key}H[v.doc._id]={indexableKeysToKeyValues:z,changes:v.changes}}k=v.seq}return m.add(o(H,k)),F.length<ax?r():q()}).on("error",u)}q()})}function jU(m,h,l){0===l.group_level&&delete l.group_level;var j,i=l.group||l.group_level;j=bx[m.reduceFun]?bx[m.reduceFun]:dD(m.reduceFun.toString(),null,eT,ke,Array.isArray,JSON.parse);var k=[],n=isNaN(l.group_level)?Number.POSITIVE_INFINITY:l.group_level;h.forEach(function(r){var u=k[k.length-1],s=i?r.key:null;return i&&Array.isArray(s)&&(s=s.slice(0,n)),u&&0===c6.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void k.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),h=[];for(var g=0,p=k.length;p>g;g++){var q=k[g],o=eN(m.sourceDB,j,[q.keys,q.values,!1]);if(o.error&&o.error instanceof dq){throw o.error}h.push({value:o.error?null:o.output,key:q.groupKey})}return{rows:kg(h,l.limit,l.skip)}}function eZ(g,h){return f2(jP(g),function(){return jH(g,h)})()}function jH(r,p){function g(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return s=v.total_rows,v.rows.map(function(z){if("value" in z.doc&&"object"==typeof z.doc.value&&null!==z.doc.value){var x=Object.keys(z.doc.value).sort(),w=["id","key","value"];if(!(w>x||x>w)){return z.doc.value}}var y=c6.parseIndexableString(z.doc._id);return{key:y[0],id:y[1],value:"value" in z.doc?z.doc.value:null}})})}function q(u){var w;if(w=i?jU(r,u,p):{total_rows:s,offset:n,rows:u},p.include_docs){var v=j5(u.map(kb));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:p.conflicts,attachments:p.attachments,binary:p.binary}).then(function(y){var x={};return y.rows.forEach(function(z){z.doc&&(x["$"+z.id]=z.doc)}),u.forEach(function(A){var B=kb(A),z=x["$"+B];z&&(A.doc=z)}),w})}return w}var s,i=r.reduceFun&&p.reduce!==!1,n=p.skip||0;if("undefined"==typeof p.keys||p.keys.length||(p.limit=0,delete p.keys),"undefined"!=typeof p.keys){var j=p.keys,o=j.map(function(u){var v={startkey:c6.toIndexableString([u]),endkey:c6.toIndexableString([u,{}])};return g(v)});return cL.all(o).then(aQ).then(q)}var m={descending:p.descending};if(p.start_key&&(p.startkey=p.start_key),p.end_key&&(p.endkey=p.end_key),"undefined"!=typeof p.startkey&&(m.startkey=p.descending?c6.toIndexableString([p.startkey,{}]):c6.toIndexableString([p.startkey])),"undefined"!=typeof p.endkey){var k=p.inclusive_end!==!1;p.descending&&(k=!k),m.endkey=c6.toIndexableString(k?[p.endkey,{}]:[p.endkey])}if("undefined"!=typeof p.key){var h=c6.toIndexableString([p.key]),l=c6.toIndexableString([p.key,{}]);m.descending?(m.endkey=h,m.startkey=l):(m.startkey=h,m.endkey=l)}return i||("number"==typeof p.limit&&(m.limit=p.limit),m.skip=n),g(m).then(q)}function eD(g){return g.request({method:"POST",url:"_view_cleanup"})}function j2(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(n){var l=eF(n),m="_design/"+l[0],k=l[1];j[m]=j[m]||{},j[m][k]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(n){var k={};n.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){k[v]=k[v]||s})})});var m=Object.keys(k).filter(function(o){return !k[o]}),l=m.map(function(o){return f2(jP(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return cL.all(l).then(function(){return{ok:!0}})})},f9({ok:!0}))}function eJ(m,g,h){if("http"===m.type()){return cc(m,g,h)}if("function"==typeof m._query){return b9(m,g,h)}if("string"!=typeof g){j3(h,g);var j={db:m,viewName:"temp_view/temp_view",map:g.map,reduce:g.reduce,temporary:!0};return b0.add(function(){return kk(j).then(function(o){function p(){return o.db.destroy()}return fF(ec(o).then(function(){return eZ(o,h)}),p)})}),b0.finish()}var i=g,l=eF(i),k=l[0],n=l[1];return m.get("_design/"+k).then(function(o){var p=o.views&&o.views[n];if(!p||"string"!=typeof p.map){throw new jO("ddoc "+k+" has no view named "+n)}j3(h,p);var q={db:m,viewName:i,map:p.map,reduce:p.reduce};return kk(q).then(function(r){return"ok"===h.stale||"update_after"===h.stale?("update_after"===h.stale&&eO.nextTick(function(){ec(r)}),eZ(r,h)):ec(r).then(function(){return eZ(r,h)})})})}function ef(g){this.status=400,this.name="query_parse_error",this.message=g,this.error=!0;try{Error.captureStackTrace(this,ef)}catch(h){}}function jO(g){this.status=404,this.name="not_found",this.message=g,this.error=!0;try{Error.captureStackTrace(this,jO)}catch(h){}}function dq(g){this.status=500,this.name="invalid_value",this.message=g,this.error=!0;try{Error.captureStackTrace(this,dq)}catch(h){}}function jX(g){return/^1-/.test(g)}function dS(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function dU(h,g){var i=Object.keys(g._attachments);return cL.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function c0(i,g,k){var h="http"===g.type()&&"http"!==i.type(),j=Object.keys(k._attachments);return h?i.get(k._id).then(function(l){return cL.all(j.map(function(m){return dS(l,k,m)?g.getAttachment(k._id,m):i.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return dU(g,k)}):dU(g,k)}function bv(g){var h=[];return Object.keys(g).forEach(function(j){var i=g[j].missing;i.forEach(function(k){h.push({id:j,rev:k})})}),{docs:h,revs:!0}}function j9(l,g,k,i){function j(){var r=bv(k);if(r.docs.length){return l.bulkGet(r).then(function(s){if(i.cancelled){throw new Error("cancelled")}return cL.all(s.results.map(function(u){return cL.all(u.docs.map(function(w){var v=w.ok;return w.error&&(o=!1),v&&v._attachments?c0(g,l,v).then(function(y){var x=Object.keys(v._attachments);return y.forEach(function(z,B){var A=v._attachments[x[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){q=q.concat(aQ(u).filter(Boolean))})})}}function m(r){return r._attachments&&Object.keys(r._attachments).length>0}function n(r){return l.allDocs({keys:r,include_docs:!0}).then(function(s){if(i.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&jX(u.value.rev)&&!m(u.doc)&&(q.push(u.doc),delete k[u.id])})})}function h(){var r=Object.keys(k).filter(function(s){var u=k[s].missing;return 1===u.length&&jX(u[0])});return r.length>0?n(r):void 0}function p(){return{ok:o,docs:q}}k=aU(k);var q=[],o=!0;return cL.resolve().then(h).then(j).then(p)}function cC(i,g,k,h,j){return i.get(g)["catch"](function(l){if(404===l.status){return"http"===i.type()&&ch(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:h,_id:g,history:[],replicator:dK,version:b3}}throw l}).then(function(l){return j.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==h}),l.history.unshift({last_seq:k,session_id:h}),l.history=l.history.slice(0,dp),l.version=b3,l.replicator=dK,l.session_id=h,l.last_seq=k,i.put(l)["catch"](function(m){if(409===m.status){return cC(i,g,k,h,j)}throw m}))})}function cl(j,h,g,i){this.src=j,this.target=h,this.id=g,this.returnValue=i}function cz(g,h){return g.session_id===h.session_id?{last_seq:g.last_seq,history:g.history}:fR(g.history,h.history)}function fR(h,i){var j=h[0],k=h.slice(1),m=i[0],n=i.slice(1);if(!j||0===i.length){return{last_seq:bj,history:[]}}var l=j.session_id;if(fL(l,i)){return{last_seq:j.last_seq,history:h}}var g=m.session_id;return fL(g,k)?{last_seq:m.last_seq,history:n}:fR(k,n)}function fL(j,h){var g=h[0],i=h.slice(1);return j&&0!==h.length?j===g.session_id?!0:fL(j,i):!1}function dN(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function cx(j,h,g,i){return j.retry===!1?(h.emit("error",g),void h.removeAllListeners()):("function"!=typeof j.back_off_function&&(j.back_off_function=aL),h.emit("requestError",g),"active"!==h.state&&"pending"!==h.state||(h.emit("paused",g),h.state="stopped",h.once("active",function(){j.current_back_off=bZ})),j.current_back_off=j.current_back_off||bZ,j.current_back_off=j.back_off_function(j.current_back_off),void setTimeout(i,j.current_back_off))}function dc(g){return Object.keys(g).sort(c6.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function bQ(l,j,g){var k=g.doc_ids?g.doc_ids.sort(c6.collate):"",m=g.filter?g.filter.toString():"",i="",h="";return g.filter&&g.query_params&&(i=JSON.stringify(dc(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),cL.all([l.id(),j.id()]).then(function(o){var n=o[0]+o[1]+m+h+i+k;return new cL(function(p){dj(n,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function d0(H,Q,q,l,p){function x(){return D?cL.resolve():bQ(H,Q,q).then(function(T){O=T,D=new cl(H,Q,O,l)})}function k(){if(i=[],0!==F.docs.length){var T=F.docs;return Q.bulkDocs({docs:T,new_edits:!1}).then(function(U){if(l.cancelled){throw o(),new Error("cancelled")}var W=[],Y={};U.forEach(function(Z){Z.error&&(p.doc_write_failures++,W.push(Z),Y[Z.id]=Z)}),G=G.concat(W),p.docs_written+=F.docs.length-W.length;var X=W.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=Y[Z._id];ae?l.emit("denied",aU(ae)):i.push(Z)}),X.length>0){var V=new Error("bulkDocs error");throw V.other_errors=W,y("target.bulkDocs failed to write docs",V),new Error("bulkWrite partial failure")}},function(U){throw p.doc_write_failures+=T.length,U})}}function R(){if(F.error){throw new Error("There was a problem getting docs.")}p.last_seq=w=F.seq;var T=aU(p);return i.length&&(T.docs=i,l.emit("change",T)),A=!0,D.writeCheckpoint(F.seq,I).then(function(){if(A=!1,l.cancelled){throw o(),new Error("cancelled")}F=void 0,s()})["catch"](P)}function K(){var T={};return F.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),Q.revsDiff(T).then(function(U){if(l.cancelled){throw o(),new Error("cancelled")}F.diffs=U})}function C(){return j9(H,Q,F.diffs,l).then(function(T){F.error=!T.ok,T.docs.forEach(function(U){delete F.diffs[U._id],p.docs_read++,F.docs.push(U)})})}function u(){if(!l.cancelled&&!F){if(0===v.length){return void M(!0)}F=v.shift(),K().then(C).then(k).then(R).then(u)["catch"](function(T){y("batch processing terminated with error",T)})}}function M(T){return 0===n.changes.length?void (0!==v.length||F||((h&&r.live||j)&&(l.state="pending",l.emit("paused")),j&&o())):void ((T||j||n.changes.length>=L)&&(v.push(n),n={seq:0,changes:[],docs:[]},"pending"!==l.state&&"stopped"!==l.state||(l.state="active",l.emit("active")),u()))}function y(T,U){B||(U.message||(U.message=T),p.ok=!1,p.status="aborting",p.errors.push(U),G=G.concat(U),v=[],n={seq:0,changes:[],docs:[]},o())}function o(){if(!(B||l.cancelled&&(p.status="cancelled",A))){p.status=p.status||"complete",p.end_time=new Date,p.last_seq=w,B=!0;var T=G.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(T.length>0){var U=G.pop();G.length>0&&(U.other_errors=G),U.result=p,cx(q,l,U,function(){d0(H,Q,q,l)})}else{p.errors=G,l.emit("complete",p),l.removeAllListeners()}}}function J(T){if(l.cancelled){return o()}var U=d2(q)(T);U&&(n.seq=T.seq,n.changes.push(T),M(0===v.length&&r.live))}function S(T){if(g=!1,l.cancelled){return o()}if(T.results.length>0){r.since=T.last_seq,s(),M(!0)}else{var U=function(){h?(r.live=!0,s()):j=!0,M(!0)};F||0!==T.results.length?U():(A=!0,D.writeCheckpoint(T.last_seq,I).then(function(){A=!1,p.last_seq=w=T.last_seq,U()})["catch"](P))}}function m(T){return g=!1,l.cancelled?o():void y("changes rejected",T)}function s(){function U(){T.cancel()}function V(){l.removeListener("cancel",U)}if(!g&&!j&&v.length<N){g=!0,l._changes&&(l.removeListener("cancel",l._abortChanges),l._changes.cancel()),l.once("cancel",U);var T=H.changes(r).on("change",J);T.then(V,V),T.then(S)["catch"](m),q.retry&&(l._changes=T,l._abortChanges=U)}}function z(){x().then(function(){return l.cancelled?void o():D.getCheckpoint().then(function(T){w=T,r={since:w,limit:L,batch_size:L,style:"all_docs",doc_ids:E,return_docs:!0},q.filter&&("string"!=typeof q.filter?r.include_docs=!0:r.filter=q.filter),"heartbeat" in q&&(r.heartbeat=q.heartbeat),"timeout" in q&&(r.timeout=q.timeout),q.query_params&&(r.query_params=q.query_params),q.view&&(r.view=q.view),s()})})["catch"](function(T){y("getCheckpoint rejected with ",T)})}function P(T){throw A=!1,y("writeCheckpoint completed with error",T),T}var F,O,D,v=[],n={seq:0,changes:[],docs:[]},A=!1,j=!1,B=!1,w=0,h=q.continuous||q.live||!1,L=q.batch_size||100,N=q.batches_limit||10,g=!1,E=q.doc_ids,G=[],i=[],I=bi();p=p||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var r={};return l.ready(H,Q),l.cancelled?void o():(l._addedListeners||(l.once("cancel",o),"function"==typeof q.complete&&(l.once("error",q.complete),l.once("complete",function(T){q.complete(null,T)})),l._addedListeners=!0),void ("undefined"==typeof q.since?z():x().then(function(){return A=!0,D.writeCheckpoint(q.since,I)}).then(function(){return A=!1,l.cancelled?void o():(w=q.since,void z())})["catch"](P)))}function c8(){cf.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var g=this,h=new cL(function(i,j){g.once("complete",i),g.once("error",j)});g.then=function(i,j){return h.then(i,j)},g["catch"]=function(i){return h["catch"](i)},g["catch"](function(){})}function ac(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function cY(l,j,g,k){if("function"==typeof g&&(k=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw dX(ba,"`doc_ids` filter parameter is not a list.")}g.complete=k,g=aU(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var m=new c8(g),i=ac(l,g),h=ac(j,g);return d0(i,h,g,m),m}function d5(j,h,g,i){return"function"==typeof g&&(i=g,g={}),"undefined"==typeof g&&(g={}),g=aU(g),g.PouchConstructor=g.PouchConstructor||this,j=ac(j,g),h=ac(h,g),new da(j,h,g,i)}function da(u,m,n,w){function l(z){r.emit("change",{direction:"pull",change:z})}function q(z){r.emit("change",{direction:"push",change:z})}function k(z){r.emit("denied",{direction:"push",doc:z})}function o(z){r.emit("denied",{direction:"pull",doc:z})}function i(){r.pushPaused=!0,r.pullPaused&&r.emit("paused")}function x(){r.pullPaused=!0,r.pushPaused&&r.emit("paused")}function s(){r.pushPaused=!1,r.pullPaused&&r.emit("active",{direction:"push"})}function p(){r.pullPaused=!1,r.pushPaused&&r.emit("active",{direction:"pull"})}function v(z){return function(D,B){var C="change"===D&&(B===l||B===q),F="denied"===D&&(B===o||B===k),A="paused"===D&&(B===x||B===i),E="active"===D&&(B===p||B===s);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&r.removeAllListeners(D))}}var r=this;this.canceled=!1;var y=n.push?dm.extend({},n,n.push):n,h=n.pull?dm.extend({},n,n.pull):n;this.push=cY(u,m,y),this.pull=cY(m,u,h),this.pushPaused=!0,this.pullPaused=!0;var g={};n.live&&(this.push.on("complete",r.pull.cancel.bind(r.pull)),this.pull.on("complete",r.push.cancel.bind(r.push))),this.on("newListener",function(z){"change"===z?(r.pull.on("change",l),r.push.on("change",q)):"denied"===z?(r.pull.on("denied",o),r.push.on("denied",k)):"active"===z?(r.pull.on("active",p),r.push.on("active",s)):"paused"===z&&(r.pull.on("paused",x),r.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(r.pull.removeListener("change",l),r.push.removeListener("change",q)):"denied"===z?(r.pull.removeListener("denied",o),r.push.removeListener("denied",k)):"active"===z?(r.pull.removeListener("active",p),r.push.removeListener("active",s)):"paused"===z&&(r.pull.removeListener("paused",x),r.push.removeListener("paused",i))}),this.pull.on("removeListener",v("pull")),this.push.on("removeListener",v("push"));var j=cL.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return r.emit("complete",z),w&&w(null,z),r.removeAllListeners(),z},function(z){if(r.cancel(),w?w(z):r.emit("error",z),r.removeAllListeners(),w){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function ca(g){g.replicate=cY,g.sync=d5}var f7,dm=d(9),b6=ed(d(5)),aX=ed(d(8)),bm=ed(d(10)),au=d(14),dO=ed(d(4)),cf=d(1),aK=ed(d(15)),bb=ed(d(16)),cJ=ed(d(17)),c6=d(12),cL="function"==typeof Promise?Promise:bm,ka=Function.prototype.toString,aC=ka.call(Object),cs=b6("pouchdb:api"),by=6;if(e8()){f7=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),f7=!!localStorage.getItem("_pouch_check_localstorage")}catch(aZ){f7=!1}}aX(fD,cf.EventEmitter),fD.prototype.addListener=function(l,j,g,k){function m(){function o(){h=!1}if(i._listeners[j]){if(h){return void (h="waiting")}h=!0;var n=e4(k,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(n).on("change",function(p){p.seq>k.since&&!k.cancelled&&(k.since=p.seq,k.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){m()},0),h=!1}).on("error",o)}}if(!this._listeners[j]){var i=this,h=!1;this._listeners[j]=m,this.on(l,m)}},fD.prototype.removeListener=function(g,h){h in this._listeners&&cf.EventEmitter.prototype.removeListener.call(this,g,this._listeners[h])},fD.prototype.notifyLocalWindows=function(g){e8()?chrome.storage.local.set({dbName:g}):eB()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},fD.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},aX(eR,Error),eR.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var dJ=new eR({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),e9=new eR({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),b2=new eR({status:404,error:"not_found",reason:"missing"}),eW=new eR({status:409,error:"conflict",reason:"Document update conflict"}),cS=new eR({status:400,error:"invalid_id",reason:"_id field must contain a string"}),bw=new eR({status:412,error:"missing_id",reason:"_id is required for puts"}),fC=new eR({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),bz=new eR({status:412,error:"precondition_failed",reason:"Database not open"}),bW=new eR({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),e6=new eR({status:500,error:"badarg",reason:"Some query argument is invalid"}),dF=new eR({status:400,error:"invalid_request",reason:"Request was invalid"}),d4=new eR({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),fI=new eR({status:500,error:"doc_validation",reason:"Bad special document member"}),ba=new eR({status:400,error:"bad_request",reason:"Something wrong with the request"}),eH=new eR({status:400,error:"bad_request",reason:"Document must be a JSON object"}),fG=new eR({status:404,error:"not_found",reason:"Database not found"}),eP=new eR({status:500,error:"indexed_db_went_bad",reason:"unknown"}),d6=new eR({status:500,error:"web_sql_went_bad",reason:"unknown"}),bA=new eR({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),jR=new eR({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),df=new eR({status:400,error:"bad_request",reason:"Invalid rev format"}),bE=new eR({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),f1=new eR({status:412,error:"missing_stub"}),ea=new eR({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cG=[dJ,e9,b2,eW,cS,bw,fC,bz,bW,e6,dF,d4,fI,ba,eH,fG,d6,bA,jR,df,bE,f1,eP,ea],cD=function(j,h,g){var i=cG.filter(function(k){return k[j]===h});return g&&i.filter(function(k){return k.message===g})[0]||i[0]},cM=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ck="queryKey",dw=/(?:^|&)([^&=]*)=?([^&]*)/g,fO=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,dP="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");aX(e5,cf.EventEmitter),e5.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},e5.prototype.doChanges=function(i){var g=this,k=i.complete;if(i=aU(i),"live" in i&&!("continuous" in i)&&(i.continuous=i.live),i.processChange=eb,"latest"===i.since&&(i.since="now"),i.since||(i.since=0),"now"===i.since){return void this.db.info().then(function(l){return g.isCancelled?void k(null,{status:"cancelled"}):(i.since=l.update_seq,void g.doChanges(i))},k)}if(i.continuous&&"now"!==i.since&&this.db.info().then(function(l){g.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),i.view&&!i.filter&&(i.filter="_view"),i.filter&&"string"==typeof i.filter&&("_view"===i.filter?i.view=bq(i.view):i.filter=bq(i.filter),"http"!==this.db.type()&&!i.doc_ids)){return this.filterChanges(i)}"descending" in i||(i.descending=!1),i.limit=0===i.limit?1:i.limit,i.complete=k;var h=this.db._changes(i);if(h&&"function"==typeof h.cancel){var j=g.cancel;g.cancel=dO(function(l){h.cancel(),j.apply(this,l)})}},e5.prototype.filterChanges=function(j){var h=this,l=j.complete;if("_view"===j.filter){if(!j.view||"string"!=typeof j.view){var i=dX(ba,"`view` filter parameter not found or invalid.");return l(i)}var k=av(j.view);this.db.get("_design/"+k[0],function(m,o){if(h.isCancelled){return l(null,{status:"cancelled"})}if(m){return l(bH(m))}var n=o&&o.views&&o.views[k[1]]&&o.views[k[1]].map;return n?(j.filter=eM(n),void h.doChanges(j)):l(dX(b2,o.views?"missing json key: "+k[1]:"missing json key: views"))})}else{var g=av(j.filter);if(!g){return h.doChanges(j)}this.db.get("_design/"+g[0],function(n,o){if(h.isCancelled){return l(null,{status:"cancelled"})}if(n){return l(bH(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(j.filter=bP(m),void h.doChanges(j)):l(dX(b2,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},aX(bd,cf.EventEmitter),bd.prototype.post=eC("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(dX(eH)):void this.bulkDocs({docs:[h]},g,jY(i))}),bd.prototype.put=eC("put",dO(function(g){function i(){j||(c1("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),j=!0)}var o,l,n,h,j=!1,k=g.shift(),m="_id" in k;if("object"!=typeof k||Array.isArray(k)){return(h=g.pop())(dX(eH))}for(;;){if(o=g.shift(),l=typeof o,"string"!==l||m?"string"!==l||!m||"_rev" in k?"object"===l?n=o:"function"===l&&(h=o):(i(),k._rev=o):(i(),k._id=o,m=!0),!g.length){break}}return n=n||{},bJ(k._id),aA(k._id)&&"function"==typeof this._putLocal?k._deleted?this._removeLocal(k,h):this._putLocal(k,h):void this.bulkDocs({docs:[k]},n,jY(h))})),bd.prototype.putAttachment=eC("putAttachment",function(l,j,g,k,m){function i(n){var o="_rev" in n?parseInt(n._rev,10):0;return n._attachments=n._attachments||{},n._attachments[j]={content_type:m,data:k,revpos:++o},h.put(n)}var h=this;return"function"==typeof m&&(m=k,k=g,g=null),"undefined"==typeof m&&(m=k,k=g,g=null),h.get(l).then(function(n){if(n._rev!==g){throw dX(eW)}return i(n)},function(n){if(n.reason===b2.message){return i({_id:l})}throw n})}),bd.prototype.removeAttachment=eC("removeAttachment",function(i,g,k,h){var j=this;j.get(i,function(m,l){return m?void h(m):l._rev!==k?void h(dX(eW)):l._attachments?(delete l._attachments[g],0===Object.keys(l._attachments).length&&delete l._attachments,void j.put(l,h)):h()})}),bd.prototype.remove=eC("remove",function(j,h,l,i){var k;"string"==typeof h?(k={_id:j,_rev:h},"function"==typeof l&&(i=l,l={})):(k=j,"function"==typeof h?(i=h,l={}):(i=l,l=h)),l=l||{},l.was_delete=!0;var g={_id:k._id,_rev:k._rev||l.rev};return g._deleted=!0,aA(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(k,i):void this.bulkDocs({docs:[g]},l,jY(i))}),bd.prototype.revsDiff=eC("revsDiff",function(h,i,j){function k(o,p){g.has(o)||g.set(o,{missing:[]}),g.get(o).missing.push(p)}function m(q,p){var o=h[q].slice(0);dd(p,function(x,w,v,r,s){var u=w+"-"+v,y=o.indexOf(u);-1!==y&&(o.splice(y,1),"available"!==s.status&&k(q,u))}),o.forEach(function(r){k(q,r)})}"function"==typeof i&&(j=i,i={});var n=Object.keys(h);if(!n.length){return j(null,{})}var l=0,g=new au.Map;n.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){g.set(o,{missing:h[o]})}else{if(q){return j(q)}m(o,p)}if(++l===n.length){var r={};return g.forEach(function(u,s){r[s]=u}),j(null,r)}})},this)}),bd.prototype.bulkGet=eC("bulkGet",function(g,h){ds(this,g,h)}),bd.prototype.compactDocument=eC("compactDocument",function(j,h,g){var i=this;this._getRevisionTree(j,function(o,m){if(o){return g(o)}var k=fM(m),n=[],l=[];Object.keys(k).forEach(function(p){k[p]>h&&n.push(p)}),dd(m,function(p,u,r,v,q){var s=u+"-"+r;"available"===q.status&&-1!==n.indexOf(s)&&l.push(s)}),i._doCompaction(j,l,g)})}),bd.prototype.compact=eC("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&f0(i)}),bd.prototype._compact=function(l,j){function g(n){h.push(m.compactDocument(n.id,0))}function k(n){var o=n.last_seq;cL.all(h).then(function(){return db(m,"_local/compaction",function(p){return !p.last_seq||p.last_seq<o?(p.last_seq=o,p):!1})}).then(function(){j(null,{ok:!0})})["catch"](j)}var m=this,i={return_docs:!1,last_seq:l.last_seq||0},h=[];m.changes(i).on("change",g).on("complete",k).on("error",j)},bd.prototype.get=eC("get",function(h,i,j){function k(){var o=[],p=m.length;return p?void m.forEach(function(q){n.get(h,{rev:q,revs:i.revs,attachments:i.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||j(null,o)})}):j(null,o)}if("function"==typeof i&&(j=i,i={}),"string"!=typeof h){return j(dX(cS))}if(aA(h)&&"function"==typeof this._getLocal){return this._getLocal(h,j)}var m=[],n=this;if(!i.open_revs){return this._get(h,i,function(y,v){if(y){return j(y)}var B=v.doc,x=v.metadata,C=v.ctx;if(i.conflicts){var o=bI(x);o.length&&(B._conflicts=o)}if(cI(x,B._rev)&&(B._deleted=!0),i.revs||i.revs_info){var A=aP(x.rev_tree),r=jJ(A,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(B._rev.split("-")[1])}),p=r.ids.map(function(D){return D.id}).indexOf(B._rev.split("-")[1])+1,w=r.ids.length-p;if(r.ids.splice(p,w),r.ids.reverse(),i.revs&&(B._revisions={start:r.pos+r.ids.length-1,ids:r.ids.map(function(D){return D.id})}),i.revs_info){var s=r.pos+r.ids.length;B._revs_info=r.ids.map(function(D){return s--,{rev:s+"-"+D.id,status:D.opts.status}})}}if(i.attachments&&B._attachments){var z=B._attachments,u=Object.keys(z).length;if(0===u){return j(null,B)}Object.keys(z).forEach(function(D){this._getAttachment(B._id,D,z[D],{rev:B._rev,binary:i.binary,ctx:C},function(F,G){var E=B._attachments[D];E.data=G,delete E.stub,delete E.length,--u||j(null,B)})},n)}else{if(B._attachments){for(var q in B._attachments){B._attachments.hasOwnProperty(q)&&(B._attachments[q].stub=!0)}}j(null,B)}})}if("all"===i.open_revs){this._getRevisionTree(h,function(o,p){return o?j(o):(m=cm(p).map(function(q){return q.rev}),void k())})}else{if(!Array.isArray(i.open_revs)){return j(dX(bW,"function_clause"))}m=i.open_revs;for(var l=0;l<m.length;l++){var g=m[l];if("string"!=typeof g||!/^\d+-/.test(g)){return j(dX(df))}}k()}}),bd.prototype.getAttachment=eC("getAttachment",function(i,g,k,h){var j=this;k instanceof Function&&(h=k,k={}),this._get(i,k,function(m,l){return m?h(m):l.doc._attachments&&l.doc._attachments[g]?(k.ctx=l.ctx,k.binary=!0,j._getAttachment(i,g,l.doc._attachments[g],k,h),void 0):h(dX(b2))})}),bd.prototype.allDocs=eC("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(dX(d4,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return ad(this,h,g)}}return this._allDocs(h,g)}),bd.prototype.changes=function(g,h){return"function"==typeof g&&(h=g,g={}),new e5(this,g,h)},bd.prototype.close=eC("close",function(g){return this._closed=!0,this._close(g)}),bd.prototype.info=eC("info",function(g){var h=this;this._info(function(j,i){return j?g(j):(i.db_name=i.db_name||h._db_name,i.auto_compaction=!(!h.auto_compaction||"http"===h.type()),i.adapter=h.type(),void g(null,i))})}),bd.prototype.id=eC("id",function(g){return this._id(g)}),bd.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},bd.prototype.bulkDocs=eC("bulkDocs",function(i,g,k){if("function"==typeof g&&(k=g,g={}),g=g||{},Array.isArray(i)&&(i={docs:i}),!i||!i.docs||!Array.isArray(i.docs)){return k(dX(e9))}for(var h=0;h<i.docs.length;++h){if("object"!=typeof i.docs[h]||Array.isArray(i.docs[h])){return k(dX(eH))}}var j;return i.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){j=j||eG(m)})}),j?k(dX(ba,j)):("new_edits" in g||("new_edits" in i?g.new_edits=i.new_edits:g.new_edits=!0),g.new_edits||"http"===this.type()||i.docs.sort(j4),bV(i.docs),this._bulkDocs(i,g,function(m,l){return m?k(m):(g.new_edits||(l=l.filter(function(n){return n.error})),void k(null,l))}))}),bd.prototype.registerDependentDatabase=eC("registerDependentDatabase",function(j,h){function g(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[j]?!1:(k.dependentDbs[j]=!0,k)}var i=new this.constructor(j,this.__opts);db(this,"_local/_pouch_dependentDbs",g).then(function(){h(null,{db:i})})["catch"](h)}),bd.prototype.destroy=eC("destroy",function(i,g){function k(){h._destroy(i,function(l,m){return l?g(l):(h._destroyed=!0,h.emit("destroyed"),void g(null,m||{ok:!0}))})}"function"==typeof i&&(g=i,i={});var h=this,j="use_prefix" in h?h.use_prefix:!0;return"http"===h.type()?k():void h.get("_local/_pouch_dependentDbs",function(p,n){if(p){return 404!==p.status?g(p):k()}var l=n.dependentDbs,o=h.constructor,m=Object.keys(l).map(function(r){var q=j?r.replace(new RegExp("^"+o.prefix),""):r;return new o(q,h.__opts).destroy()});cL.all(m).then(k,g)})}),eh.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},eh.prototype.fail=function(g){this.failed=g,this.execute()},eh.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},eh.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},aX(jN,bd),jN.debug=b6,jN.adapters={},jN.preferredAdapters=[],jN.prefix="_pouch_";var d1=new cf.EventEmitter;dk(jN),jN.parseAdapter=function(h,i){var j,k,m=h.match(/([a-z\-]*):\/\/(.*)/);if(m){if(h=/http(s?)/.test(m[1])?m[1]+"://"+m[2]:m[2],j=m[1],!jN.adapters[j].valid()){throw"Invalid adapter"}return{name:h,adapter:m[1]}}var n="idb" in jN.adapters&&"websql" in jN.adapters&&eB()&&localStorage["_pouch__websqldb_"+jN.prefix+h];if(i.adapter){k=i.adapter}else{if("undefined"!=typeof i&&i.db){k="leveldb"}else{for(var l=0;l<jN.preferredAdapters.length;++l){if(k=jN.preferredAdapters[l],k in jN.adapters){if(n&&"idb"===k){c1("log",'PouchDB is downgrading "'+h+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}j=jN.adapters[k];var g=j&&"use_prefix" in j?j.use_prefix:!0;return{name:g?jN.prefix+h:h,adapter:k}},jN.adapter=function(h,g,i){g.valid()&&(jN.adapters[h]=g,i&&jN.preferredAdapters.push(h))},jN.plugin=function(g){return"function"==typeof g?g(jN):Object.keys(g).forEach(function(h){jN.prototype[h]=g[h]}),jN},jN.defaults=function(g){function h(k,i,j){return this instanceof h?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=dm.extend({},g,i),void jN.call(this,k,i,j)):new h(k,i,j)}return aX(h,jN),h.preferredAdapters=jN.preferredAdapters.slice(),Object.keys(jN).forEach(function(i){i in h||(h[i]=jN[i])}),h};var kh="5.4.4";jN.version=kh;var kd,bF=d8(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cu=d8(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),c2=function(g){return atob(g)},dV=function(g){return btoa(g)},eQ=bc.setImmediate||bc.setTimeout,bG=32768,cA=5,e7="document-store",dG="by-sequence",cK="attach-store",jT="attach-seq-store",ag="meta-store",dQ="local-store",aH="detect-blob-support",a9={running:!1,queue:[]},c7=new au.Map,aW=new fD,cW=new au.Map;j0.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var cN=7,bX=cw("document-store"),ej=cw("by-sequence"),aJ=cw("attach-store"),dL=cw("local-store"),bT=cw("metadata-store"),bL=cw("attach-seq-store"),dx=new au.Map,f4=new fD,aF=1,j6="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+ej+" (seq, deleted)",cv="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+ej+" (doc_id, rev)",ab="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+bX+" (winningseq)",el="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+bL+" (seq)",kf="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+bL+" (digest, seq)",cg=ej+".seq = "+bX+".winningseq",jK=ej+".seq AS seq, "+ej+".deleted AS deleted, "+ej+".json AS data, "+ej+".rev AS rev, "+bX+".json AS metadata";cV.valid=af,cV.use_prefix=!0;var jS=dT(),aN=function(){},bg=25,cT=50,dB={},az=1800,b7=b6("pouchdb:http");a8.valid=function(){return !0},cq.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},cq.prototype.finish=function(){return this.promise};var fA=function(g,h){return h&&g.then(function(i){eO.nextTick(function(){h(null,i)})},function(i){eO.nextTick(function(){h(i)})}),g},d7=function(g){return dO(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&fA(i,j),i})},fF=function(g,h){return g.then(function(i){return h().then(function(){return i})},function(i){return h().then(function(){throw i})})},f2=function(g,h){return function(){var j=arguments,i=this;return g.add(function(){return h.apply(i,j)})}},j5=function(j){for(var h={},l=0,i=j.length;i>l;l++){h["$"+j[l]]=!0}var k=Object.keys(h),g=new Array(k.length);for(l=0,i=k.length;i>l;l++){g[l]=k[l].substring(1)}return g},bN={},b0=new cq,ax=50,ke=c1.bind(null,"log"),bx={_sum:function(g,h){return eT(h)},_count:function(g,h){return h.length},_stats:function(h,g){function i(l){for(var j=0,n=0,k=l.length;k>n;n++){var m=l[n];j+=m*m}return j}return{sum:eT(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},ak=d7(function(){var g=this;return"http"===g.type()?eD(g):"function"==typeof g._viewCleanup?kl(g):j2(g)}),bD=function(i,g,k){"function"==typeof g&&(k=g,g={}),g=g?km(g):{},"function"==typeof i&&(i={map:i});var h=this,j=cL.resolve().then(function(){return eJ(h,i,g)});return fA(j,k),j};aX(ef,Error),aX(jO,Error),aX(dq,Error);var d9={query:bD,viewCleanup:ak},b3=1,dK="pouchdb",dp=5,bj=0;cl.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},cl.prototype.updateTarget=function(g,h){return cC(this.target,this.id,g,h,this.returnValue)},cl.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?cL.resolve(!0):cC(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(dN(j)){return i.readOnlySource=!0,!0}throw j})};var bp={undefined:function(g,h){return 0===c6.collate(g.last_seq,h.last_seq)?h.last_seq:0},1:function(g,h){return cz(h,g).last_seq}};cl.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?cL.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return bj}var j;return j=h.version?h.version.toString():"undefined",j in bp?bp[j](h,i):bj},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:bj}).then(function(){return bj},function(j){return dN(j)?(g.readOnlySource=!0,h.last_seq):bj})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return bj})};var bZ=0;aX(c8,cf.EventEmitter),c8.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},c8.prototype.ready=function(i,g){function k(){j.cancel()}function h(){i.removeListener("destroyed",k),g.removeListener("destroyed",k)}var j=this;j._readyCalled||(j._readyCalled=!0,i.once("destroyed",k),g.once("destroyed",k),j.once("complete",h))},aX(da,cf.EventEmitter),da.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},jN.plugin(al).plugin(jF).plugin(aj).plugin(d9).plugin(ca),c.exports=jN}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(c,f,d){function g(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}f.exports=g},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+f.humanize(this.diff),!n){return e}var o="color: "+this.color;e=[e[0],o,"color: inherit"].concat(Array.prototype.slice.call(e,1));var p=0,i=0;return e[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),e.splice(i,0,o),e}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(j,p,d){function v(){return d.colors[h++%d.colors.length]}function c(e){function i(){}function n(){var o=n,s=+new Date,r=s-(k||s);o.diff=r,o.prev=k,o.curr=s,k=s,null==o.useColors&&(o.useColors=d.useColors()),null==o.color&&o.useColors&&(o.color=v());var u=Array.prototype.slice.call(arguments);u[0]=d.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=d.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof d.formatArgs&&(u=d.formatArgs.apply(o,u));var x=n.log||d.log||console.log.bind(console);x.apply(o,u)}i.enabled=!1,n.enabled=!0;var f=d.enabled(e)?n:i;return f.namespace=e,f}function g(n){d.save(n);for(var e=(n||"").split(/[\s,]+/),i=e.length,f=0;i>f;f++){e[f]&&(n=e[f].replace(/\*/g,".*?"),"-"===n[0]?d.skips.push(new RegExp("^"+n.substr(1)+"$")):d.names.push(new RegExp("^"+n+"$")))}}function l(){d.enable("")}function q(i){var e,f;for(e=0,f=d.skips.length;f>e;e++){if(d.skips[e].test(i)){return !1}}for(e=0,f=d.names.length;f>e;e++){if(d.names[e].test(i)){return !0}}return !1}function m(e){return e instanceof Error?e.stack||e.message:e}d=p.exports=c,d.coerce=m,d.disable=l,d.enable=g,d.enabled=q,d.humanize=j(11),d.names=[],d.skips=[],d.formatters={};var k,h=0},{11:11}],7:[function(d,c,f){(function(p){function h(){m=!0;for(var l,i,n=j.length;n;){for(i=j,j=[],l=-1;++l<n;){i[l]()}n=j.length}m=!1}function w(i){1!==j.push(i)||m||e()}var e,k=p.MutationObserver||p.WebKitMutationObserver;if(k){var q=0,v=new k(h),t=p.document.createTextNode("");v.observe(t,{characterData:!0}),e=function(){t.data=q=++q%2}}else{if(p.setImmediate||"undefined"==typeof p.MessageChannel){e="document" in p&&"onreadystatechange" in p.document.createElement("script")?function(){var i=p.document.createElement("script");i.onreadystatechange=function(){h(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},p.document.documentElement.appendChild(i)}:function(){setTimeout(h,0)}}else{var g=new p.MessageChannel;g.port1.onmessage=h,e=function(){g.port2.postMessage(0)}}}var m,j=[];c.exports=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(l){if(l){for(var k in l){"object"==typeof l[k]&&i[k]?h.call(i,i[k],l[k]):i[k]=l[k]}}}),i};this.extend=h}).call(this)},{}],10:[function(E,k,x){function D(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=C,this.queue=[],this.outcome=void 0,e!==D&&g(this,e)}function I(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function F(f,e,h){G(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function J(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(i,m){function f(o){e||(e=!0,d.reject(i,o))}function h(o){e||(e=!0,d.resolve(i,o))}function l(){m(h,f)}var e=!1,n=w(l);"error"===n.status&&f(n.value)}function w(f,i){var h={};try{h.value=f(i),h.status="success"}catch(e){h.status="error",h.value=e}return h}function A(e){return e instanceof this?e:d.resolve(new this(D),e)}function q(f){var e=new this(D);return d.reject(e,f)}function z(m){function e(r,s){function t(u){o[s]=u,++f!==h||l||(l=!0,d.resolve(n,o))}i.resolve(r).then(t,function(u){l||(l=!0,d.reject(n,u))})}var i=this;if("[object Array]"!==Object.prototype.toString.call(m)){return this.reject(new TypeError("must be an array"))}var h=m.length,l=!1;if(!h){return this.resolve([])}for(var o=new Array(h),f=0,p=-1,n=new this(D);++p<h;){e(m[p],p)}return n}function B(i){function m(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(h,p))},function(p){e||(e=!0,d.reject(h,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(i)){return this.reject(new TypeError("must be an array"))}var l=i.length,e=!1;if(!l){return this.resolve([])}for(var n=-1,h=new this(D);++n<l;){m(i[n])}return h}var G=E(7),d={},c=["REJECTED"],H=["FULFILLED"],C=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(e,i){if("function"!=typeof e&&this.state===H||"function"!=typeof i&&this.state===c){return this}var h=new this.constructor(D);if(this.state!==C){var f=this.state===H?e:i;F(h,f,this.outcome)}else{this.queue.push(new I(h,e,i))}return h},I.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},I.prototype.otherCallFulfilled=function(e){F(this.promise,this.onFulfilled,e)},I.prototype.callRejected=function(e){d.reject(this.promise,e)},I.prototype.otherCallRejected=function(e){F(this.promise,this.onRejected,e)},d.resolve=function(h,f){var l=w(J,f);if("error"===l.status){return d.reject(h,l.value)}var m=l.value;if(m){g(h,m)}else{h.state=H,h.outcome=f;for(var i=-1,e=h.queue.length;++i<e;){h.queue[i].callFulfilled(f)}}return h},d.reject=function(f,i){f.state=c,f.outcome=i;for(var h=-1,e=f.queue.length;++h<e;){f.queue[h].callRejected(i)}return f},j.resolve=A,j.reject=q,j.all=z,j.race=B},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(m,j,v){function C(o){if(null!==o){switch(typeof o){case"boolean":return o?1:0;case"number":return q(o);case"string":return o.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var n=Array.isArray(o),e=n?o:Object.keys(o),i=-1,l=e.length,f="";if(n){for(;++i<l;){f+=v.toIndexableString(e[i])}}else{for(;++i<l;){var h=e[i];f+=v.toIndexableString(h)+v.toIndexableString(o[h])}}return f}}return""}function d(r,h){var o,l=h,n="1"===r[h];if(n){o=0,h++}else{var p="0"===r[h];h++;var e="",i=r.substring(h,h+z),f=parseInt(i,10)+x;for(p&&(f=-f),h+=z;;){var s=r[h];if("\x00"===s){break}e+=s,h++}e=e.split("."),o=1===e.length?parseInt(e,10):parseFloat(e[0]+"."+e[1]),p&&(o-=10),0!==f&&(o=parseFloat(o+"e"+f))}return{num:o,length:h-l}}function c(e,i){var n=e.pop();if(i.length){var f=i[i.length-1];n===f.element&&(i.pop(),f=i[i.length-1]);var l=f.element,o=f.index;if(Array.isArray(l)){l.push(n)}else{if(o===e.length-2){var h=e.pop();l[h]=n}else{e.push(n)}}}}function y(i,f){for(var h=Math.min(i.length,f.length),l=0;h>l;l++){var e=v.collate(i[l],f[l]);if(0!==e){return e}}return i.length===f.length?0:i.length>f.length?1:-1}function B(f,e){return f===e?0:f>e?1:-1}function w(o,n){for(var e=Object.keys(o),i=Object.keys(n),l=Math.min(e.length,i.length),f=0;l>f;f++){var h=v.collate(e[f],i[f]);if(0!==h){return h}if(h=v.collate(o[e[f]],n[i[f]]),0!==h){return h}}return e.length===i.length?0:e.length>i.length?1:-1}function k(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function q(p){if(0===p){return"1"}var f=p.toExponential().split(/e\+?/),n=parseInt(f[1],10),i=0>p,l=i?"0":"2",o=(i?-n:n)-x,r=g.padLeft(o.toString(),"0",z);l+=A+r;var h=Math.abs(parseFloat(f[0]));i&&(h=10-h);var e=h.toFixed(20);return e=e.replace(/\.?0+$/,""),l+=A+e}var x=-324,z=3,A="",g=m(13);v.collate=function(h,e){if(h===e){return 0}h=v.normalizeKey(h),e=v.normalizeKey(e);var f=k(h),i=k(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return B(h,e)}return Array.isArray(h)?y(h,e):w(h,e)},v.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=v.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=v.normalizeKey(e))}}}}}return l},v.toIndexableString=function(f){var e="\x00";return f=v.normalizeKey(f),k(f)+A+C(f)+e},v.parseIndexableString=function(r){for(var h=[],n=[],l=0;;){var e=r[l++];if("\x00"!==e){switch(e){case"1":h.push(null);break;case"2":h.push("1"===r[l]),l++;break;case"3":var i=d(r,l);h.push(i.num),l+=i.length;break;case"4":for(var f="";;){var s=r[l];if("\x00"===s){break}f+=s,l++}f=f.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),h.push(f);break;case"5":var p={element:[],index:h.length};h.push(p.element),n.push(p);break;case"6":var o={element:{},index:h.length};h.push(o.element),n.push(o);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+e)}}else{if(1===h.length){return h.pop()}c(h,n)}}}},{13:13}],13:[function(c,f,d){function g(h,k,j){for(var e="",i=j-h.length;e.length<i;){e+=k}return e}d.padLeft=function(h,e,j){var i=g(h,e,j);return i+h},d.padRight=function(h,e,j){var i=g(h,e,j);return h+i},d.stringLexCompare=function(p,j){var m,l=p.length,h=j.length;for(m=0;l>m;m++){if(m===h){return 1}var k=p.charAt(m),e=j.charAt(m);if(k!==e){return e>k?-1:1}}return h>l?-1:0},d.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(f,c,h){function d(){this.store={}}function g(i){if(this.store=new d,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}h.Map=d,h.Set=g,d.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},d.prototype.unmangle=function(e){return e.substring(1)},d.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},d.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},d.prototype.has=function(i){var e=this.mangle(i);return e in this.store},d.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},d.prototype.forEach=function(k){for(var e=Object.keys(this.store),l=0,j=e.length;j>l;l++){var i=e[l],m=this.store[i];i=this.unmangle(i),k(m,i)}},g.prototype.add=function(e){return this.store.set(e,!0)},g.prototype.has=function(e){return this.store.has(e)},g.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(k,j){var i,m,l,h;m=[],h=[];for(i in j){e.call(j,i)&&(l=j[i],"this"!==i&&(m.push(i),h.push(l)))}return Function.apply(null,g.call(m).concat([k])).apply(j["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(C){function E(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function q(m,i,l,n,h,o,g){return E(i&l|~i&n,m,i,h,o,g)}function F(m,i,l,n,h,o,g){return E(i&n|l&~n,m,i,h,o,g)}function G(m,i,l,n,h,o,g){return E(i^l^n,m,i,h,o,g)}function A(m,i,l,n,h,o,g){return E(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=q(n,i,g,m,h[0],7,-680876936),m=q(m,n,i,g,h[1],12,-389564586),g=q(g,m,n,i,h[2],17,606105819),i=q(i,g,m,n,h[3],22,-1044525330),n=q(n,i,g,m,h[4],7,-176418897),m=q(m,n,i,g,h[5],12,1200080426),g=q(g,m,n,i,h[6],17,-1473231341),i=q(i,g,m,n,h[7],22,-45705983),n=q(n,i,g,m,h[8],7,1770035416),m=q(m,n,i,g,h[9],12,-1958414417),g=q(g,m,n,i,h[10],17,-42063),i=q(i,g,m,n,h[11],22,-1990404162),n=q(n,i,g,m,h[12],7,1804603682),m=q(m,n,i,g,h[13],12,-40341101),g=q(g,m,n,i,h[14],17,-1502002290),i=q(i,g,m,n,h[15],22,1236535329),n=F(n,i,g,m,h[1],5,-165796510),m=F(m,n,i,g,h[6],9,-1069501632),g=F(g,m,n,i,h[11],14,643717713),i=F(i,g,m,n,h[0],20,-373897302),n=F(n,i,g,m,h[5],5,-701558691),m=F(m,n,i,g,h[10],9,38016083),g=F(g,m,n,i,h[15],14,-660478335),i=F(i,g,m,n,h[4],20,-405537848),n=F(n,i,g,m,h[9],5,568446438),m=F(m,n,i,g,h[14],9,-1019803690),g=F(g,m,n,i,h[3],14,-187363961),i=F(i,g,m,n,h[8],20,1163531501),n=F(n,i,g,m,h[13],5,-1444681467),m=F(m,n,i,g,h[2],9,-51403784),g=F(g,m,n,i,h[7],14,1735328473),i=F(i,g,m,n,h[12],20,-1926607734),n=G(n,i,g,m,h[5],4,-378558),m=G(m,n,i,g,h[8],11,-2022574463),g=G(g,m,n,i,h[11],16,1839030562),i=G(i,g,m,n,h[14],23,-35309556),n=G(n,i,g,m,h[1],4,-1530992060),m=G(m,n,i,g,h[4],11,1272893353),g=G(g,m,n,i,h[7],16,-155497632),i=G(i,g,m,n,h[10],23,-1094730640),n=G(n,i,g,m,h[13],4,681279174),m=G(m,n,i,g,h[0],11,-358537222),g=G(g,m,n,i,h[3],16,-722521979),i=G(i,g,m,n,h[6],23,76029189),n=G(n,i,g,m,h[9],4,-640364487),m=G(m,n,i,g,h[12],11,-421815835),g=G(g,m,n,i,h[15],16,530742520),i=G(i,g,m,n,h[2],23,-995338651),n=A(n,i,g,m,h[0],6,-198630844),m=A(m,n,i,g,h[7],10,1126891415),g=A(g,m,n,i,h[14],15,-1416354905),i=A(i,g,m,n,h[5],21,-57434055),n=A(n,i,g,m,h[12],6,1700485571),m=A(m,n,i,g,h[3],10,-1894986606),g=A(g,m,n,i,h[10],15,-1051523),i=A(i,g,m,n,h[1],21,-2054922799),n=A(n,i,g,m,h[8],6,1873313359),m=A(m,n,i,g,h[15],10,-30611744),g=A(g,m,n,i,h[6],15,-1560198380),i=A(i,g,m,n,h[13],21,1309151649),n=A(n,i,g,m,h[4],6,-145523070),m=A(m,n,i,g,h[11],10,-1120210379),g=A(g,m,n,i,h[2],15,718787259),i=A(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function z(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function x(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function D(g){var p,h,o,r,m,l,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(p=64;i>=p;p+=64){M(n,z(g.substring(p-64,p)))}for(g=g.substring(p-64),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;h>p;p+=1){o[p>>2]|=g.charCodeAt(p)<<(p%4<<3)}if(o[p>>2]|=128<<(p%4<<3),p>55){for(M(n,o),p=0;16>p;p+=1){o[p]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=m,o[15]=l,M(n,o),n}function w(g){var l,h,o,r,m,p,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(l=64;i>=l;l+=64){M(n,x(g.subarray(l-64,l)))}for(g=i>l-64?g.subarray(l-64):new Uint8Array(0),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;h>l;l+=1){o[l>>2]|=g[l]<<(l%4<<3)}if(o[l>>2]|=128<<(l%4<<3),l>55){for(M(n,o),l=0;16>l;l+=1){o[l]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),p=parseInt(r[1],16)||0,o[14]=m,o[15]=p,M(n,o),n}function B(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function H(h){var g;for(g=0;g<h.length;g+=1){h[g]=B(h[g])}return h.join("")}function J(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function I(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==H(D("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(h,i){return h=0|h||0,0>h?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(o,l){var n,r,h,m,i=this.byteLength,s=g(o,i),p=i;return l!==C&&(p=g(l,i)),s>p?new ArrayBuffer(0):(n=p-s,r=new ArrayBuffer(n),h=new Uint8Array(r),m=new Uint8Array(this,s,n),h.set(m),r)}}(),I.prototype.append=function(g){return this.appendBinary(J(g)),this},I.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,z(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},I.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=H(this._hash),l&&(n=N(n)),this.reset(),n},I.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},I.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},I.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},I.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},I.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},I.hash=function(h,g){return I.hashBinary(J(h),g)},I.hashBinary=function(i,g){var l=D(i),h=H(l);return g?N(h):h},I.ArrayBuffer=function(){this.reset()},I.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,x(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},I.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=H(this._hash),l&&(n=N(n)),this.reset(),n},I.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},I.ArrayBuffer.prototype.getState=function(){var g=I.prototype.getState.call(this);return g.buff=j(g.buff),g},I.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),I.prototype.setState.call(this,g)},I.ArrayBuffer.prototype.destroy=I.prototype.destroy,I.ArrayBuffer.prototype._finish=I.prototype._finish,I.ArrayBuffer.hash=function(i,g){var l=w(new Uint8Array(i)),h=H(l);return g?N(h):h},I})},{}],17:[function(c,f,d){function g(p,j,m){var l=m[m.length-1];p===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,k=l.index;if(Array.isArray(h)){h.push(p)}else{if(k===j.length-2){var e=j.pop();h[e]=p}else{j.push(p)}}}d.stringify=function(h){var w=[];w.push({obj:h});for(var x,v,z,m,q,B,A,y,p,k,e,j="";x=w.pop();){if(v=x.obj,z=x.prefix||"",m=x.val||"",j+=z,m){j+=m}else{if("object"!=typeof v){j+="undefined"==typeof v?null:JSON.stringify(v)}else{if(null===v){j+="null"}else{if(Array.isArray(v)){for(w.push({val:"]"}),q=v.length-1;q>=0;q--){B=0===q?"":",",w.push({obj:v[q],prefix:B})}w.push({val:"["})}else{A=[];for(y in v){v.hasOwnProperty(y)&&A.push(y)}for(w.push({val:"}"}),q=A.length-1;q>=0;q--){p=A[q],k=v[p],e=q>0?",":"",e+=JSON.stringify(p)+":",w.push({obj:k,prefix:e})}w.push({val:"{"})}}}}}return j},d.parse=function(j){for(var h,e,v,y,m,z,q,r,p,x=[],w=[],k=0;;){if(h=j[k++],"}"!==h&&"]"!==h&&"undefined"!=typeof h){switch(h){case" ":case"	":case"\n":case":":case",":break;case"n":k+=3,g(null,x,w);break;case"t":k+=3,g(!0,x,w);break;case"f":k+=4,g(!1,x,w);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(e="",k--;;){if(v=j[k++],!/[\d\.\-e\+]/.test(v)){k--;break}e+=v}g(parseFloat(e),x,w);break;case'"':for(y="",m=void 0,z=0;;){if(q=j[k++],'"'===q&&("\\"!==m||z%2!==1)){break}y+=q,m=q,"\\"===m?z++:z=0}g(JSON.parse('"'+y+'"'),x,w);break;case"[":r={element:[],index:x.length},x.push(r.element),w.push(r);break;case"{":p={element:{},index:x.length},x.push(p.element),w.push(p);break;default:throw new Error("unexpectedly reached end of input: "+h)}}else{if(1===x.length){return x.pop()}g(x.pop(),x,w)}}}},{}]},{},[3])(3)});