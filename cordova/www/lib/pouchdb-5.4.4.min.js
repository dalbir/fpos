!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(m,i){if(!c[m]){if(!h[m]){var e="function"==typeof require&&require;if(!i&&e){return e(m,!0)}if(d){return d(m,!0)}var l=new Error("Cannot find module '"+m+"'");throw l.code="MODULE_NOT_FOUND",l}var k=c[m]={exports:{}};h[m][0].call(k.exports,function(o){var n=h[m][1][o];return g(n?n:o)},k,k.exports,a,h,c,f)}return c[m].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,l,f){function k(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}l.exports=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},k.prototype.emit=function(i){var p,e,m,o,q,n;if(this._events||(this._events={}),"error"===i&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(p=arguments[1],p instanceof Error){throw p}throw TypeError('Uncaught, unspecified "error" event.')}if(e=this._events[i],g(e)){return !1}if(d(e)){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),e.apply(this,o)}}else{if(c(e)){for(o=Array.prototype.slice.call(arguments,1),n=e.slice(),m=n.length,q=0;m>q;q++){n[q].apply(this,o)}}}return !0},k.prototype.addListener=function(m,i){var e;if(!d(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,d(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?k.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},k.prototype.on=k.prototype.addListener,k.prototype.once=function(e,m){function i(){this.removeListener(e,i),n||(n=!0,m.apply(this,arguments))}if(!d(m)){throw TypeError("listener must be a function")}var n=!1;return i.listener=m,this.on(e,i),this},k.prototype.removeListener=function(m,p){var o,n,e,i;if(!d(p)){throw TypeError("listener must be a function")}if(!this._events||!this._events[m]){return this}if(o=this._events[m],e=o.length,n=-1,o===p||d(o.listener)&&o.listener===p){delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,p)}else{if(c(o)){for(i=e;i-->0;){if(o[i]===p||o[i].listener&&o[i].listener===p){n=i;break}}if(0>n){return this}1===o.length?(o.length=0,delete this._events[m]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",m,p)}}return this},k.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],d(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},k.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?d(this._events[i])?[this._events[i]]:this._events[i].slice():[]},k.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(d(e)){return 1}if(e){return e.length}}return 0},k.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(q,x,d){function p(){v&&y&&(v=!1,y.length?w=y.concat(w):A=-1,w.length&&g())}function g(){if(!v){var f=j(p);v=!0;for(var e=w.length;e;){for(y=w,w=[];++A<e;){y&&y[A].run()}A=-1,e=w.length}y=null,v=!1,m(f)}}function k(f,e){this.fun=f,this.array=e}function c(){}var j,m,z=x.exports={};!function(){try{j=setTimeout}catch(e){j=function(){throw new Error("setTimeout is not defined")}}try{m=clearTimeout}catch(e){m=function(){throw new Error("clearTimeout is not defined")}}}();var y,w=[],v=!1,A=-1;z.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}w.push(new k(f,e)),1!==w.length||v||j(g,0)},k.prototype.run=function(){this.fun.apply(null,this.array)},z.title="browser",z.browser=!0,z.env={},z.argv=[],z.version="",z.versions={},z.on=c,z.addListener=c,z.once=c,z.off=c,z.removeListener=c,z.removeAllListeners=c,z.emit=c,z.binding=function(e){throw new Error("process.binding is not supported")},z.cwd=function(){return"/"},z.chdir=function(e){throw new Error("process.chdir is not supported")},z.umask=function(){return 0}},{}],3:[function(d,c,f){(function(fB,dg){function f5(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function f3(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function e(j){if("function"==typeof j.slice){return j.slice(0)}var h=new ArrayBuffer(j.byteLength),g=new Uint8Array(h),i=new Uint8Array(j);return g.set(i),h}function d2(h){if(h instanceof ArrayBuffer){return e(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function ed(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&f7.call(i)==b2}function aU(j){var h,g,i;if(!j||"object"!=typeof j){return j}if(Array.isArray(j)){for(h=[],g=0,i=j.length;i>g;g++){h[g]=aU(j[g])}return h}if(j instanceof Date){return j.toISOString()}if(f3(j)){return d2(j)}if(!ed(j)){return j}h={};for(g in j){if(Object.prototype.hasOwnProperty.call(j,g)){var k=aU(j[g]);"undefined"!=typeof k&&(h[g]=k)}}return h}function dh(g){var h=!1;return bb(function(i){if(h){throw new Error("once called more than once")}h=!0,g.apply(this,i)})}function dd(g){return bb(function(j){j=aU(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(m,n){fB.nextTick(function(){i(m,n)})});var h=new cJ(function(n,m){var p;try{var o=dh(function(r,s){r?m(r):n(s)});j.push(o),p=g.apply(l,j),p&&"function"==typeof p.then&&n(p)}catch(q){m(q)}});return k&&h.then(function(m){k(null,m)},k),h})}function c4(h,g){function i(j,n,l){if(dF.enabled){for(var o=[j._db_name,n],k=0;k<l.length-1;k++){o.push(l[k])}dF.apply(null,o);var m=l[l.length-1];l[l.length-1]=function(r,p){var q=[j._db_name,n];q=q.concat(r?["error",r]:["success",p]),dF.apply(null,q),m(r,p)}}}return dd(bb(function(j){if(this._closed){return cJ.reject(new Error("database is closed"))}if(this._destroyed){return cJ.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new cJ(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function eE(k,i){for(var h={},j=0,l=i.length;l>j;j++){var g=i[j];g in k&&(h[g]=k[g])}return h}function e4(g){return g}function bd(g){return[{ok:g}]}function dy(l,m,g){function r(){var w=[];j.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),g(null,{results:w})}function u(){++p===v&&r()}function i(x,w,y){j[x]={id:w,docs:y},u()}function q(){if(!(s>=h.length)){var x=Math.min(s+cS,h.length),w=h.slice(s,x);o(w,s),s+=w.length}}function o(x,w){x.forEach(function(z,D){var B=w+D,y=n[z],A=eE(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(e4);var C=e4;0===A.open_revs.length&&(delete A.open_revs,C=bd),["revs","attachments","binary","ajax"].forEach(function(E){E in m&&(A[E]=m[E])}),l.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),i(B,z,F),q()})})}var k=m.docs,n={};k.forEach(function(w){w.id in n?n[w.id].push(w):n[w.id]=[w]});var v=Object.keys(n).length,p=0,j=new Array(v),h=Object.keys(n),s=0;q()}function ch(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function eB(){return eZ}function eC(g){ch()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):eB()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function eK(){ca.EventEmitter.call(this),this._listeners={},eC(this)}function dX(g){if("undefined"!==console&&g in console){var h=Array.prototype.slice.call(arguments,1);console[g].apply(console,h)}}function ds(j,h){var g=600000;j=parseInt(j,10)||0,h=parseInt(h,10),h!==h||j>=h?h=(j||1)<<1:h+=1,h>g&&(j=g>>1,h=g);var i=Math.random(),k=h-j;return ~~(k*i+j)}function aL(g){var h=0;return g||(h=2000),ds(g,h)}function c1(g,h){dX("info","The above "+g+" is totally normal. "+h)}function db(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function eX(j,h,g){function i(k){for(var l in j){"function"!=typeof j[l]&&(this[l]=j[l])}void 0!==g&&(this.name=g),void 0!==k&&(this.reason=k)}return i.prototype=db.prototype,new i(h)}function c9(k){var i,h,j,l,g;return h=k.error===!0&&"string"==typeof k.name?k.name:k.error,g=k.reason,j=cD("name",h,g),k.missing||"missing"===g||"deleted"===g||"not_found"===h?j=cs:"doc_validation"===h?(j=kh,l=g):"bad_request"===h&&j.message!==g&&(j=bw),j||(j=cD("status",k.status,g)||d5),i=eX(j,g,h),l&&(i.message=l),k.id&&(i.id=k.id),k.status&&(i.status=k.status),k.missing&&(i.missing=k.missing),i}function bc(j,h,g){try{return !j(h,g)}catch(i){var k="Filter function threw: "+i.toString();return eX(bw,k)}}function d8(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&bc(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function jN(j){for(var h=[],g=0,i=j.length;i>g;g++){h=h.concat(j[g])}return h}function bH(g){var h;if(g?"string"!=typeof g?h=eX(e9):/^_/.test(g)&&!/^_(design|local)/.test(g)&&(h=eX(fO)):h=eX(eP),h){throw h}}function eG(g,h){return"listenerCount" in g?g.listenerCount(h):ca.EventEmitter.listenerCount(g,h)}function e0(g){if(!g){return null}var h=g.split("/");return 2===h.length?h:1===h.length?[g,g]:null}function cU(g){var h=e0(g);return h?h.join("/"):null}function cO(m){for(var k=eJ.exec(m),g={},l=14;l--;){var i=f1[l],j=k[l]||"",h=-1!==["user","password"].indexOf(i);g[i]=h?decodeURIComponent(j):j}return g[eW]={},g[f1[12]].replace(fI,function(o,p,n){p&&(g[eW][p]=n)}),g}function aD(h,g,i){return new cJ(function(j,k){h.get(g,function(o,m){if(o){if(404!==o.status){return k(o)}m={}}var l=m._rev,n=i(m);return n?(n._id=g,n._rev=l,void j(aP(h,n,i))):j({updated:!1,rev:l})})})}function aP(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return aD(h,g._id,i)})}function dY(g){return 0|Math.random()*g}function cm(j,h){h=h||eQ.length;var g="",i=-1;if(j){for(;++i<j;){g+=eQ[dY(h)]}return g}for(;++i<36;){switch(i){case 8:case 13:case 18:case 23:g+="-";break;case 19:g+=eQ[3&dY(16)|8];break;default:g+=eQ[dY(16)]}}return g}function d3(r){for(var p,g,q,s,i=r.rev_tree.slice();s=i.pop();){var n=s.ids,j=n[2],o=s.pos;if(j.length){for(var m=0,k=j.length;k>m;m++){i.push({pos:o+1,ids:j[m]})}}else{var h=!!n[1].deleted,l=n[0];p&&!(q!==h?q:g!==o?o>g:l>p)||(p=l,g=o,q=h)}}return g+"-"+p}function eU(j,l){for(var h,o=j.slice();h=o.pop();){for(var g=h.pos,i=h.ids,k=i[2],m=l(0===k.length,g,i[0],h.ctx,i[1]),n=0,p=k.length;p>n;n++){o.push({pos:g+1,ids:k[n],ctx:m})}}}function eI(g,h){return g.pos-h.pos}function bi(j){var h=[];eU(j,function(n,k,m,o,l){n&&h.push({rev:k+"-"+m,pos:k,opts:l})}),h.sort(eI).reverse();for(var g=0,i=h.length;i>g;g++){delete h[g].pos}return h}function e8(m){for(var k=d3(m),g=bi(m.rev_tree),l=[],i=0,j=g.length;j>i;i++){var h=g[i];h.rev===k||h.opts.deleted||l.push(h.rev)}return l}function af(g){var h=[];return eU(g.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(h.push(i+"-"+k),j.status="missing")}),h}function cP(r){for(var p,g=[],q=r.slice();p=q.pop();){var s=p.pos,i=p.ids,n=i[0],j=i[1],o=i[2],m=0===o.length,k=p.history?p.history.slice():[];k.push({id:n,opts:j}),m&&g.push({pos:s+1-k.length,ids:k});for(var h=0,l=o.length;l>h;h++){q.push({pos:s+1,ids:o[h],history:k})}}return g.reverse()}function j4(g,h){return g.pos-h.pos}function fM(k,i,h){for(var j,l=0,g=k.length;g>l;){j=l+g>>>1,h(k[j],i)<0?l=j+1:g=j}return l}function f0(j,h,g){var i=fM(j,h,g);j.splice(i,0,h)}function a8(h,i){for(var j,k,m=i,n=h.length;n>m;m++){var l=h[m],g=[l.id,l.opts,[]];k?(k[2].push(g),k=g):j=k=g}return j}function du(g,h){return g[0]<h[0]?-1:1}function eb(j,l){for(var h=[{tree1:j,tree2:l}],o=!1;h.length>0;){var g=h.pop(),i=g.tree1,k=g.tree2;(i[1].status||k[1].status)&&(i[1].status="available"===i[1].status||"available"===k[1].status?"available":"missing");for(var m=0;m<k[2].length;m++){if(i[2][0]){for(var n=!1,p=0;p<i[2].length;p++){i[2][p][0]===k[2][m][0]&&(h.push({tree1:i[2][p],tree2:k[2][m]}),n=!0)}n||(o="new_branch",f0(i[2],k[2][m],du))}else{o="new_leaf",i[2][0]=k[2][m]}}}return{conflicts:o,tree:j}}function fH(p,r,o){var m,k=[],s=!1,A=!1;if(!p.length){return{tree:[r],conflicts:"new_leaf"}}for(var u=0,j=p.length;j>u;u++){var n=p[u];if(n.pos===r.pos&&n.ids[0]===r.ids[0]){m=eb(n.ids,r.ids),k.push({pos:n.pos,ids:m.tree}),s=s||m.conflicts,A=!0}else{if(o!==!0){var z=n.pos<r.pos?n:r,q=n.pos<r.pos?r:n,x=q.pos-z.pos,v=[],i=[];for(i.push({ids:z.ids,diff:x,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],y=0,w=g.length;w>y;y++){i.push({ids:g[y],diff:h.diff-1,parent:h.ids,parentIdx:y})}}else{h.ids[0]===q.ids[0]&&v.push(h)}}var l=v[0];l?(m=eb(l.ids,q.ids),l.parent[2][l.parentIdx]=m.tree,k.push({pos:z.pos,ids:z.ids}),s=s||m.conflicts,A=!0):k.push(n)}else{k.push(n)}}}return A||k.push(r),k.sort(j4),{tree:k,conflicts:s||"internal_node"}}function jJ(r,p){for(var g,q=cP(r),s={},i=0,n=q.length;n>i;i++){for(var j=q[i],o=j.ids,m=Math.max(0,o.length-p),k={pos:j.pos+m,ids:a8(o,m)},h=0;m>h;h++){var l=j.pos+h+"-"+o[h].id;s[l]=!0}g=g?fH(g,k,!0).tree:[k]}return eU(g,function(w,v,u){delete s[v+"-"+u]}),{tree:g,revs:Object.keys(s)}}function bI(j,h,g){var i=fH(j,h),k=jJ(i.tree,g);return{tree:k.tree,stemmedRevs:k.revs,conflicts:i.conflicts}}function cE(j,l){for(var h,o=j.slice(),g=l.split("-"),i=parseInt(g[0],10),k=g[1];h=o.pop();){if(h.pos===i&&h.ids[0]===k){return !0}for(var m=h.ids[2],n=0,p=m.length;p>n;n++){o.push({pos:h.pos+1,ids:m[n]})}}return !1}function fD(g){return g.ids}function aA(j,h){h||(h=d3(j));for(var g,i=h.substring(h.indexOf("-")+1),k=j.rev_tree.map(fD);g=k.pop();){if(g[0]===i){return !!g[1].deleted}k=k.concat(g[2])}}function dT(g){return/^_local/.test(g)}function aY(g){return b6("return "+g+";",{})}function jY(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function dZ(h,g){try{h.emit("change",g)}catch(i){dX("error",'Error in .on("change", function):',i)}}function eM(m,k,g){function l(){i.cancel()}ca.EventEmitter.call(this);var i=this;this.db=m,k=k?aU(k):{};var j=k.complete=dh(function(n,o){n?eG(i,"error")>0&&i.emit("error",n):i.emit("complete",o),i.removeAllListeners(),m.removeListener("destroyed",l)});g&&(i.on("complete",function(n){g(null,n)}),i.on("error",g)),m.once("destroyed",l),k.onChange=function(n){k.isCancelled||(dZ(i,n),i.startSeq&&i.startSeq<=n.seq&&(i.startSeq=!1))};var h=new cJ(function(n,o){k.complete=function(p,q){p?o(p):n(q)}});i.once("cancel",function(){m.removeListener("destroyed",l),k.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){j(null,n)},j),m.taskqueue.isReady?i.doChanges(k):m.taskqueue.addTask(function(){i.isCancelled?i.emit("cancel"):i.doChanges(k)})}function dH(j,h,g){var i=[{rev:j._rev}];"all_docs"===g.style&&(i=bi(h.rev_tree).map(function(l){return{rev:l.rev}}));var k={id:h.id,changes:i,doc:j};return aA(h,j._rev)&&(k.deleted=!0),g.conflicts&&(k.doc._conflicts=e8(h),k.doc._conflicts.length||delete k.doc._conflicts),k}function eh(g,h){return h>g?-1:g>h?1:0}function fN(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function cI(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function ad(k){for(var i=0;i<k.length;i++){var h=k[i];if(h._deleted){delete h._attachments}else{if(h._attachments){for(var j=Object.keys(h._attachments),l=0;l<j.length;l++){var g=j[l];h._attachments[g]=eE(h._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function aj(j,h){var g=eh(j._id,h._id);if(0!==g){return g}var i=j._revisions?j._revisions.start:0,k=h._revisions?h._revisions.start:0;return eh(i,k)}function cV(h){var g={},i=[];return eU(h,function(n,m,j,l){var k=m+"-"+j;return n&&(g[k]=0),void 0!==l&&i.push({from:l,to:k}),k}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function ki(j,h,g){var i="limit" in h?h.keys.slice(h.skip,h.limit+h.skip):h.skip>0?h.keys.slice(h.skip):h.keys;if(h.descending&&i.reverse(),!i.length){return j._allDocs({limit:0},g)}var k={offset:h.skip};return cJ.all(i.map(function(m){var l=j9.extend({key:m,deleted:"ok"},h);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new cJ(function(n,o){j._allDocs(l,function(q,p){return q?o(q):(k.total_rows=p.total_rows,void n(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return k.rows=l,k})}function aI(j){var h=j._compactionQueue[0],i=h.opts,g=h.callback;j.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(i.last_seq=k.last_seq),j._compact(i,function(l,m){l?g(l):g(null,m),fB.nextTick(function(){j._compactionQueue.shift(),j._compactionQueue.length&&aI(j)})})})}function e3(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function av(){ca.EventEmitter.call(this)}function bq(){this.isReady=!1,this.failed=!1,this.queue=[]}function eA(g){g&&dg.debug&&dX("error",g)}function dE(m,k){function g(){j.emit("destroyed",i)}function l(){m.removeListener("destroyed",g),m.emit("destroyed",m)}var i=k.originalName,j=m.constructor,h=j._destructionListeners;m.once("destroyed",g),h.has(i)||h.set(i,[]),h.get(i).push(l)}function dk(m,k,g){if(!(this instanceof dk)){return new dk(m,k,g)}var l=this;if("function"!=typeof k&&"undefined"!=typeof k||(g=k,k={}),m&&"object"==typeof m&&(k=m,m=void 0),"undefined"==typeof g){g=eA}else{var i=g;g=function(){return dX("warn","Using a callback for new PouchDB()is deprecated."),i.apply(null,arguments)}}m=m||k.name,k=aU(k),delete k.name,this.__opts=k;var j=g;l.auto_compaction=k.auto_compaction,l.prefix=dk.prefix,av.call(l),l.taskqueue=new bq;var h=new cJ(function(n,p){g=function(r,s){return r?p(r):(delete s.then,void n(s))},k=aU(k);var o,q;return function(){try{if("string"!=typeof m){throw q=new Error("Missing/invalid DB name"),q.code=400,q}var r=(k.prefix||"")+m;if(o=dk.parseAdapter(r,k),k.originalName=m,k.name=o.name,k.adapter=k.adapter||o.adapter,l._adapter=k.adapter,by("pouchdb:adapter")("Picked adapter: "+k.adapter),l._db_name=m,!dk.adapters[k.adapter]){throw q=new Error("Adapter is missing"),q.code=404,q}if(!dk.adapters[k.adapter].valid()){throw q=new Error("Invalid Adapter"),q.code=404,q}}catch(s){l.taskqueue.fail(s)}}(),q?p(q):(l.adapter=k.adapter,l.replicate={},l.replicate.from=function(r,u,s){return l.constructor.replicate(r,l,u,s)},l.replicate.to=function(r,u,s){return l.constructor.replicate(l,r,u,s)},l.sync=function(r,u,s){return l.constructor.sync(l,r,u,s)},l.replicate.sync=l.sync,void dk.adapters[k.adapter].call(l,k,function(r){return r?(l.taskqueue.fail(r),void g(r)):(dE(l,k),l.emit("created",l),dk.emit("created",k.originalName),l.taskqueue.ready(l),void g(null,l))}))});h.then(function(n){j(null,n)},j),l.then=h.then.bind(h),l["catch"]=h["catch"].bind(h)}function bS(g){Object.keys(ca.EventEmitter.prototype).forEach(function(i){"function"==typeof ca.EventEmitter.prototype[i]&&(g[i]=c2[i].bind(c2))});var h=g._destructionListeners=new aK.Map;g.on("destroyed",function(i){h.get(i).forEach(function(j){j()}),h["delete"](i)})}function dC(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function bs(j){if(!/^\d+\-./.test(j)){return eX(ck)}var h=j.indexOf("-"),g=j.substring(0,h),i=j.substring(h+1);return{prefix:parseInt(g,10),id:i}}function eg(m,k){for(var g=m.start-m.ids.length+1,l=m.ids,i=[l[0],k,[]],j=1,h=l.length;h>j;j++){i=[l[j],{status:"missing"},[i]]}return[{pos:g,ids:i}]}function cp(j,l){var h,o,g,i={status:"available"};if(j._deleted&&(i.deleted=!0),l){if(j._id||(j._id=cm()),o=cm(32,16).toLowerCase(),j._rev){if(g=bs(j._rev),g.error){return g}j._rev_tree=[{pos:g.prefix,ids:[g.id,{status:"missing"},[[o,i,[]]]]}],h=g.prefix+1}else{j._rev_tree=[{pos:1,ids:[o,i,[]]}],h=1}}else{if(j._revisions&&(j._rev_tree=eg(j._revisions,i),h=j._revisions.start,o=j._revisions.ids[0]),!j._rev_tree){if(g=bs(j._rev),g.error){return g}h=g.prefix,o=g.id,j._rev_tree=[{pos:h,ids:[o,i,[]]}]}}bH(j._id),j._rev=h+"-"+o;var k={metadata:{},data:{}};for(var m in j){if(Object.prototype.hasOwnProperty.call(j,m)){var n="_"===m[0];if(n&&!fG[m]){var p=eX(kh,m);throw p.message=kh.message+": "+m,p}n&&!cu[m]?k.metadata[m.slice(1)]=j[m]:k.data[m]=j[m]}}return k}function jG(j){for(var h="",g=new Uint8Array(j),i=g.byteLength,k=0;i>k;k++){h+=String.fromCharCode(g[k])}return h}function bk(g){return cA(jG(g))}function bR(k,i){k=k||[],i=i||{};try{return new Blob(k,i)}catch(h){if("TypeError"!==h.name){throw h}for(var j="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,l=new j,g=0;g<k.length;g+=1){l.append(k[g])}return l.getBlob(i.type)}}function j8(j){for(var h=j.length,g=new ArrayBuffer(h),i=new Uint8Array(g),k=0;h>k;k++){i[k]=j.charCodeAt(k)}return g}function aE(g,h){return bR([j8(g)],{type:h})}function dv(g,h){return aE(d1(g),h)}function t(j,h){if("undefined"==typeof FileReader){return h(jG((new FileReaderSync).readAsArrayBuffer(j)))}var g=new FileReader,i="function"==typeof g.readAsBinaryString;g.onloadend=function(k){var l=k.target.result||"";return i?h(l):void h(jG(l))},i?g.readAsBinaryString(j):g.readAsArrayBuffer(j)}function cR(g,h){t(g,function(i){h(cA(i))})}function b8(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function j1(g){return cA(g)}function fE(j,h,g,i){(g>0||i<h.byteLength)&&(h=new Uint8Array(h,g,Math.min(i,h.byteLength)-g)),j.append(h)}function eO(j,h,g,i){(g>0||i<h.length)&&(h=h.substring(g,i)),j.appendBinary(h)}function dj(j,l){function h(){var q=m*i,u=q+i;if(m++,k>m){p(n,j,q,u),dP(h)}else{p(n,j,q,u);var r=n.end(!0),s=j1(r);l(s),n.destroy()}}var o="string"==typeof j,g=o?j.length:j.byteLength,i=Math.min(bG,g),k=Math.ceil(g/i),m=0,n=o?new bW:new bW.ArrayBuffer,p=o?eO:fE;h()}function eR(g){return bW.hash(g)}function fJ(h,i,j){function k(o){try{return d1(o)}catch(q){var p=eX(dJ,"Attachment is not a valid base64 string");return{error:p}}}function m(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=k(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===i?q.data=aE(o,q.content_type):"base64"===i?q.data=cA(o):q.data=o,dj(o,function(r){q.digest="md5-"+r,p()})}else{b8(q.data,function(r){"binary"===i?q.data=jG(r):"base64"===i&&(q.data=bk(r)),dj(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function n(){g++,h.length===g&&(l?j(l):j())}if(!h.length){return j()}var l,g=0;h.forEach(function(r){function p(u){l=u,q++,q===s.length&&n()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return n()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&m(r.data._attachments[o],p)}})}function bM(q,A,w,u,z,h,y,p){if(cE(A.rev_tree,w.metadata.rev)){return u[z]=w,h()}var l=A.winningRev||d3(A),m="deleted" in A?A.deleted:aA(A,l),r="deleted" in w.metadata?w.metadata.deleted:aA(w.metadata),n=/^1-/.test(w.metadata.rev);if(m&&!r&&p&&n){var s=w.data;s._rev=l,s._id=w.metadata.id,w=cp(s,p)}var g=bI(A.rev_tree,w.metadata.rev_tree[0],q),k=p&&(m&&r||!m&&"new_leaf"!==g.conflicts||m&&!r&&"new_branch"===g.conflicts);if(k){var j=eX(cY);return u[z]=j,h()}var i=w.metadata.rev;w.metadata.rev_tree=g.tree,w.stemmedRevs=g.stemmedRevs||[],A.rev_map&&(w.metadata.rev_map=A.rev_map);var v,B=d3(w.metadata),o=aA(w.metadata,B),x=m===o?0:o>m?-1:1;v=i===B?o:aA(w.metadata,i),y(w,B,o,v,!0,x,z,h)}function j7(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function c3(u,k,m,g,i,o,j,n,s){function v(C,B,x){var D=d3(C.metadata),z=aA(C.metadata,D);if("was_delete" in n&&z){return o[B]=eX(cs,"deleted"),x()}var A=l&&j7(C);if(A){var w=eX(cY);return o[B]=w,x()}var y=z?0:1;j(C,D,z,z,!1,y,B,x)}function q(){++h===p&&s&&s()}u=u||1000;var l=n.new_edits,r=new aK.Map,h=0,p=k.length;k.forEach(function(w,y){if(w._id&&dT(w._id)){var z=w._deleted?"_removeLocal":"_putLocal";return void m[z](w,{ctx:i},function(B,A){o[y]=B||A,q()})}var x=w.metadata.id;r.has(x)?(p--,r.get(x).push([w,y])):r.set(x,[[w,y]])}),r.forEach(function(z,x){function w(){++y<z.length?A():q()}function A(){var C=z[y],E=C[0],D=C[1];if(g.has(x)){bM(u,g.get(x),E,o,D,w,j,l)}else{var B=bI([],E.metadata.rev_tree[0],u);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],v(E,D,w)}}var y=0;A()})}function bf(g){try{return JSON.parse(g)}catch(h){return aZ.parse(g)}}function bl(g){return g.length<50000?JSON.parse(g):bf(g)}function aa(g){try{return JSON.stringify(g)}catch(h){return aZ.stringify(g)}}function jV(j,h,g,i){try{j.apply(h,g)}catch(k){i.emit("error",k)}}function bJ(g){if(!cv.running&&cv.queue.length){cv.running=!0;var h=cv.queue.shift();h.action(function(i,j){jV(h.callback,this,[i,j],g),cv.running=!1,fB.nextTick(function(){bJ(g)})})}}function aB(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(eX(eH,i,h.type))}}function dz(h,g,i){return{data:aa(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function aO(g){if(!g){return null}var h=bl(g.data);return h.winningRev=g.winningRev,h.deleted="1"===g.deletedOrLocal,h.seq=g.seq,h}function jM(g){if(!g){return g}var h=g._doc_id_rev.lastIndexOf(":");return g._id=g._doc_id_rev.substring(0,h-1),g._rev=g._doc_id_rev.substring(h+1),delete g._doc_id_rev,g}function aQ(j,h,g,i){g?i(j?"string"!=typeof j?j:dv(j,h):bR([""],{type:h})):j?"string"!=typeof j?t(j,function(k){i(cA(k))}):i(j):i("")}function cZ(h,i,j,k){function m(){++g===l.length&&k&&k()}function n(s,q){var r=s._attachments[q],p=r.digest,o=j.objectStore(f4).get(p);o.onsuccess=function(u){r.body=u.target.result.body,m()}}var l=Object.keys(h._attachments||{});if(!l.length){return k&&k()}var g=0;l.forEach(function(o){i.attachments&&i.include_docs?n(h,o):(h._attachments[o].stub=!0,m())})}function b1(g,h){return cJ.all(g.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return cJ.all(j.map(function(k){var m=i.doc._attachments[k];if("body" in m){var n=m.body,l=m.content_type;return new cJ(function(o){aQ(n,l,h,function(p){i.doc._attachments[k]=j9.extend(eE(m,["digest","content_type"]),{data:p}),o()})})}}))}}))}function aR(j,l,h){function o(){p--,p||g()}function g(){i.length&&i.forEach(function(q){var r=n.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||m["delete"](q)}})}var i=[],k=h.objectStore(dG),m=h.objectStore(f4),n=h.objectStore(cB),p=j.length;j.forEach(function(s){var r=k.index("_doc_id_rev"),q=l+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return o()}k["delete"](u);var w=n.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];i.push(x),n["delete"](y.primaryKey),y["continue"]()}else{o()}}}})}function fK(j,h,g){try{return{txn:j.transaction(h,g)}}catch(i){return{error:i}}}function b4(v,H,r,m,x,j,k){function D(){var P=[e7,dG,f4,cN,cB],O=fK(x,P,"readwrite");return O.error?k(O.error):(I=O.txn,I.onabort=aB(k),I.ontimeout=aB(k),I.oncomplete=G,A=I.objectStore(e7),y=I.objectStore(dG),w=I.objectStore(f4),E=I.objectStore(cB),void g(function(Q){return Q?(s=!0,k(Q)):void h()}))}function C(){c3(v.revs_limit,z,m,N,I,L,l,r)}function h(){function T(){++O===z.length&&C()}function R(W){var V=aO(W.target.result);V&&N.set(V.id,V),T()}if(z.length){for(var O=0,S=0,U=z.length;U>S;S++){var Q=z[S];if(Q._id&&dT(Q._id)){T()}else{var P=A.get(Q.metadata.id);P.onsuccess=R}}}}function G(){s||(j.notify(m._meta.name),m._meta.docCount+=B,k(null,L))}function p(P,O){var Q=w.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=eX(cM,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(z.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){p(T,function(U){U&&!P&&(P=U),O()})})}function l(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?n(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(an){var ae=X.stemmedRevs||[];R&&m.auto_compaction&&(ae=ae.concat(af(X.metadata))),ae&&ae.length&&aR(ae,X.metadata.id,I),T.seq=an.target.result,delete T.rev;var ao=dz(T,Q,S),ai=A.put(ao);ai.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=y.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=y.put(V,ar.target.result);ao.onsuccess=W}}function Z(){L[U]={ok:!0,id:T.id,rev:Q},N.set(X.metadata.id,X.metadata),u(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=y.put(V);Y.onsuccess=W,Y.onerror=P}function n(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;q(an,ai,Q)}})}function u(T,Q,V){function S(){++P===O.length&&V()}function U(W){var Y=T.data._attachments[W].digest,X=E.put({seq:Q,digestSeq:Y+"::"+Q});X.onsuccess=S,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),S()}}var P=0,O=Object.keys(T.data._attachments||{});if(!O.length){return V()}for(var R=0;R<O.length;R++){U(O[R])}}function q(Q,O,R){var P=w.count(Q);P.onsuccess=function(T){var U=T.target.result;if(U){return R()}var S={digest:Q,body:O},V=w.put(S);V.onsuccess=R}}for(var I,A,y,w,E,o,z=H.docs,B=0,F=0,J=z.length;J>F;F++){var M=z[F];M._id&&dT(M._id)||(M=z[F]=cp(M,r.new_edits),M.error&&!o&&(o=M))}if(o){return k(o)}var L=new Array(z.length),N=new aK.Map,s=!1,i=m._meta.blobSupport?"blob":"base64";fJ(z,i,function(O){return O?k(O):void D()})}function c5(k,i,h,j,l){try{if(k&&i){return l?IDBKeyRange.bound(i,k,!h,!1):IDBKeyRange.bound(k,i,!1,!h)}if(k){return l?IDBKeyRange.upperBound(k):IDBKeyRange.lowerBound(k)}if(i){return l?IDBKeyRange.lowerBound(i,!h):IDBKeyRange.upperBound(i,!h)}if(j){return IDBKeyRange.only(j)}}catch(g){return{error:g}}return null}function cQ(j,h,g,i){return"DataError"===g.name&&0===g.code?i(null,{total_rows:j._meta.docCount,offset:h.skip,rows:[]}):void i(eX(eH,g.name,g.message))}function bB(k,i,h,j){function l(B,J){function u(O,N,L){var M=O.id+"::"+L;n.get(M).onsuccess=function(P){N.doc=jM(P.target.result),B.conflicts&&(N.doc._conflicts=e8(O)),cZ(N.doc,B,G)}}function v(N,P,O){var M={id:O.id,key:O.id,value:{rev:P}},L=O.deleted;if("ok"===B.deleted){p.push(M),L?(M.value.deleted=!0,M.doc=null):B.include_docs&&u(O,M,P)}else{if(!L&&s--<=0&&(p.push(M),B.include_docs&&u(O,M,P),0===--r)){return}}N["continue"]()}function x(L){K=i._meta.docCount;var N=L.target.result;if(N){var O=aO(N.value),M=O.winningRev;v(N,M,O)}}function H(){J(null,{total_rows:K,offset:B.skip,rows:p})}function I(){B.attachments?b1(p,B.binary).then(H):H()}var A="startkey" in B?B.startkey:!1,y="endkey" in B?B.endkey:!1,o="key" in B?B.key:!1,s=B.skip||0,r="number"==typeof B.limit?B.limit:-1,C=B.inclusive_end!==!1,z="descending" in B&&B.descending?"prev":null,q=c5(A,y,C,o,z);if(q&&q.error){return cQ(i,B,q.error,J)}var E=[e7,dG];B.attachments&&E.push(f4);var F=fK(h,E,"readonly");if(F.error){return J(F.error)}var G=F.txn,w=G.objectStore(e7),m=G.objectStore(dG),D=z?w.openCursor(q,z):w.openCursor(q),n=m.index("_doc_id_rev"),p=[],K=0;G.oncomplete=I,D.onsuccess=x}function g(n,m){return 0===n.limit?m(null,{total_rows:i._meta.docCount,offset:n.skip,rows:[]}):void l(n,m)}g(k,j)}function aG(g){return new cJ(function(h){var i=bR([""]);g.objectStore(aH).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function j0(h,g){var i=this;cv.queue.push({action:function(j){al(i,h,j)},callback:g}),bJ(i.constructor)}function al(n,o,u){function h(x){var w=x.createObjectStore(e7,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(f4,{keyPath:"digest"}),x.createObjectStore(jQ,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aH),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(cN,{keyPath:"_id"});var v=x.createObjectStore(cB,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function i(x,w){var v=x.objectStore(e7);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=aA(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function s(v){v.createObjectStore(cN,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function m(z,w){var v=z.objectStore(cN),x=z.objectStore(e7),y=z.objectStore(dG),A=x.openCursor();A.onsuccess=function(K){var H=K.target.result;if(H){var B=H.value,E=B.id,D=dT(E),M=d3(B);if(D){var J=E+"::"+M,G=E+"::",L=E+"::~",I=y.index("_doc_id_rev"),F=IDBKeyRange.bound(G,L,!1,!1),C=I.openCursor(F);C.onsuccess=function(N){if(C=N.target.result){var O=C.value;O._doc_id_rev===J&&v.put(O),y["delete"](C.primaryKey),C["continue"]()}else{x["delete"](H.primaryKey),H["continue"]()}}}else{H["continue"]()}}else{w&&w()}}}function j(w){var v=w.createObjectStore(cB,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function k(z,w){var v=z.objectStore(dG),x=z.objectStore(f4),y=z.objectStore(cB),A=x.count();A.onsuccess=function(B){var C=B.target.result;return C?void (v.openCursor().onsuccess=function(G){var M=G.target.result;if(!M){return w()}for(var L=M.value,E=M.primaryKey,I=Object.keys(L._attachments||{}),K={},J=0;J<I.length;J++){var H=L._attachments[I[J]];K[H.digest]=!0}var F=Object.keys(K);for(J=0;J<F.length;J++){var D=F[J];y.put({seq:E,digestSeq:D+"::"+E})}M["continue"]()}):w()}}function p(v){function w(A){return A.data?aO(A):(A.deleted="1"===A.deletedOrLocal,A)}var z=v.objectStore(dG),y=v.objectStore(e7),x=y.openCursor();x.onsuccess=function(C){function D(){var H=A.id+"::",F=A.id+"::￿",G=z.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,B()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function B(){var G=dz(A,A.winningRev,A.deleted),F=y.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var A=w(E.value);return A.winningRev=A.winningRev||d3(A),A.seq?B():void D()}}}var g=o.name,q=null;n._meta=null,n.type=function(){return"idb"},n._id=dd(function(v){v(null,n._meta.instanceId)}),n._bulkDocs=function(v,w,x){b4(o,v,w,n,q,cW,x)},n._get=function(y,C,B){function w(){B(z,{doc:x,metadata:v,ctx:D})}var x,v,z,D=C.ctx;if(!D){var A=fK(q,[e7,dG,f4],"readonly");if(A.error){return B(A.error)}D=A.txn}D.objectStore(e7).get(y).onsuccess=function(E){if(v=aO(E.target.result),!v){return z=eX(cs,"missing"),w()}if(aA(v)&&!C.rev){return z=eX(cs,"deleted"),w()}var G=D.objectStore(dG),H=C.rev||v.winningRev,F=v.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return x=I.target.result,x&&(x=jM(x)),x?void w():(z=eX(cs,"missing"),w())}}},n._getAttachment=function(y,C,B,w,x){var v;if(w.ctx){v=w.ctx}else{var z=fK(q,[e7,dG,f4],"readonly");if(z.error){return x(z.error)}v=z.txn}var D=B.digest,A=B.content_type;v.objectStore(f4).get(D).onsuccess=function(E){var F=E.target.result.body;aQ(F,A,w.binary,function(G){x(null,G)})}},n._info=function(A){if(null===q||!dM.has(g)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,w,B=fK(q,[dG],"readonly");if(B.error){return A(B.error)}var z=B.txn,x=z.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,w=n._meta.docCount},z.oncomplete=function(){A(null,{doc_count:w,update_seq:v,idb_attachment_format:n._meta.blobSupport?"binary":"base64"})}},n._allDocs=function(v,w){bB(v,n,q,w)},n._changes=function(B){function x(N){function T(){return S.seq!==O?N["continue"]():(M=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=J.get(U);V.onsuccess=function(W){R(jM(W.target.result))}}function R(V){var W=B.processChange(V,S,B);W.seq=S.seq;var U=I(W);return"object"==typeof U?B.complete(U):(U&&(F++,E&&G.push(W),B.attachments&&B.include_docs?cZ(V,B,C,function(){b1([W],B.binary).then(function(){B.onChange(W)})}):B.onChange(W)),void (F!==L&&N["continue"]()))}var P=jM(N.value),O=N.key;if(z&&!z.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (H.get(P._id).onsuccess=function(U){S=aO(U.target.result),y.set(P._id,S),T()})}function K(N){var O=N.target.result;O&&x(O)}function D(){var P=[e7,dG];B.attachments&&P.push(f4);var O=fK(q,P,"readonly");if(O.error){return B.complete(O.error)}C=O.txn,C.onabort=aB(B.complete),C.oncomplete=A,w=C.objectStore(dG),H=C.objectStore(e7),J=w.index("_doc_id_rev");var N;N=B.descending?w.openCursor(null,"prev"):w.openCursor(IDBKeyRange.lowerBound(B.since,!0)),N.onsuccess=K}function A(){function N(){B.complete(null,{results:G,last_seq:M})}!B.continuous&&B.attachments?b1(G).then(N):N()}if(B=aU(B),B.continuous){var v=g+":"+cm();return cW.addListener(g,v,n,B),cW.notify(g),{cancel:function(){cW.removeListener(g,v)}}}var z=B.doc_ids&&new aK.Set(B.doc_ids);B.since=B.since||0;var M=B.since,L="limit" in B?B.limit:-1;0===L&&(L=1);var E;E="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var C,w,H,J,G=[],F=0,I=d8(B),y=new aK.Map;D()},n._close=function(v){return null===q?v(eX(bE)):(q.close(),dM["delete"](g),q=null,void v())},n._getRevisionTree=function(v,w){var z=fK(q,[e7],"readonly");if(z.error){return w(z.error)}var y=z.txn,x=y.objectStore(e7).get(v);x.onsuccess=function(B){var A=aO(B.target.result);A?w(null,A.rev_tree):w(eX(cs))}},n._doCompaction=function(y,A,w){var x=[e7,dG,f4,cB],v=fK(q,x,"readwrite");if(v.error){return w(v.error)}var B=v.txn,z=B.objectStore(e7);z.get(y).onsuccess=function(E){var C=aO(E.target.result);eU(C.rev_tree,function(I,K,H,J,G){var L=K+"-"+H;-1!==A.indexOf(L)&&(G.status="missing")}),aR(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(e7).put(dz(C,D,F))},B.onabort=aB(w),B.oncomplete=function(){w()}},n._getLocal=function(v,w){var z=fK(q,[cN],"readonly");if(z.error){return w(z.error)}var y=z.txn,x=y.objectStore(cN).get(v);x.onerror=aB(w),x.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,w(null,A)):w(eX(cs))}},n._putLocal=function(z,E,C){"function"==typeof E&&(C=E,E={}),delete z._revisions;var x=z._rev,y=z._id;x?z._rev="0-"+(parseInt(x.split("-")[1],10)+1):z._rev="0-1";var w,B=E.ctx;if(!B){var v=fK(q,[cN],"readwrite");if(v.error){return C(v.error)}B=v.txn,B.onerror=aB(C),B.oncomplete=function(){w&&C(null,w)}}var D,A=B.objectStore(cN);x?(D=A.get(y),D.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===x){var F=A.put(z);F.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)}}else{C(eX(cY))}}):(D=A.add(z),D.onerror=function(F){C(eX(cY)),F.preventDefault(),F.stopPropagation()},D.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)})},n._removeLocal=function(y,C,B){"function"==typeof C&&(B=C,C={});var w=C.ctx;if(!w){var x=fK(q,[cN],"readwrite");if(x.error){return B(x.error)}w=x.txn,w.oncomplete=function(){v&&B(null,v)}}var v,z=y._id,D=w.objectStore(cN),A=D.get(z);A.onerror=aB(B),A.onsuccess=function(F){var E=F.target.result;E&&E._rev===y._rev?(D["delete"](z),v={ok:!0,id:z,rev:"0-0"},C.ctx&&B(null,v)):B(eX(cs))}},n._destroy=function(v,x){cW.removeAllListeners(g);var w=ej.get(g);w&&w.result&&(w.result.close(),dM["delete"](g));var y=indexedDB.deleteDatabase(g);y.onsuccess=function(){ej["delete"](g),eB()&&g in localStorage&&delete localStorage[g],x(null,{ok:!0})},y.onerror=aB(x)};var l=dM.get(g);if(l){return q=l.idb,n._meta=l.global,void fB.nextTick(function(){u(null,n)})}var r;r=o.storage?jW(g,o.storage):indexedDB.open(g,dV),ej.set(g,r),r.onupgradeneeded=function(w){function z(){var B=y[A-1];A++,B&&B(v,z)}var x=w.target.result;if(w.oldVersion<1){return h(x)}var v=w.currentTarget.transaction;w.oldVersion<3&&s(x),w.oldVersion<4&&j(x);var y=[i,m,k,p],A=w.oldVersion;z()},r.onsuccess=function(x){q=x.target.result,q.onversionchange=function(){q.close(),dM["delete"](g)},q.onabort=function(B){dX("error","Database has a global failure",B.target.error),q.close(),dM["delete"](g)};var v=q.transaction([jQ,aH,e7],"readwrite"),y=v.objectStore(jQ).get(jQ),w=null,z=null,A=null;y.onsuccess=function(D){var B=function(){null!==w&&null!==z&&null!==A&&(n._meta={name:g,instanceId:A,blobSupport:w,docCount:z},dM.set(g,{idb:q,global:n._meta}),u(null,n))},E=D.target.result||{id:jQ};g+"_id" in E?(A=E[g+"_id"],B()):(A=cm(),E[g+"_id"]=A,v.objectStore(jQ).put(E).onsuccess=function(){B()}),bA||(bA=aG(v)),bA.then(function(F){w=F,B()});var C=v.objectStore(e7).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){z=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";dX("error",v),u(eX(eH,v))}}function jW(h,g){try{return indexedDB.open(h,{version:dV,storage:g})}catch(i){return indexedDB.open(h,dV)}}function am(g){g.adapter("idb",j0,!0)}function aq(g){return decodeURIComponent(escape(g))}function aV(g){return 65>g?g-48:g-55}function bu(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(aV(j.charCodeAt(h++))<<4|aV(j.charCodeAt(h++)))}return i}function aM(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(aV(j.charCodeAt(h+2))<<12|aV(j.charCodeAt(h+3))<<8|aV(j.charCodeAt(h))<<4|aV(j.charCodeAt(h+1))),h+=4}return i}function cX(g,h){return"UTF-8"===h?aq(bu(g,0,g.length)):aM(g,0,g.length)}function aw(g){return"'"+g+"'"}function ay(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function bY(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aS(g){return delete g._id,delete g._rev,JSON.stringify(g)}function cy(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function dW(g){for(var h="(";g--;){h+="?",g&&(h+=",")}return h+")"}function c7(j,h,g,i,k){return"SELECT "+j+" FROM "+("string"==typeof h?h:h.join(" JOIN "))+(g?" ON "+g:"")+(i?" WHERE "+("string"==typeof i?i:i.join(" AND ")):"")+(k?" ORDER BY "+k:"")}function b5(m,k,g){function l(){++j===m.length&&i()}function i(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+el+" WHERE seq IN "+dW(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+el+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(u){var v="SELECT digest FROM "+el+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";u.executeSql(v,s,function(x,y){for(var w=new aK.Set,z=0;z<y.rows.length;z++){w.add(y.rows.item(z).digest)}s.forEach(function(A){w.has(A)||(x.executeSql("DELETE FROM "+el+" WHERE digest=?",[A]),x.executeSql("DELETE FROM "+cg+" WHERE digest=?",[A]))})})})}})}}if(m.length){var j=0,h=[];m.forEach(function(n){var o="SELECT seq FROM "+dL+" WHERE doc_id=? AND rev=?";g.executeSql(o,[k,n],function(q,p){if(!p.rows.length){return l()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+dL+" WHERE seq=?",[r],l)})})}}function dx(g){return function(h){dX("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(eX(e6,j,i))}}function bh(g){if("size" in g){return 1000000*g.size}var h="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return h?5000000:1}function cw(s,q,m,i,k,x,h){function g(){return r?h(r):(x.notify(i._name),i._docCount=-1,void h(null,A))}function l(E,D){var F="SELECT count(*) as cnt FROM "+cg+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=eX(cM,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function u(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){l(I,function(J){J&&!E&&(E=J),D()})})}function v(G,O,J,E,R,L,Q,N){function I(){function V(ar,a0){function at(){return ++ae===ao.length&&a0(),!1}function ai(a1){var a2="INSERT INTO "+el+" (digest, seq) VALUES (?,?)",a3=[U._attachments[a1].digest,ar];p.executeSql(a2,a3,at,at)}var ae=0,ao=Object.keys(U._attachments||{});if(!ao.length){return a0()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var U=G.data,X=E?1:0,S=U._id,W=U._rev,Y=aS(U),Z="INSERT INTO "+dL+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",T=[S,W,Y,X];p.executeSql(Z,T,function(an,ai){var ae=ai.insertId;V(ae,function(){H(an,ae)})},function(){var ae=c7("seq",dL,null,"doc_id=? AND rev=?");return p.executeSql(ae,[S,W],function(ar,ai){var an=ai.rows.item(0).seq,ao="UPDATE "+dL+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[Y,X,S,W];ar.executeSql(ao,at,function(a0){V(an,function(){H(a0,an)})})}),!1})}function F(S){D||(S?(D=S,N(D)):M===K.length&&I())}function P(S){M++,F(S)}function H(W,V){var Y=G.metadata.id,X=G.stemmedRevs||[];R&&i.auto_compaction&&(X=af(G.metadata).concat(X)),X.length&&b5(X,Y,W),G.metadata.seq=V,delete G.metadata.rev;var S=R?"UPDATE "+aF+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+dL+" WHERE doc_id="+aF+".id AND rev=?) WHERE id=?":"INSERT INTO "+aF+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",T=aa(G.metadata),U=R?[T,V,O,Y]:[Y,V,V,T];W.executeSql(S,U,function(){A[Q]={ok:!0,id:G.metadata.id,rev:O},w.set(Y,G.metadata),N()})}var D=null,M=0;G.data._id=G.metadata.id,G.data._rev=G.metadata.rev;var K=Object.keys(G.data._attachments||{});E&&(G.data._deleted=!0),K.forEach(function(S){var U=G.data._attachments[S];if(U.stub){M++,F()}else{var V=U.data;delete U.data,U.revpos=parseInt(O,10);var T=U.digest;B(T,V,P)}}),K.length||I()}function z(){c3(s.revs_limit,o,i,w,p,A,v,m)}function n(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&dT(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+aF+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=bl(I.rows.item(0).json);w.set(H,K)}D()})})}function B(F,D,G){var E="SELECT digest FROM "+cg+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+cg+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,ay(D)],function(){G()},function(){return G(),!1}))})}var y=m.new_edits,C=q.docs,o=C.map(function(E){if(E._id&&dT(E._id)){return E}var D=cp(E,y);return D}),j=o.filter(function(D){return D.error});if(j.length){return h(j[0])}var p,r,A=new Array(o.length),w=new aK.Map;fJ(o,"binary",function(D){return D?h(D):void k.transaction(function(E){p=E,u(function(F){F?r=F:n(z)})},dx(h),g)})}function bX(g){return g.websql(g.name,g.version,g.description,g.size)}function cK(g){try{return{db:bX(g)}}catch(h){return{error:h}}}function jL(g){var h=dl.get(g.name);return h||(h=cK(g),dl.set(g.name,h),h.db&&(h.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),h}function cH(h,j,n,k,o){function g(){++m===l.length&&o&&o()}function i(q,s){var r=q._attachments[s],p={binary:j.binary,ctx:k};n._getAttachment(q._id,s,r,p,function(v,u){q._attachments[s]=j9.extend(eE(r,["digest","content_type"]),{data:u}),g()})}var l=Object.keys(h._attachments||{});if(!l.length){return o&&o()}var m=0;l.forEach(function(p){j.attachments&&j.include_docs?i(h,p):(h._attachments[p].stub=!0,g())})}function e5(v,k){function y(){eB()&&(window.localStorage["_pouch__websqldb_"+s._name]=!0),k(null,s)}function m(F,E){F.executeSql(dQ),F.executeSql("ALTER TABLE "+dL+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(a9),F.executeSql("ALTER TABLE "+aF+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+aF+" (local, id)");var G="SELECT "+aF+".winningseq AS seq, "+aF+".json AS metadata FROM "+dL+" JOIN "+aF+" ON "+dL+".seq = "+aF+".winningseq";F.executeSql(G,[],function(N,J){for(var M=[],H=[],I=0;I<J.rows.length;I++){var K=J.rows.item(I),L=K.seq,O=JSON.parse(K.metadata);aA(O)&&M.push(L),dT(O.id)&&H.push(O.id)}N.executeSql("UPDATE "+aF+"SET local = 1 WHERE id IN "+dW(H.length),H,function(){N.executeSql("UPDATE "+dL+" SET deleted = 1 WHERE seq IN "+dW(M.length),M,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+bg+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+aF+".id AS id, "+dL+".json AS data FROM "+dL+" JOIN "+aF+" ON "+dL+".seq = "+aF+".winningseq WHERE local = 1";F.executeSql(H,[],function(L,I){function K(){if(!M.length){return E(L)}var O=M.shift(),N=JSON.parse(O.data)._rev;L.executeSql("INSERT INTO "+bg+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+aF+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+dL+" WHERE seq=?",[O.seq],function(){K()})})})}for(var M=[],J=0;J<I.rows.length;J++){M.push(I.rows.item(J))}K()})})}function g(G,E){function H(I){function J(){if(!I.length){return E(G)}var L=I.shift(),P=cX(L.hex,x),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+dL+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){J()})}J()}var F="ALTER TABLE "+dL+" ADD COLUMN doc_id";G.executeSql(F,[],function(I){var J="ALTER TABLE "+dL+" ADD COLUMN rev";I.executeSql(J,[],function(K){K.executeSql(bT,[],function(M){var L="SELECT hex(doc_id_rev) as hex FROM "+dL;M.executeSql(L,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function z(G,E){function H(J){var I="SELECT COUNT(*) AS cnt FROM "+cg;J.executeSql(I,[],function(K,M){function P(){var Q=c7(jK+", "+aF+".id AS id",[aF,dL],aJ,null,aF+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,W){function R(at,ar){var ao=Z[at]=Z[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!W.rows.length){return E(ai)}for(var Z={},T=0;T<W.rows.length;T++){for(var V=W.rows.item(T),U=cy(V.data,V.id,V.rev),an=Object.keys(U._attachments||{}),S=0;S<an.length;S++){var X=U._attachments[an[S]];R(X.digest,V.seq)}}var Y=[];if(Object.keys(Z).forEach(function(ar){var ao=Z[ar];ao.forEach(function(at){Y.push([ar,at])})}),!Y.length){return P()}var ae=0;Y.forEach(function(ao){var ar="INSERT INTO "+el+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++ae===Y.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+el+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(j6,[],function(J){J.executeSql(d7,[],H)})})}function B(F,E){var G="ALTER TABLE "+cg+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+aF+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+aF+" SET max_seq=(SELECT MAX(seq) FROM "+dL+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+aF+" (max_seq)";J.executeSql(K,[],E)})})}function D(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;x=2===H.length?"UTF-8":"UTF-16",E()})}function w(){for(;l.length>0;){var E=l.pop();E(null,j)}}function C(H,P){if(0===P){var M="CREATE TABLE IF NOT EXISTS "+ab+" (dbid, db_version INTEGER)",J="CREATE TABLE IF NOT EXISTS "+cg+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",G="CREATE TABLE IF NOT EXISTS "+el+" (digest, seq INTEGER)",E="CREATE TABLE IF NOT EXISTS "+aF+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",F="CREATE TABLE IF NOT EXISTS "+dL+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",L="CREATE TABLE IF NOT EXISTS "+bg+" (id UNIQUE, rev, json)";H.executeSql(J),H.executeSql(L),H.executeSql(G,[],function(){H.executeSql(d7),H.executeSql(j6)}),H.executeSql(E,[],function(){H.executeSql(dQ),H.executeSql(F,[],function(){H.executeSql(a9),H.executeSql(bT),H.executeSql(M,[],function(){var R="INSERT INTO "+ab+" (db_version, dbid) VALUES (?,?)";j=cm();var Q=[dB,j];H.executeSql(R,Q,function(){w()})})})})}else{var N=function(){var Q=dB>P;Q&&H.executeSql("UPDATE "+ab+" SET db_version = "+dB);var R="SELECT dbid FROM "+ab;H.executeSql(R,[],function(T,S){j=S.rows.item(0).dbid,w()})},K=[m,p,g,z,B,r,N],I=P,O=function(Q){K[I-1](Q,O),I++};O(H)}}function o(){q.transaction(function(E){D(E,function(){A(E)})},dx(k),y)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+ab;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+ab,[],function(J,I){var K=I.rows.item(0).db_version;C(J,K)}):H.executeSql("ALTER TABLE "+ab+" ADD COLUMN db_version INTEGER",[],function(){C(H,1)}):C(H,0)})}function h(F,E){if(-1!==s._docCount){return E(s._docCount)}var G=c7("COUNT("+aF+".id) AS 'num'",[aF,dL],aJ,dL+".deleted=0");F.executeSql(G,[],function(I,H){s._docCount=H.rows.item(0).num,E(s._docCount)})}var x,s=this,j=null,n=bh(v),l=[];s._docCount=-1,s._name=v.name;var i=j9.extend({},v,{version:ag,description:v.name,size:n}),u=jL(i);if(u.error){return dx(k)(u.error)}var q=u.db;"function"!=typeof q.readTransaction&&(q.readTransaction=q.transaction),o(),s.type=function(){return"websql"},s._id=dd(function(E){E(null,j)}),s._info=function(E){q.readTransaction(function(F){h(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+dL;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:q._sqlitePlugin,websql_encoding:x})})})},dx(E))},s._bulkDocs=function(E,G,F){cw(v,E,G,s,q,jT,F)},s._get=function(K,L,I){function F(){I(N,{doc:G,metadata:J,ctx:H})}var G,J,N,H=L.ctx;if(!H){return q.readTransaction(function(O){s._get(K,j9.extend({ctx:O},L),I)})}var E,M;L.rev?(E=c7(jK,[aF,dL],aF+".id="+dL+".doc_id",[dL+".doc_id=?",dL+".rev=?"]),M=[K,L.rev]):(E=c7(jK,[aF,dL],aJ,aF+".id=?"),M=[K]),H.executeSql(E,M,function(O,P){if(!P.rows.length){return N=eX(cs,"missing"),F()}var Q=P.rows.item(0);return J=bl(Q.metadata),Q.deleted&&!L.rev?(N=eX(cs,"deleted"),F()):(G=cy(Q.data,J.id,Q.rev),void F())})},s._allDocs=function(L,H){var I,P=[],R="startkey" in L?L.startkey:!1,M="endkey" in L?L.endkey:!1,F="key" in L?L.key:!1,J="descending" in L?L.descending:!1,G="limit" in L?L.limit:-1,E="skip" in L?L.skip:0,O=L.inclusive_end!==!1,K=[],Q=[];if(F!==!1){Q.push(aF+".id = ?"),K.push(F)}else{if(R!==!1||M!==!1){if(R!==!1&&(Q.push(aF+".id "+(J?"<=":">=")+" ?"),K.push(R)),M!==!1){var N=J?">":"<";O&&(N+="="),Q.push(aF+".id "+N+" ?"),K.push(M)}F!==!1&&(Q.push(aF+".id = ?"),K.push(F))}}"ok"!==L.deleted&&Q.push(dL+".deleted = 0"),q.readTransaction(function(S){h(S,function(T){if(I=T,0!==G){var U=c7(jK,[aF,dL],aJ,Q,aF+".id "+(J?"DESC":"ASC"));U+=" LIMIT "+G+" OFFSET "+E,S.executeSql(U,K,function(Z,ao){for(var an=0,W=ao.rows.length;W>an;an++){var Y=ao.rows.item(an),ai=bl(Y.metadata),V=ai.id,X=cy(Y.data,V,Y.rev),ar=X._rev,ae={id:V,key:V,value:{rev:ar}};if(L.include_docs&&(ae.doc=X,ae.doc._rev=ar,L.conflicts&&(ae.doc._conflicts=e8(ai)),cH(ae.doc,L,s,Z)),Y.deleted){if("ok"!==L.deleted){continue}ae.value.deleted=!0,ae.doc=null}P.push(ae)}})}})},dx(H),function(){H(null,{total_rows:I,offset:L.skip,rows:P})})},s._changes=function(J){function K(){var S=aF+".json AS metadata, "+aF+".max_seq AS maxSeq, "+dL+".json AS winningDoc, "+dL+".rev AS winningRev ",T=aF+" JOIN "+dL,R=aF+".id="+dL+".doc_id AND "+aF+".winningseq="+dL+".seq",Q=["maxSeq > ?"],O=[J.since];J.doc_ids&&(Q.push(aF+".id IN "+dW(J.doc_ids.length)),O=O.concat(J.doc_ids));var U="maxSeq "+(G?"DESC":"ASC"),N=c7(S,T,R,Q,U),M=d8(J);J.view||J.filter||(N+=" LIMIT "+L);var P=J.since||0;q.readTransaction(function(V){V.executeSql(N,O,function(an,ao){function ai(a0){return function(){J.onChange(a0)}}for(var X=0,at=ao.rows.length;at>X;X++){var ar=ao.rows.item(X),W=bl(ar.metadata);P=ar.maxSeq;var ae=cy(ar.winningDoc,W.id,ar.winningRev),Z=J.processChange(ae,W,J);Z.seq=ar.maxSeq;var Y=M(Z);if("object"==typeof Y){return J.complete(Y)}if(Y&&(F++,I&&H.push(Z),J.attachments&&J.include_docs?cH(ae,J,s,an,ai(Z)):ai(Z)()),F===L){break}}})},dx(J.complete),function(){J.continuous||J.complete(null,{results:H,last_seq:P})})}if(J=aU(J),J.continuous){var E=s._name+":"+cm();return jT.addListener(s._name,E,s,J),jT.notify(s._name),{cancel:function(){jT.removeListener(s._name,E)}}}var G=J.descending;J.since=J.since&&!G?J.since:0;var L="limit" in J?J.limit:-1;0===L&&(L=1);var I;I="return_docs" in J?J.return_docs:"returnDocs" in J?J.returnDocs:!0;var H=[],F=0;K()},s._close=function(E){E()},s._getAttachment=function(K,L,I,F,G){var J,N=F.ctx,H=I.digest,E=I.content_type,M="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+cg+" WHERE digest=?";N.executeSql(M,[H],function(P,O){var Q=O.rows.item(0),R=Q.escaped?bY(Q.body):cX(Q.body,x);J=F.binary?aE(R,E):cA(R),G(null,J)})},s._getRevisionTree=function(F,E){q.readTransaction(function(H){var G="SELECT json AS metadata FROM "+aF+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=bl(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(eX(cs))}})})},s._doCompaction=function(F,E,G){return E.length?void q.transaction(function(H){var I="SELECT json AS metadata FROM "+aF+" WHERE id = ?";H.executeSql(I,[F],function(M,K){var L=bl(K.rows.item(0).metadata);eU(L.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var J="UPDATE "+aF+" SET json = ? WHERE id = ?";M.executeSql(J,[aa(L),F])}),b5(E,F,H)},dx(G),function(){G()}):G()},s._getLocal=function(F,E){q.readTransaction(function(H){var G="SELECT json, rev FROM "+bg+" WHERE id=?";H.executeSql(G,[F],function(I,K){if(K.rows.length){var L=K.rows.item(0),J=cy(L.json,F,L.rev);E(null,J)}else{E(eX(cs))}})})},s._putLocal=function(G,K,E){function L(N){var P,O;F?(P="UPDATE "+bg+" SET rev=?, json=? WHERE id=? AND rev=?",O=[M,J,I,F]):(P="INSERT INTO "+bg+" (id, rev, json) VALUES (?,?,?)",O=[I,M,J]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(H={ok:!0,id:I,rev:M},K.ctx&&E(null,H)):E(eX(cY))},function(){return E(eX(cY)),!1})}"function"==typeof K&&(E=K,K={}),delete G._revisions;var M,F=G._rev,I=G._id;M=F?G._rev="0-"+(parseInt(F.split("-")[1],10)+1):G._rev="0-1";var H,J=aS(G);K.ctx?L(K.ctx):q.transaction(L,dx(E),function(){H&&E(null,H)})},s._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+bg+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(eX(cs))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):q.transaction(G,dx(E),function(){I&&E(null,I)})},s._destroy=function(F,E){jT.removeAllListeners(s._name),q.transaction(function(H){var G=[aF,dL,cg,ab,bg,el];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},dx(E),function(){eB()&&(delete window.localStorage["_pouch__websqldb_"+s._name],delete window.localStorage[s._name]),E(null,{ok:!0})})}}function jF(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cb(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=eB(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=jF();return h&&(localStorage[g]=i?"1":"0"),i}function ek(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cb()}function bP(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=j9.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function eS(j,h){var g=bP(j),i=j9.extend({websql:g},j);e5.call(this,i,h)}function eN(g){g.adapter("websql",eS,!0)}function cd(){for(var j={},h=new cJ(function(k,l){j.resolve=k,j.reject=l}),g=new Array(arguments.length),i=0;i<g.length;i++){g[i]=arguments[i]}return j.promise=h,cJ.resolve().then(function(){return fetch.apply(null,g)}).then(function(k){j.resolve(k)})["catch"](function(k){j.reject(k)}),j}function ep(m,k){var g,l,i,j=new Headers,h={method:m.method,credentials:"include",headers:j};return m.json&&(j.set("Accept","application/json"),j.set("Content-Type",m.headers["Content-Type"]||"application/json")),m.body&&m.body instanceof Blob?b8(m.body,function(n){h.body=n}):m.body&&m.processData&&"string"!=typeof m.body?h.body=JSON.stringify(m.body):"body" in m?h.body=m.body:h.body=null,Object.keys(m.headers).forEach(function(n){m.headers.hasOwnProperty(n)&&j.set(n,m.headers[n])}),g=cd(m.url,h),m.timeout>0&&(l=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+m.url))},m.timeout)),g.promise.then(function(n){return i={statusCode:n.status},m.timeout>0&&clearTimeout(l),i.statusCode>=200&&i.statusCode<300?m.binary?n.blob():n.text():n.json()}).then(function(n){i.statusCode>=200&&i.statusCode<300?k(null,i,n):k(n,i)})["catch"](function(n){k(n,i)}),{abort:g.reject}}function bK(h,j){var n,k,o=!1,g=function(){n.abort()},i=function(){o=!0,n.abort()};n=h.xhr?new h.xhr:new XMLHttpRequest;try{n.open(h.method,h.url)}catch(l){j(l,{statusCode:413})}n.withCredentials="withCredentials" in h?h.withCredentials:!0,"GET"===h.method?delete h.headers["Content-Type"]:h.json&&(h.headers.Accept="application/json",h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json",h.body&&h.processData&&"string"!=typeof h.body&&(h.body=JSON.stringify(h.body))),h.binary&&(n.responseType="arraybuffer"),"body" in h||(h.body=null);for(var m in h.headers){h.headers.hasOwnProperty(m)&&n.setRequestHeader(m,h.headers[m])}return h.timeout>0&&(k=setTimeout(i,h.timeout),n.onprogress=function(){clearTimeout(k),4!==n.readyState&&(k=setTimeout(i,h.timeout))},"undefined"!=typeof n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var s={statusCode:n.status};if(n.status>=200&&n.status<300){var q;q=h.binary?bR([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,j(null,s,q)}else{var p={};if(o){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(n.response)}catch(r){}}j(p,s)}}},h.body&&h.body instanceof Blob?b8(h.body,function(p){n.send(p)}):n.send(h.body),{abort:g}}function ap(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function cq(g,h){return jS||g.xhr?bK(g,h):ep(g,h)}function f8(){return""}function kc(j,h){function g(m,l,n){if(!j.binary&&j.json&&"string"==typeof m){try{m=JSON.parse(m)}catch(o){return n(o)}}Array.isArray(m)&&(m=m.map(function(p){return p.error||p.missing?c9(p):p})),j.binary&&aN(m,l),n(null,m,l)}function i(l,p){var n,q;if(l.code&&l.status){var m=new Error(l.message||l.code);return m.status=l.status,p(m)}if(l.message&&"ETIMEDOUT"===l.message){return p(l)}try{n=JSON.parse(l.responseText),q=c9(n)}catch(o){q=c9(l)}p(q)}j=aU(j);var k={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return j=j9.extend(k,j),j.json&&(j.binary||(j.headers.Accept="application/json"),j.headers["Content-Type"]=j.headers["Content-Type"]||"application/json"),j.binary&&(j.encoding=null,j.json=!1),j.processData||(j.json=!1),cq(j,function(q,n,l){if(q){return q.status=n?n.statusCode:400,i(q,h)}var o,m=n.headers&&n.headers["content-type"],r=l||f8();if(!j.binary&&(j.json||!j.processData)&&"object"!=typeof r&&(/json/.test(m)||/^[\s]*\{/.test(r)&&/\}[\s]*$/.test(r))){try{r=JSON.parse(r.toString())}catch(p){}}n.statusCode>=200&&n.statusCode<300?g(r,n,h):(o=c9(r),o.status=n.statusCode,h(o))})}function eL(j,l){var h=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",o=-1!==h.indexOf("safari")&&-1===h.indexOf("chrome"),g=-1!==h.indexOf("msie"),i=-1!==h.indexOf("edge"),k=o||(g||i)&&"GET"===j.method,m="cache" in j?j.cache:!0,n=/^blob:/.test(j.url);if(!n&&(k||!m)){var p=-1!==j.url.indexOf("?");j.url+=(p?"&":"?")+"_nonce="+Date.now()}return kc(j,l)}function eV(g){var h=g.doc&&g.doc._attachments;h&&Object.keys(h).forEach(function(i){var j=h[i];j.data=dv(j.data,j.content_type)})}function aT(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function eY(g){return g._attachments&&Object.keys(g._attachments)?cJ.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new cJ(function(j){cR(i.data,j)}).then(function(j){i.data=j}):void 0})):cJ.resolve()}function dI(h){var g=cO(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function cj(g,h){return bV(g,g.db+"/"+h)}function bV(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function bU(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function jZ(j,o){function p(A,z,x){var y=A.ajax||{},B=j9.extend(aU(l),y,z);return b7(B.method+" "+B.url),w._ajax(B,x)}function k(y,x){return new cJ(function(z,A){p(y,x,function(C,B){return C?A(C):void z(B)})})}function i(y,x){return c4(y,bb(function(z){v().then(function(){return x.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(j.skipSetup||j.skip_setup){return cJ.resolve()}if(m){return m}var x={method:"GET",url:h};return m=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(c1(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:h})):cJ.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:cJ.reject(y)}),m["catch"](function(){m=null}),m}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,u=dI;j.getHost&&(u=j.getHost);var n=u(j.name,j),h=cj(n,"");j=aU(j);var l=j.ajax||{};if(w.getUrl=function(){return h},w.getHeaders=function(){return l.headers||{}},j.auth||n.auth){var s=j.auth||n.auth,r=s.username+":"+s.password,g=cA(unescape(encodeURIComponent(r)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var m;setTimeout(function(){o(null,w)}),w.type=function(){return"http"},w.id=i("id",function(x){p({},{method:"GET",url:bV(n,"")},function(y,A){var z=A&&A.uuid?A.uuid+n.db:cj(n,"");x(null,z)})}),w.request=i("request",function(y,x){y.url=cj(n,y.url),p({},y,x)}),w.compact=i("compact",function(y,x){"function"==typeof y&&(x=y,y={}),y=aU(y),p(y,{url:cj(n,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?x(null,{ok:!0}):setTimeout(z,y.interval||200)})}z()})}),w.bulkGet=c4("bulkGet",function(y,C){function B(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:cj(n,"_bulk_get"+bU(E)),method:"POST",body:{docs:y.docs}},F)}function A(){function F(L){return function(M,N){I[L]=N.results,++G===K&&C(null,{results:jN(I)})}}for(var J=cT,K=Math.ceil(y.docs.length/J),G=0,I=new Array(K),H=0;K>H;H++){var E=eE(y,["revs","attachments"]);E.ajax=l,E.docs=y.docs.slice(H*J,Math.min(y.docs.length,(H+1)*J)),dy(D,E,F(H))}}var D=this,x=bV(n,""),z=aW[x];"boolean"!=typeof z?B(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(aW[x]=!1,c1(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),A()):C(E)}else{aW[x]=!0,C(null,F)}}):z?B(C):A()}),w._info=function(x){v().then(function(){p({},{method:"GET",url:cj(n,"")},function(y,z){return y?x(y):(z.host=cj(n,""),void x(null,z))})})["catch"](x)},w.get=i("get",function(C,y,B){function A(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?cJ.all(E.map(function(J){var H=G[J],I=aT(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:cj(n,I),binary:!0}).then(function(K){return y.binary?K:new cJ(function(L){cR(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?cJ.all(E.map(function(F){return F.ok?A(F.ok):void 0})):A(E)}"function"==typeof y&&(B=y,y={}),y=aU(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=aT(C);var x={method:"GET",url:cj(n,C+bU(z))};k(y,x).then(function(E){return cJ.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){B(null,E)})})["catch"](B)}),w.remove=i("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:cj(n,aT(C._id))+"?rev="+y},A)}),w.getAttachment=i("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=cj(n,aT(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=i("removeAttachment",function(A,z,y,x){var B=cj(n,aT(A)+"/"+q(z))+"?rev="+y;p({},{method:"DELETE",url:B},x)}),w.putAttachment=i("putAttachment",function(z,D,F,G,x,E){"function"==typeof x&&(E=x,x=G,G=F,F=null);var C=aT(z)+"/"+q(D),B=cj(n,C);if(F&&(B+="?rev="+F),"string"==typeof G){var H;try{H=d1(G)}catch(A){return E(eX(dJ,"Attachment is not a valid base64 string"))}G=H?aE(H,x):""}var y={headers:{"Content-Type":x},method:"PUT",url:B,processData:!1,body:G,timeout:l.timeout||60000};p({},y,E)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,v().then(function(){return cJ.all(x.docs.map(eY))}).then(function(){p(y,{method:"POST",url:cj(n,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=i("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=aU(C);var B,A={},D="GET";C.conflicts&&(A.conflicts=!0),C.descending&&(A.descending=!0),C.include_docs&&(A.include_docs=!0),C.attachments&&(A.attachments=!0),C.key&&(A.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(A.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(A.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(A.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(A.limit=C.limit),"undefined"!=typeof C.skip&&(A.skip=C.skip);var x=bU(A);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=az?x+="&"+z:(D="POST",B={keys:C.keys})}k(C,{method:D,url:cj(n,"_all_docs"+x),body:B}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:bL;H=aU(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var y in H.query_params){H.query_params.hasOwnProperty(y)&&(D[y]=H.query_params[y])}}var F,E="GET";if(H.doc_ids){D.filter="_doc_ids";var C=JSON.stringify(H.doc_ids);C.length<az?D.doc_ids=C:(E="POST",F={doc_ids:H.doc_ids})}var z,K,x=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:E,url:cj(n,"_changes"+bU(D)),timeout:H.timeout,body:F};K=N,H.aborted||v().then(function(){z=p(H,O,M)})["catch"](M)}},I={results:[]},G=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,I.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=d8(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&I.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(K=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,I):setTimeout(function(){x(K,G)},0)}};return x(H.since||0,G),{cancel:function(){H.aborted=!0,z&&z.abort()}}},w.revsDiff=i("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:cj(n,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(y,x){p(y,{url:cj(n,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?x(z):void x(null,A)})}}function f6(g){g.adapter("http",jZ,!1),g.adapter("https",jZ,!1)}function kk(){this.promise=new cJ(function(g){g()})}function fP(h){var i=h.db,j=h.viewName,k=h.map,m=h.reduce,n=h.temporary,l=k.toString()+(m&&m.toString())+"undefined";if(!n&&i._cachedViews){var g=i._cachedViews[l];if(g){return cJ.resolve(g)}}return i.info().then(function(p){function o(u){u.views=u.views||{};var r=j;-1===r.indexOf("/")&&(r=j+"/"+j);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(n?"temp":eR(l));return aD(i,"_local/mrviews",o).then(function(){return i.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:i,adapter:i.adapter,mapFun:k,reduceFun:m};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,n||(i._cachedViews=i._cachedViews||{},i._cachedViews[l]=r,r.db.once("destroyed",function(){delete i._cachedViews[l]})),r})})})})}function eF(k,i,h,j,l,g){return b6("return ("+k.replace(/;\s*$/,"")+");",{emit:i,sum:h,log:j,isArray:l,toJSON:g})}function kg(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function bC(g){return 1===g.length&&/^1-/.test(g[0].rev)}function ka(h,g){try{h.emit("error",g)}catch(i){dX("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),dX("error",g)}}function dq(j,h,g){try{return{output:h.apply(null,g)}}catch(i){return ka(j,i),{error:i}}}function dD(h,g){var i=cx.collate(h.key,g.key);return 0!==i?i:cx.collate(h.value,g.value)}function ef(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function cF(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function fR(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=dv(k.data,k.content_type)})})}function aX(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&fR(h),h}}function bO(g){var h="builtin "+g+" function requires map values to be numbers or number arrays";return new d0(h)}function dA(h){for(var i=0,j=0,k=h.length;k>j;j++){var m=h[j];if("number"!=typeof m){if(!Array.isArray(m)){throw bO("_sum")}i="number"==typeof i?[i]:i;for(var n=0,l=m.length;l>n;n++){var g=m[n];if("number"!=typeof g){throw bO("_sum")}"undefined"==typeof i[n]?i.push(g):i[n]+=g}}else{"number"==typeof i?i+=m:i[0]+=m}}return i}function dU(j,h,g,i){var k=h[j];"undefined"!=typeof k&&(i&&(k=encodeURIComponent(JSON.stringify(k))),g.push(j+"="+k))}function cc(g){if("undefined"!=typeof g){var h=Number(g);return isNaN(h)||h!==parseInt(g,10)?g:h}}function e1(g){return g.group_level=cc(g.group_level),g.limit=cc(g.limit),g.skip=cc(g.skip),g}function jU(g){if(g){if("number"!=typeof g){return new f9('Invalid value for integer: "'+g+'"')}if(0>g){return new f9('Invalid value for positive integer: "'+g+'"')}}}function km(j,h){var g=j.descending?"endkey":"startkey",i=j.descending?"startkey":"endkey";if("undefined"!=typeof j[g]&&"undefined"!=typeof j[i]&&cx.collate(j[g],j[i])>0){throw new f9("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(h.reduce&&j.reduce!==!1){if(j.include_docs){throw new f9("{include_docs:true} is invalid for reduce")}if(j.keys&&j.keys.length>1&&!j.group&&!j.group_level){throw new f9("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=jU(j[k]);if(l){throw l}})}function ah(h,j,n){var k,o=[],g="GET";if(dU("reduce",n,o),dU("include_docs",n,o),dU("attachments",n,o),dU("limit",n,o),dU("descending",n,o),dU("group",n,o),dU("group_level",n,o),dU("skip",n,o),dU("stale",n,o),dU("conflicts",n,o),dU("startkey",n,o,!0),dU("start_key",n,o,!0),dU("endkey",n,o,!0),dU("end_key",n,o,!0),dU("inclusive_end",n,o),dU("key",n,o,!0),o=o.join("&"),o=""===o?"":"?"+o,"undefined"!=typeof n.keys){var i=2000,l="keys="+encodeURIComponent(JSON.stringify(n.keys));l.length+o.length+1<=i?o+=("?"===o[0]?"&":"?")+l:(g="POST","string"==typeof j?k={keys:n.keys}:j.keys=n.keys)}if("string"==typeof j){var m=kg(j);return h.request({method:g,url:"_design/"+m[0]+"/_view/"+m[1]+o,body:k}).then(aX(n))}return k=k||{},Object.keys(j).forEach(function(p){Array.isArray(j[p])?k[p]=j[p]:k[p]=j[p].toString()}),h.request({method:"POST",url:"_temp_view"+o,body:k}).then(aX(n))}function em(h,g,i){return new cJ(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function ec(g){return new cJ(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function fQ(g){return function(h){if(404===h.status){return g}throw h}}function jP(g,k,p){function m(){return bC(o)?cJ.resolve(j):k.db.get(h)["catch"](fQ(j))}function l(r){return r.keys.length?k.db.allDocs({keys:r.keys,include_docs:!0}):cJ.resolve({rows:[]})}function n(z,B){for(var v=[],s={},u=0,w=B.rows.length;w>u;u++){var y=B.rows[u],r=y.doc;if(r&&(v.push(r),s[r._id]=!0,r._deleted=!q[r._id],!r._deleted)){var A=q[r._id];"value" in A&&(r.value=A.value)}}var x=Object.keys(q);return x.forEach(function(C){if(!s[C]){var E={_id:C},D=q[C];"value" in D&&(E.value=D.value),v.push(E)}}),z.keys=j5(x.concat(z.keys)),v.push(z),v}var h="_local/doc_"+g,j={_id:h,keys:[]},i=p[g],q=i.indexableKeysToKeyValues,o=i.changes;return m().then(function(r){return l(r).then(function(s){return n(r,s)})})}function jX(j,h,g){var i="_local/lastSeq";return j.db.get(i)["catch"](fQ({_id:i,seq:0})).then(function(k){var l=Object.keys(h);return cJ.all(l.map(function(m){return jP(m,j,h)})).then(function(n){var m=jN(n);return k.seq=g,m.push(k),j.db.bulkDocs({docs:m})})})}function jI(h){var g="string"==typeof h?h:h.name,i=bN[g];return i||(i=bN[g]=new kk),i}function da(g){return f2(jI(g),function(){return j3(g)})()}function j3(h){function j(p,r){var q={id:o._id,key:cx.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=cx.normalizeKey(r)),k.push(q)}function n(q,p){return function(){return jX(h,q,p)}}var k,o,g;if("function"==typeof h.mapFun&&2===h.mapFun.length){var i=h.mapFun;g=function(p){return i(p,j)}}else{g=eF(h.mapFun.toString(),j,dA,bp,Array.isArray,JSON.parse)}var l=h.seq||0,m=new kk;return new cJ(function(p,s){function r(){m.finish().then(function(){h.seq=l,p()})}function q(){function u(v){s(v)}h.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:l,limit:ax}).on("complete",function(F){var A=F.results;if(!A.length){return r()}for(var H={},x=0,v=A.length;v>x;x++){var C=A[x];if("_"!==C.doc._id[0]){k=[],o=C.doc,o._deleted||dq(h.sourceDB,g,[o]),k.sort(dD);for(var D,z={},B=0,G=k.length;G>B;B++){var w=k[B],y=[w.key,w.id];0===cx.collate(w.key,D)&&y.push(B);var E=cx.toIndexableString(y);z[E]=w,D=w.key}H[C.doc._id]={indexableKeysToKeyValues:z,changes:C.changes}}l=C.seq}return m.add(n(H,l)),A.length<ax?r():q()}).on("error",u)}q()})}function e2(g,k,p){0===p.group_level&&delete p.group_level;var m,l=p.group||p.group_level;m=bx[g.reduceFun]?bx[g.reduceFun]:eF(g.reduceFun.toString(),null,dA,bp,Array.isArray,JSON.parse);var n=[],h=isNaN(p.group_level)?Number.POSITIVE_INFINITY:p.group_level;k.forEach(function(r){var u=n[n.length-1],s=l?r.key:null;return l&&Array.isArray(s)&&(s=s.slice(0,h)),u&&0===cx.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void n.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),k=[];for(var j=0,i=n.length;i>j;j++){var q=n[j],o=dq(g.sourceDB,m,[q.keys,q.values,!1]);if(o.error&&o.error instanceof d0){throw o.error}k.push({value:o.error?null:o.output,key:q.groupKey})}return{rows:ef(k,p.limit,p.skip)}}function kj(g,h){return f2(jI(g),function(){return eT(g,h)})()}function eT(r,p){function g(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return s=v.total_rows,v.rows.map(function(z){if("value" in z.doc&&"object"==typeof z.doc.value&&null!==z.doc.value){var x=Object.keys(z.doc.value).sort(),w=["id","key","value"];if(!(w>x||x>w)){return z.doc.value}}var y=cx.parseIndexableString(z.doc._id);return{key:y[0],id:y[1],value:"value" in z.doc?z.doc.value:null}})})}function q(u){var w;if(w=i?e2(r,u,p):{total_rows:s,offset:n,rows:u},p.include_docs){var v=j5(u.map(cF));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:p.conflicts,attachments:p.attachments,binary:p.binary}).then(function(y){var x={};return y.rows.forEach(function(z){z.doc&&(x["$"+z.id]=z.doc)}),u.forEach(function(A){var B=cF(A),z=x["$"+B];z&&(A.doc=z)}),w})}return w}var s,i=r.reduceFun&&p.reduce!==!1,n=p.skip||0;if("undefined"==typeof p.keys||p.keys.length||(p.limit=0,delete p.keys),"undefined"!=typeof p.keys){var j=p.keys,o=j.map(function(u){var v={startkey:cx.toIndexableString([u]),endkey:cx.toIndexableString([u,{}])};return g(v)});return cJ.all(o).then(jN).then(q)}var m={descending:p.descending};if(p.start_key&&(p.startkey=p.start_key),p.end_key&&(p.endkey=p.end_key),"undefined"!=typeof p.startkey&&(m.startkey=p.descending?cx.toIndexableString([p.startkey,{}]):cx.toIndexableString([p.startkey])),"undefined"!=typeof p.endkey){var k=p.inclusive_end!==!1;p.descending&&(k=!k),m.endkey=cx.toIndexableString(k?[p.endkey,{}]:[p.endkey])}if("undefined"!=typeof p.key){var h=cx.toIndexableString([p.key]),l=cx.toIndexableString([p.key,{}]);m.descending?(m.endkey=h,m.startkey=l):(m.startkey=h,m.endkey=l)}return i||("number"==typeof p.limit&&(m.limit=p.limit),m.skip=n),g(m).then(q)}function cl(g){return g.request({method:"POST",url:"_view_cleanup"})}function eq(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(n){var l=kg(n),m="_design/"+l[0],k=l[1];j[m]=j[m]||{},j[m][k]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(n){var k={};n.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){k[v]=k[v]||s})})});var m=Object.keys(k).filter(function(o){return !k[o]}),l=m.map(function(o){return f2(jI(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return cJ.all(l).then(function(){return{ok:!0}})})},fQ({ok:!0}))}function fC(m,g,h){if("http"===m.type()){return ah(m,g,h)}if("function"==typeof m._query){return em(m,g,h)}if("string"!=typeof g){km(h,g);var j={db:m,viewName:"temp_view/temp_view",map:g.map,reduce:g.reduce,temporary:!0};return b0.add(function(){return fP(j).then(function(o){function p(){return o.db.destroy()}return fF(da(o).then(function(){return kj(o,h)}),p)})}),b0.finish()}var i=g,l=kg(i),k=l[0],n=l[1];return m.get("_design/"+k).then(function(o){var p=o.views&&o.views[n];if(!p||"string"!=typeof p.map){throw new kl("ddoc "+k+" has no view named "+n)}km(h,p);var q={db:m,viewName:i,map:p.map,reduce:p.reduce};return fP(q).then(function(r){return"ok"===h.stale||"update_after"===h.stale?("update_after"===h.stale&&fB.nextTick(function(){da(r)}),kj(r,h)):da(r).then(function(){return kj(r,h)})})})}function f9(g){this.status=400,this.name="query_parse_error",this.message=g,this.error=!0;try{Error.captureStackTrace(this,f9)}catch(h){}}function kl(g){this.status=404,this.name="not_found",this.message=g,this.error=!0;try{Error.captureStackTrace(this,kl)}catch(h){}}function d0(g){this.status=500,this.name="invalid_value",this.message=g,this.error=!0;try{Error.captureStackTrace(this,d0)}catch(h){}}function j2(g){return/^1-/.test(g)}function dm(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function c0(h,g){var i=Object.keys(g._attachments);return cJ.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function cC(j,h,g){var i="http"===h.type()&&"http"!==j.type(),k=Object.keys(g._attachments);return i?j.get(g._id).then(function(l){return cJ.all(k.map(function(m){return dm(l,g,m)?h.getAttachment(g._id,m):j.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return c0(h,g)}):c0(h,g)}function cL(g){var h=[];return Object.keys(g).forEach(function(j){var i=g[j].missing;i.forEach(function(k){h.push({id:j,rev:k})})}),{docs:h,revs:!0}}function jH(p,j,n,l){function m(){var r=cL(n);if(r.docs.length){return p.bulkGet(r).then(function(s){if(l.cancelled){throw new Error("cancelled")}return cJ.all(s.results.map(function(u){return cJ.all(u.docs.map(function(w){var v=w.ok;return w.error&&(o=!1),v&&v._attachments?cC(j,p,v).then(function(y){var x=Object.keys(v._attachments);return y.forEach(function(z,B){var A=v._attachments[x[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){q=q.concat(jN(u).filter(Boolean))})})}}function g(r){return r._attachments&&Object.keys(r._attachments).length>0}function h(r){return p.allDocs({keys:r,include_docs:!0}).then(function(s){if(l.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&j2(u.value.rev)&&!g(u.doc)&&(q.push(u.doc),delete n[u.id])})})}function k(){var r=Object.keys(n).filter(function(s){var u=n[s].missing;return 1===u.length&&j2(u[0])});return r.length>0?h(r):void 0}function i(){return{ok:o,docs:q}}n=aU(n);var q=[],o=!0;return cJ.resolve().then(k).then(m).then(i)}function b9(j,h,g,i,k){return j.get(h)["catch"](function(l){if(404===l.status){return"http"===j.type()&&c1(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:i,_id:h,history:[],replicator:dK,version:ke}}throw l}).then(function(l){return k.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==i}),l.history.unshift({last_seq:g,session_id:i}),l.history=l.history.slice(0,dp),l.version=ke,l.replicator=dK,l.session_id=i,l.last_seq=g,j.put(l)["catch"](function(m){if(409===m.status){return b9(j,h,g,i,k)}throw m}))})}function ac(j,h,g,i){this.src=j,this.target=h,this.id=g,this.returnValue=i}function bm(g,h){return g.session_id===h.session_id?{last_seq:g.last_seq,history:g.history}:dc(g.history,h.history)}function dc(h,i){var j=h[0],k=h.slice(1),m=i[0],n=i.slice(1);if(!j||0===i.length){return{last_seq:b3,history:[]}}var l=j.session_id;if(kb(l,i)){return{last_seq:j.last_seq,history:h}}var g=m.session_id;return kb(g,k)?{last_seq:m.last_seq,history:n}:dc(k,n)}function kb(j,h){var g=h[0],i=h.slice(1);return j&&0!==h.length?j===g.session_id?!0:kb(j,i):!1}function dR(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function bQ(j,h,g,i){return j.retry===!1?(h.emit("error",g),void h.removeAllListeners()):("function"!=typeof j.back_off_function&&(j.back_off_function=aL),h.emit("requestError",g),"active"!==h.state&&"pending"!==h.state||(h.emit("paused",g),h.state="stopped",h.once("active",function(){j.current_back_off=bZ})),j.current_back_off=j.current_back_off||bZ,j.current_back_off=j.back_off_function(j.current_back_off),void setTimeout(i,j.current_back_off))}function jO(g){return Object.keys(g).sort(cx.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function bv(m,k,g){var l=g.doc_ids?g.doc_ids.sort(cx.collate):"",i=g.filter?g.filter.toString():"",j="",h="";return g.filter&&g.query_params&&(j=JSON.stringify(jO(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),cJ.all([m.id(),k.id()]).then(function(o){var n=o[0]+o[1]+i+h+j+l;return new cJ(function(p){dj(n,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dS(v,E,Q,L,P){function k(){return q?cJ.resolve():bv(v,E,Q).then(function(T){C=T,q=new ac(v,E,C,L)})}function K(){if(I=[],0!==s.docs.length){var T=s.docs;return E.bulkDocs({docs:T,new_edits:!1}).then(function(W){if(L.cancelled){throw O(),new Error("cancelled")}var Y=[],V={};W.forEach(function(Z){Z.error&&(P.doc_write_failures++,Y.push(Z),V[Z.id]=Z)}),u=u.concat(Y),P.docs_written+=s.docs.length-Y.length;var U=Y.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=V[Z._id];ae?L.emit("denied",aU(ae)):I.push(Z)}),U.length>0){var X=new Error("bulkDocs error");throw X.other_errors=Y,l("target.bulkDocs failed to write docs",X),new Error("bulkWrite partial failure")}},function(U){throw P.doc_write_failures+=T.length,U})}}function F(){if(s.error){throw new Error("There was a problem getting docs.")}P.last_seq=j=s.seq;var T=aU(P);return I.length&&(T.docs=I,L.emit("change",T)),n=!0,q.writeCheckpoint(s.seq,w).then(function(){if(n=!1,L.cancelled){throw O(),new Error("cancelled")}s=void 0,g()})["catch"](D)}function y(){var T={};return s.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),E.revsDiff(T).then(function(U){if(L.cancelled){throw O(),new Error("cancelled")}s.diffs=U})}function p(){return jH(v,E,s.diffs,L).then(function(T){s.error=!T.ok,T.docs.forEach(function(U){delete s.diffs[U._id],P.docs_read++,s.docs.push(U)})})}function h(){if(!L.cancelled&&!s){if(0===i.length){return void A(!0)}s=i.shift(),y().then(p).then(K).then(F).then(h)["catch"](function(T){l("batch processing terminated with error",T)})}}function A(T){return 0===N.changes.length?void (0!==i.length||s||((H&&R.live||J)&&(L.state="pending",L.emit("paused")),J&&O())):void ((T||J||N.changes.length>=z)&&(i.push(N),N={seq:0,changes:[],docs:[]},"pending"!==L.state&&"stopped"!==L.state||(L.state="active",L.emit("active")),h()))}function l(T,U){o||(U.message||(U.message=T),P.ok=!1,P.status="aborting",P.errors.push(U),u=u.concat(U),i=[],N={seq:0,changes:[],docs:[]},O())}function O(){if(!(o||L.cancelled&&(P.status="cancelled",n))){P.status=P.status||"complete",P.end_time=new Date,P.last_seq=j,o=!0;var T=u.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(T.length>0){var U=u.pop();u.length>0&&(U.other_errors=u),U.result=P,bQ(Q,L,U,function(){dS(v,E,Q,L)})}else{P.errors=u,L.emit("complete",P),L.removeAllListeners()}}}function x(T){if(L.cancelled){return O()}var U=d8(Q)(T);U&&(N.seq=T.seq,N.changes.push(T),A(0===i.length&&R.live))}function S(T){if(G=!1,L.cancelled){return O()}if(T.results.length>0){R.since=T.last_seq,g(),A(!0)}else{var U=function(){H?(R.live=!0,g()):J=!0,A(!0)};s||0!==T.results.length?U():(n=!0,q.writeCheckpoint(T.last_seq,w).then(function(){n=!1,P.last_seq=j=T.last_seq,U()})["catch"](D))}}function M(T){return G=!1,L.cancelled?O():void l("changes rejected",T)}function g(){function U(){T.cancel()}function V(){L.removeListener("cancel",U)}if(!G&&!J&&i.length<B){G=!0,L._changes&&(L.removeListener("cancel",L._abortChanges),L._changes.cancel()),L.once("cancel",U);var T=v.changes(R).on("change",x);T.then(V,V),T.then(S)["catch"](M),Q.retry&&(L._changes=T,L._abortChanges=U)}}function m(){k().then(function(){return L.cancelled?void O():q.getCheckpoint().then(function(T){j=T,R={since:j,limit:z,batch_size:z,style:"all_docs",doc_ids:r,return_docs:!0},Q.filter&&("string"!=typeof Q.filter?R.include_docs=!0:R.filter=Q.filter),"heartbeat" in Q&&(R.heartbeat=Q.heartbeat),"timeout" in Q&&(R.timeout=Q.timeout),Q.query_params&&(R.query_params=Q.query_params),Q.view&&(R.view=Q.view),g()})})["catch"](function(T){l("getCheckpoint rejected with ",T)})}function D(T){throw n=!1,l("writeCheckpoint completed with error",T),T}var s,C,q,i=[],N={seq:0,changes:[],docs:[]},n=!1,J=!1,o=!1,j=0,H=Q.continuous||Q.live||!1,z=Q.batch_size||100,B=Q.batches_limit||10,G=!1,r=Q.doc_ids,u=[],I=[],w=cm();P=P||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var R={};return L.ready(v,E),L.cancelled?void O():(L._addedListeners||(L.once("cancel",O),"function"==typeof Q.complete&&(L.once("error",Q.complete),L.once("complete",function(T){Q.complete(null,T)})),L._addedListeners=!0),void ("undefined"==typeof Q.since?m():k().then(function(){return n=!0,q.writeCheckpoint(Q.since,w)}).then(function(){return n=!1,L.cancelled?void O():(j=Q.since,void m())})["catch"](D)))}function cz(){ca.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var g=this,h=new cJ(function(i,j){g.once("complete",i),g.once("error",j)});g.then=function(i,j){return h.then(i,j)},g["catch"]=function(i){return h["catch"](i)},g["catch"](function(){})}function fL(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function dN(m,k,g,l){if("function"==typeof g&&(l=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw eX(bw,"`doc_ids` filter parameter is not a list.")}g.complete=l,g=aU(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var i=new cz(g),j=fL(m,g),h=fL(k,g);return dS(j,h,g,i),i}function dO(j,h,g,i){return"function"==typeof g&&(i=g,g={}),"undefined"==typeof g&&(g={}),g=aU(g),g.PouchConstructor=g.PouchConstructor||this,j=fL(j,g),h=fL(h,g),new eD(j,h,g,i)}function eD(y,q,r,l){function p(z){w.emit("change",{direction:"pull",change:z})}function v(z){w.emit("change",{direction:"push",change:z})}function o(z){w.emit("denied",{direction:"push",doc:z})}function s(z){w.emit("denied",{direction:"pull",doc:z})}function i(){w.pushPaused=!0,w.pullPaused&&w.emit("paused")}function m(){w.pullPaused=!0,w.pushPaused&&w.emit("paused")}function x(){w.pushPaused=!1,w.pullPaused&&w.emit("active",{direction:"push"})}function u(){w.pullPaused=!1,w.pushPaused&&w.emit("active",{direction:"pull"})}function k(z){return function(D,B){var C="change"===D&&(B===p||B===v),F="denied"===D&&(B===s||B===o),A="paused"===D&&(B===m||B===i),E="active"===D&&(B===u||B===x);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&w.removeAllListeners(D))}}var w=this;this.canceled=!1;var n=r.push?j9.extend({},r,r.push):r,h=r.pull?j9.extend({},r,r.pull):r;this.push=dN(y,q,n),this.pull=dN(q,y,h),this.pushPaused=!0,this.pullPaused=!0;var g={};r.live&&(this.push.on("complete",w.pull.cancel.bind(w.pull)),this.pull.on("complete",w.push.cancel.bind(w.push))),this.on("newListener",function(z){"change"===z?(w.pull.on("change",p),w.push.on("change",v)):"denied"===z?(w.pull.on("denied",s),w.push.on("denied",o)):"active"===z?(w.pull.on("active",u),w.push.on("active",x)):"paused"===z&&(w.pull.on("paused",m),w.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(w.pull.removeListener("change",p),w.push.removeListener("change",v)):"denied"===z?(w.pull.removeListener("denied",s),w.push.removeListener("denied",o)):"active"===z?(w.pull.removeListener("active",u),w.push.removeListener("active",x)):"paused"===z&&(w.pull.removeListener("paused",m),w.push.removeListener("paused",i))}),this.pull.on("removeListener",k("pull")),this.push.on("removeListener",k("push"));var j=cJ.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return w.emit("complete",z),l&&l(null,z),w.removeAllListeners(),z},function(z){if(w.cancel(),l?l(z):w.emit("error",z),w.removeAllListeners(),l){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function bz(g){g.replicate=dN,g.sync=dO}var eZ,j9=d(9),by=f5(d(5)),c6=f5(d(8)),aC=f5(d(10)),aK=d(14),bb=f5(d(4)),ca=d(1),b6=f5(d(15)),bW=f5(d(16)),aZ=f5(d(17)),cx=d(12),cJ="function"==typeof Promise?Promise:aC,f7=Function.prototype.toString,b2=f7.call(Object),dF=by("pouchdb:api"),cS=6;if(ch()){eZ=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),eZ=!!localStorage.getItem("_pouch_check_localstorage")}catch(c8){eZ=!1}}c6(eK,ca.EventEmitter),eK.prototype.addListener=function(m,k,g,l){function i(){function o(){h=!1}if(j._listeners[k]){if(h){return void (h="waiting")}h=!0;var n=eE(l,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(n).on("change",function(p){p.seq>l.since&&!l.cancelled&&(l.since=p.seq,l.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){i()},0),h=!1}).on("error",o)}}if(!this._listeners[k]){var j=this,h=!1;this._listeners[k]=i,this.on(m,i)}},eK.prototype.removeListener=function(g,h){h in this._listeners&&ca.EventEmitter.prototype.removeListener.call(this,g,this._listeners[h])},eK.prototype.notifyLocalWindows=function(g){ch()?chrome.storage.local.set({dbName:g}):eB()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},eK.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},c6(db,Error),db.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var au=new db({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),cf=new db({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),cs=new db({status:404,error:"not_found",reason:"missing"}),cY=new db({status:409,error:"conflict",reason:"Document update conflict"}),e9=new db({status:400,error:"invalid_id",reason:"_id field must contain a string"}),eP=new db({status:412,error:"missing_id",reason:"_id is required for puts"}),fO=new db({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),bE=new db({status:412,error:"precondition_failed",reason:"Database not open"}),d5=new db({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),dJ=new db({status:500,error:"badarg",reason:"Some query argument is invalid"}),ba=new db({status:400,error:"invalid_request",reason:"Request was invalid"}),kd=new db({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),kh=new db({status:500,error:"doc_validation",reason:"Bad special document member"}),bw=new db({status:400,error:"bad_request",reason:"Something wrong with the request"}),ea=new db({status:400,error:"bad_request",reason:"Document must be a JSON object"}),bF=new db({status:404,error:"not_found",reason:"Database not found"}),eH=new db({status:500,error:"indexed_db_went_bad",reason:"unknown"}),e6=new db({status:500,error:"web_sql_went_bad",reason:"unknown"}),df=new db({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),d4=new db({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),ck=new db({status:400,error:"bad_request",reason:"Invalid rev format"}),jR=new db({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),cM=new db({status:412,error:"missing_stub"}),d6=new db({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cG=[au,cf,cs,cY,e9,eP,fO,bE,d5,dJ,ba,kd,kh,bw,ea,bF,e6,df,d4,ck,jR,cM,eH,d6],cD=function(j,h,g){var i=cG.filter(function(k){return k[j]===h});return g&&i.filter(function(k){return k.message===g})[0]||i[0]},f1=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],eW="queryKey",fI=/(?:^|&)([^&=]*)=?([^&]*)/g,eJ=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eQ="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");c6(eM,ca.EventEmitter),eM.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},eM.prototype.doChanges=function(j){var h=this,g=j.complete;if(j=aU(j),"live" in j&&!("continuous" in j)&&(j.continuous=j.live),j.processChange=dH,"latest"===j.since&&(j.since="now"),j.since||(j.since=0),"now"===j.since){return void this.db.info().then(function(l){return h.isCancelled?void g(null,{status:"cancelled"}):(j.since=l.update_seq,void h.doChanges(j))},g)}if(j.continuous&&"now"!==j.since&&this.db.info().then(function(l){h.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),j.view&&!j.filter&&(j.filter="_view"),j.filter&&"string"==typeof j.filter&&("_view"===j.filter?j.view=cU(j.view):j.filter=cU(j.filter),"http"!==this.db.type()&&!j.doc_ids)){return this.filterChanges(j)}"descending" in j||(j.descending=!1),j.limit=0===j.limit?1:j.limit,j.complete=g;var i=this.db._changes(j);if(i&&"function"==typeof i.cancel){var k=h.cancel;h.cancel=bb(function(l){i.cancel(),k.apply(this,l)})}},eM.prototype.filterChanges=function(k){var i=this,h=k.complete;if("_view"===k.filter){if(!k.view||"string"!=typeof k.view){var j=eX(bw,"`view` filter parameter not found or invalid.");return h(j)}var l=e0(k.view);this.db.get("_design/"+l[0],function(m,o){if(i.isCancelled){return h(null,{status:"cancelled"})}if(m){return h(c9(m))}var n=o&&o.views&&o.views[l[1]]&&o.views[l[1]].map;return n?(k.filter=jY(n),void i.doChanges(k)):h(eX(cs,o.views?"missing json key: "+l[1]:"missing json key: views"))})}else{var g=e0(k.filter);if(!g){return i.doChanges(k)}this.db.get("_design/"+g[0],function(n,o){if(i.isCancelled){return h(null,{status:"cancelled"})}if(n){return h(c9(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(k.filter=aY(m),void i.doChanges(k)):h(eX(cs,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},c6(av,ca.EventEmitter),av.prototype.post=c4("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(eX(ea)):void this.bulkDocs({docs:[h]},g,cI(i))}),av.prototype.put=c4("put",bb(function(h){function j(){i||(dX("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),i=!0)}var n,k,o,g,i=!1,l=h.shift(),m="_id" in l;if("object"!=typeof l||Array.isArray(l)){return(g=h.pop())(eX(ea))}for(;;){if(n=h.shift(),k=typeof n,"string"!==k||m?"string"!==k||!m||"_rev" in l?"object"===k?o=n:"function"===k&&(g=n):(j(),l._rev=n):(j(),l._id=n,m=!0),!h.length){break}}return o=o||{},bH(l._id),dT(l._id)&&"function"==typeof this._putLocal?l._deleted?this._removeLocal(l,g):this._putLocal(l,g):void this.bulkDocs({docs:[l]},o,cI(g))})),av.prototype.putAttachment=c4("putAttachment",function(m,k,g,l,i){function j(n){var o="_rev" in n?parseInt(n._rev,10):0;return n._attachments=n._attachments||{},n._attachments[k]={content_type:i,data:l,revpos:++o},h.put(n)}var h=this;return"function"==typeof i&&(i=l,l=g,g=null),"undefined"==typeof i&&(i=l,l=g,g=null),h.get(m).then(function(n){if(n._rev!==g){throw eX(cY)}return j(n)},function(n){if(n.reason===cs.message){return j({_id:m})}throw n})}),av.prototype.removeAttachment=c4("removeAttachment",function(j,h,g,i){var k=this;k.get(j,function(m,l){return m?void i(m):l._rev!==g?void i(eX(cY)):l._attachments?(delete l._attachments[h],0===Object.keys(l._attachments).length&&delete l._attachments,void k.put(l,i)):i()})}),av.prototype.remove=c4("remove",function(k,i,h,j){var l;"string"==typeof i?(l={_id:k,_rev:i},"function"==typeof h&&(j=h,h={})):(l=k,"function"==typeof i?(j=i,h={}):(j=h,h=i)),h=h||{},h.was_delete=!0;var g={_id:l._id,_rev:l._rev||h.rev};return g._deleted=!0,dT(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(l,j):void this.bulkDocs({docs:[g]},h,cI(j))}),av.prototype.revsDiff=c4("revsDiff",function(h,i,j){function k(o,p){g.has(o)||g.set(o,{missing:[]}),g.get(o).missing.push(p)}function m(q,p){var o=h[q].slice(0);eU(p,function(v,s,r,w,x){var u=s+"-"+r,y=o.indexOf(u);-1!==y&&(o.splice(y,1),"available"!==x.status&&k(q,u))}),o.forEach(function(r){k(q,r)})}"function"==typeof i&&(j=i,i={});var n=Object.keys(h);if(!n.length){return j(null,{})}var l=0,g=new aK.Map;n.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){g.set(o,{missing:h[o]})}else{if(q){return j(q)}m(o,p)}if(++l===n.length){var r={};return g.forEach(function(u,s){r[s]=u}),j(null,r)}})},this)}),av.prototype.bulkGet=c4("bulkGet",function(g,h){dy(this,g,h)}),av.prototype.compactDocument=c4("compactDocument",function(j,h,g){var i=this;this._getRevisionTree(j,function(k,n){if(k){return g(k)}var l=cV(n),o=[],m=[];Object.keys(l).forEach(function(p){l[p]>h&&o.push(p)}),eU(n,function(p,u,r,v,q){var s=u+"-"+r;"available"===q.status&&-1!==o.indexOf(s)&&m.push(s)}),i._doCompaction(j,m,g)})}),av.prototype.compact=c4("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&aI(i)}),av.prototype._compact=function(m,k){function g(n){h.push(i.compactDocument(n.id,0))}function l(n){var o=n.last_seq;cJ.all(h).then(function(){return aD(i,"_local/compaction",function(p){return !p.last_seq||p.last_seq<o?(p.last_seq=o,p):!1})}).then(function(){k(null,{ok:!0})})["catch"](k)}var i=this,j={return_docs:!1,last_seq:m.last_seq||0},h=[];i.changes(j).on("change",g).on("complete",l).on("error",k)},av.prototype.get=c4("get",function(h,i,j){function k(){var o=[],p=m.length;return p?void m.forEach(function(q){n.get(h,{rev:q,revs:i.revs,attachments:i.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||j(null,o)})}):j(null,o)}if("function"==typeof i&&(j=i,i={}),"string"!=typeof h){return j(eX(e9))}if(dT(h)&&"function"==typeof this._getLocal){return this._getLocal(h,j)}var m=[],n=this;if(!i.open_revs){return this._get(h,i,function(y,v){if(y){return j(y)}var B=v.doc,x=v.metadata,C=v.ctx;if(i.conflicts){var o=e8(x);o.length&&(B._conflicts=o)}if(aA(x,B._rev)&&(B._deleted=!0),i.revs||i.revs_info){var A=cP(x.rev_tree),r=fN(A,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(B._rev.split("-")[1])}),p=r.ids.map(function(D){return D.id}).indexOf(B._rev.split("-")[1])+1,w=r.ids.length-p;if(r.ids.splice(p,w),r.ids.reverse(),i.revs&&(B._revisions={start:r.pos+r.ids.length-1,ids:r.ids.map(function(D){return D.id})}),i.revs_info){var s=r.pos+r.ids.length;B._revs_info=r.ids.map(function(D){return s--,{rev:s+"-"+D.id,status:D.opts.status}})}}if(i.attachments&&B._attachments){var z=B._attachments,u=Object.keys(z).length;if(0===u){return j(null,B)}Object.keys(z).forEach(function(D){this._getAttachment(B._id,D,z[D],{rev:B._rev,binary:i.binary,ctx:C},function(F,G){var E=B._attachments[D];E.data=G,delete E.stub,delete E.length,--u||j(null,B)})},n)}else{if(B._attachments){for(var q in B._attachments){B._attachments.hasOwnProperty(q)&&(B._attachments[q].stub=!0)}}j(null,B)}})}if("all"===i.open_revs){this._getRevisionTree(h,function(o,p){return o?j(o):(m=bi(p).map(function(q){return q.rev}),void k())})}else{if(!Array.isArray(i.open_revs)){return j(eX(d5,"function_clause"))}m=i.open_revs;for(var l=0;l<m.length;l++){var g=m[l];if("string"!=typeof g||!/^\d+-/.test(g)){return j(eX(ck))}}k()}}),av.prototype.getAttachment=c4("getAttachment",function(j,h,g,i){var k=this;g instanceof Function&&(i=g,g={}),this._get(j,g,function(m,l){return m?i(m):l.doc._attachments&&l.doc._attachments[h]?(g.ctx=l.ctx,g.binary=!0,k._getAttachment(j,h,l.doc._attachments[h],g,i),void 0):i(eX(cs))})}),av.prototype.allDocs=c4("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(eX(kd,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return ki(this,h,g)}}return this._allDocs(h,g)}),av.prototype.changes=function(g,h){return"function"==typeof g&&(h=g,g={}),new eM(this,g,h)},av.prototype.close=c4("close",function(g){return this._closed=!0,this._close(g)}),av.prototype.info=c4("info",function(g){var h=this;this._info(function(j,i){return j?g(j):(i.db_name=i.db_name||h._db_name,i.auto_compaction=!(!h.auto_compaction||"http"===h.type()),i.adapter=h.type(),void g(null,i))})}),av.prototype.id=c4("id",function(g){return this._id(g)}),av.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},av.prototype.bulkDocs=c4("bulkDocs",function(j,h,g){if("function"==typeof h&&(g=h,h={}),h=h||{},Array.isArray(j)&&(j={docs:j}),!j||!j.docs||!Array.isArray(j.docs)){return g(eX(cf))}for(var i=0;i<j.docs.length;++i){if("object"!=typeof j.docs[i]||Array.isArray(j.docs[i])){return g(eX(ea))}}var k;return j.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){k=k||e3(m)})}),k?g(eX(bw,k)):("new_edits" in h||("new_edits" in j?h.new_edits=j.new_edits:h.new_edits=!0),h.new_edits||"http"===this.type()||j.docs.sort(aj),ad(j.docs),this._bulkDocs(j,h,function(m,l){return m?g(m):(h.new_edits||(l=l.filter(function(n){return n.error})),void g(null,l))}))}),av.prototype.registerDependentDatabase=c4("registerDependentDatabase",function(j,h){function g(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[j]?!1:(k.dependentDbs[j]=!0,k)}var i=new this.constructor(j,this.__opts);aD(this,"_local/_pouch_dependentDbs",g).then(function(){h(null,{db:i})})["catch"](h)}),av.prototype.destroy=c4("destroy",function(j,h){function g(){i._destroy(j,function(l,m){return l?h(l):(i._destroyed=!0,i.emit("destroyed"),void h(null,m||{ok:!0}))})}"function"==typeof j&&(h=j,j={});var i=this,k="use_prefix" in i?i.use_prefix:!0;return"http"===i.type()?g():void i.get("_local/_pouch_dependentDbs",function(l,o){if(l){return 404!==l.status?h(l):g()}var m=o.dependentDbs,p=i.constructor,n=Object.keys(m).map(function(r){var q=k?r.replace(new RegExp("^"+p.prefix),""):r;return new p(q,i.__opts).destroy()});cJ.all(n).then(g,h)})}),bq.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},bq.prototype.fail=function(g){this.failed=g,this.execute()},bq.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},bq.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},c6(dk,av),dk.debug=by,dk.adapters={},dk.preferredAdapters=[],dk.prefix="_pouch_";var c2=new ca.EventEmitter;bS(dk),dk.parseAdapter=function(h,i){var j,k,m=h.match(/([a-z\-]*):\/\/(.*)/);if(m){if(h=/http(s?)/.test(m[1])?m[1]+"://"+m[2]:m[2],j=m[1],!dk.adapters[j].valid()){throw"Invalid adapter"}return{name:h,adapter:m[1]}}var n="idb" in dk.adapters&&"websql" in dk.adapters&&eB()&&localStorage["_pouch__websqldb_"+dk.prefix+h];if(i.adapter){k=i.adapter}else{if("undefined"!=typeof i&&i.db){k="leveldb"}else{for(var l=0;l<dk.preferredAdapters.length;++l){if(k=dk.preferredAdapters[l],k in dk.adapters){if(n&&"idb"===k){dX("log",'PouchDB is downgrading "'+h+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}j=dk.adapters[k];var g=j&&"use_prefix" in j?j.use_prefix:!0;return{name:g?dk.prefix+h:h,adapter:k}},dk.adapter=function(h,g,i){g.valid()&&(dk.adapters[h]=g,i&&dk.preferredAdapters.push(h))},dk.plugin=function(g){return"function"==typeof g?g(dk):Object.keys(g).forEach(function(h){dk.prototype[h]=g[h]}),dk},dk.defaults=function(g){function h(k,i,j){return this instanceof h?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=j9.extend({},g,i),void dk.call(this,k,i,j)):new h(k,i,j)}return c6(h,dk),h.preferredAdapters=dk.preferredAdapters.slice(),Object.keys(dk).forEach(function(i){i in h||(h[i]=dk[i])}),h};var dw="5.4.4";dk.version=dw;var bA,fG=dC(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cu=dC(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),d1=function(g){return atob(g)},cA=function(g){return btoa(g)},dP=dg.setImmediate||dg.setTimeout,bG=32768,dV=5,e7="document-store",dG="by-sequence",f4="attach-store",cB="attach-seq-store",jQ="meta-store",cN="local-store",aH="detect-blob-support",cv={running:!1,queue:[]},dM=new aK.Map,cW=new eK,ej=new aK.Map;j0.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var dB=7,aF=aw("document-store"),dL=aw("by-sequence"),cg=aw("attach-store"),bg=aw("local-store"),ab=aw("metadata-store"),el=aw("attach-seq-store"),dl=new aK.Map,jT=new eK,ag=1,a9="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+dL+" (seq, deleted)",bT="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+dL+" (doc_id, rev)",dQ="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+aF+" (winningseq)",d7="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+el+" (seq)",j6="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+el+" (digest, seq)",aJ=dL+".seq = "+aF+".winningseq",jK=dL+".seq AS seq, "+dL+".deleted AS deleted, "+dL+".json AS data, "+dL+".rev AS rev, "+aF+".json AS metadata";eS.valid=ek,eS.use_prefix=!0;var jS=ap(),aN=function(){},bL=25,cT=50,aW={},az=1800,b7=by("pouchdb:http");jZ.valid=function(){return !0},kk.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},kk.prototype.finish=function(){return this.promise};var fA=function(g,h){return h&&g.then(function(i){fB.nextTick(function(){h(null,i)})},function(i){fB.nextTick(function(){h(i)})}),g},kf=function(g){return bb(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&fA(i,j),i})},fF=function(g,h){return g.then(function(i){return h().then(function(){return i})},function(i){return h().then(function(){throw i})})},f2=function(g,h){return function(){var j=arguments,i=this;return g.add(function(){return h.apply(i,j)})}},j5=function(k){for(var i={},h=0,j=k.length;j>h;h++){i["$"+k[h]]=!0}var l=Object.keys(i),g=new Array(l.length);for(h=0,j=l.length;j>h;h++){g[h]=l[h].substring(1)}return g},bN={},b0=new kk,ax=50,bp=dX.bind(null,"log"),bx={_sum:function(g,h){return dA(h)},_count:function(g,h){return h.length},_stats:function(h,g){function i(m){for(var k=0,j=0,l=m.length;l>j;j++){var n=m[j];k+=n*n}return k}return{sum:dA(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},d9=kf(function(){var g=this;return"http"===g.type()?cl(g):"function"==typeof g._viewCleanup?ec(g):eq(g)}),ak=function(j,h,g){"function"==typeof h&&(g=h,h={}),h=h?e1(h):{},"function"==typeof j&&(j={map:j});var i=this,k=cJ.resolve().then(function(){return fC(i,j,h)});return fA(k,g),k};c6(f9,Error),c6(kl,Error),c6(d0,Error);var bD={query:ak,viewCleanup:d9},ke=1,dK="pouchdb",dp=5,b3=0;ac.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},ac.prototype.updateTarget=function(g,h){return b9(this.target,this.id,g,h,this.returnValue)},ac.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?cJ.resolve(!0):b9(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(dR(j)){return i.readOnlySource=!0,!0}throw j})};var bj={undefined:function(g,h){return 0===cx.collate(g.last_seq,h.last_seq)?h.last_seq:0},1:function(g,h){return bm(h,g).last_seq}};ac.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?cJ.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return b3}var j;return j=h.version?h.version.toString():"undefined",j in bj?bj[j](h,i):b3},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:b3}).then(function(){return b3},function(j){return dR(j)?(g.readOnlySource=!0,h.last_seq):b3})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return b3})};var bZ=0;c6(cz,ca.EventEmitter),cz.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},cz.prototype.ready=function(j,h){function g(){k.cancel()}function i(){j.removeListener("destroyed",g),h.removeListener("destroyed",g)}var k=this;k._readyCalled||(k._readyCalled=!0,j.once("destroyed",g),h.once("destroyed",g),k.once("complete",i))},c6(eD,ca.EventEmitter),eD.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},dk.plugin(am).plugin(eN).plugin(f6).plugin(bD).plugin(bz),c.exports=dk}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(c,f,d){function g(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}f.exports=g},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+f.humanize(this.diff),!n){return e}var o="color: "+this.color;e=[e[0],o,"color: inherit"].concat(Array.prototype.slice.call(e,1));var p=0,i=0;return e[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),e.splice(i,0,o),e}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(p,d,k){function h(){return k.colors[m++%k.colors.length]}function j(e){function i(){}function n(){var o=n,s=+new Date,r=s-(q||s);o.diff=r,o.prev=q,o.curr=s,q=s,null==o.useColors&&(o.useColors=k.useColors()),null==o.color&&o.useColors&&(o.color=h());var u=Array.prototype.slice.call(arguments);u[0]=k.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=k.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof k.formatArgs&&(u=k.formatArgs.apply(o,u));var x=n.log||k.log||console.log.bind(console);x.apply(o,u)}i.enabled=!1,n.enabled=!0;var f=k.enabled(e)?n:i;return f.namespace=e,f}function l(n){k.save(n);for(var e=(n||"").split(/[\s,]+/),i=e.length,f=0;i>f;f++){e[f]&&(n=e[f].replace(/\*/g,".*?"),"-"===n[0]?k.skips.push(new RegExp("^"+n.substr(1)+"$")):k.names.push(new RegExp("^"+n+"$")))}}function v(){k.enable("")}function g(i){var e,f;for(e=0,f=k.skips.length;f>e;e++){if(k.skips[e].test(i)){return !1}}for(e=0,f=k.names.length;f>e;e++){if(k.names[e].test(i)){return !0}}return !1}function c(e){return e instanceof Error?e.stack||e.message:e}k=d.exports=j,k.coerce=c,k.disable=v,k.enable=l,k.enabled=g,k.humanize=p(11),k.names=[],k.skips=[],k.formatters={};var q,m=0},{11:11}],7:[function(d,c,f){(function(w){function p(){v=!0;for(var l,i,n=q.length;n;){for(i=q,q=[],l=-1;++l<n;){i[l]()}n=q.length}v=!1}function j(i){1!==q.push(i)||v||k()}var k,t=w.MutationObserver||w.WebKitMutationObserver;if(t){var e=0,h=new t(p),g=w.document.createTextNode("");h.observe(g,{characterData:!0}),k=function(){g.data=e=++e%2}}else{if(w.setImmediate||"undefined"==typeof w.MessageChannel){k="document" in w&&"onreadystatechange" in w.document.createElement("script")?function(){var i=w.document.createElement("script");i.onreadystatechange=function(){p(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},w.document.documentElement.appendChild(i)}:function(){setTimeout(p,0)}}else{var m=new w.MessageChannel;m.port1.onmessage=p,k=function(){m.port2.postMessage(0)}}}var v,q=[];c.exports=j}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(l){if(l){for(var k in l){"object"==typeof l[k]&&i[k]?h.call(i,i[k],l[k]):i[k]=l[k]}}}),i};this.extend=h}).call(this)},{}],10:[function(E,k,x){function D(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=C,this.queue=[],this.outcome=void 0,e!==D&&g(this,e)}function I(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function F(f,e,h){G(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function J(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(i,m){function f(o){e||(e=!0,d.reject(i,o))}function h(o){e||(e=!0,d.resolve(i,o))}function l(){m(h,f)}var e=!1,n=w(l);"error"===n.status&&f(n.value)}function w(f,i){var h={};try{h.value=f(i),h.status="success"}catch(e){h.status="error",h.value=e}return h}function A(e){return e instanceof this?e:d.resolve(new this(D),e)}function q(f){var e=new this(D);return d.reject(e,f)}function z(h){function n(r,s){function t(u){m[s]=u,++i!==o||e||(e=!0,d.resolve(l,m))}p.resolve(r).then(t,function(u){e||(e=!0,d.reject(l,u))})}var p=this;if("[object Array]"!==Object.prototype.toString.call(h)){return this.reject(new TypeError("must be an array"))}var o=h.length,e=!1;if(!o){return this.resolve([])}for(var m=new Array(o),i=0,f=-1,l=new this(D);++f<o;){n(h[f],f)}return l}function B(i){function m(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(h,p))},function(p){e||(e=!0,d.reject(h,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(i)){return this.reject(new TypeError("must be an array"))}var l=i.length,e=!1;if(!l){return this.resolve([])}for(var n=-1,h=new this(D);++n<l;){m(i[n])}return h}var G=E(7),d={},c=["REJECTED"],H=["FULFILLED"],C=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(e,i){if("function"!=typeof e&&this.state===H||"function"!=typeof i&&this.state===c){return this}var h=new this.constructor(D);if(this.state!==C){var f=this.state===H?e:i;F(h,f,this.outcome)}else{this.queue.push(new I(h,e,i))}return h},I.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},I.prototype.otherCallFulfilled=function(e){F(this.promise,this.onFulfilled,e)},I.prototype.callRejected=function(e){d.reject(this.promise,e)},I.prototype.otherCallRejected=function(e){F(this.promise,this.onRejected,e)},d.resolve=function(h,f){var l=w(J,f);if("error"===l.status){return d.reject(h,l.value)}var m=l.value;if(m){g(h,m)}else{h.state=H,h.outcome=f;for(var i=-1,e=h.queue.length;++i<e;){h.queue[i].callFulfilled(f)}}return h},d.reject=function(f,i){f.state=c,f.outcome=i;for(var h=-1,e=f.queue.length;++h<e;){f.queue[h].callRejected(i)}return f},j.resolve=A,j.reject=q,j.all=z,j.race=B},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(v,m,c){function C(o){if(null!==o){switch(typeof o){case"boolean":return o?1:0;case"number":return q(o);case"string":return o.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var n=Array.isArray(o),e=n?o:Object.keys(o),i=-1,l=e.length,f="";if(n){for(;++i<l;){f+=c.toIndexableString(e[i])}}else{for(;++i<l;){var h=e[i];f+=c.toIndexableString(h)+c.toIndexableString(o[h])}}return f}}return""}function j(l,r){var h,e=r,f="1"===l[r];if(f){h=0,r++}else{var i="0"===l[r];r++;var o="",s=l.substring(r,r+z),p=parseInt(s,10)+x;for(i&&(p=-p),r+=z;;){var n=l[r];if("\x00"===n){break}o+=n,r++}o=o.split("."),h=1===o.length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(h-=10),0!==p&&(h=parseFloat(h+"e"+p))}return{num:h,length:r-e}}function d(e,i){var n=e.pop();if(i.length){var f=i[i.length-1];n===f.element&&(i.pop(),f=i[i.length-1]);var l=f.element,o=f.index;if(Array.isArray(l)){l.push(n)}else{if(o===e.length-2){var h=e.pop();l[h]=n}else{e.push(n)}}}}function y(h,e){for(var f=Math.min(h.length,e.length),i=0;f>i;i++){var l=c.collate(h[i],e[i]);if(0!==l){return l}}return h.length===e.length?0:h.length>e.length?1:-1}function B(f,e){return f===e?0:f>e?1:-1}function w(o,n){for(var e=Object.keys(o),i=Object.keys(n),l=Math.min(e.length,i.length),f=0;l>f;f++){var h=c.collate(e[f],i[f]);if(0!==h){return h}if(h=c.collate(o[e[f]],n[i[f]]),0!==h){return h}}return e.length===i.length?0:e.length>i.length?1:-1}function k(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function q(l){if(0===l){return"1"}var p=l.toExponential().split(/e\+?/),h=parseInt(p[1],10),e=0>l,f=e?"0":"2",i=(e?-h:h)-x,n=g.padLeft(i.toString(),"0",z);f+=A+n;var r=Math.abs(parseFloat(p[0]));e&&(r=10-r);var o=r.toFixed(20);return o=o.replace(/\.?0+$/,""),f+=A+o}var x=-324,z=3,A="",g=v(13);c.collate=function(h,e){if(h===e){return 0}h=c.normalizeKey(h),e=c.normalizeKey(e);var f=k(h),i=k(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return B(h,e)}return Array.isArray(h)?y(h,e):w(h,e)},c.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=c.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=c.normalizeKey(e))}}}}}return l},c.toIndexableString=function(f){var e="\x00";return f=c.normalizeKey(f),k(f)+A+C(f)+e},c.parseIndexableString=function(l){for(var r=[],f=[],e=0;;){var o=l[e++];if("\x00"!==o){switch(o){case"1":r.push(null);break;case"2":r.push("1"===l[e]),e++;break;case"3":var s=j(l,e);r.push(s.num),e+=s.length;break;case"4":for(var p="";;){var n=l[e];if("\x00"===n){break}p+=n,e++}p=p.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(p);break;case"5":var i={element:[],index:r.length};r.push(i.element),f.push(i);break;case"6":var h={element:{},index:r.length};r.push(h.element),f.push(h);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}}else{if(1===r.length){return r.pop()}d(r,f)}}}},{13:13}],13:[function(c,f,d){function g(e,j,i){for(var k="",h=i-e.length;k.length<h;){k+=j}return k}d.padLeft=function(h,e,j){var i=g(h,e,j);return i+h},d.padRight=function(h,e,j){var i=g(h,e,j);return h+i},d.stringLexCompare=function(p,j){var m,l=p.length,h=j.length;for(m=0;l>m;m++){if(m===h){return 1}var k=p.charAt(m),e=j.charAt(m);if(k!==e){return e>k?-1:1}}return h>l?-1:0},d.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(h,f,d){function g(){this.store={}}function c(i){if(this.store=new g,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}d.Map=g,d.Set=c,g.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},g.prototype.unmangle=function(e){return e.substring(1)},g.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},g.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},g.prototype.has=function(i){var e=this.mangle(i);return e in this.store},g.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},g.prototype.forEach=function(k){for(var e=Object.keys(this.store),l=0,j=e.length;j>l;l++){var i=e[l],m=this.store[i];i=this.unmangle(i),k(m,i)}},c.prototype.add=function(e){return this.store.set(e,!0)},c.prototype.has=function(e){return this.store.has(e)},c.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(l,k){var j,i,m,h;i=[],h=[];for(j in k){e.call(k,j)&&(m=k[j],"this"!==j&&(i.push(j),h.push(m)))}return Function.apply(null,g.call(i).concat([l])).apply(k["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(C){function E(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function q(m,i,l,n,h,o,g){return E(i&l|~i&n,m,i,h,o,g)}function F(m,i,l,n,h,o,g){return E(i&n|l&~n,m,i,h,o,g)}function G(m,i,l,n,h,o,g){return E(i^l^n,m,i,h,o,g)}function A(m,i,l,n,h,o,g){return E(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=q(n,i,g,m,h[0],7,-680876936),m=q(m,n,i,g,h[1],12,-389564586),g=q(g,m,n,i,h[2],17,606105819),i=q(i,g,m,n,h[3],22,-1044525330),n=q(n,i,g,m,h[4],7,-176418897),m=q(m,n,i,g,h[5],12,1200080426),g=q(g,m,n,i,h[6],17,-1473231341),i=q(i,g,m,n,h[7],22,-45705983),n=q(n,i,g,m,h[8],7,1770035416),m=q(m,n,i,g,h[9],12,-1958414417),g=q(g,m,n,i,h[10],17,-42063),i=q(i,g,m,n,h[11],22,-1990404162),n=q(n,i,g,m,h[12],7,1804603682),m=q(m,n,i,g,h[13],12,-40341101),g=q(g,m,n,i,h[14],17,-1502002290),i=q(i,g,m,n,h[15],22,1236535329),n=F(n,i,g,m,h[1],5,-165796510),m=F(m,n,i,g,h[6],9,-1069501632),g=F(g,m,n,i,h[11],14,643717713),i=F(i,g,m,n,h[0],20,-373897302),n=F(n,i,g,m,h[5],5,-701558691),m=F(m,n,i,g,h[10],9,38016083),g=F(g,m,n,i,h[15],14,-660478335),i=F(i,g,m,n,h[4],20,-405537848),n=F(n,i,g,m,h[9],5,568446438),m=F(m,n,i,g,h[14],9,-1019803690),g=F(g,m,n,i,h[3],14,-187363961),i=F(i,g,m,n,h[8],20,1163531501),n=F(n,i,g,m,h[13],5,-1444681467),m=F(m,n,i,g,h[2],9,-51403784),g=F(g,m,n,i,h[7],14,1735328473),i=F(i,g,m,n,h[12],20,-1926607734),n=G(n,i,g,m,h[5],4,-378558),m=G(m,n,i,g,h[8],11,-2022574463),g=G(g,m,n,i,h[11],16,1839030562),i=G(i,g,m,n,h[14],23,-35309556),n=G(n,i,g,m,h[1],4,-1530992060),m=G(m,n,i,g,h[4],11,1272893353),g=G(g,m,n,i,h[7],16,-155497632),i=G(i,g,m,n,h[10],23,-1094730640),n=G(n,i,g,m,h[13],4,681279174),m=G(m,n,i,g,h[0],11,-358537222),g=G(g,m,n,i,h[3],16,-722521979),i=G(i,g,m,n,h[6],23,76029189),n=G(n,i,g,m,h[9],4,-640364487),m=G(m,n,i,g,h[12],11,-421815835),g=G(g,m,n,i,h[15],16,530742520),i=G(i,g,m,n,h[2],23,-995338651),n=A(n,i,g,m,h[0],6,-198630844),m=A(m,n,i,g,h[7],10,1126891415),g=A(g,m,n,i,h[14],15,-1416354905),i=A(i,g,m,n,h[5],21,-57434055),n=A(n,i,g,m,h[12],6,1700485571),m=A(m,n,i,g,h[3],10,-1894986606),g=A(g,m,n,i,h[10],15,-1051523),i=A(i,g,m,n,h[1],21,-2054922799),n=A(n,i,g,m,h[8],6,1873313359),m=A(m,n,i,g,h[15],10,-30611744),g=A(g,m,n,i,h[6],15,-1560198380),i=A(i,g,m,n,h[13],21,1309151649),n=A(n,i,g,m,h[4],6,-145523070),m=A(m,n,i,g,h[11],10,-1120210379),g=A(g,m,n,i,h[2],15,718787259),i=A(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function z(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function x(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function D(g){var p,h,o,r,m,l,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(p=64;i>=p;p+=64){M(n,z(g.substring(p-64,p)))}for(g=g.substring(p-64),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;h>p;p+=1){o[p>>2]|=g.charCodeAt(p)<<(p%4<<3)}if(o[p>>2]|=128<<(p%4<<3),p>55){for(M(n,o),p=0;16>p;p+=1){o[p]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=m,o[15]=l,M(n,o),n}function w(g){var l,h,o,r,m,p,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(l=64;i>=l;l+=64){M(n,x(g.subarray(l-64,l)))}for(g=i>l-64?g.subarray(l-64):new Uint8Array(0),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;h>l;l+=1){o[l>>2]|=g[l]<<(l%4<<3)}if(o[l>>2]|=128<<(l%4<<3),l>55){for(M(n,o),l=0;16>l;l+=1){o[l]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),p=parseInt(r[1],16)||0,o[14]=m,o[15]=p,M(n,o),n}function B(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function H(h){var g;for(g=0;g<h.length;g+=1){h[g]=B(h[g])}return h.join("")}function J(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function I(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==H(D("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(h,i){return h=0|h||0,0>h?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(i,o){var s,r,h,n,l=this.byteLength,m=g(i,l),p=l;return o!==C&&(p=g(o,l)),m>p?new ArrayBuffer(0):(s=p-m,r=new ArrayBuffer(s),h=new Uint8Array(r),n=new Uint8Array(this,m,s),h.set(n),r)}}(),I.prototype.append=function(g){return this.appendBinary(J(g)),this},I.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,z(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},I.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=H(this._hash),l&&(n=N(n)),this.reset(),n},I.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},I.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},I.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},I.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},I.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},I.hash=function(h,g){return I.hashBinary(J(h),g)},I.hashBinary=function(i,g){var l=D(i),h=H(l);return g?N(h):h},I.ArrayBuffer=function(){this.reset()},I.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,x(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},I.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=H(this._hash),l&&(n=N(n)),this.reset(),n},I.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},I.ArrayBuffer.prototype.getState=function(){var g=I.prototype.getState.call(this);return g.buff=j(g.buff),g},I.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),I.prototype.setState.call(this,g)},I.ArrayBuffer.prototype.destroy=I.prototype.destroy,I.ArrayBuffer.prototype._finish=I.prototype._finish,I.ArrayBuffer.hash=function(i,g){var l=w(new Uint8Array(i)),h=H(l);return g?N(h):h},I})},{}],17:[function(c,f,d){function g(p,j,m){var l=m[m.length-1];p===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,k=l.index;if(Array.isArray(h)){h.push(p)}else{if(k===j.length-2){var e=j.pop();h[e]=p}else{j.push(p)}}}d.stringify=function(w){var x=[];x.push({obj:w});for(var B,h,q,m,v,z,A,y,p,k,e,j="";B=x.pop();){if(h=B.obj,q=B.prefix||"",m=B.val||"",j+=q,m){j+=m}else{if("object"!=typeof h){j+="undefined"==typeof h?null:JSON.stringify(h)}else{if(null===h){j+="null"}else{if(Array.isArray(h)){for(x.push({val:"]"}),v=h.length-1;v>=0;v--){z=0===v?"":",",x.push({obj:h[v],prefix:z})}x.push({val:"["})}else{A=[];for(y in h){h.hasOwnProperty(y)&&A.push(y)}for(x.push({val:"}"}),v=A.length-1;v>=0;v--){p=A[v],k=h[p],e=v>0?",":"",e+=JSON.stringify(p)+":",x.push({obj:k,prefix:e})}x.push({val:"{"})}}}}}return j},d.parse=function(j){for(var h,y,e,m,q,z,v,r,p,x=[],w=[],k=0;;){if(h=j[k++],"}"!==h&&"]"!==h&&"undefined"!=typeof h){switch(h){case" ":case"	":case"\n":case":":case",":break;case"n":k+=3,g(null,x,w);break;case"t":k+=3,g(!0,x,w);break;case"f":k+=4,g(!1,x,w);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(y="",k--;;){if(e=j[k++],!/[\d\.\-e\+]/.test(e)){k--;break}y+=e}g(parseFloat(y),x,w);break;case'"':for(m="",q=void 0,z=0;;){if(v=j[k++],'"'===v&&("\\"!==q||z%2!==1)){break}m+=v,q=v,"\\"===q?z++:z=0}g(JSON.parse('"'+m+'"'),x,w);break;case"[":r={element:[],index:x.length},x.push(r.element),w.push(r);break;case"{":p={element:{},index:x.length},x.push(p.element),w.push(p);break;default:throw new Error("unexpectedly reached end of input: "+h)}}else{if(1===x.length){return x.pop()}g(x.pop(),x,w)}}}},{}]},{},[3])(3)});