!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(j,g){if(!i[j]){if(!l[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(e){return e(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=i[j]={exports:{}};l[j][0].call(f.exports,function(p){var m=l[j][1][p];return a(m?m:p)},f,f.exports,d,l,i,b)}return i[j].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,r,l,h,j,f;if(this._events||(this._events={}),"error"===k&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[k],p(r)){return !1}if(b(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(i(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(g,j){function f(){this.removeListener(g,f),h||(h=!0,j.apply(this,arguments))}if(!b(j)){throw TypeError("listener must be a function")}var h=!1;return f.listener=j,this.on(g,f),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(i(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(i,a,b){function h(){B&&s&&(B=!1,s.length?u=s.concat(u):e=-1,u.length&&r())}function r(){if(!B){var g=n(h);B=!0;for(var j=u.length;j;){for(s=u,u=[];++e<j;){s&&s[e].run()}e=-1,j=u.length}s=null,B=!1,f(g)}}function l(g,j){this.fun=g,this.array=j}function t(){}var n,f,o=a.exports={};!function(){try{n=setTimeout}catch(g){n=function(){throw new Error("setTimeout is not defined")}}try{f=clearTimeout}catch(g){f=function(){throw new Error("clearTimeout is not defined")}}}();var s,u=[],B=!1,e=-1;o.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}u.push(new l(j,k)),1!==u.length||B||n(r,0)},l.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=t,o.addListener=t,o.once=t,o.off=t,o.removeListener=t,o.removeAllListeners=t,o.emit=t,o.binding=function(g){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(g){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(e,a,b){(function(g9,jt){function cn(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fc(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fZ(ac){if("function"==typeof ac.slice){return ac.slice(0)}var aa=new ArrayBuffer(ac.byteLength),ab=new Uint8Array(aa),t=new Uint8Array(ac);return ab.set(t),aa}function iO(t){if(t instanceof ArrayBuffer){return fZ(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function hn(t){var aa=Object.getPrototypeOf(t);if(null===aa){return !0}var ab=aa.constructor;return"function"==typeof ab&&ab instanceof ab&&de.call(ab)==gp}function fp(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=fp(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(fc(ac)){return iO(ac)}if(!hn(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=fp(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function fi(t){var aa=!1;return hS(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function ee(t){return hS(function(ac){ac=fp(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){g9.nextTick(function(){ad(ah,ag)})});var af=new he(function(ah,aj){var al;try{var ag=fi(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function ge(t,aa){function ab(af,ah,ac){if(gB.enabled){for(var ag=[af._db_name,ah],ad=0;ad<ac.length-1;ad++){ag.push(ac[ad])}gB.apply(null,ag);var aj=ac[ac.length-1];ac[ac.length-1]=function(ak,am){var al=[af._db_name,ah];al=al.concat(ak?["error",ak]:["success",am]),gB.apply(null,al),aj(ak,am)}}}return ee(hS(function(ad){if(this._closed){return he.reject(new Error("database is closed"))}if(this._destroyed){return he.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new he(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function gC(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function fy(t){return t}function gX(t){return[{ok:t}]}function gf(aq,ak,aa){function ah(){var av=[];ag.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aa(null,{results:av})}function ac(){++au===al&&ah()}function t(ax,av,aw){ag[ax]={id:av,docs:aw},ac()}function af(){if(!(aj>=ad.length)){var av=Math.min(aj+i8,ad.length),aw=ad.slice(aj,av);am(aw,aj),aj+=aw.length}}function am(av,aw){av.forEach(function(ay,aC){var aA=aw+aC,ax=ab[ay],az=gC(ax[0],["atts_since","attachments"]);az.open_revs=ax.map(function(aD){return aD.rev}),az.open_revs=az.open_revs.filter(fy);var aB=fy;0===az.open_revs.length&&(delete az.open_revs,aB=gX),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ak&&(az[aD]=ak[aD])}),aq.get(ay,az,function(aD,aF){var aE;aE=aD?[{error:aD}]:aB(aF),t(aA,ay,aE),af()})})}var ap=ak.docs,ab={};ap.forEach(function(av){av.id in ab?ab[av.id].push(av):ab[av.id]=[av]});var al=Object.keys(ab).length,au=0,ag=new Array(al),ad=Object.keys(ab),aj=0;af()}function fu(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ga(){return at}function er(t){fu()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ga()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function co(){jC.EventEmitter.call(this),this._listeners={},er(this)}function iu(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function fU(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function gl(t){var aa=0;return t||(aa=2000),fU(t,aa)}function go(t,aa){iu("info","The above "+t+" is totally normal. "+aa)}function fv(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function ii(ac,aa,ab){function t(af){for(var ad in ac){"function"!=typeof ac[ad]&&(this[ad]=ac[ad])}void 0!==ab&&(this.name=ab),void 0!==af&&(this.reason=af)}return t.prototype=fv.prototype,new t(aa)}function iC(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=gu("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=ew:"doc_validation"===aa?(ad=ei,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=h7),ad||(ad=gu("status",ac.status,af)||ik),t=ii(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function iS(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return ii(h7,ab)}}function hA(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&iS(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function R(ac){for(var aa=[],ab=0,t=ac.length;t>ab;ab++){aa=aa.concat(ac[ab])}return aa}function hs(t){var aa;if(t?"string"!=typeof t?aa=ii(iq):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=ii(et)):aa=ii(hl),aa){throw aa}}function iy(t,aa){return"listenerCount" in t?t.listenerCount(aa):jC.EventEmitter.listenerCount(t,aa)}function gh(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function jd(t){var aa=gh(t);return aa?aa.join("/"):null}function gd(ab){for(var ad=be.exec(ab),ag={},ac=14;ac--;){var aa=bt[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[q]={},ag[bt[12]].replace(ez,function(ah,ak,aj){ak&&(ag[q][ak]=aj)}),ag}function fx(t,aa,ab){return new he(function(ad,ac){t.get(aa,function(ag,aj){if(ag){if(404!==ag.status){return ac(ag)}aj={}}var af=aj._rev,ah=ab(aj);return ah?(ah._id=aa,ah._rev=af,void ad(w(t,ah,ab))):ad({updated:!1,rev:af})})})}function w(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return fx(t,aa._id,ab)})}function iv(t){return 0|Math.random()*t}function eo(ac,aa){aa=aa||fo.length;var ab="",t=-1;if(ac){for(;++t<ac;){ab+=fo[iv(aa)]}return ab}for(;++t<36;){switch(t){case 8:case 13:case 18:case 23:ab+="-";break;case 19:ab+=fo[3&iv(16)|8];break;default:ab+=fo[iv(16)]}}return ab}function gs(t){for(var ap,ak,am,al,ah=t.rev_tree.slice();al=ah.pop();){var ab=al.ids,ag=ab[2],aa=al.pos;if(ag.length){for(var ac=0,af=ag.length;af>ac;ac++){ah.push({pos:aa+1,ids:ag[ac]})}}else{var aj=!!ab[1].deleted,ad=ab[0];ap&&!(am!==aj?am:ak!==aa?aa>ak:ad>ap)||(ap=ad,ak=aa,am=aj)}}return ak+"-"+ap}function fd(ak,ah){for(var ac,af=ak.slice();ac=af.pop();){for(var ad=ac.pos,aa=ac.ids,aj=aa[2],ag=ah(0===aj.length,ad,aa[0],ac.ctx,aa[1]),t=0,ab=aj.length;ab>t;t++){af.push({pos:ad+1,ids:aj[t],ctx:ag})}}}function g(t,aa){return t.pos-aa.pos}function i1(ac){var aa=[];fd(ac,function(af,aj,ag,ad,ah){af&&aa.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),aa.sort(g).reverse();for(var ab=0,t=aa.length;t>ab;ab++){delete aa[ab].pos}return aa}function gz(ab){for(var ad=gs(ab),ag=i1(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function jo(t){var aa=[];return fd(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function iD(t){for(var ap,ak=[],am=t.slice();ap=am.pop();){var al=ap.pos,ah=ap.ids,ab=ah[0],ag=ah[1],aa=ah[2],ac=0===aa.length,af=ap.history?ap.history.slice():[];af.push({id:ab,opts:ag}),ac&&ak.push({pos:al+1-af.length,ids:af});for(var aj=0,ad=aa.length;ad>aj;aj++){am.push({pos:al+1,ids:aa[aj],history:af})}}return ak.reverse()}function a3(t,aa){return t.pos-aa.pos}function iz(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function iM(ac,aa,ab){var t=iz(ac,aa,ab);ac.splice(t,0,aa)}function bo(aa,ah){for(var ad,ag,af=ah,t=aa.length;t>af;af++){var ab=aa[af],ac=[ab.id,ab.opts,[]];ag?(ag[2].push(ac),ag=ac):ad=ag=ac}return ad}function hU(t,aa){return t[0]<aa[0]?-1:1}function V(ak,ah){for(var ac=[{tree1:ak,tree2:ah}],af=!1;ac.length>0;){var ad=ac.pop(),aa=ad.tree1,aj=ad.tree2;(aa[1].status||aj[1].status)&&(aa[1].status="available"===aa[1].status||"available"===aj[1].status?"available":"missing");for(var ag=0;ag<aj[2].length;ag++){if(aa[2][0]){for(var t=!1,ab=0;ab<aa[2].length;ab++){aa[2][ab][0]===aj[2][ag][0]&&(ac.push({tree1:aa[2][ab],tree2:aj[2][ag]}),t=!0)}t||(af="new_branch",iM(aa[2],aj[2][ag],hU))}else{af="new_leaf",aa[2][0]=aj[2][ag]}}}return{conflicts:af,tree:ak}}function jg(ab,aa,ad){var aj,av=[],aq=!1,ac=!1;if(!ab.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=ab.length;aw>ak;ak++){var ag=ab[ak];if(ag.pos===aa.pos&&ag.ids[0]===aa.ids[0]){aj=V(ag.ids,aa.ids),av.push({pos:ag.pos,ids:aj.tree}),aq=aq||aj.conflicts,ac=!0}else{if(ad!==!0){var al=ag.pos<aa.pos?ag:aa,t=ag.pos<aa.pos?aa:ag,am=t.pos-al.pos,ap=[],ax=[];for(ax.push({ids:al.ids,diff:am,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],af=0,ah=az.length;ah>af;af++){ax.push({ids:az[af],diff:ay.diff-1,parent:ay.ids,parentIdx:af})}}else{ay.ids[0]===t.ids[0]&&ap.push(ay)}}var au=ap[0];au?(aj=V(au.ids,t.ids),au.parent[2][au.parentIdx]=aj.tree,av.push({pos:al.pos,ids:al.ids}),aq=aq||aj.conflicts,ac=!0):av.push(ag)}else{av.push(ag)}}}return ac||av.push(aa),av.sort(a3),{tree:av,conflicts:aq||"internal_node"}}function di(t,ap){for(var ak,am=iD(t),al={},ah=0,ab=am.length;ab>ah;ah++){for(var ag=am[ah],aa=ag.ids,ac=Math.max(0,aa.length-ap),af={pos:ag.pos+ac,ids:bo(aa,ac)},aj=0;ac>aj;aj++){var ad=ag.pos+aj+"-"+aa[aj].id;al[ad]=!0}ak=ak?jg(ak,af,!0).tree:[af]}return fd(ak,function(av,aq,au){delete al[aq+"-"+au]}),{tree:ak,revs:Object.keys(al)}}function jE(ac,t,aa){var ad=jg(ac,t),ab=di(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function hB(ak,ah){for(var ac,af=ak.slice(),ad=ah.split("-"),aa=parseInt(ad[0],10),aj=ad[1];ac=af.pop();){if(ac.pos===aa&&ac.ids[0]===aj){return !0}for(var ag=ac.ids[2],t=0,ab=ag.length;ab>t;t++){af.push({pos:ac.pos+1,ids:ag[t]})}}return !1}function iT(t){return t.ids}function g0(ac,t){t||(t=gs(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(iT);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function g6(t){return/^_local/.test(t)}function gO(t){return ij("return "+t+";",{})}function jw(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function ex(t,aa){try{t.emit("change",aa)}catch(ab){iu("error",'Error in .on("change", function):',ab)}}function h1(ab,ad,ag){function ac(){aa.cancel()}jC.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?fp(ad):{};var t=ad.complete=fi(function(ah,aj){ah?iy(aa,"error")>0&&aa.emit("error",ah):aa.emit("complete",aj),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(ex(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new he(function(ah,aj){ad.complete=function(al,ak){al?aj(al):ah(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function gk(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=i1(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return g0(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=gz(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function iP(t,aa){return aa>t?-1:t>aa?1:0}function ar(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function E(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function gK(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=gC(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function l(ac,t){var aa=iP(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return iP(ad,ab)}function hF(t){var aa={},ab=[];return fd(t,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(aa[ah]=0),void 0!==ag&&ab.push({from:ag,to:ah}),ah}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function r(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return he.all(ad.map(function(af){var ag=gc.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new he(function(ah,aj){ac._allDocs(ag,function(ak,al){return ak?aj(ak):(ab.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function a4(ac){var aa=ac._compactionQueue[0],t=aa.opts,ab=aa.callback;ac.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(t.last_seq=ad.last_seq),ac._compact(t,function(ag,af){ag?ab(ag):ab(null,af),g9.nextTick(function(){ac._compactionQueue.shift(),ac._compactionQueue.length&&a4(ac)})})})}function h2(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function jB(){jC.EventEmitter.call(this)}function g5(){this.isReady=!1,this.failed=!1,this.queue=[]}function fa(t){t&&jt.debug&&iu("error",t)}function gE(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function g4(ab,ad,ag){if(!(this instanceof g4)){return new g4(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=fa}else{var aa=ag;ag=function(){return iu("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=fp(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=g4.prefix,jB.call(ac),ac.taskqueue=new g5;var af=new he(function(ak,ah){ag=function(ap,am){return ap?ah(ap):(delete am.then,void ak(am))},ad=fp(ad);var aj,al;return function(){try{if("string"!=typeof ab){throw al=new Error("Missing/invalid DB name"),al.code=400,al}var ap=(ad.prefix||"")+ab;if(aj=g4.parseAdapter(ap,ad),ad.originalName=ab,ad.name=aj.name,ad.adapter=ad.adapter||aj.adapter,ac._adapter=ad.adapter,gi("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!g4.adapters[ad.adapter]){throw al=new Error("Adapter is missing"),al.code=404,al}if(!g4.adapters[ad.adapter].valid()){throw al=new Error("Invalid Adapter"),al.code=404,al}}catch(am){ac.taskqueue.fail(am)}}(),al?ah(al):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void g4.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(gE(ac,ad),ac.emit("created",ac),g4.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function eu(t){Object.keys(jC.EventEmitter.prototype).forEach(function(ab){"function"==typeof jC.EventEmitter.prototype[ab]&&(t[ab]=iX[ab].bind(iX))});var aa=t._destructionListeners=new h5.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function fh(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function i3(ac){if(!/^\d+\-./.test(ac)){return ii(i4)}var aa=ac.indexOf("-"),ab=ac.substring(0,aa),t=ac.substring(aa+1);return{prefix:parseInt(ab,10),id:t}}function h0(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function jl(ak,ah){var ac,af,ad,aa={status:"available"};if(ak._deleted&&(aa.deleted=!0),ah){if(ak._id||(ak._id=eo()),af=eo(32,16).toLowerCase(),ak._rev){if(ad=i3(ak._rev),ad.error){return ad}ak._rev_tree=[{pos:ad.prefix,ids:[ad.id,{status:"missing"},[[af,aa,[]]]]}],ac=ad.prefix+1}else{ak._rev_tree=[{pos:1,ids:[af,aa,[]]}],ac=1}}else{if(ak._revisions&&(ak._rev_tree=h0(ak._revisions,aa),ac=ak._revisions.start,af=ak._revisions.ids[0]),!ak._rev_tree){if(ad=i3(ak._rev),ad.error){return ad}ac=ad.prefix,af=ad.id,ak._rev_tree=[{pos:ac,ids:[af,aa,[]]}]}}hs(ak._id),ak._rev=ac+"-"+af;var aj={metadata:{},data:{}};for(var ag in ak){if(Object.prototype.hasOwnProperty.call(ak,ag)){var t="_"===ag[0];if(t&&!gT[ag]){var ab=ii(ei,ag);throw ab.message=ei.message+": "+ag,ab}t&&!hY[ag]?aj.metadata[ag.slice(1)]=ak[ag]:aj.data[ag]=ak[ag]}}return aj}function Y(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function iJ(t){return h3(Y(t))}function a8(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function y(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function a7(t,aa){return a8([y(t)],{type:aa})}function gM(t,aa){return a7(D(t),aa)}function S(ac,aa){if("undefined"==typeof FileReader){return aa(Y((new FileReaderSync).readAsArrayBuffer(ac)))}var ab=new FileReader,t="function"==typeof ab.readAsBinaryString;ab.onloadend=function(af){var ad=af.target.result||"";return t?aa(ad):void aa(Y(ad))},t?ab.readAsBinaryString(ac):ab.readAsArrayBuffer(ac)}function jA(t,aa){S(t,function(ab){aa(h3(ab))})}function ci(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function H(t){return h3(t)}function O(ac,aa,ab,t){(ab>0||t<aa.byteLength)&&(aa=new Uint8Array(aa,ab,Math.min(t,aa.byteLength)-ab)),ac.append(aa)}function a9(ac,aa,ab,t){(ab>0||t<aa.length)&&(aa=aa.substring(ab,t)),ac.appendBinary(aa)}function dt(ak,ah){function ac(){var aq=ag*aa,al=aq+aa;if(ag++,aj>ag){ab(t,ak,aq,al),hM(ac)}else{ab(t,ak,aq,al);var ap=t.end(!0),am=H(ap);ah(am),t.destroy()}}var af="string"==typeof ak,ad=af?ak.length:ak.byteLength,aa=Math.min(iU,ad),aj=Math.ceil(ad/aa),ag=0,t=af?new i5:new i5.ArrayBuffer,ab=af?a9:O;ac()}function ih(t){return i5.hash(t)}function I(aa,ah,ad){function ag(al){try{return D(al)}catch(aj){var ak=ii(gx,"Attachment is not a valid base64 string");return{error:ak}}}function af(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ag(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ah?aj.data=a7(al,aj.content_type):"base64"===ah?aj.data=h3(al):aj.data=al,dt(al,function(am){aj.digest="md5-"+am,ak()})}else{ci(aj.data,function(am){"binary"===ah?aj.data=Y(am):"base64"===ah&&(aj.data=iJ(am)),dt(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function t(){ac++,aa.length===ac&&(ab?ad(ab):ad())}if(!aa.length){return ad()}var ab,ac=0;aa.forEach(function(ak){function am(aq){ab=aq,al++,al===aj.length&&t()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return t()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&af(ak.data._attachments[ap],am)}})}function i2(ac,ab,av,aj,aw,am,ad,ag){if(hB(ab.rev_tree,av.metadata.rev)){return aj[aw]=av,am()}var ax=ab.winningRev||gs(ab),au="deleted" in ab?ab.deleted:g0(ab,ax),al="deleted" in av.metadata?av.metadata.deleted:g0(av.metadata),aq=/^1-/.test(av.metadata.rev);if(au&&!al&&ag&&aq){var t=av.data;t._rev=ax,t._id=av.metadata.id,av=jl(t,ag)}var ak=jE(ab.rev_tree,av.metadata.rev_tree[0],ac),ay=ag&&(au&&al||!au&&"new_leaf"!==ak.conflicts||au&&!al&&"new_branch"===ak.conflicts);if(ay){var az=ii(g1);return aj[aw]=az,am()}var aA=av.metadata.rev;av.metadata.rev_tree=ak.tree,av.stemmedRevs=ak.stemmedRevs||[],ab.rev_map&&(av.metadata.rev_map=ab.rev_map);var ah,aa=gs(av.metadata),ap=g0(av.metadata,aa),af=au===ap?0:ap>au?-1:1;ah=aA===aa?ap:g0(av.metadata,aA),ad(av,aa,ap,ah,!0,af,aw,am)}function bn(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jq(ac,aa,ak,af,aq,ah,ab,am,aj){function ag(aC,aw,aA){var az=gs(aC.metadata),ax=g0(aC.metadata,az);if("was_delete" in am&&ax){return ah[aw]=ii(ew,"deleted"),aA()}var ay=t&&bn(aC);if(ay){var av=ii(g1);return ah[aw]=av,aA()}var aB=ax?0:1;ab(aC,az,ax,ax,!1,aB,aw,aA)}function al(){++ad===au&&aj&&aj()}ac=ac||1000;var t=am.new_edits,ap=new h5.Map,ad=0,au=aa.length;aa.forEach(function(ay,aw){if(ay._id&&g6(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void ak[av](ay,{ctx:aq},function(aA,az){ah[aw]=aA||az,al()})}var ax=ay.metadata.id;ap.has(ax)?(au--,ap.get(ax).push([ay,aw])):ap.set(ax,[[ay,aw]])}),ap.forEach(function(aw,ay){function az(){++ax<aw.length?av():al()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(af.has(ay)){i2(ac,af.get(ay),aA,ah,aB,az,ab,t)}else{var aD=jE([],aA.metadata.rev_tree[0],ac);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ag(aA,aB,az)}}var ax=0;av()})}function hk(t){try{return JSON.parse(t)}catch(aa){return hw.parse(t)}}function z(t){return t.length<50000?JSON.parse(t):hk(t)}function hH(t){try{return JSON.stringify(t)}catch(aa){return hw.stringify(t)}}function Z(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function ja(t){if(!hV.running&&hV.queue.length){hV.running=!0;var aa=hV.queue.shift();aa.action(function(ac,ab){Z(aa.callback,this,[ac,ab],t),hV.running=!1,g9.nextTick(function(){ja(t)})})}}function fW(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(ii(fn,aa,ab.type))}}function jD(t,aa,ab){return{data:hH(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function hN(t){if(!t){return null}var aa=z(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function gI(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function hE(ac,aa,ab,t){ab?t(ac?"string"!=typeof ac?ac:gM(ac,aa):a8([""],{type:aa})):ac?"string"!=typeof ac?S(ac,function(ad){t(h3(ad))}):t(ac):t("")}function jn(aa,ah,ad,ag){function af(){++ac===ab.length&&ag&&ag()}function t(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ad.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,af()}}var ab=Object.keys(aa._attachments||{});if(!ab.length){return ag&&ag()}var ac=0;ab.forEach(function(aj){ah.attachments&&ah.include_docs?t(aa,aj):(aa._attachments[aj].stub=!0,af())})}function hz(t,aa){return he.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return he.all(ab.map(function(af){var ah=ac.doc._attachments[af];if("body" in ah){var ag=ah.body,ad=ah.content_type;return new he(function(aj){hE(ag,ad,aa,function(ak){ac.doc._attachments[af]=gc.extend(gC(ah,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function ib(ak,ah,ac){function af(){ab--,ab||ad()}function ad(){aa.length&&aa.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ag["delete"](am)}})}var aa=[],aj=ac.objectStore(gv),ag=ac.objectStore(gr),t=ac.objectStore(a6),ab=ak.length;ak.forEach(function(al){var am=aj.index("_doc_id_rev"),ap=ah+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return af()}aj["delete"](au);var av=t.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];aa.push(ax),t["delete"](aw.primaryKey),aw["continue"]()}else{af()}}}})}function ix(ac,aa,ab){try{return{txn:ac.transaction(aa,ab)}}catch(t){return{error:t}}}function hL(ap,aI,az,aG,aj,aJ,am){function ax(){var aN=[h8,gv,gr,hP,a6],aO=ix(aj,aN,"readwrite");return aO.error?am(aO.error):(al=aO.txn,al.onabort=fW(am),al.ontimeout=fW(am),al.oncomplete=av,ag=al.objectStore(h8),ah=al.objectStore(gv),aB=al.objectStore(gr),t=al.objectStore(a6),void aM(function(aP){return aP?(ab=!0,am(aP)):void aL()}))}function ay(){jq(ap.revs_limit,aE,aG,ac,al,ak,aH,az)}function aL(){function aN(){++aS===aE.length&&ay()}function aP(aU){var aV=hN(aU.target.result);aV&&ac.set(aV.id,aV),aN()}if(aE.length){for(var aS=0,aO=0,aT=aE.length;aT>aO;aO++){var aQ=aE[aO];if(aQ._id&&g6(aQ._id)){aN()}else{var aR=ag.get(aQ.metadata.id);aR.onsuccess=aP}}}}function av(){ab||(aJ.notify(aG._meta.name),aG._meta.docCount+=aA,am(null,ak))}function aD(aO,aP){var aN=aB.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=ii(iV,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aE.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aD(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aH(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aF(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(aZ){var bb=aP.stemmedRevs||[];aV&&aG.auto_compaction&&(bb=bb.concat(jo(aP.metadata))),bb&&bb.length&&ib(bb,aP.metadata.id,al),aT.seq=aZ.target.result,delete aT.rev;var bc=jD(aT,aW,aU),ba=ag.put(bc);ba.onsuccess=aN}function aX(ba){ba.preventDefault(),ba.stopPropagation();var bb=ah.index("_doc_id_rev"),aZ=bb.getKey(aR._doc_id_rev);aZ.onsuccess=function(bc){var bd=ah.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ak[aS]={ok:!0,id:aT.id,rev:aW},ac.set(aP.metadata.id,aP.metadata),au(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ah.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aF(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aY){var bb=aP.data._attachments[aY];if(bb.stub){aO++,aN()}else{var aZ=bb.data;delete bb.data,bb.revpos=parseInt(aW,10);var ba=bb.digest;aC(ba,aZ,aV)}})}function au(aR,aU,aP){function aS(){++aN===aO.length&&aP()}function aQ(aW){var aX=aR.data._attachments[aW].digest,aV=t.put({seq:aU,digestSeq:aX+"::"+aU});aV.onsuccess=aS,aV.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aS()}}var aN=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function aC(aO,aQ,aN){var aP=aB.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=aB.put(aS);aT.onsuccess=aN}}for(var al,ag,ah,aB,t,aa,aE=aI.docs,aA=0,aw=0,af=aE.length;af>aw;aw++){var aq=aE[aw];aq._id&&g6(aq._id)||(aq=aE[aw]=jl(aq,az.new_edits),aq.error&&!aa&&(aa=aq))}if(aa){return am(aa)}var ak=new Array(aE.length),ac=new h5.Map,ab=!1,aK=aG._meta.blobSupport?"blob":"base64";I(aE,aK,function(aN){return aN?am(aN):void ax()})}function js(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function hq(ac,aa,ab,t){return"DataError"===ab.name&&0===ab.code?t(null,{total_rows:ac._meta.docCount,offset:aa.skip,rows:[]}):void t(ii(fn,ab.name,ab.message))}function jk(ac,t,aa,ad){function ab(aq,aD){function ay(aM,aN,aL){var aK=aM.id+"::"+aL;az.get(aK).onsuccess=function(aO){aN.doc=gI(aO.target.result),aq.conflicts&&(aN.doc._conflicts=gz(aM)),jn(aN.doc,aq,al)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===aq.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):aq.include_docs&&ay(aK,aM,aO)}else{if(!aN&&am--<=0&&(aJ.push(aM),aq.include_docs&&ay(aK,aM,aO),0===--aw)){return}}aL["continue"]()}function ah(aL){ag=t._meta.docCount;var aN=aL.target.result;if(aN){var aM=hN(aN.value),aK=aM.winningRev;av(aN,aK,aM)}}function aE(){aD(null,{total_rows:ag,offset:aq.skip,rows:aJ})}function aB(){aq.attachments?hz(aJ,aq.binary).then(aE):aE()}var aH="startkey" in aq?aq.startkey:!1,aC="endkey" in aq?aq.endkey:!1,aA="key" in aq?aq.key:!1,am=aq.skip||0,aw="number"==typeof aq.limit?aq.limit:-1,ax=aq.inclusive_end!==!1,ak="descending" in aq&&aq.descending?"prev":null,aG=js(aH,aC,ax,aA,ak);if(aG&&aG.error){return hq(t,aq,aG.error,aD)}var au=[h8,gv];aq.attachments&&au.push(gr);var aj=ix(aa,au,"readonly");if(aj.error){return aD(aj.error)}var al=aj.txn,aI=al.objectStore(h8),ap=al.objectStore(gv),aF=ak?aI.openCursor(aG,ak):aI.openCursor(aG),az=ap.index("_doc_id_rev"),aJ=[],ag=0;al.oncomplete=aB,aF.onsuccess=ah}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:t._meta.docCount,offset:ag.skip,rows:[]}):void ab(ag,ah)}af(ac,ad)}function hv(t){return new he(function(ab){var aa=a8([""]);t.objectStore(iH).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function gy(t,aa){var ab=this;hV.queue.push({action:function(ac){hf(ab,t,ac)},callback:aa}),ja(ab.constructor)}function hf(ad,ac,ap){function al(au){var av=au.createObjectStore(h8,{keyPath:"id"});au.createObjectStore(gv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gr,{keyPath:"digest"}),au.createObjectStore(i9,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(iH),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(hP,{keyPath:"_id"});var aw=au.createObjectStore(a6,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(au,av){var aw=au.objectStore(h8);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=g0(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function aq(au){au.createObjectStore(hP,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function af(ax,av){var aw=ax.objectStore(hP),az=ax.objectStore(h8),ay=ax.objectStore(gv),au=az.openCursor();au.onsuccess=function(aK){var aB=aK.target.result;if(aB){var aH=aB.value,aE=aH.id,aF=g6(aE),aI=gs(aH);if(aF){var aL=aE+"::"+aI,aC=aE+"::",aJ=aE+"::~",aA=ay.index("_doc_id_rev"),aD=IDBKeyRange.bound(aC,aJ,!1,!1),aG=aA.openCursor(aD);aG.onsuccess=function(aN){if(aG=aN.target.result){var aM=aG.value;aM._doc_id_rev===aL&&aw.put(aM),ay["delete"](aG.primaryKey),aG["continue"]()}else{az["delete"](aB.primaryKey),aB["continue"]()}}}else{aB["continue"]()}}else{av&&av()}}}function aj(au){var av=au.createObjectStore(a6,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ah(ax,av){var aw=ax.objectStore(gv),az=ax.objectStore(gr),ay=ax.objectStore(a6),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aI){var aC=aI.target.result;if(!aC){return av()}for(var aD=aC.value,aK=aC.primaryKey,aG=Object.keys(aD._attachments||{}),aE={},aF=0;aF<aG.length;aF++){var aH=aD._attachments[aG[aF]];aE[aH.digest]=!0}var aJ=Object.keys(aE);for(aF=0;aF<aJ.length;aF++){var aL=aJ[aF];ay.put({seq:aK,digestSeq:aL+"::"+aK})}aC["continue"]()}):av()}}function ab(av){function au(az){return az.data?hN(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(gv),ax=av.objectStore(h8),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=jD(aD,aD.winningRev,aD.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=au(aA.value);return aD.winningRev=aD.winningRev||gs(aD),aD.seq?az():void aB()}}}var am=ac.name,aa=null;ad._meta=null,ad.type=function(){return"idb"},ad._id=ee(function(au){au(null,ad._meta.instanceId)}),ad._bulkDocs=function(aw,av,au){hL(ac,aw,av,ad,aa,iR,au)},ad._get=function(aB,ax,ay){function au(){ay(aA,{doc:aC,metadata:av,ctx:aw})}var aC,av,aA,aw=ax.ctx;if(!aw){var az=ix(aa,[h8,gv,gr],"readonly");if(az.error){return ay(az.error)}aw=az.txn}aw.objectStore(h8).get(aB).onsuccess=function(aG){if(av=hN(aG.target.result),!av){return aA=ii(ew,"missing"),au()}if(g0(av)&&!ax.rev){return aA=ii(ew,"deleted"),au()}var aE=aw.objectStore(gv),aD=ax.rev||av.winningRev,aF=av.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aC=aH.target.result,aC&&(aC=gI(aC)),aC?void au():(aA=ii(ew,"missing"),au())}}},ad._getAttachment=function(aB,ax,ay,au,aC){var av;if(au.ctx){av=au.ctx}else{var aA=ix(aa,[h8,gv,gr],"readonly");if(aA.error){return aC(aA.error)}av=aA.txn}var aw=ay.digest,az=ay.content_type;av.objectStore(gr).get(aw).onsuccess=function(aE){var aD=aE.target.result.body;hE(aD,az,au.binary,function(aF){aC(null,aF)})}},ad._info=function(av){if(null===aa||!hD.has(am)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var au,ay,ax=ix(aa,[gv],"readonly");if(ax.error){return av(ax.error)}var aw=ax.txn,az=aw.objectStore(gv).openCursor(null,"prev");az.onsuccess=function(aB){var aC=aB.target.result;au=aC?aC.key:0,ay=ad._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:au,idb_attachment_format:ad._meta.blobSupport?"binary":"base64"})}},ad._allDocs=function(av,au){jk(av,ad,aa,au)},ad._changes=function(av){function aJ(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aF=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aH.get(aU);aT.onsuccess=function(aV){aO(gI(aV.target.result))}}function aO(aU){var aT=av.processChange(aU,aN,av);aT.seq=aN.seq;var aV=aL(aT);return"object"==typeof aV?av.complete(aV):(aV&&(aK++,aD&&aI.push(aT),av.attachments&&av.include_docs?jn(aU,av,az,function(){hz([aT],av.binary).then(function(){av.onChange(aT)})}):av.onChange(aT)),void (aK!==ax&&aS["continue"]()))}var aQ=gI(aS.value),aR=aS.key;if(aB&&!aB.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aE.get(aQ._id).onsuccess=function(aT){aN=hN(aT.target.result),ay.set(aQ._id,aN),aM()})}function aA(aN){var aM=aN.target.result;aM&&aJ(aM)}function au(){var aM=[h8,gv];av.attachments&&aM.push(gr);var aN=ix(aa,aM,"readonly");if(aN.error){return av.complete(aN.error)}az=aN.txn,az.onabort=fW(av.complete),az.oncomplete=aC,aG=az.objectStore(gv),aE=az.objectStore(h8),aH=aG.index("_doc_id_rev");var aO;aO=av.descending?aG.openCursor(null,"prev"):aG.openCursor(IDBKeyRange.lowerBound(av.since,!0)),aO.onsuccess=aA}function aC(){function aM(){av.complete(null,{results:aI,last_seq:aF})}!av.continuous&&av.attachments?hz(aI).then(aM):aM()}if(av=fp(av),av.continuous){var aw=am+":"+eo();return iR.addListener(am,aw,ad,av),iR.notify(am),{cancel:function(){iR.removeListener(am,aw)}}}var aB=av.doc_ids&&new h5.Set(av.doc_ids);av.since=av.since||0;var aF=av.since,ax="limit" in av?av.limit:-1;0===ax&&(ax=1);var aD;aD="return_docs" in av?av.return_docs:"returnDocs" in av?av.returnDocs:!0;var az,aG,aE,aH,aI=[],aK=0,aL=hA(av),ay=new h5.Map;au()},ad._close=function(au){return null===aa?au(ii(hi)):(aa.close(),hD["delete"](am),aa=null,void au())},ad._getRevisionTree=function(av,au){var aw=ix(aa,[h8],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(h8).get(av);ay.onsuccess=function(aA){var az=hN(aA.target.result);az?au(null,az.rev_tree):au(ii(ew))}},ad._doCompaction=function(aA,av,ay){var az=[h8,gv,gr,a6],au=ix(aa,az,"readwrite");if(au.error){return ay(au.error)}var ax=au.txn,aw=ax.objectStore(h8);aw.get(aA).onsuccess=function(aC){var aE=hN(aC.target.result);fd(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),ib(av,aA,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(h8).put(jD(aE,aD,aB))},ax.onabort=fW(ay),ax.oncomplete=function(){ay()}},ad._getLocal=function(av,au){var aw=ix(aa,[hP],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(hP).get(av);ay.onerror=fW(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(ii(ew))}},ad._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=ix(aa,[hP],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=fW(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(hP);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(ii(g1))}}):(az=aC.add(aD),az.onerror=function(aE){aA(ii(g1)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ad._removeLocal=function(aB,ax,ay){"function"==typeof ax&&(ay=ax,ax={});var au=ax.ctx;if(!au){var aC=ix(aa,[hP],"readwrite");if(aC.error){return ay(aC.error)}au=aC.txn,au.oncomplete=function(){av&&ay(null,av)}}var av,aA=aB._id,aw=au.objectStore(hP),az=aw.get(aA);az.onerror=fW(ay),az.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aB._rev?(aw["delete"](aA),av={ok:!0,id:aA,rev:"0-0"},ax.ctx&&ay(null,av)):ay(ii(ew))}},ad._destroy=function(av,ax){iR.removeAllListeners(am);var au=ff.get(am);au&&au.result&&(au.result.close(),hD["delete"](am));var aw=indexedDB.deleteDatabase(am);aw.onsuccess=function(){ff["delete"](am),ga()&&am in localStorage&&delete localStorage[am],ax(null,{ok:!0})},aw.onerror=fW(ax)};var ag=hD.get(am);if(ag){return aa=ag.idb,ad._meta=ag.global,void g9.nextTick(function(){ap(null,ad)})}var t;t=ac.storage?jy(am,ac.storage):indexedDB.open(am,g2),ff.set(am,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return al(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&aq(az),av.oldVersion<4&&aj(az);var ay=[ak,af,ah,ab],au=av.oldVersion;ax()},t.onsuccess=function(az){aa=az.target.result,aa.onversionchange=function(){aa.close(),hD["delete"](am)},aa.onabort=function(aA){iu("error","Database has a global failure",aA.target.error),aa.close(),hD["delete"](am)};var aw=aa.transaction([i9,iH,h8],"readwrite"),ay=aw.objectStore(i9).get(i9),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(ad._meta={name:am,instanceId:au,blobSupport:av,docCount:ax},hD.set(am,{idb:aa,global:ad._meta}),ap(null,ad))},aA=aB.target.result||{id:i9};am+"_id" in aA?(au=aA[am+"_id"],aD()):(au=eo(),aA[am+"_id"]=au,aw.objectStore(i9).put(aA).onsuccess=function(){aD()}),ht||(ht=hv(aw)),ht.then(function(aE){av=aE,aD()});var aC=aw.objectStore(h8).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iu("error",au),ap(ii(fn,au))}}function jy(t,aa){try{return indexedDB.open(t,{version:g2,storage:aa})}catch(ab){return indexedDB.open(t,g2)}}function ji(t){t.adapter("idb",gy,!0)}function jh(t){return decodeURIComponent(escape(t))}function ig(t){return 65>t?t-48:t-55}function iI(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(ig(ac.charCodeAt(aa++))<<4|ig(ac.charCodeAt(aa++)))}return t}function hX(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(ig(ac.charCodeAt(aa+2))<<12|ig(ac.charCodeAt(aa+3))<<8|ig(ac.charCodeAt(aa))<<4|ig(ac.charCodeAt(aa+1))),aa+=4}return t}function hT(t,aa){return"UTF-8"===aa?jh(iI(t,0,t.length)):hX(t,0,t.length)}function gn(t){return"'"+t+"'"}function jf(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hW(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jx(t){return delete t._id,delete t._rev,JSON.stringify(t)}function jc(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function ft(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function gj(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function jv(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+gq+" WHERE seq IN "+ft(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+gq+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+gq+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new h5.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+gq+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+iw+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(ah){var aj="SELECT seq FROM "+B+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ad,ah],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+B+" WHERE seq=?",[ak],ac)})})}}function h6(t){return function(ad){iu("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(ii(iB,ab,ac))}}function it(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function id(aA,ag,aB,av,au,ak,al){function ax(){return ac?al(ac):(ak.notify(av._name),av._docCount=-1,void al(null,ah))}function ay(aD,aE){var aC="SELECT count(*) as cnt FROM "+iw+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=ii(iV,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ab(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ay(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function t(aN,aF,aK,aP,aC,aI,aD,aG){function aL(){function aR(bc,ba){function bb(){return ++bf===bg.length&&ba(),!1}function aZ(bh){var bj="INSERT INTO "+gq+" (digest, seq) VALUES (?,?)",bi=[aS._attachments[bh].digest,bc];ap.executeSql(bj,bi,bb,bb)}var bf=0,bg=Object.keys(aS._attachments||{});if(!bg.length){return ba()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aS=aN.data,aX=aP?1:0,aU=aS._id,aY=aS._rev,aW=jx(aS),aV="INSERT INTO "+B+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aT=[aU,aY,aW,aX];ap.executeSql(aV,aT,function(aZ,ba){var bb=ba.insertId;aR(bb,function(){aM(aZ,bb)})},function(){var aZ=gj("seq",B,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aU,aY],function(bd,bc){var bb=bc.rows.item(0).seq,bf="UPDATE "+B+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aW,aX,aU,aY];bd.executeSql(bf,ba,function(bg){aR(bb,function(){aM(bg,bb)})})}),!1})}function aO(aR){aQ||(aR?(aQ=aR,aG(aQ)):aH===aJ.length&&aL())}function aE(aR){aH++,aO(aR)}function aM(aV,aW){var aT=aN.metadata.id,aU=aN.stemmedRevs||[];aC&&av.auto_compaction&&(aU=jo(aN.metadata).concat(aU)),aU.length&&jv(aU,aT,aV),aN.metadata.seq=aW,delete aN.metadata.rev;var aS=aC?"UPDATE "+hJ+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+B+" WHERE doc_id="+hJ+".id AND rev=?) WHERE id=?":"INSERT INTO "+hJ+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aR=hH(aN.metadata),aX=aC?[aR,aW,aF,aT]:[aT,aW,aW,aR];aV.executeSql(aS,aX,function(){ah[aD]={ok:!0,id:aN.metadata.id,rev:aF},am.set(aT,aN.metadata),aG()})}var aQ=null,aH=0;aN.data._id=aN.metadata.id,aN.data._rev=aN.metadata.rev;var aJ=Object.keys(aN.data._attachments||{});aP&&(aN.data._deleted=!0),aJ.forEach(function(aS){var aU=aN.data._attachments[aS];if(aU.stub){aH++,aO()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aF,10);var aR=aU.digest;af(aR,aT,aE)}}),aJ.length||aL()}function aw(){jq(aA.revs_limit,aq,av,am,ap,ah,t,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&g6(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hJ+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=z(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function af(aD,aF,aC){var aE="SELECT digest FROM "+iw+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iw+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jf(aF)],function(){aC()},function(){return aC(),!1}))})}var aj=aB.new_edits,ad=ag.docs,aq=ad.map(function(aC){if(aC._id&&g6(aC._id)){return aC}var aD=jl(aC,aj);return aD}),aa=aq.filter(function(aC){return aC.error});if(aa.length){return al(aa[0])}var ap,ac,ah=new Array(aq.length),am=new h5.Map;I(aq,"binary",function(aC){return aC?al(aC):void au.transaction(function(aD){ap=aD,ab(function(aE){aE?ac=aE:az(aw)})},h6(al),ax)})}function gQ(t){return t.websql(t.name,t.version,t.description,t.size)}function f(t){try{return{db:gQ(t)}}catch(aa){return{error:aa}}}function hQ(t){var aa=T.get(t.name);return aa||(aa=f(t),T.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function gS(ac,aj,af,ah,ad){function ab(){++t===ag.length&&ad&&ad()}function aa(am,ak){var al=am._attachments[ak],ap={binary:aj.binary,ctx:ah};af._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=gc.extend(gC(al,["digest","content_type"]),{data:aq}),ab()})}var ag=Object.keys(ac._attachments||{});if(!ag.length){return ad&&ad()}var t=0;ag.forEach(function(ak){aj.attachments&&aj.include_docs?aa(ac,ak):(ac._attachments[ak].stub=!0,ab())})}function im(ap,av){function ag(){ga()&&(window.localStorage["_pouch__websqldb_"+am._name]=!0),av(null,am)}function au(aD,aE){aD.executeSql(o),aD.executeSql("ALTER TABLE "+B+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(gH),aD.executeSql("ALTER TABLE "+hJ+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hJ+" (local, id)");var aF="SELECT "+hJ+".winningseq AS seq, "+hJ+".json AS metadata FROM "+B+" JOIN "+hJ+" ON "+B+".seq = "+hJ+".winningseq";aD.executeSql(aF,[],function(aL,aH){for(var aM=[],aJ=[],aI=0;aI<aH.rows.length;aI++){var aG=aH.rows.item(aI),aN=aG.seq,aK=JSON.parse(aG.metadata);g0(aK)&&aM.push(aN),g6(aK.id)&&aJ.push(aK.id)}aL.executeSql("UPDATE "+hJ+"SET local = 1 WHERE id IN "+ft(aJ.length),aJ,function(){aL.executeSql("UPDATE "+B+" SET deleted = 1 WHERE seq IN "+ft(aM.length),aM,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+J+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hJ+".id AS id, "+B+".json AS data FROM "+B+" JOIN "+hJ+" ON "+B+".seq = "+hJ+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+J+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hJ+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+B+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function az(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aL=aH.shift(),aN=hT(aL.hex,aw),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aO=aN.substring(aK+2),aJ="UPDATE "+B+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aM,aO,aN],function(){aI()})}aI()}var aF="ALTER TABLE "+B+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+B+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(iL,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+B;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ah(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+iw;aI.executeSql(aH,[],function(aM,aK){function aN(){var aP=gj(hh+", "+hJ+".id AS id",[hJ,B],ic,null,hJ+".id ");aP+=" LIMIT "+aJ+" OFFSET "+aO,aO+=aJ,aM.executeSql(aP,[],function(ba,aY){function aU(bc,bd){var bf=aW[bc]=aW[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aY.rows.length){return aG(ba)}for(var aW={},aS=0;aS<aY.rows.length;aS++){for(var aZ=aY.rows.item(aS),aQ=jc(aZ.data,aZ.id,aZ.rev),aV=Object.keys(aQ._attachments||{}),aT=0;aT<aV.length;aT++){var aX=aQ._attachments[aV[aT]];aU(aX.digest,aZ.seq)}}var bb=[];if(Object.keys(aW).forEach(function(bc){var bd=aW[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aN()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+gq+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aG(aM)}var aO=0,aJ=10;aN()})}var aF="CREATE TABLE IF NOT EXISTS "+gq+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(i0,[],function(aI){aI.executeSql(h9,[],aD)})})}function ac(aE,aF){var aD="ALTER TABLE "+iw+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ad(aE,aF){var aD="ALTER TABLE "+hJ+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hJ+" SET max_seq=(SELECT MAX(seq) FROM "+B+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hJ+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aa(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;aw=2===aG.length?"UTF-8":"UTF-16",aE()})}function aj(){for(;af.length>0;){var aD=af.pop();aD(null,aC)}}function ab(aE,aI){if(0===aI){var aL="CREATE TABLE IF NOT EXISTS "+a2+" (dbid, db_version INTEGER)",aO="CREATE TABLE IF NOT EXISTS "+iw+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aF="CREATE TABLE IF NOT EXISTS "+gq+" (digest, seq INTEGER)",aH="CREATE TABLE IF NOT EXISTS "+hJ+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aG="CREATE TABLE IF NOT EXISTS "+B+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aM="CREATE TABLE IF NOT EXISTS "+J+" (id UNIQUE, rev, json)";aE.executeSql(aO),aE.executeSql(aM),aE.executeSql(aF,[],function(){aE.executeSql(h9),aE.executeSql(i0)}),aE.executeSql(aH,[],function(){aE.executeSql(o),aE.executeSql(aG,[],function(){aE.executeSql(gH),aE.executeSql(iL),aE.executeSql(aL,[],function(){var aP="INSERT INTO "+a2+" (db_version, dbid) VALUES (?,?)";aC=eo();var aQ=[ie,aC];aE.executeSql(aP,aQ,function(){aj()})})})})}else{var aK=function(){var aQ=ie>aI;aQ&&aE.executeSql("UPDATE "+a2+" SET db_version = "+ie);var aP="SELECT dbid FROM "+a2;aE.executeSql(aP,[],function(aR,aS){aC=aS.rows.item(0).dbid,aj()})},aN=[au,aq,az,ah,ac,ad,aK],aD=aI,aJ=function(aP){aN[aD-1](aP,aJ),aD++};aJ(aE)}}function aB(){ax.transaction(function(aD){aa(aD,function(){ak(aD)})},h6(av),ag)}function ak(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+a2;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+a2,[],function(aH,aI){var aJ=aI.rows.item(0).db_version;ab(aH,aJ)}):aF.executeSql("ALTER TABLE "+a2+" ADD COLUMN db_version INTEGER",[],function(){ab(aF,1)}):ab(aF,0)})}function ay(aE,aF){if(-1!==am._docCount){return aF(am._docCount)}var aD=gj("COUNT("+hJ+".id) AS 'num'",[hJ,B],ic,B+".deleted=0");aE.executeSql(aD,[],function(aG,aH){am._docCount=aH.rows.item(0).num,aF(am._docCount)})}var aw,am=this,aC=null,al=it(ap),af=[];am._docCount=-1,am._name=ap.name;var t=gc.extend({},ap,{version:fl,description:ap.name,size:al}),aA=hQ(t);if(aA.error){return h6(av)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),aB(),am.type=function(){return"websql"},am._id=ee(function(aD){aD(null,aC)}),am._info=function(aD){ax.readTransaction(function(aE){ay(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+B;aE.executeSql(aG,[],function(aI,aH){var aJ=aH.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aJ,sqlite_plugin:ax._sqlitePlugin,websql_encoding:aw})})})},h6(aD))},am._bulkDocs=function(aF,aD,aE){id(ap,aF,aD,am,ax,hm,aE)},am._get=function(aF,aE,aH){function aK(){aH(aM,{doc:aJ,metadata:aG,ctx:aI})}var aJ,aG,aM,aI=aE.ctx;if(!aI){return ax.readTransaction(function(aN){am._get(aF,gc.extend({ctx:aN},aE),aH)})}var aL,aD;aE.rev?(aL=gj(hh,[hJ,B],hJ+".id="+B+".doc_id",[B+".doc_id=?",B+".rev=?"]),aD=[aF,aE.rev]):(aL=gj(hh,[hJ,B],ic,hJ+".id=?"),aD=[aF]),aI.executeSql(aL,aD,function(aP,aO){if(!aO.rows.length){return aM=ii(ew,"missing"),aK()}var aN=aO.rows.item(0);return aG=z(aN.metadata),aN.deleted&&!aE.rev?(aM=ii(ew,"deleted"),aK()):(aJ=jc(aN.data,aG.id,aN.rev),void aK())})},am._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(hJ+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(hJ+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(hJ+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(hJ+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(B+".deleted = 0"),ax.readTransaction(function(aR){ay(aR,function(aS){if(aF=aS,0!==aH){var aT=gj(hh,[hJ,B],ic,aL,hJ+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aZ,aW){for(var aX=0,bc=aW.rows.length;bc>aX;aX++){var ba=aW.rows.item(aX),aY=z(ba.metadata),aU=aY.id,bb=jc(ba.data,aU,ba.rev),aV=bb._rev,bd={id:aU,key:aU,value:{rev:aV}};if(aQ.include_docs&&(bd.doc=bb,bd.doc._rev=aV,aQ.conflicts&&(bd.doc._conflicts=gz(aY)),gS(bd.doc,aQ,am,aZ)),ba.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},h6(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},am._changes=function(aE){function aD(){var aN=hJ+".json AS metadata, "+hJ+".max_seq AS maxSeq, "+B+".json AS winningDoc, "+B+".rev AS winningRev ",aM=hJ+" JOIN "+B,aO=hJ+".id="+B+".doc_id AND "+hJ+".winningseq="+B+".seq",aP=["maxSeq > ?"],aR=[aE.since];aE.doc_ids&&(aP.push(hJ+".id IN "+ft(aE.doc_ids.length)),aR=aR.concat(aE.doc_ids));var aL="maxSeq "+(aH?"DESC":"ASC"),aS=gj(aN,aM,aO,aP,aL),aT=hA(aE);aE.view||aE.filter||(aS+=" LIMIT "+aK);var aQ=aE.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(aW,aV){function aX(bg){return function(){aE.onChange(bg)}}for(var bb=0,bc=aV.rows.length;bc>bb;bb++){var bd=aV.rows.item(bb),aZ=z(bd.metadata);aQ=bd.maxSeq;var bf=jc(bd.winningDoc,aZ.id,bd.winningRev),aY=aE.processChange(bf,aZ,aE);aY.seq=bd.maxSeq;var ba=aT(aY);if("object"==typeof ba){return aE.complete(ba)}if(ba&&(aI++,aF&&aG.push(aY),aE.attachments&&aE.include_docs?gS(bf,aE,am,aW,aX(aY)):aX(aY)()),aI===aK){break}}})},h6(aE.complete),function(){aE.continuous||aE.complete(null,{results:aG,last_seq:aQ})})}if(aE=fp(aE),aE.continuous){var aJ=am._name+":"+eo();return hm.addListener(am._name,aJ,am,aE),hm.notify(am._name),{cancel:function(){hm.removeListener(am._name,aJ)}}}var aH=aE.descending;aE.since=aE.since&&!aH?aE.since:0;var aK="limit" in aE?aE.limit:-1;0===aK&&(aK=1);var aF;aF="return_docs" in aE?aE.return_docs:"returnDocs" in aE?aE.returnDocs:!0;var aG=[],aI=0;aD()},am._close=function(aD){aD()},am._getAttachment=function(aF,aE,aH,aK,aJ){var aG,aM=aK.ctx,aI=aH.digest,aL=aH.content_type,aD="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iw+" WHERE digest=?";aM.executeSql(aD,[aI],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hW(aO.body):hT(aO.body,aw);aG=aK.binary?a7(aN,aL):h3(aN),aJ(null,aG)})},am._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hJ+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=z(aJ.rows.item(0).metadata);aE(null,aI.rev_tree)}else{aE(ii(ew))}})})},am._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hJ+" WHERE id = ?";aH.executeSql(aG,[aE],function(aK,aI){var aL=z(aI.rows.item(0).metadata);fd(aL.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aJ="UPDATE "+hJ+" SET json = ? WHERE id = ?";aK.executeSql(aJ,[hH(aL),aE])}),jv(aF,aE,aH)},h6(aD),function(){aD()}):aD()},am._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+J+" WHERE id=?";aF.executeSql(aG,[aD],function(aJ,aH){if(aH.rows.length){var aK=aH.rows.item(0),aI=jc(aK.json,aD,aK.rev);aE(null,aI)}else{aE(ii(ew))}})})},am._putLocal=function(aI,aE,aK){function aD(aO){var aM,aN;aJ?(aM="UPDATE "+J+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aL,aF,aG,aJ]):(aM="INSERT INTO "+J+" (id, rev, json) VALUES (?,?,?)",aN=[aG,aL,aF]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aH={ok:!0,id:aG,rev:aL},aE.ctx&&aK(null,aH)):aK(ii(g1))},function(){return aK(ii(g1)),!1})}"function"==typeof aE&&(aK=aE,aE={}),delete aI._revisions;var aL,aJ=aI._rev,aG=aI._id;aL=aJ?aI._rev="0-"+(parseInt(aJ.split("-")[1],10)+1):aI._rev="0-1";var aH,aF=jx(aI);aE.ctx?aD(aE.ctx):ax.transaction(aD,h6(aK),function(){aH&&aK(null,aH)})},am._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+J+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(ii(ew))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,h6(aH),function(){aD&&aH(null,aD)})},am._destroy=function(aD,aE){hm.removeAllListeners(am._name),ax.transaction(function(aF){var aG=[hJ,B,iw,a2,J,gq];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},h6(aE),function(){ga()&&(delete window.localStorage["_pouch__websqldb_"+am._name],delete window.localStorage[am._name]),aE(null,{ok:!0})})}}function iN(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gV(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var t=ga(),aa="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[aa]){return"1"===localStorage[aa]}var ab=iN();return t&&(localStorage[aa]=ab?"1":"0"),ab}function fS(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gV()}function hR(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=gc.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function gA(ac,aa){var ab=hR(ac),t=gc.extend({websql:ab},ac);im.call(this,t,aa)}function j(t){t.adapter("websql",gA,!0)}function i6(){for(var ac={},aa=new he(function(af,ad){ac.resolve=af,ac.reject=ad}),ab=new Array(arguments.length),t=0;t<ab.length;t++){ab[t]=arguments[t]}return ac.promise=aa,he.resolve().then(function(){return fetch.apply(null,ab)}).then(function(ad){ac.resolve(ad)})["catch"](function(ad){ac.reject(ad)}),ac}function v(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?ci(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=i6(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function fT(ac,aj){var af,ah,ad=!1,ab=function(){af.abort()},aa=function(){ad=!0,af.abort()};af=ac.xhr?new ac.xhr:new XMLHttpRequest;try{af.open(ac.method,ac.url)}catch(ag){aj(ag,{statusCode:413})}af.withCredentials="withCredentials" in ac?ac.withCredentials:!0,"GET"===ac.method?delete ac.headers["Content-Type"]:ac.json&&(ac.headers.Accept="application/json",ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json",ac.body&&ac.processData&&"string"!=typeof ac.body&&(ac.body=JSON.stringify(ac.body))),ac.binary&&(af.responseType="arraybuffer"),"body" in ac||(ac.body=null);for(var t in ac.headers){ac.headers.hasOwnProperty(t)&&af.setRequestHeader(t,ac.headers[t])}return ac.timeout>0&&(ah=setTimeout(aa,ac.timeout),af.onprogress=function(){clearTimeout(ah),4!==af.readyState&&(ah=setTimeout(aa,ac.timeout))},"undefined"!=typeof af.upload&&(af.upload.onprogress=af.onprogress)),af.onreadystatechange=function(){if(4===af.readyState){var ak={statusCode:af.status};if(af.status>=200&&af.status<300){var am;am=ac.binary?a8([af.response||""],{type:af.getResponseHeader("Content-Type")}):af.responseText,aj(null,ak,am)}else{var ap={};if(ad){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(af.response)}catch(al){}}aj(ap,ak)}}},ac.body&&ac.body instanceof Blob?ci(ac.body,function(ak){af.send(ak)}):af.send(ac.body),{abort:ab}}function iW(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function fq(t,aa){return jz||t.xhr?fT(t,aa):v(t,aa)}function P(){return""}function hr(ac,t){function aa(aj,af,ah){if(!ac.binary&&ac.json&&"string"==typeof aj){try{aj=JSON.parse(aj)}catch(ag){return ah(ag)}}Array.isArray(aj)&&(aj=aj.map(function(ak){return ak.error||ak.missing?iC(ak):ak})),ac.binary&&en(aj,af),ah(null,aj,af)}function ad(af,ah){var ak,ag;if(af.code&&af.status){var al=new Error(af.message||af.code);return al.status=af.status,ah(al)}if(af.message&&"ETIMEDOUT"===af.message){return ah(af)}try{ak=JSON.parse(af.responseText),ag=iC(ak)}catch(aj){ag=iC(af)}ah(ag)}ac=fp(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=gc.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),fq(ac,function(ak,af,ah){if(ak){return ak.status=af?af.statusCode:400,ad(ak,t)}var am,ag=af.headers&&af.headers["content-type"],aj=ah||P();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof aj&&(/json/.test(ag)||/^[\s]*\{/.test(aj)&&/\}[\s]*$/.test(aj))){try{aj=JSON.parse(aj.toString())}catch(al){}}af.statusCode>=200&&af.statusCode<300?aa(aj,af,t):(am=iC(aj),am.status=af.statusCode,t(am))})}function g7(ak,ah){var ac=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",af=-1!==ac.indexOf("safari")&&-1===ac.indexOf("chrome"),ad=-1!==ac.indexOf("msie"),aa=-1!==ac.indexOf("edge"),aj=af||(ad||aa)&&"GET"===ak.method,ag="cache" in ak?ak.cache:!0,t=/^blob:/.test(ak.url);if(!t&&(aj||!ag)){var ab=-1!==ak.url.indexOf("?");ak.url+=(ab?"&":"?")+"_nonce="+Date.now()}return hr(ak,ah)}function fw(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=gM(ab.data,ab.content_type)})}function fg(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function L(t){return t._attachments&&Object.keys(t._attachments)?he.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new he(function(ac){jA(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):he.resolve()}function hd(t){var aa=gd(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function gY(t,aa){return ev(t,t.db+"/"+aa)}function ev(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function gF(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function ct(ac,au){function ap(ax,aA,az){var ay=ax.ajax||{},aw=gc.extend(fp(aa),ay,aA);return gZ(aw.method+" "+aw.url),ah._ajax(aw,az)}function ab(aw,ax){return new he(function(az,ay){ap(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aj(aw,ax){return ge(aw,hS(function(ay){aq().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aq(){if(ac.skipSetup||ac.skip_setup){return he.resolve()}if(al){return al}var aw={method:"GET",url:av};return al=ab({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(go(404,"PouchDB is just detecting if the remote exists."),ab({},{method:"PUT",url:av})):he.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:he.reject(ax)}),al["catch"](function(){al=null}),al}function am(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ah=this,t=hd;ac.getHost&&(t=ac.getHost);var ak=t(ac.name,ac),av=gY(ak,"");ac=fp(ac);var aa=ac.ajax||{};if(ah.getUrl=function(){return av},ah.getHeaders=function(){return aa.headers||{}},ac.auth||ak.auth){var ad=ac.auth||ak.auth,af=ad.username+":"+ad.password,ag=h3(unescape(encodeURIComponent(af)));aa.headers=aa.headers||{},aa.headers.Authorization="Basic "+ag}ah._ajax=g7;var al;setTimeout(function(){au(null,ah)}),ah.type=function(){return"http"},ah.id=aj("id",function(aw){ap({},{method:"GET",url:ev(ak,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ak.db:gY(ak,"");aw(null,ay)})}),ah.request=aj("request",function(aw,ax){aw.url=gY(ak,aw.url),ap({},aw,ax)}),ah.compact=aj("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=fp(aw),ap(aw,{url:gY(ak,"_compact"),method:"POST"},function(){function ay(){ah.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ah.bulkGet=ge("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ap({},{url:gY(ak,"_bulk_get"+gF(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aG(aK){return function(aM,aL){aD[aK]=aL.results,++aF===aI&&aA(null,{results:R(aD)})}}for(var aJ=K,aI=Math.ceil(aC.docs.length/aJ),aF=0,aD=new Array(aI),aE=0;aI>aE;aE++){var aH=gC(aC,["revs","attachments"]);aH.ajax=aa,aH.docs=aC.docs.slice(aE*aJ,Math.min(aC.docs.length,(aE+1)*aJ)),gf(az,aH,aG(aE))}}var az=this,ay=ev(ak,""),aw=jr[ay];"boolean"!=typeof aw?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(jr[ay]=!1,go(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{jr[ay]=!0,aA(null,aE)}}):aw?ax(aA):aB()}),ah._info=function(aw){aq().then(function(){ap({},{method:"GET",url:gY(ak,"")},function(ay,ax){return ay?aw(ay):(ax.host=gY(ak,""),void aw(null,ax))})})["catch"](aw)},ah.get=aj("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?he.all(aF.map(function(aH){var aG=aD[aH],aI=fg(aE._id)+"/"+am(aH)+"?rev="+aE._rev;return ab(aC,{method:"GET",url:gY(ak,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:new he(function(aK){jA(aJ,aK)})}).then(function(aJ){delete aG.stub,delete aG.length,aG.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?he.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=fp(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=fg(aA);var ay={method:"GET",url:gY(ak,aA+gF(aw))};ab(aC,ay).then(function(aD){return he.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ah.remove=aj("remove",function(aB,az,ax,ay){var aA;"string"==typeof az?(aA={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aA=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aw=aA._rev||ax.rev;ap(ax,{method:"DELETE",url:gY(ak,fg(aA._id))+"?rev="+aw},ay)}),ah.getAttachment=aj("getAttachment",function(aB,ax,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.rev?"?rev="+az.rev:"",ay=gY(ak,fg(aB))+"/"+am(ax)+aw;ap(az,{method:"GET",url:ay,binary:!0},aA)}),ah.removeAttachment=aj("removeAttachment",function(ax,aA,ay,az){var aw=gY(ak,fg(ax)+"/"+am(aA))+"?rev="+ay;ap({},{method:"DELETE",url:aw},az)}),ah.putAttachment=aj("putAttachment",function(az,aG,aE,aD,aB,aF){"function"==typeof aB&&(aF=aB,aB=aD,aD=aE,aE=null);var aw=fg(az)+"/"+am(aG),ax=gY(ak,aw);if(aE&&(ax+="?rev="+aE),"string"==typeof aD){var aC;try{aC=D(aD)}catch(ay){return aF(ii(gx,"Attachment is not a valid base64 string"))}aD=aC?a7(aC,aB):""}var aA={headers:{"Content-Type":aB},method:"PUT",url:ax,processData:!1,body:aD,timeout:aa.timeout||60000};ap({},aA,aF)}),ah._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,aq().then(function(){return he.all(ax.docs.map(L))}).then(function(){ap(aw,{method:"POST",url:gY(ak,"_bulk_docs"),body:ax},function(aA,az){return aA?ay(aA):(az.forEach(function(aB){aB.ok=!0}),void ay(null,az))})})["catch"](ay)},ah.allDocs=aj("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=fp(aA);var ax,aB={},az="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var ay=gF(aB);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=jb?ay+="&"+aw:(az="POST",ax={keys:aA.keys})}ab(aA,{method:az,url:gY(ak,"_all_docs"+ay),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(fw),aC(null,aD)})["catch"](aC)}),ah._changes=function(ay){var aF="batch_size" in ay?ay.batch_size:il;ay=fp(ay),ay.timeout="timeout" in ay?ay.timeout:"timeout" in aa?aa.timeout:30000;var aH,az=ay.timeout?{timeout:ay.timeout-5000}:{},aw="undefined"!=typeof ay.limit?ay.limit:!1;aH="return_docs" in ay?ay.return_docs:"returnDocs" in ay?ay.returnDocs:!0;var aB=aw;if(ay.style&&(az.style=ay.style),(ay.include_docs||ay.filter&&"function"==typeof ay.filter)&&(az.include_docs=!0),ay.attachments&&(az.attachments=!0),ay.continuous&&(az.feed="longpoll"),ay.conflicts&&(az.conflicts=!0),ay.descending&&(az.descending=!0),"heartbeat" in ay?ay.heartbeat&&(az.heartbeat=ay.heartbeat):az.heartbeat=10000,ay.filter&&"string"==typeof ay.filter&&(az.filter=ay.filter),ay.view&&"string"==typeof ay.view&&(az.filter="_view",az.view=ay.view),ay.query_params&&"object"==typeof ay.query_params){for(var aJ in ay.query_params){ay.query_params.hasOwnProperty(aJ)&&(az[aJ]=ay.query_params[aJ])}}var aD,aE="GET";if(ay.doc_ids){az.filter="_doc_ids";var aG=JSON.stringify(ay.doc_ids);aG.length<jb?az.doc_ids=aG:(aE="POST",aD={doc_ids:ay.doc_ids})}var aI,aK,ax=function(aM,aN){if(!ay.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),ay.descending?aw&&(az.limit=aB):az.limit=!aw||aB>aF?aF:aB;var aL={method:aE,url:gY(ak,"_changes"+gF(az)),timeout:ay.timeout,body:aD};aK=aM,ay.aborted||aq().then(function(){aI=ap(ay,aL,aN)})["catch"](aN)}},aA={results:[]},aC=function(aN,aL){if(!ay.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aA.last_seq=aL.last_seq;var aP={};aP.query=ay.query_params,aL.results=aL.results.filter(function(aR){aB--;var aQ=hA(ay)(aR);return aQ&&(ay.include_docs&&ay.attachments&&ay.binary&&fw(aR),aH&&aA.results.push(aR),ay.onChange(aR)),aQ})}else{if(aN){return ay.aborted=!0,void ay.complete(aN)}}aL&&aL.last_seq&&(aK=aL.last_seq);var aO=aw&&0>=aB||aL&&aF>aM||ay.descending;(!ay.continuous||aw&&0>=aB)&&aO?ay.complete(null,aA):setTimeout(function(){ax(aK,aC)},0)}};return ax(ay.since||0,aC),{cancel:function(){ay.aborted=!0,aI&&aI.abort()}}},ah.revsDiff=aj("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),ap(aw,{method:"POST",url:gY(ak,"_revs_diff"),body:ax},ay)}),ah._close=function(aw){aw()},ah._destroy=function(aw,ax){ap(aw,{url:gY(ak,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function a0(t){t.adapter("http",ct,!1),t.adapter("https",ct,!1)}function F(){this.promise=new he(function(t){t()})}function an(aa){var ah=aa.db,ad=aa.viewName,ag=aa.map,af=aa.reduce,t=aa.temporary,ab=ag.toString()+(af&&af.toString())+"undefined";if(!t&&ah._cachedViews){var ac=ah._cachedViews[ab];if(ac){return he.resolve(ac)}}return ah.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ad;-1===aq.indexOf("/")&&(aq=ad+"/"+ad);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(t?"temp":ih(ab));return fx(ah,"_local/mrviews",al).then(function(){return ah.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ah,adapter:ah.adapter,mapFun:ag,reduceFun:af};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,t||(ah._cachedViews=ah._cachedViews||{},ah._cachedViews[ab]=aq,aq.db.once("destroyed",function(){delete ah._cachedViews[ab]})),aq})})})})}function ey(ac,t,aa,ad,ab,af){return ij("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function W(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function ip(t){return 1===t.length&&/^1-/.test(t[0].rev)}function gG(t,aa){try{t.emit("error",aa)}catch(ab){iu("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iu("error",aa)}}function hZ(ac,aa,ab){try{return{output:aa.apply(null,ab)}}catch(t){return gG(ac,t),{error:t}}}function s(t,aa){var ab=hg.collate(t.key,aa.key);return 0!==ab?ab:hg.collate(t.value,aa.value)}function h(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function ha(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function fb(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gM(ac.data,ac.content_type)})})}function k(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&fb(aa),aa}}function ao(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new iZ(aa)}function br(aa){for(var ah=0,ad=0,ag=aa.length;ag>ad;ad++){var af=aa[ad];if("number"!=typeof af){if(!Array.isArray(af)){throw ao("_sum")}ah="number"==typeof ah?[ah]:ah;for(var t=0,ab=af.length;ab>t;t++){var ac=af[t];if("number"!=typeof ac){throw ao("_sum")}"undefined"==typeof ah[t]?ah.push(ac):ah[t]+=ac}}else{"number"==typeof ah?ah+=af:ah[0]+=af}}return ah}function es(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function A(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function gR(t){return t.group_level=A(t.group_level),t.limit=A(t.limit),t.skip=A(t.skip),t}function M(t){if(t){if("number"!=typeof t){return new fe('Invalid value for integer: "'+t+'"')}if(0>t){return new fe('Invalid value for positive integer: "'+t+'"')}}}function fY(ac,aa){var ab=ac.descending?"endkey":"startkey",t=ac.descending?"startkey":"endkey";if("undefined"!=typeof ac[ab]&&"undefined"!=typeof ac[t]&&hg.collate(ac[ab],ac[t])>0){throw new fe("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(aa.reduce&&ac.reduce!==!1){if(ac.include_docs){throw new fe("{include_docs:true} is invalid for reduce")}if(ac.keys&&ac.keys.length>1&&!ac.group&&!ac.group_level){throw new fe("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=M(ac[af]);if(ad){throw ad}})}function gJ(ac,aj,af){var ah,ad=[],ab="GET";if(es("reduce",af,ad),es("include_docs",af,ad),es("attachments",af,ad),es("limit",af,ad),es("descending",af,ad),es("group",af,ad),es("group_level",af,ad),es("skip",af,ad),es("stale",af,ad),es("conflicts",af,ad),es("startkey",af,ad,!0),es("start_key",af,ad,!0),es("endkey",af,ad,!0),es("end_key",af,ad,!0),es("inclusive_end",af,ad),es("key",af,ad,!0),ad=ad.join("&"),ad=""===ad?"":"?"+ad,"undefined"!=typeof af.keys){var aa=2000,ag="keys="+encodeURIComponent(JSON.stringify(af.keys));ag.length+ad.length+1<=aa?ad+=("?"===ad[0]?"&":"?")+ag:(ab="POST","string"==typeof aj?ah={keys:af.keys}:aj.keys=af.keys)}if("string"==typeof aj){var t=W(aj);return ac.request({method:ab,url:"_design/"+t[0]+"/_view/"+t[1]+ad,body:ah}).then(k(af))}return ah=ah||{},Object.keys(aj).forEach(function(ak){Array.isArray(aj[ak])?ah[ak]=aj[ak]:ah[ak]=aj[ak].toString()}),ac.request({method:"POST",url:"_temp_view"+ad,body:ah}).then(k(af))}function G(t,aa,ab){return new he(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function n(t){return new he(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function iE(t){return function(aa){if(404===aa.status){return t}throw aa}}function a1(ag,aa,ah){function ak(){return ip(t)?he.resolve(ac):aa.db.get(af)["catch"](iE(ac))}function al(am){return am.keys.length?aa.db.allDocs({keys:am.keys,include_docs:!0}):he.resolve({rows:[]})}function aj(aw,av){for(var aA=[],aq={},am=0,ay=av.rows.length;ay>am;am++){var ax=av.rows[am],ap=ax.doc;if(ap&&(aA.push(ap),aq[ap._id]=!0,ap._deleted=!ab[ap._id],!ap._deleted)){var au=ab[ap._id];"value" in au&&(ap.value=au.value)}}var az=Object.keys(ab);return az.forEach(function(aD){if(!aq[aD]){var aB={_id:aD},aC=ab[aD];"value" in aC&&(aB.value=aC.value),aA.push(aB)}}),aw.keys=jj(az.concat(aw.keys)),aA.push(aw),aA}var af="_local/doc_"+ag,ac={_id:af,keys:[]},ad=ah[ag],ab=ad.indexableKeysToKeyValues,t=ad.changes;return ak().then(function(am){return al(am).then(function(ap){return aj(am,ap)})})}function iQ(ac,aa,ab){var t="_local/lastSeq";return ac.db.get(t)["catch"](iE({_id:t,seq:0})).then(function(af){var ad=Object.keys(aa);return he.all(ad.map(function(ag){return a1(ag,ac,aa)})).then(function(ag){var ah=R(ag);return af.seq=ab,ah.push(af),ac.db.bulkDocs({docs:ah})})})}function fr(t){var aa="string"==typeof t?t:t.name,ab=hb[aa];return ab||(ab=hb[aa]=new F),ab}function ho(t){return jp(fr(t),function(){return fz(t)})()}function fz(ac){function aj(am,ak){var al={id:ad._id,key:hg.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=hg.normalizeKey(ak)),ah.push(al)}function af(ak,al){return function(){return iQ(ac,ak,al)}}var ah,ad,ab;if("function"==typeof ac.mapFun&&2===ac.mapFun.length){var aa=ac.mapFun;ab=function(ak){return aa(ak,aj)}}else{ab=ey(ac.mapFun.toString(),aj,br,iK,Array.isArray,JSON.parse)}var ag=ac.seq||0,t=new F;return new he(function(ap,ak){function al(){t.finish().then(function(){ac.seq=ag,ap()})}function am(){function aq(au){ak(au)}ac.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ag,limit:dr}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var au={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){ah=[],ad=ax.doc,ad._deleted||hZ(ac.sourceDB,ab,[ad]),ah.sort(s);for(var ay,aC={},az=0,aG=ah.length;aG>az;az++){var aE=ah[az],aB=[aE.key,aE.id];0===hg.collate(aE.key,ay)&&aB.push(az);var aw=hg.toIndexableString(aB);aC[aw]=aE,ay=aE.key}au[ax.doc._id]={indexableKeysToKeyValues:aC,changes:ax.changes}}ag=ax.seq}return t.add(af(au,ag)),aA.length<dr?al():am()}).on("error",aq)}am()})}function ae(ag,aa,ah){0===ah.group_level&&delete ah.group_level;var ak,al=ah.group||ah.group_level;ak=C[ag.reduceFun]?C[ag.reduceFun]:ey(ag.reduceFun.toString(),null,br,iK,Array.isArray,JSON.parse);var aj=[],af=isNaN(ah.group_level)?Number.POSITIVE_INFINITY:ah.group_level;aa.forEach(function(aq){var am=aj[aj.length-1],ap=al?aq.key:null;return al&&Array.isArray(ap)&&(ap=ap.slice(0,af)),am&&0===hg.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void aj.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aa=[];for(var ac=0,ad=aj.length;ad>ac;ac++){var ab=aj[ac],t=hZ(ag.sourceDB,ak,[ab.keys,ab.values,!1]);if(t.error&&t.error instanceof iZ){throw t.error}aa.push({value:t.error?null:t.output,key:ab.groupKey})}return{rows:h(aa,ah.limit,ah.skip)}}function g8(t,aa){return jp(fr(t),function(){return gw(t,aa)})()}function gw(t,ap){function ak(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return al=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=hg.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function am(au){var av;if(av=ah?ae(t,au,ap):{total_rows:al,offset:ab,rows:au},ap.include_docs){var aq=jj(au.map(ha));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ap.conflicts,attachments:ap.attachments,binary:ap.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=ha(ay),az=ax["$"+aA];az&&(ay.doc=az)}),av})}return av}var al,ah=t.reduceFun&&ap.reduce!==!1,ab=ap.skip||0;if("undefined"==typeof ap.keys||ap.keys.length||(ap.limit=0,delete ap.keys),"undefined"!=typeof ap.keys){var ag=ap.keys,aa=ag.map(function(aq){var au={startkey:hg.toIndexableString([aq]),endkey:hg.toIndexableString([aq,{}])};return ak(au)});return he.all(aa).then(R).then(am)}var ac={descending:ap.descending};if(ap.start_key&&(ap.startkey=ap.start_key),ap.end_key&&(ap.endkey=ap.end_key),"undefined"!=typeof ap.startkey&&(ac.startkey=ap.descending?hg.toIndexableString([ap.startkey,{}]):hg.toIndexableString([ap.startkey])),"undefined"!=typeof ap.endkey){var af=ap.inclusive_end!==!1;ap.descending&&(af=!af),ac.endkey=hg.toIndexableString(af?[ap.endkey,{}]:[ap.endkey])}if("undefined"!=typeof ap.key){var aj=hg.toIndexableString([ap.key]),ad=hg.toIndexableString([ap.key,{}]);ac.descending?(ac.endkey=aj,ac.startkey=ad):(ac.startkey=aj,ac.endkey=ad)}return ah||("number"==typeof ap.limit&&(ac.limit=ap.limit),ac.skip=ab),ak(ac).then(am)}function a5(t){return t.request({method:"POST",url:"_view_cleanup"})}function gm(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ag){var ad=W(ag),ah="_design/"+ad[0],af=ad[1];aa[ah]=aa[ah]||{},aa[ah][af]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ag){var af={};ag.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){af[au]=af[au]||am})})});var ah=Object.keys(af).filter(function(aj){return !af[aj]}),ad=ah.map(function(aj){return jp(fr(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return he.all(ad).then(function(){return{ok:!0}})})},iE({ok:!0}))}function m(af,ac,aa){if("http"===af.type()){return gJ(af,ac,aa)}if("function"==typeof af._query){return G(af,ac,aa)}if("string"!=typeof ac){fY(aa,ac);var ad={db:af,viewName:"temp_view/temp_view",map:ac.map,reduce:ac.reduce,temporary:!0};return iG.add(function(){return an(ad).then(function(ak){function aj(){return ak.db.destroy()}return iY(ho(ak).then(function(){return g8(ak,aa)}),aj)})}),iG.finish()}var ah=ac,ab=W(ah),ag=ab[0],t=ab[1];return af.get("_design/"+ag).then(function(al){var ak=al.views&&al.views[t];if(!ak||"string"!=typeof ak.map){throw new iF("ddoc "+ag+" has no view named "+t)}fY(aa,ak);var aj={db:af,viewName:ah,map:ak.map,reduce:ak.reduce};return an(aj).then(function(am){return"ok"===aa.stale||"update_after"===aa.stale?("update_after"===aa.stale&&g9.nextTick(function(){ho(am)}),g8(am,aa)):ho(am).then(function(){return g8(am,aa)})})})}function fe(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fe)}catch(aa){}}function iF(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,iF)}catch(aa){}}function iZ(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,iZ)}catch(aa){}}function h4(t){return/^1-/.test(t)}function x(t,aa,ab){return !t._attachments||!t._attachments[ab]||t._attachments[ab].digest!==aa._attachments[ab].digest}function i(t,aa){var ab=Object.keys(aa._attachments);return he.all(ab.map(function(ac){return t.getAttachment(aa._id,ac,{rev:aa._rev})}))}function X(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return he.all(ab.map(function(ag){return x(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return i(t,aa)}):i(t,aa)}function fj(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function i7(ah,ac,aj,al){function ak(){var am=fj(aj);if(am.docs.length){return ah.bulkGet(am).then(function(ap){if(al.cancelled){throw new Error("cancelled")}return he.all(ap.results.map(function(aq){return he.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?X(ac,ah,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ab=ab.concat(R(aq).filter(Boolean))})})}}function ag(am){return am._attachments&&Object.keys(am._attachments).length>0}function af(am){return ah.allDocs({keys:am,include_docs:!0}).then(function(ap){if(al.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&h4(aq.value.rev)&&!ag(aq.doc)&&(ab.push(aq.doc),delete aj[aq.id])})})}function aa(){var am=Object.keys(aj).filter(function(aq){var ap=aj[aq].missing;return 1===ap.length&&h4(ap[0])});return am.length>0?af(am):void 0}function ad(){return{ok:t,docs:ab}}aj=fp(aj);var ab=[],t=!0;return he.resolve().then(aa).then(ak).then(ad)}function Q(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&go(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:p}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,hj),af.version=p,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return Q(ac,t,aa,ad,ab)}throw ag}))})}function ai(ac,aa,ab,t){this.src=ac,this.target=aa,this.id=ab,this.returnValue=t}function ju(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:iA(t.history,aa.history)}function iA(aa,ah){var ad=aa[0],ag=aa.slice(1),af=ah[0],t=ah.slice(1);if(!ad||0===ah.length){return{last_seq:ce,history:[]}}var ab=ad.session_id;if(gg(ab,ah)){return{last_seq:ad.last_seq,history:aa}}var ac=af.session_id;return gg(ac,ag)?{last_seq:af.last_seq,history:t}:iA(ag,t)}function gg(ac,aa){var ab=aa[0],t=aa.slice(1);return ac&&0!==aa.length?ac===ab.session_id?!0:gg(ac,t):!1}function fs(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function N(ac,aa,ab,t){return ac.retry===!1?(aa.emit("error",ab),void aa.removeAllListeners()):("function"!=typeof ac.back_off_function&&(ac.back_off_function=gl),aa.emit("requestError",ab),"active"!==aa.state&&"pending"!==aa.state||(aa.emit("paused",ab),aa.state="stopped",aa.once("active",function(){ac.current_back_off=hC})),ac.current_back_off=ac.current_back_off||hC,ac.current_back_off=ac.back_off_function(ac.current_back_off),void setTimeout(t,ac.current_back_off))}function gD(t){return Object.keys(t).sort(hg.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function cr(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(hg.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(gD(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),he.all([ab.id(),ad.id()]).then(function(aj){var ah=aj[0]+aj[1]+aa+af+t+ac;return new he(function(ak){dt(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gP(aP,aG,au,az,av){function aj(){return ab?he.resolve():cr(aP,aG,au).then(function(aS){aI=aS,ab=new ai(aP,aG,aI,az)})}function aA(){if(aC=[],0!==aR.docs.length){var aS=aR.docs;return aG.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(az.cancelled){throw aw(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(av.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),aQ=aQ.concat(aV),av.docs_written+=aR.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?az.emit("denied",fp(aY)):aC.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,ah("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw av.doc_write_failures+=aS.length,aT})}}function aF(){if(aR.error){throw new Error("There was a problem getting docs.")}av.last_seq=ak=aR.seq;var aS=fp(av);return aC.length&&(aS.docs=aC,az.emit("change",aS)),af=!0,ab.writeCheckpoint(aR.seq,aO).then(function(){if(af=!1,az.cancelled){throw aw(),new Error("cancelled")}aR=void 0,ap()})["catch"](aH)}function aM(){var aS={};return aR.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aG.revsDiff(aS).then(function(aT){if(az.cancelled){throw aw(),new Error("cancelled")}aR.diffs=aT})}function ac(){return i7(aP,aG,aR.diffs,az).then(function(aS){aR.error=!aS.ok,aS.docs.forEach(function(aT){delete aR.diffs[aT._id],av.docs_read++,aR.docs.push(aT)})})}function am(){if(!az.cancelled&&!aR){if(0===al.length){return void aK(!0)}aR=al.shift(),aM().then(ac).then(aA).then(aF).then(am)["catch"](function(aS){ah("batch processing terminated with error",aS)})}}function aK(aS){return 0===ax.changes.length?void (0!==al.length||aR||((aD&&aq.live||aB)&&(az.state="pending",az.emit("paused")),aB&&aw())):void ((aS||aB||ax.changes.length>=aL)&&(al.push(ax),ax={seq:0,changes:[],docs:[]},"pending"!==az.state&&"stopped"!==az.state||(az.state="active",az.emit("active")),am()))}function ah(aS,aT){ad||(aT.message||(aT.message=aS),av.ok=!1,av.status="aborting",av.errors.push(aT),aQ=aQ.concat(aT),al=[],ax={seq:0,changes:[],docs:[]},aw())}function aw(){if(!(ad||az.cancelled&&(av.status="cancelled",af))){av.status=av.status||"complete",av.end_time=new Date,av.last_seq=ak,ad=!0;var aS=aQ.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aQ.pop();aQ.length>0&&(aT.other_errors=aQ),aT.result=av,N(au,az,aT,function(){gP(aP,aG,au,az)})}else{av.errors=aQ,az.emit("complete",av),az.removeAllListeners()}}}function aN(aS){if(az.cancelled){return aw()}var aT=hA(au)(aS);aT&&(ax.seq=aS.seq,ax.changes.push(aS),aK(0===al.length&&aq.live))}function t(aS){if(aE=!1,az.cancelled){return aw()}if(aS.results.length>0){aq.since=aS.last_seq,ap(),aK(!0)}else{var aT=function(){aD?(aq.live=!0,ap()):aB=!0,aK(!0)};aR||0!==aS.results.length?aT():(af=!0,ab.writeCheckpoint(aS.last_seq,aO).then(function(){af=!1,av.last_seq=ak=aS.last_seq,aT()})["catch"](aH))}}function ay(aS){return aE=!1,az.cancelled?aw():void ah("changes rejected",aS)}function ap(){function aS(){aT.cancel()}function aU(){az.removeListener("cancel",aS)}if(!aE&&!aB&&al.length<aJ){aE=!0,az._changes&&(az.removeListener("cancel",az._abortChanges),az._changes.cancel()),az.once("cancel",aS);var aT=aP.changes(aq).on("change",aN);aT.then(aU,aU),aT.then(t)["catch"](ay),au.retry&&(az._changes=aT,az._abortChanges=aS)}}function ag(){aj().then(function(){return az.cancelled?void aw():ab.getCheckpoint().then(function(aS){ak=aS,aq={since:ak,limit:aL,batch_size:aL,style:"all_docs",doc_ids:aa,return_docs:!0},au.filter&&("string"!=typeof au.filter?aq.include_docs=!0:aq.filter=au.filter),"heartbeat" in au&&(aq.heartbeat=au.heartbeat),"timeout" in au&&(aq.timeout=au.timeout),au.query_params&&(aq.query_params=au.query_params),au.view&&(aq.view=au.view),ap()})})["catch"](function(aS){ah("getCheckpoint rejected with ",aS)})}function aH(aS){throw af=!1,ah("writeCheckpoint completed with error",aS),aS}var aR,aI,ab,al=[],ax={seq:0,changes:[],docs:[]},af=!1,aB=!1,ad=!1,ak=0,aD=au.continuous||au.live||!1,aL=au.batch_size||100,aJ=au.batches_limit||10,aE=!1,aa=au.doc_ids,aQ=[],aC=[],aO=eo();av=av||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aq={};return az.ready(aP,aG),az.cancelled?void aw():(az._addedListeners||(az.once("cancel",aw),"function"==typeof au.complete&&(az.once("error",au.complete),az.once("complete",function(aS){au.complete(null,aS)})),az._addedListeners=!0),void ("undefined"==typeof au.since?ag():aj().then(function(){return af=!0,ab.writeCheckpoint(au.since,aO)}).then(function(){return af=!1,az.cancelled?void aw():(ak=au.since,void ag())})["catch"](aH)))}function io(){jC.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new he(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function gb(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function hc(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw ii(h7,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=fp(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new io(ag),t=gb(ab,ag),af=gb(ad,ag);return gP(t,af,ag,aa),aa}function hO(ac,aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"undefined"==typeof ab&&(ab={}),ab=fp(ab),ab.PouchConstructor=ab.PouchConstructor||this,ac=gb(ac,ab),aa=gb(aa,ab),new hI(ac,aa,ab,t)}function hI(aa,aj,ah,aq){function ak(ay){ac.emit("change",{direction:"pull",change:ay})}function ad(ay){ac.emit("change",{direction:"push",change:ay})}function al(ay){ac.emit("denied",{direction:"push",doc:ay})}function ag(ay){ac.emit("denied",{direction:"pull",doc:ay})}function av(){ac.pushPaused=!0,ac.pullPaused&&ac.emit("paused")}function ap(){ac.pullPaused=!0,ac.pushPaused&&ac.emit("paused")}function ab(){ac.pushPaused=!1,ac.pullPaused&&ac.emit("active",{direction:"push"})}function af(){ac.pullPaused=!1,ac.pushPaused&&ac.emit("active",{direction:"pull"})}function t(ay){return function(aC,az){var aE="change"===aC&&(az===ak||az===ad),aA="denied"===aC&&(az===ag||az===al),aD="paused"===aC&&(az===ap||az===av),aB="active"===aC&&(az===af||az===ab);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ac.removeAllListeners(aC))}}var ac=this;this.canceled=!1;var am=ah.push?gc.extend({},ah,ah.push):ah,aw=ah.pull?gc.extend({},ah,ah.pull):ah;this.push=hc(aa,aj,am),this.pull=hc(aj,aa,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ah.live&&(this.push.on("complete",ac.pull.cancel.bind(ac.pull)),this.pull.on("complete",ac.push.cancel.bind(ac.push))),this.on("newListener",function(ay){"change"===ay?(ac.pull.on("change",ak),ac.push.on("change",ad)):"denied"===ay?(ac.pull.on("denied",ag),ac.push.on("denied",al)):"active"===ay?(ac.pull.on("active",af),ac.push.on("active",ab)):"paused"===ay&&(ac.pull.on("paused",ap),ac.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ac.pull.removeListener("change",ak),ac.push.removeListener("change",ad)):"denied"===ay?(ac.pull.removeListener("denied",ag),ac.push.removeListener("denied",al)):"active"===ay?(ac.pull.removeListener("active",af),ac.push.removeListener("active",ab)):"paused"===ay&&(ac.pull.removeListener("paused",ap),ac.push.removeListener("paused",av))}),this.pull.on("removeListener",t("pull")),this.push.on("removeListener",t("push"));var au=he.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ac.emit("complete",az),aq&&aq(null,az),ac.removeAllListeners(),az},function(ay){if(ac.cancel(),aq?aq(ay):ac.emit("error",ay),ac.removeAllListeners(),aq){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function jm(t){t.replicate=hc,t.sync=hO}var at,gc=e(9),gi=cn(e(5)),je=cn(e(8)),hx=cn(e(10)),h5=e(14),hS=cn(e(4)),jC=e(1),ij=cn(e(15)),i5=cn(e(16)),hw=cn(e(17)),hg=e(12),he="function"==typeof Promise?Promise:hx,de=Function.prototype.toString,gp=de.call(Object),gB=gi("pouchdb:api"),i8=6;if(fu()){at=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),at=!!localStorage.getItem("_pouch_check_localstorage")}catch(gN){at=!1}}je(co,jC.EventEmitter),co.prototype.addListener=function(ab,ad,ag,ac){function aa(){function aj(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var ah=gC(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",aj)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},co.prototype.removeListener=function(t,aa){aa in this._listeners&&jC.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},co.prototype.notifyLocalWindows=function(t){fu()?chrome.storage.local.set({dbName:t}):ga()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},co.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},je(fv,Error),fv.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var gW=new fv({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hK=new fv({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ew=new fv({status:404,error:"not_found",reason:"missing"}),g1=new fv({status:409,error:"conflict",reason:"Document update conflict"}),iq=new fv({status:400,error:"invalid_id",reason:"_id field must contain a string"}),hl=new fv({status:412,error:"missing_id",reason:"_id is required for puts"}),et=new fv({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hi=new fv({status:412,error:"precondition_failed",reason:"Database not open"}),ik=new fv({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),gx=new fv({status:500,error:"badarg",reason:"Some query argument is invalid"}),g3=new fv({status:400,error:"invalid_request",reason:"Request was invalid"}),hy=new fv({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ei=new fv({status:500,error:"doc_validation",reason:"Bad special document member"}),h7=new fv({status:400,error:"bad_request",reason:"Something wrong with the request"}),fV=new fv({status:400,error:"bad_request",reason:"Document must be a JSON object"}),fX=new fv({status:404,error:"not_found",reason:"Database not found"}),fn=new fv({status:500,error:"indexed_db_went_bad",reason:"unknown"}),iB=new fv({status:500,error:"web_sql_went_bad",reason:"unknown"}),dn=new fv({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fm=new fv({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),i4=new fv({status:400,error:"bad_request",reason:"Invalid rev format"}),gL=new fv({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),iV=new fv({status:412,error:"missing_stub"}),hG=new fv({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gt=[gW,hK,ew,g1,iq,hl,et,hi,ik,gx,g3,hy,ei,h7,fV,fX,iB,dn,fm,i4,gL,iV,fn,hG],gu=function(ac,aa,ab){var t=gt.filter(function(ad){return ad[ac]===aa});return ab&&t.filter(function(ad){return ad.message===ab})[0]||t[0]},bt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q="queryKey",ez=/(?:^|&)([^&=]*)=?([^&]*)/g,be=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");je(h1,jC.EventEmitter),h1.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},h1.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=fp(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=gk,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=jd(ac.view):ac.filter=jd(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=hS(function(af){ad.cancel(),ab.apply(this,af)})}},h1.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=ii(h7,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=gh(ac.view);this.db.get("_design/"+ab[0],function(aj,ag){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(aj){return aa(iC(aj))}var ah=ag&&ag.views&&ag.views[ab[1]]&&ag.views[ab[1]].map;return ah?(ac.filter=jw(ah),void t.doChanges(ac)):aa(ii(ew,ag.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=gh(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(ah,ag){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ah){return aa(iC(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(ac.filter=gO(aj),void t.doChanges(ac)):aa(ii(ew,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},je(jB,jC.EventEmitter),jB.prototype.post=ge("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(ii(fV)):void this.bulkDocs({docs:[t]},aa,E(ab))}),jB.prototype.put=ge("put",hS(function(ac){function aj(){aa||(iu("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),aa=!0)}var af,ah,ad,ab,aa=!1,ag=ac.shift(),t="_id" in ag;if("object"!=typeof ag||Array.isArray(ag)){return(ab=ac.pop())(ii(fV))}for(;;){if(af=ac.shift(),ah=typeof af,"string"!==ah||t?"string"!==ah||!t||"_rev" in ag?"object"===ah?ad=af:"function"===ah&&(ab=af):(aj(),ag._rev=af):(aj(),ag._id=af,t=!0),!ac.length){break}}return ad=ad||{},hs(ag._id),g6(ag._id)&&"function"==typeof this._putLocal?ag._deleted?this._removeLocal(ag,ab):this._putLocal(ag,ab):void this.bulkDocs({docs:[ag]},ad,E(ab))})),jB.prototype.putAttachment=ge("putAttachment",function(ab,ad,ag,ac,aa){function t(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ad]={content_type:aa,data:ac,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw ii(g1)}return t(ah)},function(ah){if(ah.reason===ew.message){return t({_id:ab})}throw ah})}),jB.prototype.removeAttachment=ge("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(ii(g1)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),jB.prototype.remove=ge("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,g6(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,E(ad))}),jB.prototype.revsDiff=ge("revsDiff",function(aa,ah,ad){function ag(ak,aj){ac.has(ak)||ac.set(ak,{missing:[]}),ac.get(ak).missing.push(aj)}function af(aj,ak){var al=aa[aj].slice(0);fd(ak,function(av,aw,am,aq,ap){var ax=aw+"-"+am,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==ap.status&&ag(aj,ax))}),al.forEach(function(am){ag(aj,am)})}"function"==typeof ah&&(ad=ah,ah={});var t=Object.keys(aa);if(!t.length){return ad(null,{})}var ab=0,ac=new h5.Map;t.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ac.set(aj,{missing:aa[aj]})}else{if(al){return ad(al)}af(aj,am)}if(++ab===t.length){var ak={};return ac.forEach(function(ap,aq){ak[aq]=ap}),ad(null,ak)}})},this)}),jB.prototype.bulkGet=ge("bulkGet",function(t,aa){gf(this,t,aa)}),jB.prototype.compactDocument=ge("compactDocument",function(ac,aa,ab){var t=this;this._getRevisionTree(ac,function(aj,af){if(aj){return ab(aj)}var ah=hF(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>aa&&ad.push(ak)}),fd(af,function(ak,am,aq,al,au){var ap=am+"-"+aq;"available"===au.status&&-1!==ad.indexOf(ap)&&ag.push(ap)}),t._doCompaction(ac,ag,ab)})}),jB.prototype.compact=ge("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&a4(ab)}),jB.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(ah){var aj=ah.last_seq;he.all(af).then(function(){return fx(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},jB.prototype.get=ge("get",function(aa,ah,ad){function ag(){var ak=[],aj=af.length;return aj?void af.forEach(function(al){t.get(aa,{rev:al,revs:ah.revs,attachments:ah.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ad(null,ak)})}):ad(null,ak)}if("function"==typeof ah&&(ad=ah,ah={}),"string"!=typeof aa){return ad(ii(iq))}if(g6(aa)&&"function"==typeof this._getLocal){return this._getLocal(aa,ad)}var af=[],t=this;if(!ah.open_revs){return this._get(aa,ah,function(al,ap){if(al){return ad(al)}var az=ap.doc,aA=ap.metadata,aw=ap.ctx;if(ah.conflicts){var aB=gz(aA);aB.length&&(az._conflicts=aB)}if(g0(aA,az._rev)&&(az._deleted=!0),ah.revs||ah.revs_info){var aj=iD(aA.rev_tree),au=ar(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(az._rev.split("-")[1])}),ay=au.ids.map(function(aC){return aC.id}).indexOf(az._rev.split("-")[1])+1,aq=au.ids.length-ay;if(au.ids.splice(ay,aq),au.ids.reverse(),ah.revs&&(az._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ah.revs_info){var am=au.pos+au.ids.length;az._revs_info=au.ids.map(function(aC){return am--,{rev:am+"-"+aC.id,status:aC.opts.status}})}}if(ah.attachments&&az._attachments){var ak=az._attachments,ax=Object.keys(ak).length;if(0===ax){return ad(null,az)}Object.keys(ak).forEach(function(aC){this._getAttachment(az._id,aC,ak[aC],{rev:az._rev,binary:ah.binary,ctx:aw},function(aE,aD){var aF=az._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--ax||ad(null,az)})},t)}else{if(az._attachments){for(var av in az._attachments){az._attachments.hasOwnProperty(av)&&(az._attachments[av].stub=!0)}}ad(null,az)}})}if("all"===ah.open_revs){this._getRevisionTree(aa,function(ak,aj){return ak?ad(ak):(af=i1(aj).map(function(al){return al.rev}),void ag())})}else{if(!Array.isArray(ah.open_revs)){return ad(ii(ik,"function_clause"))}af=ah.open_revs;for(var ab=0;ab<af.length;ab++){var ac=af[ab];if("string"!=typeof ac||!/^\d+-/.test(ac)){return ad(ii(i4))}}ag()}}),jB.prototype.getAttachment=ge("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(ii(ew))})}),jB.prototype.allDocs=ge("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(ii(hy,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return r(this,t,aa)}}return this._allDocs(t,aa)}),jB.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new h1(this,t,aa)},jB.prototype.close=ge("close",function(t){return this._closed=!0,this._close(t)}),jB.prototype.info=ge("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),jB.prototype.id=ge("id",function(t){return this._id(t)}),jB.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},jB.prototype.bulkDocs=ge("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(ii(hK))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(ii(fV))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||h2(ag)})}),ab?aa(ii(h7,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(l),gK(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),jB.prototype.registerDependentDatabase=ge("registerDependentDatabase",function(ac,aa){function ab(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ac]?!1:(ad.dependentDbs[ac]=!0,ad)}var t=new this.constructor(ac,this.__opts);fx(this,"_local/_pouch_dependentDbs",ab).then(function(){aa(null,{db:t})})["catch"](aa)}),jB.prototype.destroy=ge("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});he.all(ag).then(aa,t)})}),g5.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},g5.prototype.fail=function(t){this.failed=t,this.execute()},g5.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},g5.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},je(g4,jB),g4.debug=gi,g4.adapters={},g4.preferredAdapters=[],g4.prefix="_pouch_";var iX=new jC.EventEmitter;eu(g4),g4.parseAdapter=function(aa,ah){var ad,ag,af=aa.match(/([a-z\-]*):\/\/(.*)/);if(af){if(aa=/http(s?)/.test(af[1])?af[1]+"://"+af[2]:af[2],ad=af[1],!g4.adapters[ad].valid()){throw"Invalid adapter"}return{name:aa,adapter:af[1]}}var t="idb" in g4.adapters&&"websql" in g4.adapters&&ga()&&localStorage["_pouch__websqldb_"+g4.prefix+aa];if(ah.adapter){ag=ah.adapter}else{if("undefined"!=typeof ah&&ah.db){ag="leveldb"}else{for(var ab=0;ab<g4.preferredAdapters.length;++ab){if(ag=g4.preferredAdapters[ab],ag in g4.adapters){if(t&&"idb"===ag){iu("log",'PouchDB is downgrading "'+aa+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ad=g4.adapters[ag];var ac=ad&&"use_prefix" in ad?ad.use_prefix:!0;return{name:ac?g4.prefix+aa:aa,adapter:ag}},g4.adapter=function(t,aa,ab){aa.valid()&&(g4.adapters[t]=aa,ab&&g4.preferredAdapters.push(t))},g4.plugin=function(t){return"function"==typeof t?t(g4):Object.keys(t).forEach(function(aa){g4.prototype[aa]=t[aa]}),g4},g4.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=gc.extend({},t,ad),void g4.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return je(aa,g4),aa.preferredAdapters=g4.preferredAdapters.slice(),Object.keys(g4).forEach(function(ab){ab in aa||(aa[ab]=g4[ab])}),aa};var u="5.4.4";g4.version=u;var ht,gT=fh(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hY=fh(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),D=function(t){return atob(t)},h3=function(t){return btoa(t)},hM=jt.setImmediate||jt.setTimeout,iU=32768,g2=5,h8="document-store",gv="by-sequence",gr="attach-store",a6="attach-seq-store",i9="meta-store",hP="local-store",iH="detect-blob-support",hV={running:!1,queue:[]},hD=new h5.Map,iR=new co,ff=new h5.Map;gy.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ie=7,hJ=gn("document-store"),B=gn("by-sequence"),iw=gn("attach-store"),J=gn("local-store"),a2=gn("metadata-store"),gq=gn("attach-seq-store"),T=new h5.Map,hm=new co,fl=1,gH="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+B+" (seq, deleted)",iL="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+B+" (doc_id, rev)",o="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hJ+" (winningseq)",h9="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+gq+" (seq)",i0="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+gq+" (digest, seq)",ic=B+".seq = "+hJ+".winningseq",hh=B+".seq AS seq, "+B+".deleted AS deleted, "+B+".json AS data, "+B+".rev AS rev, "+hJ+".json AS metadata";gA.valid=fS,gA.use_prefix=!0;var jz=iW(),en=function(){},il=25,K=50,jr={},jb=1800,gZ=gi("pouchdb:http");ct.valid=function(){return !0},F.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},F.prototype.finish=function(){return this.promise};var hu=function(t,aa){return aa&&t.then(function(ab){g9.nextTick(function(){aa(null,ab)})},function(ab){g9.nextTick(function(){aa(ab)})}),t},ir=function(t){return hS(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hu(ab,aa),ab})},iY=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},jp=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},jj=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},hb={},iG=new F,dr=50,iK=iu.bind(null,"log"),C={_sum:function(t,aa){return br(aa)},_count:function(t,aa){return aa.length},_stats:function(t,aa){function ab(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:br(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},hp=ir(function(){var t=this;return"http"===t.type()?a5(t):"function"==typeof t._viewCleanup?n(t):gm(t)}),U=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?gR(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=he.resolve().then(function(){return m(ad,ac,t)});return hu(ab,aa),ab};je(fe,Error),je(iF,Error),je(iZ,Error);var ia={query:U,viewCleanup:hp},p=1,gU="pouchdb",hj=5,ce=0;ai.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},ai.prototype.updateTarget=function(t,aa){return Q(this.target,this.id,t,aa,this.returnValue)},ai.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?he.resolve(!0):Q(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(fs(ac)){return ab.readOnlySource=!0,!0}throw ac})};var fk={undefined:function(t,aa){return 0===hg.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return ju(aa,t).last_seq}};ai.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?he.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ce}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in fk?fk[ab](aa,ac):ce},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ce}).then(function(){return ce},function(ac){return fs(ac)?(t.readOnlySource=!0,aa.last_seq):ce})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ce})};var hC=0;je(io,jC.EventEmitter),io.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},io.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},je(hI,jC.EventEmitter),hI.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},g4.plugin(ji).plugin(j).plugin(a0).plugin(ia).plugin(jm),a.exports=g4}).call(this,e(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var f="color: "+this.color;k=[k[0],f,"color: inherit"].concat(Array.prototype.slice.call(k,1));var j=0,g=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),k.splice(g,0,f),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(n,b,s){function u(){return s.colors[o++%s.colors.length]}function t(h){function k(){}function j(){var q=j,m=+new Date,p=m-(i||m);q.diff=p,q.prev=i,q.curr=m,i=m,null==q.useColors&&(q.useColors=s.useColors()),null==q.color&&q.useColors&&(q.color=u());var w=Array.prototype.slice.call(arguments);w[0]=s.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=s.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof s.formatArgs&&(w=s.formatArgs.apply(q,w));var v=j.log||s.log||console.log.bind(console);v.apply(q,w)}k.enabled=!1,j.enabled=!0;var g=s.enabled(h)?j:k;return g.namespace=h,g}function r(j){s.save(j);for(var h=(j||"").split(/[\s,]+/),k=h.length,g=0;k>g;g++){h[g]&&(j=h[g].replace(/\*/g,".*?"),"-"===j[0]?s.skips.push(new RegExp("^"+j.substr(1)+"$")):s.names.push(new RegExp("^"+j+"$")))}}function f(){s.enable("")}function a(g){var j,h;for(j=0,h=s.skips.length;h>j;j++){if(s.skips[j].test(g)){return !1}}for(j=0,h=s.names.length;h>j;j++){if(s.names[j].test(g)){return !0}}return !1}function e(g){return g instanceof Error?g.stack||g.message:g}s=b.exports=t,s.coerce=e,s.disable=f,s.enable=r,s.enabled=a,s.humanize=n(11),s.names=[],s.skips=[],s.formatters={};var i,o=0},{11:11}],7:[function(e,a,b){(function(i){function r(){l=!0;for(var j,g,h=o.length;h;){for(g=o,o=[],j=-1;++j<h;){g[j]()}h=o.length}l=!1}function x(g){1!==o.push(g)||l||u()}var u,n=i.MutationObserver||i.WebKitMutationObserver;if(n){var f=0,y=new n(r),z=i.document.createTextNode("");y.observe(z,{characterData:!0}),u=function(){z.data=f=++f%2}}else{if(i.setImmediate||"undefined"==typeof i.MessageChannel){u="document" in i&&"onreadystatechange" in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){r(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(r,0)}}else{var s=new i.MessageChannel;s.port1.onmessage=r,u=function(){s.port2.postMessage(0)}}}var l,o=[];a.exports=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(e,a,b){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(t,u,i){function r(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=a,this.queue=[],this.outcome=void 0,g!==r&&y(this,g)}function h(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function p(j,k,g){n(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function e(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(q,j){function w(A){x||(x=!0,K.reject(q,A))}function g(A){x||(x=!0,K.resolve(q,A))}function k(){j(g,w)}var x=!1,z=o(k);"error"===z.status&&w(z.value)}function o(q,j){var k={};try{k.value=q(j),k.status="success"}catch(g){k.status="error",k.value=g}return k}function f(g){return g instanceof this?g:K.resolve(new this(r),g)}function l(g){var j=new this(r);return K.reject(j,g)}function b(w){function g(E,D){function C(F){k[D]=F,++q!==B||x||(x=!0,K.resolve(A,k))}z.resolve(E).then(C,function(F){x||(x=!0,K.reject(A,F))})}var z=this;if("[object Array]"!==Object.prototype.toString.call(w)){return this.reject(new TypeError("must be an array"))}var B=w.length,x=!1;if(!B){return this.resolve([])}for(var k=new Array(B),q=0,j=-1,A=new this(r);++j<B;){g(w[j],j)}return A}function s(q){function j(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(g,B))},function(B){x||(x=!0,K.reject(g,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(q)){return this.reject(new TypeError("must be an array"))}var k=q.length,x=!1;if(!k){return this.resolve([])}for(var z=-1,g=new this(r);++z<k;){j(q[z])}return g}var n=t(7),K={},L=["REJECTED"],m=["FULFILLED"],a=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(g,j){if("function"!=typeof g&&this.state===m||"function"!=typeof j&&this.state===L){return this}var k=new this.constructor(r);if(this.state!==a){var q=this.state===m?g:j;p(k,q,this.outcome)}else{this.queue.push(new h(k,g,j))}return k},h.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){p(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){K.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){p(this.promise,this.onRejected,g)},K.resolve=function(g,w){var k=o(e,w);if("error"===k.status){return K.reject(g,k.value)}var j=k.value;if(j){y(g,j)}else{g.state=m,g.outcome=w;for(var q=-1,x=g.queue.length;++q<x;){g.queue[q].callFulfilled(w)}}return g},K.reject=function(q,j){q.state=L,q.outcome=j;for(var k=-1,g=q.queue.length;++k<g;){q.queue[k].callRejected(j)}return q},v.resolve=f,v.reject=l,v.all=b,v.race=s},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function s(j){if(null!==j){switch(typeof j){case"boolean":return j?1:0;case"number":return p(j);case"string":return j.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var m=Array.isArray(j),v=m?j:Object.keys(j),g=-1,w=v.length,q="";if(m){for(;++g<w;){q+=h.toIndexableString(v[g])}}else{for(;++g<w;){var k=v[g];q+=h.toIndexableString(k)+h.toIndexableString(j[k])}}return q}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+n),m=parseInt(j,10)+e;for(x&&(m=-m),k+=n;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(v,g){var m=v.pop();if(g.length){var q=g[g.length-1];m===q.element&&(g.pop(),q=g[g.length-1]);var w=q.element,j=q.index;if(Array.isArray(w)){w.push(m)}else{if(j===v.length-2){var k=v.pop();w[k]=m}else{v.push(m)}}}}function b(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(j,m){for(var v=Object.keys(j),g=Object.keys(m),w=Math.min(v.length,g.length),q=0;w>q;q++){var k=h.collate(v[q],g[q]);if(0!==k){return k}if(k=h.collate(j[v[q]],m[g[q]]),0!==k){return k}}return v.length===g.length?0:v.length>g.length?1:-1}function a(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function p(k){if(0===k){return"1"}var y=k.toExponential().split(/e\+?/),q=parseInt(y[1],10),w=0>k,v=w?"0":"2",m=(w?-q:q)-e,j=i.padLeft(m.toString(),"0",n);v+=u+j;var x=Math.abs(parseFloat(y[0]));w&&(x=10-x);var g=x.toFixed(20);return g=g.replace(/\.?0+$/,""),v+=u+g}var e=-324,n=3,u="",i=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=a(j),g=a(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=h.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=h.normalizeKey(v))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),a(g)+u+s(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(b,h,a){function e(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var g,o=n.length,f=r.length;for(g=0;o>g;g++){if(g===f){return 1}var q=n.charAt(g),i=r.charAt(g);if(q!==i){return i>q?-1:1}}return f>o?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(l){function Q(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function s(j,A,k,w,q,z,x){return Q(A&k|~A&w,j,A,q,z,x)}function y(j,A,k,w,q,z,x){return Q(A&w|k&~w,j,A,q,z,x)}function u(j,A,k,w,q,z,x){return Q(A^k^w,j,A,q,z,x)}function o(j,A,k,w,q,z,x){return Q(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=s(z,j,x,k,w[0],7,-680876936),k=s(k,z,j,x,w[1],12,-389564586),x=s(x,k,z,j,w[2],17,606105819),j=s(j,x,k,z,w[3],22,-1044525330),z=s(z,j,x,k,w[4],7,-176418897),k=s(k,z,j,x,w[5],12,1200080426),x=s(x,k,z,j,w[6],17,-1473231341),j=s(j,x,k,z,w[7],22,-45705983),z=s(z,j,x,k,w[8],7,1770035416),k=s(k,z,j,x,w[9],12,-1958414417),x=s(x,k,z,j,w[10],17,-42063),j=s(j,x,k,z,w[11],22,-1990404162),z=s(z,j,x,k,w[12],7,1804603682),k=s(k,z,j,x,w[13],12,-40341101),x=s(x,k,z,j,w[14],17,-1502002290),j=s(j,x,k,z,w[15],22,1236535329),z=y(z,j,x,k,w[1],5,-165796510),k=y(k,z,j,x,w[6],9,-1069501632),x=y(x,k,z,j,w[11],14,643717713),j=y(j,x,k,z,w[0],20,-373897302),z=y(z,j,x,k,w[5],5,-701558691),k=y(k,z,j,x,w[10],9,38016083),x=y(x,k,z,j,w[15],14,-660478335),j=y(j,x,k,z,w[4],20,-405537848),z=y(z,j,x,k,w[9],5,568446438),k=y(k,z,j,x,w[14],9,-1019803690),x=y(x,k,z,j,w[3],14,-187363961),j=y(j,x,k,z,w[8],20,1163531501),z=y(z,j,x,k,w[13],5,-1444681467),k=y(k,z,j,x,w[2],9,-51403784),x=y(x,k,z,j,w[7],14,1735328473),j=y(j,x,k,z,w[12],20,-1926607734),z=u(z,j,x,k,w[5],4,-378558),k=u(k,z,j,x,w[8],11,-2022574463),x=u(x,k,z,j,w[11],16,1839030562),j=u(j,x,k,z,w[14],23,-35309556),z=u(z,j,x,k,w[1],4,-1530992060),k=u(k,z,j,x,w[4],11,1272893353),x=u(x,k,z,j,w[7],16,-155497632),j=u(j,x,k,z,w[10],23,-1094730640),z=u(z,j,x,k,w[13],4,681279174),k=u(k,z,j,x,w[0],11,-358537222),x=u(x,k,z,j,w[3],16,-722521979),j=u(j,x,k,z,w[6],23,76029189),z=u(z,j,x,k,w[9],4,-640364487),k=u(k,z,j,x,w[12],11,-421815835),x=u(x,k,z,j,w[15],16,530742520),j=u(j,x,k,z,w[2],23,-995338651),z=o(z,j,x,k,w[0],6,-198630844),k=o(k,z,j,x,w[7],10,1126891415),x=o(x,k,z,j,w[14],15,-1416354905),j=o(j,x,k,z,w[5],21,-57434055),z=o(z,j,x,k,w[12],6,1700485571),k=o(k,z,j,x,w[3],10,-1894986606),x=o(x,k,z,j,w[10],15,-1051523),j=o(j,x,k,z,w[1],21,-2054922799),z=o(z,j,x,k,w[8],6,1873313359),k=o(k,z,j,x,w[15],10,-30611744),x=o(x,k,z,j,w[6],15,-1560198380),j=o(j,x,k,z,w[13],21,1309151649),z=o(z,j,x,k,w[4],6,-145523070),k=o(k,z,j,x,w[11],10,-1120210379),x=o(x,k,z,j,w[2],15,718787259),j=o(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function m(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function r(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function O(C){var x,A,B,w,k,q,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;z>=x;x+=64){g(j,m(C.substring(x-64,x)))}for(C=C.substring(x-64),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;A>x;x+=1){B[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(B[x>>2]|=128<<(x%4<<3),x>55){for(g(j,B),x=0;16>x;x+=1){B[x]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),q=parseInt(w[1],16)||0,B[14]=k,B[15]=q,g(j,B),j}function v(C){var q,A,B,w,k,x,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(q=64;z>=q;q+=64){g(j,r(C.subarray(q-64,q)))}for(C=z>q-64?C.subarray(q-64):new Uint8Array(0),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=0;A>q;q+=1){B[q>>2]|=C[q]<<(q%4<<3)}if(B[q>>2]|=128<<(q%4<<3),q>55){for(g(j,B),q=0;16>q;q+=1){B[q]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,B[14]=k,B[15]=x,g(j,B),j}function P(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function t(j){var k;for(k=0;k<j.length;k+=1){j[k]=P(j[k])}return j.join("")}function n(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function p(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==t(O("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(x,z){var q,w,A,C,D=this.byteLength,k=j(x,D),B=D;return z!==l&&(B=j(z,D)),k>B?new ArrayBuffer(0):(q=B-k,w=new ArrayBuffer(q),A=new Uint8Array(w),C=new Uint8Array(this,k,q),A.set(C),w)}}(),p.prototype.append=function(j){return this.appendBinary(n(j)),this},p.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,m(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},p.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},p.hash=function(j,k){return p.hashBinary(n(j),k)},p.hashBinary=function(q,w){var k=O(q),j=t(k);return w?e(j):j},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,r(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var j=p.prototype.getState.call(this);return j.buff=S(j.buff),j},p.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),p.prototype.setState.call(this,j)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(q,w){var k=v(new Uint8Array(q)),j=t(k);return w?e(j):j},p})},{}],17:[function(b,h,a){function e(n,r,g){var o=g[g.length-1];n===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,q=o.index;if(Array.isArray(f)){f.push(n)}else{if(q===r.length-2){var i=r.pop();f[i]=n}else{r.push(n)}}}a.stringify=function(D){var E=[];E.push({obj:D});for(var u,f,l,n,s,i,g,r,F,o,C,t="";u=E.pop();){if(f=u.obj,l=u.prefix||"",n=u.val||"",t+=l,n){t+=n}else{if("object"!=typeof f){t+="undefined"==typeof f?null:JSON.stringify(f)}else{if(null===f){t+="null"}else{if(Array.isArray(f)){for(E.push({val:"]"}),s=f.length-1;s>=0;s--){i=0===s?"":",",E.push({obj:f[s],prefix:i})}E.push({val:"["})}else{g=[];for(r in f){f.hasOwnProperty(r)&&g.push(r)}for(E.push({val:"}"}),s=g.length-1;s>=0;s--){F=g[s],o=f[F],C=s>0?",":"",C+=JSON.stringify(F)+":",E.push({obj:o,prefix:C})}E.push({val:"{"})}}}}}return t},a.parse=function(s){for(var i,D,g,t,A,f,l,o,B,C=[],n=[],u=0;;){if(i=s[u++],"}"!==i&&"]"!==i&&"undefined"!=typeof i){switch(i){case" ":case"	":case"\n":case":":case",":break;case"n":u+=3,e(null,C,n);break;case"t":u+=3,e(!0,C,n);break;case"f":u+=4,e(!1,C,n);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",u--;;){if(g=s[u++],!/[\d\.\-e\+]/.test(g)){u--;break}D+=g}e(parseFloat(D),C,n);break;case'"':for(t="",A=void 0,f=0;;){if(l=s[u++],'"'===l&&("\\"!==A||f%2!==1)){break}t+=l,A=l,"\\"===A?f++:f=0}e(JSON.parse('"'+t+'"'),C,n);break;case"[":o={element:[],index:C.length},C.push(o.element),n.push(o);break;case"{":B={element:{},index:C.length},C.push(B.element),n.push(B);break;default:throw new Error("unexpectedly reached end of input: "+i)}}else{if(1===C.length){return C.pop()}e(C.pop(),C,n)}}}},{}]},{},[3])(3)});