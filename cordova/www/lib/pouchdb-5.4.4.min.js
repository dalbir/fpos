!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(j,g){if(!l[j]){if(!b[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(k){return k(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=l[j]={exports:{}};b[j][0].call(f.exports,function(m){var p=b[j][1][m];return e(p?p:m)},f,f.exports,d,b,l,i)}return l[j].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,r,l,h,j,f;if(this._events||(this._events={}),"error"===g&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[g],m(r)){return !1}if(o(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(p(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(f,h){function j(){this.removeListener(f,j),g||(g=!0,h.apply(this,arguments))}if(!o(h)){throw TypeError("listener must be a function")}var g=!1;return j.listener=h,this.on(f,j),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(p(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(o,l,n){function B(){t&&f&&(t=!1,f.length?i=f.concat(i):a=-1,i.length&&u())}function u(){if(!t){var g=r(B);t=!0;for(var j=i.length;j;){for(f=i,i=[];++a<j;){f&&f[a].run()}a=-1,j=i.length}f=null,t=!1,h(g)}}function e(g,j){this.fun=g,this.array=j}function b(){}var r,h,s=l.exports={};!function(){try{r=setTimeout}catch(g){r=function(){throw new Error("setTimeout is not defined")}}try{h=clearTimeout}catch(g){h=function(){throw new Error("clearTimeout is not defined")}}}();var f,i=[],t=!1,a=-1;s.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}i.push(new e(j,k)),1!==i.length||t||r(u,0)},e.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.binding=function(g){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(g){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],3:[function(b,e,a){(function(g9,iS){function gC(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function fZ(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function cn(ab){if("function"==typeof ab.slice){return ab.slice(0)}var t=new ArrayBuffer(ab.byteLength),aa=new Uint8Array(t),ac=new Uint8Array(ab);return aa.set(ac),t}function h2(aa){if(aa instanceof ArrayBuffer){return cn(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function eu(aa){var ab=Object.getPrototypeOf(aa);if(null===ab){return !0}var t=ab.constructor;return"function"==typeof t&&t instanceof t&&ez.call(t)==io}function fp(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=fp(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(fZ(ac)){return h2(ac)}if(!eu(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=fp(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function er(aa){var t=!1;return hK(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function ge(t){return hK(function(ac){ac=fp(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){g9.nextTick(function(){ad(ag,ah)})});var af=new hg(function(ah,aj){var al;try{var ag=er(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fy(aa,ab){function t(ag,aj,ad){if(hl.enabled){for(var ah=[ag._db_name,aj],af=0;af<ad.length-1;af++){ah.push(ad[af])}hl.apply(null,ah);var ac=ad[ad.length-1];ad[ad.length-1]=function(ak,am){var al=[ag._db_name,aj];al=al.concat(ak?["error",ak]:["success",am]),hl.apply(null,al),ac(ak,am)}}}return ge(hK(function(ad){if(this._closed){return hg.reject(new Error("database is closed"))}if(this._destroyed){return hg.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new hg(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function fi(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function fc(t){return t}function gX(t){return[{ok:t}]}function fd(ah,ac,ak){function aa(){var av=[];t.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),ak(null,{results:av})}function ap(){++aj===ad&&aa()}function am(av,aw,ax){t[av]={id:aw,docs:ax},ap()}function aq(){if(!(ag>=ab.length)){var av=Math.min(ag+hw,ab.length),aw=ab.slice(ag,av);af(aw,ag),ag+=aw.length}}function af(av,aw){av.forEach(function(aA,ay){var aC=aw+ay,aB=au[aA],ax=fi(aB[0],["atts_since","attachments"]);ax.open_revs=aB.map(function(aD){return aD.rev}),ax.open_revs=ax.open_revs.filter(fc);var az=fc;0===ax.open_revs.length&&(delete ax.open_revs,az=gX),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ac&&(ax[aD]=ac[aD])}),ah.get(aA,ax,function(aD,aF){var aE;aE=aD?[{error:aD}]:az(aF),am(aC,aA,aE),aq()})})}var al=ac.docs,au={};al.forEach(function(av){av.id in au?au[av.id].push(av):au[av.id]=[av]});var ad=Object.keys(au).length,aj=0,t=new Array(ad),ab=Object.keys(au),ag=0;aq()}function a3(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gf(){return ei}function co(t){a3()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gf()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function fU(){ij.EventEmitter.call(this),this._listeners={},co(this)}function gl(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function ee(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function go(aa){var t=0;return aa||(t=2000),ee(aa,t)}function jd(aa,t){gl("info","The above "+aa+" is totally normal. "+t)}function jl(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function iO(ab,t,aa){function ac(af){for(var ad in ab){"function"!=typeof ab[ad]&&(this[ad]=ab[ad])}void 0!==aa&&(this.name=aa),void 0!==af&&(this.reason=af)}return ac.prototype=jl.prototype,new ac(t)}function iC(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=h3("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=ju:"doc_validation"===aa?(ad=m,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=fV),ad||(ad=h3("status",ac.status,af)||gB),t=iO(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function ii(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return iO(fV,ab)}}function a9(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&ii(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function gd(ab){for(var t=[],aa=0,ac=ab.length;ac>aa;aa++){t=t.concat(ab[aa])}return t}function jt(aa){var t;if(aa?"string"!=typeof aa?t=iO(gN):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=iO(at)):t=iO(gx),t){throw t}}function fa(aa,t){return"listenerCount" in aa?aa.listenerCount(t):ij.EventEmitter.listenerCount(aa,t)}function g5(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function hs(aa){var t=g5(aa);return t?t.join("/"):null}function iu(ab){for(var ad=fz.exec(ab),ag={},ac=14;ac--;){var aa=fX[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[ht]={},ag[fX[12]].replace(be,function(aj,ah,ak){ah&&(ag[ht][ah]=ak)}),ag}function H(aa,ab,t){return new hg(function(ad,ac){aa.get(ab,function(af,ah){if(af){if(404!==af.status){return ac(af)}ah={}}var aj=ah._rev,ag=t(ah);return ag?(ag._id=ab,ag._rev=aj,void ad(g6(aa,ag,t))):ad({updated:!1,rev:aj})})})}function g6(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return H(aa,ab._id,t)})}function jE(t){return 0|Math.random()*t}function iv(ab,t){t=t||iV.length;var aa="",ac=-1;if(ab){for(;++ac<ab;){aa+=iV[jE(t)]}return aa}for(;++ac<36;){switch(ac){case 8:case 13:case 18:case 23:aa+="-";break;case 19:aa+=iV[3&jE(16)|8];break;default:aa+=iV[jE(16)]}}return aa}function jg(t){for(var ab,am,aa,ap,ak=t.rev_tree.slice();ap=ak.pop();){var ad=ap.ids,aj=ad[2],ac=ap.pos;if(aj.length){for(var af=0,ah=aj.length;ah>af;af++){ak.push({pos:ac+1,ids:aj[af]})}}else{var al=!!ad[1].deleted,ag=ad[0];ab&&!(aa!==al?aa:am!==ac?ac>am:ag>ab)||(ab=ag,am=ac,aa=al)}}return am+"-"+ab}function ga(ad,aa){for(var ag,aj=ad.slice();ag=aj.pop();){for(var ah=ag.pos,af=ag.ids,ac=af[2],ak=aa(0===ac.length,ah,af[0],ag.ctx,af[1]),ab=0,t=ac.length;t>ab;ab++){aj.push({pos:ah+1,ids:ac[ab],ctx:ak})}}}function fq(aa,t){return aa.pos-t.pos}function L(ab){var t=[];ga(ab,function(af,aj,ag,ad,ah){af&&t.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),t.sort(fq).reverse();for(var aa=0,ac=t.length;ac>aa;aa++){delete t[aa].pos}return t}function g0(ab){for(var ad=jg(ab),ag=L(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function gz(aa){var t=[];return ga(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function h1(t){for(var ab,am=[],aa=t.slice();ab=aa.pop();){var ap=ab.pos,ak=ab.ids,ad=ak[0],aj=ak[1],ac=ak[2],af=0===ac.length,ah=ab.history?ab.history.slice():[];ah.push({id:ad,opts:aj}),af&&am.push({pos:ap+1-ah.length,ids:ah});for(var al=0,ag=ac.length;ag>al;al++){aa.push({pos:ap+1,ids:ac[al],history:ah})}}return am.reverse()}function eo(aa,t){return aa.pos-t.pos}function fS(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function E(ab,t,aa){var ac=fS(ab,t,aa);ab.splice(ac,0,t)}function iD(ab,t){for(var ah,ac,aa=t,af=ab.length;af>aa;aa++){var ag=ab[aa],ad=[ag.id,ag.opts,[]];ac?(ac[2].push(ad),ac=ad):ah=ac=ad}return ah}function jw(aa,t){return aa[0]<t[0]?-1:1}function gO(ad,aa){for(var ag=[{tree1:ad,tree2:aa}],aj=!1;ag.length>0;){var ah=ag.pop(),af=ah.tree1,ac=ah.tree2;(af[1].status||ac[1].status)&&(af[1].status="available"===af[1].status||"available"===ac[1].status?"available":"missing");for(var ak=0;ak<ac[2].length;ak++){if(af[2][0]){for(var ab=!1,t=0;t<af[2].length;t++){af[2][t][0]===ac[2][ak][0]&&(ag.push({tree1:af[2][t],tree2:ac[2][ak]}),ab=!0)}ab||(aj="new_branch",E(af[2],ac[2][ak],jw))}else{aj="new_leaf",af[2][0]=ac[2][ak]}}}return{conflicts:aj,tree:ad}}function hR(al,aa,am){var aq,av=[],ag=!1,ac=!1;if(!al.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=al.length;aw>ak;ak++){var ap=al[ak];if(ap.pos===aa.pos&&ap.ids[0]===aa.ids[0]){aq=gO(ap.ids,aa.ids),av.push({pos:ap.pos,ids:aq.tree}),ag=ag||aq.conflicts,ac=!0}else{if(am!==!0){var t=ap.pos<aa.pos?ap:aa,aj=ap.pos<aa.pos?aa:ap,ab=aj.pos-t.pos,ad=[],ax=[];for(ax.push({ids:t.ids,diff:ab,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],af=0,ah=az.length;ah>af;af++){ax.push({ids:az[af],diff:ay.diff-1,parent:ay.ids,parentIdx:af})}}else{ay.ids[0]===aj.ids[0]&&ad.push(ay)}}var au=ad[0];au?(aq=gO(au.ids,aj.ids),au.parent[2][au.parentIdx]=aq.tree,av.push({pos:t.pos,ids:t.ids}),ag=ag||aq.conflicts,ac=!0):av.push(ap)}else{av.push(ap)}}}return ac||av.push(aa),av.sort(eo),{tree:av,conflicts:ag||"internal_node"}}function iP(t,ab){for(var am,aa=h1(t),ap={},ak=0,ad=aa.length;ad>ak;ak++){for(var aj=aa[ak],ac=aj.ids,af=Math.max(0,ac.length-ab),ah={pos:aj.pos+af,ids:iD(ac,af)},al=0;af>al;al++){var ag=aj.pos+al+"-"+ac[al].id;ap[ag]=!0}am=am?hR(am,ah,!0).tree:[ah]}return ga(am,function(aq,au,av){delete ap[au+"-"+av]}),{tree:am,revs:Object.keys(ap)}}function fT(ac,t,aa){var ad=hR(ac,t),ab=iP(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function bo(ad,aa){for(var ag,aj=ad.slice(),ah=aa.split("-"),af=parseInt(ah[0],10),ac=ah[1];ag=aj.pop();){if(ag.pos===af&&ag.ids[0]===ac){return !0}for(var ak=ag.ids[2],ab=0,t=ak.length;t>ab;ab++){aj.push({pos:ag.pos+1,ids:ak[ab]})}}return !1}function gs(t){return t.ids}function iT(ac,t){t||(t=jg(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(gs);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function gk(t){return/^_local/.test(t)}function di(t){return hc("return "+t+";",{})}function hF(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function w(aa,ab){try{aa.emit("change",ab)}catch(t){gl("error",'Error in .on("change", function):',t)}}function iz(ab,ad,ag){function ac(){aa.cancel()}ij.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?fp(ad):{};var t=ad.complete=er(function(aj,ah){aj?fa(aa,"error")>0&&aa.emit("error",aj):aa.emit("complete",ah),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(w(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new hg(function(aj,ah){ad.complete=function(al,ak){al?ah(al):aj(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function jo(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=L(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return iT(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=g0(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function hU(aa,t){return t>aa?-1:aa>t?1:0}function iW(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function hB(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function fg(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=fi(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function i1(ac,t){var aa=hU(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return hU(ad,ab)}function ex(aa){var ab={},t=[];return ga(aa,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(ab[ah]=0),void 0!==ag&&t.push({from:ag,to:ah}),ah}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function ct(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return hg.all(ad.map(function(af){var ag=gc.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hg(function(aj,ah){ac._allDocs(ag,function(ak,al){return ak?ah(ak):(ab.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function im(ab){var t=ab._compactionQueue[0],ac=t.opts,aa=t.callback;ab.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ac.last_seq=ad.last_seq),ab._compact(ac,function(ag,af){ag?aa(ag):aa(null,af),g9.nextTick(function(){ab._compactionQueue.shift(),ab._compactionQueue.length&&im(ab)})})})}function iy(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function fh(){ij.EventEmitter.call(this)}function jB(){this.isReady=!1,this.failed=!1,this.queue=[]}function gE(t){t&&iS.debug&&gl("error",t)}function fv(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function hE(ab,ad,ag){if(!(this instanceof hE)){return new hE(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=gE}else{var aa=ag;ag=function(){return gl("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=fp(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=hE.prefix,fh.call(ac),ac.taskqueue=new jB;var af=new hg(function(aj,al){ag=function(ap,am){return ap?al(ap):(delete am.then,void aj(am))},ad=fp(ad);var ah,ak;return function(){try{if("string"!=typeof ab){throw ak=new Error("Missing/invalid DB name"),ak.code=400,ak}var ap=(ad.prefix||"")+ab;if(ah=hE.parseAdapter(ap,ad),ad.originalName=ab,ad.name=ah.name,ad.adapter=ad.adapter||ah.adapter,ac._adapter=ad.adapter,he("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!hE.adapters[ad.adapter]){throw ak=new Error("Adapter is missing"),ak.code=404,ak}if(!hE.adapters[ad.adapter].valid()){throw ak=new Error("Invalid Adapter"),ak.code=404,ak}}catch(am){ac.taskqueue.fail(am)}}(),ak?al(ak):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void hE.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(fv(ac,ad),ac.emit("created",ac),hE.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function g4(aa){Object.keys(ij.EventEmitter.prototype).forEach(function(ab){"function"==typeof ij.EventEmitter.prototype[ab]&&(aa[ab]=gL[ab].bind(gL))});var t=aa._destructionListeners=new g1.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function ih(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function gM(ab){if(!/^\d+\-./.test(ab)){return iO(dn)}var t=ab.indexOf("-"),aa=ab.substring(0,t),ac=ab.substring(t+1);return{prefix:parseInt(aa,10),id:ac}}function hn(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function fW(ad,aa){var ag,aj,ah,af={status:"available"};if(ad._deleted&&(af.deleted=!0),aa){if(ad._id||(ad._id=iv()),aj=iv(32,16).toLowerCase(),ad._rev){if(ah=gM(ad._rev),ah.error){return ah}ad._rev_tree=[{pos:ah.prefix,ids:[ah.id,{status:"missing"},[[aj,af,[]]]]}],ag=ah.prefix+1}else{ad._rev_tree=[{pos:1,ids:[aj,af,[]]}],ag=1}}else{if(ad._revisions&&(ad._rev_tree=hn(ad._revisions,af),ag=ad._revisions.start,aj=ad._revisions.ids[0]),!ad._rev_tree){if(ah=gM(ad._rev),ah.error){return ah}ag=ah.prefix,aj=ah.id,ad._rev_tree=[{pos:ag,ids:[aj,af,[]]}]}}jt(ad._id),ad._rev=ag+"-"+aj;var ac={metadata:{},data:{}};for(var ak in ad){if(Object.prototype.hasOwnProperty.call(ad,ak)){var ab="_"===ak[0];if(ab&&!q[ak]){var t=iO(m,ak);throw t.message=m.message+": "+ak,t}ab&&!gt[ak]?ac.metadata[ak.slice(1)]=ad[ak]:ac.data[ak]=ad[ak]}}return ac}function i3(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function ja(t){return gu(i3(t))}function I(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function fx(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function dt(aa,t){return I([fx(aa)],{type:t})}function hA(aa,t){return dt(fm(aa),t)}function bn(ab,t){if("undefined"==typeof FileReader){return t(i3((new FileReaderSync).readAsArrayBuffer(ab)))}var aa=new FileReader,ac="function"==typeof aa.readAsBinaryString;aa.onloadend=function(af){var ad=af.target.result||"";return ac?t(ad):void t(i3(ad))},ac?aa.readAsBinaryString(ab):aa.readAsArrayBuffer(ab)}function iJ(aa,t){bn(aa,function(ab){t(gu(ab))})}function y(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function hH(t){return gu(t)}function a7(ab,t,aa,ac){(aa>0||ac<t.byteLength)&&(t=new Uint8Array(t,aa,Math.min(ac,t.byteLength)-aa)),ab.append(t)}function h0(ab,t,aa,ac){(aa>0||ac<t.length)&&(t=t.substring(aa,ac)),ab.appendBinary(t)}function R(ad,aa){function ag(){var aq=ak*af,al=aq+af;if(ak++,ac>ak){t(ab,ad,aq,al),bt(ag)}else{t(ab,ad,aq,al);var ap=ab.end(!0),am=hH(ap);aa(am),ab.destroy()}}var aj="string"==typeof ad,ah=aj?ad.length:ad.byteLength,af=Math.min(iU,ah),ac=Math.ceil(ah/af),ak=0,ab=aj?new jC:new jC.ArrayBuffer,t=aj?h0:a7;ag()}function ci(t){return jC.hash(t)}function gI(ab,t,ah){function ac(al){try{return fm(al)}catch(aj){var ak=iO(hy,"Attachment is not a valid base64 string");return{error:ak}}}function aa(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ac(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===t?aj.data=dt(al,aj.content_type):"base64"===t?aj.data=gu(al):aj.data=al,R(al,function(am){aj.digest="md5-"+am,ak()})}else{y(aj.data,function(am){"binary"===t?aj.data=i3(am):"base64"===t&&(aj.data=ja(am)),R(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function af(){ad++,ab.length===ad&&(ag?ah(ag):ah())}if(!ab.length){return ah()}var ag,ad=0;ab.forEach(function(ak){function am(aq){ag=aq,al++,al===aj.length&&af()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return af()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&aa(ak.data._attachments[ap],am)}})}function jD(ay,aj,aA,ad,am,av,al,ax){if(bo(aj.rev_tree,aA.metadata.rev)){return ad[am]=aA,av()}var ak=aj.winningRev||jg(aj),au="deleted" in aj?aj.deleted:iT(aj,ak),af="deleted" in aA.metadata?aA.metadata.deleted:iT(aA.metadata),aq=/^1-/.test(aA.metadata.rev);if(au&&!af&&ax&&aq){var az=aA.data;az._rev=ak,az._id=aA.metadata.id,aA=fW(az,ax)}var aw=fT(aj.rev_tree,aA.metadata.rev_tree[0],ay),ag=ax&&(au&&af||!au&&"new_leaf"!==aw.conflicts||au&&!af&&"new_branch"===aw.conflicts);if(ag){var ac=iO(h7);return ad[am]=ac,av()}var t=aA.metadata.rev;aA.metadata.rev_tree=aw.tree,aA.stemmedRevs=aw.stemmedRevs||[],aj.rev_map&&(aA.metadata.rev_map=aj.rev_map);var ab,ah=jg(aA.metadata),ap=iT(aA.metadata,ah),aa=au===ap?0:ap>au?-1:1;ab=t===ah?ap:iT(aA.metadata,t),al(aA,ah,ap,ab,!0,aa,am,av)}function a8(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jA(am,ak,ac,au,ah,aa,aq,af,ag){function t(aA,aC,aw){var ax=jg(aA.metadata),av=iT(aA.metadata,ax);if("was_delete" in af&&av){return aa[aC]=iO(ju,"deleted"),aw()}var az=ap&&a8(aA);if(az){var ay=iO(h7);return aa[aC]=ay,aw()}var aB=av?0:1;aq(aA,ax,av,av,!1,aB,aC,aw)}function ad(){++ab===aj&&ag&&ag()}am=am||1000;var ap=af.new_edits,al=new g1.Map,ab=0,aj=ak.length;ak.forEach(function(aw,ay){if(aw._id&&gk(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void ac[ax](aw,{ctx:ah},function(aA,az){aa[ay]=aA||az,ad()})}var av=aw.metadata.id;al.has(av)?(aj--,al.get(av).push([aw,ay])):al.set(av,[[aw,ay]])}),al.forEach(function(ay,aw){function ax(){++az<ay.length?av():ad()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(au.has(aw)){jD(am,au.get(aw),aA,aa,aB,ax,aq,ap)}else{var aD=fT([],aA.metadata.rev_tree[0],am);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],t(aA,aB,ax)}}var az=0;av()})}function it(aa){try{return JSON.parse(aa)}catch(t){return hx.parse(aa)}}function Z(t){return t.length<50000?JSON.parse(t):it(t)}function O(aa){try{return JSON.stringify(aa)}catch(t){return hx.stringify(aa)}}function gy(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function jk(aa){if(!hD.running&&hD.queue.length){hD.running=!0;var t=hD.queue.shift();t.action(function(ac,ab){gy(t.callback,this,[ac,ab],aa),hD.running=!1,g9.nextTick(function(){jk(aa)})})}}function gh(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(iO(gW,aa,ab.type))}}function ib(aa,ab,t){return{data:O(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function hL(aa){if(!aa){return null}var t=Z(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function z(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function Y(ab,t,aa,ac){aa?ac(ab?"string"!=typeof ab?ab:hA(ab,t):I([""],{type:t})):ab?"string"!=typeof ab?bn(ab,function(ad){ac(gu(ad))}):ac(ab):ac("")}function jq(ab,t,ah,ac){function aa(){++ad===ag.length&&ac&&ac()}function af(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ah.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,aa()}}var ag=Object.keys(ab._attachments||{});if(!ag.length){return ac&&ac()}var ad=0;ag.forEach(function(aj){t.attachments&&t.include_docs?af(ab,aj):(ab._attachments[aj].stub=!0,aa())})}function hN(aa,t){return hg.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hg.all(ab.map(function(ad){var ag=ac.doc._attachments[ad];if("body" in ag){var af=ag.body,ah=ag.content_type;return new hg(function(aj){Y(af,ah,t,function(ak){ac.doc._attachments[ad]=gc.extend(fi(ag,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function hv(ad,aa,ag){function aj(){t--,t||ah()}function ah(){af.length&&af.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ak["delete"](am)}})}var af=[],ac=ag.objectStore(g2),ak=ag.objectStore(gr),ab=ag.objectStore(gq),t=ad.length;ad.forEach(function(al){var am=ac.index("_doc_id_rev"),ap=aa+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return aj()}ac["delete"](av);var aq=ab.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];af.push(aw),ab["delete"](ay.primaryKey),ay["continue"]()}else{aj()}}}})}function hz(ab,t,aa){try{return{txn:ab.transaction(t,aa)}}catch(ac){return{error:ac}}}function i2(aJ,aD,am,al,ap,ax,ay){function aI(){var aN=[gv,g2,gr,jz,gq],aO=hz(ap,aN,"readwrite");return aO.error?ay(aO.error):(ah=aO.txn,ah.onabort=gh(ay),ah.ontimeout=gh(ay),ah.oncomplete=aj,aC=ah.objectStore(gv),ag=ah.objectStore(g2),av=ah.objectStore(gr),ac=ah.objectStore(gq),void aM(function(aP){return aP?(ak=!0,ay(aP)):void aL()}))}function aH(){jA(aJ.revs_limit,aa,al,aE,ah,t,aF,am)}function aL(){function aS(){++aQ===aa.length&&aH()}function aN(aU){var aV=hL(aU.target.result);aV&&aE.set(aV.id,aV),aS()}if(aa.length){for(var aQ=0,aT=0,aR=aa.length;aR>aT;aT++){var aO=aa[aT];if(aO._id&&gk(aO._id)){aS()}else{var aP=aC.get(aO.metadata.id);aP.onsuccess=aN}}}}function aj(){ak||(ax.notify(al._meta.name),al._meta.docCount+=aA,ay(null,t))}function au(aO,aP){var aN=av.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=iO(gT,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aa.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){au(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aF(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aG(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(ba){var bc=aP.stemmedRevs||[];aV&&al.auto_compaction&&(bc=bc.concat(gz(aP.metadata))),bc&&bc.length&&hv(bc,aP.metadata.id,ah),aT.seq=ba.target.result,delete aT.rev;var aZ=ib(aT,aW,aU),bb=aC.put(aZ);bb.onsuccess=aN}function aX(aZ){aZ.preventDefault(),aZ.stopPropagation();var ba=ag.index("_doc_id_rev"),bb=ba.getKey(aR._doc_id_rev);bb.onsuccess=function(bc){var bd=ag.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){t[aS]={ok:!0,id:aT.id,rev:aW},aE.set(aP.metadata.id,aP.metadata),az(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ag.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aG(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(bb){var aZ=aP.data._attachments[bb];if(aZ.stub){aO++,aN()}else{var aY=aZ.data;delete aZ.data,aZ.revpos=parseInt(aW,10);var ba=aZ.digest;aB(ba,aY,aV)}})}function az(aT,aO,aR){function aU(){++aP===aQ.length&&aR()}function aS(aV){var aW=aT.data._attachments[aV].digest,aX=ac.put({seq:aO,digestSeq:aW+"::"+aO});aX.onsuccess=aU,aX.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aU()}}var aP=0,aQ=Object.keys(aT.data._attachments||{});if(!aQ.length){return aR()}for(var aN=0;aN<aQ.length;aN++){aS(aQ[aN])}}function aB(aO,aQ,aN){var aP=av.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=av.put(aU);aR.onsuccess=aN}}for(var ah,aC,ag,av,ac,aq,aa=aD.docs,aA=0,ab=0,af=aa.length;af>ab;ab++){var aw=aa[ab];aw._id&&gk(aw._id)||(aw=aa[ab]=fW(aw,am.new_edits),aw.error&&!aq&&(aq=aw))}if(aq){return ay(aq)}var t=new Array(aa.length),aE=new g1.Map,ak=!1,aK=al._meta.blobSupport?"blob":"base64";gI(aa,aK,function(aN){return aN?ay(aN):void aI()})}function id(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function hf(ab,t,aa,ac){return"DataError"===aa.name&&0===aa.code?ac(null,{total_rows:ab._meta.docCount,offset:t.skip,rows:[]}):void ac(iO(gW,aa.name,aa.message))}function hq(ac,t,aa,ad){function ab(al,am){function aE(aN,aK,aM){var aL=aN.id+"::"+aM;az.get(aL).onsuccess=function(aO){aK.doc=z(aO.target.result),al.conflicts&&(aK.doc._conflicts=g0(aN)),jq(aK.doc,al,au)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===al.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):al.include_docs&&aE(aK,aM,aO)}else{if(!aN&&aC--<=0&&(aJ.push(aM),al.include_docs&&aE(aK,aM,aO),0===--aG)){return}}aL["continue"]()}function ay(aM){ag=t._meta.docCount;var aK=aM.target.result;if(aK){var aN=hL(aK.value),aL=aN.winningRev;av(aK,aL,aN)}}function ah(){am(null,{total_rows:ag,offset:al.skip,rows:aJ})}function aw(){al.attachments?hN(aJ,al.binary).then(ah):ah()}var ak="startkey" in al?al.startkey:!1,aq="endkey" in al?al.endkey:!1,ax="key" in al?al.key:!1,aC=al.skip||0,aG="number"==typeof al.limit?al.limit:-1,aD=al.inclusive_end!==!1,aj="descending" in al&&al.descending?"prev":null,aB=id(ak,aq,aD,ax,aj);if(aB&&aB.error){return hf(t,al,aB.error,am)}var aH=[gv,g2];al.attachments&&aH.push(gr);var aA=hz(aa,aH,"readonly");if(aA.error){return am(aA.error)}var au=aA.txn,aI=au.objectStore(gv),ap=au.objectStore(g2),aF=aj?aI.openCursor(aB,aj):aI.openCursor(aB),az=ap.index("_doc_id_rev"),aJ=[],ag=0;au.oncomplete=aw,aF.onsuccess=ay}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:t._meta.docCount,offset:ah.skip,rows:[]}):void ab(ah,ag)}af(ac,ad)}function jn(t){return new hg(function(ab){var aa=I([""]);t.objectStore(jx).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function S(aa,ab){var t=this;hD.queue.push({action:function(ac){ix(t,aa,ac)},callback:ab}),jk(t.constructor)}function ix(ab,aa,al){function aj(au){var av=au.createObjectStore(gv,{keyPath:"id"});au.createObjectStore(g2,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gr,{keyPath:"digest"}),au.createObjectStore(J,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jx),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(jz,{keyPath:"_id"});var aw=au.createObjectStore(gq,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ah(au,av){var aw=au.objectStore(gv);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=iT(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function am(au){au.createObjectStore(jz,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ac(ax,av){var aw=ax.objectStore(jz),az=ax.objectStore(gv),ay=ax.objectStore(g2),au=az.openCursor();au.onsuccess=function(aL){var aC=aL.target.result;if(aC){var aI=aC.value,aF=aI.id,aG=gk(aF),aJ=jg(aI);if(aG){var aA=aF+"::"+aJ,aD=aF+"::",aK=aF+"::~",aB=ay.index("_doc_id_rev"),aE=IDBKeyRange.bound(aD,aK,!1,!1),aH=aB.openCursor(aE);aH.onsuccess=function(aN){if(aH=aN.target.result){var aM=aH.value;aM._doc_id_rev===aA&&aw.put(aM),ay["delete"](aH.primaryKey),aH["continue"]()}else{az["delete"](aC.primaryKey),aC["continue"]()}}}else{aC["continue"]()}}else{av&&av()}}}function ag(au){var av=au.createObjectStore(gq,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function af(ax,av){var aw=ax.objectStore(g2),az=ax.objectStore(gr),ay=ax.objectStore(gq),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aD){var aH=aD.target.result;if(!aH){return av()}for(var aI=aH.value,aF=aH.primaryKey,aL=Object.keys(aI._attachments||{}),aJ={},aK=0;aK<aL.length;aK++){var aC=aI._attachments[aL[aK]];aJ[aC.digest]=!0}var aE=Object.keys(aJ);for(aK=0;aK<aE.length;aK++){var aG=aE[aK];ay.put({seq:aF,digestSeq:aG+"::"+aF})}aH["continue"]()}):av()}}function aq(av){function au(az){return az.data?hL(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(g2),ax=av.objectStore(gv),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=ib(az,az.winningRev,az.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=au(aA.value);return az.winningRev=az.winningRev||jg(az),az.seq?aD():void aB()}}}var ak=aa.name,ap=null;ab._meta=null,ab.type=function(){return"idb"},ab._id=ge(function(au){au(null,ab._meta.instanceId)}),ab._bulkDocs=function(aw,av,au){i2(aa,aw,av,ab,ap,gS,au)},ab._get=function(az,av,aw){function aB(){aw(ay,{doc:aA,metadata:aC,ctx:au})}var aA,aC,ay,au=av.ctx;if(!au){var ax=hz(ap,[gv,g2,gr],"readonly");if(ax.error){return aw(ax.error)}au=ax.txn}au.objectStore(gv).get(az).onsuccess=function(aG){if(aC=hL(aG.target.result),!aC){return ay=iO(ju,"missing"),aB()}if(iT(aC)&&!av.rev){return ay=iO(ju,"deleted"),aB()}var aE=au.objectStore(g2),aD=av.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=z(aA)),aA?void aB():(ay=iO(ju,"missing"),aB())}}},ab._getAttachment=function(az,av,aw,aB,aA){var aC;if(aB.ctx){aC=aB.ctx}else{var ay=hz(ap,[gv,g2,gr],"readonly");if(ay.error){return aA(ay.error)}aC=ay.txn}var au=aw.digest,ax=aw.content_type;aC.objectStore(gr).get(au).onsuccess=function(aE){var aD=aE.target.result.body;Y(aD,ax,aB.binary,function(aF){aA(null,aF)})}},ab._info=function(av){if(null===ap||!i0.has(ak)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var ax,aw,az=hz(ap,[g2],"readonly");if(az.error){return av(az.error)}var ay=az.txn,au=ay.objectStore(g2).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,aw=ab._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:ax,idb_attachment_format:ab._meta.blobSupport?"binary":"base64"})}},ab._allDocs=function(av,au){hq(av,ab,ap,au)},ab._changes=function(aK){function aB(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aw=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=az.get(aU);aT.onsuccess=function(aV){aO(z(aV.target.result))}}function aO(aU){var aT=aK.processChange(aU,aN,aK);aT.seq=aN.seq;var aV=aC(aT);return"object"==typeof aV?aK.complete(aV):(aV&&(aG++,aH&&au.push(aT),aK.attachments&&aK.include_docs?jq(aU,aK,aJ,function(){hN([aT],aK.binary).then(function(){aK.onChange(aT)})}):aK.onChange(aT)),void (aG!==av&&aS["continue"]()))}var aQ=z(aS.value),aR=aS.key;if(ax&&!ax.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aI.get(aQ._id).onsuccess=function(aT){aN=hL(aT.target.result),ay.set(aQ._id,aN),aM()})}function aL(aN){var aM=aN.target.result;aM&&aB(aM)}function aF(){var aM=[gv,g2];aK.attachments&&aM.push(gr);var aN=hz(ap,aM,"readonly");if(aN.error){return aK.complete(aN.error)}aJ=aN.txn,aJ.onabort=gh(aK.complete),aJ.oncomplete=aE,aD=aJ.objectStore(g2),aI=aJ.objectStore(gv),az=aD.index("_doc_id_rev");var aO;aO=aK.descending?aD.openCursor(null,"prev"):aD.openCursor(IDBKeyRange.lowerBound(aK.since,!0)),aO.onsuccess=aL}function aE(){function aM(){aK.complete(null,{results:au,last_seq:aw})}!aK.continuous&&aK.attachments?hN(au).then(aM):aM()}if(aK=fp(aK),aK.continuous){var aA=ak+":"+iv();return gS.addListener(ak,aA,ab,aK),gS.notify(ak),{cancel:function(){gS.removeListener(ak,aA)}}}var ax=aK.doc_ids&&new g1.Set(aK.doc_ids);aK.since=aK.since||0;var aw=aK.since,av="limit" in aK?aK.limit:-1;0===av&&(av=1);var aH;aH="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aJ,aD,aI,az,au=[],aG=0,aC=a9(aK),ay=new g1.Map;aF()},ab._close=function(au){return null===ap?au(iO(i8)):(ap.close(),i0["delete"](ak),ap=null,void au())},ab._getRevisionTree=function(av,au){var aw=hz(ap,[gv],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(gv).get(av);ay.onsuccess=function(aA){var az=hL(aA.target.result);az?au(null,az.rev_tree):au(iO(ju))}},ab._doCompaction=function(aA,av,aw){var au=[gv,g2,gr,gq],ax=hz(ap,au,"readwrite");if(ax.error){return aw(ax.error)}var az=ax.txn,ay=az.objectStore(gv);ay.get(aA).onsuccess=function(aC){var aE=hL(aC.target.result);ga(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),hv(av,aA,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(gv).put(ib(aE,aD,aB))},az.onabort=gh(aw),az.oncomplete=function(){aw()}},ab._getLocal=function(av,au){var aw=hz(ap,[jz],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(jz).get(av);ay.onerror=gh(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(iO(ju))}},ab._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hz(ap,[jz],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=gh(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(jz);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(iO(h7))}}):(au=ax.add(ay),au.onerror=function(aE){av(iO(h7)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ab._removeLocal=function(az,av,aw){"function"==typeof av&&(aw=av,av={});var aB=av.ctx;if(!aB){var aA=hz(ap,[jz],"readwrite");if(aA.error){return aw(aA.error)}aB=aA.txn,aB.oncomplete=function(){aC&&aw(null,aC)}}var aC,ay=az._id,au=aB.objectStore(jz),ax=au.get(ay);ax.onerror=gh(aw),ax.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===az._rev?(au["delete"](ay),aC={ok:!0,id:ay,rev:"0-0"},av.ctx&&aw(null,aC)):aw(iO(ju))}},ab._destroy=function(au,aw){gS.removeAllListeners(ak);var ax=hV.get(ak);ax&&ax.result&&(ax.result.close(),i0["delete"](ak));var av=indexedDB.deleteDatabase(ak);av.onsuccess=function(){hV["delete"](ak),gf()&&ak in localStorage&&delete localStorage[ak],aw(null,{ok:!0})},av.onerror=gh(aw)};var ad=i0.get(ak);if(ad){return ap=ad.idb,ab._meta=ad.global,void g9.nextTick(function(){al(null,ab)})}var t;t=aa.storage?ji(ak,aa.storage):indexedDB.open(ak,h8),hV.set(ak,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return aj(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&am(az),av.oldVersion<4&&ag(az);var ay=[ah,ac,af,aq],au=av.oldVersion;ax()},t.onsuccess=function(az){ap=az.target.result,ap.onversionchange=function(){ap.close(),i0["delete"](ak)},ap.onabort=function(aA){gl("error","Database has a global failure",aA.target.error),ap.close(),i0["delete"](ak)};var aw=ap.transaction([J,jx,gv],"readwrite"),ay=aw.objectStore(J).get(J),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(ab._meta={name:ak,instanceId:au,blobSupport:av,docCount:ax},i0.set(ak,{idb:ap,global:ab._meta}),al(null,ab))},aA=aB.target.result||{id:J};ak+"_id" in aA?(au=aA[ak+"_id"],aD()):(au=iv(),aA[ak+"_id"]=au,aw.objectStore(J).put(aA).onsuccess=function(){aD()}),iB||(iB=jn(aw)),iB.then(function(aE){av=aE,aD()});var aC=aw.objectStore(gv).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";gl("error",au),al(iO(gW,au))}}function ji(aa,ab){try{return indexedDB.open(aa,{version:h8,storage:ab})}catch(t){return indexedDB.open(aa,h8)}}function iI(t){t.adapter("idb",S,!0)}function iw(t){return decodeURIComponent(escape(t))}function hT(t){return 65>t?t-48:t-55}function jy(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(hT(ab.charCodeAt(t++))<<4|hT(ab.charCodeAt(t++)))}return ac}function hW(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(hT(ab.charCodeAt(t+2))<<12|hT(ab.charCodeAt(t+3))<<8|hT(ab.charCodeAt(t))<<4|hT(ab.charCodeAt(t+1))),t+=4}return ac}function js(aa,t){return"UTF-8"===t?iw(jy(aa,0,aa.length)):hW(aa,0,aa.length)}function gj(t){return"'"+t+"'"}function iH(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function ig(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jh(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hk(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function ft(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function hX(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function jf(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+T+" WHERE seq IN "+ft(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+T+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+T+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new g1.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+T+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+jv+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(aj){var ah="SELECT seq FROM "+iL+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ad,aj],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+iL+" WHERE seq=?",[ak],ac)})})}}function hm(t){return function(ad){gl("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(iO(D,ab,ac))}}function gn(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function jc(af,aj,aB,av,au,t,aa){function ax(){return ah?aa(ah):(t.notify(av._name),av._docCount=-1,void aa(null,am))}function ak(aD,aE){var aC="SELECT count(*) as cnt FROM "+jv+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=iO(gT,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ad(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ak(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ag(aI,aP,aF,aK,aM,aD,aN,aQ){function aG(){function aY(bc,bb){function ba(){return ++bd===bf.length&&bb(),!1}function aZ(bi){var bh="INSERT INTO "+T+" (digest, seq) VALUES (?,?)",bj=[aR._attachments[bi].digest,bc];ap.executeSql(bh,bj,ba,ba)}var bd=0,bf=Object.keys(aR._attachments||{});if(!bf.length){return bb()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aR=aI.data,aW=aK?1:0,aT=aR._id,aX=aR._rev,aV=jh(aR),aU="INSERT INTO "+iL+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aS=[aT,aX,aV,aW];ap.executeSql(aU,aS,function(bb,aZ){var ba=aZ.insertId;aY(ba,function(){aH(bb,ba)})},function(){var aZ=hX("seq",iL,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aT,aX],function(bf,bd){var bc=bd.rows.item(0).seq,bb="UPDATE "+iL+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aV,aW,aT,aX];bf.executeSql(bb,ba,function(bg){aY(bc,function(){aH(bg,bc)})})}),!1})}function aJ(aR){aL||(aR?(aL=aR,aQ(aL)):aC===aE.length&&aG())}function aO(aR){aC++,aJ(aR)}function aH(aW,aX){var aU=aI.metadata.id,aV=aI.stemmedRevs||[];aM&&av.auto_compaction&&(aV=gz(aI.metadata).concat(aV)),aV.length&&jf(aV,aU,aW),aI.metadata.seq=aX,delete aI.metadata.rev;var aT=aM?"UPDATE "+B+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+iL+" WHERE doc_id="+B+".id AND rev=?) WHERE id=?":"INSERT INTO "+B+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aS=O(aI.metadata),aR=aM?[aS,aX,aP,aU]:[aU,aX,aX,aS];aW.executeSql(aT,aR,function(){am[aN]={ok:!0,id:aI.metadata.id,rev:aP},ac.set(aU,aI.metadata),aQ()})}var aL=null,aC=0;aI.data._id=aI.metadata.id,aI.data._rev=aI.metadata.rev;var aE=Object.keys(aI.data._attachments||{});aK&&(aI.data._deleted=!0),aE.forEach(function(aU){var aS=aI.data._attachments[aU];if(aS.stub){aC++,aJ()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aP,10);var aT=aS.digest;aw(aT,aR,aO)}}),aE.length||aG()}function ab(){jA(af.revs_limit,aq,av,ac,ap,am,ag,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&gk(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+B+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=Z(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function aw(aD,aF,aC){var aE="SELECT digest FROM "+jv+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+jv+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iH(aF)],function(){aC()},function(){return aC(),!1}))})}var aA=aB.new_edits,al=aj.docs,aq=al.map(function(aC){if(aC._id&&gk(aC._id)){return aC}var aD=fW(aC,aA);return aD}),ay=aq.filter(function(aC){return aC.error});if(ay.length){return aa(ay[0])}var ap,ah,am=new Array(aq.length),ac=new g1.Map;gI(aq,"binary",function(aC){return aC?aa(aC):void au.transaction(function(aD){ap=aD,ad(function(aE){aE?ah=aE:az(ab)})},hm(aa),ax)})}function gQ(t){return t.websql(t.name,t.version,t.description,t.size)}function ff(aa){try{return{db:gQ(aa)}}catch(t){return{error:t}}}function hQ(aa){var t=iR.get(aa.name);return t||(t=ff(aa),iR.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function ir(af,ac,ah,aa,aj){function ag(){++ab===t.length&&aj&&aj()}function ad(am,ak){var al=am._attachments[ak],ap={binary:ac.binary,ctx:aa};ah._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=gc.extend(fi(al,["digest","content_type"]),{data:au}),ag()})}var t=Object.keys(af._attachments||{});if(!t.length){return aj&&aj()}var ab=0;t.forEach(function(ak){ac.attachments&&ac.include_docs?ad(af,ak):(af._attachments[ak].stub=!0,ag())})}function r(ad,az){function ac(){gf()&&(window.localStorage["_pouch__websqldb_"+aj._name]=!0),az(null,aj)}function ay(aD,aE){aD.executeSql(ie),aD.executeSql("ALTER TABLE "+iL+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(i9),aD.executeSql("ALTER TABLE "+B+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+B+" (local, id)");var aF="SELECT "+B+".winningseq AS seq, "+B+".json AS metadata FROM "+iL+" JOIN "+B+" ON "+iL+".seq = "+B+".winningseq";aD.executeSql(aF,[],function(aK,aG){for(var aL=[],aI=[],aH=0;aH<aG.rows.length;aH++){var aN=aG.rows.item(aH),aM=aN.seq,aJ=JSON.parse(aN.metadata);iT(aJ)&&aL.push(aM),gk(aJ.id)&&aI.push(aJ.id)}aK.executeSql("UPDATE "+B+"SET local = 1 WHERE id IN "+ft(aI.length),aI,function(){aK.executeSql("UPDATE "+iL+" SET deleted = 1 WHERE seq IN "+ft(aL.length),aL,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+a2+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+B+".id AS id, "+iL+".json AS data FROM "+iL+" JOIN "+B+" ON "+iL+".seq = "+B+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+a2+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+B+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+iL+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function au(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aJ=aI.shift(),aL=js(aJ.hex,aB),aO=aL.lastIndexOf("::"),aK=aL.substring(0,aO),aM=aL.substring(aO+2),aN="UPDATE "+iL+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aN,[aK,aM,aL],function(){aH()})}aH()}var aF="ALTER TABLE "+iL+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+iL+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(gH,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+iL;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ag(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+jv;aH.executeSql(aI,[],function(aK,aO){function aL(){var aP=hX(h9+", "+B+".id AS id",[B,iL],jj,null,B+".id ");aP+=" LIMIT "+aN+" OFFSET "+aM,aM+=aN,aK.executeSql(aP,[],function(ba,aT){function aY(bc,bd){var bf=aQ[bc]=aQ[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aT.rows.length){return aG(ba)}for(var aQ={},aW=0;aW<aT.rows.length;aW++){for(var aU=aT.rows.item(aW),aV=hk(aU.data,aU.id,aU.rev),aZ=Object.keys(aV._attachments||{}),aX=0;aX<aZ.length;aX++){var aS=aV._attachments[aZ[aX]];aY(aS.digest,aU.seq)}}var aR=[];if(Object.keys(aQ).forEach(function(bc){var bd=aQ[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aL()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+T+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aL()})})})}var aJ=aO.rows.item(0).cnt;if(!aJ){return aG(aK)}var aM=0,aN=10;aL()})}var aF="CREATE TABLE IF NOT EXISTS "+T+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(hJ,[],function(aI){aI.executeSql(ce,[],aD)})})}function ab(aE,aF){var aD="ALTER TABLE "+jv+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ak(aE,aF){var aD="ALTER TABLE "+B+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+B+" SET max_seq=(SELECT MAX(seq) FROM "+iL+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+B+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function am(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;aB=2===aG.length?"UTF-8":"UTF-16",aE()})}function ah(){for(;af.length>0;){var aD=af.pop();aD(null,aw)}}function aa(aF,aJ){if(0===aJ){var aM="CREATE TABLE IF NOT EXISTS "+h6+" (dbid, db_version INTEGER)",aD="CREATE TABLE IF NOT EXISTS "+jv+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aG="CREATE TABLE IF NOT EXISTS "+T+" (digest, seq INTEGER)",aI="CREATE TABLE IF NOT EXISTS "+B+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aH="CREATE TABLE IF NOT EXISTS "+iL+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aN="CREATE TABLE IF NOT EXISTS "+a2+" (id UNIQUE, rev, json)";aF.executeSql(aD),aF.executeSql(aN),aF.executeSql(aG,[],function(){aF.executeSql(ce),aF.executeSql(hJ)}),aF.executeSql(aI,[],function(){aF.executeSql(ie),aF.executeSql(aH,[],function(){aF.executeSql(i9),aF.executeSql(gH),aF.executeSql(aM,[],function(){var aP="INSERT INTO "+h6+" (db_version, dbid) VALUES (?,?)";aw=iv();var aQ=[a6,aw];aF.executeSql(aP,aQ,function(){ah()})})})})}else{var aL=function(){var aQ=a6>aJ;aQ&&aF.executeSql("UPDATE "+h6+" SET db_version = "+a6);var aP="SELECT dbid FROM "+h6;aF.executeSql(aP,[],function(aR,aS){aw=aS.rows.item(0).dbid,ah()})},aO=[ay,aq,au,ag,ab,ak,aL],aE=aJ,aK=function(aP){aO[aE-1](aP,aK),aE++};aK(aF)}}function av(){ax.transaction(function(aD){am(aD,function(){ap(aD)})},hm(az),ac)}function ap(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+h6;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+h6,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;aa(aI,aH)}):aF.executeSql("ALTER TABLE "+h6+" ADD COLUMN db_version INTEGER",[],function(){aa(aF,1)}):aa(aF,0)})}function aC(aE,aF){if(-1!==aj._docCount){return aF(aj._docCount)}var aD=hX("COUNT("+B+".id) AS 'num'",[B,iL],jj,iL+".deleted=0");aE.executeSql(aD,[],function(aG,aH){aj._docCount=aH.rows.item(0).num,aF(aj._docCount)})}var aB,aj=this,aw=null,al=gn(ad),af=[];aj._docCount=-1,aj._name=ad.name;var t=gc.extend({},ad,{version:ic,description:ad.name,size:al}),aA=hQ(t);if(aA.error){return hm(az)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),av(),aj.type=function(){return"websql"},aj._id=ge(function(aD){aD(null,aw)}),aj._info=function(aD){ax.readTransaction(function(aE){aC(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+iL;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:ax._sqlitePlugin,websql_encoding:aB})})})},hm(aD))},aj._bulkDocs=function(aF,aD,aE){jc(ad,aF,aD,aj,ax,il,aE)},aj._get=function(aK,aJ,aM){function aF(){aM(aH,{doc:aE,metadata:aL,ctx:aD})}var aE,aL,aH,aD=aJ.ctx;if(!aD){return ax.readTransaction(function(aN){aj._get(aK,gc.extend({ctx:aN},aJ),aM)})}var aG,aI;aJ.rev?(aG=hX(h9,[B,iL],B+".id="+iL+".doc_id",[iL+".doc_id=?",iL+".rev=?"]),aI=[aK,aJ.rev]):(aG=hX(h9,[B,iL],jj,B+".id=?"),aI=[aK]),aD.executeSql(aG,aI,function(aP,aO){if(!aO.rows.length){return aH=iO(ju,"missing"),aF()}var aN=aO.rows.item(0);return aL=Z(aN.metadata),aN.deleted&&!aJ.rev?(aH=iO(ju,"deleted"),aF()):(aE=hk(aN.data,aL.id,aN.rev),void aF())})},aj._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(B+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(B+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(B+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(B+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(iL+".deleted = 0"),ax.readTransaction(function(aR){aC(aR,function(aT){if(aM=aT,0!==aO){var aS=hX(h9,[B,iL],jj,aE,B+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aU,ba){for(var bb=0,aX=ba.rows.length;aX>bb;bb++){var aV=ba.rows.item(bb),bc=Z(aV.metadata),aY=bc.id,aW=hk(aV.data,aY,aV.rev),aZ=aW._rev,bd={id:aY,key:aY,value:{rev:aZ}};if(aJ.include_docs&&(bd.doc=aW,bd.doc._rev=aZ,aJ.conflicts&&(bd.doc._conflicts=g0(bc)),ir(bd.doc,aJ,aj,aU)),aV.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},hm(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},aj._changes=function(aD){function aK(){var aN=B+".json AS metadata, "+B+".max_seq AS maxSeq, "+iL+".json AS winningDoc, "+iL+".rev AS winningRev ",aM=B+" JOIN "+iL,aO=B+".id="+iL+".doc_id AND "+B+".winningseq="+iL+".seq",aP=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aP.push(B+".id IN "+ft(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aL="maxSeq "+(aG?"DESC":"ASC"),aS=hX(aN,aM,aO,aP,aL),aT=a9(aD);aD.view||aD.filter||(aS+=" LIMIT "+aJ);var aQ=aD.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(ba,aY){function bb(bg){return function(){aD.onChange(bg)}}for(var aV=0,aW=aY.rows.length;aW>aV;aV++){var aX=aY.rows.item(aV),aZ=Z(aX.metadata);aQ=aX.maxSeq;var bf=hk(aX.winningDoc,aZ.id,aX.winningRev),bc=aD.processChange(bf,aZ,aD);bc.seq=aX.maxSeq;var bd=aT(bc);if("object"==typeof bd){return aD.complete(bd)}if(bd&&(aH++,aE&&aF.push(bc),aD.attachments&&aD.include_docs?ir(bf,aD,aj,ba,bb(bc)):bb(bc)()),aH===aJ){break}}})},hm(aD.complete),function(){aD.continuous||aD.complete(null,{results:aF,last_seq:aQ})})}if(aD=fp(aD),aD.continuous){var aI=aj._name+":"+iv();return il.addListener(aj._name,aI,aj,aD),il.notify(aj._name),{cancel:function(){il.removeListener(aj._name,aI)}}}var aG=aD.descending;aD.since=aD.since&&!aG?aD.since:0;var aJ="limit" in aD?aD.limit:-1;0===aJ&&(aJ=1);var aE;aE="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aF=[],aH=0;aK()},aj._close=function(aD){aD()},aj._getAttachment=function(aK,aJ,aM,aF,aE){var aL,aH=aF.ctx,aD=aM.digest,aG=aM.content_type,aI="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+jv+" WHERE digest=?";aH.executeSql(aI,[aD],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?ig(aO.body):js(aO.body,aB);aL=aF.binary?dt(aN,aG):gu(aN),aE(null,aL)})},aj._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+B+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=Z(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(iO(ju))}})})},aj._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+B+" WHERE id = ?";aH.executeSql(aG,[aE],function(aJ,aL){var aK=Z(aL.rows.item(0).metadata);ga(aK.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aI="UPDATE "+B+" SET json = ? WHERE id = ?";aJ.executeSql(aI,[O(aK),aE])}),jf(aF,aE,aH)},hm(aD),function(){aD()}):aD()},aj._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+a2+" WHERE id=?";aF.executeSql(aG,[aD],function(aI,aK){if(aK.rows.length){var aJ=aK.rows.item(0),aH=hk(aJ.json,aD,aJ.rev);aE(null,aH)}else{aE(iO(ju))}})})},aj._putLocal=function(aJ,aF,aL){function aE(aO){var aM,aN;aK?(aM="UPDATE "+a2+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aD,aG,aH,aK]):(aM="INSERT INTO "+a2+" (id, rev, json) VALUES (?,?,?)",aN=[aH,aD,aG]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aI={ok:!0,id:aH,rev:aD},aF.ctx&&aL(null,aI)):aL(iO(h7))},function(){return aL(iO(h7)),!1})}"function"==typeof aF&&(aL=aF,aF={}),delete aJ._revisions;var aD,aK=aJ._rev,aH=aJ._id;aD=aK?aJ._rev="0-"+(parseInt(aK.split("-")[1],10)+1):aJ._rev="0-1";var aI,aG=jh(aJ);aF.ctx?aE(aF.ctx):ax.transaction(aE,hm(aL),function(){aI&&aL(null,aI)})},aj._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+a2+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(iO(ju))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,hm(aH),function(){aD&&aH(null,aD)})},aj._destroy=function(aD,aE){il.removeAllListeners(aj._name),ax.transaction(function(aF){var aG=[B,iL,jv,h6,a2,T];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},hm(aE),function(){gf()&&(delete window.localStorage["_pouch__websqldb_"+aj._name],delete window.localStorage[aj._name]),aE(null,{ok:!0})})}}function an(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gY(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var aa=gf(),ab="_pouch__websqldb_valid_"+navigator.userAgent;if(aa&&localStorage[ab]){return"1"===localStorage[ab]}var t=an();return aa&&(localStorage[ab]=t?"1":"0"),t}function fu(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gY()}function gK(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=gc.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function l(ab,t){var aa=gK(ab),ac=gc.extend({websql:aa},ab);r.call(this,ac,t)}function ip(t){t.adapter("websql",l,!0)}function P(){for(var ab={},t=new hg(function(af,ad){ab.resolve=af,ab.reject=ad}),aa=new Array(arguments.length),ac=0;ac<aa.length;ac++){aa[ac]=arguments[ac]}return ab.promise=t,hg.resolve().then(function(){return fetch.apply(null,aa)}).then(function(ad){ab.resolve(ad)})["catch"](function(ad){ab.reject(ad)}),ab}function hZ(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?y(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=P(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function ev(af,ac){var ah,aa,aj=!1,ag=function(){ah.abort()},ad=function(){aj=!0,ah.abort()};ah=af.xhr?new af.xhr:new XMLHttpRequest;try{ah.open(af.method,af.url)}catch(t){ac(t,{statusCode:413})}ah.withCredentials="withCredentials" in af?af.withCredentials:!0,"GET"===af.method?delete af.headers["Content-Type"]:af.json&&(af.headers.Accept="application/json",af.headers["Content-Type"]=af.headers["Content-Type"]||"application/json",af.body&&af.processData&&"string"!=typeof af.body&&(af.body=JSON.stringify(af.body))),af.binary&&(ah.responseType="arraybuffer"),"body" in af||(af.body=null);for(var ab in af.headers){af.headers.hasOwnProperty(ab)&&ah.setRequestHeader(ab,af.headers[ab])}return af.timeout>0&&(aa=setTimeout(ad,af.timeout),ah.onprogress=function(){clearTimeout(aa),4!==ah.readyState&&(aa=setTimeout(ad,af.timeout))},"undefined"!=typeof ah.upload&&(ah.upload.onprogress=ah.onprogress)),ah.onreadystatechange=function(){if(4===ah.readyState){var ak={statusCode:ah.status};if(ah.status>=200&&ah.status<300){var am;am=af.binary?I([ah.response||""],{type:ah.getResponseHeader("Content-Type")}):ah.responseText,ac(null,ak,am)}else{var ap={};if(aj){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ah.response)}catch(al){}}ac(ap,ak)}}},af.body&&af.body instanceof Blob?y(af.body,function(ak){ah.send(ak)}):ah.send(af.body),{abort:ag}}function g(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function ar(aa,t){return gZ||aa.xhr?ev(aa,t):hZ(aa,t)}function i6(){return""}function V(ac,t){function aa(ah,aj,ag){if(!ac.binary&&ac.json&&"string"==typeof ah){try{ah=JSON.parse(ah)}catch(af){return ag(af)}}Array.isArray(ah)&&(ah=ah.map(function(ak){return ak.error||ak.missing?iC(ak):ak})),ac.binary&&C(ah,aj),ag(null,ah,aj)}function ad(ag,aj){var al,ah;if(ag.code&&ag.status){var af=new Error(ag.message||ag.code);return af.status=ag.status,aj(af)}if(ag.message&&"ETIMEDOUT"===ag.message){return aj(ag)}try{al=JSON.parse(ag.responseText),ah=iC(al)}catch(ak){ah=iC(ag)}aj(ah)}ac=fp(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=gc.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),ar(ac,function(am,ah,ak){if(am){return am.status=ah?ah.statusCode:400,ad(am,t)}var ag,aj=ah.headers&&ah.headers["content-type"],al=ak||i6();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof al&&(/json/.test(aj)||/^[\s]*\{/.test(al)&&/\}[\s]*$/.test(al))){try{al=JSON.parse(al.toString())}catch(af){}}ah.statusCode>=200&&ah.statusCode<300?aa(al,ah,t):(ag=iC(al),ag.status=ah.statusCode,t(ag))})}function fw(ad,aa){var ag=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aj=-1!==ag.indexOf("safari")&&-1===ag.indexOf("chrome"),ah=-1!==ag.indexOf("msie"),af=-1!==ag.indexOf("edge"),ac=aj||(ah||af)&&"GET"===ad.method,ak="cache" in ad?ad.cache:!0,ab=/^blob:/.test(ad.url);if(!ab&&(ac||!ak)){var t=-1!==ad.url.indexOf("?");ad.url+=(t?"&":"?")+"_nonce="+Date.now()}return V(ad,aa)}function ey(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=hA(ab.data,ab.content_type)})}function iM(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function gA(t){return t._attachments&&Object.keys(t._attachments)?hg.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hg(function(ac){iJ(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hg.resolve()}function ha(aa){var ab=iu(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function hd(aa,t){return hr(aa,aa.db+"/"+t)}function hr(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function a0(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function a4(aj,af){function ab(ax,ay,aw){var aA=ax.ajax||{},az=gc.extend(fp(ag),aA,ay);return U(az.method+" "+az.url),ap._ajax(az,aw)}function ah(ax,aw){return new hg(function(az,ay){ab(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(ax,aw){return fy(ax,hK(function(ay){ac().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ac(){if(aj.skipSetup||aj.skip_setup){return hg.resolve()}if(ad){return ad}var aw={method:"GET",url:ak};return ad=ah({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(jd(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:ak})):hg.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hg.reject(ax)}),ad["catch"](function(){ad=null}),ad}function aa(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ap=this,al=ha;aj.getHost&&(al=aj.getHost);var t=al(aj.name,aj),ak=hd(t,"");aj=fp(aj);var ag=aj.ajax||{};if(ap.getUrl=function(){return ak},ap.getHeaders=function(){return ag.headers||{}},aj.auth||t.auth){var au=aj.auth||t.auth,av=au.username+":"+au.password,am=gu(unescape(encodeURIComponent(av)));ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+am}ap._ajax=fw;var ad;setTimeout(function(){af(null,ap)}),ap.type=function(){return"http"},ap.id=aq("id",function(aw){ab({},{method:"GET",url:hr(t,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+t.db:hd(t,"");aw(null,ay)})}),ap.request=aq("request",function(ax,aw){ax.url=hd(t,ax.url),ab({},ax,aw)}),ap.compact=aq("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=fp(ax),ab(ax,{url:hd(t,"_compact"),method:"POST"},function(){function ay(){ap.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ap.bulkGet=fy("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ab({},{url:hd(t,"_bulk_get"+a0(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aJ(aK){return function(aM,aL){aG[aK]=aL.results,++aI===aE&&aA(null,{results:gd(aG)})}}for(var aF=hp,aE=Math.ceil(aC.docs.length/aF),aI=0,aG=new Array(aE),aH=0;aE>aH;aH++){var aD=fi(aC,["revs","attachments"]);aD.ajax=ag,aD.docs=aC.docs.slice(aH*aF,Math.min(aC.docs.length,(aH+1)*aF)),fd(ay,aD,aJ(aH))}}var ay=this,aw=hr(t,""),az=hh[aw];"boolean"!=typeof az?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(hh[aw]=!1,jd(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{hh[aw]=!0,aA(null,aE)}}):az?aB(aA):ax()}),ap._info=function(aw){ac().then(function(){ab({},{method:"GET",url:hd(t,"")},function(ay,ax){return ay?aw(ay):(ax.host=hd(t,""),void aw(null,ax))})})["catch"](aw)},ap.get=aq("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hg.all(aF.map(function(aG){var aI=aD[aG],aH=iM(aE._id)+"/"+aa(aG)+"?rev="+aE._rev;return ah(aC,{method:"GET",url:hd(t,aH),binary:!0}).then(function(aJ){return aC.binary?aJ:new hg(function(aK){iJ(aJ,aK)})}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?hg.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=fp(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=iM(aA);var aw={method:"GET",url:hd(t,aA+a0(az))};ah(aC,aw).then(function(aD){return hg.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ap.remove=aq("remove",function(ax,aB,az,aw){var ay;"string"==typeof aB?(ay={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(ay=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var aA=ay._rev||az.rev;ab(az,{method:"DELETE",url:hd(t,iM(ay._id))+"?rev="+aA},aw)}),ap.getAttachment=aq("getAttachment",function(ax,az,aB,ay){"function"==typeof aB&&(ay=aB,aB={});var aA=aB.rev?"?rev="+aB.rev:"",aw=hd(t,iM(ax))+"/"+aa(az)+aA;ab(aB,{method:"GET",url:aw,binary:!0},ay)}),ap.removeAttachment=aq("removeAttachment",function(ax,ay,aA,aw){var az=hd(t,iM(ax)+"/"+aa(ay))+"?rev="+aA;ab({},{method:"DELETE",url:az},aw)}),ap.putAttachment=aq("putAttachment",function(aC,ay,aw,aG,aE,ax){"function"==typeof aE&&(ax=aE,aE=aG,aG=aw,aw=null);var az=iM(aC)+"/"+aa(ay),aA=hd(t,az);if(aw&&(aA+="?rev="+aw),"string"==typeof aG){var aF;try{aF=fm(aG)}catch(aB){return ax(iO(hy,"Attachment is not a valid base64 string"))}aG=aF?dt(aF,aE):""}var aD={headers:{"Content-Type":aE},method:"PUT",url:aA,processData:!1,body:aG,timeout:ag.timeout||60000};ab({},aD,ax)}),ap._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,ac().then(function(){return hg.all(aw.docs.map(gA))}).then(function(){ab(ay,{method:"POST",url:hd(t,"_bulk_docs"),body:aw},function(aA,az){return aA?ax(aA):(az.forEach(function(aB){aB.ok=!0}),void ax(null,az))})})["catch"](ax)},ap.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=fp(aA);var aB,ax={},ay="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var aw=a0(ax);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=iY?aw+="&"+az:(ay="POST",aB={keys:aA.keys})}ah(aA,{method:ay,url:hd(t,"_all_docs"+aw),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ey),aC(null,aD)})["catch"](aC)}),ap._changes=function(aH){var az="batch_size" in aH?aH.batch_size:o;aH=fp(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ag?ag.timeout:30000;var aB,aw=aH.timeout?{timeout:aH.timeout-5000}:{},aF="undefined"!=typeof aH.limit?aH.limit:!1;aB="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var ay=aF;if(aH.style&&(aw.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aw.include_docs=!0),aH.attachments&&(aw.attachments=!0),aH.continuous&&(aw.feed="longpoll"),aH.conflicts&&(aw.conflicts=!0),aH.descending&&(aw.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aw.heartbeat=aH.heartbeat):aw.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aw.filter=aH.filter),aH.view&&"string"==typeof aH.view&&(aw.filter="_view",aw.view=aH.view),aH.query_params&&"object"==typeof aH.query_params){for(var aD in aH.query_params){aH.query_params.hasOwnProperty(aD)&&(aw[aD]=aH.query_params[aD])}}var aJ,aG="GET";if(aH.doc_ids){aw.filter="_doc_ids";var aI=JSON.stringify(aH.doc_ids);aI.length<iY?aw.doc_ids=aI:(aG="POST",aJ={doc_ids:aH.doc_ids})}var aK,ax,aA=function(aM,aN){if(!aH.aborted){aw.since=aM,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aH.descending?aF&&(aw.limit=ay):aw.limit=!aF||ay>az?az:ay;var aL={method:aG,url:hd(t,"_changes"+a0(aw)),timeout:aH.timeout,body:aJ};ax=aM,aH.aborted||ac().then(function(){aK=ab(aH,aL,aN)})["catch"](aN)}},aC={results:[]},aE=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aC.last_seq=aL.last_seq;var aP={};aP.query=aH.query_params,aL.results=aL.results.filter(function(aR){ay--;var aQ=a9(aH)(aR);return aQ&&(aH.include_docs&&aH.attachments&&aH.binary&&ey(aR),aB&&aC.results.push(aR),aH.onChange(aR)),aQ})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(ax=aL.last_seq);var aO=aF&&0>=ay||aL&&az>aM||aH.descending;(!aH.continuous||aF&&0>=ay)&&aO?aH.complete(null,aC):setTimeout(function(){aA(ax,aE)},0)}};return aA(aH.since||0,aE),{cancel:function(){aH.aborted=!0,aK&&aK.abort()}}},ap.revsDiff=aq("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),ab(ay,{method:"POST",url:hd(t,"_revs_diff"),body:aw},ax)}),ap._close=function(aw){aw()},ap._destroy=function(ax,aw){ab(ax,{url:hd(t,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function gF(t){t.adapter("http",a4,!1),t.adapter("https",a4,!1)}function v(){this.promise=new hg(function(t){t()})}function iN(ab){var t=ab.db,ah=ab.viewName,ac=ab.map,aa=ab.reduce,af=ab.temporary,ag=ac.toString()+(aa&&aa.toString())+"undefined";if(!af&&t._cachedViews){var ad=t._cachedViews[ag];if(ad){return hg.resolve(ad)}}return t.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ah;-1===aq.indexOf("/")&&(aq=ah+"/"+ah);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(af?"temp":ci(ag));return H(t,"_local/mrviews",al).then(function(){return t.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:t,adapter:t.adapter,mapFun:ac,reduceFun:aa};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,af||(t._cachedViews=t._cachedViews||{},t._cachedViews[ag]=aq,aq.db.once("destroyed",function(){delete t._cachedViews[ag]})),aq})})})})}function g7(ac,t,aa,ad,ab,af){return hc("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function es(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function j(t){return 1===t.length&&/^1-/.test(t[0].rev)}function gV(aa,ab){try{aa.emit("error",ab)}catch(t){gl("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),gl("error",ab)}}function gJ(ab,t,aa){try{return{output:t.apply(null,aa)}}catch(ac){return gV(ab,ac),{error:ac}}}function br(aa,ab){var t=hS.collate(aa.key,ab.key);return 0!==t?t:hS.collate(aa.value,ab.value)}function ao(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function fe(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function iQ(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=hA(ac.data,ac.content_type)})})}function n(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&iQ(aa),aa}}function A(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new gm(t)}function fr(ab){for(var t=0,ah=0,ac=ab.length;ac>ah;ah++){var aa=ab[ah];if("number"!=typeof aa){if(!Array.isArray(aa)){throw A("_sum")}t="number"==typeof t?[t]:t;for(var af=0,ag=aa.length;ag>af;af++){var ad=aa[af];if("number"!=typeof ad){throw A("_sum")}"undefined"==typeof t[af]?t.push(ad):t[af]+=ad}}else{"number"==typeof t?t+=aa:t[0]+=aa}}return t}function fb(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function gG(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function h4(t){return t.group_level=gG(t.group_level),t.limit=gG(t.limit),t.skip=gG(t.skip),t}function k(t){if(t){if("number"!=typeof t){return new F('Invalid value for integer: "'+t+'"')}if(0>t){return new F('Invalid value for positive integer: "'+t+'"')}}}function iE(ab,t){var aa=ab.descending?"endkey":"startkey",ac=ab.descending?"startkey":"endkey";if("undefined"!=typeof ab[aa]&&"undefined"!=typeof ab[ac]&&hS.collate(ab[aa],ab[ac])>0){throw new F("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(t.reduce&&ab.reduce!==!1){if(ab.include_docs){throw new F("{include_docs:true} is invalid for reduce")}if(ab.keys&&ab.keys.length>1&&!ab.group&&!ab.group_level){throw new F("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=k(ab[af]);if(ad){throw ad}})}function fY(af,ac,ah){var aa,aj=[],ag="GET";if(fb("reduce",ah,aj),fb("include_docs",ah,aj),fb("attachments",ah,aj),fb("limit",ah,aj),fb("descending",ah,aj),fb("group",ah,aj),fb("group_level",ah,aj),fb("skip",ah,aj),fb("stale",ah,aj),fb("conflicts",ah,aj),fb("startkey",ah,aj,!0),fb("start_key",ah,aj,!0),fb("endkey",ah,aj,!0),fb("end_key",ah,aj,!0),fb("inclusive_end",ah,aj),fb("key",ah,aj,!0),aj=aj.join("&"),aj=""===aj?"":"?"+aj,"undefined"!=typeof ah.keys){var ad=2000,t="keys="+encodeURIComponent(JSON.stringify(ah.keys));t.length+aj.length+1<=ad?aj+=("?"===aj[0]?"&":"?")+t:(ag="POST","string"==typeof ac?aa={keys:ah.keys}:ac.keys=ah.keys)}if("string"==typeof ac){var ab=es(ac);return af.request({method:ag,url:"_design/"+ab[0]+"/_view/"+ab[1]+aj,body:aa}).then(n(ah))}return aa=aa||{},Object.keys(ac).forEach(function(ak){Array.isArray(ac[ak])?aa[ak]=ac[ak]:aa[ak]=ac[ak].toString()}),af.request({method:"POST",url:"_temp_view"+aj,body:aa}).then(n(ah))}function ho(aa,ab,t){return new hg(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function a1(t){return new hg(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function M(t){return function(aa){if(404===aa.status){return t}throw aa}}function ae(al,ag,aa){function ad(){return j(ab)?hg.resolve(ah):ag.db.get(ak)["catch"](M(ah))}function af(am){return am.keys.length?ag.db.allDocs({keys:am.keys,include_docs:!0}):hg.resolve({rows:[]})}function ac(ax,au){for(var am=[],ap={},aA=0,az=au.rows.length;az>aA;aA++){var aw=au.rows[aA],aq=aw.doc;if(aq&&(am.push(aq),ap[aq._id]=!0,aq._deleted=!t[aq._id],!aq._deleted)){var av=t[aq._id];"value" in av&&(aq.value=av.value)}}var ay=Object.keys(t);return ay.forEach(function(aD){if(!ap[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),am.push(aB)}}),ax.keys=hb(ay.concat(ax.keys)),am.push(ax),am}var ak="_local/doc_"+al,ah={_id:ak,keys:[]},aj=aa[al],t=aj.indexableKeysToKeyValues,ab=aj.changes;return ad().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function h(ab,t,aa){var ac="_local/lastSeq";return ab.db.get(ac)["catch"](M({_id:ac,seq:0})).then(function(af){var ad=Object.keys(t);return hg.all(ad.map(function(ag){return ae(ag,ab,t)})).then(function(ah){var ag=gd(ah);return af.seq=aa,ag.push(af),ab.db.bulkDocs({docs:ag})})})}function g8(aa){var ab="string"==typeof aa?aa:aa.name,t=K[ab];return t||(t=K[ab]=new v),t}function iF(t){return dr(g8(t),function(){return u(t)})()}function u(af){function ac(am,ak){var al={id:aj._id,key:hS.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=hS.normalizeKey(ak)),aa.push(al)}function ah(ak,al){return function(){return h(af,ak,al)}}var aa,aj,ag;if("function"==typeof af.mapFun&&2===af.mapFun.length){var ad=af.mapFun;ag=function(ak){return ad(ak,ac)}}else{ag=g7(af.mapFun.toString(),ac,fr,en,Array.isArray,JSON.parse)}var t=af.seq||0,ab=new v;return new hg(function(ap,ak){function al(){ab.finish().then(function(){af.seq=t,ap()})}function am(){function aq(au){ak(au)}af.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:t,limit:p}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var aC={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){aa=[],aj=ax.doc,aj._deleted||gJ(af.sourceDB,ag,[aj]),aa.sort(br);for(var au,ay={},az=0,aG=aa.length;aG>az;az++){var aE=aa[az],aB=[aE.key,aE.id];0===hS.collate(aE.key,au)&&aB.push(az);var aw=hS.toIndexableString(aB);ay[aw]=aE,au=aE.key}aC[ax.doc._id]={indexableKeysToKeyValues:ay,changes:ax.changes}}t=ax.seq}return ab.add(ah(aC,t)),aA.length<p?al():am()}).on("error",aq)}am()})}function s(al,ag,aa){0===aa.group_level&&delete aa.group_level;var ad,af=aa.group||aa.group_level;ad=jb[al.reduceFun]?jb[al.reduceFun]:g7(al.reduceFun.toString(),null,fr,en,Array.isArray,JSON.parse);var ac=[],ak=isNaN(aa.group_level)?Number.POSITIVE_INFINITY:aa.group_level;ag.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&(ap=ap.slice(0,ak)),am&&0===hS.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ac.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ag=[];for(var ah=0,aj=ac.length;aj>ah;ah++){var t=ac[ah],ab=gJ(al.sourceDB,ad,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof gm){throw ab.error}ag.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:ao(ag,aa.limit,aa.skip)}}function W(aa,t){return dr(g8(aa),function(){return gD(aa,t)})()}function gD(t,ab){function am(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ap=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=hS.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function aa(av){var aq;if(aq=ak?s(t,av,ab):{total_rows:ap,offset:ad,rows:av},ab.include_docs){var au=hb(av.map(fe));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:ab.conflicts,attachments:ab.attachments,binary:ab.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=fe(ay),az=aw["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ap,ak=t.reduceFun&&ab.reduce!==!1,ad=ab.skip||0;if("undefined"==typeof ab.keys||ab.keys.length||(ab.limit=0,delete ab.keys),"undefined"!=typeof ab.keys){var aj=ab.keys,ac=aj.map(function(au){var aq={startkey:hS.toIndexableString([au]),endkey:hS.toIndexableString([au,{}])};return am(aq)});return hg.all(ac).then(gd).then(aa)}var af={descending:ab.descending};if(ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"undefined"!=typeof ab.startkey&&(af.startkey=ab.descending?hS.toIndexableString([ab.startkey,{}]):hS.toIndexableString([ab.startkey])),"undefined"!=typeof ab.endkey){var ah=ab.inclusive_end!==!1;ab.descending&&(ah=!ah),af.endkey=hS.toIndexableString(ah?[ab.endkey,{}]:[ab.endkey])}if("undefined"!=typeof ab.key){var al=hS.toIndexableString([ab.key]),ag=hS.toIndexableString([ab.key,{}]);af.descending?(af.endkey=al,af.startkey=ag):(af.startkey=al,af.endkey=ag)}return ak||("number"==typeof ab.limit&&(af.limit=ab.limit),af.skip=ad),am(af).then(aa)}function gw(t){return t.request({method:"POST",url:"_view_cleanup"})}function gb(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(af){var ah=es(af),ag="_design/"+ah[0],ad=ah[1];aa[ag]=aa[ag]||{},aa[ag][ad]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(af){var ad={};af.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ad[au]=ad[au]||am})})});var ag=Object.keys(ad).filter(function(aj){return !ad[aj]}),ah=ag.map(function(aj){return dr(g8(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hg.all(ah).then(function(){return{ok:!0}})})},M({ok:!0}))}function de(aa,ad,ab){if("http"===aa.type()){return fY(aa,ad,ab)}if("function"==typeof aa._query){return ho(aa,ad,ab)}if("string"!=typeof ad){iE(ab,ad);var ah={db:aa,viewName:"temp_view/temp_view",map:ad.map,reduce:ad.reduce,temporary:!0};return hu.add(function(){return iN(ah).then(function(ak){function aj(){return ak.db.destroy()}return jp(iF(ak).then(function(){return W(ak,ab)}),aj)})}),hu.finish()}var t=ad,ag=es(t),ac=ag[0],af=ag[1];return aa.get("_design/"+ac).then(function(al){var ak=al.views&&al.views[af];if(!ak||"string"!=typeof ak.map){throw new fj("ddoc "+ac+" has no view named "+af)}iE(ab,ak);var aj={db:aa,viewName:t,map:ak.map,reduce:ak.reduce};return iN(aj).then(function(am){return"ok"===ab.stale||"update_after"===ab.stale?("update_after"===ab.stale&&g9.nextTick(function(){iF(am)}),W(am,ab)):iF(am).then(function(){return W(am,ab)})})})}function F(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,F)}catch(t){}}function fj(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,fj)}catch(t){}}function gm(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gm)}catch(t){}}function ai(t){return/^1-/.test(t)}function gR(aa,ab,t){return !aa._attachments||!aa._attachments[t]||aa._attachments[t].digest!==ab._attachments[t].digest}function x(aa,ab){var t=Object.keys(ab._attachments);return hg.all(t.map(function(ac){return aa.getAttachment(ab._id,ac,{rev:ab._rev})}))}function iZ(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return hg.all(ab.map(function(ag){return gR(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return x(t,aa)}):x(t,aa)}function X(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function cr(aa,ah,ac,af){function ad(){var am=X(ac);if(am.docs.length){return aa.bulkGet(am).then(function(ap){if(af.cancelled){throw new Error("cancelled")}return hg.all(ap.results.map(function(aq){return hg.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?iZ(ah,aa,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(gd(aq).filter(Boolean))})})}}function al(am){return am._attachments&&Object.keys(am._attachments).length>0}function ak(am){return aa.allDocs({keys:am,include_docs:!0}).then(function(ap){if(af.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&ai(aq.value.rev)&&!al(aq.doc)&&(t.push(aq.doc),delete ac[aq.id])})})}function ag(){var am=Object.keys(ac).filter(function(aq){var ap=ac[aq].missing;return 1===ap.length&&ai(ap[0])});return am.length>0?ak(am):void 0}function aj(){return{ok:ab,docs:t}}ac=fp(ac);var t=[],ab=!0;return hg.resolve().then(ag).then(ad).then(aj)}function iA(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&jd(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:jr}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,ia),af.version=jr,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return iA(ac,t,aa,ad,ab)}throw ag}))})}function Q(ab,t,aa,ac){this.src=ab,this.target=t,this.id=aa,this.returnValue=ac}function hi(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:i7(aa.history,t.history)}function i7(ab,t){var ah=ab[0],ac=ab.slice(1),aa=t[0],af=t.slice(1);if(!ah||0===t.length){return{last_seq:fl,history:[]}}var ag=ah.session_id;if(i(ag,t)){return{last_seq:ah.last_seq,history:ab}}var ad=aa.session_id;return i(ad,ac)?{last_seq:aa.last_seq,history:af}:i7(ac,af)}function i(ab,t){var aa=t[0],ac=t.slice(1);return ab&&0!==t.length?ab===aa.session_id?!0:i(ab,ac):!1}function fs(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function a5(ab,t,aa,ac){return ab.retry===!1?(t.emit("error",aa),void t.removeAllListeners()):("function"!=typeof ab.back_off_function&&(ab.back_off_function=go),t.emit("requestError",aa),"active"!==t.state&&"pending"!==t.state||(t.emit("paused",aa),t.state="stopped",t.once("active",function(){ab.current_back_off=fk})),ab.current_back_off=ab.current_back_off||fk,ab.current_back_off=ab.back_off_function(ab.current_back_off),void setTimeout(ac,ab.current_back_off))}function gg(t){return Object.keys(t).sort(hS.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function G(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(hS.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(gg(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hg.all([ab.id(),ad.id()]).then(function(ah){var aj=ah[0]+ah[1]+aa+af+t+ac;return new hg(function(ak){R(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gP(au,af,aK,aP,aL){function aE(){return ay?hg.resolve():G(au,af,aK).then(function(aS){ah=aS,ay=new Q(au,af,ah,aP)})}function aQ(){if(aa=[],0!==aw.docs.length){var aS=aw.docs;return af.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(aP.cancelled){throw aM(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(aL.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),av=av.concat(aV),aL.docs_written+=aw.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?aP.emit("denied",fp(aY)):aa.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,aD("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw aL.doc_write_failures+=aS.length,aT})}}function ad(){if(aw.error){throw new Error("There was a problem getting docs.")}aL.last_seq=aF=aw.seq;var aS=fp(aL);return aa.length&&(aS.docs=aa,aP.emit("change",aS)),aB=!0,ay.writeCheckpoint(aw.seq,aq).then(function(){if(aB=!1,aP.cancelled){throw aM(),new Error("cancelled")}aw=void 0,aI()})["catch"](ag)}function am(){var aS={};return aw.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),af.revsDiff(aS).then(function(aT){if(aP.cancelled){throw aM(),new Error("cancelled")}aw.diffs=aT})}function az(){return cr(au,af,aw.diffs,aP).then(function(aS){aw.error=!aS.ok,aS.docs.forEach(function(aT){delete aw.diffs[aT._id],aL.docs_read++,aw.docs.push(aT)})})}function aH(){if(!aP.cancelled&&!aw){if(0===aG.length){return void ak(!0)}aw=aG.shift(),am().then(az).then(aQ).then(ad).then(aH)["catch"](function(aS){aD("batch processing terminated with error",aS)})}}function ak(aS){return 0===aN.changes.length?void (0!==aG.length||aw||((ab&&aJ.live||aR)&&(aP.state="pending",aP.emit("paused")),aR&&aM())):void ((aS||aR||aN.changes.length>=al)&&(aG.push(aN),aN={seq:0,changes:[],docs:[]},"pending"!==aP.state&&"stopped"!==aP.state||(aP.state="active",aP.emit("active")),aH()))}function aD(aT,aS){aA||(aS.message||(aS.message=aT),aL.ok=!1,aL.status="aborting",aL.errors.push(aS),av=av.concat(aS),aG=[],aN={seq:0,changes:[],docs:[]},aM())}function aM(){if(!(aA||aP.cancelled&&(aL.status="cancelled",aB))){aL.status=aL.status||"complete",aL.end_time=new Date,aL.last_seq=aF,aA=!0;var aT=av.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=av.pop();av.length>0&&(aS.other_errors=av),aS.result=aL,a5(aK,aP,aS,function(){gP(au,af,aK,aP)})}else{aL.errors=av,aP.emit("complete",aL),aP.removeAllListeners()}}}function ap(aT){if(aP.cancelled){return aM()}var aS=a9(aK)(aT);aS&&(aN.seq=aT.seq,aN.changes.push(aT),ak(0===aG.length&&aJ.live))}function t(aT){if(ac=!1,aP.cancelled){return aM()}if(aT.results.length>0){aJ.since=aT.last_seq,aI(),ak(!0)}else{var aS=function(){ab?(aJ.live=!0,aI()):aR=!0,ak(!0)};aw||0!==aT.results.length?aS():(aB=!0,ay.writeCheckpoint(aT.last_seq,aq).then(function(){aB=!1,aL.last_seq=aF=aT.last_seq,aS()})["catch"](ag))}}function aO(aS){return ac=!1,aP.cancelled?aM():void aD("changes rejected",aS)}function aI(){function aT(){aU.cancel()}function aS(){aP.removeListener("cancel",aT)}if(!ac&&!aR&&aG.length<aj){ac=!0,aP._changes&&(aP.removeListener("cancel",aP._abortChanges),aP._changes.cancel()),aP.once("cancel",aT);var aU=au.changes(aJ).on("change",ap);aU.then(aS,aS),aU.then(t)["catch"](aO),aK.retry&&(aP._changes=aU,aP._abortChanges=aT)}}function aC(){aE().then(function(){return aP.cancelled?void aM():ay.getCheckpoint().then(function(aS){aF=aS,aJ={since:aF,limit:al,batch_size:al,style:"all_docs",doc_ids:ax,return_docs:!0},aK.filter&&("string"!=typeof aK.filter?aJ.include_docs=!0:aJ.filter=aK.filter),"heartbeat" in aK&&(aJ.heartbeat=aK.heartbeat),"timeout" in aK&&(aJ.timeout=aK.timeout),aK.query_params&&(aJ.query_params=aK.query_params),aK.view&&(aJ.view=aK.view),aI()})})["catch"](function(aS){aD("getCheckpoint rejected with ",aS)})}function ag(aS){throw aB=!1,aD("writeCheckpoint completed with error",aS),aS}var aw,ah,ay,aG=[],aN={seq:0,changes:[],docs:[]},aB=!1,aR=!1,aA=!1,aF=0,ab=aK.continuous||aK.live||!1,al=aK.batch_size||100,aj=aK.batches_limit||10,ac=!1,ax=aK.doc_ids,av=[],aa=[],aq=iv();aL=aL||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aJ={};return aP.ready(au,af),aP.cancelled?void aM():(aP._addedListeners||(aP.once("cancel",aM),"function"==typeof aK.complete&&(aP.once("error",aK.complete),aP.once("complete",function(aS){aK.complete(null,aS)})),aP._addedListeners=!0),void ("undefined"==typeof aK.since?aC():aE().then(function(){return aB=!0,ay.writeCheckpoint(aK.since,aq)}).then(function(){return aB=!1,aP.cancelled?void aM():(aF=aK.since,void aC())})["catch"](ag)))}function jm(){ij.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hg(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function N(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function je(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw iO(fV,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=fp(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new jm(ag),t=N(ab,ag),af=N(ad,ag);return gP(t,af,ag,aa),aa}function iq(ab,t,aa,ac){return"function"==typeof aa&&(ac=aa,aa={}),"undefined"==typeof aa&&(aa={}),aa=fp(aa),aa.PouchConstructor=aa.PouchConstructor||this,ab=N(ab,aa),t=N(t,aa),new hI(ab,t,aa,ac)}function hI(al,ac,ab,aj){function ad(ay){ap.emit("change",{direction:"pull",change:ay})}function aq(ay){ap.emit("change",{direction:"push",change:ay})}function af(ay){ap.emit("denied",{direction:"push",doc:ay})}function aa(ay){ap.emit("denied",{direction:"pull",doc:ay})}function av(){ap.pushPaused=!0,ap.pullPaused&&ap.emit("paused")}function ah(){ap.pullPaused=!0,ap.pushPaused&&ap.emit("paused")}function am(){ap.pushPaused=!1,ap.pullPaused&&ap.emit("active",{direction:"push"})}function t(){ap.pullPaused=!1,ap.pushPaused&&ap.emit("active",{direction:"pull"})}function ak(ay){return function(aC,aE){var aD="change"===aC&&(aE===ad||aE===aq),aA="denied"===aC&&(aE===aa||aE===af),az="paused"===aC&&(aE===ah||aE===av),aB="active"===aC&&(aE===t||aE===am);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ap.removeAllListeners(aC))}}var ap=this;this.canceled=!1;var ag=ab.push?gc.extend({},ab,ab.push):ab,aw=ab.pull?gc.extend({},ab,ab.pull):ab;this.push=je(al,ac,ag),this.pull=je(ac,al,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ab.live&&(this.push.on("complete",ap.pull.cancel.bind(ap.pull)),this.pull.on("complete",ap.push.cancel.bind(ap.push))),this.on("newListener",function(ay){"change"===ay?(ap.pull.on("change",ad),ap.push.on("change",aq)):"denied"===ay?(ap.pull.on("denied",aa),ap.push.on("denied",af)):"active"===ay?(ap.pull.on("active",t),ap.push.on("active",am)):"paused"===ay&&(ap.pull.on("paused",ah),ap.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ap.pull.removeListener("change",ad),ap.push.removeListener("change",aq)):"denied"===ay?(ap.pull.removeListener("denied",aa),ap.push.removeListener("denied",af)):"active"===ay?(ap.pull.removeListener("active",t),ap.push.removeListener("active",am)):"paused"===ay&&(ap.pull.removeListener("paused",ah),ap.push.removeListener("paused",av))}),this.pull.on("removeListener",ak("pull")),this.push.on("removeListener",ak("push"));var au=hg.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ap.emit("complete",az),aj&&aj(null,az),ap.removeAllListeners(),az},function(ay){if(ap.cancel(),aj?aj(ay):ap.emit("error",ay),ap.removeAllListeners(),aj){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gi(t){t.replicate=je,t.sync=iq}var ei,gc=b(9),he=gC(b(5)),hO=gC(b(8)),i5=gC(b(10)),g1=b(14),hK=gC(b(4)),ij=b(1),hc=gC(b(15)),jC=gC(b(16)),hx=gC(b(17)),hS=b(12),hg="function"==typeof Promise?Promise:i5,ez=Function.prototype.toString,io=ez.call(Object),hl=he("pouchdb:api"),hw=6;if(a3()){ei=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),ei=!!localStorage.getItem("_pouch_check_localstorage")}catch(gp){ei=!1}}hO(fU,ij.EventEmitter),fU.prototype.addListener=function(ab,ad,ag,ac){function aa(){function ah(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var aj=fi(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",ah)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},fU.prototype.removeListener=function(aa,t){t in this._listeners&&ij.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},fU.prototype.notifyLocalWindows=function(t){a3()?chrome.storage.local.set({dbName:t}):gf()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},fU.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hO(jl,Error),jl.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ew=new jl({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),h5=new jl({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),ju=new jl({status:404,error:"not_found",reason:"missing"}),h7=new jl({status:409,error:"conflict",reason:"Document update conflict"}),gN=new jl({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gx=new jl({status:412,error:"missing_id",reason:"_id is required for puts"}),at=new jl({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),i8=new jl({status:412,error:"precondition_failed",reason:"Database not open"}),gB=new jl({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),hy=new jl({status:500,error:"badarg",reason:"Some query argument is invalid"}),fn=new jl({status:400,error:"invalid_request",reason:"Request was invalid"}),g3=new jl({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),m=new jl({status:500,error:"doc_validation",reason:"Bad special document member"}),fV=new jl({status:400,error:"bad_request",reason:"Something wrong with the request"}),ik=new jl({status:400,error:"bad_request",reason:"Document must be a JSON object"}),i4=new jl({status:404,error:"not_found",reason:"Database not found"}),gW=new jl({status:500,error:"indexed_db_went_bad",reason:"unknown"}),D=new jl({status:500,error:"web_sql_went_bad",reason:"unknown"}),hG=new jl({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),hM=new jl({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),dn=new jl({status:400,error:"bad_request",reason:"Invalid rev format"}),fo=new jl({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),gT=new jl({status:412,error:"missing_stub"}),iX=new jl({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[ew,h5,ju,h7,gN,gx,at,i8,gB,hy,fn,g3,m,fV,ik,i4,D,hG,hM,dn,fo,gT,gW,iX],h3=function(ab,t,aa){var ac=hY.filter(function(ad){return ad[ab]===t});return aa&&ac.filter(function(ad){return ad.message===aa})[0]||ac[0]},fX=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ht="queryKey",be=/(?:^|&)([^&=]*)=?([^&]*)/g,fz=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,iV="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hO(iz,ij.EventEmitter),iz.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},iz.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=fp(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=jo,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=hs(ac.view):ac.filter=hs(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=hK(function(af){ad.cancel(),ab.apply(this,af)})}},iz.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=iO(fV,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=g5(ac.view);this.db.get("_design/"+ab[0],function(ag,ah){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ag){return aa(iC(ag))}var aj=ah&&ah.views&&ah.views[ab[1]]&&ah.views[ab[1]].map;return aj?(ac.filter=hF(aj),void t.doChanges(ac)):aa(iO(ju,ah.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=g5(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(aj,ah){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(aj){return aa(iC(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(ac.filter=di(ag),void t.doChanges(ac)):aa(iO(ju,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hO(fh,ij.EventEmitter),fh.prototype.post=fy("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(iO(ik)):void this.bulkDocs({docs:[aa]},ab,hB(t))}),fh.prototype.put=fy("put",hK(function(af){function ac(){ad||(gl("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ad=!0)}var ah,aa,aj,ag,ad=!1,t=af.shift(),ab="_id" in t;if("object"!=typeof t||Array.isArray(t)){return(ag=af.pop())(iO(ik))}for(;;){if(ah=af.shift(),aa=typeof ah,"string"!==aa||ab?"string"!==aa||!ab||"_rev" in t?"object"===aa?aj=ah:"function"===aa&&(ag=ah):(ac(),t._rev=ah):(ac(),t._id=ah,ab=!0),!af.length){break}}return aj=aj||{},jt(t._id),gk(t._id)&&"function"==typeof this._putLocal?t._deleted?this._removeLocal(t,ag):this._putLocal(t,ag):void this.bulkDocs({docs:[t]},aj,hB(ag))})),fh.prototype.putAttachment=fy("putAttachment",function(ab,ad,ag,ac,aa){function t(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ad]={content_type:aa,data:ac,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw iO(h7)}return t(ah)},function(ah){if(ah.reason===ju.message){return t({_id:ab})}throw ah})}),fh.prototype.removeAttachment=fy("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(iO(h7)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),fh.prototype.remove=fy("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,gk(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,hB(ad))}),fh.prototype.revsDiff=fy("revsDiff",function(ab,t,ah){function ac(ak,aj){ad.has(ak)||ad.set(ak,{missing:[]}),ad.get(ak).missing.push(aj)}function aa(aj,ak){var al=ab[aj].slice(0);ga(ak,function(av,aw,am,aq,ap){var au=aw+"-"+am,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==ap.status&&ac(aj,au))}),al.forEach(function(am){ac(aj,am)})}"function"==typeof t&&(ah=t,t={});var af=Object.keys(ab);if(!af.length){return ah(null,{})}var ag=0,ad=new g1.Map;af.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ad.set(aj,{missing:ab[aj]})}else{if(al){return ah(al)}aa(aj,am)}if(++ag===af.length){var ak={};return ad.forEach(function(ap,aq){ak[aq]=ap}),ah(null,ak)}})},this)}),fh.prototype.bulkGet=fy("bulkGet",function(aa,t){fd(this,aa,t)}),fh.prototype.compactDocument=fy("compactDocument",function(ab,t,aa){var ac=this;this._getRevisionTree(ab,function(aj,af){if(aj){return aa(aj)}var ah=ex(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>t&&ad.push(ak)}),ga(af,function(au,al,ap,ak,aq){var am=al+"-"+ap;"available"===aq.status&&-1!==ad.indexOf(am)&&ag.push(am)}),ac._doCompaction(ab,ag,aa)})}),fh.prototype.compact=fy("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&im(t)}),fh.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(aj){var ah=aj.last_seq;hg.all(af).then(function(){return H(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},fh.prototype.get=fy("get",function(ab,t,ah){function ac(){var ak=[],aj=aa.length;return aj?void aa.forEach(function(al){af.get(ab,{rev:al,revs:t.revs,attachments:t.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ah(null,ak)})}):ah(null,ak)}if("function"==typeof t&&(ah=t,t={}),"string"!=typeof ab){return ah(iO(gN))}if(gk(ab)&&"function"==typeof this._getLocal){return this._getLocal(ab,ah)}var aa=[],af=this;if(!t.open_revs){return this._get(ab,t,function(ax,aB){if(ax){return ah(ax)}var aA=aB.doc,az=aB.metadata,am=aB.ctx;if(t.conflicts){var ap=g0(az);ap.length&&(aA._conflicts=ap)}if(iT(az,aA._rev)&&(aA._deleted=!0),t.revs||t.revs_info){var au=h1(az.rev_tree),aj=iW(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aA._rev.split("-")[1])}),aq=aj.ids.map(function(aC){return aC.id}).indexOf(aA._rev.split("-")[1])+1,aw=aj.ids.length-aq;if(aj.ids.splice(aq,aw),aj.ids.reverse(),t.revs&&(aA._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),t.revs_info){var ay=aj.pos+aj.ids.length;aA._revs_info=aj.ids.map(function(aC){return ay--,{rev:ay+"-"+aC.id,status:aC.opts.status}})}}if(t.attachments&&aA._attachments){var av=aA._attachments,al=Object.keys(av).length;if(0===al){return ah(null,aA)}Object.keys(av).forEach(function(aC){this._getAttachment(aA._id,aC,av[aC],{rev:aA._rev,binary:t.binary,ctx:am},function(aE,aD){var aF=aA._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--al||ah(null,aA)})},af)}else{if(aA._attachments){for(var ak in aA._attachments){aA._attachments.hasOwnProperty(ak)&&(aA._attachments[ak].stub=!0)}}ah(null,aA)}})}if("all"===t.open_revs){this._getRevisionTree(ab,function(ak,aj){return ak?ah(ak):(aa=L(aj).map(function(al){return al.rev}),void ac())})}else{if(!Array.isArray(t.open_revs)){return ah(iO(gB,"function_clause"))}aa=t.open_revs;for(var ag=0;ag<aa.length;ag++){var ad=aa[ag];if("string"!=typeof ad||!/^\d+-/.test(ad)){return ah(iO(dn))}}ac()}}),fh.prototype.getAttachment=fy("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(iO(ju))})}),fh.prototype.allDocs=fy("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(iO(g3,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return ct(this,aa,ab)}}return this._allDocs(aa,ab)}),fh.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new iz(this,aa,t)},fh.prototype.close=fy("close",function(t){return this._closed=!0,this._close(t)}),fh.prototype.info=fy("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),fh.prototype.id=fy("id",function(t){return this._id(t)}),fh.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},fh.prototype.bulkDocs=fy("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(iO(h5))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(iO(ik))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||iy(ag)})}),ab?aa(iO(fV,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(i1),fg(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),fh.prototype.registerDependentDatabase=fy("registerDependentDatabase",function(ab,t){function aa(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ab]?!1:(ad.dependentDbs[ab]=!0,ad)}var ac=new this.constructor(ab,this.__opts);H(this,"_local/_pouch_dependentDbs",aa).then(function(){t(null,{db:ac})})["catch"](t)}),fh.prototype.destroy=fy("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});hg.all(ag).then(aa,t)})}),jB.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},jB.prototype.fail=function(t){this.failed=t,this.execute()},jB.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},jB.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hO(hE,fh),hE.debug=he,hE.adapters={},hE.preferredAdapters=[],hE.prefix="_pouch_";var gL=new ij.EventEmitter;g4(hE),hE.parseAdapter=function(ab,t){var ah,ac,aa=ab.match(/([a-z\-]*):\/\/(.*)/);if(aa){if(ab=/http(s?)/.test(aa[1])?aa[1]+"://"+aa[2]:aa[2],ah=aa[1],!hE.adapters[ah].valid()){throw"Invalid adapter"}return{name:ab,adapter:aa[1]}}var af="idb" in hE.adapters&&"websql" in hE.adapters&&gf()&&localStorage["_pouch__websqldb_"+hE.prefix+ab];if(t.adapter){ac=t.adapter}else{if("undefined"!=typeof t&&t.db){ac="leveldb"}else{for(var ag=0;ag<hE.preferredAdapters.length;++ag){if(ac=hE.preferredAdapters[ag],ac in hE.adapters){if(af&&"idb"===ac){gl("log",'PouchDB is downgrading "'+ab+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ah=hE.adapters[ac];var ad=ah&&"use_prefix" in ah?ah.use_prefix:!0;return{name:ad?hE.prefix+ab:ab,adapter:ac}},hE.adapter=function(aa,ab,t){ab.valid()&&(hE.adapters[aa]=ab,t&&hE.preferredAdapters.push(aa))},hE.plugin=function(t){return"function"==typeof t?t(hE):Object.keys(t).forEach(function(aa){hE.prototype[aa]=t[aa]}),hE},hE.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=gc.extend({},aa,ad),void hE.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hO(t,hE),t.preferredAdapters=hE.preferredAdapters.slice(),Object.keys(hE).forEach(function(ab){ab in t||(t[ab]=hE[ab])}),t};var et="5.4.4";hE.version=et;var iB,q=ih(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=ih(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),fm=function(t){return atob(t)},gu=function(t){return btoa(t)},bt=iS.setImmediate||iS.setTimeout,iU=32768,h8=5,gv="document-store",g2="by-sequence",gr="attach-store",gq="attach-seq-store",J="meta-store",jz="local-store",jx="detect-blob-support",hD={running:!1,queue:[]},i0=new g1.Map,gS=new fU,hV=new g1.Map;S.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var a6=7,B=gj("document-store"),iL=gj("by-sequence"),jv=gj("attach-store"),a2=gj("local-store"),h6=gj("metadata-store"),T=gj("attach-seq-store"),iR=new g1.Map,il=new fU,ic=1,i9="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+iL+" (seq, deleted)",gH="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+iL+" (doc_id, rev)",ie="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+B+" (winningseq)",ce="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+T+" (seq)",hJ="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+T+" (digest, seq)",jj=iL+".seq = "+B+".winningseq",h9=iL+".seq AS seq, "+iL+".deleted AS deleted, "+iL+".json AS data, "+iL+".rev AS rev, "+B+".json AS metadata";l.valid=fu,l.use_prefix=!0;var gZ=g(),C=function(){},o=25,hp=50,hh={},iY=1800,U=he("pouchdb:http");a4.valid=function(){return !0},v.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},v.prototype.finish=function(){return this.promise};var iK=function(aa,t){return t&&aa.then(function(ab){g9.nextTick(function(){t(null,ab)})},function(ab){g9.nextTick(function(){t(ab)})}),aa},f=function(t){return hK(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&iK(ab,aa),ab})},jp=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},dr=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},hb=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},K={},hu=new v,p=50,en=gl.bind(null,"log"),jb={_sum:function(aa,t){return fr(t)},_count:function(aa,t){return t.length},_stats:function(aa,ab){function t(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:fr(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},hP=f(function(){var t=this;return"http"===t.type()?gw(t):"function"==typeof t._viewCleanup?a1(t):gb(t)}),iG=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?h4(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=hg.resolve().then(function(){return de(ad,ac,t)});return iK(ab,aa),ab};hO(F,Error),hO(fj,Error),hO(gm,Error);var hC={query:iG,viewCleanup:hP},jr=1,gU="pouchdb",ia=5,fl=0;Q.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},Q.prototype.updateTarget=function(aa,t){return iA(this.target,this.id,aa,t,this.returnValue)},Q.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?hg.resolve(!0):iA(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(fs(ac)){return t.readOnlySource=!0,!0}throw ac})};var hj={undefined:function(aa,t){return 0===hS.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return hi(t,aa).last_seq}};Q.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hg.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return fl}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hj?hj[ab](aa,ac):fl},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:fl}).then(function(){return fl},function(ac){return fs(ac)?(t.readOnlySource=!0,aa.last_seq):fl})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return fl})};var fk=0;hO(jm,ij.EventEmitter),jm.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},jm.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},hO(hI,ij.EventEmitter),hI.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},hE.plugin(iI).plugin(ip).plugin(gF).plugin(hC).plugin(gi),e.exports=hE}).call(this,b(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var j="color: "+this.color;h=[h[0],j,"color: inherit"].concat(Array.prototype.slice.call(h,1));var g=0,f=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),h.splice(f,0,j),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(i,a,r){function t(){return r.colors[n++%r.colors.length]}function s(g){function j(){}function h(){var w=h,q=+new Date,v=q-(f||q);w.diff=v,w.prev=f,w.curr=q,f=q,null==w.useColors&&(w.useColors=r.useColors()),null==w.color&&w.useColors&&(w.color=t());var m=Array.prototype.slice.call(arguments);m[0]=r.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=r.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof r.formatArgs&&(m=r.formatArgs.apply(w,m));var l=h.log||r.log||console.log.bind(console);l.apply(w,m)}j.enabled=!1,h.enabled=!0;var k=r.enabled(g)?h:j;return k.namespace=g,k}function o(h){r.save(h);for(var g=(h||"").split(/[\s,]+/),j=g.length,k=0;j>k;k++){g[k]&&(h=g[k].replace(/\*/g,".*?"),"-"===h[0]?r.skips.push(new RegExp("^"+h.substr(1)+"$")):r.names.push(new RegExp("^"+h+"$")))}}function e(){r.enable("")}function u(g){var j,h;for(j=0,h=r.skips.length;h>j;j++){if(r.skips[j].test(g)){return !1}}for(j=0,h=r.names.length;h>j;j++){if(r.names[j].test(g)){return !0}}return !1}function b(g){return g instanceof Error?g.stack||g.message:g}r=a.exports=s,r.coerce=b,r.disable=e,r.enable=o,r.enabled=u,r.humanize=i(11),r.names=[],r.skips=[],r.formatters={};var f,n=0},{11:11}],7:[function(b,e,a){(function(f){function o(){i=!0;for(var g,h,j=n.length;j;){for(h=n,n=[],g=-1;++g<j;){h[g]()}j=n.length}i=!1}function u(g){1!==n.push(g)||i||s()}var s,l=f.MutationObserver||f.WebKitMutationObserver;if(l){var z=0,x=new l(o),y=f.document.createTextNode("");x.observe(y,{characterData:!0}),s=function(){y.data=z=++z%2}}else{if(f.setImmediate||"undefined"==typeof f.MessageChannel){s="document" in f&&"onreadystatechange" in f.document.createElement("script")?function(){var g=f.document.createElement("script");g.onreadystatechange=function(){o(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},f.document.documentElement.appendChild(g)}:function(){setTimeout(o,0)}}else{var r=new f.MessageChannel;r.port1.onmessage=o,s=function(){r.port2.postMessage(0)}}}var i,n=[];e.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(b,e,a){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(f,u,o){function s(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=p,this.queue=[],this.outcome=void 0,g!==s&&y(this,g)}function e(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function m(j,k,g){t(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function b(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(g,k){function w(A){x||(x=!0,K.reject(g,A))}function j(A){x||(x=!0,K.resolve(g,A))}function q(){k(j,w)}var x=!1,z=r(q);"error"===z.status&&w(z.value)}function r(g,k){var q={};try{q.value=g(k),q.status="success"}catch(j){q.status="error",q.value=j}return q}function i(g){return g instanceof this?g:K.resolve(new this(s),g)}function n(g){var j=new this(s);return K.reject(j,g)}function a(z){function k(E,D){function C(F){q[D]=F,++x!==j||B||(B=!0,K.resolve(w,q))}g.resolve(E).then(C,function(F){B||(B=!0,K.reject(w,F))})}var g=this;if("[object Array]"!==Object.prototype.toString.call(z)){return this.reject(new TypeError("must be an array"))}var j=z.length,B=!1;if(!j){return this.resolve([])}for(var q=new Array(j),x=0,A=-1,w=new this(s);++A<j;){k(z[A],A)}return w}function l(g){function k(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(j,B))},function(B){x||(x=!0,K.reject(j,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var q=g.length,x=!1;if(!q){return this.resolve([])}for(var z=-1,j=new this(s);++z<q;){k(g[z])}return j}var t=f(7),K={},L=["REJECTED"],h=["FULFILLED"],p=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(j,k){if("function"!=typeof j&&this.state===h||"function"!=typeof k&&this.state===L){return this}var q=new this.constructor(s);if(this.state!==p){var g=this.state===h?j:k;m(q,g,this.outcome)}else{this.queue.push(new e(q,j,k))}return q},e.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},e.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},e.prototype.callRejected=function(g){K.reject(this.promise,g)},e.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)},K.resolve=function(j,w){var q=r(b,w);if("error"===q.status){return K.reject(j,q.value)}var k=q.value;if(k){y(j,k)}else{j.state=h,j.outcome=w;for(var g=-1,x=j.queue.length;++g<x;){j.queue[g].callFulfilled(w)}}return j},K.reject=function(g,k){g.state=L,g.outcome=k;for(var q=-1,j=g.queue.length;++q<j;){g.queue[q].callRejected(k)}return g},v.resolve=i,v.reject=n,v.all=a,v.race=l},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function b(v){if(null!==v){switch(typeof v){case"boolean":return v?1:0;case"number":return n(v);case"string":return v.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var w=Array.isArray(v),q=w?v:Object.keys(v),j=-1,g=q.length,m="";if(w){for(;++j<g;){m+=h.toIndexableString(q[j])}}else{for(;++j<g;){var k=q[j];m+=h.toIndexableString(k)+h.toIndexableString(v[k])}}return m}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+i),m=parseInt(j,10)+t;for(x&&(m=-m),k+=i;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(q,j){var w=q.pop();if(j.length){var m=j[j.length-1];w===m.element&&(j.pop(),m=j[j.length-1]);var g=m.element,v=m.index;if(Array.isArray(g)){g.push(w)}else{if(v===q.length-2){var k=q.pop();g[k]=w}else{q.push(w)}}}}function s(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(v,w){for(var q=Object.keys(v),j=Object.keys(w),g=Math.min(q.length,j.length),m=0;g>m;m++){var k=h.collate(q[m],j[m]);if(0!==k){return k}if(k=h.collate(v[q[m]],w[j[m]]),0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function p(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function n(q){if(0===q){return"1"}var j=q.toExponential().split(/e\+?/),w=parseInt(j[1],10),y=0>q,x=y?"0":"2",v=(y?-w:w)-t,m=a.padLeft(v.toString(),"0",i);x+=f+m;var g=Math.abs(parseFloat(j[0]));y&&(g=10-g);var k=g.toFixed(20);return k=k.replace(/\.?0+$/,""),x+=f+k}var t=-324,i=3,f="",a=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=p(j),g=p(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=h.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=h.normalizeKey(q))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),p(g)+f+b(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(h,b,e){function a(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var f,g=r.length,o=n.length;for(f=0;g>f;f++){if(f===o){return 1}var i=r.charAt(f),q=n.charAt(f);if(i!==q){return q>i?-1:1}}return o>g?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(y){function o(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function u(j,q,k,A,w,z,x){return o(q&k|~q&A,j,q,w,z,x)}function t(j,q,k,A,w,z,x){return o(q&A|k&~A,j,q,w,z,x)}function Q(j,q,k,A,w,z,x){return o(q^k^A,j,q,w,z,x)}function r(j,q,k,A,w,z,x){return o(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=u(z,q,x,j,w[0],7,-680876936),j=u(j,z,q,x,w[1],12,-389564586),x=u(x,j,z,q,w[2],17,606105819),q=u(q,x,j,z,w[3],22,-1044525330),z=u(z,q,x,j,w[4],7,-176418897),j=u(j,z,q,x,w[5],12,1200080426),x=u(x,j,z,q,w[6],17,-1473231341),q=u(q,x,j,z,w[7],22,-45705983),z=u(z,q,x,j,w[8],7,1770035416),j=u(j,z,q,x,w[9],12,-1958414417),x=u(x,j,z,q,w[10],17,-42063),q=u(q,x,j,z,w[11],22,-1990404162),z=u(z,q,x,j,w[12],7,1804603682),j=u(j,z,q,x,w[13],12,-40341101),x=u(x,j,z,q,w[14],17,-1502002290),q=u(q,x,j,z,w[15],22,1236535329),z=t(z,q,x,j,w[1],5,-165796510),j=t(j,z,q,x,w[6],9,-1069501632),x=t(x,j,z,q,w[11],14,643717713),q=t(q,x,j,z,w[0],20,-373897302),z=t(z,q,x,j,w[5],5,-701558691),j=t(j,z,q,x,w[10],9,38016083),x=t(x,j,z,q,w[15],14,-660478335),q=t(q,x,j,z,w[4],20,-405537848),z=t(z,q,x,j,w[9],5,568446438),j=t(j,z,q,x,w[14],9,-1019803690),x=t(x,j,z,q,w[3],14,-187363961),q=t(q,x,j,z,w[8],20,1163531501),z=t(z,q,x,j,w[13],5,-1444681467),j=t(j,z,q,x,w[2],9,-51403784),x=t(x,j,z,q,w[7],14,1735328473),q=t(q,x,j,z,w[12],20,-1926607734),z=Q(z,q,x,j,w[5],4,-378558),j=Q(j,z,q,x,w[8],11,-2022574463),x=Q(x,j,z,q,w[11],16,1839030562),q=Q(q,x,j,z,w[14],23,-35309556),z=Q(z,q,x,j,w[1],4,-1530992060),j=Q(j,z,q,x,w[4],11,1272893353),x=Q(x,j,z,q,w[7],16,-155497632),q=Q(q,x,j,z,w[10],23,-1094730640),z=Q(z,q,x,j,w[13],4,681279174),j=Q(j,z,q,x,w[0],11,-358537222),x=Q(x,j,z,q,w[3],16,-722521979),q=Q(q,x,j,z,w[6],23,76029189),z=Q(z,q,x,j,w[9],4,-640364487),j=Q(j,z,q,x,w[12],11,-421815835),x=Q(x,j,z,q,w[15],16,530742520),q=Q(q,x,j,z,w[2],23,-995338651),z=r(z,q,x,j,w[0],6,-198630844),j=r(j,z,q,x,w[7],10,1126891415),x=r(x,j,z,q,w[14],15,-1416354905),q=r(q,x,j,z,w[5],21,-57434055),z=r(z,q,x,j,w[12],6,1700485571),j=r(j,z,q,x,w[3],10,-1894986606),x=r(x,j,z,q,w[10],15,-1051523),q=r(q,x,j,z,w[1],21,-2054922799),z=r(z,q,x,j,w[8],6,1873313359),j=r(j,z,q,x,w[15],10,-30611744),x=r(x,j,z,q,w[6],15,-1560198380),q=r(q,x,j,z,w[13],21,1309151649),z=r(z,q,x,j,w[4],6,-145523070),j=r(j,z,q,x,w[11],10,-1120210379),x=r(x,j,z,q,w[2],15,718787259),q=r(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function l(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function v(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function P(C){var k,z,A,j,x,B,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;q>=k;k+=64){g(w,l(C.substring(k-64,k)))}for(C=C.substring(k-64),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;z>k;k+=1){A[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(A[k>>2]|=128<<(k%4<<3),k>55){for(g(w,A),k=0;16>k;k+=1){A[k]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),B=parseInt(j[1],16)||0,A[14]=x,A[15]=B,g(w,A),w}function O(C){var B,z,A,j,x,k,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(B=64;q>=B;B+=64){g(w,v(C.subarray(B-64,B)))}for(C=q>B-64?C.subarray(B-64):new Uint8Array(0),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=0;z>B;B+=1){A[B>>2]|=C[B]<<(B%4<<3)}if(A[B>>2]|=128<<(B%4<<3),B>55){for(g(w,A),B=0;16>B;B+=1){A[B]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,A[14]=x,A[15]=k,g(w,A),w}function s(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function p(j){var k;for(k=0;k<j.length;k+=1){j[k]=s(j[k])}return j.join("")}function m(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function n(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(P("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(B,w){var D,k,C,x,A=this.byteLength,z=j(B,A),q=A;return w!==y&&(q=j(w,A)),z>q?new ArrayBuffer(0):(D=q-z,k=new ArrayBuffer(D),C=new Uint8Array(k),x=new Uint8Array(this,z,D),C.set(x),k)}}(),n.prototype.append=function(j){return this.appendBinary(m(j)),this},n.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,l(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},n.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},n.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},n.hash=function(j,k){return n.hashBinary(m(j),k)},n.hashBinary=function(k,w){var j=P(k),q=p(j);return w?e(q):q},n.ArrayBuffer=function(){this.reset()},n.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,v(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=p(this._hash),k&&(z=e(z)),this.reset(),z},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var j=n.prototype.getState.call(this);return j.buff=S(j.buff),j},n.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),n.prototype.setState.call(this,j)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(k,w){var j=O(new Uint8Array(k)),q=p(j);return w?e(q):q},n})},{}],17:[function(h,b,e){function a(r,n,f){var g=f[f.length-1];r===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,i=g.index;if(Array.isArray(o)){o.push(r)}else{if(i===n.length-2){var q=n.pop();o[q]=r}else{n.push(r)}}}e.stringify=function(D){var i=[];i.push({obj:D});for(var u,E,F,n,s,f,l,C,g,o,t,r="";u=i.pop();){if(E=u.obj,F=u.prefix||"",n=u.val||"",r+=F,n){r+=n}else{if("object"!=typeof E){r+="undefined"==typeof E?null:JSON.stringify(E)}else{if(null===E){r+="null"}else{if(Array.isArray(E)){for(i.push({val:"]"}),s=E.length-1;s>=0;s--){f=0===s?"":",",i.push({obj:E[s],prefix:f})}i.push({val:"["})}else{l=[];for(C in E){E.hasOwnProperty(C)&&l.push(C)}for(i.push({val:"}"}),s=l.length-1;s>=0;s--){g=l[s],o=E[g],t=s>0?",":"",t+=JSON.stringify(g)+":",i.push({obj:o,prefix:t})}i.push({val:"{"})}}}}}return r},e.parse=function(i){for(var B,D,g,t,A,o,l,s,C,n=[],u=[],f=0;;){if(B=i[f++],"}"!==B&&"]"!==B&&"undefined"!=typeof B){switch(B){case" ":case"	":case"\n":case":":case",":break;case"n":f+=3,a(null,n,u);break;case"t":f+=3,a(!0,n,u);break;case"f":f+=4,a(!1,n,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",f--;;){if(g=i[f++],!/[\d\.\-e\+]/.test(g)){f--;break}D+=g}a(parseFloat(D),n,u);break;case'"':for(t="",A=void 0,o=0;;){if(l=i[f++],'"'===l&&("\\"!==A||o%2!==1)){break}t+=l,A=l,"\\"===A?o++:o=0}a(JSON.parse('"'+t+'"'),n,u);break;case"[":s={element:[],index:n.length},n.push(s.element),u.push(s);break;case"{":C={element:{},index:n.length},n.push(C.element),u.push(C);break;default:throw new Error("unexpectedly reached end of input: "+B)}}else{if(1===n.length){return n.pop()}a(n.pop(),n,u)}}}},{}]},{},[3])(3)});