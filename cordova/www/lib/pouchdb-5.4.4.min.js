!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(c,f,h){function j(l,e){if(!f[l]){if(!c[l]){var m="function"==typeof require&&require;if(!e&&m){return m(l,!0)}if(g){return g(l,!0)}var k=new Error("Cannot find module '"+l+"'");throw k.code="MODULE_NOT_FOUND",k}var i=f[l]={exports:{}};c[l][0].call(i.exports,function(o){var n=c[l][1][o];return j(n?n:o)},i,i.exports,a,c,f,h)}return f[l].exports}for(var g="function"==typeof require&&require,d=0;d<h.length;d++){j(h[d])}return j}({1:[function(j,l,f){function k(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(e){return"function"==typeof e}function g(e){return"number"==typeof e}function h(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}l.exports=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.prototype.setMaxListeners=function(e){if(!g(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},k.prototype.emit=function(i){var p,m,q,e,n,o;if(this._events||(this._events={}),"error"===i&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if(p=arguments[1],p instanceof Error){throw p}throw TypeError('Uncaught, unspecified "error" event.')}if(m=this._events[i],c(m)){return !1}if(d(m)){switch(arguments.length){case 1:m.call(this);break;case 2:m.call(this,arguments[1]);break;case 3:m.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1),m.apply(this,e)}}else{if(h(m)){for(e=Array.prototype.slice.call(arguments,1),o=m.slice(),q=o.length,n=0;q>n;n++){o[n].apply(this,e)}}}return !0},k.prototype.addListener=function(m,i){var e;if(!d(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,d(i.listener)?i.listener:i),this._events[m]?h(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,h(this._events[m])&&!this._events[m].warned&&(e=c(this._maxListeners)?k.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},k.prototype.on=k.prototype.addListener,k.prototype.once=function(e,m){function i(){this.removeListener(e,i),n||(n=!0,m.apply(this,arguments))}if(!d(m)){throw TypeError("listener must be a function")}var n=!1;return i.listener=m,this.on(e,i),this},k.prototype.removeListener=function(m,p){var o,n,e,i;if(!d(p)){throw TypeError("listener must be a function")}if(!this._events||!this._events[m]){return this}if(o=this._events[m],e=o.length,n=-1,o===p||d(o.listener)&&o.listener===p){delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,p)}else{if(h(o)){for(i=e;i-->0;){if(o[i]===p||o[i].listener&&o[i].listener===p){n=i;break}}if(0>n){return this}1===o.length?(o.length=0,delete this._events[m]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",m,p)}}return this},k.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],d(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},k.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?d(this._events[i])?[this._events[i]]:this._events[i].slice():[]},k.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(d(e)){return 1}if(e){return e.length}}return 0},k.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(x,c,A){function y(){m&&d&&(m=!1,d.length?v=d.concat(v):j=-1,v.length&&k())}function k(){if(!m){var f=q(y);m=!0;for(var e=v.length;e;){for(d=v,v=[];++j<e;){d&&d[j].run()}j=-1,e=v.length}d=null,m=!1,z(f)}}function w(f,e){this.fun=f,this.array=e}function g(){}var q,z,p=c.exports={};!function(){try{q=setTimeout}catch(e){q=function(){throw new Error("setTimeout is not defined")}}try{z=clearTimeout}catch(e){z=function(){throw new Error("clearTimeout is not defined")}}}();var d,v=[],m=!1,j=-1;p.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}v.push(new w(f,e)),1!==v.length||m||q(k,0)},w.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=g,p.addListener=g,p.once=g,p.off=g,p.removeListener=g,p.removeAllListeners=g,p.emit=g,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],3:[function(c,f,d){(function(c1,dX){function dg(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function eX(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function fD(j){if("function"==typeof j.slice){return j.slice(0)}var h=new ArrayBuffer(j.byteLength),g=new Uint8Array(h),i=new Uint8Array(j);return g.set(i),h}function aL(i){if(i instanceof ArrayBuffer){return fD(i)}var h=i.size,g=i.type;return"function"==typeof i.slice?i.slice(0,h,g):i.webkitSlice(0,h,g)}function aD(i){var h=Object.getPrototypeOf(i);if(null===h){return !0}var g=h.constructor;return"function"==typeof g&&g instanceof g&&fO.call(g)==b6}function ch(k){var i,h,j;if(!k||"object"!=typeof k){return k}if(Array.isArray(k)){for(i=[],h=0,j=k.length;j>h;h++){i[h]=ch(k[h])}return i}if(k instanceof Date){return k.toISOString()}if(eX(k)){return aL(k)}if(!aD(k)){return k}i={};for(h in k){if(Object.prototype.hasOwnProperty.call(k,h)){var g=ch(k[h]);"undefined"!=typeof g&&(i[h]=g)}}return i}function eC(g){var h=!1;return b2(function(i){if(h){throw new Error("once called more than once")}h=!0,g.apply(this,i)})}function ed(g){return b2(function(j){j=ch(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(m,n){c1.nextTick(function(){i(m,n)})});var h=new e9(function(o,n){var q;try{var p=eC(function(r,s){r?n(r):o(s)});j.push(p),q=g.apply(l,j),q&&"function"==typeof q.then&&o(q)}catch(m){n(m)}});return k&&h.then(function(m){k(null,m)},k),h})}function e4(i,h){function g(n,l,j){if(eP.enabled){for(var m=[n._db_name,l],o=0;o<j.length-1;o++){m.push(j[o])}eP.apply(null,m);var k=j[j.length-1];j[j.length-1]=function(r,p){var q=[n._db_name,l];q=q.concat(r?["error",r]:["success",p]),eP.apply(null,q),k(r,p)}}}return ed(b2(function(j){if(this._closed){return e9.reject(new Error("database is closed"))}if(this._destroyed){return e9.reject(new Error("database is destroyed"))}var k=this;return g(k,i,j),this.taskqueue.isReady?h.apply(this,j):new e9(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[i].apply(k,j))})})}))}function dy(l,j){for(var i={},k=0,h=j.length;h>k;k++){var g=j[k];g in l&&(i[g]=l[g])}return i}function f3(g){return g}function dY(g){return[{ok:g}]}function eB(q,g,o){function i(){var w=[];j.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),o(null,{results:w})}function l(){++p===v&&i()}function m(y,x,w){j[y]={id:x,docs:w},l()}function k(){if(!(s>=h.length)){var x=Math.min(s+bb,h.length),w=h.slice(s,x);u(w,s),s+=w.length}}function u(x,w){x.forEach(function(D,B){var z=w+B,A=n[D],C=dy(A[0],["atts_since","attachments"]);C.open_revs=A.map(function(E){return E.rev}),C.open_revs=C.open_revs.filter(f3);var y=f3;0===C.open_revs.length&&(delete C.open_revs,y=dY),["revs","attachments","binary","ajax"].forEach(function(E){E in g&&(C[E]=g[E])}),q.get(D,C,function(G,E){var F;F=G?[{error:G}]:y(E),m(z,D,F),k()})})}var r=g.docs,n={};r.forEach(function(w){w.id in n?n[w.id].push(w):n[w.id]=[w]});var v=Object.keys(n).length,p=0,j=new Array(v),h=Object.keys(n),s=0;k()}function fH(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function dd(){return eJ}function eK(g){fH()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):dd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function f5(){aX.EventEmitter.call(this),this._listeners={},eK(this)}function av(g){if("undefined"!==console&&g in console){var h=Array.prototype.slice.call(arguments,1);console[g].apply(console,h)}}function eE(k,i){var h=600000;k=parseInt(k,10)||0,i=parseInt(i,10),i!==i||k>=i?i=(k||1)<<1:i+=1,i>h&&(k=h>>1,i=h);var j=Math.random(),g=i-k;return ~~(g*j+k)}function dC(g){var h=0;return g||(h=2000),eE(g,h)}function bJ(g,h){av("info","The above "+g+" is totally normal. "+h)}function d8(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function cU(j,h,g){function i(k){for(var l in j){"function"!=typeof j[l]&&(this[l]=j[l])}void 0!==g&&(this.name=g),void 0!==k&&(this.reason=k)}return i.prototype=d8.prototype,new i(h)}function eO(l){var j,i,k,h,g;return i=l.error===!0&&"string"==typeof l.name?l.name:l.error,g=l.reason,k=cD("name",i,g),l.missing||"missing"===g||"deleted"===g||"not_found"===i?k=by:"doc_validation"===i?(k=ka,h=g):"bad_request"===i&&k.message!==g&&(k=e6),k||(k=cD("status",l.status,g)||dF),j=cU(k,g,i),h&&(j.message=h),l.id&&(j.id=l.id),l.status&&(j.status=l.status),l.missing&&(j.missing=l.missing),j}function aU(k,i,h){try{return !k(i,h)}catch(j){var g="Filter function threw: "+j.toString();return cU(e6,g)}}function eG(i){var h={},g=i.filter&&"function"==typeof i.filter;return h.query=i.query_params,function(k){k.doc||(k.doc={});var l=g&&aU(i.filter,k.doc,h);if("object"==typeof l){return l}if(l){return !1}if(i.include_docs){if(!i.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function aa(j){for(var h=[],g=0,i=j.length;i>g;g++){h=h.concat(j[g])}return h}function bS(g){var h;if(g?"string"!=typeof g?h=cU(c8):/^_/.test(g)&&!/^_(design|local)/.test(g)&&(h=cU(fI)):h=cU(dJ),h){throw h}}function bq(g,h){return"listenerCount" in g?g.listenerCount(h):aX.EventEmitter.listenerCount(g,h)}function d2(g){if(!g){return null}var h=g.split("/");return 2===h.length?h:1===h.length?[g,g]:null}function bc(g){var h=d2(g);return h?h.join("/"):null}function e0(i){for(var l=kh.exec(i),g={},m=14;m--;){var j=f1[m],k=l[m]||"",h=-1!==["user","password"].indexOf(j);g[j]=h?decodeURIComponent(k):k}return g[df]={},g[f1[12]].replace(eZ,function(p,n,o){n&&(g[df][n]=o)}),g}function jG(i,h,g){return new e9(function(j,k){i.get(h,function(o,m){if(o){if(404!==o.status){return k(o)}m={}}var l=m._rev,n=g(m);return n?(n._id=h,n._rev=l,void j(bI(i,n,g))):j({updated:!1,rev:l})})})}function bI(i,h,g){return i.put(h).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return jG(i,h._id,g)})}function ap(g){return 0|Math.random()*g}function cE(j,h){h=h||eQ.length;var g="",i=-1;if(j){for(;++i<j;){g+=eQ[ap(h)]}return g}for(;++i<36;){switch(i){case 8:case 13:case 18:case 23:g+="-";break;case 19:g+=eQ[3&ap(16)|8];break;default:g+=eQ[ap(16)]}}return g}function dZ(r){for(var l,o,m,n,q=r.rev_tree.slice();n=q.pop();){var j=n.ids,s=j[2],k=n.pos;if(s.length){for(var i=0,g=s.length;g>i;i++){q.push({pos:k+1,ids:s[i]})}}else{var p=!!j[1].deleted,h=j[0];l&&!(m!==p?m:o!==k?k>o:h>l)||(l=h,o=k,m=p)}}return o+"-"+l}function ds(j,l){for(var h,o=j.slice();h=o.pop();){for(var g=h.pos,i=h.ids,k=i[2],m=l(0===k.length,g,i[0],h.ctx,i[1]),n=0,p=k.length;p>n;n++){o.push({pos:g+1,ids:k[n],ctx:m})}}}function jQ(g,h){return g.pos-h.pos}function bV(j){var h=[];ds(j,function(o,l,n,k,m){o&&h.push({rev:l+"-"+n,pos:l,opts:m})}),h.sort(jQ).reverse();for(var g=0,i=h.length;i>g;g++){delete h[g].pos}return h}function du(i){for(var l=dZ(i),g=bV(i.rev_tree),m=[],j=0,k=g.length;k>j;j++){var h=g[j];h.rev===l||h.opts.deleted||m.push(h.rev)}return m}function cP(g){var h=[];return ds(g.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(h.push(i+"-"+k),j.status="missing")}),h}function e8(r){for(var l,o=[],m=r.slice();l=m.pop();){var n=l.pos,q=l.ids,j=q[0],s=q[1],k=q[2],i=0===k.length,g=l.history?l.history.slice():[];g.push({id:j,opts:s}),i&&o.push({pos:n+1-g.length,ids:g});for(var p=0,h=k.length;h>p;p++){m.push({pos:n+1,ids:k[p],history:g})}}return o.reverse()}function bP(g,h){return g.pos-h.pos}function bi(l,j,i){for(var k,h=0,g=l.length;g>h;){k=h+g>>>1,i(l[k],j)<0?h=k+1:g=k}return h}function jJ(j,h,g){var i=bi(j,h,g);j.splice(i,0,h)}function af(h,i){for(var j,k,m=i,n=h.length;n>m;m++){var l=h[m],g=[l.id,l.opts,[]];k?(k[2].push(g),k=g):j=k=g}return j}function c4(g,h){return g[0]<h[0]?-1:1}function f0(j,l){for(var h=[{tree1:j,tree2:l}],o=!1;h.length>0;){var g=h.pop(),i=g.tree1,k=g.tree2;(i[1].status||k[1].status)&&(i[1].status="available"===i[1].status||"available"===k[1].status?"available":"missing");for(var m=0;m<k[2].length;m++){if(i[2][0]){for(var n=!1,p=0;p<i[2].length;p++){i[2][p][0]===k[2][m][0]&&(h.push({tree1:i[2][p],tree2:k[2][m]}),n=!0)}n||(o="new_branch",jJ(i[2],k[2][m],c4))}else{o="new_leaf",i[2][0]=k[2][m]}}}return{conflicts:o,tree:j}}function aP(n,u,m){var x,k=[],p=!1,r=!1;if(!n.length){return{tree:[u],conflicts:"new_leaf"}}for(var w=0,j=n.length;j>w;w++){var z=n[w];if(z.pos===u.pos&&z.ids[0]===u.ids[0]){x=f0(z.ids,u.ids),k.push({pos:z.pos,ids:x.tree}),p=p||x.conflicts,r=!0}else{if(m!==!0){var v=z.pos<u.pos?z:u,o=z.pos<u.pos?u:z,s=o.pos-v.pos,q=[],i=[];for(i.push({ids:v.ids,diff:s,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],A=0,y=g.length;y>A;A++){i.push({ids:g[A],diff:h.diff-1,parent:h.ids,parentIdx:A})}}else{h.ids[0]===o.ids[0]&&q.push(h)}}var l=q[0];l?(x=f0(l.ids,o.ids),l.parent[2][l.parentIdx]=x.tree,k.push({pos:v.pos,ids:v.ids}),p=p||x.conflicts,r=!0):k.push(z)}else{k.push(z)}}}return r||k.push(u),k.sort(bP),{tree:k,conflicts:p||"internal_node"}}function fM(r,l){for(var o,m=e8(r),n={},q=0,j=m.length;j>q;q++){for(var s=m[q],k=s.ids,i=Math.max(0,k.length-l),g={pos:s.pos+i,ids:af(k,i)},p=0;i>p;p++){var h=s.pos+p+"-"+k[p].id;n[h]=!0}o=o?aP(o,g,!0).tree:[g]}return ds(o,function(u,w,v){delete n[w+"-"+v]}),{tree:o,revs:Object.keys(n)}}function dh(k,i,h){var j=aP(k,i),g=fM(j.tree,h);return{tree:g.tree,stemmedRevs:g.revs,conflicts:j.conflicts}}function dH(j,l){for(var h,o=j.slice(),g=l.split("-"),i=parseInt(g[0],10),k=g[1];h=o.pop();){if(h.pos===i&&h.ids[0]===k){return !0}for(var m=h.ids[2],n=0,p=m.length;p>n;n++){o.push({pos:h.pos+1,ids:m[n]})}}return !1}function cd(g){return g.ids}function jY(k,i){i||(i=dZ(k));for(var h,j=i.substring(i.indexOf("-")+1),g=k.rev_tree.map(cd);h=g.pop();){if(h[0]===j){return !!h[1].deleted}g=g.concat(h[2])}}function cI(g){return/^_local/.test(g)}function eM(g){return d5("return "+g+";",{})}function aA(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function fB(i,h){try{i.emit("change",h)}catch(g){av("error",'Error in .on("change", function):',g)}}function aT(i,l,g){function m(){j.cancel()}aX.EventEmitter.call(this);var j=this;this.db=i,l=l?ch(l):{};var k=l.complete=eC(function(n,o){n?bq(j,"error")>0&&j.emit("error",n):j.emit("complete",o),j.removeAllListeners(),i.removeListener("destroyed",m)});g&&(j.on("complete",function(n){g(null,n)}),j.on("error",g)),i.once("destroyed",m),l.onChange=function(n){l.isCancelled||(fB(j,n),j.startSeq&&j.startSeq<=n.seq&&(j.startSeq=!1))};var h=new e9(function(n,o){l.complete=function(p,q){p?o(p):n(q)}});j.once("cancel",function(){i.removeListener("destroyed",m),l.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){k(null,n)},k),i.taskqueue.isReady?j.doChanges(l):i.taskqueue.addTask(function(){j.isCancelled?j.emit("cancel"):j.doChanges(l)})}function aI(k,i,h){var j=[{rev:k._rev}];"all_docs"===h.style&&(j=bV(i.rev_tree).map(function(l){return{rev:l.rev}}));var g={id:i.id,changes:j,doc:k};return jY(i,k._rev)&&(g.deleted=!0),h.conflicts&&(g.doc._conflicts=du(i),g.doc._conflicts.length||delete g.doc._conflicts),g}function eY(g,h){return h>g?-1:g>h?1:0}function eS(i,h){for(var g=0;g<i.length;g++){if(h(i[g],g)===!0){return i[g]}}}function dT(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function ki(l){for(var j=0;j<l.length;j++){var i=l[j];if(i._deleted){delete i._attachments}else{if(i._attachments){for(var k=Object.keys(i._attachments),h=0;h<k.length;h++){var g=k[h];i._attachments[g]=dy(i._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function ek(k,i){var h=eY(k._id,i._id);if(0!==h){return h}var j=k._revisions?k._revisions.start:0,g=i._revisions?i._revisions.start:0;return eY(j,g)}function cm(i){var h={},g=[];return ds(i,function(j,n,k,m){var l=n+"-"+k;return j&&(h[l]=0),void 0!==m&&g.push({from:m,to:l}),l}),g.reverse(),g.forEach(function(j){void 0===h[j.from]?h[j.from]=1+h[j.to]:h[j.from]=Math.min(h[j.from],1+h[j.to])}),h}function eI(k,i,h){var j="limit" in i?i.keys.slice(i.skip,i.limit+i.skip):i.skip>0?i.keys.slice(i.skip):i.keys;if(i.descending&&j.reverse(),!j.length){return k._allDocs({limit:0},h)}var g={offset:i.skip};return e9.all(j.map(function(m){var l=d0.extend({key:m,deleted:"ok"},i);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new e9(function(n,o){k._allDocs(l,function(q,p){return q?o(q):(g.total_rows=p.total_rows,void n(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return g.rows=l,g})}function cV(j){var h=j._compactionQueue[0],i=h.opts,g=h.callback;j.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(i.last_seq=k.last_seq),j._compact(i,function(l,m){l?g(l):g(null,m),c1.nextTick(function(){j._compactionQueue.shift(),j._compactionQueue.length&&cV(j)})})})}function bH(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function eU(){aX.EventEmitter.call(this)}function bR(){this.isReady=!1,this.failed=!1,this.queue=[]}function eh(g){g&&dX.debug&&av("error",g)}function bd(i,l){function g(){k.emit("destroyed",j)}function m(){i.removeListener("destroyed",g),i.emit("destroyed",i)}var j=l.originalName,k=i.constructor,h=k._destructionListeners;i.once("destroyed",g),h.has(j)||h.set(j,[]),h.get(j).push(m)}function c9(i,l,g){if(!(this instanceof c9)){return new c9(i,l,g)}var m=this;if("function"!=typeof l&&"undefined"!=typeof l||(g=l,l={}),i&&"object"==typeof i&&(l=i,i=void 0),"undefined"==typeof g){g=eh}else{var j=g;g=function(){return av("warn","Using a callback for new PouchDB()is deprecated."),j.apply(null,arguments)}}i=i||l.name,l=ch(l),delete l.name,this.__opts=l;var k=g;m.auto_compaction=l.auto_compaction,m.prefix=c9.prefix,eU.call(m),m.taskqueue=new bR;var h=new e9(function(n,p){g=function(r,s){return r?p(r):(delete s.then,void n(s))},l=ch(l);var o,q;return function(){try{if("string"!=typeof i){throw q=new Error("Missing/invalid DB name"),q.code=400,q}var r=(l.prefix||"")+i;if(o=c9.parseAdapter(r,l),l.originalName=i,l.name=o.name,l.adapter=l.adapter||o.adapter,m._adapter=l.adapter,dO("pouchdb:adapter")("Picked adapter: "+l.adapter),m._db_name=i,!c9.adapters[l.adapter]){throw q=new Error("Adapter is missing"),q.code=404,q}if(!c9.adapters[l.adapter].valid()){throw q=new Error("Invalid Adapter"),q.code=404,q}}catch(s){m.taskqueue.fail(s)}}(),q?p(q):(m.adapter=l.adapter,m.replicate={},m.replicate.from=function(r,u,s){return m.constructor.replicate(r,m,u,s)},m.replicate.to=function(r,u,s){return m.constructor.replicate(m,r,u,s)},m.sync=function(r,u,s){return m.constructor.sync(m,r,u,s)},m.replicate.sync=m.sync,void c9.adapters[l.adapter].call(m,l,function(r){return r?(m.taskqueue.fail(r),void g(r)):(bd(m,l),m.emit("created",m),c9.emit("created",l.originalName),m.taskqueue.ready(m),void g(null,m))}))});h.then(function(n){k(null,n)},k),m.then=h.then.bind(h),m["catch"]=h["catch"].bind(h)}function eR(g){Object.keys(aX.EventEmitter.prototype).forEach(function(i){"function"==typeof aX.EventEmitter.prototype[i]&&(g[i]=c2[i].bind(c2))});var h=g._destructionListeners=new bz.Map;g.on("destroyed",function(i){h.get(i).forEach(function(j){j()}),h["delete"](i)})}function e3(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function dk(j){if(!/^\d+\-./.test(j)){return cU(ck)}var h=j.indexOf("-"),g=j.substring(0,h),i=j.substring(h+1);return{prefix:parseInt(g,10),id:i}}function dE(i,l){for(var g=i.start-i.ids.length+1,m=i.ids,j=[m[0],l,[]],k=1,h=m.length;h>k;k++){j=[m[k],{status:"missing"},[j]]}return[{pos:g,ids:j}]}function dv(j,l){var h,o,g,i={status:"available"};if(j._deleted&&(i.deleted=!0),l){if(j._id||(j._id=cE()),o=cE(32,16).toLowerCase(),j._rev){if(g=dk(j._rev),g.error){return g}j._rev_tree=[{pos:g.prefix,ids:[g.id,{status:"missing"},[[o,i,[]]]]}],h=g.prefix+1}else{j._rev_tree=[{pos:1,ids:[o,i,[]]}],h=1}}else{if(j._revisions&&(j._rev_tree=dE(j._revisions,i),h=j._revisions.start,o=j._revisions.ids[0]),!j._rev_tree){if(g=dk(j._rev),g.error){return g}h=g.prefix,o=g.id,j._rev_tree=[{pos:h,ids:[o,i,[]]}]}}bS(j._id),j._rev=h+"-"+o;var k={metadata:{},data:{}};for(var m in j){if(Object.prototype.hasOwnProperty.call(j,m)){var n="_"===m[0];if(n&&!fG[m]){var p=cU(ka,m);throw p.message=ka.message+": "+m,p}n&&!cu[m]?k.metadata[m.slice(1)]=j[m]:k.data[m]=j[m]}}return k}function jW(k){for(var i="",h=new Uint8Array(k),j=h.byteLength,g=0;j>g;g++){i+=String.fromCharCode(h[g])}return i}function bk(g){return dV(jW(g))}function eg(l,j){l=l||[],j=j||{};try{return new Blob(l,j)}catch(i){if("TypeError"!==i.name){throw i}for(var k="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,h=new k,g=0;g<l.length;g+=1){h.append(l[g])}return h.getBlob(j.type)}}function cO(k){for(var i=k.length,h=new ArrayBuffer(i),j=new Uint8Array(h),g=0;i>g;g++){j[g]=k.charCodeAt(g)}return h}function db(g,h){return eg([cO(g)],{type:h})}function aQ(g,h){return db(d1(g),h)}function t(j,h){if("undefined"==typeof FileReader){return h(jW((new FileReaderSync).readAsArrayBuffer(j)))}var g=new FileReader,i="function"==typeof g.readAsBinaryString;g.onloadend=function(k){var l=k.target.result||"";return i?h(l):void h(jW(l))},i?g.readAsBinaryString(j):g.readAsArrayBuffer(j)}function cR(g,h){t(g,function(i){h(dV(i))})}function jN(i,h){if("undefined"==typeof FileReader){return h((new FileReaderSync).readAsArrayBuffer(i))}var g=new FileReader;g.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);h(k)},g.readAsArrayBuffer(i)}function fK(g){return dV(g)}function j8(j,h,g,i){(g>0||i<h.byteLength)&&(h=new Uint8Array(h,g,Math.min(i,h.byteLength)-g)),j.append(h)}function eA(j,h,g,i){(g>0||i<h.length)&&(h=h.substring(g,i)),j.appendBinary(h)}function j1(j,l){function h(){var q=m*i,u=q+i;if(m++,k>m){p(n,j,q,u),dP(h)}else{p(n,j,q,u);var r=n.end(!0),s=fK(r);l(s),n.destroy()}}var o="string"==typeof j,g=o?j.length:j.byteLength,i=Math.min(bG,g),k=Math.ceil(g/i),m=0,n=o?new cY:new cY.ArrayBuffer,p=o?eA:j8;h()}function dj(g){return cY.hash(g)}function fJ(h,i,j){function k(o){try{return d1(o)}catch(q){var p=cU(eW,"Attachment is not a valid base64 string");return{error:p}}}function m(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=k(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===i?q.data=db(o,q.content_type):"base64"===i?q.data=dV(o):q.data=o,j1(o,function(r){q.digest="md5-"+r,p()})}else{jN(q.data,function(r){"binary"===i?q.data=jW(r):"base64"===i&&(q.data=bk(r)),j1(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function n(){g++,h.length===g&&(l?j(l):j())}if(!h.length){return j()}var l,g=0;h.forEach(function(r){function p(u){l=u,q++,q===s.length&&n()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return n()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&m(r.data._attachments[o],p)}})}function bM(k,v,i,A,h,w,u,l){if(dH(v.rev_tree,i.metadata.rev)){return A[h]=i,w()}var g=v.winningRev||dZ(v),m="deleted" in v?v.deleted:jY(v,g),y="deleted" in i.metadata?i.metadata.deleted:jY(i.metadata),n=/^1-/.test(i.metadata.rev);if(m&&!y&&l&&n){var j=i.data;j._rev=g,j._id=i.metadata.id,i=dv(j,l)}var z=dh(v.rev_tree,i.metadata.rev_tree[0],k),p=l&&(m&&y||!m&&"new_leaf"!==z.conflicts||m&&!y&&"new_branch"===z.conflicts);if(p){var q=cU(bw);return A[h]=q,w()}var s=i.metadata.rev;i.metadata.rev_tree=z.tree,i.stemmedRevs=z.stemmedRevs||[],v.rev_map&&(i.metadata.rev_map=v.rev_map);var B,x=dZ(i.metadata),o=jY(i.metadata,x),r=m===o?0:o>m?-1:1;B=s===x?o:jY(i.metadata,s),u(i,x,o,B,!0,r,h,w)}function j7(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function c3(m,o,g,k,q,i,n,u,s){function j(B,x,C){var D=dZ(B.metadata),z=jY(B.metadata,D);if("was_delete" in u&&z){return i[x]=cU(by,"deleted"),C()}var A=l&&j7(B);if(A){var w=cU(bw);return i[x]=w,C()}var y=z?0:1;n(B,D,z,z,!1,y,x,C)}function v(){++h===p&&s&&s()}m=m||1000;var l=u.new_edits,r=new bz.Map,h=0,p=o.length;o.forEach(function(w,y){if(w._id&&cI(w._id)){var z=w._deleted?"_removeLocal":"_putLocal";return void g[z](w,{ctx:q},function(B,A){i[y]=B||A,v()})}var x=w.metadata.id;r.has(x)?(p--,r.get(x).push([w,y])):r.set(x,[[w,y]])}),r.forEach(function(z,x){function w(){++y<z.length?A():v()}function A(){var C=z[y],E=C[0],D=C[1];if(k.has(x)){bM(m,k.get(x),E,i,D,w,n,l)}else{var B=dh([],E.metadata.rev_tree[0],m);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],j(E,D,w)}}var y=0;A()})}function cH(g){try{return JSON.parse(g)}catch(h){return cf.parse(g)}}function cp(g){return g.length<50000?JSON.parse(g):cH(g)}function dz(g){try{return JSON.stringify(g)}catch(h){return cf.stringify(g)}}function jV(k,i,h,j){try{k.apply(i,h)}catch(g){j.emit("error",g)}}function bl(g){if(!dW.running&&dW.queue.length){dW.running=!0;var h=dW.queue.shift();h.action(function(i,j){jV(h.callback,this,[i,j],g),dW.running=!1,c1.nextTick(function(){bl(g)})})}}function e(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(cU(bW,i,h.type))}}function b8(i,h,g){return{data:dz(i),winningRev:h,deletedOrLocal:g?"1":"0",seq:i.seq,id:i.id}}function aO(g){if(!g){return null}var h=cp(g.data);return h.winningRev=g.winningRev,h.deleted="1"===g.deletedOrLocal,h.seq=g.seq,h}function jM(g){if(!g){return g}var h=g._doc_id_rev.lastIndexOf(":");return g._id=g._doc_id_rev.substring(0,h-1),g._rev=g._doc_id_rev.substring(h+1),delete g._doc_id_rev,g}function fE(j,h,g,i){g?i(j?"string"!=typeof j?j:aQ(j,h):eg([""],{type:h})):j?"string"!=typeof j?t(j,function(k){i(dV(k))}):i(j):i("")}function cZ(h,i,j,k){function m(){++g===l.length&&k&&k()}function n(s,q){var r=s._attachments[q],p=r.digest,o=j.objectStore(dl).get(p);o.onsuccess=function(u){r.body=u.target.result.body,m()}}var l=Object.keys(h._attachments||{});if(!l.length){return k&&k()}var g=0;l.forEach(function(o){i.attachments&&i.include_docs?n(h,o):(h._attachments[o].stub=!0,m())})}function b1(g,h){return e9.all(g.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return e9.all(j.map(function(k){var m=i.doc._attachments[k];if("body" in m){var n=m.body,l=m.content_type;return new e9(function(o){fE(n,l,h,function(p){i.doc._attachments[k]=d0.extend(dy(m,["digest","content_type"]),{data:p}),o()})})}}))}}))}function aR(j,l,h){function o(){p--,p||g()}function g(){i.length&&i.forEach(function(q){var r=n.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||m["delete"](q)}})}var i=[],k=h.objectStore(e7),m=h.objectStore(dl),n=h.objectStore(bT),p=j.length;j.forEach(function(s){var r=k.index("_doc_id_rev"),q=l+"::"+s;r.getKey(q).onsuccess=function(w){var v=w.target.result;if("number"!=typeof v){return o()}k["delete"](v);var u=n.index("seq").openCursor(IDBKeyRange.only(v));u.onsuccess=function(y){var x=y.target.result;if(x){var z=x.value.digestSeq.split("::")[0];i.push(z),n["delete"](x.primaryKey),x["continue"]()}else{o()}}}})}function bs(j,h,g){try{return{txn:j.transaction(h,g)}}catch(i){return{error:i}}}function aE(m,j,p,y,n,x,u){function v(){var P=[cA,e7,dl,bx,bT],O=bs(n,P,"readwrite");return O.error?u(O.error):(A=O.txn,A.onabort=e(u),A.ontimeout=e(u),A.oncomplete=l,E=A.objectStore(cA),q=A.objectStore(e7),I=A.objectStore(dl),w=A.objectStore(bT),void g(function(Q){return Q?(s=!0,u(Q)):void h()}))}function r(){c3(m.revs_limit,z,y,N,A,L,G,p)}function h(){function R(){++T===z.length&&r()}function P(W){var V=aO(W.target.result);V&&N.set(V.id,V),R()}if(z.length){for(var T=0,Q=0,S=z.length;S>Q;Q++){var O=z[Q];if(O._id&&cI(O._id)){R()}else{var U=E.get(O.metadata.id);U.onsuccess=P}}}}function l(){s||(x.notify(y._meta.name),y._meta.docCount+=B,u(null,L))}function D(P,O){var Q=I.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=cU(cM,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(z.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){D(T,function(U){U&&!P&&(P=U),O()})})}function G(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?C(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(an){var ae=X.stemmedRevs||[];R&&y.auto_compaction&&(ae=ae.concat(cP(X.metadata))),ae&&ae.length&&aR(ae,X.metadata.id,A),T.seq=an.target.result,delete T.rev;var ao=b8(T,Q,S),ai=E.put(ao);ai.onsuccess=Z}function P(ae){ae.preventDefault(),ae.stopPropagation();var an=q.index("_doc_id_rev"),ai=an.getKey(V._doc_id_rev);ai.onsuccess=function(ar){var ao=q.put(V,ar.target.result);ao.onsuccess=W}}function Z(){L[U]={ok:!0,id:T.id,rev:Q},N.set(X.metadata.id,X.metadata),k(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=q.put(V);Y.onsuccess=W,Y.onerror=P}function C(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(ai){var Z=W.data._attachments[ai];if(Z.stub){X++,Y()}else{var ae=Z.data;delete Z.data,Z.revpos=parseInt(P,10);var an=Z.digest;H(an,ae,Q)}})}function k(T,Q,V){function S(){++P===O.length&&V()}function U(Y){var X=T.data._attachments[Y].digest,W=w.put({seq:Q,digestSeq:X+"::"+Q});W.onsuccess=S,W.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),S()}}var P=0,O=Object.keys(T.data._attachments||{});if(!O.length){return V()}for(var R=0;R<O.length;R++){U(O[R])}}function H(Q,O,R){var P=I.count(Q);P.onsuccess=function(T){var U=T.target.result;if(U){return R()}var S={digest:Q,body:O},V=I.put(S);V.onsuccess=R}}for(var A,E,q,I,w,o,z=j.docs,B=0,F=0,J=z.length;J>F;F++){var M=z[F];M._id&&cI(M._id)||(M=z[F]=dv(M,p.new_edits),M.error&&!o&&(o=M))}if(o){return u(o)}var L=new Array(z.length),N=new bz.Map,s=!1,i=y._meta.blobSupport?"blob":"base64";fJ(z,i,function(O){return O?u(O):void v()})}function cw(l,j,i,k,h){try{if(l&&j){return h?IDBKeyRange.bound(j,l,!i,!1):IDBKeyRange.bound(l,j,!1,!i)}if(l){return h?IDBKeyRange.upperBound(l):IDBKeyRange.lowerBound(l)}if(j){return h?IDBKeyRange.lowerBound(j,!i):IDBKeyRange.upperBound(j,!i)}if(k){return IDBKeyRange.only(k)}}catch(g){return{error:g}}return null}function aB(j,h,g,i){return"DataError"===g.name&&0===g.code?i(null,{total_rows:j._meta.docCount,offset:h.skip,rows:[]}):void i(cU(bW,g.name,g.message))}function bB(l,j,i,k){function h(z,I){function A(O,N,L){var M=O.id+"::"+L;p.get(M).onsuccess=function(P){N.doc=jM(P.target.result),z.conflicts&&(N.doc._conflicts=du(O)),cZ(N.doc,z,G)}}function v(M,O,N){var L={id:N.id,key:N.id,value:{rev:O}},P=N.deleted;if("ok"===z.deleted){w.push(L),P?(L.value.deleted=!0,L.doc=null):z.include_docs&&A(N,L,O)}else{if(!P&&E--<=0&&(w.push(L),z.include_docs&&A(N,L,O),0===--o)){return}}M["continue"]()}function F(L){K=j._meta.docCount;var N=L.target.result;if(N){var O=aO(N.value),M=O.winningRev;v(N,M,O)}}function C(){I(null,{total_rows:K,offset:z.skip,rows:w})}function J(){z.attachments?b1(w,z.binary).then(C):C()}var u="startkey" in z?z.startkey:!1,q="endkey" in z?z.endkey:!1,r="key" in z?z.key:!1,E=z.skip||0,o="number"==typeof z.limit?z.limit:-1,H=z.inclusive_end!==!1,B="descending" in z&&z.descending?"prev":null,y=cw(u,q,H,r,B);if(y&&y.error){return aB(j,z,y.error,I)}var s=[cA,e7];z.attachments&&s.push(dl);var x=bs(i,s,"readonly");if(x.error){return I(x.error)}var G=x.txn,D=G.objectStore(cA),n=G.objectStore(e7),m=B?D.openCursor(y,B):D.openCursor(y),p=n.index("_doc_id_rev"),w=[],K=0;G.oncomplete=J,m.onsuccess=F}function g(n,m){return 0===n.limit?m(null,{total_rows:j._meta.docCount,offset:n.skip,rows:[]}):void h(n,m)}g(l,k)}function bu(g){return new e9(function(h){var i=eg([""]);g.objectStore(aq).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function j0(i,h){var g=this;dW.queue.push({action:function(j){ay(g,i,j)},callback:h}),bl(g.constructor)}function ay(j,k,o){function q(x){var w=x.createObjectStore(cA,{keyPath:"id"});x.createObjectStore(e7,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(dl,{keyPath:"digest"}),x.createObjectStore(c7,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aq),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(bx,{keyPath:"_id"});var v=x.createObjectStore(bT,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function s(x,w){var v=x.objectStore(cA);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=jY(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function n(v){v.createObjectStore(bx,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function i(w,y){var x=w.objectStore(bx),z=w.objectStore(cA),v=w.objectStore(e7),A=z.openCursor();A.onsuccess=function(C){var L=C.target.result;if(L){var F=L.value,I=F.id,H=cI(I),E=dZ(F);if(H){var B=I+"::"+E,K=I+"::",D=I+"::~",M=v.index("_doc_id_rev"),J=IDBKeyRange.bound(K,D,!1,!1),G=M.openCursor(J);G.onsuccess=function(N){if(G=N.target.result){var O=G.value;O._doc_id_rev===B&&x.put(O),v["delete"](G.primaryKey),G["continue"]()}else{z["delete"](L.primaryKey),L["continue"]()}}}else{L["continue"]()}}else{y&&y()}}}function u(w){var v=w.createObjectStore(bT,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function g(w,y){var x=w.objectStore(e7),z=w.objectStore(dl),v=w.objectStore(bT),A=z.count();A.onsuccess=function(B){var C=B.target.result;return C?void (x.openCursor().onsuccess=function(I){var E=I.target.result;if(!E){return y()}for(var D=E.value,G=E.primaryKey,K=Object.keys(D._attachments||{}),M={},L=0;L<K.length;L++){var J=D._attachments[K[L]];M[J.digest]=!0}var H=Object.keys(M);for(L=0;L<H.length;L++){var F=H[L];v.put({seq:G,digestSeq:F+"::"+G})}E["continue"]()}):y()}}function l(x){function y(A){return A.data?aO(A):(A.deleted="1"===A.deletedOrLocal,A)}var w=x.objectStore(e7),v=x.objectStore(cA),z=v.openCursor();z.onsuccess=function(C){function D(){var H=A.id+"::",F=A.id+"::￿",G=w.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,B()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function B(){var G=b8(A,A.winningRev,A.deleted),F=v.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var A=y(E.value);return A.winningRev=A.winningRev||dZ(A),A.seq?B():void D()}}}var p=k.name,m=null;j._meta=null,j.type=function(){return"idb"},j._id=ed(function(v){v(null,j._meta.instanceId)}),j._bulkDocs=function(v,w,x){aE(k,v,w,j,m,bg,x)},j._get=function(z,D,C){function x(){C(A,{doc:y,metadata:w,ctx:v})}var y,w,A,v=D.ctx;if(!v){var B=bs(m,[cA,e7,dl],"readonly");if(B.error){return C(B.error)}v=B.txn}v.objectStore(cA).get(z).onsuccess=function(E){if(w=aO(E.target.result),!w){return A=cU(by,"missing"),x()}if(jY(w)&&!D.rev){return A=cU(by,"deleted"),x()}var G=v.objectStore(e7),H=D.rev||w.winningRev,F=w.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return y=I.target.result,y&&(y=jM(y)),y?void x():(A=cU(by,"missing"),x())}}},j._getAttachment=function(z,D,C,x,y){var w;if(x.ctx){w=x.ctx}else{var A=bs(m,[cA,e7,dl],"readonly");if(A.error){return y(A.error)}w=A.txn}var v=C.digest,B=C.content_type;w.objectStore(dl).get(v).onsuccess=function(E){var F=E.target.result.body;fE(F,B,x.binary,function(G){y(null,G)})}},j._info=function(A){if(null===m||!dQ.has(p)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var x,w,v=bs(m,[e7],"readonly");if(v.error){return A(v.error)}var z=v.txn,B=z.objectStore(e7).openCursor(null,"prev");B.onsuccess=function(D){var C=D.target.result;x=C?C.key:0,w=j._meta.docCount},z.oncomplete=function(){A(null,{doc_count:w,update_seq:x,idb_attachment_format:j._meta.blobSupport?"binary":"base64"})}},j._allDocs=function(v,w){bB(v,j,m,w)},j._changes=function(C){function w(N){function T(){return S.seq!==O?N["continue"]():(M=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=B.get(U);V.onsuccess=function(W){R(jM(W.target.result))}}function R(V){var W=C.processChange(V,S,C);W.seq=S.seq;var U=I(W);return"object"==typeof U?C.complete(U):(U&&(x++,L&&G.push(W),C.attachments&&C.include_docs?cZ(V,C,F,function(){b1([W],C.binary).then(function(){C.onChange(W)})}):C.onChange(W)),void (x!==J&&N["continue"]()))}var P=jM(N.value),O=N.key;if(E&&!E.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (H.get(P._id).onsuccess=function(U){S=aO(U.target.result),y.set(P._id,S),T()})}function K(N){var O=N.target.result;O&&w(O)}function D(){var P=[cA,e7];C.attachments&&P.push(dl);var O=bs(m,P,"readonly");if(O.error){return C.complete(O.error)}F=O.txn,F.onabort=e(C.complete),F.oncomplete=A,z=F.objectStore(e7),H=F.objectStore(cA),B=z.index("_doc_id_rev");var N;N=C.descending?z.openCursor(null,"prev"):z.openCursor(IDBKeyRange.lowerBound(C.since,!0)),N.onsuccess=K}function A(){function N(){C.complete(null,{results:G,last_seq:M})}!C.continuous&&C.attachments?b1(G).then(N):N()}if(C=ch(C),C.continuous){var v=p+":"+cE();return bg.addListener(p,v,j,C),bg.notify(p),{cancel:function(){bg.removeListener(p,v)}}}var E=C.doc_ids&&new bz.Set(C.doc_ids);C.since=C.since||0;var M=C.since,J="limit" in C?C.limit:-1;0===J&&(J=1);var L;L="return_docs" in C?C.return_docs:"returnDocs" in C?C.returnDocs:!0;var F,z,H,B,G=[],x=0,I=eG(C),y=new bz.Map;D()},j._close=function(v){return null===m?v(cU(bm)):(m.close(),dQ["delete"](p),m=null,void v())},j._getRevisionTree=function(x,y){var w=bs(m,[cA],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(cA).get(x);z.onsuccess=function(B){var A=aO(B.target.result);A?y(null,A.rev_tree):y(cU(by))}},j._doCompaction=function(y,A,w){var B=[cA,e7,dl,bT],x=bs(m,B,"readwrite");if(x.error){return w(x.error)}var v=x.txn,z=v.objectStore(cA);z.get(y).onsuccess=function(E){var C=aO(E.target.result);ds(C.rev_tree,function(I,K,H,J,G){var L=K+"-"+H;-1!==A.indexOf(L)&&(G.status="missing")}),aR(A,y,v);var D=C.winningRev,F=C.deleted;v.objectStore(cA).put(b8(C,D,F))},v.onabort=e(w),v.oncomplete=function(){w()}},j._getLocal=function(x,y){var w=bs(m,[bx],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(bx).get(x);z.onerror=e(y),z.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,y(null,A)):y(cU(by))}},j._putLocal=function(z,E,C){"function"==typeof E&&(C=E,E={}),delete z._revisions;var x=z._rev,y=z._id;x?z._rev="0-"+(parseInt(x.split("-")[1],10)+1):z._rev="0-1";var w,B=E.ctx;if(!B){var v=bs(m,[bx],"readwrite");if(v.error){return C(v.error)}B=v.txn,B.onerror=e(C),B.oncomplete=function(){w&&C(null,w)}}var D,A=B.objectStore(bx);x?(D=A.get(y),D.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===x){var F=A.put(z);F.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)}}else{C(cU(bw))}}):(D=A.add(z),D.onerror=function(F){C(cU(bw)),F.preventDefault(),F.stopPropagation()},D.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)})},j._removeLocal=function(z,D,C){"function"==typeof D&&(C=D,D={});var x=D.ctx;if(!x){var y=bs(m,[bx],"readwrite");if(y.error){return C(y.error)}x=y.txn,x.oncomplete=function(){w&&C(null,w)}}var w,A=z._id,v=x.objectStore(bx),B=v.get(A);B.onerror=e(C),B.onsuccess=function(F){var E=F.target.result;E&&E._rev===z._rev?(v["delete"](A),w={ok:!0,id:A,rev:"0-0"},D.ctx&&C(null,w)):C(cU(by))}},j._destroy=function(v,x){bg.removeAllListeners(p);var w=bL.get(p);w&&w.result&&(w.result.close(),dQ["delete"](p));var y=indexedDB.deleteDatabase(p);y.onsuccess=function(){bL["delete"](p),dd()&&p in localStorage&&delete localStorage[p],x(null,{ok:!0})},y.onerror=e(x)};var h=dQ.get(p);if(h){return m=h.idb,j._meta=h.global,void c1.nextTick(function(){o(null,j)})}var r;r=k.storage?aG(p,k.storage):indexedDB.open(p,dG),bL.set(p,r),r.onupgradeneeded=function(y){function w(){var B=v[A-1];A++,B&&B(x,w)}var z=y.target.result;if(y.oldVersion<1){return q(z)}var x=y.currentTarget.transaction;y.oldVersion<3&&n(z),y.oldVersion<4&&u(z);var v=[s,i,g,l],A=y.oldVersion;w()},r.onsuccess=function(z){m=z.target.result,m.onversionchange=function(){m.close(),dQ["delete"](p)},m.onabort=function(B){av("error","Database has a global failure",B.target.error),m.close(),dQ["delete"](p)};var x=m.transaction([c7,aq,cA],"readwrite"),v=x.objectStore(c7).get(c7),y=null,w=null,A=null;v.onsuccess=function(D){var B=function(){null!==y&&null!==w&&null!==A&&(j._meta={name:p,instanceId:A,blobSupport:y,docCount:w},dQ.set(p,{idb:m,global:j._meta}),o(null,j))},E=D.target.result||{id:c7};p+"_id" in E?(A=E[p+"_id"],B()):(A=cE(),E[p+"_id"]=A,x.objectStore(c7).put(E).onsuccess=function(){B()}),bA||(bA=bu(x)),bA.then(function(F){y=F,B()});var C=x.objectStore(cA).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){w=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";av("error",v),o(cU(bW,v))}}function aG(i,h){try{return indexedDB.open(i,{version:dG,storage:h})}catch(g){return indexedDB.open(i,dG)}}function b4(g){g.adapter("idb",j0,!0)}function b5(g){return decodeURIComponent(escape(g))}function cX(g){return 65>g?g-48:g-55}function al(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(cX(j.charCodeAt(h++))<<4|cX(j.charCodeAt(h++)))}return i}function bY(j,h,g){for(var i="";g>h;){i+=String.fromCharCode(cX(j.charCodeAt(h+2))<<12|cX(j.charCodeAt(h+3))<<8|cX(j.charCodeAt(h))<<4|cX(j.charCodeAt(h+1))),h+=4}return i}function c5(g,h){return"UTF-8"===h?b5(al(g,0,g.length)):bY(g,0,g.length)}function bh(g){return"'"+g+"'"}function aS(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function aV(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aJ(g){return delete g._id,delete g._rev,JSON.stringify(g)}function bf(i,h,g){return i=JSON.parse(i),i._id=h,i._rev=g,i}function cK(g){for(var h="(";g--;){h+="?",g&&(h+=",")}return h+")"}function aM(k,i,h,j,g){return"SELECT "+k+" FROM "+("string"==typeof i?i:i.join(" JOIN "))+(h?" ON "+h:"")+(j?" WHERE "+("string"==typeof j?j:j.join(" AND ")):"")+(g?" ORDER BY "+g:"")}function aH(i,l,g){function m(){++k===i.length&&j()}function j(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+a9+" WHERE seq IN "+cK(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+a9+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(u){var v="SELECT digest FROM "+a9+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";u.executeSql(v,s,function(x,y){for(var w=new bz.Set,z=0;z<y.rows.length;z++){w.add(y.rows.item(z).digest)}s.forEach(function(A){w.has(A)||(x.executeSql("DELETE FROM "+a9+" WHERE digest=?",[A]),x.executeSql("DELETE FROM "+am+" WHERE digest=?",[A]))})})})}})}}if(i.length){var k=0,h=[];i.forEach(function(n){var o="SELECT seq FROM "+el+" WHERE doc_id=? AND rev=?";g.executeSql(o,[l,n],function(q,p){if(!p.rows.length){return m()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+el+" WHERE seq=?",[r],m)})})}}function ej(g){return function(h){av("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(cU(ea,j,i))}}function aw(g){if("size" in g){return 1000000*g.size}var h="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return h?5000000:1}function cy(x,u,k,g,i,C,B){function n(){return w?B(w):(C.notify(g._name),g._docCount=-1,void B(null,r))}function s(E,D){var F="SELECT count(*) as cnt FROM "+am+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=cU(cM,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function y(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){s(I,function(J){J&&!E&&(E=J),D()})})}function h(N,G,Q,L,J,D,I,F){function P(){function V(ar,a0){function at(){return ++ao===an.length&&a0(),!1}function ai(a2){var a3="INSERT INTO "+a9+" (digest, seq) VALUES (?,?)",a1=[U._attachments[a2].digest,ar];p.executeSql(a3,a1,at,at)}var ao=0,an=Object.keys(U._attachments||{});if(!an.length){return a0()}for(var ae=0;ae<an.length;ae++){ai(an[ae])}}var U=N.data,X=L?1:0,S=U._id,W=U._rev,Y=aJ(U),Z="INSERT INTO "+el+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",T=[S,W,Y,X];p.executeSql(Z,T,function(ai,ae){var an=ae.insertId;V(an,function(){O(ai,an)})},function(){var ae=aM("seq",el,null,"doc_id=? AND rev=?");return p.executeSql(ae,[S,W],function(ar,ai){var an=ai.rows.item(0).seq,ao="UPDATE "+el+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[Y,X,S,W];ar.executeSql(ao,at,function(a0){V(an,function(){O(a0,an)})})}),!1})}function M(S){K||(S?(K=S,F(K)):E===R.length&&P())}function H(S){E++,M(S)}function O(X,W){var S=N.metadata.id,Y=N.stemmedRevs||[];J&&g.auto_compaction&&(Y=cP(N.metadata).concat(Y)),Y.length&&aH(Y,S,X),N.metadata.seq=W,delete N.metadata.rev;var T=J?"UPDATE "+jL+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+el+" WHERE doc_id="+jL+".id AND rev=?) WHERE id=?":"INSERT INTO "+jL+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",U=dz(N.metadata),V=J?[U,W,G,S]:[S,W,W,U];X.executeSql(T,V,function(){r[I]={ok:!0,id:N.metadata.id,rev:G},A.set(S,N.metadata),F()})}var K=null,E=0;N.data._id=N.metadata.id,N.data._rev=N.metadata.rev;var R=Object.keys(N.data._attachments||{});L&&(N.data._deleted=!0),R.forEach(function(S){var U=N.data._attachments[S];if(U.stub){E++,M()}else{var V=U.data;delete U.data,U.revpos=parseInt(G,10);var T=U.digest;v(T,V,H)}}),R.length||P()}function q(){c3(x.revs_limit,o,g,A,p,r,h,k)}function m(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&cI(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+jL+" WHERE id = ?",[H],function(K,J){if(J.rows.length){var I=cp(J.rows.item(0).json);A.set(H,I)}D()})})}function v(F,D,G){var E="SELECT digest FROM "+am+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+am+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,aS(D)],function(){G()},function(){return G(),!1}))})}var l=k.new_edits,j=u.docs,o=j.map(function(E){if(E._id&&cI(E._id)){return E}var D=dv(E,l);return D}),z=o.filter(function(D){return D.error});if(z.length){return B(z[0])}var p,w,r=new Array(o.length),A=new bz.Map;fJ(o,"binary",function(D){return D?B(D):void i.transaction(function(E){p=E,y(function(F){F?w=F:m(q)})},ej(B),n)})}function cQ(g){return g.websql(g.name,g.version,g.description,g.size)}function jT(g){try{return{db:cQ(g)}}catch(h){return{error:h}}}function dM(g){var h=f4.get(g.name);return h||(h=jT(g),f4.set(g.name,h),h.db&&(h.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),h}function ab(h,j,n,k,o){function g(){++m===l.length&&o&&o()}function i(q,s){var r=q._attachments[s],p={binary:j.binary,ctx:k};n._getAttachment(q._id,s,r,p,function(v,u){q._attachments[s]=d0.extend(dy(r,["digest","content_type"]),{data:u}),g()})}var l=Object.keys(h._attachments||{});if(!l.length){return o&&o()}var m=0;l.forEach(function(p){j.attachments&&j.include_docs?i(h,p):(h._attachments[p].stub=!0,g())})}function j4(A,o){function x(){dd()&&(window.localStorage["_pouch__websqldb_"+D._name]=!0),o(null,D)}function g(F,E){F.executeSql(ag),F.executeSql("ALTER TABLE "+el+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(cW),F.executeSql("ALTER TABLE "+jL+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+jL+" (local, id)");var G="SELECT "+jL+".winningseq AS seq, "+jL+".json AS metadata FROM "+el+" JOIN "+jL+" ON "+el+".seq = "+jL+".winningseq";F.executeSql(G,[],function(N,J){for(var M=[],H=[],I=0;I<J.rows.length;I++){var K=J.rows.item(I),L=K.seq,O=JSON.parse(K.metadata);jY(O)&&M.push(L),cI(O.id)&&H.push(O.id)}N.executeSql("UPDATE "+jL+"SET local = 1 WHERE id IN "+cK(H.length),H,function(){N.executeSql("UPDATE "+el+" SET deleted = 1 WHERE seq IN "+cK(M.length),M,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+kf+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+jL+".id AS id, "+el+".json AS data FROM "+el+" JOIN "+jL+" ON "+el+".seq = "+jL+".winningseq WHERE local = 1";F.executeSql(H,[],function(I,K){function M(){if(!J.length){return E(I)}var O=J.shift(),N=JSON.parse(O.data)._rev;I.executeSql("INSERT INTO "+kf+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+jL+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+el+" WHERE seq=?",[O.seq],function(){M()})})})}for(var J=[],L=0;L<K.rows.length;L++){J.push(K.rows.item(L))}M()})})}function k(G,E){function H(I){function J(){if(!I.length){return E(G)}var P=I.shift(),N=c5(P.hex,n),K=N.lastIndexOf("::"),O=N.substring(0,K),M=N.substring(K+2),L="UPDATE "+el+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(L,[O,M,N],function(){J()})}J()}var F="ALTER TABLE "+el+" ADD COLUMN doc_id";G.executeSql(F,[],function(I){var J="ALTER TABLE "+el+" ADD COLUMN rev";I.executeSql(J,[],function(K){K.executeSql(cB,[],function(M){var L="SELECT hex(doc_id_rev) as hex FROM "+el;M.executeSql(L,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function w(G,E){function H(J){var I="SELECT COUNT(*) AS cnt FROM "+am;J.executeSql(I,[],function(O,K){function N(){var Q=aM(ak+", "+jL+".id AS id",[jL,el],bD,null,jL+".id ");Q+=" LIMIT "+L+" OFFSET "+M,M+=L,O.executeSql(Q,[],function(ai,U){function Z(at,ar){var ao=W[at]=W[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!U.rows.length){return E(ai)}for(var W={},R=0;R<U.rows.length;R++){for(var T=U.rows.item(R),S=bf(T.data,T.id,T.rev),X=Object.keys(S._attachments||{}),an=0;an<X.length;an++){var V=S._attachments[X[an]];Z(V.digest,T.seq)}}var Y=[];if(Object.keys(W).forEach(function(ar){var ao=W[ar];ao.forEach(function(at){Y.push([ar,at])})}),!Y.length){return N()}var ae=0;Y.forEach(function(ao){var ar="INSERT INTO "+a9+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++ae===Y.length&&N()})})})}var P=K.rows.item(0).cnt;if(!P){return E(O)}var M=0,L=10;N()})}var F="CREATE TABLE IF NOT EXISTS "+a9+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(aW,[],function(J){J.executeSql(dx,[],H)})})}function y(F,E){var G="ALTER TABLE "+am+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function v(F,E){var G="ALTER TABLE "+jL+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+jL+" SET max_seq=(SELECT MAX(seq) FROM "+el+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+jL+" (max_seq)";J.executeSql(K,[],E)})})}function C(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;n=2===H.length?"UTF-8":"UTF-16",E()})}function s(){for(;i.length>0;){var E=i.pop();E(null,h)}}function B(L,H){if(0===H){var E="CREATE TABLE IF NOT EXISTS "+bX+" (dbid, db_version INTEGER)",N="CREATE TABLE IF NOT EXISTS "+am+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",K="CREATE TABLE IF NOT EXISTS "+a9+" (digest, seq INTEGER)",I="CREATE TABLE IF NOT EXISTS "+jL+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",J="CREATE TABLE IF NOT EXISTS "+el+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",P="CREATE TABLE IF NOT EXISTS "+kf+" (id UNIQUE, rev, json)";L.executeSql(N),L.executeSql(P),L.executeSql(K,[],function(){L.executeSql(dx),L.executeSql(aW)}),L.executeSql(I,[],function(){L.executeSql(ag),L.executeSql(J,[],function(){L.executeSql(cW),L.executeSql(cB),L.executeSql(E,[],function(){var R="INSERT INTO "+bX+" (db_version, dbid) VALUES (?,?)";h=cE();var Q=[dL,h];L.executeSql(R,Q,function(){s()})})})})}else{var F=function(){var Q=dL>H;Q&&L.executeSql("UPDATE "+bX+" SET db_version = "+dL);var R="SELECT dbid FROM "+bX;L.executeSql(R,[],function(T,S){h=S.rows.item(0).dbid,s()})},O=[g,p,k,w,y,v,F],M=H,G=function(Q){O[M-1](Q,G),M++};G(L)}}function j(){u.transaction(function(E){C(E,function(){r(E)})},ej(o),x)}function r(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+bX;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+bX,[],function(K,J){var I=J.rows.item(0).db_version;B(K,I)}):H.executeSql("ALTER TABLE "+bX+" ADD COLUMN db_version INTEGER",[],function(){B(H,1)}):B(H,0)})}function m(F,E){if(-1!==D._docCount){return E(D._docCount)}var G=aM("COUNT("+jL+".id) AS 'num'",[jL,el],bD,el+".deleted=0");F.executeSql(G,[],function(I,H){D._docCount=H.rows.item(0).num,E(D._docCount)})}var n,D=this,h=null,l=aw(A),i=[];D._docCount=-1,D._name=A.name;var q=d0.extend({},A,{version:b7,description:A.name,size:l}),z=dM(q);if(z.error){return ej(o)(z.error)}var u=z.db;"function"!=typeof u.readTransaction&&(u.readTransaction=u.transaction),j(),D.type=function(){return"websql"},D._id=ed(function(E){E(null,h)}),D._info=function(E){u.readTransaction(function(F){m(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+el;F.executeSql(G,[],function(J,K){var I=K.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:I,sqlite_plugin:u._sqlitePlugin,websql_encoding:n})})})},ej(E))},D._bulkDocs=function(E,G,F){cy(A,E,G,D,u,cv,F)},D._get=function(M,N,K){function H(){K(F,{doc:I,metadata:L,ctx:J})}var I,L,F,J=N.ctx;if(!J){return u.readTransaction(function(O){D._get(M,d0.extend({ctx:O},N),K)})}var G,E;N.rev?(G=aM(ak,[jL,el],jL+".id="+el+".doc_id",[el+".doc_id=?",el+".rev=?"]),E=[M,N.rev]):(G=aM(ak,[jL,el],bD,jL+".id=?"),E=[M]),J.executeSql(G,E,function(O,P){if(!P.rows.length){return F=cU(by,"missing"),H()}var Q=P.rows.item(0);return L=cp(Q.metadata),Q.deleted&&!N.rev?(F=cU(by,"deleted"),H()):(I=bf(Q.data,L.id,Q.rev),void H())})},D._allDocs=function(L,H){var I,P=[],R="startkey" in L?L.startkey:!1,M="endkey" in L?L.endkey:!1,F="key" in L?L.key:!1,J="descending" in L?L.descending:!1,G="limit" in L?L.limit:-1,E="skip" in L?L.skip:0,O=L.inclusive_end!==!1,K=[],Q=[];if(F!==!1){Q.push(jL+".id = ?"),K.push(F)}else{if(R!==!1||M!==!1){if(R!==!1&&(Q.push(jL+".id "+(J?"<=":">=")+" ?"),K.push(R)),M!==!1){var N=J?">":"<";O&&(N+="="),Q.push(jL+".id "+N+" ?"),K.push(M)}F!==!1&&(Q.push(jL+".id = ?"),K.push(F))}}"ok"!==L.deleted&&Q.push(el+".deleted = 0"),u.readTransaction(function(S){m(S,function(T){if(I=T,0!==G){var U=aM(ak,[jL,el],bD,Q,jL+".id "+(J?"DESC":"ASC"));U+=" LIMIT "+G+" OFFSET "+E,S.executeSql(U,K,function(X,ai){for(var Z=0,ar=ai.rows.length;ar>Z;Z++){var W=ai.rows.item(Z),Y=cp(W.metadata),ao=Y.id,V=bf(W.data,ao,W.rev),an=V._rev,ae={id:ao,key:ao,value:{rev:an}};if(L.include_docs&&(ae.doc=V,ae.doc._rev=an,L.conflicts&&(ae.doc._conflicts=du(Y)),ab(ae.doc,L,D,X)),W.deleted){if("ok"!==L.deleted){continue}ae.value.deleted=!0,ae.doc=null}P.push(ae)}})}})},ej(H),function(){H(null,{total_rows:I,offset:L.skip,rows:P})})},D._changes=function(J){function K(){var S=jL+".json AS metadata, "+jL+".max_seq AS maxSeq, "+el+".json AS winningDoc, "+el+".rev AS winningRev ",T=jL+" JOIN "+el,R=jL+".id="+el+".doc_id AND "+jL+".winningseq="+el+".seq",Q=["maxSeq > ?"],O=[J.since];J.doc_ids&&(Q.push(jL+".id IN "+cK(J.doc_ids.length)),O=O.concat(J.doc_ids));var U="maxSeq "+(G?"DESC":"ASC"),N=aM(S,T,R,Q,U),M=eG(J);J.view||J.filter||(N+=" LIMIT "+L);var P=J.since||0;u.readTransaction(function(V){V.executeSql(N,O,function(an,ao){function ai(a0){return function(){J.onChange(a0)}}for(var X=0,at=ao.rows.length;at>X;X++){var ar=ao.rows.item(X),W=cp(ar.metadata);P=ar.maxSeq;var ae=bf(ar.winningDoc,W.id,ar.winningRev),Z=J.processChange(ae,W,J);Z.seq=ar.maxSeq;var Y=M(Z);if("object"==typeof Y){return J.complete(Y)}if(Y&&(F++,I&&H.push(Z),J.attachments&&J.include_docs?ab(ae,J,D,an,ai(Z)):ai(Z)()),F===L){break}}})},ej(J.complete),function(){J.continuous||J.complete(null,{results:H,last_seq:P})})}if(J=ch(J),J.continuous){var E=D._name+":"+cE();return cv.addListener(D._name,E,D,J),cv.notify(D._name),{cancel:function(){cv.removeListener(D._name,E)}}}var G=J.descending;J.since=J.since&&!G?J.since:0;var L="limit" in J?J.limit:-1;0===L&&(L=1);var I;I="return_docs" in J?J.return_docs:"returnDocs" in J?J.returnDocs:!0;var H=[],F=0;K()},D._close=function(E){E()},D._getAttachment=function(M,N,K,H,I){var L,F=H.ctx,J=K.digest,G=K.content_type,E="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+am+" WHERE digest=?";F.executeSql(E,[J],function(P,O){var Q=O.rows.item(0),R=Q.escaped?aV(Q.body):c5(Q.body,n);L=H.binary?db(R,G):dV(R),I(null,L)})},D._getRevisionTree=function(F,E){u.readTransaction(function(H){var G="SELECT json AS metadata FROM "+jL+" WHERE id = ?";H.executeSql(G,[F],function(K,I){if(I.rows.length){var J=cp(I.rows.item(0).metadata);E(null,J.rev_tree)}else{E(cU(by))}})})},D._doCompaction=function(F,E,G){return E.length?void u.transaction(function(H){var I="SELECT json AS metadata FROM "+jL+" WHERE id = ?";H.executeSql(I,[F],function(M,K){var L=cp(K.rows.item(0).metadata);ds(L.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var J="UPDATE "+jL+" SET json = ? WHERE id = ?";M.executeSql(J,[dz(L),F])}),aH(E,F,H)},ej(G),function(){G()}):G()},D._getLocal=function(F,E){u.readTransaction(function(H){var G="SELECT json, rev FROM "+kf+" WHERE id=?";H.executeSql(G,[F],function(I,K){if(K.rows.length){var L=K.rows.item(0),J=bf(L.json,F,L.rev);E(null,J)}else{E(cU(by))}})})},D._putLocal=function(K,F,I){function G(N){var P,O;J?(P="UPDATE "+kf+" SET rev=?, json=? WHERE id=? AND rev=?",O=[H,E,M,J]):(P="INSERT INTO "+kf+" (id, rev, json) VALUES (?,?,?)",O=[M,H,E]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(L={ok:!0,id:M,rev:H},F.ctx&&I(null,L)):I(cU(bw))},function(){return I(cU(bw)),!1})}"function"==typeof F&&(I=F,F={}),delete K._revisions;var H,J=K._rev,M=K._id;H=J?K._rev="0-"+(parseInt(J.split("-")[1],10)+1):K._rev="0-1";var L,E=aJ(K);F.ctx?G(F.ctx):u.transaction(G,ej(I),function(){L&&I(null,L)})},D._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+kf+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(cU(by))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):u.transaction(G,ej(E),function(){I&&E(null,I)})},D._destroy=function(F,E){cv.removeAllListeners(D._name),u.transaction(function(H){var G=[jL,el,am,bX,kf,a9];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},ej(E),function(){dd()&&(delete window.localStorage["_pouch__websqldb_"+D._name],delete window.localStorage[D._name]),E(null,{ok:!0})})}}function cF(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function cb(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var i=dd(),h="_pouch__websqldb_valid_"+navigator.userAgent;if(i&&localStorage[h]){return"1"===localStorage[h]}var g=cF();return i&&(localStorage[h]=g?"1":"0"),g}function d3(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:cb()}function e5(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=d0.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function eb(j,h){var g=e5(j),i=d0.extend({websql:g},j);j4.call(this,i,h)}function fN(g){g.adapter("websql",eb,!0)}function ep(){for(var j={},h=new e9(function(k,l){j.resolve=k,j.reject=l}),g=new Array(arguments.length),i=0;i<g.length;i++){g[i]=arguments[i]}return j.promise=h,e9.resolve().then(function(){return fetch.apply(null,g)}).then(function(k){j.resolve(k)})["catch"](function(k){j.reject(k)}),j}function bU(i,l){var g,m,j,k=new Headers,h={method:i.method,credentials:"include",headers:k};return i.json&&(k.set("Accept","application/json"),k.set("Content-Type",i.headers["Content-Type"]||"application/json")),i.body&&i.body instanceof Blob?jN(i.body,function(n){h.body=n}):i.body&&i.processData&&"string"!=typeof i.body?h.body=JSON.stringify(i.body):"body" in i?h.body=i.body:h.body=null,Object.keys(i.headers).forEach(function(n){i.headers.hasOwnProperty(n)&&k.set(n,i.headers[n])}),g=ep(i.url,h),i.timeout>0&&(m=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+i.url))},i.timeout)),g.promise.then(function(n){return j={statusCode:n.status},i.timeout>0&&clearTimeout(m),j.statusCode>=200&&j.statusCode<300?i.binary?n.blob():n.text():n.json()}).then(function(n){j.statusCode>=200&&j.statusCode<300?l(null,j,n):l(n,j)})["catch"](function(n){l(n,j)}),{abort:g.reject}}function fP(h,j){var n,k,o=!1,g=function(){n.abort()},i=function(){o=!0,n.abort()};n=h.xhr?new h.xhr:new XMLHttpRequest;try{n.open(h.method,h.url)}catch(l){j(l,{statusCode:413})}n.withCredentials="withCredentials" in h?h.withCredentials:!0,"GET"===h.method?delete h.headers["Content-Type"]:h.json&&(h.headers.Accept="application/json",h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json",h.body&&h.processData&&"string"!=typeof h.body&&(h.body=JSON.stringify(h.body))),h.binary&&(n.responseType="arraybuffer"),"body" in h||(h.body=null);for(var m in h.headers){h.headers.hasOwnProperty(m)&&n.setRequestHeader(m,h.headers[m])}return h.timeout>0&&(k=setTimeout(i,h.timeout),n.onprogress=function(){clearTimeout(k),4!==n.readyState&&(k=setTimeout(i,h.timeout))},"undefined"!=typeof n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var s={statusCode:n.status};if(n.status>=200&&n.status<300){var q;q=h.binary?eg([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,j(null,s,q)}else{var p={};if(o){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(n.response)}catch(r){}}j(p,s)}}},h.body&&h.body instanceof Blob?jN(h.body,function(p){n.send(p)}):n.send(h.body),{abort:g}}function bK(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function e1(g,h){return az||g.xhr?fP(g,h):bU(g,h)}function aj(){return""}function a8(k,i){function h(m,l,n){if(!k.binary&&k.json&&"string"==typeof m){try{m=JSON.parse(m)}catch(o){return n(o)}}Array.isArray(m)&&(m=m.map(function(p){return p.error||p.missing?eO(p):p})),k.binary&&jK(m,l),n(null,m,l)}function j(p,n){var l,o;if(p.code&&p.status){var q=new Error(p.message||p.code);return q.status=p.status,n(q)}if(p.message&&"ETIMEDOUT"===p.message){return n(p)}try{l=JSON.parse(p.responseText),o=eO(l)}catch(m){o=eO(p)}n(o)}k=ch(k);var g={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return k=d0.extend(g,k),k.json&&(k.binary||(k.headers.Accept="application/json"),k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json"),k.binary&&(k.encoding=null,k.json=!1),k.processData||(k.json=!1),e1(k,function(l,p,n){if(l){return l.status=p?p.statusCode:400,j(l,i)}var q,o=p.headers&&p.headers["content-type"],m=n||aj();if(!k.binary&&(k.json||!k.processData)&&"object"!=typeof m&&(/json/.test(o)||/^[\s]*\{/.test(m)&&/\}[\s]*$/.test(m))){try{m=JSON.parse(m.toString())}catch(r){}}p.statusCode>=200&&p.statusCode<300?h(m,p,i):(q=eO(m),q.status=p.statusCode,i(q))})}function dD(j,l){var h=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",o=-1!==h.indexOf("safari")&&-1===h.indexOf("chrome"),g=-1!==h.indexOf("msie"),i=-1!==h.indexOf("edge"),k=o||(g||i)&&"GET"===j.method,m="cache" in j?j.cache:!0,n=/^blob:/.test(j.url);if(!n&&(k||!m)){var p=-1!==j.url.indexOf("?");j.url+=(p?"&":"?")+"_nonce="+Date.now()}return a8(j,l)}function eL(g){var h=g.doc&&g.doc._attachments;h&&Object.keys(h).forEach(function(i){var j=h[i];j.data=aQ(j.data,j.content_type)})}function bC(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function kc(g){return g._attachments&&Object.keys(g._attachments)?e9.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new e9(function(j){cR(i.data,j)}).then(function(j){i.data=j}):void 0})):e9.resolve()}function dI(i){var h=e0(i);(h.user||h.password)&&(h.auth={username:h.user,password:h.password});var g=h.path.replace(/(^\/|\/$)/g,"").split("/");return h.db=g.pop(),-1===h.db.indexOf("%")&&(h.db=encodeURIComponent(h.db)),h.path=g.join("/"),h}function cj(g,h){return ad(g,g.db+"/"+h)}function ad(i,h){var g=i.path?"/":"";return i.protocol+"://"+i.host+(i.port?":"+i.port:"")+"/"+i.path+g+h}function jF(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function f8(o,s){function w(A,z,x){var y=A.ajax||{},B=d0.extend(ch(q),y,z);return fF(B.method+" "+B.url),k._ajax(B,x)}function p(y,x){return new e9(function(z,A){w(y,x,function(C,B){return C?A(C):void z(B)})})}function j(y,x){return e4(y,b2(function(z){v().then(function(){return x.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(o.skipSetup||o.skip_setup){return e9.resolve()}if(u){return u}var x={method:"GET",url:r};return u=p({},x)["catch"](function(y){return y&&y.status&&404===y.status?(bJ(404,"PouchDB is just detecting if the remote exists."),p({},{method:"PUT",url:r})):e9.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:e9.reject(y)}),u["catch"](function(){u=null}),u}function g(x){return x.split("/").map(encodeURIComponent).join("/")}var k=this,n=dI;o.getHost&&(n=o.getHost);var h=n(o.name,o),r=cj(h,"");o=ch(o);var q=o.ajax||{};if(k.getUrl=function(){return r},k.getHeaders=function(){return q.headers||{}},o.auth||h.auth){var m=o.auth||h.auth,i=m.username+":"+m.password,l=dV(unescape(encodeURIComponent(i)));q.headers=q.headers||{},q.headers.Authorization="Basic "+l}k._ajax=dD;var u;setTimeout(function(){s(null,k)}),k.type=function(){return"http"},k.id=j("id",function(x){w({},{method:"GET",url:ad(h,"")},function(y,A){var z=A&&A.uuid?A.uuid+h.db:cj(h,"");x(null,z)})}),k.request=j("request",function(y,x){y.url=cj(h,y.url),w({},y,x)}),k.compact=j("compact",function(y,x){"function"==typeof y&&(x=y,y={}),y=ch(y),w(y,{url:cj(h,"_compact"),method:"POST"},function(){function z(){k.info(function(A,B){B&&!B.compact_running?x(null,{ok:!0}):setTimeout(z,y.interval||200)})}z()})}),k.bulkGet=e4("bulkGet",function(y,C){function B(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),w({},{url:cj(h,"_bulk_get"+jF(E)),method:"POST",body:{docs:y.docs}},F)}function A(){function I(L){return function(M,N){E[L]=N.results,++J===G&&C(null,{results:aa(E)})}}for(var F=ke,G=Math.ceil(y.docs.length/F),J=0,E=new Array(G),K=0;G>K;K++){var H=dy(y,["revs","attachments"]);H.ajax=q,H.docs=y.docs.slice(K*F,Math.min(y.docs.length,(K+1)*F)),eB(z,H,I(K))}}var z=this,D=ad(h,""),x=cT[D];"boolean"!=typeof x?B(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(cT[D]=!1,bJ(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),A()):C(E)}else{cT[D]=!0,C(null,F)}}):x?B(C):A()}),k._info=function(x){v().then(function(){w({},{method:"GET",url:cj(h,"")},function(y,z){return y?x(y):(z.host=cj(h,""),void x(null,z))})})["catch"](x)},k.get=j("get",function(C,y,B){function A(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?e9.all(E.map(function(I){var J=G[I],H=bC(F._id)+"/"+g(I)+"?rev="+F._rev;return p(y,{method:"GET",url:cj(h,H),binary:!0}).then(function(K){return y.binary?K:new e9(function(L){cR(K,L)})}).then(function(K){delete J.stub,delete J.length,J.data=K})})):void 0}function z(E){return Array.isArray(E)?e9.all(E.map(function(F){return F.ok?A(F.ok):void 0})):A(E)}"function"==typeof y&&(B=y,y={}),y=ch(y);var x={};y.revs&&(x.revs=!0),y.revs_info&&(x.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),x.open_revs=y.open_revs),y.rev&&(x.rev=y.rev),y.conflicts&&(x.conflicts=y.conflicts),C=bC(C);var D={method:"GET",url:cj(h,C+jF(x))};p(y,D).then(function(E){return e9.resolve().then(function(){return y.attachments?z(E):void 0}).then(function(){B(null,E)})})["catch"](B)}),k.remove=j("remove",function(B,z,x,C){var y;"string"==typeof z?(y={_id:B,_rev:z},"function"==typeof x&&(C=x,x={})):(y=B,"function"==typeof z?(C=z,x={}):(C=x,x=z));var A=y._rev||x.rev;w(x,{method:"DELETE",url:cj(h,bC(y._id))+"?rev="+A},C)}),k.getAttachment=j("getAttachment",function(B,x,z,y){"function"==typeof z&&(y=z,z={});var A=z.rev?"?rev="+z.rev:"",C=cj(h,bC(B))+"/"+g(x)+A;w(z,{method:"GET",url:C,binary:!0},y)}),k.removeAttachment=j("removeAttachment",function(A,z,y,x){var B=cj(h,bC(A)+"/"+g(z))+"?rev="+y;w({},{method:"DELETE",url:B},x)}),k.putAttachment=j("putAttachment",function(H,A,C,D,F,B){"function"==typeof F&&(B=F,F=D,D=C,C=null);var z=bC(H)+"/"+g(A),y=cj(h,z);if(C&&(y+="?rev="+C),"string"==typeof D){var E;try{E=d1(D)}catch(x){return B(cU(eW,"Attachment is not a valid base64 string"))}D=E?db(E,F):""}var G={headers:{"Content-Type":F},method:"PUT",url:y,processData:!1,body:D,timeout:q.timeout||60000};w({},G,B)}),k._bulkDocs=function(z,x,y){z.new_edits=x.new_edits,v().then(function(){return e9.all(z.docs.map(kc))}).then(function(){w(x,{method:"POST",url:cj(h,"_bulk_docs"),body:z},function(B,A){return B?y(B):(A.forEach(function(C){C.ok=!0}),void y(null,A))})})["catch"](y)},k.allDocs=j("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=ch(C);var B,A={},z="GET";C.conflicts&&(A.conflicts=!0),C.descending&&(A.descending=!0),C.include_docs&&(A.include_docs=!0),C.attachments&&(A.attachments=!0),C.key&&(A.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(A.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(A.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(A.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(A.limit=C.limit),"undefined"!=typeof C.skip&&(A.skip=C.skip);var D=jF(A);if("undefined"!=typeof C.keys){var x="keys="+encodeURIComponent(JSON.stringify(C.keys));x.length+D.length+1<=bj?D+="&"+x:(z="POST",B={keys:C.keys})}p(C,{method:z,url:cj(h,"_all_docs"+D),body:B}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eL),y(null,E)})["catch"](y)}),k._changes=function(B){var J="batch_size" in B?B.batch_size:j6;B=ch(B),B.timeout="timeout" in B?B.timeout:"timeout" in q?q.timeout:30000;var H,A=B.timeout?{timeout:B.timeout-5000}:{},D="undefined"!=typeof B.limit?B.limit:!1;H="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var L=D;if(B.style&&(A.style=B.style),(B.include_docs||B.filter&&"function"==typeof B.filter)&&(A.include_docs=!0),B.attachments&&(A.attachments=!0),B.continuous&&(A.feed="longpoll"),B.conflicts&&(A.conflicts=!0),B.descending&&(A.descending=!0),"heartbeat" in B?B.heartbeat&&(A.heartbeat=B.heartbeat):A.heartbeat=10000,B.filter&&"string"==typeof B.filter&&(A.filter=B.filter),B.view&&"string"==typeof B.view&&(A.filter="_view",A.view=B.view),B.query_params&&"object"==typeof B.query_params){for(var y in B.query_params){B.query_params.hasOwnProperty(y)&&(A[y]=B.query_params[y])}}var F,G="GET";if(B.doc_ids){A.filter="_doc_ids";var E=JSON.stringify(B.doc_ids);E.length<bj?A.doc_ids=E:(G="POST",F={doc_ids:B.doc_ids})}var C,z,K=function(N,M){if(!B.aborted){A.since=N,"object"==typeof A.since&&(A.since=JSON.stringify(A.since)),B.descending?D&&(A.limit=L):A.limit=!D||L>J?J:L;var O={method:G,url:cj(h,"_changes"+jF(A)),timeout:B.timeout,body:F};z=N,B.aborted||v().then(function(){C=w(B,O,M)})["catch"](M)}},x={results:[]},I=function(O,Q){if(!B.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,x.last_seq=Q.last_seq;var M={};M.query=B.query_params,Q.results=Q.results.filter(function(R){L--;var S=eG(B)(R);return S&&(B.include_docs&&B.attachments&&B.binary&&eL(R),H&&x.results.push(R),B.onChange(R)),S})}else{if(O){return B.aborted=!0,void B.complete(O)}}Q&&Q.last_seq&&(z=Q.last_seq);var N=D&&0>=L||Q&&J>P||B.descending;(!B.continuous||D&&0>=L)&&N?B.complete(null,x):setTimeout(function(){K(z,I)},0)}};return K(B.since||0,I),{cancel:function(){B.aborted=!0,C&&C.abort()}}},k.revsDiff=j("revsDiff",function(z,x,y){"function"==typeof x&&(y=x,x={}),w(x,{method:"POST",url:cj(h,"_revs_diff"),body:z},y)}),k._close=function(x){x()},k._destroy=function(y,x){w(y,{url:cj(h,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?x(z):void x(null,A)})}}function aY(g){g.adapter("http",f8,!1),g.adapter("https",f8,!1)}function kk(){this.promise=new e9(function(g){g()})}function jZ(h){var i=h.db,j=h.viewName,k=h.map,m=h.reduce,n=h.temporary,l=k.toString()+(m&&m.toString())+"undefined";if(!n&&i._cachedViews){var g=i._cachedViews[l];if(g){return e9.resolve(g)}}return i.info().then(function(p){function o(u){u.views=u.views||{};var r=j;-1===r.indexOf("/")&&(r=j+"/"+j);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(n?"temp":dj(l));return jG(i,"_local/mrviews",o).then(function(){return i.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:i,adapter:i.adapter,mapFun:k,reduceFun:m};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,n||(i._cachedViews=i._cachedViews||{},i._cachedViews[l]=r,r.db.once("destroyed",function(){delete i._cachedViews[l]})),r})})})})}function eV(l,j,i,k,h,g){return d5("return ("+l.replace(/;\s*$/,"")+");",{emit:j,sum:i,log:k,isArray:h,toJSON:g})}function fQ(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function cq(g){return 1===g.length&&/^1-/.test(g[0].rev)}function bO(i,h){try{i.emit("error",h)}catch(g){av("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),av("error",h)}}function kj(j,h,g){try{return{output:h.apply(null,g)}}catch(i){return bO(j,i),{error:i}}}function f9(i,h){var g=au.collate(i.key,h.key);return 0!==g?g:au.collate(i.value,h.value)}function jP(i,h,g){return g=g||0,"number"==typeof h?i.slice(g,h+g):g>0?i.slice(g):i}function dA(i){var h=i.value,g=h&&"object"==typeof h&&h._id||i.id;return g}function dR(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=aQ(k.data,k.content_type)})})}function ef(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&dR(h),h}}function e2(g){var h="builtin "+g+" function requires map values to be numbers or number arrays";return new cl(h)}function f6(h){for(var i=0,j=0,k=h.length;k>j;j++){var m=h[j];if("number"!=typeof m){if(!Array.isArray(m)){throw e2("_sum")}i="number"==typeof i?[i]:i;for(var n=0,l=m.length;l>n;n++){var g=m[n];if("number"!=typeof g){throw e2("_sum")}"undefined"==typeof i[n]?i.push(g):i[n]+=g}}else{"number"==typeof i?i+=m:i[0]+=m}}return i}function jU(k,i,h,j){var g=i[k];"undefined"!=typeof g&&(j&&(g=encodeURIComponent(JSON.stringify(g))),h.push(k+"="+g))}function eF(g){if("undefined"!=typeof g){var h=Number(g);return isNaN(h)||h!==parseInt(g,10)?g:h}}function c0(g){return g.group_level=eF(g.group_level),g.limit=eF(g.limit),g.skip=eF(g.skip),g}function kb(g){if(g){if("number"!=typeof g){return new jI('Invalid value for integer: "'+g+'"')}if(0>g){return new jI('Invalid value for positive integer: "'+g+'"')}}}function em(j,h){var g=j.descending?"endkey":"startkey",i=j.descending?"startkey":"endkey";if("undefined"!=typeof j[g]&&"undefined"!=typeof j[i]&&au.collate(j[g],j[i])>0){throw new jI("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(h.reduce&&j.reduce!==!1){if(j.include_docs){throw new jI("{include_docs:true} is invalid for reduce")}if(j.keys&&j.keys.length>1&&!j.group&&!j.group_level){throw new jI("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=kb(j[k]);if(l){throw l}})}function kg(h,j,n){var k,o=[],g="GET";if(jU("reduce",n,o),jU("include_docs",n,o),jU("attachments",n,o),jU("limit",n,o),jU("descending",n,o),jU("group",n,o),jU("group_level",n,o),jU("skip",n,o),jU("stale",n,o),jU("conflicts",n,o),jU("startkey",n,o,!0),jU("start_key",n,o,!0),jU("endkey",n,o,!0),jU("end_key",n,o,!0),jU("inclusive_end",n,o),jU("key",n,o,!0),o=o.join("&"),o=""===o?"":"?"+o,"undefined"!=typeof n.keys){var i=2000,l="keys="+encodeURIComponent(JSON.stringify(n.keys));l.length+o.length+1<=i?o+=("?"===o[0]?"&":"?")+l:(g="POST","string"==typeof j?k={keys:n.keys}:j.keys=n.keys)}if("string"==typeof j){var m=fQ(j);return h.request({method:g,url:"_design/"+m[0]+"/_view/"+m[1]+o,body:k}).then(ef(n))}return k=k||{},Object.keys(j).forEach(function(p){Array.isArray(j[p])?k[p]=j[p]:k[p]=j[p].toString()}),h.request({method:"POST",url:"_temp_view"+o,body:k}).then(ef(n))}function fL(i,h,g){return new e9(function(j,k){i._query(h,g,function(m,l){return m?k(m):void j(l)})})}function eN(g){return new e9(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function eq(g){return function(h){if(404===h.status){return g}throw h}}function cc(n,i,m){function k(){return cq(o)?e9.resolve(h):i.db.get(p)["catch"](eq(h))}function j(r){return r.keys.length?i.db.allDocs({keys:r.keys,include_docs:!0}):e9.resolve({rows:[]})}function l(u,w){for(var A=[],z={},B=0,s=w.rows.length;s>B;B++){var v=w.rows[B],y=v.doc;if(y&&(A.push(y),z[y._id]=!0,y._deleted=!q[y._id],!y._deleted)){var x=q[y._id];"value" in x&&(y.value=x.value)}}var r=Object.keys(q);return r.forEach(function(C){if(!z[C]){var E={_id:C},D=q[C];"value" in D&&(E.value=D.value),A.push(E)}}),u.keys=b0(r.concat(u.keys)),A.push(u),A}var p="_local/doc_"+n,h={_id:p,keys:[]},g=m[n],q=g.indexableKeysToKeyValues,o=g.changes;return k().then(function(r){return j(r).then(function(s){return l(r,s)})})}function eT(j,h,g){var i="_local/lastSeq";return j.db.get(i)["catch"](eq({_id:i,seq:0})).then(function(k){var l=Object.keys(h);return e9.all(l.map(function(m){return cc(m,j,h)})).then(function(n){var m=aa(n);return k.seq=g,m.push(k),j.db.bulkDocs({docs:m})})})}function ah(i){var h="string"==typeof i?i:i.name,g=fA[h];return g||(g=fA[h]=new kk),g}function dU(g){return cg(ah(g),function(){return fC(g)})()}function fC(h){function j(p,r){var q={id:o._id,key:au.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=au.normalizeKey(r)),k.push(q)}function n(q,p){return function(){return eT(h,q,p)}}var k,o,g;if("function"==typeof h.mapFun&&2===h.mapFun.length){var i=h.mapFun;g=function(p){return i(p,j)}}else{g=eV(h.mapFun.toString(),j,f6,dB,Array.isArray,JSON.parse)}var l=h.seq||0,m=new kk;return new e9(function(p,s){function r(){m.finish().then(function(){h.seq=l,p()})}function q(){function u(v){s(v)}h.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:l,limit:j5}).on("complete",function(A){var v=A.results;if(!v.length){return r()}for(var D={},F=0,C=v.length;C>F;F++){var x=v[F];if("_"!==x.doc._id[0]){k=[],o=x.doc,o._deleted||kj(h.sourceDB,g,[o]),k.sort(f9);for(var z,H={},w=0,B=k.length;B>w;w++){var E=k[w],G=[E.key,E.id];0===au.collate(E.key,z)&&G.push(w);var y=au.toIndexableString(G);H[y]=E,z=E.key}D[x.doc._id]={indexableKeysToKeyValues:H,changes:x.changes}}l=x.seq}return m.add(n(D,l)),v.length<j5?r():q()}).on("error",u)}q()})}function j3(n,i,m){0===m.group_level&&delete m.group_level;var k,j=m.group||m.group_level;k=d7[n.reduceFun]?d7[n.reduceFun]:eV(n.reduceFun.toString(),null,f6,dB,Array.isArray,JSON.parse);var l=[],p=isNaN(m.group_level)?Number.POSITIVE_INFINITY:m.group_level;i.forEach(function(r){var u=l[l.length-1],s=j?r.key:null;return j&&Array.isArray(s)&&(s=s.slice(0,p)),u&&0===au.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void l.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),i=[];for(var h=0,g=l.length;g>h;h++){var q=l[h],o=kj(n.sourceDB,k,[q.keys,q.values,!1]);if(o.error&&o.error instanceof cl){throw o.error}i.push({value:o.error?null:o.output,key:q.groupKey})}return{rows:jP(i,m.limit,m.skip)}}function km(g,h){return cg(ah(g),function(){return b9(g,h)})()}function b9(r,l){function o(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return n=v.total_rows,v.rows.map(function(z){if("value" in z.doc&&"object"==typeof z.doc.value&&null!==z.doc.value){var x=Object.keys(z.doc.value).sort(),w=["id","key","value"];if(!(w>x||x>w)){return z.doc.value}}var y=au.parseIndexableString(z.doc._id);return{key:y[0],id:y[1],value:"value" in z.doc?z.doc.value:null}})})}function m(v){var u;if(u=q?j3(r,v,l):{total_rows:n,offset:j,rows:v},l.include_docs){var w=b0(v.map(dA));return r.sourceDB.allDocs({keys:w,include_docs:!0,conflicts:l.conflicts,attachments:l.attachments,binary:l.binary}).then(function(y){var x={};return y.rows.forEach(function(z){z.doc&&(x["$"+z.id]=z.doc)}),v.forEach(function(A){var B=dA(A),z=x["$"+B];z&&(A.doc=z)}),u})}return u}var n,q=r.reduceFun&&l.reduce!==!1,j=l.skip||0;if("undefined"==typeof l.keys||l.keys.length||(l.limit=0,delete l.keys),"undefined"!=typeof l.keys){var s=l.keys,k=s.map(function(u){var v={startkey:au.toIndexableString([u]),endkey:au.toIndexableString([u,{}])};return o(v)});return e9.all(k).then(aa).then(m)}var i={descending:l.descending};if(l.start_key&&(l.startkey=l.start_key),l.end_key&&(l.endkey=l.end_key),"undefined"!=typeof l.startkey&&(i.startkey=l.descending?au.toIndexableString([l.startkey,{}]):au.toIndexableString([l.startkey])),"undefined"!=typeof l.endkey){var g=l.inclusive_end!==!1;l.descending&&(g=!g),i.endkey=au.toIndexableString(g?[l.endkey,{}]:[l.endkey])}if("undefined"!=typeof l.key){var p=au.toIndexableString([l.key]),h=au.toIndexableString([l.key,{}]);i.descending?(i.endkey=p,i.startkey=h):(i.startkey=p,i.endkey=h)}return q||("number"==typeof l.limit&&(i.limit=l.limit),i.skip=j),o(i).then(m)}function bQ(g){return g.request({method:"POST",url:"_view_cleanup"})}function cC(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(n){var l=fQ(n),m="_design/"+l[0],k=l[1];j[m]=j[m]||{},j[m][k]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(n){var k={};n.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){k[v]=k[v]||s})})});var m=Object.keys(k).filter(function(o){return !k[o]}),l=m.map(function(o){return cg(ah(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return e9.all(l).then(function(){return{ok:!0}})})},eq({ok:!0}))}function dw(m,g,h){if("http"===m.type()){return kg(m,g,h)}if("function"==typeof m._query){return fL(m,g,h)}if("string"!=typeof g){em(h,g);var j={db:m,viewName:"temp_view/temp_view",map:g.map,reduce:g.reduce,temporary:!0};return ax.add(function(){return jZ(j).then(function(o){function p(){return o.db.destroy()}return aF(dU(o).then(function(){return km(o,h)}),p)})}),ax.finish()}var i=g,l=fQ(i),k=l[0],n=l[1];return m.get("_design/"+k).then(function(o){var p=o.views&&o.views[n];if(!p||"string"!=typeof p.map){throw new dS("ddoc "+k+" has no view named "+n)}em(h,p);var q={db:m,viewName:i,map:p.map,reduce:p.reduce};return jZ(q).then(function(r){return"ok"===h.stale||"update_after"===h.stale?("update_after"===h.stale&&c1.nextTick(function(){dU(r)}),km(r,h)):dU(r).then(function(){return km(r,h)})})})}function jI(g){this.status=400,this.name="query_parse_error",this.message=g,this.error=!0;try{Error.captureStackTrace(this,jI)}catch(h){}}function dS(g){this.status=404,this.name="not_found",this.message=g,this.error=!0;try{Error.captureStackTrace(this,dS)}catch(h){}}function cl(g){this.status=500,this.name="invalid_value",this.message=g,this.error=!0;try{Error.captureStackTrace(this,cl)}catch(h){}}function dq(g){return/^1-/.test(g)}function bv(i,h,g){return !i._attachments||!i._attachments[g]||i._attachments[g].digest!==h._attachments[g].digest}function jO(i,h){var g=Object.keys(h._attachments);return e9.all(g.map(function(j){return i.getAttachment(h._id,j,{rev:h._rev})}))}function jX(k,i,h){var j="http"===i.type()&&"http"!==k.type(),g=Object.keys(h._attachments);return j?k.get(h._id).then(function(l){return e9.all(g.map(function(m){return bv(l,h,m)?i.getAttachment(h._id,m):k.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return jO(i,h)}):jO(i,h)}function kl(g){var h=[];return Object.keys(g).forEach(function(j){var i=g[j].missing;i.forEach(function(k){h.push({id:j,rev:k})})}),{docs:h,revs:!0}}function eD(m,h,l,j){function k(){var r=kl(l);if(r.docs.length){return m.bulkGet(r).then(function(s){if(j.cancelled){throw new Error("cancelled")}return e9.all(s.results.map(function(u){return e9.all(u.docs.map(function(w){var v=w.ok;return w.error&&(o=!1),v&&v._attachments?jX(h,m,v).then(function(y){var x=Object.keys(v._attachments);return y.forEach(function(z,B){var A=v._attachments[x[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){q=q.concat(aa(u).filter(Boolean))})})}}function n(r){return r._attachments&&Object.keys(r._attachments).length>0}function p(r){return m.allDocs({keys:r,include_docs:!0}).then(function(s){if(j.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&dq(u.value.rev)&&!n(u.doc)&&(q.push(u.doc),delete l[u.id])})})}function i(){var r=Object.keys(l).filter(function(s){var u=l[s].missing;return 1===u.length&&dq(u[0])});return r.length>0?p(r):void 0}function g(){return{ok:o,docs:q}}l=ch(l);var q=[],o=!0;return e9.resolve().then(i).then(k).then(g)}function ac(k,i,h,j,g){return k.get(i)["catch"](function(l){if(404===l.status){return"http"===k.type()&&bJ(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:j,_id:i,history:[],replicator:dK,version:bN}}throw l}).then(function(l){return g.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==j}),l.history.unshift({last_seq:h,session_id:j}),l.history=l.history.slice(0,dp),l.version=bN,l.replicator=dK,l.session_id=j,l.last_seq=h,k.put(l)["catch"](function(m){if(409===m.status){return ac(k,i,h,j,g)}throw m}))})}function j2(j,h,g,i){this.src=j,this.target=h,this.id=g,this.returnValue=i}function cJ(g,h){return g.session_id===h.session_id?{last_seq:g.last_seq,history:g.history}:cx(g.history,h.history)}function cx(h,i){var j=h[0],k=h.slice(1),m=i[0],n=i.slice(1);if(!j||0===i.length){return{last_seq:jS,history:[]}}var l=j.session_id;if(ec(l,i)){return{last_seq:j.last_seq,history:h}}var g=m.session_id;return ec(g,k)?{last_seq:m.last_seq,history:n}:cx(k,n)}function ec(j,h){var g=h[0],i=h.slice(1);return j&&0!==h.length?j===g.session_id?!0:ec(j,i):!1}function da(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function j9(j,h,g,i){return j.retry===!1?(h.emit("error",g),void h.removeAllListeners()):("function"!=typeof j.back_off_function&&(j.back_off_function=dC),h.emit("requestError",g),"active"!==h.state&&"pending"!==h.state||(h.emit("paused",g),h.state="stopped",h.once("active",function(){j.current_back_off=bZ})),j.current_back_off=j.current_back_off||bZ,j.current_back_off=j.back_off_function(j.current_back_off),void setTimeout(i,j.current_back_off))}function dN(g){return Object.keys(g).sort(au.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function jH(i,l,g){var m=g.doc_ids?g.doc_ids.sort(au.collate):"",j=g.filter?g.filter.toString():"",k="",h="";return g.filter&&g.query_params&&(k=JSON.stringify(dN(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),e9.all([i.id(),l.id()]).then(function(o){var n=o[0]+o[1]+j+h+k+m;return new e9(function(p){j1(n,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dc(D,M,m,h,l){function s(){return z?e9.resolve():jH(D,M,m).then(function(T){K=T,z=new j2(D,M,K,h)})}function g(){if(Q=[],0!==B.docs.length){var T=B.docs;return M.bulkDocs({docs:T,new_edits:!1}).then(function(Y){if(h.cancelled){throw k(),new Error("cancelled")}var V=[],X={};Y.forEach(function(Z){Z.error&&(l.doc_write_failures++,V.push(Z),X[Z.id]=Z)}),C=C.concat(V),l.docs_written+=B.docs.length-V.length;var W=V.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=X[Z._id];ae?h.emit("denied",ch(ae)):Q.push(Z)}),W.length>0){var U=new Error("bulkDocs error");throw U.other_errors=V,u("target.bulkDocs failed to write docs",U),new Error("bulkWrite partial failure")}},function(U){throw l.doc_write_failures+=T.length,U})}}function N(){if(B.error){throw new Error("There was a problem getting docs.")}l.last_seq=r=B.seq;var T=ch(l);return Q.length&&(T.docs=Q,h.emit("change",T)),w=!0,z.writeCheckpoint(B.seq,E).then(function(){if(w=!1,h.cancelled){throw k(),new Error("cancelled")}B=void 0,o()})["catch"](L)}function G(){var T={};return B.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),M.revsDiff(T).then(function(U){if(h.cancelled){throw k(),new Error("cancelled")}B.diffs=U})}function y(){return eD(D,M,B.diffs,h).then(function(T){B.error=!T.ok,T.docs.forEach(function(U){delete B.diffs[U._id],l.docs_read++,B.docs.push(U)})})}function p(){if(!h.cancelled&&!B){if(0===q.length){return void I(!0)}B=q.shift(),G().then(y).then(g).then(N).then(p)["catch"](function(T){u("batch processing terminated with error",T)})}}function I(T){return 0===j.changes.length?void (0!==q.length||B||((P&&n.live||R)&&(h.state="pending",h.emit("paused")),R&&k())):void ((T||R||j.changes.length>=H)&&(q.push(j),j={seq:0,changes:[],docs:[]},"pending"!==h.state&&"stopped"!==h.state||(h.state="active",h.emit("active")),p()))}function u(T,U){x||(U.message||(U.message=T),l.ok=!1,l.status="aborting",l.errors.push(U),C=C.concat(U),q=[],j={seq:0,changes:[],docs:[]},k())}function k(){if(!(x||h.cancelled&&(l.status="cancelled",w))){l.status=l.status||"complete",l.end_time=new Date,l.last_seq=r,x=!0;var T=C.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(T.length>0){var U=C.pop();C.length>0&&(U.other_errors=C),U.result=l,j9(m,h,U,function(){dc(D,M,m,h)})}else{l.errors=C,h.emit("complete",l),h.removeAllListeners()}}}function F(T){if(h.cancelled){return k()}var U=eG(m)(T);U&&(j.seq=T.seq,j.changes.push(T),I(0===q.length&&n.live))}function S(T){if(O=!1,h.cancelled){return k()}if(T.results.length>0){n.since=T.last_seq,o(),I(!0)}else{var U=function(){P?(n.live=!0,o()):R=!0,I(!0)};B||0!==T.results.length?U():(w=!0,z.writeCheckpoint(T.last_seq,E).then(function(){w=!1,l.last_seq=r=T.last_seq,U()})["catch"](L))}}function i(T){return O=!1,h.cancelled?k():void u("changes rejected",T)}function o(){function V(){U.cancel()}function T(){h.removeListener("cancel",V)}if(!O&&!R&&q.length<J){O=!0,h._changes&&(h.removeListener("cancel",h._abortChanges),h._changes.cancel()),h.once("cancel",V);var U=D.changes(n).on("change",F);U.then(T,T),U.then(S)["catch"](i),m.retry&&(h._changes=U,h._abortChanges=V)}}function v(){s().then(function(){return h.cancelled?void k():z.getCheckpoint().then(function(T){r=T,n={since:r,limit:H,batch_size:H,style:"all_docs",doc_ids:A,return_docs:!0},m.filter&&("string"!=typeof m.filter?n.include_docs=!0:n.filter=m.filter),"heartbeat" in m&&(n.heartbeat=m.heartbeat),"timeout" in m&&(n.timeout=m.timeout),m.query_params&&(n.query_params=m.query_params),m.view&&(n.view=m.view),o()})})["catch"](function(T){u("getCheckpoint rejected with ",T)})}function L(T){throw w=!1,u("writeCheckpoint completed with error",T),T}var B,K,z,q=[],j={seq:0,changes:[],docs:[]},w=!1,R=!1,x=!1,r=0,P=m.continuous||m.live||!1,H=m.batch_size||100,J=m.batches_limit||10,O=!1,A=m.doc_ids,C=[],Q=[],E=cE();l=l||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var n={};return h.ready(D,M),h.cancelled?void k():(h._addedListeners||(h.once("cancel",k),"function"==typeof m.complete&&(h.once("error",m.complete),h.once("complete",function(T){m.complete(null,T)})),h._addedListeners=!0),void ("undefined"==typeof m.since?v():s().then(function(){return w=!0,z.writeCheckpoint(m.since,E)}).then(function(){return w=!1,h.cancelled?void k():(r=m.since,void v())})["catch"](L)))}function cL(){aX.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var g=this,h=new e9(function(i,j){g.once("complete",i),g.once("error",j)});g.then=function(i,j){return h.then(i,j)},g["catch"]=function(i){return h["catch"](i)},g["catch"](function(){})}function fR(i,h){var g=h.PouchConstructor;return"string"==typeof i?new g(i,h):i}function cS(i,l,g,m){if("function"==typeof g&&(m=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw cU(e6,"`doc_ids` filter parameter is not a list.")}g.complete=m,g=ch(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var j=new cL(g),k=fR(i,g),h=fR(l,g);return dc(k,h,g,j),j}function aC(j,h,g,i){return"function"==typeof g&&(i=g,g={}),"undefined"==typeof g&&(g={}),g=ch(g),g.PouchConstructor=g.PouchConstructor||this,j=fR(j,g),h=fR(h,g),new dm(j,h,g,i)}function dm(l,s,u,n){function r(z){y.emit("change",{direction:"pull",change:z})}function x(z){y.emit("change",{direction:"push",change:z})}function q(z){y.emit("denied",{direction:"push",doc:z})}function v(z){y.emit("denied",{direction:"pull",doc:z})}function i(){y.pushPaused=!0,y.pullPaused&&y.emit("paused")}function o(){y.pullPaused=!0,y.pushPaused&&y.emit("paused")}function k(){y.pushPaused=!1,y.pullPaused&&y.emit("active",{direction:"push"})}function w(){y.pullPaused=!1,y.pushPaused&&y.emit("active",{direction:"pull"})}function m(z){return function(D,A){var B="change"===D&&(A===r||A===x),F="denied"===D&&(A===v||A===q),C="paused"===D&&(A===o||A===i),E="active"===D&&(A===w||A===k);(B||F||C||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&y.removeAllListeners(D))}}var y=this;this.canceled=!1;var p=u.push?d0.extend({},u,u.push):u,h=u.pull?d0.extend({},u,u.pull):u;this.push=cS(l,s,p),this.pull=cS(s,l,h),this.pushPaused=!0,this.pullPaused=!0;var g={};u.live&&(this.push.on("complete",y.pull.cancel.bind(y.pull)),this.pull.on("complete",y.push.cancel.bind(y.push))),this.on("newListener",function(z){"change"===z?(y.pull.on("change",r),y.push.on("change",x)):"denied"===z?(y.pull.on("denied",v),y.push.on("denied",q)):"active"===z?(y.pull.on("active",w),y.push.on("active",k)):"paused"===z&&(y.pull.on("paused",o),y.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(y.pull.removeListener("change",r),y.push.removeListener("change",x)):"denied"===z?(y.pull.removeListener("denied",v),y.push.removeListener("denied",q)):"active"===z?(y.pull.removeListener("active",w),y.push.removeListener("active",k)):"paused"===z&&(y.pull.removeListener("paused",o),y.push.removeListener("paused",i))}),this.pull.on("removeListener",m("pull")),this.push.on("removeListener",m("push"));var j=e9.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return y.emit("complete",z),n&&n(null,z),y.removeAllListeners(),z},function(z){if(y.cancel(),n?n(z):y.emit("error",z),y.removeAllListeners(),n){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function c6(g){g.replicate=cS,g.sync=aC}var eJ,d0=c(9),dO=dg(c(5)),aZ=dg(c(8)),aK=dg(c(10)),bz=c(14),b2=dg(c(4)),aX=c(1),d5=dg(c(15)),cY=dg(c(16)),cf=dg(c(17)),au=c(12),e9="function"==typeof Promise?Promise:aK,fO=Function.prototype.toString,b6=fO.call(Object),eP=dO("pouchdb:api"),bb=6;if(fH()){eJ=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),eJ=!!localStorage.getItem("_pouch_check_localstorage")}catch(ca){eJ=!1}}aZ(f5,aX.EventEmitter),f5.prototype.addListener=function(i,l,g,m){function j(){function o(){h=!1}if(k._listeners[l]){if(h){return void (h="waiting")}h=!0;var n=dy(m,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(n).on("change",function(p){p.seq>m.since&&!m.cancelled&&(m.since=p.seq,m.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){j()},0),h=!1}).on("error",o)}}if(!this._listeners[l]){var k=this,h=!1;this._listeners[l]=j,this.on(i,j)}},f5.prototype.removeListener=function(g,h){h in this._listeners&&aX.EventEmitter.prototype.removeListener.call(this,g,this._listeners[h])},f5.prototype.notifyLocalWindows=function(g){fH()?chrome.storage.local.set({dbName:g}):dd()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},f5.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},aZ(d8,Error),d8.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var cs=new d8({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),cz=new d8({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),by=new d8({status:404,error:"not_found",reason:"missing"}),bw=new d8({status:409,error:"conflict",reason:"Document update conflict"}),c8=new d8({status:400,error:"invalid_id",reason:"_id field must contain a string"}),dJ=new d8({status:412,error:"missing_id",reason:"_id is required for puts"}),fI=new d8({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),bm=new d8({status:412,error:"precondition_failed",reason:"Database not open"}),dF=new d8({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),eW=new d8({status:500,error:"badarg",reason:"Some query argument is invalid"}),eH=new d8({status:400,error:"invalid_request",reason:"Request was invalid"}),ba=new d8({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ka=new d8({status:500,error:"doc_validation",reason:"Bad special document member"}),e6=new d8({status:400,error:"bad_request",reason:"Something wrong with the request"}),d4=new d8({status:400,error:"bad_request",reason:"Document must be a JSON object"}),bF=new d8({status:404,error:"not_found",reason:"Database not found"}),bW=new d8({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ea=new d8({status:500,error:"web_sql_went_bad",reason:"unknown"}),kd=new d8({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),bE=new d8({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),ck=new d8({status:400,error:"bad_request",reason:"Invalid rev format"}),jR=new d8({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),cM=new d8({status:412,error:"missing_stub"}),d6=new d8({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cG=[cs,cz,by,bw,c8,dJ,fI,bm,dF,eW,eH,ba,ka,e6,d4,bF,ea,kd,bE,ck,jR,cM,bW,d6],cD=function(j,h,g){var i=cG.filter(function(k){return k[j]===h});return g&&i.filter(function(k){return k.message===g})[0]||i[0]},f1=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],df="queryKey",eZ=/(?:^|&)([^&=]*)=?([^&]*)/g,kh=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eQ="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");aZ(aT,aX.EventEmitter),aT.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},aT.prototype.doChanges=function(k){var i=this,h=k.complete;if(k=ch(k),"live" in k&&!("continuous" in k)&&(k.continuous=k.live),k.processChange=aI,"latest"===k.since&&(k.since="now"),k.since||(k.since=0),"now"===k.since){return void this.db.info().then(function(l){return i.isCancelled?void h(null,{status:"cancelled"}):(k.since=l.update_seq,void i.doChanges(k))},h)}if(k.continuous&&"now"!==k.since&&this.db.info().then(function(l){i.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),k.view&&!k.filter&&(k.filter="_view"),k.filter&&"string"==typeof k.filter&&("_view"===k.filter?k.view=bc(k.view):k.filter=bc(k.filter),"http"!==this.db.type()&&!k.doc_ids)){return this.filterChanges(k)}"descending" in k||(k.descending=!1),k.limit=0===k.limit?1:k.limit,k.complete=h;var j=this.db._changes(k);if(j&&"function"==typeof j.cancel){var g=i.cancel;i.cancel=b2(function(l){j.cancel(),g.apply(this,l)})}},aT.prototype.filterChanges=function(l){var j=this,i=l.complete;if("_view"===l.filter){if(!l.view||"string"!=typeof l.view){var k=cU(e6,"`view` filter parameter not found or invalid.");return i(k)}var h=d2(l.view);this.db.get("_design/"+h[0],function(n,m){if(j.isCancelled){return i(null,{status:"cancelled"})}if(n){return i(eO(n))}var o=m&&m.views&&m.views[h[1]]&&m.views[h[1]].map;return o?(l.filter=aA(o),void j.doChanges(l)):i(cU(by,m.views?"missing json key: "+h[1]:"missing json key: views"))})}else{var g=d2(l.filter);if(!g){return j.doChanges(l)}this.db.get("_design/"+g[0],function(o,m){if(j.isCancelled){return i(null,{status:"cancelled"})}if(o){return i(eO(o))}var n=m&&m.filters&&m.filters[g[1]];return n?(l.filter=eM(n),void j.doChanges(l)):i(cU(by,m&&m.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},aZ(eU,aX.EventEmitter),eU.prototype.post=e4("post",function(i,h,g){return"function"==typeof h&&(g=h,h={}),"object"!=typeof i||Array.isArray(i)?g(cU(d4)):void this.bulkDocs({docs:[i]},h,dT(g))}),eU.prototype.put=e4("put",b2(function(h){function j(){i||(av("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),i=!0)}var n,k,o,g,i=!1,l=h.shift(),m="_id" in l;if("object"!=typeof l||Array.isArray(l)){return(g=h.pop())(cU(d4))}for(;;){if(n=h.shift(),k=typeof n,"string"!==k||m?"string"!==k||!m||"_rev" in l?"object"===k?o=n:"function"===k&&(g=n):(j(),l._rev=n):(j(),l._id=n,m=!0),!h.length){break}}return o=o||{},bS(l._id),cI(l._id)&&"function"==typeof this._putLocal?l._deleted?this._removeLocal(l,g):this._putLocal(l,g):void this.bulkDocs({docs:[l]},o,dT(g))})),eU.prototype.putAttachment=e4("putAttachment",function(i,l,g,m,j){function k(n){var o="_rev" in n?parseInt(n._rev,10):0;return n._attachments=n._attachments||{},n._attachments[l]={content_type:j,data:m,revpos:++o},h.put(n)}var h=this;return"function"==typeof j&&(j=m,m=g,g=null),"undefined"==typeof j&&(j=m,m=g,g=null),h.get(i).then(function(n){if(n._rev!==g){throw cU(bw)}return k(n)},function(n){if(n.reason===by.message){return k({_id:i})}throw n})}),eU.prototype.removeAttachment=e4("removeAttachment",function(k,i,h,j){var g=this;g.get(k,function(m,l){return m?void j(m):l._rev!==h?void j(cU(bw)):l._attachments?(delete l._attachments[i],0===Object.keys(l._attachments).length&&delete l._attachments,void g.put(l,j)):j()})}),eU.prototype.remove=e4("remove",function(l,j,i,k){var h;"string"==typeof j?(h={_id:l,_rev:j},"function"==typeof i&&(k=i,i={})):(h=l,"function"==typeof j?(k=j,i={}):(k=i,i=j)),i=i||{},i.was_delete=!0;var g={_id:h._id,_rev:h._rev||i.rev};return g._deleted=!0,cI(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(h,k):void this.bulkDocs({docs:[g]},i,dT(k))}),eU.prototype.revsDiff=e4("revsDiff",function(h,i,j){function k(o,p){g.has(o)||g.set(o,{missing:[]}),g.get(o).missing.push(p)}function m(q,p){var o=h[q].slice(0);ds(p,function(r,x,w,s,v){var u=x+"-"+w,y=o.indexOf(u);-1!==y&&(o.splice(y,1),"available"!==v.status&&k(q,u))}),o.forEach(function(r){k(q,r)})}"function"==typeof i&&(j=i,i={});var n=Object.keys(h);if(!n.length){return j(null,{})}var l=0,g=new bz.Map;n.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){g.set(o,{missing:h[o]})}else{if(q){return j(q)}m(o,p)}if(++l===n.length){var r={};return g.forEach(function(u,s){r[s]=u}),j(null,r)}})},this)}),eU.prototype.bulkGet=e4("bulkGet",function(g,h){eB(this,g,h)}),eU.prototype.compactDocument=e4("compactDocument",function(j,h,g){var i=this;this._getRevisionTree(j,function(l,o){if(l){return g(l)}var m=cm(o),k=[],n=[];Object.keys(m).forEach(function(p){m[p]>h&&k.push(p)}),ds(o,function(r,p,u,q,s){var v=p+"-"+u;"available"===s.status&&-1!==k.indexOf(v)&&n.push(v)}),i._doCompaction(j,n,g)})}),eU.prototype.compact=e4("compact",function(i,h){"function"==typeof i&&(h=i,i={});var g=this;i=i||{},g._compactionQueue=g._compactionQueue||[],g._compactionQueue.push({opts:i,callback:h}),1===g._compactionQueue.length&&cV(g)}),eU.prototype._compact=function(i,l){function g(n){h.push(j.compactDocument(n.id,0))}function m(n){var o=n.last_seq;e9.all(h).then(function(){return jG(j,"_local/compaction",function(p){return !p.last_seq||p.last_seq<o?(p.last_seq=o,p):!1})}).then(function(){l(null,{ok:!0})})["catch"](l)}var j=this,k={return_docs:!1,last_seq:i.last_seq||0},h=[];j.changes(k).on("change",g).on("complete",m).on("error",l)},eU.prototype.get=e4("get",function(h,i,j){function k(){var o=[],p=m.length;return p?void m.forEach(function(q){n.get(h,{rev:q,revs:i.revs,attachments:i.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||j(null,o)})}):j(null,o)}if("function"==typeof i&&(j=i,i={}),"string"!=typeof h){return j(cU(c8))}if(cI(h)&&"function"==typeof this._getLocal){return this._getLocal(h,j)}var m=[],n=this;if(!i.open_revs){return this._get(h,i,function(v,x){if(v){return j(v)}var o=x.doc,y=x.metadata,B=x.ctx;if(i.conflicts){var C=du(y);C.length&&(o._conflicts=C)}if(jY(y,o._rev)&&(o._deleted=!0),i.revs||i.revs_info){var A=e8(y.rev_tree),r=eS(A,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(o._rev.split("-")[1])}),p=r.ids.map(function(D){return D.id}).indexOf(o._rev.split("-")[1])+1,w=r.ids.length-p;if(r.ids.splice(p,w),r.ids.reverse(),i.revs&&(o._revisions={start:r.pos+r.ids.length-1,ids:r.ids.map(function(D){return D.id})}),i.revs_info){var s=r.pos+r.ids.length;o._revs_info=r.ids.map(function(D){return s--,{rev:s+"-"+D.id,status:D.opts.status}})}}if(i.attachments&&o._attachments){var z=o._attachments,u=Object.keys(z).length;if(0===u){return j(null,o)}Object.keys(z).forEach(function(D){this._getAttachment(o._id,D,z[D],{rev:o._rev,binary:i.binary,ctx:B},function(F,G){var E=o._attachments[D];E.data=G,delete E.stub,delete E.length,--u||j(null,o)})},n)}else{if(o._attachments){for(var q in o._attachments){o._attachments.hasOwnProperty(q)&&(o._attachments[q].stub=!0)}}j(null,o)}})}if("all"===i.open_revs){this._getRevisionTree(h,function(o,p){return o?j(o):(m=bV(p).map(function(q){return q.rev}),void k())})}else{if(!Array.isArray(i.open_revs)){return j(cU(dF,"function_clause"))}m=i.open_revs;for(var l=0;l<m.length;l++){var g=m[l];if("string"!=typeof g||!/^\d+-/.test(g)){return j(cU(ck))}}k()}}),eU.prototype.getAttachment=e4("getAttachment",function(k,i,h,j){var g=this;h instanceof Function&&(j=h,h={}),this._get(k,h,function(m,l){return m?j(m):l.doc._attachments&&l.doc._attachments[i]?(h.ctx=l.ctx,h.binary=!0,g._getAttachment(k,i,l.doc._attachments[i],h,j),void 0):j(cU(by))})}),eU.prototype.allDocs=e4("allDocs",function(i,h){if("function"==typeof i&&(h=i,i={}),i.skip="undefined"!=typeof i.skip?i.skip:0,i.start_key&&(i.startkey=i.start_key),i.end_key&&(i.endkey=i.end_key),"keys" in i){if(!Array.isArray(i.keys)){return h(new TypeError("options.keys must be an array"))}var g=["startkey","endkey","key"].filter(function(j){return j in i})[0];if(g){return void h(cU(ba,"Query parameter `"+g+"` is not compatible with multi-get"))}if("http"!==this.type()){return eI(this,i,h)}}return this._allDocs(i,h)}),eU.prototype.changes=function(g,h){return"function"==typeof g&&(h=g,g={}),new aT(this,g,h)},eU.prototype.close=e4("close",function(g){return this._closed=!0,this._close(g)}),eU.prototype.info=e4("info",function(g){var h=this;this._info(function(j,i){return j?g(j):(i.db_name=i.db_name||h._db_name,i.auto_compaction=!(!h.auto_compaction||"http"===h.type()),i.adapter=h.type(),void g(null,i))})}),eU.prototype.id=e4("id",function(g){return this._id(g)}),eU.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},eU.prototype.bulkDocs=e4("bulkDocs",function(k,i,h){if("function"==typeof i&&(h=i,i={}),i=i||{},Array.isArray(k)&&(k={docs:k}),!k||!k.docs||!Array.isArray(k.docs)){return h(cU(cz))}for(var j=0;j<k.docs.length;++j){if("object"!=typeof k.docs[j]||Array.isArray(k.docs[j])){return h(cU(d4))}}var g;return k.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){g=g||bH(m)})}),g?h(cU(e6,g)):("new_edits" in i||("new_edits" in k?i.new_edits=k.new_edits:i.new_edits=!0),i.new_edits||"http"===this.type()||k.docs.sort(ek),ki(k.docs),this._bulkDocs(k,i,function(m,l){return m?h(m):(i.new_edits||(l=l.filter(function(n){return n.error})),void h(null,l))}))}),eU.prototype.registerDependentDatabase=e4("registerDependentDatabase",function(j,h){function g(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[j]?!1:(k.dependentDbs[j]=!0,k)}var i=new this.constructor(j,this.__opts);jG(this,"_local/_pouch_dependentDbs",g).then(function(){h(null,{db:i})})["catch"](h)}),eU.prototype.destroy=e4("destroy",function(k,i){function h(){j._destroy(k,function(l,m){return l?i(l):(j._destroyed=!0,j.emit("destroyed"),void i(null,m||{ok:!0}))})}"function"==typeof k&&(i=k,k={});var j=this,g="use_prefix" in j?j.use_prefix:!0;return"http"===j.type()?h():void j.get("_local/_pouch_dependentDbs",function(m,p){if(m){return 404!==m.status?i(m):h()}var n=p.dependentDbs,l=j.constructor,o=Object.keys(n).map(function(r){var q=g?r.replace(new RegExp("^"+l.prefix),""):r;return new l(q,j.__opts).destroy()});e9.all(o).then(h,i)})}),bR.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},bR.prototype.fail=function(g){this.failed=g,this.execute()},bR.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},bR.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},aZ(c9,eU),c9.debug=dO,c9.adapters={},c9.preferredAdapters=[],c9.prefix="_pouch_";var c2=new aX.EventEmitter;eR(c9),c9.parseAdapter=function(h,i){var j,k,m=h.match(/([a-z\-]*):\/\/(.*)/);if(m){if(h=/http(s?)/.test(m[1])?m[1]+"://"+m[2]:m[2],j=m[1],!c9.adapters[j].valid()){throw"Invalid adapter"}return{name:h,adapter:m[1]}}var n="idb" in c9.adapters&&"websql" in c9.adapters&&dd()&&localStorage["_pouch__websqldb_"+c9.prefix+h];if(i.adapter){k=i.adapter}else{if("undefined"!=typeof i&&i.db){k="leveldb"}else{for(var l=0;l<c9.preferredAdapters.length;++l){if(k=c9.preferredAdapters[l],k in c9.adapters){if(n&&"idb"===k){av("log",'PouchDB is downgrading "'+h+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}j=c9.adapters[k];var g=j&&"use_prefix" in j?j.use_prefix:!0;return{name:g?c9.prefix+h:h,adapter:k}},c9.adapter=function(i,h,g){h.valid()&&(c9.adapters[i]=h,g&&c9.preferredAdapters.push(i))},c9.plugin=function(g){return"function"==typeof g?g(c9):Object.keys(g).forEach(function(h){c9.prototype[h]=g[h]}),c9},c9.defaults=function(g){function h(k,i,j){return this instanceof h?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=d0.extend({},g,i),void c9.call(this,k,i,j)):new h(k,i,j)}return aZ(h,c9),h.preferredAdapters=c9.preferredAdapters.slice(),Object.keys(c9).forEach(function(i){i in h||(h[i]=c9[i])}),h};var f7="5.4.4";c9.version=f7;var bA,fG=e3(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cu=e3(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),d1=function(g){return atob(g)},dV=function(g){return btoa(g)},dP=dX.setImmediate||dX.setTimeout,bG=32768,dG=5,cA="document-store",e7="by-sequence",dl="attach-store",bT="attach-seq-store",c7="meta-store",bx="local-store",aq="detect-blob-support",dW={running:!1,queue:[]},dQ=new bz.Map,bg=new f5,bL=new bz.Map;j0.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var dL=7,jL=bh("document-store"),el=bh("by-sequence"),am=bh("attach-store"),kf=bh("local-store"),bX=bh("metadata-store"),a9=bh("attach-seq-store"),f4=new bz.Map,cv=new f5,b7=1,cW="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+el+" (seq, deleted)",cB="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+el+" (doc_id, rev)",ag="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+jL+" (winningseq)",dx="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+a9+" (seq)",aW="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+a9+" (digest, seq)",bD=el+".seq = "+jL+".winningseq",ak=el+".seq AS seq, "+el+".deleted AS deleted, "+el+".json AS data, "+el+".rev AS rev, "+jL+".json AS metadata";eb.valid=d3,eb.use_prefix=!0;var az=bK(),jK=function(){},j6=25,ke=50,cT={},bj=1800,fF=dO("pouchdb:http");f8.valid=function(){return !0},kk.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},kk.prototype.finish=function(){return this.promise};var b3=function(g,h){return h&&g.then(function(i){c1.nextTick(function(){h(null,i)})},function(i){c1.nextTick(function(){h(i)})}),g},cN=function(g){return b2(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&b3(i,j),i})},aF=function(g,h){return g.then(function(i){return h().then(function(){return i})},function(i){return h().then(function(){throw i})})},cg=function(g,h){return function(){var j=arguments,i=this;return g.add(function(){return h.apply(i,j)})}},b0=function(l){for(var j={},i=0,k=l.length;k>i;i++){j["$"+l[i]]=!0}var h=Object.keys(j),g=new Array(h.length);for(i=0,k=h.length;k>i;i++){g[i]=h[i].substring(1)}return g},fA={},ax=new kk,j5=50,dB=av.bind(null,"log"),d7={_sum:function(g,h){return f6(h)},_count:function(g,h){return h.length},_stats:function(i,h){function g(n){for(var l=0,k=0,m=n.length;m>k;k++){var j=n[k];l+=j*j}return l}return{sum:f6(h),min:Math.min.apply(null,h),max:Math.max.apply(null,h),count:h.length,sumsqr:g(h)}}},aN=cN(function(){var g=this;return"http"===g.type()?bQ(g):"function"==typeof g._viewCleanup?eN(g):cC(g)}),f2=function(k,i,h){"function"==typeof i&&(h=i,i={}),i=i?c0(i):{},"function"==typeof k&&(k={map:k});var j=this,g=e9.resolve().then(function(){return dw(j,k,i)});return b3(g,h),g};aZ(jI,Error),aZ(dS,Error),aZ(cl,Error);var d9={query:f2,viewCleanup:aN},bN=1,dK="pouchdb",dp=5,jS=0;j2.prototype.writeCheckpoint=function(i,h){var g=this;return this.updateTarget(i,h).then(function(){return g.updateSource(i,h)})},j2.prototype.updateTarget=function(g,h){return ac(this.target,this.id,g,h,this.returnValue)},j2.prototype.updateSource=function(i,h){var g=this;return this.readOnlySource?e9.resolve(!0):ac(this.src,this.id,i,h,this.returnValue)["catch"](function(j){if(da(j)){return g.readOnlySource=!0,!0}throw j})};var bp={undefined:function(g,h){return 0===au.collate(g.last_seq,h.last_seq)?h.last_seq:0},1:function(g,h){return cJ(h,g).last_seq}};j2.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?e9.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return jS}var j;return j=h.version?h.version.toString():"undefined",j in bp?bp[j](h,i):jS},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:jS}).then(function(){return jS},function(j){return da(j)?(g.readOnlySource=!0,h.last_seq):jS})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return jS})};var bZ=0;aZ(cL,aX.EventEmitter),cL.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},cL.prototype.ready=function(k,i){function h(){g.cancel()}function j(){k.removeListener("destroyed",h),i.removeListener("destroyed",h)}var g=this;g._readyCalled||(g._readyCalled=!0,k.once("destroyed",h),i.once("destroyed",h),g.once("complete",j))},aZ(dm,aX.EventEmitter),dm.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},c9.plugin(b4).plugin(fN).plugin(aY).plugin(d9).plugin(c6),f.exports=c9}).call(this,c(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(c,f,d){function g(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}f.exports=g},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+f.humanize(this.diff),!n){return e}var i="color: "+this.color;e=[e[0],i,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,p=0;return e[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(o++,"%c"===q&&(p=o))}),e.splice(p,0,i),e}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(q,g,l){function j(){return l.colors[p++%l.colors.length]}function k(e){function i(){}function n(){var s=n,u=+new Date,t=u-(v||u);s.diff=t,s.prev=v,s.curr=u,v=u,null==s.useColors&&(s.useColors=l.useColors()),null==s.color&&s.useColors&&(s.color=j());var o=Array.prototype.slice.call(arguments);o[0]=l.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var x=0;o[0]=o[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}x++;var w=l.formatters[B];if("function"==typeof w){var C=o[x];D=w.call(s,C),o.splice(x,1),x--}return D}),"function"==typeof l.formatArgs&&(o=l.formatArgs.apply(s,o));var r=n.log||l.log||console.log.bind(console);r.apply(s,o)}i.enabled=!1,n.enabled=!0;var f=l.enabled(e)?n:i;return f.namespace=e,f}function m(n){l.save(n);for(var e=(n||"").split(/[\s,]+/),i=e.length,f=0;i>f;f++){e[f]&&(n=e[f].replace(/\*/g,".*?"),"-"===n[0]?l.skips.push(new RegExp("^"+n.substr(1)+"$")):l.names.push(new RegExp("^"+n+"$")))}}function c(){l.enable("")}function h(i){var e,f;for(e=0,f=l.skips.length;f>e;e++){if(l.skips[e].test(i)){return !1}}for(e=0,f=l.names.length;f>e;e++){if(l.names[e].test(i)){return !0}}return !1}function d(e){return e instanceof Error?e.stack||e.message:e}l=g.exports=k,l.coerce=d,l.disable=c,l.enable=m,l.enabled=h,l.humanize=q(11),l.names=[],l.skips=[],l.formatters={};var v,p=0},{11:11}],7:[function(c,f,d){(function(e){function q(){w=!0;for(var n,l,i=t.length;i;){for(l=t,t=[],n=-1;++n<i;){l[n]()}i=t.length}w=!1}function k(i){1!==t.push(i)||w||m()}var m,v=e.MutationObserver||e.WebKitMutationObserver;if(v){var g=0,j=new v(q),h=e.document.createTextNode("");j.observe(h,{characterData:!0}),m=function(){h.data=g=++g%2}}else{if(e.setImmediate||"undefined"==typeof e.MessageChannel){m="document" in e&&"onreadystatechange" in e.document.createElement("script")?function(){var i=e.document.createElement("script");i.onreadystatechange=function(){q(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},e.document.documentElement.appendChild(i)}:function(){setTimeout(q,0)}}else{var p=new e.MessageChannel;p.port1.onmessage=q,m=function(){p.port2.postMessage(0)}}}var w,t=[];f.exports=k}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(c,f,d){"function"==typeof Object.create?f.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(c,f,d){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(l){if(l){for(var k in l){"object"==typeof l[k]&&i[k]?h.call(i,i[k],l[k]):i[k]=l[k]}}}),i};this.extend=h}).call(this)},{}],10:[function(E,k,x){function D(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=H,this.queue=[],this.outcome=void 0,e!==D&&g(this,e)}function z(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function I(f,e,h){G(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function C(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(i,m){function f(o){e||(e=!0,d.reject(i,o))}function h(o){e||(e=!0,d.resolve(i,o))}function l(){m(h,f)}var e=!1,n=w(l);"error"===n.status&&f(n.value)}function w(f,i){var h={};try{h.value=f(i),h.status="success"}catch(e){h.status="error",h.value=e}return h}function A(e){return e instanceof this?e:d.resolve(new this(D),e)}function q(f){var e=new this(D);return d.reject(e,f)}function F(e){function f(r,s){function t(u){l[s]=u,++h!==n||p||(p=!0,d.resolve(i,l))}o.resolve(r).then(t,function(u){p||(p=!0,d.reject(i,u))})}var o=this;if("[object Array]"!==Object.prototype.toString.call(e)){return this.reject(new TypeError("must be an array"))}var n=e.length,p=!1;if(!n){return this.resolve([])}for(var l=new Array(n),h=0,m=-1,i=new this(D);++m<n;){f(e[m],m)}return i}function B(i){function m(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(h,p))},function(p){e||(e=!0,d.reject(h,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(i)){return this.reject(new TypeError("must be an array"))}var l=i.length,e=!1;if(!l){return this.resolve([])}for(var n=-1,h=new this(D);++n<l;){m(i[n])}return h}var G=E(7),d={},c=["REJECTED"],J=["FULFILLED"],H=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(e,i){if("function"!=typeof e&&this.state===J||"function"!=typeof i&&this.state===c){return this}var h=new this.constructor(D);if(this.state!==H){var f=this.state===J?e:i;I(h,f,this.outcome)}else{this.queue.push(new z(h,e,i))}return h},z.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},z.prototype.otherCallFulfilled=function(e){I(this.promise,this.onFulfilled,e)},z.prototype.callRejected=function(e){d.reject(this.promise,e)},z.prototype.otherCallRejected=function(e){I(this.promise,this.onRejected,e)},d.resolve=function(h,f){var l=w(C,f);if("error"===l.status){return d.reject(h,l.value)}var m=l.value;if(m){g(h,m)}else{h.state=J,h.outcome=f;for(var i=-1,e=h.queue.length;++i<e;){h.queue[i].callFulfilled(f)}}return h},d.reject=function(f,i){f.state=c,f.outcome=i;for(var h=-1,e=f.queue.length;++h<e;){f.queue[h].callRejected(i)}return f},j.resolve=A,j.reject=q,j.all=F,j.race=B},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(c,v,d){function C(f){if(null!==f){switch(typeof f){case"boolean":return f?1:0;case"number":return q(f);case"string":return f.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var i=Array.isArray(f),n=i?f:Object.keys(f),e=-1,o=n.length,l="";if(i){for(;++e<o;){l+=d.toIndexableString(n[e])}}else{for(;++e<o;){var h=n[e];l+=d.toIndexableString(h)+d.toIndexableString(f[h])}}return l}}return""}function m(e,l){var r,o=l,p="1"===e[l];if(p){r=0,l++}else{var s="0"===e[l];l++;var h="",n=e.substring(l,l+z),i=parseInt(n,10)+x;for(s&&(i=-i),l+=z;;){var f=e[l];if("\x00"===f){break}h+=f,l++}h=h.split("."),r=1===h.length?parseInt(h,10):parseFloat(h[0]+"."+h[1]),s&&(r-=10),0!==i&&(r=parseFloat(r+"e"+i))}return{num:r,length:l-o}}function j(n,e){var i=n.pop();if(e.length){var l=e[e.length-1];i===l.element&&(e.pop(),l=e[e.length-1]);var o=l.element,f=l.index;if(Array.isArray(o)){o.push(i)}else{if(f===n.length-2){var h=n.pop();o[h]=i}else{n.push(i)}}}}function y(f,l){for(var e=Math.min(f.length,l.length),h=0;e>h;h++){var i=d.collate(f[h],l[h]);if(0!==i){return i}}return f.length===l.length?0:f.length>l.length?1:-1}function B(f,e){return f===e?0:f>e?1:-1}function w(f,i){for(var n=Object.keys(f),e=Object.keys(i),o=Math.min(n.length,e.length),l=0;o>l;l++){var h=d.collate(n[l],e[l]);if(0!==h){return h}if(h=d.collate(f[n[l]],i[e[l]]),0!==h){return h}}return n.length===e.length?0:n.length>e.length?1:-1}function k(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function q(i){if(0===i){return"1"}var o=i.toExponential().split(/e\+?/),f=parseInt(o[1],10),r=0>i,e=r?"0":"2",h=(r?-f:f)-x,l=g.padLeft(h.toString(),"0",z);e+=A+l;var p=Math.abs(parseFloat(o[0]));r&&(p=10-p);var n=p.toFixed(20);return n=n.replace(/\.?0+$/,""),e+=A+n}var x=-324,z=3,A="",g=c(13);d.collate=function(h,e){if(h===e){return 0}h=d.normalizeKey(h),e=d.normalizeKey(e);var f=k(h),i=k(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return B(h,e)}return Array.isArray(h)?y(h,e):w(h,e)},d.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var f=0;i>f;f++){l[f]=d.normalizeKey(h[f])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var e in h){if(h.hasOwnProperty(e)){var n=h[e];"undefined"!=typeof n&&(l[e]=d.normalizeKey(n))}}}}}return l},d.toIndexableString=function(f){var e="\x00";return f=d.normalizeKey(f),k(f)+A+C(f)+e},d.parseIndexableString=function(e){for(var l=[],p=[],o=0;;){var h=e[o++];if("\x00"!==h){switch(h){case"1":l.push(null);break;case"2":l.push("1"===e[o]),o++;break;case"3":var n=m(e,o);l.push(n.num),o+=n.length;break;case"4":for(var i="";;){var f=e[o];if("\x00"===f){break}i+=f,o++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),l.push(i);break;case"5":var s={element:[],index:l.length};l.push(s.element),p.push(s);break;case"6":var r={element:{},index:l.length};l.push(r.element),p.push(r);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+h)}}else{if(1===l.length){return l.pop()}j(l,p)}}}},{13:13}],13:[function(c,f,d){function g(k,i,h){for(var j="",e=h-k.length;j.length<e;){j+=i}return j}d.padLeft=function(h,e,j){var i=g(h,e,j);return i+h},d.padRight=function(h,e,j){var i=g(h,e,j);return h+i},d.stringLexCompare=function(p,j){var l,h=p.length,m=j.length;for(l=0;h>l;l++){if(l===m){return 1}var k=p.charAt(l),e=j.charAt(l);if(k!==e){return e>k?-1:1}}return m>h?-1:0},d.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(d,h,g){function c(){this.store={}}function f(i){if(this.store=new c,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}g.Map=c,g.Set=f,c.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},c.prototype.unmangle=function(e){return e.substring(1)},c.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},c.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},c.prototype.has=function(i){var e=this.mangle(i);return e in this.store},c.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},c.prototype.forEach=function(k){for(var e=Object.keys(this.store),l=0,j=e.length;j>l;l++){var i=e[l],m=this.store[i];i=this.unmangle(i),k(m,i)}},f.prototype.add=function(e){return this.store.set(e,!0)},f.prototype.has=function(e){return this.store.has(e)},f.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(c,f,d){(function(){var e={}.hasOwnProperty,g=[].slice;f.exports=function(m,l){var k,j,i,h;j=[],h=[];for(k in l){e.call(l,k)&&(i=l[k],"this"!==k&&(j.push(k),h.push(i)))}return Function.apply(null,g.call(j).concat([m])).apply(l["this"],h)}}).call(this)},{}],16:[function(e,d,c){!function(g){if("object"==typeof c){d.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(H){function E(i,h,n,m,l,g){return h=K(K(h,i),K(m,g)),K(h<<l|h>>>32-l,n)}function q(m,n,l,h,i,o,g){return E(n&l|~n&h,m,n,i,o,g)}function I(m,n,l,h,i,o,g){return E(n&h|l&~h,m,n,i,o,g)}function G(m,n,l,h,i,o,g){return E(n^l^h,m,n,i,o,g)}function A(m,n,l,h,i,o,g){return E(l^(n|~h),m,n,i,o,g)}function M(i,h){var n=i[0],m=i[1],g=i[2],l=i[3];n=q(n,m,g,l,h[0],7,-680876936),l=q(l,n,m,g,h[1],12,-389564586),g=q(g,l,n,m,h[2],17,606105819),m=q(m,g,l,n,h[3],22,-1044525330),n=q(n,m,g,l,h[4],7,-176418897),l=q(l,n,m,g,h[5],12,1200080426),g=q(g,l,n,m,h[6],17,-1473231341),m=q(m,g,l,n,h[7],22,-45705983),n=q(n,m,g,l,h[8],7,1770035416),l=q(l,n,m,g,h[9],12,-1958414417),g=q(g,l,n,m,h[10],17,-42063),m=q(m,g,l,n,h[11],22,-1990404162),n=q(n,m,g,l,h[12],7,1804603682),l=q(l,n,m,g,h[13],12,-40341101),g=q(g,l,n,m,h[14],17,-1502002290),m=q(m,g,l,n,h[15],22,1236535329),n=I(n,m,g,l,h[1],5,-165796510),l=I(l,n,m,g,h[6],9,-1069501632),g=I(g,l,n,m,h[11],14,643717713),m=I(m,g,l,n,h[0],20,-373897302),n=I(n,m,g,l,h[5],5,-701558691),l=I(l,n,m,g,h[10],9,38016083),g=I(g,l,n,m,h[15],14,-660478335),m=I(m,g,l,n,h[4],20,-405537848),n=I(n,m,g,l,h[9],5,568446438),l=I(l,n,m,g,h[14],9,-1019803690),g=I(g,l,n,m,h[3],14,-187363961),m=I(m,g,l,n,h[8],20,1163531501),n=I(n,m,g,l,h[13],5,-1444681467),l=I(l,n,m,g,h[2],9,-51403784),g=I(g,l,n,m,h[7],14,1735328473),m=I(m,g,l,n,h[12],20,-1926607734),n=G(n,m,g,l,h[5],4,-378558),l=G(l,n,m,g,h[8],11,-2022574463),g=G(g,l,n,m,h[11],16,1839030562),m=G(m,g,l,n,h[14],23,-35309556),n=G(n,m,g,l,h[1],4,-1530992060),l=G(l,n,m,g,h[4],11,1272893353),g=G(g,l,n,m,h[7],16,-155497632),m=G(m,g,l,n,h[10],23,-1094730640),n=G(n,m,g,l,h[13],4,681279174),l=G(l,n,m,g,h[0],11,-358537222),g=G(g,l,n,m,h[3],16,-722521979),m=G(m,g,l,n,h[6],23,76029189),n=G(n,m,g,l,h[9],4,-640364487),l=G(l,n,m,g,h[12],11,-421815835),g=G(g,l,n,m,h[15],16,530742520),m=G(m,g,l,n,h[2],23,-995338651),n=A(n,m,g,l,h[0],6,-198630844),l=A(l,n,m,g,h[7],10,1126891415),g=A(g,l,n,m,h[14],15,-1416354905),m=A(m,g,l,n,h[5],21,-57434055),n=A(n,m,g,l,h[12],6,1700485571),l=A(l,n,m,g,h[3],10,-1894986606),g=A(g,l,n,m,h[10],15,-1051523),m=A(m,g,l,n,h[1],21,-2054922799),n=A(n,m,g,l,h[8],6,1873313359),l=A(l,n,m,g,h[15],10,-30611744),g=A(g,l,n,m,h[6],15,-1560198380),m=A(m,g,l,n,h[13],21,1309151649),n=A(n,m,g,l,h[4],6,-145523070),l=A(l,n,m,g,h[11],10,-1120210379),g=A(g,l,n,m,h[2],15,718787259),m=A(m,g,l,n,h[9],21,-343485551),i[0]=K(n,i[0]),i[1]=K(m,i[1]),i[2]=K(g,i[2]),i[3]=K(l,i[3])}function F(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g.charCodeAt(i)+(g.charCodeAt(i+1)<<8)+(g.charCodeAt(i+2)<<16)+(g.charCodeAt(i+3)<<24)}return h}function x(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g[i]+(g[i+1]<<8)+(g[i+2]<<16)+(g[i+3]<<24)}return h}function D(g){var p,h,o,r,m,l,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(p=64;i>=p;p+=64){M(n,F(g.substring(p-64,p)))}for(g=g.substring(p-64),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;h>p;p+=1){o[p>>2]|=g.charCodeAt(p)<<(p%4<<3)}if(o[p>>2]|=128<<(p%4<<3),p>55){for(M(n,o),p=0;16>p;p+=1){o[p]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=m,o[15]=l,M(n,o),n}function w(g){var l,h,o,r,m,p,i=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(l=64;i>=l;l+=64){M(n,x(g.subarray(l-64,l)))}for(g=i>l-64?g.subarray(l-64):new Uint8Array(0),h=g.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;h>l;l+=1){o[l>>2]|=g[l]<<(l%4<<3)}if(o[l>>2]|=128<<(l%4<<3),l>55){for(M(n,o),l=0;16>l;l+=1){o[l]=0}}return r=8*i,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),p=parseInt(r[1],16)||0,o[14]=m,o[15]=p,M(n,o),n}function B(g){var i,h="";for(i=0;4>i;i+=1){h+=L[g>>8*i+4&15]+L[g>>8*i&15]}return h}function J(h){var g;for(g=0;g<h.length;g+=1){h[g]=B(h[g])}return h.join("")}function C(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(i,h){var n,m=i.length,l=new ArrayBuffer(m),g=new Uint8Array(l);for(n=0;m>n;n+=1){g[n]=i.charCodeAt(n)}return h?g:l}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(h,g,i){var l=new Uint8Array(h.byteLength+g.byteLength);return l.set(new Uint8Array(h)),l.set(new Uint8Array(g),h.byteLength),i?l:l.buffer}function N(h){var g,i=[],l=h.length;for(g=0;l-1>g;g+=2){i.push(parseInt(h.substr(g,2),16))}return String.fromCharCode.apply(String,i)}function z(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==J(D("hello"))&&(K=function(h,g){var i=(65535&h)+(65535&g),l=(h>>16)+(g>>16)+(i>>16);return l<<16|65535&i}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(h,i){return h=0|h||0,0>h?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(s,n){var r,l,o,p,m=this.byteLength,h=g(s,m),i=m;return n!==H&&(i=g(n,m)),h>i?new ArrayBuffer(0):(r=i-h,l=new ArrayBuffer(r),o=new Uint8Array(l),p=new Uint8Array(this,h,r),o.set(p),l)}}(),z.prototype.append=function(g){return this.appendBinary(C(g)),this},z.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var i,h=this._buff.length;for(i=64;h>=i;i+=64){M(this._hash,F(this._buff.substring(i-64,i)))}return this._buff=this._buff.substring(i-64),this},z.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m.charCodeAt(h)<<(h%4<<3)}return this._finish(g,l),n=J(this._hash),i&&(n=N(n)),this.reset(),n},z.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},z.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},z.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},z.prototype._finish=function(i,h){var n,m,l,g=h;if(i[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,i),g=0;16>g;g+=1){i[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(n[2],16),l=parseInt(n[1],16)||0,i[14]=m,i[15]=l,M(this._hash,i)},z.hash=function(h,g){return z.hashBinary(C(h),g)},z.hashBinary=function(h,g){var i=D(h),l=J(i);return g?N(l):l},z.ArrayBuffer=function(){this.reset()},z.ArrayBuffer.prototype.append=function(h){var g,i=f(this._buff.buffer,h,!0),l=i.length;for(this._length+=h.byteLength,g=64;l>=g;g+=64){M(this._hash,x(i.subarray(g-64,g)))}return this._buff=l>g-64?new Uint8Array(i.buffer.slice(g-64)):new Uint8Array(0),this},z.ArrayBuffer.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m[h]<<(h%4<<3)}return this._finish(g,l),n=J(this._hash),i&&(n=N(n)),this.reset(),n},z.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.ArrayBuffer.prototype.getState=function(){var g=z.prototype.getState.call(this);return g.buff=j(g.buff),g},z.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),z.prototype.setState.call(this,g)},z.ArrayBuffer.prototype.destroy=z.prototype.destroy,z.ArrayBuffer.prototype._finish=z.prototype._finish,z.ArrayBuffer.hash=function(h,g){var i=w(new Uint8Array(h)),l=J(i);return g?N(l):l},z})},{}],17:[function(c,f,d){function g(p,j,l){var h=l[l.length-1];p===h.element&&(l.pop(),h=l[l.length-1]);var m=h.element,k=h.index;if(Array.isArray(m)){m.push(p)}else{if(k===j.length-2){var e=j.pop();m[e]=p}else{j.push(p)}}}d.stringify=function(v){var q=[];q.push({obj:v});for(var B,p,w,m,z,A,x,j,h,k,y,e="";B=q.pop();){if(p=B.obj,w=B.prefix||"",m=B.val||"",e+=w,m){e+=m}else{if("object"!=typeof p){e+="undefined"==typeof p?null:JSON.stringify(p)}else{if(null===p){e+="null"}else{if(Array.isArray(p)){for(q.push({val:"]"}),z=p.length-1;z>=0;z--){A=0===z?"":",",q.push({obj:p[z],prefix:A})}q.push({val:"["})}else{x=[];for(j in p){p.hasOwnProperty(j)&&x.push(j)}for(q.push({val:"}"}),z=x.length-1;z>=0;z--){h=x[z],k=p[h],y=z>0?",":"",y+=JSON.stringify(h)+":",q.push({obj:k,prefix:y})}q.push({val:"{"})}}}}}return e},d.parse=function(j){for(var h,m,y,q,v,z,e,r,p,x=[],w=[],k=0;;){if(h=j[k++],"}"!==h&&"]"!==h&&"undefined"!=typeof h){switch(h){case" ":case"	":case"\n":case":":case",":break;case"n":k+=3,g(null,x,w);break;case"t":k+=3,g(!0,x,w);break;case"f":k+=4,g(!1,x,w);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(m="",k--;;){if(y=j[k++],!/[\d\.\-e\+]/.test(y)){k--;break}m+=y}g(parseFloat(m),x,w);break;case'"':for(q="",v=void 0,z=0;;){if(e=j[k++],'"'===e&&("\\"!==v||z%2!==1)){break}q+=e,v=e,"\\"===v?z++:z=0}g(JSON.parse('"'+q+'"'),x,w);break;case"[":r={element:[],index:x.length},x.push(r.element),w.push(r);break;case"{":p={element:{},index:x.length},x.push(p.element),w.push(p);break;default:throw new Error("unexpectedly reached end of input: "+h)}}else{if(1===x.length){return x.pop()}g(x.pop(),x,w)}}}},{}]},{},[3])(3)});