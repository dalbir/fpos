!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(n,h){if(!b[n]){if(!i[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(a){return a(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=b[n]={exports:{}};i[n][0].call(g.exports,function(p){var m=i[n][1][p];return k(m?m:p)},g,g.exports,d,i,b,l)}return b[n].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,l,j,r,f,h;if(this._events||(this._events={}),"error"===k&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[k],i(l)){return !1}if(b(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(m(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(m(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(f,a,B){function h(){e&&u&&(e=!1,u.length?b=u.concat(b):s=-1,b.length&&o())}function o(){if(!e){var g=n(h);e=!0;for(var j=b.length;j;){for(u=b,b=[];++s<j;){u&&u[s].run()}s=-1,j=b.length}u=null,e=!1,i(g)}}function l(g,j){this.fun=g,this.array=j}function r(){}var n,i,t=a.exports={};!function(){try{n=setTimeout}catch(g){n=function(){throw new Error("setTimeout is not defined")}}try{i=clearTimeout}catch(g){i=function(){throw new Error("clearTimeout is not defined")}}}();var u,b=[],e=!1,s=-1;t.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}b.push(new l(j,k)),1!==b.length||e||n(o,0)},l.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=r,t.addListener=r,t.once=r,t.off=r,t.removeListener=r,t.removeAllListeners=r,t.emit=r,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],3:[function(a,b,e){(function(g0,ge){function cn(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function co(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function a9(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function h0(ab){if(ab instanceof ArrayBuffer){return a9(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function fi(ab){var t=Object.getPrototypeOf(ab);if(null===t){return !0}var aa=t.constructor;return"function"==typeof aa&&aa instanceof aa&&m.call(aa)==hi}function iu(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=iu(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(co(ab)){return h0(ab)}if(!fi(ab)){return ab}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=iu(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function hF(t){var aa=!1;return ij(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function gf(t){return ij(function(ac){ac=iu(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){g0.nextTick(function(){ad(ah,ag)})});var af=new i5(function(ag,ah){var ak;try{var al=hF(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gk(ab,t){function aa(ah,ac,af){if(gW.enabled){for(var aj=[ah._db_name,ac],ag=0;ag<af.length-1;ag++){aj.push(af[ag])}gW.apply(null,aj);var ad=af[af.length-1];af[af.length-1]=function(ak,am){var al=[ah._db_name,ac];al=al.concat(ak?["error",ak]:["success",am]),gW.apply(null,al),ad(ak,am)}}}return gf(ij(function(ad){if(this._closed){return i5.reject(new Error("database is closed"))}if(this._destroyed){return i5.reject(new Error("database is destroyed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new i5(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function gC(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function er(t){return t}function ih(t){return[{ok:t}]}function fy(al,ak,aa){function ad(){var av=[];ap.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aa(null,{results:av})}function ac(){++ag===ab&&ad()}function aq(aw,ax,av){ap[aw]={id:ax,docs:av},ac()}function af(){if(!(t>=au.length)){var av=Math.min(t+gp,au.length),aw=au.slice(t,av);ah(aw,t),t+=aw.length}}function ah(av,aw){av.forEach(function(aC,aA){var ay=aw+aA,az=aj[aC],aB=gC(az[0],["atts_since","attachments"]);aB.open_revs=az.map(function(aD){return aD.rev}),aB.open_revs=aB.open_revs.filter(er);var ax=er;0===aB.open_revs.length&&(delete aB.open_revs,ax=ih),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ak&&(aB[aD]=ak[aD])}),al.get(aC,aB,function(aD,aF){var aE;aE=aD?[{error:aD}]:ax(aF),aq(ay,aC,aE),af()})})}var am=ak.docs,aj={};am.forEach(function(av){av.id in aj?aj[av.id].push(av):aj[av.id]=[av]});var ab=Object.keys(aj).length,ag=0,ap=new Array(ab),au=Object.keys(aj),t=0;af()}function iC(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function fd(){return et}function fc(t){iC()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):fd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function fZ(){he.EventEmitter.call(this),this._listeners={},fc(this)}function h2(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function hB(ab,ad){var t=600000;ab=parseInt(ab,10)||0,ad=parseInt(ad,10),ad!==ad||ab>=ad?ad=(ab||1)<<1:ad+=1,ad>t&&(ab=t>>1,ad=t);var ac=Math.random(),aa=ad-ab;return ~~(aa*ac+ab)}function jd(t){var aa=0;return t||(aa=2000),hB(t,aa)}function gl(t,aa){h2("info","The above "+t+" is totally normal. "+aa)}function hH(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function fU(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=hH.prototype,new ab(ac)}function gh(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=gu("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=gx:"doc_validation"===t?(ac=at,aa=af):"bad_request"===t&&ac.message!==af&&(ac=hy),ac||(ac=gu("status",ab.status,af)||gN),ad=fU(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function ii(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return fU(hy,aa)}}function gM(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&ii(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function Y(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function hs(t){var aa;if(t?"string"!=typeof t?aa=fU(g1):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=fU(u)):aa=fU(ew),aa){throw aa}}function fa(t,aa){return"listenerCount" in t?t.listenerCount(aa):he.EventEmitter.listenerCount(t,aa)}function g5(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function go(t){var aa=g5(t);return aa?aa.join("/"):null}function i3(aa){for(var ac=ez.exec(aa),ag={},ab=14;ab--;){var t=q[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[fV]={},ag[q[12]].replace(de,function(ak,aj,ah){aj&&(ag[fV][aj]=ah)}),ag}function jl(ab,t,aa){return new i5(function(ad,ac){ab.get(t,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=aa(ag);return af?(af._id=t,af._rev=ah,void ad(iz(ab,af,aa))):ad({updated:!1,rev:ah})})})}function iz(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return jl(ab,t._id,aa)})}function fp(t){return 0|Math.random()*t}function gz(aa,ac){ac=ac||fX.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=fX[fp(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=fX[3&fp(16)|8];break;default:t+=fX[fp(16)]}}return t}function gO(t){for(var ad,aa,ac,ab,am=t.rev_tree.slice();ab=am.pop();){var ag=ab.ids,al=ag[2],af=ab.pos;if(al.length){for(var ah=0,ak=al.length;ak>ah;ah++){am.push({pos:af+1,ids:al[ah]})}}else{var ap=!!ag[1].deleted,aj=ag[0];ad&&!(ac!==ap?ac:aa!==af?af>aa:aj>ad)||(ad=aj,aa=af,ac=ap)}}return aa+"-"+ad}function eu(ah,af){for(var ak,ac=ah.slice();ak=ac.pop();){for(var aa=ak.pos,aj=ak.ids,ag=aj[2],ad=af(0===ag.length,aa,aj[0],ak.ctx,aj[1]),t=0,ab=ag.length;ab>t;t++){ac.push({pos:aa+1,ids:ag[t],ctx:ad})}}}function gA(t,aa){return t.pos-aa.pos}function jE(aa){var ac=[];eu(aa,function(ad,ah,af,aj,ag){ad&&ac.push({rev:ah+"-"+af,pos:ah,opts:ag})}),ac.sort(gA).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function eo(aa){for(var ac=gO(aa),ag=jE(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function a3(t){var aa=[];return eu(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function hR(t){for(var ad,aa=[],ac=t.slice();ad=ac.pop();){var ab=ad.pos,am=ad.ids,ag=am[0],al=am[1],af=am[2],ah=0===af.length,ak=ad.history?ad.history.slice():[];ak.push({id:ag,opts:al}),ah&&aa.push({pos:ab+1-ak.length,ids:ak});for(var ap=0,aj=af.length;aj>ap;ap++){ac.push({pos:ab+1,ids:af[ap],history:ak})}}return aa.reverse()}function L(t,aa){return t.pos-aa.pos}function w(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function r(aa,ac,t){var ab=w(aa,ac,t);aa.splice(ab,0,ac)}function im(ag,af){for(var t,ad,ab=af,aa=ag.length;aa>ab;ab++){var ac=ag[ab],ah=[ac.id,ac.opts,[]];ad?(ad[2].push(ah),ad=ah):t=ad=ah}return t}function ga(t,aa){return t[0]<aa[0]?-1:1}function gK(ah,af){for(var ak=[{tree1:ah,tree2:af}],ac=!1;ak.length>0;){var aa=ak.pop(),aj=aa.tree1,ag=aa.tree2;(aj[1].status||ag[1].status)&&(aj[1].status="available"===aj[1].status||"available"===ag[1].status?"available":"missing");for(var ad=0;ad<ag[2].length;ad++){if(aj[2][0]){for(var t=!1,ab=0;ab<aj[2].length;ab++){aj[2][ab][0]===ag[2][ad][0]&&(ak.push({tree1:aj[2][ab],tree2:ag[2][ad]}),t=!0)}t||(ac="new_branch",r(aj[2],ag[2][ad],ga))}else{ac="new_leaf",aj[2][0]=ag[2][ad]}}}return{conflicts:ac,tree:ah}}function di(am,ak,ap){var t,av=[],aj=!1,aa=!1;if(!am.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=am.length;aw>ah;ah++){var aq=am[ah];if(aq.pos===ak.pos&&aq.ids[0]===ak.ids[0]){t=gK(aq.ids,ak.ids),av.push({pos:aq.pos,ids:t.tree}),aj=aj||t.conflicts,aa=!0}else{if(ap!==!0){var ab=aq.pos<ak.pos?aq:ak,al=aq.pos<ak.pos?ak:aq,ad=al.pos-ab.pos,ag=[],ax=[];for(ax.push({ids:ab.ids,diff:ad,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ac=0,af=az.length;af>ac;ac++){ax.push({ids:az[ac],diff:ay.diff-1,parent:ay.ids,parentIdx:ac})}}else{ay.ids[0]===al.ids[0]&&ag.push(ay)}}var au=ag[0];au?(t=gK(au.ids,al.ids),au.parent[2][au.parentIdx]=t.tree,av.push({pos:ab.pos,ids:ab.ids}),aj=aj||t.conflicts,aa=!0):av.push(aq)}else{av.push(aq)}}}return aa||av.push(ak),av.sort(L),{tree:av,conflicts:aj||"internal_node"}}function g(t,ad){for(var aa,ac=hR(t),ab={},am=0,ag=ac.length;ag>am;am++){for(var al=ac[am],af=al.ids,ah=Math.max(0,af.length-ad),ak={pos:al.pos+ah,ids:im(af,ah)},ap=0;ah>ap;ap++){var aj=al.pos+ap+"-"+af[ap].id;ab[aj]=!0}aa=aa?di(aa,ak,!0).tree:[ak]}return eu(aa,function(au,av,aq){delete ab[av+"-"+aq]}),{tree:aa,revs:Object.keys(ab)}}function iT(ab,ad,t){var ac=di(ab,ad),aa=g(ac.tree,t);return{tree:aa.tree,stemmedRevs:aa.revs,conflicts:ac.conflicts}}function hU(ah,af){for(var ak,ac=ah.slice(),aa=af.split("-"),aj=parseInt(aa[0],10),ag=aa[1];ak=ac.pop();){if(ak.pos===aj&&ak.ids[0]===ag){return !0}for(var ad=ak.ids[2],t=0,ab=ad.length;ab>t;t++){ac.push({pos:ak.pos+1,ids:ad[t]})}}return !1}function ee(t){return t.ids}function jo(ab,ad){ad||(ad=gO(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(ee);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function fq(t){return/^_local/.test(t)}function ip(t){return hg("return "+t+";",{})}function bo(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function h1(ab,t){try{ab.emit("change",t)}catch(aa){h2("error",'Error in .on("change", function):',aa)}}function ex(aa,ac,ag){function ab(){t.cancel()}he.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?iu(ac):{};var ad=ac.complete=hF(function(ah,aj){ah?fa(t,"error")>0&&t.emit("error",ah):t.emit("complete",aj),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(h1(t,ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new i5(function(ah,aj){ac.complete=function(al,ak){al?aj(al):ah(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function fu(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=jE(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return jo(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=eo(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function gI(t,aa){return aa>t?-1:t>aa?1:0}function v(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function gs(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function a4(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=gC(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function a0(ab,ad){var t=gI(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return gI(ac,aa)}function i1(ab){var t={},aa=[];return eu(ab,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(t[ag]=0),void 0!==af&&aa.push({from:af,to:ag}),ag}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function ar(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return i5.all(ac.map(function(af){var ag=G.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new i5(function(ah,aj){ab._allDocs(ag,function(ak,al){return ak?aj(ak):(aa.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function jg(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),g0.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&jg(aa)})})})}function g4(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function jt(){he.EventEmitter.call(this)}function jB(){this.isReady=!1,this.failed=!1,this.queue=[]}function gE(t){t&&ge.debug&&h2("error",t)}function fv(aa,ac){function ag(){ad.emit("destroyed",t)}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function hE(aa,ac,ag){if(!(this instanceof hE)){return new hE(aa,ac,ag)}var ab=this;if("function"!=typeof ac&&"undefined"!=typeof ac||(ag=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ag){ag=gE}else{var t=ag;ag=function(){return h2("warn","Using a callback for new PouchDB()is deprecated."),t.apply(null,arguments)}}aa=aa||ac.name,ac=iu(ac),delete ac.name,this.__opts=ac;var ad=ag;ab.auto_compaction=ac.auto_compaction,ab.prefix=hE.prefix,jt.call(ab),ab.taskqueue=new jB;var af=new i5(function(ah,ak){ag=function(ap,am){return ap?ak(ap):(delete am.then,void ah(am))},ac=iu(ac);var al,aj;return function(){try{if("string"!=typeof aa){throw aj=new Error("Missing/invalid DB name"),aj.code=400,aj}var ap=(ac.prefix||"")+aa;if(al=hE.parseAdapter(ap,ac),ac.originalName=aa,ac.name=al.name,ac.adapter=ac.adapter||al.adapter,ab._adapter=ac.adapter,hx("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aa,!hE.adapters[ac.adapter]){throw aj=new Error("Adapter is missing"),aj.code=404,aj}if(!hE.adapters[ac.adapter].valid()){throw aj=new Error("Invalid Adapter"),aj.code=404,aj}}catch(am){ab.taskqueue.fail(am)}}(),aj?ak(aj):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void hE.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ag(am)):(fv(ab,ac),ab.emit("created",ab),hE.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ag(null,ab))}))});af.then(function(ah){ad(null,ah)},ad),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function hn(t){Object.keys(he.EventEmitter.prototype).forEach(function(ab){"function"==typeof he.EventEmitter.prototype[ab]&&(t[ab]=hM[ab].bind(hM))});var aa=t._destructionListeners=new je.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function gX(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function jA(aa){if(!/^\d+\-./.test(aa)){return fU(iB)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function fh(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function gy(ah,af){var ak,ac,aa,aj={status:"available"};if(ah._deleted&&(aj.deleted=!0),af){if(ah._id||(ah._id=gz()),ac=gz(32,16).toLowerCase(),ah._rev){if(aa=jA(ah._rev),aa.error){return aa}ah._rev_tree=[{pos:aa.prefix,ids:[aa.id,{status:"missing"},[[ac,aj,[]]]]}],ak=aa.prefix+1}else{ah._rev_tree=[{pos:1,ids:[ac,aj,[]]}],ak=1}}else{if(ah._revisions&&(ah._rev_tree=fh(ah._revisions,aj),ak=ah._revisions.start,ac=ah._revisions.ids[0]),!ah._rev_tree){if(aa=jA(ah._rev),aa.error){return aa}ak=aa.prefix,ac=aa.id,ah._rev_tree=[{pos:ak,ids:[ac,aj,[]]}]}}hs(ah._id),ah._rev=ak+"-"+ac;var ag={metadata:{},data:{}};for(var ad in ah){if(Object.prototype.hasOwnProperty.call(ah,ad)){var t="_"===ad[0];if(t&&!dn[ad]){var ab=fU(at,ad);throw ab.message=at.message+": "+ad,ab}t&&!hY[ad]?ag.metadata[ad.slice(1)]=ah[ad]:ag.data[ad]=ah[ad]}}return ag}function ci(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function jD(t){return gv(ci(t))}function iO(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function H(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function jk(t,aa){return iO([H(t)],{type:aa})}function hA(t,aa){return jk(fo(t),aa)}function a8(aa,ac){if("undefined"==typeof FileReader){return ac(ci((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(ci(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function i2(t,aa){a8(t,function(ab){aa(gv(ab))})}function hf(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function O(t){return gv(t)}function dt(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function g9(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function gd(ah,af){function ak(){var aq=ad*aj,al=aq+aj;if(ad++,ag>ad){ab(t,ah,aq,al),gT(ak)}else{ab(t,ah,aq,al);var ap=t.end(!0),am=O(ap);af(am),t.destroy()}}var ac="string"==typeof ah,aa=ac?ah.length:ah.byteLength,aj=Math.min(iU,aa),ag=Math.ceil(aa/aj),ad=0,t=ac?new hl:new hl.ArrayBuffer,ab=ac?g9:dt;ak()}function fW(t){return hl.hash(t)}function z(ag,af,t){function ad(al){try{return fo(al)}catch(aj){var ak=fU(h7,"Attachment is not a valid base64 string");return{error:ak}}}function ab(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ad(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===af?aj.data=jk(al,aj.content_type):"base64"===af?aj.data=gv(al):aj.data=al,gd(al,function(am){aj.digest="md5-"+am,ak()})}else{hf(aj.data,function(am){"binary"===af?aj.data=ci(am):"base64"===af&&(aj.data=jD(am)),gd(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function aa(){ah++,ag.length===ah&&(ac?t(ac):t())}if(!ag.length){return t()}var ac,ah=0;ag.forEach(function(ak){function am(aq){ac=aq,al++,al===aj.length&&aa()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return aa()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ab(ak.data._attachments[ap],am)}})}function hq(am,ab,ag,aj,ac,ay,ad,aA){if(hU(ab.rev_tree,ag.metadata.rev)){return aj[ac]=ag,ay()}var t=ab.winningRev||gO(ab),au="deleted" in ab?ab.deleted:jo(ab,t),al="deleted" in ag.metadata?ag.metadata.deleted:jo(ag.metadata),aq=/^1-/.test(ag.metadata.rev);if(au&&!al&&aA&&aq){var ak=ag.data;ak._rev=t,ak._id=ag.metadata.id,ag=gy(ak,aA)}var az=iT(ab.rev_tree,ag.metadata.rev_tree[0],am),av=aA&&(au&&al||!au&&"new_leaf"!==az.conflicts||au&&!al&&"new_branch"===az.conflicts);if(av){var aw=fU(hO);return aj[ac]=aw,ay()}var ax=ag.metadata.rev;ag.metadata.rev_tree=az.tree,ag.stemmedRevs=az.stemmedRevs||[],ab.rev_map&&(ag.metadata.rev_map=ab.rev_map);var ah,aa=gO(ag.metadata),ap=jo(ag.metadata,aa),af=au===ap?0:ap>au?-1:1;ah=ax===aa?ap:jo(ag.metadata,ax),ad(ag,aa,ap,ah,!0,af,ac,ay)}function I(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function hL(ac,am,ak,aa,aq,ah,ap,aj,t){function ab(aw,aA,aC){var av=gO(aw.metadata),ay=jo(aw.metadata,av);if("was_delete" in aj&&ay){return ah[aA]=fU(gx,"deleted"),aC()}var ax=al&&I(aw);if(ax){var az=fU(hO);return ah[aA]=az,aC()}var aB=ay?0:1;ap(aw,av,ay,ay,!1,aB,aA,aC)}function af(){++au===ag&&t&&t()}ac=ac||1000;var al=aj.new_edits,ad=new je.Map,au=0,ag=am.length;am.forEach(function(ay,aw){if(ay._id&&fq(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void ak[av](ay,{ctx:aq},function(aA,az){ah[aw]=aA||az,af()})}var ax=ay.metadata.id;ad.has(ax)?(ag--,ad.get(ax).push([ay,aw])):ad.set(ax,[[ay,aw]])}),ad.forEach(function(aw,ay){function az(){++ax<aw.length?av():af()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(aa.has(ay)){hq(ac,aa.get(ay),aA,ah,aB,az,ap,al)}else{var aD=iT([],aA.metadata.rev_tree[0],ac);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ab(aA,aB,az)}}var ax=0;av()})}function ig(t){try{return JSON.parse(t)}catch(aa){return io.parse(t)}}function ib(t){return t.length<50000?JSON.parse(t):ig(t)}function a7(t){try{return JSON.stringify(t)}catch(aa){return io.stringify(t)}}function S(ab,ad,t,ac){try{ab.apply(ad,t)}catch(aa){ac.emit("error",aa)}}function iS(t){if(!i9.running&&i9.queue.length){i9.running=!0;var aa=i9.queue.shift();aa.action(function(ac,ab){S(aa.callback,this,[ac,ab],t),i9.running=!1,g0.nextTick(function(){iS(t)})})}}function jn(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(fU(gB,aa,ab.type))}}function fx(ab,t,aa){return{data:a7(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function ja(t){if(!t){return null}var aa=ib(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function Z(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function iy(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:hA(aa,ac):iO([""],{type:ac})):aa?"string"!=typeof aa?a8(aa,function(ad){ab(gv(ad))}):ab(aa):ab("")}function hN(ag,af,t,ad){function ab(){++ah===ac.length&&ad&&ad()}function aa(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=t.objectStore(o).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ab()}}var ac=Object.keys(ag._attachments||{});if(!ac.length){return ad&&ad()}var ah=0;ac.forEach(function(aj){af.attachments&&af.include_docs?aa(ag,aj):(ag._attachments[aj].stub=!0,ab())})}function iJ(t,aa){return i5.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return i5.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new i5(function(aj){iy(ad,ag,aa,function(ak){ac.doc._attachments[ah]=G.extend(gC(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function ix(ah,af,ak){function ac(){ab--,ab||aa()}function aa(){aj.length&&aj.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ad["delete"](am)}})}var aj=[],ag=ak.objectStore(h8),ad=ak.objectStore(o),t=ak.objectStore(hV),ab=ah.length;ah.forEach(function(al){var am=ag.index("_doc_id_rev"),ap=af+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return ac()}ag["delete"](aq);var au=t.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];aj.push(ay),t["delete"](ax.primaryKey),ax["continue"]()}else{ac()}}}})}function y(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function iI(au,ah,aG,aI,aD,az,ay){function am(){var aN=[g2,h8,o,gq,hV],aO=y(aD,aN,"readwrite");return aO.error?ay(aO.error):(ag=aO.txn,ag.onabort=jn(ay),ag.ontimeout=jn(ay),ag.oncomplete=aj,aB=ag.objectStore(g2),aC=ag.objectStore(h8),aE=ag.objectStore(o),al=ag.objectStore(hV),void aM(function(aP){return aP?(t=!0,ay(aP)):void aL()}))}function ap(){hL(au.revs_limit,aq,aI,aa,ag,ac,aJ,aG)}function aL(){function aN(){++aS===aq.length&&ap()}function aP(aU){var aV=ja(aU.target.result);aV&&aa.set(aV.id,aV),aN()}if(aq.length){for(var aS=0,aO=0,aT=aq.length;aT>aO;aO++){var aQ=aq[aO];if(aQ._id&&fq(aQ._id)){aN()}else{var aR=aB.get(aQ.metadata.id);aR.onsuccess=aP}}}}function aj(){t||(az.notify(aI._meta.name),aI._meta.docCount+=aA,ay(null,ac))}function aH(aO,aP){var aN=aE.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=fU(i4,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aq.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aH(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aJ(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ax(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bb){var aZ=aP.stemmedRevs||[];aV&&aI.auto_compaction&&(aZ=aZ.concat(a3(aP.metadata))),aZ&&aZ.length&&ix(aZ,aP.metadata.id,ag),aT.seq=bb.target.result,delete aT.rev;var ba=fx(aT,aW,aU),bc=aB.put(ba);bc.onsuccess=aN}function aX(bb){bb.preventDefault(),bb.stopPropagation();var aZ=aC.index("_doc_id_rev"),ba=aZ.getKey(aR._doc_id_rev);ba.onsuccess=function(bc){var bd=aC.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ac[aS]={ok:!0,id:aT.id,rev:aW},aa.set(aP.metadata.id,aP.metadata),aF(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=aC.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ax(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aZ){var aY=aP.data._attachments[aZ];if(aY.stub){aO++,aN()}else{var bb=aY.data;delete aY.data,aY.revpos=parseInt(aW,10);var ba=aY.digest;av(ba,bb,aV)}})}function aF(aN,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aX){var aV=aN.data._attachments[aX].digest,aW=al.put({seq:aQ,digestSeq:aV+"::"+aQ});aW.onsuccess=aO,aW.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aN.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function av(aO,aQ,aN){var aP=aE.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=aE.put(aS);aT.onsuccess=aN}}for(var ag,aB,aC,aE,al,aw,aq=ah.docs,aA=0,ak=0,af=aq.length;af>ak;ak++){var ab=aq[ak];ab._id&&fq(ab._id)||(ab=aq[ak]=gy(ab,aG.new_edits),ab.error&&!aw&&(aw=ab))}if(aw){return ay(aw)}var ac=new Array(aq.length),aa=new je.Map,t=!1,aK=aI._meta.blobSupport?"blob":"base64";z(aq,aK,function(aN){return aN?ay(aN):void am()})}function gj(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function hQ(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(fU(gB,t.name,t.message))}function hv(ab,ad,t,ac){function aa(aB,ah){function aG(aK,aL,aN){var aM=aK.id+"::"+aN;aJ.get(aM).onsuccess=function(aO){aL.doc=Z(aO.target.result),aB.conflicts&&(aL.doc._conflicts=eo(aK)),hN(aL.doc,aB,al)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===aB.deleted){aI.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):aB.include_docs&&aG(aL,aN,aK)}else{if(!aO&&aw--<=0&&(aI.push(aN),aB.include_docs&&aG(aL,aN,aK),0===--aH)){return}}aM["continue"]()}function au(aN){ag=ad._meta.docCount;var aL=aN.target.result;if(aL){var aK=ja(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function ak(){ah(null,{total_rows:ag,offset:aB.skip,rows:aI})}function aj(){aB.attachments?iJ(aI,aB.binary).then(ak):ak()}var aC="startkey" in aB?aB.startkey:!1,aE="endkey" in aB?aB.endkey:!1,ay="key" in aB?aB.key:!1,aw=aB.skip||0,aH="number"==typeof aB.limit?aB.limit:-1,aq=aB.inclusive_end!==!1,aD="descending" in aB&&aB.descending?"prev":null,ax=gj(aC,aE,aq,ay,aD);if(ax&&ax.error){return hQ(ad,aB,ax.error,ah)}var aA=[g2,h8];aB.attachments&&aA.push(o);var am=y(t,aA,"readonly");if(am.error){return ah(am.error)}var al=am.txn,aF=al.objectStore(g2),az=al.objectStore(h8),ap=aD?aF.openCursor(ax,aD):aF.openCursor(ax),aJ=az.index("_doc_id_rev"),aI=[],ag=0;al.oncomplete=aj,ap.onsuccess=au}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ad._meta.docCount,offset:ag.skip,rows:[]}):void aa(ag,ah)}af(ab,ac)}function ji(t){return new i5(function(ab){var aa=iO([""]);t.objectStore(jh).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function bn(ab,t){var aa=this;i9.queue.push({action:function(ac){jy(aa,ab,ac)},callback:t}),iS(aa.constructor)}function jy(ah,ag,ab){function aq(au){var av=au.createObjectStore(g2,{keyPath:"id"});au.createObjectStore(h8,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(o,{keyPath:"digest"}),au.createObjectStore(V,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jh),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(gq,{keyPath:"_id"});var aw=au.createObjectStore(hV,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ap(au,av){var aw=au.objectStore(g2);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=jo(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ac(au){au.createObjectStore(gq,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aj(av,ay){var az=av.objectStore(gq),ax=av.objectStore(g2),aw=av.objectStore(h8),au=ax.openCursor();au.onsuccess=function(aA){var aD=aA.target.result;if(aD){var aJ=aD.value,aG=aJ.id,aH=fq(aG),aK=gO(aJ);if(aH){var aB=aG+"::"+aK,aE=aG+"::",aL=aG+"::~",aC=aw.index("_doc_id_rev"),aF=IDBKeyRange.bound(aE,aL,!1,!1),aI=aC.openCursor(aF);aI.onsuccess=function(aN){if(aI=aN.target.result){var aM=aI.value;aM._doc_id_rev===aB&&az.put(aM),aw["delete"](aI.primaryKey),aI["continue"]()}else{ax["delete"](aD.primaryKey),aD["continue"]()}}}else{aD["continue"]()}}else{ay&&ay()}}}function am(au){var av=au.createObjectStore(hV,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function al(av,ay){var az=av.objectStore(h8),ax=av.objectStore(o),aw=av.objectStore(hV),au=ax.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (az.openCursor().onsuccess=function(aG){var aK=aG.target.result;if(!aK){return ay()}for(var aL=aK.value,aI=aK.primaryKey,aE=Object.keys(aL._attachments||{}),aC={},aD=0;aD<aE.length;aD++){var aF=aL._attachments[aE[aD]];aC[aF.digest]=!0}var aH=Object.keys(aC);for(aD=0;aD<aH.length;aD++){var aJ=aH[aD];aw.put({seq:aI,digestSeq:aJ+"::"+aI})}aK["continue"]()}):ay()}}function af(ay){function ax(az){return az.data?ja(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ay.objectStore(h8),av=ay.objectStore(g2),aw=av.openCursor();aw.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=fx(aD,aD.winningRev,aD.deleted),aF=av.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ax(aA.value);return aD.winningRev=aD.winningRev||gO(aD),aD.seq?az():void aB()}}}var aa=ag.name,ad=null;ah._meta=null,ah.type=function(){return"idb"},ah._id=gf(function(au){au(null,ah._meta.instanceId)}),ah._bulkDocs=function(aw,av,au){iI(ag,aw,av,ah,ad,i0,au)},ah._get=function(au,az,aA){function aw(){aA(aC,{doc:av,metadata:ax,ctx:ay})}var av,ax,aC,ay=az.ctx;if(!ay){var aB=y(ad,[g2,h8,o],"readonly");if(aB.error){return aA(aB.error)}ay=aB.txn}ay.objectStore(g2).get(au).onsuccess=function(aG){if(ax=ja(aG.target.result),!ax){return aC=fU(gx,"missing"),aw()}if(jo(ax)&&!az.rev){return aC=fU(gx,"deleted"),aw()}var aE=ay.objectStore(h8),aD=az.rev||ax.winningRev,aF=ax.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return av=aH.target.result,av&&(av=Z(av)),av?void aw():(aC=fU(gx,"missing"),aw())}}},ah._getAttachment=function(au,az,aA,aw,av){var ax;if(aw.ctx){ax=aw.ctx}else{var aC=y(ad,[g2,h8,o],"readonly");if(aC.error){return av(aC.error)}ax=aC.txn}var ay=aA.digest,aB=aA.content_type;ax.objectStore(o).get(ay).onsuccess=function(aE){var aD=aE.target.result.body;iy(aD,aB,aw.binary,function(aF){av(null,aF)})}},ah._info=function(av){if(null===ad||!h6.has(aa)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var az,ay,au=y(ad,[h8],"readonly");if(au.error){return av(au.error)}var aw=au.txn,ax=aw.objectStore(h8).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,ay=ah._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:az,idb_attachment_format:ah._meta.blobSupport?"binary":"base64"})}},ah._allDocs=function(av,au){hv(av,ah,ad,au)},ah._changes=function(ax){function az(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aA=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aD.get(aU);aT.onsuccess=function(aV){aO(Z(aV.target.result))}}function aO(aU){var aT=ax.processChange(aU,aN,ax);aT.seq=aN.seq;var aV=aE(aT);return"object"==typeof aV?ax.complete(aV):(aV&&(av++,aG&&aF.push(aT),ax.attachments&&ax.include_docs?hN(aU,ax,aH,function(){iJ([aT],ax.binary).then(function(){ax.onChange(aT)})}):ax.onChange(aT)),void (av!==aB&&aS["continue"]()))}var aQ=Z(aS.value),aR=aS.key;if(aJ&&!aJ.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (au.get(aQ._id).onsuccess=function(aT){aN=ja(aT.target.result),ay.set(aQ._id,aN),aM()})}function aC(aN){var aM=aN.target.result;aM&&az(aM)}function aw(){var aM=[g2,h8];ax.attachments&&aM.push(o);var aN=y(ad,aM,"readonly");if(aN.error){return ax.complete(aN.error)}aH=aN.txn,aH.onabort=jn(ax.complete),aH.oncomplete=aI,aK=aH.objectStore(h8),au=aH.objectStore(g2),aD=aK.index("_doc_id_rev");var aO;aO=ax.descending?aK.openCursor(null,"prev"):aK.openCursor(IDBKeyRange.lowerBound(ax.since,!0)),aO.onsuccess=aC}function aI(){function aM(){ax.complete(null,{results:aF,last_seq:aA})}!ax.continuous&&ax.attachments?iJ(aF).then(aM):aM()}if(ax=iu(ax),ax.continuous){var aL=aa+":"+gz();return i0.addListener(aa,aL,ah,ax),i0.notify(aa),{cancel:function(){i0.removeListener(aa,aL)}}}var aJ=ax.doc_ids&&new je.Set(ax.doc_ids);ax.since=ax.since||0;var aA=ax.since,aB="limit" in ax?ax.limit:-1;0===aB&&(aB=1);var aG;aG="return_docs" in ax?ax.return_docs:"returnDocs" in ax?ax.returnDocs:!0;var aH,aK,au,aD,aF=[],av=0,aE=gM(ax),ay=new je.Map;aw()},ah._close=function(au){return null===ad?au(fU(iV)):(ad.close(),h6["delete"](aa),ad=null,void au())},ah._getRevisionTree=function(ay,ax){var au=y(ad,[g2],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(g2).get(ay);aw.onsuccess=function(aA){var az=ja(aA.target.result);az?ax(null,az.rev_tree):ax(fU(gx))}},ah._doCompaction=function(aA,av,ay){var ax=[g2,h8,o,hV],az=y(ad,ax,"readwrite");if(az.error){return ay(az.error)}var au=az.txn,aw=au.objectStore(g2);aw.get(aA).onsuccess=function(aC){var aE=ja(aC.target.result);eu(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),ix(av,aA,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(g2).put(fx(aE,aD,aB))},au.onabort=jn(ay),au.oncomplete=function(){ay()}},ah._getLocal=function(ay,ax){var au=y(ad,[gq],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(gq).get(ay);aw.onerror=jn(ax),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(fU(gx))}},ah._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=y(ad,[gq],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=jn(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(gq);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(fU(hO))}}):(az=aC.add(aD),az.onerror=function(aE){aA(fU(hO)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ah._removeLocal=function(au,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.ctx;if(!aw){var av=y(ad,[gq],"readwrite");if(av.error){return aA(av.error)}aw=av.txn,aw.oncomplete=function(){ax&&aA(null,ax)}}var ax,aC=au._id,ay=aw.objectStore(gq),aB=ay.get(aC);aB.onerror=jn(aA),aB.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===au._rev?(ay["delete"](aC),ax={ok:!0,id:aC,rev:"0-0"},az.ctx&&aA(null,ax)):aA(fU(gx))}},ah._destroy=function(ax,av){i0.removeAllListeners(aa);var aw=gH.get(aa);aw&&aw.result&&(aw.result.close(),h6["delete"](aa));var au=indexedDB.deleteDatabase(aa);au.onsuccess=function(){gH["delete"](aa),fd()&&aa in localStorage&&delete localStorage[aa],av(null,{ok:!0})},au.onerror=jn(av)};var ak=h6.get(aa);if(ak){return ad=ak.idb,ah._meta=ak.global,void g0.nextTick(function(){ab(null,ah)})}var t;t=ag.storage?R(aa,ag.storage):indexedDB.open(aa,h3),gH.set(aa,t),t.onupgradeneeded=function(ay){function av(){var aA=aw[au-1];au++,aA&&aA(az,av)}var ax=ay.target.result;if(ay.oldVersion<1){return aq(ax)}var az=ay.currentTarget.transaction;ay.oldVersion<3&&ac(ax),ay.oldVersion<4&&am(ax);var aw=[ap,aj,al,af],au=ay.oldVersion;av()},t.onsuccess=function(ax){ad=ax.target.result,ad.onversionchange=function(){ad.close(),h6["delete"](aa)},ad.onabort=function(aA){h2("error","Database has a global failure",aA.target.error),ad.close(),h6["delete"](aa)};var az=ad.transaction([V,jh,g2],"readwrite"),aw=az.objectStore(V).get(V),ay=null,av=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ay&&null!==av&&null!==au&&(ah._meta={name:aa,instanceId:au,blobSupport:ay,docCount:av},h6.set(aa,{idb:ad,global:ah._meta}),ab(null,ah))},aA=aB.target.result||{id:V};aa+"_id" in aA?(au=aA[aa+"_id"],aD()):(au=gz(),aA[aa+"_id"]=au,az.objectStore(V).put(aA).onsuccess=function(){aD()}),iX||(iX=ji(az)),iX.then(function(aE){ay=aE,aD()});var aC=az.objectStore(g2).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){av=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";h2("error",au),ab(fU(gB,au))}}function R(ab,t){try{return indexedDB.open(ab,{version:h3,storage:t})}catch(aa){return indexedDB.open(ab,h3)}}function jx(t){t.adapter("idb",bn,!0)}function jv(t){return decodeURIComponent(escape(t))}function it(t){return 65>t?t-48:t-55}function hz(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(it(aa.charCodeAt(ac++))<<4|it(aa.charCodeAt(ac++)))}return ab}function jc(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(it(aa.charCodeAt(ac+2))<<12|it(aa.charCodeAt(ac+3))<<8|it(aa.charCodeAt(ac))<<4|it(aa.charCodeAt(ac+1))),ac+=4}return ab}function gn(t,aa){return"UTF-8"===aa?jv(hz(t,0,t.length)):jc(t,0,t.length)}function js(t){return"'"+t+"'"}function jq(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hk(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function iw(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hW(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function gQ(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function hJ(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function iH(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+ff+" WHERE seq IN "+gQ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+ff+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+ff+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new je.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+ff+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+hb+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(ah){var aj="SELECT seq FROM "+ft+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ac,ah],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+ft+" WHERE seq=?",[ak],ab)})})}}function gZ(t){return function(ad){h2("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(fU(g3,ab,ac))}}function id(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function hX(al,aA,au,ax,av,ag,ay){function az(){return am?ay(am):(ag.notify(ax._name),ax._docCount=-1,void ay(null,ac))}function t(aD,aE){var aC="SELECT count(*) as cnt FROM "+hb+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=fU(i4,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ak(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){t(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aj(aG,aN,aD,aI,aK,aQ,aL,aO){function aE(){function aX(bc,ba){function bb(){return ++bg===bd.length&&ba(),!1}function aZ(bj){var bi="INSERT INTO "+ff+" (digest, seq) VALUES (?,?)",bh=[aY._attachments[bj].digest,bc];ap.executeSql(bi,bh,bb,bb)}var bg=0,bd=Object.keys(aY._attachments||{});if(!bd.length){return ba()}for(var bf=0;bf<bd.length;bf++){aZ(bd[bf])}}var aY=aG.data,aV=aI?1:0,aS=aY._id,aW=aY._rev,aU=iw(aY),aT="INSERT INTO "+ft+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aR=[aS,aW,aU,aV];ap.executeSql(aT,aR,function(ba,bb){var aZ=bb.insertId;aX(aZ,function(){aF(ba,aZ)})},function(){var aZ=hJ("seq",ft,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aS,aW],function(bb,bf){var bd=bf.rows.item(0).seq,bc="UPDATE "+ft+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aU,aV,aS,aW];bb.executeSql(bc,ba,function(bg){aX(bd,function(){aF(bg,bd)})})}),!1})}function aH(aR){aJ||(aR?(aJ=aR,aO(aJ)):aP===aC.length&&aE())}function aM(aR){aP++,aH(aR)}function aF(aV,aW){var aT=aG.metadata.id,aU=aG.stemmedRevs||[];aK&&ax.auto_compaction&&(aU=a3(aG.metadata).concat(aU)),aU.length&&iH(aU,aT,aV),aG.metadata.seq=aW,delete aG.metadata.rev;var aS=aK?"UPDATE "+jj+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+ft+" WHERE doc_id="+jj+".id AND rev=?) WHERE id=?":"INSERT INTO "+jj+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aR=a7(aG.metadata),aX=aK?[aR,aW,aN,aT]:[aT,aW,aW,aR];aV.executeSql(aS,aX,function(){ac[aL]={ok:!0,id:aG.metadata.id,rev:aN},ah.set(aT,aG.metadata),aO()})}var aJ=null,aP=0;aG.data._id=aG.metadata.id,aG.data._rev=aG.metadata.rev;var aC=Object.keys(aG.data._attachments||{});aI&&(aG.data._deleted=!0),aC.forEach(function(aS){var aU=aG.data._attachments[aS];if(aU.stub){aP++,aH()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aN,10);var aR=aU.digest;ab(aR,aT,aM)}}),aC.length||aE()}function ad(){hL(al.revs_limit,aq,ax,ah,ap,ac,aj,au)}function aB(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&fq(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+jj+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=ib(aH.rows.item(0).json);ah.set(aF,aI)}aE()})})}function ab(aD,aF,aC){var aE="SELECT digest FROM "+hb+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+hb+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jq(aF)],function(){aC()},function(){return aC(),!1}))})}var af=au.new_edits,aa=aA.docs,aq=aa.map(function(aC){if(aC._id&&fq(aC._id)){return aC}var aD=gy(aC,af);return aD}),aw=aq.filter(function(aC){return aC.error});if(aw.length){return ay(aw[0])}var ap,am,ac=new Array(aq.length),ah=new je.Map;z(aq,"binary",function(aC){return aC?ay(aC):void av.transaction(function(aD){ap=aD,ak(function(aE){aE?am=aE:aB(ad)})},gZ(ay),az)})}function iL(t){return t.websql(t.name,t.version,t.description,t.size)}function gr(t){try{return{db:iL(t)}}catch(aa){return{error:aa}}}function ce(t){var aa=hD.get(t.name);return aa||(aa=gr(t),hD.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function hT(aj,ag,ac,af,ab){function aa(){++t===ad.length&&ab&&ab()}function ah(am,ak){var al=am._attachments[ak],ap={binary:ag.binary,ctx:af};ac._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=G.extend(gC(al,["digest","content_type"]),{data:aq}),aa()})}var ad=Object.keys(aj._attachments||{});if(!ad.length){return ab&&ab()}var t=0;ad.forEach(function(ak){ag.attachments&&ag.include_docs?ah(aj,ak):(aj._attachments[ak].stub=!0,aa())})}function fS(ak,av){function ag(){fd()&&(window.localStorage["_pouch__websqldb_"+am._name]=!0),av(null,am)}function au(aD,aE){aD.executeSql(gS),aD.executeSql("ALTER TABLE "+ft+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(il),aD.executeSql("ALTER TABLE "+jj+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+jj+" (local, id)");var aF="SELECT "+jj+".winningseq AS seq, "+jj+".json AS metadata FROM "+ft+" JOIN "+jj+" ON "+ft+".seq = "+jj+".winningseq";aD.executeSql(aF,[],function(aJ,aN){for(var aK=[],aH=[],aG=0;aG<aN.rows.length;aG++){var aM=aN.rows.item(aG),aL=aM.seq,aI=JSON.parse(aM.metadata);jo(aI)&&aK.push(aL),fq(aI.id)&&aH.push(aI.id)}aJ.executeSql("UPDATE "+jj+"SET local = 1 WHERE id IN "+gQ(aH.length),aH,function(){aJ.executeSql("UPDATE "+ft+" SET deleted = 1 WHERE seq IN "+gQ(aK.length),aK,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+ie+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+jj+".id AS id, "+ft+".json AS data FROM "+ft+" JOIN "+jj+" ON "+ft+".seq = "+jj+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aJ,aH){function aK(){if(!aI.length){return aF(aJ)}var aM=aI.shift(),aN=JSON.parse(aM.data)._rev;aJ.executeSql("INSERT INTO "+ie+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+jj+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+ft+" WHERE seq=?",[aM.seq],function(){aK()})})})}for(var aI=[],aL=0;aL<aH.rows.length;aL++){aI.push(aH.rows.item(aL))}aK()})})}function az(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aN=aH.shift(),aJ=gn(aN.hex,ah),aM=aJ.lastIndexOf("::"),aO=aJ.substring(0,aM),aK=aJ.substring(aM+2),aL="UPDATE "+ft+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aO,aK,aJ],function(){aI()})}aI()}var aF="ALTER TABLE "+ft+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+ft+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(hm,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+ft;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function af(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+hb;aI.executeSql(aH,[],function(aO,aM){function aJ(){var aP=hJ(f+", "+jj+".id AS id",[jj,ft],jf,null,jj+".id ");aP+=" LIMIT "+aL+" OFFSET "+aK,aK+=aL,aO.executeSql(aP,[],function(ba,aU){function aZ(bc,bd){var bf=aS[bc]=aS[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aU.rows.length){return aG(ba)}for(var aS={},aX=0;aX<aU.rows.length;aX++){for(var aV=aU.rows.item(aX),aW=hW(aV.data,aV.id,aV.rev),aQ=Object.keys(aW._attachments||{}),aY=0;aY<aQ.length;aY++){var aT=aW._attachments[aQ[aY]];aZ(aT.digest,aV.seq)}}var bb=[];if(Object.keys(aS).forEach(function(bc){var bd=aS[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aJ()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+ff+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aJ()})})})}var aN=aM.rows.item(0).cnt;if(!aN){return aG(aO)}var aK=0,aL=10;aJ()})}var aF="CREATE TABLE IF NOT EXISTS "+ff+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(J,[],function(aI){aI.executeSql(fl,[],aD)})})}function ac(aE,aF){var aD="ALTER TABLE "+hb+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ap(aE,aF){var aD="ALTER TABLE "+jj+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+jj+" SET max_seq=(SELECT MAX(seq) FROM "+ft+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+jj+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aa(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ah=2===aG.length?"UTF-8":"UTF-16",aE()})}function aj(){for(;t.length>0;){var aD=t.pop();aD(null,aw)}}function ab(aG,aK){if(0===aK){var aN="CREATE TABLE IF NOT EXISTS "+a6+" (dbid, db_version INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+hb+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aH="CREATE TABLE IF NOT EXISTS "+ff+" (digest, seq INTEGER)",aJ="CREATE TABLE IF NOT EXISTS "+jj+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aI="CREATE TABLE IF NOT EXISTS "+ft+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aO="CREATE TABLE IF NOT EXISTS "+ie+" (id UNIQUE, rev, json)";aG.executeSql(aE),aG.executeSql(aO),aG.executeSql(aH,[],function(){aG.executeSql(fl),aG.executeSql(J)}),aG.executeSql(aJ,[],function(){aG.executeSql(gS),aG.executeSql(aI,[],function(){aG.executeSql(il),aG.executeSql(hm),aG.executeSql(aN,[],function(){var aP="INSERT INTO "+a6+" (db_version, dbid) VALUES (?,?)";aw=gz();var aQ=[h9,aw];aG.executeSql(aP,aQ,function(){aj()})})})})}else{var aM=function(){var aQ=h9>aK;aQ&&aG.executeSql("UPDATE "+a6+" SET db_version = "+h9);var aP="SELECT dbid FROM "+a6;aG.executeSql(aP,[],function(aR,aS){aw=aS.rows.item(0).dbid,aj()})},aD=[au,aq,az,af,ac,ap,aM],aF=aK,aL=function(aP){aD[aF-1](aP,aL),aF++};aL(aG)}}function aB(){aA.transaction(function(aD){aa(aD,function(){ad(aD)})},gZ(av),ag)}function ad(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+a6;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+a6,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;ab(aJ,aI)}):aF.executeSql("ALTER TABLE "+a6+" ADD COLUMN db_version INTEGER",[],function(){ab(aF,1)}):ab(aF,0)})}function ay(aE,aF){if(-1!==am._docCount){return aF(am._docCount)}var aD=hJ("COUNT("+jj+".id) AS 'num'",[jj,ft],jf,ft+".deleted=0");aE.executeSql(aD,[],function(aG,aH){am._docCount=aH.rows.item(0).num,aF(am._docCount)})}var ah,am=this,aw=null,aC=id(ak),t=[];am._docCount=-1,am._name=ak.name;var ax=G.extend({},ak,{version:a2,description:ak.name,size:aC}),al=ce(ax);if(al.error){return gZ(av)(al.error)}var aA=al.db;"function"!=typeof aA.readTransaction&&(aA.readTransaction=aA.transaction),aB(),am.type=function(){return"websql"},am._id=gf(function(aD){aD(null,aw)}),am._info=function(aD){aA.readTransaction(function(aE){ay(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+ft;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:aA._sqlitePlugin,websql_encoding:ah})})})},gZ(aD))},am._bulkDocs=function(aF,aD,aE){hX(ak,aF,aD,am,aA,T,aE)},am._get=function(aD,aM,aF){function aI(){aF(aK,{doc:aH,metadata:aE,ctx:aG})}var aH,aE,aK,aG=aM.ctx;if(!aG){return aA.readTransaction(function(aN){am._get(aD,G.extend({ctx:aN},aM),aF)})}var aJ,aL;aM.rev?(aJ=hJ(f,[jj,ft],jj+".id="+ft+".doc_id",[ft+".doc_id=?",ft+".rev=?"]),aL=[aD,aM.rev]):(aJ=hJ(f,[jj,ft],jf,jj+".id=?"),aL=[aD]),aG.executeSql(aJ,aL,function(aP,aO){if(!aO.rows.length){return aK=fU(gx,"missing"),aI()}var aN=aO.rows.item(0);return aE=ib(aN.metadata),aN.deleted&&!aM.rev?(aK=fU(gx,"deleted"),aI()):(aH=hW(aN.data,aE.id,aN.rev),void aI())})},am._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(jj+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(jj+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(jj+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(jj+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(ft+".deleted = 0"),aA.readTransaction(function(aR){ay(aR,function(aS){if(aF=aS,0!==aH){var aT=hJ(f,[jj,ft],jf,aL,jj+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aV,bb){for(var bc=0,aY=bb.rows.length;aY>bc;bc++){var aW=bb.rows.item(bc),aU=ib(aW.metadata),aZ=aU.id,aX=hW(aW.data,aZ,aW.rev),ba=aX._rev,bd={id:aZ,key:aZ,value:{rev:ba}};if(aQ.include_docs&&(bd.doc=aX,bd.doc._rev=ba,aQ.conflicts&&(bd.doc._conflicts=eo(aU)),hT(bd.doc,aQ,am,aV)),aW.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},gZ(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},am._changes=function(aK){function aJ(){var aN=jj+".json AS metadata, "+jj+".max_seq AS maxSeq, "+ft+".json AS winningDoc, "+ft+".rev AS winningRev ",aM=jj+" JOIN "+ft,aO=jj+".id="+ft+".doc_id AND "+jj+".winningseq="+ft+".seq",aP=["maxSeq > ?"],aR=[aK.since];aK.doc_ids&&(aP.push(jj+".id IN "+gQ(aK.doc_ids.length)),aR=aR.concat(aK.doc_ids));var aL="maxSeq "+(aF?"DESC":"ASC"),aS=hJ(aN,aM,aO,aP,aL),aT=gM(aK);aK.view||aK.filter||(aS+=" LIMIT "+aI);var aQ=aK.since||0;aA.readTransaction(function(aU){aU.executeSql(aS,aR,function(bd,bc){function aV(bg){return function(){aK.onChange(bg)}}for(var aY=0,ba=bc.rows.length;ba>aY;aY++){var bb=bc.rows.item(aY),aZ=ib(bb.metadata);aQ=bb.maxSeq;var bf=hW(bb.winningDoc,aZ.id,bb.winningRev),aW=aK.processChange(bf,aZ,aK);aW.seq=bb.maxSeq;var aX=aT(aW);if("object"==typeof aX){return aK.complete(aX)}if(aX&&(aG++,aD&&aE.push(aW),aK.attachments&&aK.include_docs?hT(bf,aK,am,bd,aV(aW)):aV(aW)()),aG===aI){break}}})},gZ(aK.complete),function(){aK.continuous||aK.complete(null,{results:aE,last_seq:aQ})})}if(aK=iu(aK),aK.continuous){var aH=am._name+":"+gz();return T.addListener(am._name,aH,am,aK),T.notify(am._name),{cancel:function(){T.removeListener(am._name,aH)}}}var aF=aK.descending;aK.since=aK.since&&!aF?aK.since:0;var aI="limit" in aK?aK.limit:-1;0===aI&&(aI=1);var aD;aD="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aE=[],aG=0;aJ()},am._close=function(aD){aD()},am._getAttachment=function(aD,aM,aF,aI,aH){var aE,aK=aI.ctx,aG=aF.digest,aJ=aF.content_type,aL="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+hb+" WHERE digest=?";aK.executeSql(aL,[aG],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hk(aO.body):gn(aO.body,ah);aE=aI.binary?jk(aN,aJ):gv(aN),aH(null,aE)})},am._getRevisionTree=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+jj+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=ib(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(fU(gx))}})})},am._doCompaction=function(aE,aF,aD){return aF.length?void aA.transaction(function(aH){var aG="SELECT json AS metadata FROM "+jj+" WHERE id = ?";aH.executeSql(aG,[aE],function(aI,aK){var aJ=ib(aK.rows.item(0).metadata);eu(aJ.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aL="UPDATE "+jj+" SET json = ? WHERE id = ?";aI.executeSql(aL,[a7(aJ),aE])}),iH(aF,aE,aH)},gZ(aD),function(){aD()}):aD()},am._getLocal=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json, rev FROM "+ie+" WHERE id=?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=aJ.rows.item(0),aK=hW(aI.json,aD,aI.rev);aE(null,aK)}else{aE(fU(gx))}})})},am._putLocal=function(aH,aD,aJ){function aL(aO){var aM,aN;aI?(aM="UPDATE "+ie+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aK,aE,aF,aI]):(aM="INSERT INTO "+ie+" (id, rev, json) VALUES (?,?,?)",aN=[aF,aK,aE]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aG={ok:!0,id:aF,rev:aK},aD.ctx&&aJ(null,aG)):aJ(fU(hO))},function(){return aJ(fU(hO)),!1})}"function"==typeof aD&&(aJ=aD,aD={}),delete aH._revisions;var aK,aI=aH._rev,aF=aH._id;aK=aI?aH._rev="0-"+(parseInt(aI.split("-")[1],10)+1):aH._rev="0-1";var aG,aE=iw(aH);aD.ctx?aL(aD.ctx):aA.transaction(aL,gZ(aJ),function(){aG&&aJ(null,aG)})},am._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+ie+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(fU(gx))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):aA.transaction(aF,gZ(aH),function(){aD&&aH(null,aD)})},am._destroy=function(aD,aE){T.removeAllListeners(am._name),aA.transaction(function(aF){var aG=[jj,ft,hb,a6,ie,ff];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},gZ(aE),function(){fd()&&(delete window.localStorage["_pouch__websqldb_"+am._name],delete window.localStorage[am._name]),aE(null,{ok:!0})})}}function j(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function hd(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var ab=fd(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(ab&&localStorage[t]){return"1"===localStorage[t]}var aa=j();return ab&&(localStorage[t]=aa?"1":"0"),aa}function fg(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:hd()}function iP(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=G.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function ev(aa,ac){var t=iP(aa),ab=G.extend({websql:t},aa);fS.call(this,ab,ac)}function fY(t){t.adapter("websql",ev,!0)}function iD(){for(var aa={},ac=new i5(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,i5.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function gF(aa,ac){var ag,ab,t,ad=new Headers,af={method:aa.method,credentials:"include",headers:ad};return aa.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?hf(aa.body,function(ah){af.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?af.body=JSON.stringify(aa.body):"body" in aa?af.body=aa.body:af.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ad.set(ah,aa.headers[ah])}),ag=iD(aa.url,af),aa.timeout>0&&(ab=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ag.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?ac(null,t,ah):ac(ah,t)})["catch"](function(ah){ac(ah,t)}),{abort:ag.reject}}function hr(aj,ag){var ac,af,ab=!1,aa=function(){ac.abort()},ah=function(){ab=!0,ac.abort()};ac=aj.xhr?new aj.xhr:new XMLHttpRequest;try{ac.open(aj.method,aj.url)}catch(ad){ag(ad,{statusCode:413})}ac.withCredentials="withCredentials" in aj?aj.withCredentials:!0,"GET"===aj.method?delete aj.headers["Content-Type"]:aj.json&&(aj.headers.Accept="application/json",aj.headers["Content-Type"]=aj.headers["Content-Type"]||"application/json",aj.body&&aj.processData&&"string"!=typeof aj.body&&(aj.body=JSON.stringify(aj.body))),aj.binary&&(ac.responseType="arraybuffer"),"body" in aj||(aj.body=null);for(var t in aj.headers){aj.headers.hasOwnProperty(t)&&ac.setRequestHeader(t,aj.headers[t])}return aj.timeout>0&&(af=setTimeout(ah,aj.timeout),ac.onprogress=function(){clearTimeout(af),4!==ac.readyState&&(af=setTimeout(ah,aj.timeout))},"undefined"!=typeof ac.upload&&(ac.upload.onprogress=ac.onprogress)),ac.onreadystatechange=function(){if(4===ac.readyState){var ak={statusCode:ac.status};if(ac.status>=200&&ac.status<300){var am;am=aj.binary?iO([ac.response||""],{type:ac.getResponseHeader("Content-Type")}):ac.responseText,ag(null,ak,am)}else{var ap={};if(ab){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ac.response)}catch(al){}}ag(ap,ak)}}},aj.body&&aj.body instanceof Blob?hf(aj.body,function(ak){ac.send(ak)}):ac.send(aj.body),{abort:aa}}function jw(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function hZ(t,aa){return U||t.xhr?hr(t,aa):gF(t,aa)}function l(){return""}function E(ab,ad){function t(ag,ah,af){if(!ab.binary&&ab.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?gh(ak):ak})),ab.binary&&jb(ag,ah),af(null,ag,ah)}function ac(ah,ak){var af,aj;if(ah.code&&ah.status){var ag=new Error(ah.message||ah.code);return ag.status=ah.status,ak(ag)}if(ah.message&&"ETIMEDOUT"===ah.message){return ak(ah)}try{af=JSON.parse(ah.responseText),aj=gh(af)}catch(al){aj=gh(ah)}ak(aj)}ab=iu(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=G.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),hZ(ab,function(ak,af,ah){if(ak){return ak.status=af?af.statusCode:400,ac(ak,ad)}var am,ag=af.headers&&af.headers["content-type"],aj=ah||l();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof aj&&(/json/.test(ag)||/^[\s]*\{/.test(aj)&&/\}[\s]*$/.test(aj))){try{aj=JSON.parse(aj.toString())}catch(al){}}af.statusCode>=200&&af.statusCode<300?t(aj,af,ad):(am=gh(aj),am.status=af.statusCode,ad(am))})}function ey(ah,af){var ak=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ac=-1!==ak.indexOf("safari")&&-1===ak.indexOf("chrome"),aa=-1!==ak.indexOf("msie"),aj=-1!==ak.indexOf("edge"),ag=ac||(aa||aj)&&"GET"===ah.method,ad="cache" in ah?ah.cache:!0,t=/^blob:/.test(ah.url);if(!t&&(ag||!ad)){var ab=-1!==ah.url.indexOf("?");ah.url+=(ab?"&":"?")+"_nonce="+Date.now()}return E(ah,af)}function g7(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=hA(ab.data,ab.content_type)})}function iv(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function g6(t){return t._attachments&&Object.keys(t._attachments)?i5.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new i5(function(ac){i2(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):i5.resolve()}function gV(ab){var t=i3(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function ha(t,aa){return iM(t,t.db+"/"+aa)}function iM(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function iN(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function P(aq,aj){function ah(ax,aA,az){var ay=ax.ajax||{},aw=G.extend(iu(am),ay,aA);return iG(aw.method+" "+aw.url),ab._ajax(aw,az)}function ap(aw,ax){return new i5(function(az,ay){ah(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function au(aw,ax){return gk(aw,ij(function(ay){ac().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function ac(){if(aq.skipSetup||aq.skip_setup){return i5.resolve()}if(al){return al}var aw={method:"GET",url:av};return al=ap({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(gl(404,"PouchDB is just detecting if the remote exists."),ap({},{method:"PUT",url:av})):i5.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:i5.reject(ax)}),al["catch"](function(){al=null}),al}function ag(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ab=this,t=gV;aq.getHost&&(t=aq.getHost);var ak=t(aq.name,aq),av=ha(ak,"");aq=iu(aq);var am=aq.ajax||{};if(ab.getUrl=function(){return av},ab.getHeaders=function(){return am.headers||{}},aq.auth||ak.auth){var ad=aq.auth||ak.auth,af=ad.username+":"+ad.password,aa=gv(unescape(encodeURIComponent(af)));am.headers=am.headers||{},am.headers.Authorization="Basic "+aa}ab._ajax=ey;var al;setTimeout(function(){aj(null,ab)}),ab.type=function(){return"http"},ab.id=au("id",function(aw){ah({},{method:"GET",url:iM(ak,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ak.db:ha(ak,"");aw(null,ay)})}),ab.request=au("request",function(aw,ax){aw.url=ha(ak,aw.url),ah({},aw,ax)}),ab.compact=au("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=iu(aw),ah(aw,{url:ha(ak,"_compact"),method:"POST"},function(){function ay(){ab.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ab.bulkGet=gk("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ah({},{url:ha(ak,"_bulk_get"+iN(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aG(aK){return function(aM,aL){aD[aK]=aL.results,++aF===aI&&aA(null,{results:Y(aD)})}}for(var aJ=hP,aI=Math.ceil(aC.docs.length/aJ),aF=0,aD=new Array(aI),aE=0;aI>aE;aE++){var aH=gC(aC,["revs","attachments"]);aH.ajax=am,aH.docs=aC.docs.slice(aE*aJ,Math.min(aC.docs.length,(aE+1)*aJ)),fy(aw,aH,aG(aE))}}var aw=this,az=iM(ak,""),ay=ir[az];"boolean"!=typeof ay?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(ir[az]=!1,gl(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{ir[az]=!0,aA(null,aE)}}):ay?ax(aA):aB()}),ab._info=function(aw){ac().then(function(){ah({},{method:"GET",url:ha(ak,"")},function(ay,ax){return ay?aw(ay):(ax.host=ha(ak,""),void aw(null,ax))})})["catch"](aw)},ab.get=au("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?i5.all(aF.map(function(aI){var aH=aD[aI],aG=iv(aE._id)+"/"+ag(aI)+"?rev="+aE._rev;return ap(aC,{method:"GET",url:ha(ak,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:new i5(function(aK){i2(aJ,aK)})}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function aw(aD){return Array.isArray(aD)?i5.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=iu(aC);var ay={};aC.revs&&(ay.revs=!0),aC.revs_info&&(ay.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),ay.open_revs=aC.open_revs),aC.rev&&(ay.rev=aC.rev),aC.conflicts&&(ay.conflicts=aC.conflicts),aA=iv(aA);var az={method:"GET",url:ha(ak,aA+iN(ay))};ap(aC,az).then(function(aD){return i5.resolve().then(function(){return aC.attachments?aw(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ab.remove=au("remove",function(az,ax,aB,aA){var aw;"string"==typeof ax?(aw={_id:az,_rev:ax},"function"==typeof aB&&(aA=aB,aB={})):(aw=az,"function"==typeof ax?(aA=ax,aB={}):(aA=aB,aB=ax));var ay=aw._rev||aB.rev;ah(aB,{method:"DELETE",url:ha(ak,iv(aw._id))+"?rev="+ay},aA)}),ab.getAttachment=au("getAttachment",function(az,aB,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var ay=ax.rev?"?rev="+ax.rev:"",aA=ha(ak,iv(az))+"/"+ag(aB)+ay;ah(ax,{method:"GET",url:aA,binary:!0},aw)}),ab.removeAttachment=au("removeAttachment",function(ax,aA,ay,az){var aw=ha(ak,iv(ax)+"/"+ag(aA))+"?rev="+ay;ah({},{method:"DELETE",url:aw},az)}),ab.putAttachment=au("putAttachment",function(aG,aC,aA,az,ax,aB){"function"==typeof ax&&(aB=ax,ax=az,az=aA,aA=null);var aD=iv(aG)+"/"+ag(aC),aE=ha(ak,aD);if(aA&&(aE+="?rev="+aA),"string"==typeof az){var ay;try{ay=fo(az)}catch(aF){return aB(fU(h7,"Attachment is not a valid base64 string"))}az=ay?jk(ay,ax):""}var aw={headers:{"Content-Type":ax},method:"PUT",url:aE,processData:!1,body:az,timeout:am.timeout||60000};ah({},aw,aB)}),ab._bulkDocs=function(ay,ax,aw){ay.new_edits=ax.new_edits,ac().then(function(){return i5.all(ay.docs.map(g6))}).then(function(){ah(ax,{method:"POST",url:ha(ak,"_bulk_docs"),body:ay},function(aA,az){return aA?aw(aA):(az.forEach(function(aB){aB.ok=!0}),void aw(null,az))})})["catch"](aw)},ab.allDocs=au("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=iu(aA);var ax,aB={},aw="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var az=iN(aB);if("undefined"!=typeof aA.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aA.keys));ay.length+az.length+1<=jp?az+="&"+ay:(aw="POST",ax={keys:aA.keys})}ap(aA,{method:aw,url:ha(ak,"_all_docs"+az),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(g7),aC(null,aD)})["catch"](aC)}),ab._changes=function(aB){var aw="batch_size" in aB?aB.batch_size:iR;aB=iu(aB),aB.timeout="timeout" in aB?aB.timeout:"timeout" in am?am.timeout:30000;var ay,aF=aB.timeout?{timeout:aB.timeout-5000}:{},az="undefined"!=typeof aB.limit?aB.limit:!1;ay="return_docs" in aB?aB.return_docs:"returnDocs" in aB?aB.returnDocs:!0;var aH=az;if(aB.style&&(aF.style=aB.style),(aB.include_docs||aB.filter&&"function"==typeof aB.filter)&&(aF.include_docs=!0),aB.attachments&&(aF.attachments=!0),aB.continuous&&(aF.feed="longpoll"),aB.conflicts&&(aF.conflicts=!0),aB.descending&&(aF.descending=!0),"heartbeat" in aB?aB.heartbeat&&(aF.heartbeat=aB.heartbeat):aF.heartbeat=10000,aB.filter&&"string"==typeof aB.filter&&(aF.filter=aB.filter),aB.view&&"string"==typeof aB.view&&(aF.filter="_view",aF.view=aB.view),aB.query_params&&"object"==typeof aB.query_params){for(var aJ in aB.query_params){aB.query_params.hasOwnProperty(aJ)&&(aF[aJ]=aB.query_params[aJ])}}var aD,aE="GET";if(aB.doc_ids){aF.filter="_doc_ids";var aG=JSON.stringify(aB.doc_ids);aG.length<jp?aF.doc_ids=aG:(aE="POST",aD={doc_ids:aB.doc_ids})}var aI,aK,ax=function(aM,aN){if(!aB.aborted){aF.since=aM,"object"==typeof aF.since&&(aF.since=JSON.stringify(aF.since)),aB.descending?az&&(aF.limit=aH):aF.limit=!az||aH>aw?aw:aH;var aL={method:aE,url:ha(ak,"_changes"+iN(aF)),timeout:aB.timeout,body:aD};aK=aM,aB.aborted||ac().then(function(){aI=ah(aB,aL,aN)})["catch"](aN)}},aA={results:[]},aC=function(aN,aL){if(!aB.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aA.last_seq=aL.last_seq;var aP={};aP.query=aB.query_params,aL.results=aL.results.filter(function(aR){aH--;var aQ=gM(aB)(aR);return aQ&&(aB.include_docs&&aB.attachments&&aB.binary&&g7(aR),ay&&aA.results.push(aR),aB.onChange(aR)),aQ})}else{if(aN){return aB.aborted=!0,void aB.complete(aN)}}aL&&aL.last_seq&&(aK=aL.last_seq);var aO=az&&0>=aH||aL&&aw>aM||aB.descending;(!aB.continuous||az&&0>=aH)&&aO?aB.complete(null,aA):setTimeout(function(){ax(aK,aC)},0)}};return ax(aB.since||0,aC),{cancel:function(){aB.aborted=!0,aI&&aI.abort()}}},ab.revsDiff=au("revsDiff",function(ay,ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ah(ax,{method:"POST",url:ha(ak,"_revs_diff"),body:ay},aw)}),ab._close=function(aw){aw()},ab._destroy=function(aw,ax){ah(aw,{url:ha(ak,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function n(t){t.adapter("http",P,!1),t.adapter("https",P,!1)}function an(){this.promise=new i5(function(t){t()})}function ct(ag){var af=ag.db,t=ag.viewName,ad=ag.map,ab=ag.reduce,aa=ag.temporary,ac=ad.toString()+(ab&&ab.toString())+"undefined";if(!aa&&af._cachedViews){var ah=af._cachedViews[ac];if(ah){return i5.resolve(ah)}}return af.info().then(function(ak){function al(am){am.views=am.views||{};var aq=t;-1===aq.indexOf("/")&&(aq=t+"/"+t);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(aa?"temp":fW(ac));return jl(af,"_local/mrviews",al).then(function(){return af.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:af,adapter:af.adapter,mapFun:ad,reduceFun:ab};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,aa||(af._cachedViews=af._cachedViews||{},af._cachedViews[ac]=aq,aq.db.once("destroyed",function(){delete af._cachedViews[ac]})),aq})})})})}function fb(ab,ad,t,ac,aa,af){return hg("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function A(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function iW(t){return 1===t.length&&/^1-/.test(t[0].rev)}function be(ab,t){try{ab.emit("error",t)}catch(aa){h2("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),h2("error",t)}}function gb(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return be(aa,ab),{error:ab}}}function fw(ab,t){var aa=gw.collate(ab.key,t.key);return 0!==aa?aa:gw.collate(ab.value,t.value)}function gJ(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function i6(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function cr(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=hA(ac.data,ac.content_type)})})}function iq(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&cr(aa),aa}}function iQ(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new gP(aa)}function gY(ag){for(var af=0,t=0,ad=ag.length;ad>t;t++){var ab=ag[t];if("number"!=typeof ab){if(!Array.isArray(ab)){throw iQ("_sum")}af="number"==typeof af?[af]:af;for(var aa=0,ac=ab.length;ac>aa;aa++){var ah=ab[aa];if("number"!=typeof ah){throw iQ("_sum")}"undefined"==typeof af[aa]?af.push(ah):af[aa]+=ah}}else{"number"==typeof af?af+=ab:af[0]+=ab}}return af}function gR(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function iE(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function fT(t){return t.group_level=iE(t.group_level),t.limit=iE(t.limit),t.skip=iE(t.skip),t}function br(t){if(t){if("number"!=typeof t){return new k('Invalid value for integer: "'+t+'"')}if(0>t){return new k('Invalid value for positive integer: "'+t+'"')}}}function ae(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&gw.collate(aa[t],aa[ab])>0){throw new k("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new k("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new k("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=br(aa[af]);if(ad){throw ad}})}function a1(aj,ag,ac){var af,ab=[],aa="GET";if(gR("reduce",ac,ab),gR("include_docs",ac,ab),gR("attachments",ac,ab),gR("limit",ac,ab),gR("descending",ac,ab),gR("group",ac,ab),gR("group_level",ac,ab),gR("skip",ac,ab),gR("stale",ac,ab),gR("conflicts",ac,ab),gR("startkey",ac,ab,!0),gR("start_key",ac,ab,!0),gR("endkey",ac,ab,!0),gR("end_key",ac,ab,!0),gR("inclusive_end",ac,ab),gR("key",ac,ab,!0),ab=ab.join("&"),ab=""===ab?"":"?"+ab,"undefined"!=typeof ac.keys){var ah=2000,ad="keys="+encodeURIComponent(JSON.stringify(ac.keys));ad.length+ab.length+1<=ah?ab+=("?"===ab[0]?"&":"?")+ad:(aa="POST","string"==typeof ag?af={keys:ac.keys}:ag.keys=ac.keys)}if("string"==typeof ag){var t=A(ag);return aj.request({method:aa,url:"_design/"+t[0]+"/_view/"+t[1]+ab,body:af}).then(iq(ac))}return af=af||{},Object.keys(ag).forEach(function(ak){Array.isArray(ag[ak])?af[ak]=ag[ak]:af[ak]=ag[ak].toString()}),aj.request({method:"POST",url:"_temp_view"+ab,body:af}).then(iq(ac))}function gG(ab,t,aa){return new i5(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function fj(t){return new i5(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function s(t){return function(aa){if(404===aa.status){return t}throw aa}}function W(aa,ah,ac){function af(){return iW(t)?i5.resolve(aj):ah.db.get(al)["catch"](s(aj))}function ag(am){return am.keys.length?ah.db.allDocs({keys:am.keys,include_docs:!0}):i5.resolve({rows:[]})}function ad(am,ay){for(var au=[],aw={},av=0,aq=ay.rows.length;aq>av;av++){var aA=ay.rows[av],ax=aA.doc;if(ax&&(au.push(ax),aw[ax._id]=!0,ax._deleted=!ab[ax._id],!ax._deleted)){var az=ab[ax._id];"value" in az&&(ax.value=az.value)}}var ap=Object.keys(ab);return ap.forEach(function(aD){if(!aw[aD]){var aB={_id:aD},aC=ab[aD];"value" in aC&&(aB.value=aC.value),au.push(aB)}}),am.keys=K(ap.concat(am.keys)),au.push(am),au}var al="_local/doc_"+aa,aj={_id:al,keys:[]},ak=ac[aa],ab=ak.indexableKeysToKeyValues,t=ak.changes;return af().then(function(am){return ag(am).then(function(ap){return ad(am,ap)})})}function Q(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](s({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return i5.all(ad.map(function(ag){return W(ag,aa,ac)})).then(function(ag){var ah=Y(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function h(ab){var t="string"==typeof ab?ab:ab.name,aa=hp[t];return aa||(aa=hp[t]=new an),aa}function hI(t){return p(h(t),function(){return M(t)})()}function M(aj){function ag(am,ak){var al={id:ab._id,key:gw.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gw.normalizeKey(ak)),af.push(al)}function ac(ak,al){return function(){return Q(aj,ak,al)}}var af,ab,aa;if("function"==typeof aj.mapFun&&2===aj.mapFun.length){var ah=aj.mapFun;aa=function(ak){return ah(ak,ag)}}else{aa=fb(aj.mapFun.toString(),ag,gY,ia,Array.isArray,JSON.parse)}var ad=aj.seq||0,t=new an;return new i5(function(ap,ak){function al(){t.finish().then(function(){aj.seq=ad,ap()})}function am(){function aq(au){ak(au)}aj.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ad,limit:jr}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var ay={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){af=[],ab=aD.doc,ab._deleted||gb(aj.sourceDB,aa,[ab]),af.sort(fw);for(var aC,au={},aE=0,az=af.length;az>aE;aE++){var aw=af[aE],aG=[aw.key,aw.id];0===gw.collate(aw.key,aC)&&aG.push(aE);var aB=gw.toIndexableString(aG);au[aB]=aw,aC=aw.key}ay[aD.doc._id]={indexableKeysToKeyValues:au,changes:aD.changes}}ad=aD.seq}return t.add(ac(ay,ad)),aF.length<jr?al():am()}).on("error",aq)}am()})}function es(aa,ah,ac){0===ac.group_level&&delete ac.group_level;var af,ag=ac.group||ac.group_level;af=iY[aa.reduceFun]?iY[aa.reduceFun]:fb(aa.reduceFun.toString(),null,gY,ia,Array.isArray,JSON.parse);var ad=[],al=isNaN(ac.group_level)?Number.POSITIVE_INFINITY:ac.group_level;ah.forEach(function(aq){var am=ad[ad.length-1],ap=ag?aq.key:null;return ag&&Array.isArray(ap)&&(ap=ap.slice(0,al)),am&&0===gw.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ad.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ah=[];for(var aj=0,ak=ad.length;ak>aj;aj++){var ab=ad[aj],t=gb(aa.sourceDB,af,[ab.keys,ab.values,!1]);if(t.error&&t.error instanceof gP){throw t.error}ah.push({value:t.error?null:t.output,key:ab.groupKey})}return{rows:gJ(ah,ac.limit,ac.skip)}}function ao(t,aa){return p(h(t),function(){return g8(t,aa)})()}function g8(t,ad){function aa(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ab=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=gw.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ac(aq){var au;if(au=am?es(t,aq,ad):{total_rows:ab,offset:ag,rows:aq},ad.include_docs){var av=K(aq.map(i6));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:ad.conflicts,attachments:ad.attachments,binary:ad.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=i6(ay),az=ax["$"+aA];az&&(ay.doc=az)}),au})}return au}var ab,am=t.reduceFun&&ad.reduce!==!1,ag=ad.skip||0;if("undefined"==typeof ad.keys||ad.keys.length||(ad.limit=0,delete ad.keys),"undefined"!=typeof ad.keys){var al=ad.keys,af=al.map(function(aq){var au={startkey:gw.toIndexableString([aq]),endkey:gw.toIndexableString([aq,{}])};return aa(au)});return i5.all(af).then(Y).then(ac)}var ah={descending:ad.descending};if(ad.start_key&&(ad.startkey=ad.start_key),ad.end_key&&(ad.endkey=ad.end_key),"undefined"!=typeof ad.startkey&&(ah.startkey=ad.descending?gw.toIndexableString([ad.startkey,{}]):gw.toIndexableString([ad.startkey])),"undefined"!=typeof ad.endkey){var ak=ad.inclusive_end!==!1;ad.descending&&(ak=!ak),ah.endkey=gw.toIndexableString(ak?[ad.endkey,{}]:[ad.endkey])}if("undefined"!=typeof ad.key){var ap=gw.toIndexableString([ad.key]),aj=gw.toIndexableString([ad.key,{}]);ah.descending?(ah.endkey=ap,ah.startkey=aj):(ah.startkey=ap,ah.endkey=aj)}return am||("number"==typeof ad.limit&&(ah.limit=ad.limit),ah.skip=ag),aa(ah).then(ac)}function iA(t){return t.request({method:"POST",url:"_view_cleanup"})}function fe(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=A(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return p(h(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return i5.all(ag).then(function(){return{ok:!0}})})},s({ok:!0}))}function ei(ab,ah,ag){if("http"===ab.type()){return a1(ab,ah,ag)}if("function"==typeof ab._query){return gG(ab,ah,ag)}if("string"!=typeof ah){ae(ag,ah);var t={db:ab,viewName:"temp_view/temp_view",map:ah.map,reduce:ah.reduce,temporary:!0};return iK.add(function(){return ct(t).then(function(ak){function aj(){return ak.db.destroy()}return dr(hI(ak).then(function(){return ao(ak,ag)}),aj)})}),iK.finish()}var af=ah,ac=A(af),ad=ac[0],aa=ac[1];return ab.get("_design/"+ad).then(function(al){var ak=al.views&&al.views[aa];if(!ak||"string"!=typeof ak.map){throw new ai("ddoc "+ad+" has no view named "+aa)}ae(ag,ak);var aj={db:ab,viewName:af,map:ak.map,reduce:ak.reduce};return ct(aj).then(function(am){return"ok"===ag.stale||"update_after"===ag.stale?("update_after"===ag.stale&&g0.nextTick(function(){hI(am)}),ao(am,ag)):hI(am).then(function(){return ao(am,ag)})})})}function k(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,k)}catch(aa){}}function ai(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,ai)}catch(aa){}}function gP(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gP)}catch(aa){}}function N(t){return/^1-/.test(t)}function gc(ab,t,aa){return !ab._attachments||!ab._attachments[aa]||ab._attachments[aa].digest!==t._attachments[aa].digest}function gm(ab,t){var aa=Object.keys(t._attachments);return i5.all(aa.map(function(ac){return ab.getAttachment(t._id,ac,{rev:t._rev})}))}function i7(ab,ad,t){var ac="http"===ad.type()&&"http"!==ab.type(),aa=Object.keys(t._attachments);return ac?ab.get(t._id).then(function(af){return i5.all(aa.map(function(ag){return gc(af,t,ag)?ad.getAttachment(t._id,ag):ab.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return gm(ad,t)}):gm(ad,t)}function hS(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function i(ac,aj,ad,ag){function af(){var am=hS(ad);if(am.docs.length){return ac.bulkGet(am).then(function(ap){if(ag.cancelled){throw new Error("cancelled")}return i5.all(ap.results.map(function(aq){return i5.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?i7(aj,ac,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ab=ab.concat(Y(aq).filter(Boolean))})})}}function aa(am){return am._attachments&&Object.keys(am._attachments).length>0}function al(am){return ac.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ag.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&N(aq.value.rev)&&!aa(aq.doc)&&(ab.push(aq.doc),delete ad[aq.id])})})}function ah(){var am=Object.keys(ad).filter(function(aq){var ap=ad[aq].missing;return 1===ap.length&&N(ap[0])});return am.length>0?al(am):void 0}function ak(){return{ok:t,docs:ab}}ad=iu(ad);var ab=[],t=!0;return i5.resolve().then(ah).then(af).then(ak)}function iF(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&gl(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:gU,version:C}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,hC),af.version=C,af.replicator=gU,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return iF(ab,ad,t,ac,aa)}throw ag}))})}function a5(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function jC(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:gg(t.history,aa.history)}function gg(ag,af){var t=ag[0],ad=ag.slice(1),ab=af[0],aa=af.slice(1);if(!t||0===af.length){return{last_seq:hh,history:[]}}var ac=t.session_id;if(F(ac,af)){return{last_seq:t.last_seq,history:ag}}var ah=ab.session_id;return F(ah,ad)?{last_seq:ab.last_seq,history:aa}:gg(ad,aa)}function F(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:F(aa,ab):!1}function fr(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function ho(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=jd),ac.emit("requestError",t),"active"!==ac.state&&"pending"!==ac.state||(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=hj})),aa.current_back_off=aa.current_back_off||hj,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function X(t){return Object.keys(t).sort(gw.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function iZ(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(gw.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(X(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),i5.all([aa.id(),ac.id()]).then(function(aj){var ah=aj[0]+aj[1]+t+af+ad+ab;return new i5(function(ak){gd(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function h4(af,aN,aB,aG,aC){function av(){return ak?i5.resolve():iZ(af,aN,aB).then(function(aS){aP=aS,ak=new a5(af,aN,aP,aG)})}function aH(){if(aJ=[],0!==ah.docs.length){var aS=ah.docs;return aN.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(aG.cancelled){throw aD(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(aC.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),ag=ag.concat(aT),aC.docs_written+=ah.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?aG.emit("denied",iu(aY)):aJ.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,au("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw aC.doc_write_failures+=aS.length,aT})}}function aM(){if(ah.error){throw new Error("There was a problem getting docs.")}aC.last_seq=aw=ah.seq;var aS=iu(aC);return aJ.length&&(aS.docs=aJ,aG.emit("change",aS)),ap=!0,ak.writeCheckpoint(ah.seq,ad).then(function(){if(ap=!1,aG.cancelled){throw aD(),new Error("cancelled")}ah=void 0,az()})["catch"](aO)}function ab(){var aS={};return ah.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aN.revsDiff(aS).then(function(aT){if(aG.cancelled){throw aD(),new Error("cancelled")}ah.diffs=aT})}function al(){return i(af,aN,ah.diffs,aG).then(function(aS){ah.error=!aS.ok,aS.docs.forEach(function(aT){delete ah.diffs[aT._id],aC.docs_read++,ah.docs.push(aT)})})}function ay(){if(!aG.cancelled&&!ah){if(0===ax.length){return void aR(!0)}ah=ax.shift(),ab().then(al).then(aH).then(aM).then(ay)["catch"](function(aS){au("batch processing terminated with error",aS)})}}function aR(aS){return 0===aE.changes.length?void (0!==ax.length||ah||((aK&&aA.live||aI)&&(aG.state="pending",aG.emit("paused")),aI&&aD())):void ((aS||aI||aE.changes.length>=aa)&&(ax.push(aE),aE={seq:0,changes:[],docs:[]},"pending"!==aG.state&&"stopped"!==aG.state||(aG.state="active",aG.emit("active")),ay()))}function au(aS,aT){am||(aT.message||(aT.message=aS),aC.ok=!1,aC.status="aborting",aC.errors.push(aT),ag=ag.concat(aT),ax=[],aE={seq:0,changes:[],docs:[]},aD())}function aD(){if(!(am||aG.cancelled&&(aC.status="cancelled",ap))){aC.status=aC.status||"complete",aC.end_time=new Date,aC.last_seq=aw,am=!0;var aS=ag.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=ag.pop();ag.length>0&&(aT.other_errors=ag),aT.result=aC,ho(aB,aG,aT,function(){h4(af,aN,aB,aG)})}else{aC.errors=ag,aG.emit("complete",aC),aG.removeAllListeners()}}}function ac(aS){if(aG.cancelled){return aD()}var aT=gM(aB)(aS);aT&&(aE.seq=aS.seq,aE.changes.push(aS),aR(0===ax.length&&aA.live))}function t(aS){if(aL=!1,aG.cancelled){return aD()}if(aS.results.length>0){aA.since=aS.last_seq,az(),aR(!0)}else{var aT=function(){aK?(aA.live=!0,az()):aI=!0,aR(!0)};ah||0!==aS.results.length?aT():(ap=!0,ak.writeCheckpoint(aS.last_seq,ad).then(function(){ap=!1,aC.last_seq=aw=aS.last_seq,aT()})["catch"](aO))}}function aF(aS){return aL=!1,aG.cancelled?aD():void au("changes rejected",aS)}function az(){function aU(){aS.cancel()}function aT(){aG.removeListener("cancel",aU)}if(!aL&&!aI&&ax.length<aQ){aL=!0,aG._changes&&(aG.removeListener("cancel",aG._abortChanges),aG._changes.cancel()),aG.once("cancel",aU);var aS=af.changes(aA).on("change",ac);aS.then(aT,aT),aS.then(t)["catch"](aF),aB.retry&&(aG._changes=aS,aG._abortChanges=aU)}}function aq(){av().then(function(){return aG.cancelled?void aD():ak.getCheckpoint().then(function(aS){aw=aS,aA={since:aw,limit:aa,batch_size:aa,style:"all_docs",doc_ids:aj,return_docs:!0},aB.filter&&("string"!=typeof aB.filter?aA.include_docs=!0:aA.filter=aB.filter),"heartbeat" in aB&&(aA.heartbeat=aB.heartbeat),"timeout" in aB&&(aA.timeout=aB.timeout),aB.query_params&&(aA.query_params=aB.query_params),aB.view&&(aA.view=aB.view),az()})})["catch"](function(aS){au("getCheckpoint rejected with ",aS)})}function aO(aS){throw ap=!1,au("writeCheckpoint completed with error",aS),aS}var ah,aP,ak,ax=[],aE={seq:0,changes:[],docs:[]},ap=!1,aI=!1,am=!1,aw=0,aK=aB.continuous||aB.live||!1,aa=aB.batch_size||100,aQ=aB.batches_limit||10,aL=!1,aj=aB.doc_ids,ag=[],aJ=[],ad=gz();aC=aC||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aA={};return aG.ready(af,aN),aG.cancelled?void aD():(aG._addedListeners||(aG.once("cancel",aD),"function"==typeof aB.complete&&(aG.once("error",aB.complete),aG.once("complete",function(aS){aB.complete(null,aS)})),aG._addedListeners=!0),void ("undefined"==typeof aB.since?aq():av().then(function(){return ap=!0,ak.writeCheckpoint(aB.since,ad)}).then(function(){return ap=!1,aG.cancelled?void aD():(aw=aB.since,void aq())})["catch"](aO)))}function i8(){he.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new i5(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function x(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function h5(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw fU(hy,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=iu(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new i8(ag),ad=x(aa,ag),af=x(ac,ag);return h4(ad,af,ag,t),t}function fs(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=iu(t),t.PouchConstructor=t.PouchConstructor||this,aa=x(aa,t),ac=x(ac,t),new gD(aa,ac,t,ab)}function gD(aa,aj,ah,aq){function ak(ay){ac.emit("change",{direction:"pull",change:ay})}function ad(ay){ac.emit("change",{direction:"push",change:ay})}function al(ay){ac.emit("denied",{direction:"push",doc:ay})}function ag(ay){ac.emit("denied",{direction:"pull",doc:ay})}function av(){ac.pushPaused=!0,ac.pullPaused&&ac.emit("paused")}function ap(){ac.pullPaused=!0,ac.pushPaused&&ac.emit("paused")}function ab(){ac.pushPaused=!1,ac.pullPaused&&ac.emit("active",{direction:"push"})}function af(){ac.pullPaused=!1,ac.pushPaused&&ac.emit("active",{direction:"pull"})}function t(ay){return function(aC,aD){var az="change"===aC&&(aD===ak||aD===ad),aA="denied"===aC&&(aD===ag||aD===al),aE="paused"===aC&&(aD===ap||aD===av),aB="active"===aC&&(aD===af||aD===ab);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ac.removeAllListeners(aC))}}var ac=this;this.canceled=!1;var am=ah.push?G.extend({},ah,ah.push):ah,aw=ah.pull?G.extend({},ah,ah.pull):ah;this.push=h5(aa,aj,am),this.pull=h5(aj,aa,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ah.live&&(this.push.on("complete",ac.pull.cancel.bind(ac.pull)),this.pull.on("complete",ac.push.cancel.bind(ac.push))),this.on("newListener",function(ay){"change"===ay?(ac.pull.on("change",ak),ac.push.on("change",ad)):"denied"===ay?(ac.pull.on("denied",ag),ac.push.on("denied",al)):"active"===ay?(ac.pull.on("active",af),ac.push.on("active",ab)):"paused"===ay&&(ac.pull.on("paused",ap),ac.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ac.pull.removeListener("change",ak),ac.push.removeListener("change",ad)):"denied"===ay?(ac.pull.removeListener("denied",ag),ac.push.removeListener("denied",al)):"active"===ay?(ac.pull.removeListener("active",af),ac.push.removeListener("active",ab)):"paused"===ay&&(ac.pull.removeListener("paused",ap),ac.push.removeListener("paused",av))}),this.pull.on("removeListener",t("pull")),this.push.on("removeListener",t("push"));var au=i5.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ac.emit("complete",az),aq&&aq(null,az),ac.removeAllListeners(),az},function(ay){if(ac.cancel(),aq?aq(ay):ac.emit("error",ay),ac.removeAllListeners(),aq){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function hw(t){t.replicate=h5,t.sync=fs}var et,G=a(9),hx=cn(a(5)),hK=cn(a(8)),jm=cn(a(10)),je=a(14),ij=cn(a(4)),he=a(1),hg=cn(a(15)),hl=cn(a(16)),io=cn(a(17)),gw=a(12),i5="function"==typeof Promise?Promise:jm,m=Function.prototype.toString,hi=m.call(Object),gW=hx("pouchdb:api"),gp=6;if(iC()){et=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),et=!!localStorage.getItem("_pouch_check_localstorage")}catch(gi){et=!1}}hK(fZ,he.EventEmitter),fZ.prototype.addListener=function(aa,ac,ag,ab){function t(){function aj(){af=!1}if(ad._listeners[ac]){if(af){return void (af="waiting")}af=!0;var ah=gC(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){t()},0),af=!1}).on("error",aj)}}if(!this._listeners[ac]){var ad=this,af=!1;this._listeners[ac]=t,this.on(aa,t)}},fZ.prototype.removeListener=function(t,aa){aa in this._listeners&&he.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},fZ.prototype.notifyLocalWindows=function(t){iC()?chrome.storage.local.set({dbName:t}):fd()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},fZ.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hK(hH,Error),hH.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ju=new hH({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hc=new hH({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),gx=new hH({status:404,error:"not_found",reason:"missing"}),hO=new hH({status:409,error:"conflict",reason:"Document update conflict"}),g1=new hH({status:400,error:"invalid_id",reason:"_id field must contain a string"}),ew=new hH({status:412,error:"missing_id",reason:"_id is required for puts"}),u=new hH({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),iV=new hH({status:412,error:"precondition_failed",reason:"Database not open"}),gN=new hH({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),h7=new hH({status:500,error:"badarg",reason:"Some query argument is invalid"}),ik=new hH({status:400,error:"invalid_request",reason:"Request was invalid"}),D=new hH({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),at=new hH({status:500,error:"doc_validation",reason:"Bad special document member"}),hy=new hH({status:400,error:"bad_request",reason:"Something wrong with the request"}),gL=new hH({status:400,error:"bad_request",reason:"Document must be a JSON object"}),ht=new hH({status:404,error:"not_found",reason:"Database not found"}),gB=new hH({status:500,error:"indexed_db_went_bad",reason:"unknown"}),g3=new hH({status:500,error:"web_sql_went_bad",reason:"unknown"}),hG=new hH({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fn=new hH({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iB=new hH({status:400,error:"bad_request",reason:"Invalid rev format"}),bt=new hH({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),i4=new hH({status:412,error:"missing_stub"}),fm=new hH({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gt=[ju,hc,gx,hO,g1,ew,u,iV,gN,h7,ik,D,at,hy,gL,ht,g3,hG,fn,iB,bt,i4,gB,fm],gu=function(aa,ac,t){var ab=gt.filter(function(ad){return ad[aa]===ac});return t&&ab.filter(function(ad){return ad.message===t})[0]||ab[0]},q=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],fV="queryKey",de=/(?:^|&)([^&=]*)=?([^&]*)/g,ez=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fX="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hK(ex,he.EventEmitter),ex.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},ex.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=iu(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=fu,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.view&&!ab.filter&&(ab.filter="_view"),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=go(ab.view):ab.filter=go(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=ij(function(af){ac.cancel(),aa.apply(this,af)})}},ex.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=fU(hy,"`view` filter parameter not found or invalid.");return t(ac)}var aa=g5(ab.view);this.db.get("_design/"+aa[0],function(ah,aj){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ah){return t(gh(ah))}var ag=aj&&aj.views&&aj.views[aa[1]]&&aj.views[aa[1]].map;return ag?(ab.filter=bo(ag),void ad.doChanges(ab)):t(fU(gx,aj.views?"missing json key: "+aa[1]:"missing json key: views"))})}else{var af=g5(ab.filter);if(!af){return ad.doChanges(ab)}this.db.get("_design/"+af[0],function(ag,aj){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ag){return t(gh(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ab.filter=ip(ah),void ad.doChanges(ab)):t(fU(gx,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hK(jt,he.EventEmitter),jt.prototype.post=gk("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(fU(gL)):void this.bulkDocs({docs:[ab]},t,gs(aa))}),jt.prototype.put=gk("put",ij(function(aj){function ag(){ah||(h2("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ah=!0)}var ac,af,ab,aa,ah=!1,ad=aj.shift(),t="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(aa=aj.pop())(fU(gL))}for(;;){if(ac=aj.shift(),af=typeof ac,"string"!==af||t?"string"!==af||!t||"_rev" in ad?"object"===af?ab=ac:"function"===af&&(aa=ac):(ag(),ad._rev=ac):(ag(),ad._id=ac,t=!0),!aj.length){break}}return ab=ab||{},hs(ad._id),fq(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,aa):this._putLocal(ad,aa):void this.bulkDocs({docs:[ad]},ab,gs(aa))})),jt.prototype.putAttachment=gk("putAttachment",function(aa,ac,ag,ab,t){function ad(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ac]={content_type:t,data:ab,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof t&&(t=ab,ab=ag,ag=null),"undefined"==typeof t&&(t=ab,ab=ag,ag=null),af.get(aa).then(function(ah){if(ah._rev!==ag){throw fU(hO)}return ad(ah)},function(ah){if(ah.reason===gx.message){return ad({_id:aa})}throw ah})}),jt.prototype.removeAttachment=gk("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(fU(hO)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),jt.prototype.remove=gk("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,fq(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,gs(ac))}),jt.prototype.revsDiff=gk("revsDiff",function(ag,af,t){function ad(ak,aj){ah.has(ak)||ah.set(ak,{missing:[]}),ah.get(ak).missing.push(aj)}function ab(aj,ak){var al=ag[aj].slice(0);eu(ak,function(am,ap,aq,aw,av){var ax=ap+"-"+aq,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==av.status&&ad(aj,ax))}),al.forEach(function(am){ad(aj,am)})}"function"==typeof af&&(t=af,af={});var aa=Object.keys(ag);if(!aa.length){return t(null,{})}var ac=0,ah=new je.Map;aa.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ah.set(aj,{missing:ag[aj]})}else{if(al){return t(al)}ab(aj,am)}if(++ac===aa.length){var ak={};return ah.forEach(function(ap,aq){ak[aq]=ap}),t(null,ak)}})},this)}),jt.prototype.bulkGet=gk("bulkGet",function(t,aa){fy(this,t,aa)}),jt.prototype.compactDocument=gk("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(ah,ad){if(ah){return t(ah)}var ag=i1(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>ac&&aj.push(ak)}),eu(ad,function(aq,ak,am,au,ap){var al=ak+"-"+am;"available"===ap.status&&-1!==aj.indexOf(al)&&af.push(al)}),ab._doCompaction(aa,af,t)})}),jt.prototype.compact=gk("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&jg(aa)}),jt.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(ah){var aj=ah.last_seq;i5.all(af).then(function(){return jl(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},jt.prototype.get=gk("get",function(ag,af,t){function ad(){var ak=[],aj=ab.length;return aj?void ab.forEach(function(al){aa.get(ag,{rev:al,revs:af.revs,attachments:af.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||t(null,ak)})}):t(null,ak)}if("function"==typeof af&&(t=af,af={}),"string"!=typeof ag){return t(fU(g1))}if(fq(ag)&&"function"==typeof this._getLocal){return this._getLocal(ag,t)}var ab=[],aa=this;if(!af.open_revs){return this._get(ag,af,function(al,ap){if(al){return t(al)}var az=ap.doc,am=ap.metadata,ay=ap.ctx;if(af.conflicts){var ax=eo(am);ax.length&&(az._conflicts=ax)}if(jo(am,az._rev)&&(az._deleted=!0),af.revs||af.revs_info){var aj=hR(am.rev_tree),au=v(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(az._rev.split("-")[1])}),aw=au.ids.map(function(aC){return aC.id}).indexOf(az._rev.split("-")[1])+1,aA=au.ids.length-aw;if(au.ids.splice(aw,aA),au.ids.reverse(),af.revs&&(az._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),af.revs_info){var aq=au.pos+au.ids.length;az._revs_info=au.ids.map(function(aC){return aq--,{rev:aq+"-"+aC.id,status:aC.opts.status}})}}if(af.attachments&&az._attachments){var ak=az._attachments,aB=Object.keys(ak).length;if(0===aB){return t(null,az)}Object.keys(ak).forEach(function(aC){this._getAttachment(az._id,aC,ak[aC],{rev:az._rev,binary:af.binary,ctx:ay},function(aE,aD){var aF=az._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aB||t(null,az)})},aa)}else{if(az._attachments){for(var av in az._attachments){az._attachments.hasOwnProperty(av)&&(az._attachments[av].stub=!0)}}t(null,az)}})}if("all"===af.open_revs){this._getRevisionTree(ag,function(ak,aj){return ak?t(ak):(ab=jE(aj).map(function(al){return al.rev}),void ad())})}else{if(!Array.isArray(af.open_revs)){return t(fU(gN,"function_clause"))}ab=af.open_revs;for(var ac=0;ac<ab.length;ac++){var ah=ab[ac];if("string"!=typeof ah||!/^\d+-/.test(ah)){return t(fU(iB))}}ad()}}),jt.prototype.getAttachment=gk("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ab,ad,ag.doc._attachments[ad],t,ac),void 0):ac(fU(gx))})}),jt.prototype.allDocs=gk("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(fU(D,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return ar(this,ab,t)}}return this._allDocs(ab,t)}),jt.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new ex(this,t,aa)},jt.prototype.close=gk("close",function(t){return this._closed=!0,this._close(t)}),jt.prototype.info=gk("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),jt.prototype.id=gk("id",function(t){return this._id(t)}),jt.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},jt.prototype.bulkDocs=gk("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(fU(hc))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(fU(gL))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||g4(ag)})}),aa?t(fU(hy,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(a0),a4(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),jt.prototype.registerDependentDatabase=gk("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);jl(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),jt.prototype.destroy=gk("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac._destroyed=!0,ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});i5.all(af).then(t,ad)})}),jB.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},jB.prototype.fail=function(t){this.failed=t,this.execute()},jB.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},jB.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hK(hE,jt),hE.debug=hx,hE.adapters={},hE.preferredAdapters=[],hE.prefix="_pouch_";var hM=new he.EventEmitter;hn(hE),hE.parseAdapter=function(ag,af){var t,ad,ab=ag.match(/([a-z\-]*):\/\/(.*)/);if(ab){if(ag=/http(s?)/.test(ab[1])?ab[1]+"://"+ab[2]:ab[2],t=ab[1],!hE.adapters[t].valid()){throw"Invalid adapter"}return{name:ag,adapter:ab[1]}}var aa="idb" in hE.adapters&&"websql" in hE.adapters&&fd()&&localStorage["_pouch__websqldb_"+hE.prefix+ag];if(af.adapter){ad=af.adapter}else{if("undefined"!=typeof af&&af.db){ad="leveldb"}else{for(var ac=0;ac<hE.preferredAdapters.length;++ac){if(ad=hE.preferredAdapters[ac],ad in hE.adapters){if(aa&&"idb"===ad){h2("log",'PouchDB is downgrading "'+ag+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}t=hE.adapters[ad];var ah=t&&"use_prefix" in t?t.use_prefix:!0;return{name:ah?hE.prefix+ag:ag,adapter:ad}},hE.adapter=function(ab,t,aa){t.valid()&&(hE.adapters[ab]=t,aa&&hE.preferredAdapters.push(ab))},hE.plugin=function(t){return"function"==typeof t?t(hE):Object.keys(t).forEach(function(aa){hE.prototype[aa]=t[aa]}),hE},hE.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=G.extend({},t,ad),void hE.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return hK(aa,hE),aa.preferredAdapters=hE.preferredAdapters.slice(),Object.keys(hE).forEach(function(ab){ab in aa||(aa[ab]=hE[ab])}),aa};var fz="5.4.4";hE.version=fz;var iX,dn=gX(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hY=gX(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),fo=function(t){return atob(t)},gv=function(t){return btoa(t)},gT=ge.setImmediate||ge.setTimeout,iU=32768,h3=5,g2="document-store",h8="by-sequence",o="attach-store",hV="attach-seq-store",V="meta-store",gq="local-store",jh="detect-blob-support",i9={running:!1,queue:[]},h6=new je.Map,i0=new fZ,gH=new je.Map;bn.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var h9=7,jj=js("document-store"),ft=js("by-sequence"),hb=js("attach-store"),ie=js("local-store"),a6=js("metadata-store"),ff=js("attach-seq-store"),hD=new je.Map,T=new fZ,a2=1,il="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+ft+" (seq, deleted)",hm="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+ft+" (doc_id, rev)",gS="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+jj+" (winningseq)",fl="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+ff+" (seq)",J="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+ff+" (digest, seq)",jf=ft+".seq = "+jj+".winningseq",f=ft+".seq AS seq, "+ft+".deleted AS deleted, "+ft+".json AS data, "+ft+".rev AS rev, "+jj+".json AS metadata";ev.valid=fg,ev.use_prefix=!0;var U=jw(),jb=function(){},iR=25,hP=50,ir={},jp=1800,iG=hx("pouchdb:http");P.valid=function(){return !0},an.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},an.prototype.finish=function(){return this.promise};var en=function(t,aa){return aa&&t.then(function(ab){g0.nextTick(function(){aa(null,ab)})},function(ab){g0.nextTick(function(){aa(ab)})}),t},B=function(t){return ij(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&en(ab,aa),ab})},dr=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},p=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},K=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},hp={},iK=new an,jr=50,ia=h2.bind(null,"log"),iY={_sum:function(t,aa){return gY(aa)},_count:function(t,aa){return aa.length},_stats:function(ab,t){function aa(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:gY(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},fk=B(function(){var t=this;return"http"===t.type()?iA(t):"function"==typeof t._viewCleanup?fj(t):fe(t)}),jz=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?fT(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=i5.resolve().then(function(){return ei(ac,ab,ad)});return en(aa,t),aa};hK(k,Error),hK(ai,Error),hK(gP,Error);var hu={query:jz,viewCleanup:fk},C=1,gU="pouchdb",hC=5,hh=0;a5.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},a5.prototype.updateTarget=function(t,aa){return iF(this.target,this.id,t,aa,this.returnValue)},a5.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?i5.resolve(!0):iF(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){if(fr(ac)){return aa.readOnlySource=!0,!0}throw ac})};var ic={undefined:function(t,aa){return 0===gw.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return jC(aa,t).last_seq}};a5.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?i5.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return hh}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in ic?ic[ab](aa,ac):hh},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:hh}).then(function(){return hh},function(ac){return fr(ac)?(t.readOnlySource=!0,aa.last_seq):hh})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return hh})};var hj=0;hK(i8,he.EventEmitter),i8.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},i8.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))},hK(gD,he.EventEmitter),gD.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},hE.plugin(jx).plugin(fY).plugin(n).plugin(hu).plugin(hw),b.exports=hE}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var g="color: "+this.color;k=[k[0],g,"color: inherit"].concat(Array.prototype.slice.call(k,1));var f=0,j=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),k.splice(j,0,g),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(u,o,e){function i(){return e.colors[a++%e.colors.length]}function f(k){function h(){}function g(){var m=g,w=+new Date,l=w-(t||w);m.diff=l,m.prev=t,m.curr=w,t=w,null==m.useColors&&(m.useColors=e.useColors()),null==m.color&&m.useColors&&(m.color=i());var q=Array.prototype.slice.call(arguments);q[0]=e.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=e.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof e.formatArgs&&(q=e.formatArgs.apply(m,q));var p=g.log||e.log||console.log.bind(console);p.apply(m,q)}h.enabled=!1,g.enabled=!0;var j=e.enabled(k)?g:h;return j.namespace=k,j}function b(g){e.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?e.skips.push(new RegExp("^"+g.substr(1)+"$")):e.names.push(new RegExp("^"+g+"$")))}}function s(){e.enable("")}function n(g){var j,h;for(j=0,h=e.skips.length;h>j;j++){if(e.skips[j].test(g)){return !1}}for(j=0,h=e.names.length;h>j;j++){if(e.names[j].test(g)){return !0}}return !1}function r(g){return g instanceof Error?g.stack||g.message:g}e=o.exports=f,e.coerce=r,e.disable=s,e.enable=b,e.enabled=n,e.humanize=u(11),e.names=[],e.skips=[],e.formatters={};var t,a=0},{11:11}],7:[function(a,b,e){(function(s){function z(){u=!0;for(var h,j,g=y.length;g;){for(j=y,y=[],h=-1;++h<g;){j[h]()}g=y.length}u=!1}function l(g){1!==y.push(g)||u||i()}var i,x=s.MutationObserver||s.WebKitMutationObserver;if(x){var r=0,n=new x(z),o=s.document.createTextNode("");n.observe(o,{characterData:!0}),i=function(){o.data=r=++r%2}}else{if(s.setImmediate||"undefined"==typeof s.MessageChannel){i="document" in s&&"onreadystatechange" in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){z(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(z,0)}}else{var f=new s.MessageChannel;f.port1.onmessage=z,i=function(){f.port2.postMessage(0)}}}var u,y=[];b.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(a,b,e){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(i,u,r){function l(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=m,this.queue=[],this.outcome=void 0,g!==l&&y(this,g)}function b(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function h(j,k,g){f(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function a(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=s(g);"error"===z.status&&w(z.value)}function s(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function o(g){return g instanceof this?g:K.resolve(new this(l),g)}function t(g){var j=new this(l);return K.reject(j,g)}function p(A){function z(E,D){function C(F){g[D]=F,++k!==x||q||(q=!0,K.resolve(j,g))}w.resolve(E).then(C,function(F){q||(q=!0,K.reject(j,F))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(A)){return this.reject(new TypeError("must be an array"))}var x=A.length,q=!1;if(!x){return this.resolve([])}for(var g=new Array(x),k=0,B=-1,j=new this(l);++B<x;){z(A[B],B)}return j}function n(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(l);++z<g;){q(j[z])}return k}var f=i(7),K={},L=["REJECTED"],e=["FULFILLED"],m=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===e||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(l);if(this.state!==m){var j=this.state===e?k:q;h(g,j,this.outcome)}else{this.queue.push(new b(g,k,q))}return g},b.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){K.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=s(a,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=e,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},v.resolve=o,v.reject=t,v.all=p,v.race=n},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(h,l,D){function s(q){if(null!==q){switch(typeof q){case"boolean":return q?1:0;case"number":return i(q);case"string":return q.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var g=Array.isArray(q),m=g?q:Object.keys(q),v=-1,j=m.length,w="";if(g){for(;++v<j;){w+=D.toIndexableString(m[v])}}else{for(;++v<j;){var k=m[v];w+=D.toIndexableString(k)+D.toIndexableString(q[k])}}return w}}return""}function o(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+a),x=parseInt(v,10)+e;for(j&&(x=-x),w+=a;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function r(m,v){var g=m.pop();if(v.length){var w=v[v.length-1];g===w.element&&(v.pop(),w=v[v.length-1]);var j=w.element,q=w.index;if(Array.isArray(j)){j.push(g)}else{if(q===m.length-2){var k=m.pop();j[k]=g}else{m.push(g)}}}}function b(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=D.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(q,g){for(var m=Object.keys(q),v=Object.keys(g),j=Math.min(m.length,v.length),w=0;j>w;w++){var k=D.collate(m[w],v[w]);if(0!==k){return k}if(k=D.collate(q[m[w]],g[v[w]]),0!==k){return k}}return m.length===v.length?0:m.length>v.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(g){if(0===g){return"1"}var w=g.toExponential().split(/e\+?/),k=parseInt(w[1],10),q=0>g,m=q?"0":"2",j=(q?-k:k)-e,y=p.padLeft(j.toString(),"0",a);m+=u+y;var v=Math.abs(parseFloat(w[0]));q&&(v=10-v);var x=v.toFixed(20);return x=x.replace(/\.?0+$/,""),m+=u+x}var e=-324,a=3,u="",p=h(13);D.collate=function(j,m){if(j===m){return 0}j=D.normalizeKey(j),m=D.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},D.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=D.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=D.normalizeKey(m))}}}}}return g},D.toIndexableString=function(g){var j="\x00";return g=D.normalizeKey(g),n(g)+u+s(g)+j},D.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=o(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}r(w,m)}}}},{13:13}],13:[function(b,h,a){function e(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var o,f=n.length,g=r.length;for(o=0;f>o;o++){if(o===g){return 1}var q=n.charAt(o),i=r.charAt(o);if(q!==i){return i>q?-1:1}}return g>f?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(o,p){var q,g,n,r;g=[],r=[];for(q in p){h.call(p,q)&&(n=p[q],"this"!==q&&(g.push(q),r.push(n)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],r)}}).call(this)},{}],16:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(t){function r(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function Q(j,w,k,q,A,z,x){return r(w&k|~w&q,j,w,A,z,x)}function p(j,w,k,q,A,z,x){return r(w&q|k&~q,j,w,A,z,x)}function o(j,w,k,q,A,z,x){return r(w^k^q,j,w,A,z,x)}function v(j,w,k,q,A,z,x){return r(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=Q(z,k,x,q,w[0],7,-680876936),q=Q(q,z,k,x,w[1],12,-389564586),x=Q(x,q,z,k,w[2],17,606105819),k=Q(k,x,q,z,w[3],22,-1044525330),z=Q(z,k,x,q,w[4],7,-176418897),q=Q(q,z,k,x,w[5],12,1200080426),x=Q(x,q,z,k,w[6],17,-1473231341),k=Q(k,x,q,z,w[7],22,-45705983),z=Q(z,k,x,q,w[8],7,1770035416),q=Q(q,z,k,x,w[9],12,-1958414417),x=Q(x,q,z,k,w[10],17,-42063),k=Q(k,x,q,z,w[11],22,-1990404162),z=Q(z,k,x,q,w[12],7,1804603682),q=Q(q,z,k,x,w[13],12,-40341101),x=Q(x,q,z,k,w[14],17,-1502002290),k=Q(k,x,q,z,w[15],22,1236535329),z=p(z,k,x,q,w[1],5,-165796510),q=p(q,z,k,x,w[6],9,-1069501632),x=p(x,q,z,k,w[11],14,643717713),k=p(k,x,q,z,w[0],20,-373897302),z=p(z,k,x,q,w[5],5,-701558691),q=p(q,z,k,x,w[10],9,38016083),x=p(x,q,z,k,w[15],14,-660478335),k=p(k,x,q,z,w[4],20,-405537848),z=p(z,k,x,q,w[9],5,568446438),q=p(q,z,k,x,w[14],9,-1019803690),x=p(x,q,z,k,w[3],14,-187363961),k=p(k,x,q,z,w[8],20,1163531501),z=p(z,k,x,q,w[13],5,-1444681467),q=p(q,z,k,x,w[2],9,-51403784),x=p(x,q,z,k,w[7],14,1735328473),k=p(k,x,q,z,w[12],20,-1926607734),z=o(z,k,x,q,w[5],4,-378558),q=o(q,z,k,x,w[8],11,-2022574463),x=o(x,q,z,k,w[11],16,1839030562),k=o(k,x,q,z,w[14],23,-35309556),z=o(z,k,x,q,w[1],4,-1530992060),q=o(q,z,k,x,w[4],11,1272893353),x=o(x,q,z,k,w[7],16,-155497632),k=o(k,x,q,z,w[10],23,-1094730640),z=o(z,k,x,q,w[13],4,681279174),q=o(q,z,k,x,w[0],11,-358537222),x=o(x,q,z,k,w[3],16,-722521979),k=o(k,x,q,z,w[6],23,76029189),z=o(z,k,x,q,w[9],4,-640364487),q=o(q,z,k,x,w[12],11,-421815835),x=o(x,q,z,k,w[15],16,530742520),k=o(k,x,q,z,w[2],23,-995338651),z=v(z,k,x,q,w[0],6,-198630844),q=v(q,z,k,x,w[7],10,1126891415),x=v(x,q,z,k,w[14],15,-1416354905),k=v(k,x,q,z,w[5],21,-57434055),z=v(z,k,x,q,w[12],6,1700485571),q=v(q,z,k,x,w[3],10,-1894986606),x=v(x,q,z,k,w[10],15,-1051523),k=v(k,x,q,z,w[1],21,-2054922799),z=v(z,k,x,q,w[8],6,1873313359),q=v(q,z,k,x,w[15],10,-30611744),x=v(x,q,z,k,w[6],15,-1560198380),k=v(k,x,q,z,w[13],21,1309151649),z=v(z,k,x,q,w[4],6,-145523070),q=v(q,z,k,x,w[11],10,-1120210379),x=v(x,q,z,k,w[2],15,718787259),k=v(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function y(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function O(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function s(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,y(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function P(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,O(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function u(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function n(j){var k;for(k=0;k<j.length;k+=1){j[k]=u(j[k])}return j.join("")}function l(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function m(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==n(s("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(C,k){var w,x,D,A,q=this.byteLength,B=j(C,q),z=q;return k!==t&&(z=j(k,q)),B>z?new ArrayBuffer(0):(w=z-B,x=new ArrayBuffer(w),D=new Uint8Array(x),A=new Uint8Array(this,B,w),D.set(A),x)}}(),m.prototype.append=function(j){return this.appendBinary(l(j)),this},m.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,y(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},m.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},m.hash=function(j,k){return m.hashBinary(l(j),k)},m.hashBinary=function(j,w){var q=s(j),k=n(q);return w?e(k):k},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,O(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var j=m.prototype.getState.call(this);return j.buff=S(j.buff),j},m.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),m.prototype.setState.call(this,j)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(j,w){var q=P(new Uint8Array(j)),k=n(q);return w?e(k):k},m})},{}],17:[function(b,h,a){function e(n,r,o){var f=o[o.length-1];n===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,q=f.index;if(Array.isArray(g)){g.push(n)}else{if(q===r.length-2){var i=r.pop();g[i]=n}else{r.push(n)}}}a.stringify=function(f){var u=[];u.push({obj:f});for(var E,D,i,n,g,F,s,t,l,o,r,C="";E=u.pop();){if(D=E.obj,i=E.prefix||"",n=E.val||"",C+=i,n){C+=n}else{if("object"!=typeof D){C+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){C+="null"}else{if(Array.isArray(D)){for(u.push({val:"]"}),g=D.length-1;g>=0;g--){F=0===g?"":",",u.push({obj:D[g],prefix:F})}u.push({val:"["})}else{s=[];for(t in D){D.hasOwnProperty(t)&&s.push(t)}for(u.push({val:"}"}),g=s.length-1;g>=0;g--){l=s[g],o=D[l],r=g>0?",":"",r+=JSON.stringify(l)+":",u.push({obj:o,prefix:r})}u.push({val:"{"})}}}}}return C},a.parse=function(B){for(var C,t,D,A,l,s,g,i,n,u=[],f=[],o=0;;){if(C=B[o++],"}"!==C&&"]"!==C&&"undefined"!=typeof C){switch(C){case" ":case"	":case"\n":case":":case",":break;case"n":o+=3,e(null,u,f);break;case"t":o+=3,e(!0,u,f);break;case"f":o+=4,e(!1,u,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(t="",o--;;){if(D=B[o++],!/[\d\.\-e\+]/.test(D)){o--;break}t+=D}e(parseFloat(t),u,f);break;case'"':for(A="",l=void 0,s=0;;){if(g=B[o++],'"'===g&&("\\"!==l||s%2!==1)){break}A+=g,l=g,"\\"===l?s++:s=0}e(JSON.parse('"'+A+'"'),u,f);break;case"[":i={element:[],index:u.length},u.push(i.element),f.push(i);break;case"{":n={element:{},index:u.length},u.push(n.element),f.push(n);break;default:throw new Error("unexpectedly reached end of input: "+C)}}else{if(1===u.length){return u.pop()}e(u.pop(),u,f)}}}},{}]},{},[3])(3)});