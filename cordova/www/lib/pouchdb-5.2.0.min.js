!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(a,i,b){function l(f,j){if(!i[f]){if(!a[f]){var n="function"==typeof require&&require;if(!j&&n){return n(f,!0)}if(e){return e(f,!0)}var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var h=i[f]={exports:{}};a[f][0].call(h.exports,function(m){var p=a[f][1][m];return l(p?p:m)},h,h.exports,d,a,i,b)}return i[f].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){l(b[k])}return l}({1:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var j=arguments,f=this.useColors;if(j[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+j[0]+(f?"%c ":" ")+"+"+p.humanize(this.diff),!f){return j}var k="color: "+this.color;j=[j[0],k,"color: inherit"].concat(Array.prototype.slice.call(j,1));var h=0,g=0;return j[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(h++,"%c"===l&&(g=h))}),j.splice(g,0,k),j}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(n,b,s){function u(){return s.colors[o++%s.colors.length]}function t(j){function g(){}function k(){var q=k,m=+new Date,p=m-(i||m);q.diff=p,q.prev=i,q.curr=m,i=m,null==q.useColors&&(q.useColors=s.useColors()),null==q.color&&q.useColors&&(q.color=u());var l=Array.prototype.slice.call(arguments);l[0]=s.coerce(l[0]),"string"!=typeof l[0]&&(l=["%o"].concat(l));var w=0;l[0]=l[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}w++;var x=s.formatters[A];if("function"==typeof x){var z=l[w];y=x.call(q,z),l.splice(w,1),w--}return y}),"function"==typeof s.formatArgs&&(l=s.formatArgs.apply(q,l));var v=k.log||s.log||console.log.bind(console);v.apply(q,l)}g.enabled=!1,k.enabled=!0;var h=s.enabled(j)?k:g;return h.namespace=j,h}function r(k){s.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?s.skips.push(new RegExp("^"+k.substr(1)+"$")):s.names.push(new RegExp("^"+k+"$")))}}function f(){s.enable("")}function a(g){var j,h;for(j=0,h=s.skips.length;h>j;j++){if(s.skips[j].test(g)){return !1}}for(j=0,h=s.names.length;h>j;j++){if(s.names[j].test(g)){return !0}}return !1}function e(g){return g instanceof Error?g.stack||g.message:g}s=b.exports=t,s.coerce=e,s.disable=f,s.enable=r,s.enabled=a,s.humanize=n(9),s.names=[],s.skips=[],s.formatters={};var i,o=0},{9:9}],4:[function(e,a,n){function m(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function b(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}a.exports=m,m.EventEmitter=m,m.prototype._events=void 0,m.prototype._maxListeners=void 0,m.defaultMaxListeners=10,m.prototype.setMaxListeners=function(f){if(!b(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},m.prototype.emit=function(f){var k,j,g,l,h,r;if(this._events||(this._events={}),"error"===f&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(j=this._events[f],p(j)){return !1}if(o(j)){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),j.apply(this,l)}}else{if(i(j)){for(l=Array.prototype.slice.call(arguments,1),r=j.slice(),g=r.length,h=0;g>h;h++){r[h].apply(this,l)}}}return !0},m.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?m.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},m.prototype.on=m.prototype.addListener,m.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},m.prototype.removeListener=function(l,j){var k,f,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[l]){return this}if(k=this._events[l],h=k.length,f=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,j)}else{if(i(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){f=g;break}}if(0>f){return this}1===k.length?(k.length=0,delete this._events[l]):k.splice(f,1),this._events.removeListener&&this.emit("removeListener",l,j)}}return this},m.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},m.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},m.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},m.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(e,a,b){(function(i){function r(){l=!0;for(var j,g,h=o.length;h;){for(g=o,o=[],j=-1;++j<h;){g[j]()}h=o.length}l=!1}function x(g){1!==o.push(g)||l||u()}var u,n=i.MutationObserver||i.WebKitMutationObserver;if(n){var f=0,y=new n(r),z=i.document.createTextNode("");y.observe(z,{characterData:!0}),u=function(){z.data=f=++f%2}}else{if(i.setImmediate||"undefined"==typeof i.MessageChannel){u="document" in i&&"onreadystatechange" in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){r(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(r,0)}}else{var s=new i.MessageChannel;s.port1.onmessage=r,u=function(){s.port2.postMessage(0)}}}var l,o=[];a.exports=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(e,a,b){(function(f){f("object"==typeof b?b:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(n){if(n){for(var i in n){"object"==typeof n[i]&&h[i]?k.call(h,h[i],n[i]):h[i]=n[i]}}}),h};j.extend=k})},{}],8:[function(o,u,s){function n(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=h,this.queue=[],this.outcome=void 0,g!==n&&y(this,g)}function a(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function e(j,k,g){i(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function p(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=l(j);"error"===z.status&&w(z.value)}function l(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function r(g){return g instanceof this?g:K.resolve(new this(n),g)}function f(g){var j=new this(n);return K.reject(j,g)}function m(B){function A(E,D){function C(F){w[D]=F,++z!==k||g||(g=!0,K.resolve(x,w))}j.resolve(E).then(C,function(F){g||(g=!0,K.reject(x,F))})}var j=this;if("[object Array]"!==Object.prototype.toString.call(B)){return this.reject(new TypeError("must be an array"))}var k=B.length,g=!1;if(!k){return this.resolve([])}for(var w=new Array(k),z=0,q=-1,x=new this(n);++q<k;){A(B[q],q)}return x}function t(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(n);++z<j;){g(k[z])}return q}var i=o(5),K={},L=["REJECTED"],b=["FULFILLED"],h=["PENDING"];u.exports=s=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===b||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(n);if(this.state!==h){var k=this.state===b?q:g;e(j,k,this.outcome)}else{this.queue.push(new a(j,q,g))}return j},a.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){e(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){K.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){e(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=l(p,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=b,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},s.resolve=r,s.reject=f,s.all=m,s.race=t},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(p,s,h){function n(m){if(null!==m){switch(typeof m){case"boolean":return m?1:0;case"number":return a(m);case"string":return m.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var j=Array.isArray(m),w=j?m:Object.keys(m),q=-1,v=w.length,k="";if(j){for(;++q<v;){k+=h.toIndexableString(w[q])}}else{for(;++q<v;){var g=w[q];k+=h.toIndexableString(g)+h.toIndexableString(m[g])}}return k}}return""}function i(q,g){var w,y=g,x="1"===q[g];if(x){w=0,g++}else{var v="0"===q[g];g++;var k="",z=q.substring(g,g+o),j=parseInt(z,10)+t;for(v&&(j=-j),g+=o;;){var m=q[g];if("\x00"===m){break}k+=m,g++}k=k.split("."),w=1===k.length?parseInt(k,10):parseFloat(k[0]+"."+k[1]),v&&(w-=10),0!==j&&(w=parseFloat(w+"e"+j))}return{num:w,length:g-y}}function r(w,q){var j=w.pop();if(q.length){var g=q[q.length-1];j===g.element&&(q.pop(),g=q[q.length-1]);var v=g.element,k=g.index;if(Array.isArray(v)){v.push(j)}else{if(k===w.length-2){var m=w.pop();v[m]=j}else{w.push(j)}}}}function D(k,q){for(var m=Math.min(k.length,q.length),j=0;m>j;j++){var g=h.collate(k[j],q[j]);if(0!==g){return g}}return k.length===q.length?0:k.length>q.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(m,j){for(var w=Object.keys(m),q=Object.keys(j),v=Math.min(w.length,q.length),k=0;v>k;k++){var g=h.collate(w[k],q[k]);if(0!==g){return g}if(g=h.collate(m[w[k]],j[q[k]]),0!==g){return g}}return w.length===q.length?0:w.length>q.length?1:-1}function b(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(v){if(0===v){return"1"}var k=v.toExponential().split(/e\+?/),x=parseInt(k[1],10),g=0>v,y=g?"0":"2",w=(g?-x:x)-t,q=l.padLeft(w.toString(),"0",o);y+=f+q;var j=Math.abs(parseFloat(k[0]));g&&(j=10-j);var m=j.toFixed(20);return m=m.replace(/\.?0+$/,""),y+=f+m}var t=-324,o=3,f="",l=p(11);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=b(j),g=b(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?D(j,m):u(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=h.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=h.normalizeKey(v))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),b(g)+f+n(g)+j},h.parseIndexableString=function(q){for(var g=[],x=[],y=0;;){var k=q[y++];if("\x00"!==k){switch(k){case"1":g.push(null);break;case"2":g.push("1"===q[y]),y++;break;case"3":var z=i(q,y);g.push(z.num),y+=z.length;break;case"4":for(var j="";;){var m=q[y];if("\x00"===m){break}j+=m,y++}j=j.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),g.push(j);break;case"5":var v={element:[],index:g.length};g.push(v.element),x.push(v);break;case"6":var w={element:{},index:g.length};g.push(w.element),x.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+k)}}else{if(1===g.length){return g.pop()}r(g,x)}}}},{11:11}],11:[function(h,b,e){function a(n,g,l){for(var f="",m=l-n.length;f.length<m;){f+=g}return f}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(g,r){var i,n=g.length,o=r.length;for(i=0;n>i;i++){if(i===o){return 1}var q=g.charAt(i),f=r.charAt(i);if(q!==f){return f>q?-1:1}}return o>n?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(a,e,i){function b(){this.store={}}function j(g){if(this.store=new b,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}i.Map=b,i.Set=j,b.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},b.prototype.unmangle=function(f){return f.substring(1)},b.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},b.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},b.prototype.has=function(f){var g=this.mangle(f);return g in this.store},b.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},b.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},j.prototype.add=function(f){return this.store.set(f,!0)},j.prototype.has=function(f){return this.store.has(f)},j.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(s,p){var q,g,o,r;g=[],r=[];for(q in p){h.call(p,q)&&(o=p[q],"this"!==q&&(g.push(q),r.push(o)))}return Function.apply(null,f.call(g).concat([s])).apply(p["this"],r)}}).call(this)},{}],15:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(p){function v(q,w,z,j,k,x){return w=u(u(w,q),u(j,x)),u(w<<k|w>>>32-k,z)}function o(j,A,k,w,x,z,q){return v(A&k|~A&w,j,A,x,z,q)}function n(j,A,k,w,x,z,q){return v(A&w|k&~w,j,A,x,z,q)}function r(j,A,k,w,x,z,q){return v(A^k^w,j,A,x,z,q)}function O(j,A,k,w,x,z,q){return v(k^(A|~w),j,A,x,z,q)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=o(z,j,x,k,w[0],7,-680876936),k=o(k,z,j,x,w[1],12,-389564586),x=o(x,k,z,j,w[2],17,606105819),j=o(j,x,k,z,w[3],22,-1044525330),z=o(z,j,x,k,w[4],7,-176418897),k=o(k,z,j,x,w[5],12,1200080426),x=o(x,k,z,j,w[6],17,-1473231341),j=o(j,x,k,z,w[7],22,-45705983),z=o(z,j,x,k,w[8],7,1770035416),k=o(k,z,j,x,w[9],12,-1958414417),x=o(x,k,z,j,w[10],17,-42063),j=o(j,x,k,z,w[11],22,-1990404162),z=o(z,j,x,k,w[12],7,1804603682),k=o(k,z,j,x,w[13],12,-40341101),x=o(x,k,z,j,w[14],17,-1502002290),j=o(j,x,k,z,w[15],22,1236535329),z=n(z,j,x,k,w[1],5,-165796510),k=n(k,z,j,x,w[6],9,-1069501632),x=n(x,k,z,j,w[11],14,643717713),j=n(j,x,k,z,w[0],20,-373897302),z=n(z,j,x,k,w[5],5,-701558691),k=n(k,z,j,x,w[10],9,38016083),x=n(x,k,z,j,w[15],14,-660478335),j=n(j,x,k,z,w[4],20,-405537848),z=n(z,j,x,k,w[9],5,568446438),k=n(k,z,j,x,w[14],9,-1019803690),x=n(x,k,z,j,w[3],14,-187363961),j=n(j,x,k,z,w[8],20,1163531501),z=n(z,j,x,k,w[13],5,-1444681467),k=n(k,z,j,x,w[2],9,-51403784),x=n(x,k,z,j,w[7],14,1735328473),j=n(j,x,k,z,w[12],20,-1926607734),z=r(z,j,x,k,w[5],4,-378558),k=r(k,z,j,x,w[8],11,-2022574463),x=r(x,k,z,j,w[11],16,1839030562),j=r(j,x,k,z,w[14],23,-35309556),z=r(z,j,x,k,w[1],4,-1530992060),k=r(k,z,j,x,w[4],11,1272893353),x=r(x,k,z,j,w[7],16,-155497632),j=r(j,x,k,z,w[10],23,-1094730640),z=r(z,j,x,k,w[13],4,681279174),k=r(k,z,j,x,w[0],11,-358537222),x=r(x,k,z,j,w[3],16,-722521979),j=r(j,x,k,z,w[6],23,76029189),z=r(z,j,x,k,w[9],4,-640364487),k=r(k,z,j,x,w[12],11,-421815835),x=r(x,k,z,j,w[15],16,530742520),j=r(j,x,k,z,w[2],23,-995338651),z=O(z,j,x,k,w[0],6,-198630844),k=O(k,z,j,x,w[7],10,1126891415),x=O(x,k,z,j,w[14],15,-1416354905),j=O(j,x,k,z,w[5],21,-57434055),z=O(z,j,x,k,w[12],6,1700485571),k=O(k,z,j,x,w[3],10,-1894986606),x=O(x,k,z,j,w[10],15,-1051523),j=O(j,x,k,z,w[1],21,-2054922799),z=O(z,j,x,k,w[8],6,1873313359),k=O(k,z,j,x,w[15],10,-30611744),x=O(x,k,z,j,w[6],15,-1560198380),j=O(j,x,k,z,w[13],21,1309151649),z=O(z,j,x,k,w[4],6,-145523070),k=O(k,z,j,x,w[11],10,-1120210379),x=O(x,k,z,j,w[2],15,718787259),j=O(j,x,k,z,w[9],21,-343485551),q[0]=u(z,q[0]),q[1]=u(j,q[1]),q[2]=u(x,q[2]),q[3]=u(k,q[3])}function t(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function P(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function l(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,t(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function s(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,P(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function Q(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function m(j){var k;for(k=0;k<j.length;k+=1){j[k]=Q(j[k])}return j.join("")}function y(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function i(){this.reset()}var u=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(l("hello"))&&(u=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(D,x){var k,A,B,q,z=this.byteLength,C=j(D,z),w=z;return x!==p&&(w=j(x,z)),C>w?new ArrayBuffer(0):(k=w-C,A=new ArrayBuffer(k),B=new Uint8Array(A),q=new Uint8Array(this,C,k),B.set(q),A)}}(),i.prototype.append=function(j){return this.appendBinary(y(j)),this},i.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,t(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},i.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},i.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},i.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},i.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},i.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},i.hash=function(j,k){return i.hashBinary(y(j),k)},i.hashBinary=function(q,w){var k=l(q),j=m(k);return w?e(j):j},i.ArrayBuffer=function(){this.reset()},i.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,P(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},i.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},i.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},i.ArrayBuffer.prototype.getState=function(){var j=i.prototype.getState.call(this);return j.buff=S(j.buff),j},i.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),i.prototype.setState.call(this,j)},i.ArrayBuffer.prototype.destroy=i.prototype.destroy,i.ArrayBuffer.prototype._finish=i.prototype._finish,i.ArrayBuffer.hash=function(q,w){var k=s(new Uint8Array(q)),j=m(k);return w?e(j):j},i})},{}],16:[function(h,b,e){function a(g,r,i){var n=i[i.length-1];g===n.element&&(i.pop(),n=i[i.length-1]);var o=n.element,q=n.index;if(Array.isArray(o)){o.push(g)}else{if(q===r.length-2){var f=r.pop();o[f]=g}else{r.push(g)}}}e.stringify=function(C){var i=[];i.push({obj:C});for(var t,u,g,n,s,f,r,D,E,o,l,F="";t=i.pop();){if(u=t.obj,g=t.prefix||"",n=t.val||"",F+=g,n){F+=n}else{if("object"!=typeof u){F+="undefined"==typeof u?null:JSON.stringify(u)}else{if(null===u){F+="null"}else{if(Array.isArray(u)){for(i.push({val:"]"}),s=u.length-1;s>=0;s--){f=0===s?"":",",i.push({obj:u[s],prefix:f})}i.push({val:"["})}else{r=[];for(D in u){u.hasOwnProperty(D)&&r.push(D)}for(i.push({val:"}"}),s=r.length-1;s>=0;s--){E=r[s],o=u[E],l=s>0?",":"",l+=JSON.stringify(E)+":",i.push({obj:o,prefix:l})}i.push({val:"{"})}}}}}return F},e.parse=function(C){for(var n,u,B,l,s,i,D,t,f,o=[],A=[],g=0;;){if(n=C[g++],"}"!==n&&"]"!==n&&"undefined"!=typeof n){switch(n){case" ":case"	":case"\n":case":":case",":break;case"n":g+=3,a(null,o,A);break;case"t":g+=3,a(!0,o,A);break;case"f":g+=4,a(!1,o,A);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(u="",g--;;){if(B=C[g++],!/[\d\.\-e\+]/.test(B)){g--;break}u+=B}a(parseFloat(u),o,A);break;case'"':for(l="",s=void 0,i=0;;){if(D=C[g++],'"'===D&&("\\"!==s||i%2!==1)){break}l+=D,s=D,"\\"===s?i++:i=0}a(JSON.parse('"'+l+'"'),o,A);break;case"[":t={element:[],index:o.length},o.push(t.element),A.push(t);break;case"{":f={element:{},index:o.length},o.push(f.element),A.push(f);break;default:throw new Error("unexpectedly reached end of input: "+n)}}else{if(1===o.length){return o.pop()}a(o.pop(),o,A)}}}},{}],17:[function(e,a,b){(function(O,X){function U(aa,ac){aa=aa||[],ac=ac||{};try{return new Blob(aa,ac)}catch(ad){if("TypeError"!==ad.name){throw ad}for(var ab="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,t=new ab,af=0;af<aa.length;af+=1){t.append(aa[af])}return t.getBlob(ac.type)}}function hY(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function f4(){for(var t={},ab=new gy(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,gy.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function iv(aa,af){var ad,ab,t,ac=new Headers,ag={method:aa.method,credentials:"include",headers:ac};return aa.json&&(ac.set("Accept","application/json"),ac.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?hY(aa.body,function(ah){ag.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?ag.body=JSON.stringify(aa.body):"body" in aa?ag.body=aa.body:ag.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ac.set(ah,aa.headers[ah])}),ad=f4(aa.url,ag),aa.timeout>0&&(ab=setTimeout(function(){ad.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ad.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?af(null,t,ah):af(ah,t)})["catch"](function(ah){af(ah,t)}),{abort:ad.reject}}function iC(t,ac){var ad,aa,ag=function(){ad.abort()};ad=t.xhr?new t.xhr:new XMLHttpRequest;try{ad.open(t.method,t.url)}catch(ab){ac(ab,{statusCode:413})}ad.withCredentials="withCredentials" in t?t.withCredentials:!0,"GET"===t.method?delete t.headers["Content-Type"]:t.json&&(t.headers.Accept="application/json",t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.body&&t.processData&&"string"!=typeof t.body&&(t.body=JSON.stringify(t.body))),t.binary&&(ad.responseType="arraybuffer"),"body" in t||(t.body=null);for(var af in t.headers){t.headers.hasOwnProperty(af)&&ad.setRequestHeader(af,t.headers[af])}return t.timeout>0&&(aa=setTimeout(ag,t.timeout),ad.onprogress=function(){clearTimeout(aa),aa=setTimeout(ag,t.timeout)},"undefined"!=typeof ad.upload&&(ad.upload.onprogress=ad.onprogress)),ad.onreadystatechange=function(){if(4===ad.readyState){var al={statusCode:ad.status};if(ad.status>=200&&ad.status<300){var aj;aj=t.binary?U([ad.response||""],{type:ad.getResponseHeader("Content-Type")}):ad.responseText,ac(null,al,aj)}else{var ak={};try{ak=JSON.parse(ad.response)}catch(ah){}ac(ak,al)}}},t.body&&t.body instanceof Blob?hY(t.body,function(ah){ad.send(ah)}):ad.send(t.body),{abort:ag}}function gk(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function gJ(aa,t){return fW||aa.xhr?iC(aa,t):iv(aa,t)}function a2(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gx(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=a2.prototype,new aa(ab)}function fx(aa){var ac,ad,ab,t,af;return ad=aa.error===!0&&"string"==typeof aa.name?aa.name:aa.error,af=aa.reason,ab=hx("name",ad,af),aa.missing||"missing"===af||"deleted"===af||"not_found"===ad?ab=gD:"doc_validation"===ad?(ab=gl,t=af):"bad_request"===ad&&ab.message!==af&&(ab=ei),ab||(ab=hx("status",aa.status,af)||iY),ac=gx(ab,af,ad),t&&(ac.message=t),aa.id&&(ac.id=aa.id),aa.status&&(ac.status=aa.status),aa.missing&&(ac.missing=aa.missing),ac}function k(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function gd(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function p(t){if(t instanceof ArrayBuffer){return gd(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function ho(aa){var ac,ad,ab;if(!aa||"object"!=typeof aa){return aa}if(Array.isArray(aa)){for(ac=[],ad=0,ab=aa.length;ab>ad;ad++){ac[ad]=ho(aa[ad])}return ac}if(aa instanceof Date){return aa.toISOString()}if(k(aa)){return p(aa)}ac={};for(ad in aa){if(Object.prototype.hasOwnProperty.call(aa,ad)){var t=ho(aa[ad]);"undefined"!=typeof t&&(ac[ad]=t)}}return ac}function N(){return""}function fk(aa,ac){function ad(af,ag,aj){if(!aa.binary&&aa.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?fx(ak):ak})),aa.binary&&gn(af,ag),aj(null,af,ag)}function ab(aj,al){var ag,ak;if(aj.code&&aj.status){var ah=new Error(aj.message||aj.code);return ah.status=aj.status,al(ah)}try{ag=JSON.parse(aj.responseText),ak=fx(ag)}catch(af){ak=fx(aj)}al(ak)}aa=ho(aa);var t={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return aa=ez.extend(t,aa),aa.json&&(aa.binary||(aa.headers.Accept="application/json"),aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json"),aa.binary&&(aa.encoding=null,aa.json=!1),aa.processData||(aa.json=!1),gJ(aa,function(ah,al,af){if(ah){return ah.status=al?al.statusCode:400,ab(ah,ac)}var ak,am=al.headers&&al.headers["content-type"],ag=af||N();if(!aa.binary&&(aa.json||!aa.processData)&&"object"!=typeof ag&&(/json/.test(am)||/^[\s]*\{/.test(ag)&&/\}[\s]*$/.test(ag))){try{ag=JSON.parse(ag.toString())}catch(aj){}}al.statusCode>=200&&al.statusCode<300?ad(ag,al,ac):(ak=fx(ag),ak.status=al.statusCode,ac(ak))})}function f6(ac,aa){var af=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ah=-1!==af.indexOf("safari")&&-1===af.indexOf("chrome"),ag=-1!==af.indexOf("msie"),ab=ah&&"POST"===ac.method||ag&&"GET"===ac.method,ad="cache" in ac?ac.cache:!0;if(ab||!ad){var t=-1!==ac.url.indexOf("?");ac.url+=(t?"&":"?")+"_nonce="+Date.now()}return fk(ac,aa)}function G(aa){var t=!1;return dt(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function f3(t){return dt(function(ac){ac=ho(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){O.nextTick(function(){ad(ag,ah)})});var af=new gy(function(al,ag){var aj;try{var ak=G(function(ap,am){ap?ag(ap):al(am)});ac.push(ak),aj=t.apply(aa,ac),aj&&"function"==typeof aj.then&&al(aj)}catch(ah){ag(ah)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gA(t,aa){function ab(aj,ad,ag){if(K.enabled){for(var ac=[aj._db_name,ad],ah=0;ah<ag.length-1;ah++){ac.push(ag[ah])}K.apply(null,ac);var af=ag[ag.length-1];ag[ag.length-1]=function(ak,am){var al=[aj._db_name,ad];al=al.concat(ak?["error",ak]:["success",am]),K.apply(null,al),af(ak,am)}}}return f3(dt(function(ad){if(this._closed){return gy.reject(new Error("database is closed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new gy(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function fR(aa,ac){for(var ad={},ab=0,t=ac.length;t>ab;ab++){var af=ac[ab];af in aa&&(ad[af]=aa[af])}return ad}function n(t,aa,ab){return new gy(function(ad,ac){t.get(aa,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=ab(af);return aj?(aj._id=aa,aj._rev=ag,void ad(Q(t,aj,ab))):ad({updated:!1,rev:ag})})})}function Q(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return n(t,aa._id,ab)})}function cn(t){for(var ag,ac,af,ad,aa=t.rev_tree.slice();ad=aa.pop();){var aj=ad.ids,ap=aj[2],ah=ad.pos;if(ap.length){for(var ak=0,am=ap.length;am>ak;ak++){aa.push({pos:ah+1,ids:ap[ak]})}}else{var ab=!!aj[1].deleted,al=aj[0];(!ag||(af!==ab?af:ac!==ah?ah>ac:al>ag))&&(ag=al,ac=ah,af=ab)}}return ac+"-"+ag}function fe(t){return t.ids}function ij(aa,ac){ac||(ac=cn(aa));for(var ad,ab=ac.substring(ac.indexOf("-")+1),t=aa.rev_tree.map(fe);ad=t.pop();){if(ad[0]===ab){return !!ad[1].deleted}t=t.concat(ad[2])}}function h5(t){return iF("return "+t+";",{})}function de(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function L(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function F(aa){var t=L(aa);return t?t.join("/"):null}function f2(aa,aj){for(var ad,ag=aa.slice();ad=ag.pop();){for(var af=ad.pos,ac=ad.ids,ak=ac[2],ah=aj(0===ak.length,af,ac[0],ad.ctx,ac[1]),ab=0,t=ak.length;t>ab;ab++){ag.push({pos:af+1,ids:ak[ab],ctx:ah})}}}function dr(aa,t){return aa.pos-t.pos}function eu(t){var ab=[];f2(t,function(aj,ag,ad,ah,af){aj&&ab.push({rev:ag+"-"+ad,pos:ag,opts:af})}),ab.sort(dr).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function cr(t){for(var ab=cn(t),ag=eu(t.rev_tree),aa=[],ad=0,ac=ag.length;ac>ad;ad++){var af=ag[ad];af.rev===ab||af.opts.deleted||aa.push(af.rev)}return aa}function A(t,ab,ag){function aa(){ad.cancel()}a4.EventEmitter.call(this);var ad=this;this.db=t,ab=ab?ho(ab):{};var ac=ab.complete=G(function(aj,ah){aj?ad.emit("error",aj):ad.emit("complete",ah),ad.removeAllListeners(),t.removeListener("destroyed",aa)});ag&&(ad.on("complete",function(ah){ag(null,ah)}),ad.on("error",ag)),t.once("destroyed",aa),ab.onChange=function(ah){ab.isCancelled||(ad.emit("change",ah),ad.startSeq&&ad.startSeq<=ah.seq&&(ad.startSeq=!1))};var af=new gy(function(aj,ah){ab.complete=function(al,ak){al?ah(al):aj(ak)}});ad.once("cancel",function(){t.removeListener("destroyed",aa),ab.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ac(null,ah)},ac),t.taskqueue.isReady?ad.doChanges(ab):t.taskqueue.addTask(function(){ad.isCancelled?ad.emit("cancel"):ad.doChanges(ab)})}function gh(aa,ac,ad){var ab=[{rev:aa._rev}];"all_docs"===ad.style&&(ab=eu(ac.rev_tree).map(function(af){return{rev:af.rev}}));var t={id:ac.id,changes:ab,doc:aa};return ij(ac,aa._rev)&&(t.deleted=!0),ad.conflicts&&(t.doc._conflicts=cr(ac),t.doc._conflicts.length||delete t.doc._conflicts),t}function fl(t,aj,ad){function ag(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ad(null,{results:am})}function af(){++al===ak&&ag()}function ac(aq,am,ap){ab[aq]={id:am,docs:ap},af()}var aa=Array.isArray(aj)?aj:aj.docs,ah={};aa.forEach(function(am){am.id in ah?ah[am.id].push(am):ah[am.id]=[am]});var ak=Object.keys(ah).length,al=0,ab=new Array(ak);Object.keys(ah).forEach(function(aq,ap){var am=ah[aq],au=fR(am[0],["atts_since","attachments"]);au.open_revs=am.map(function(aw){return aw.rev}),au.open_revs=au.open_revs.filter(function(aw){return aw});var av=function(aw){return aw};0===au.open_revs.length&&(delete au.open_revs,av=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in aj&&(au[aw]=aj[aw])}),t.get(aq,au,function(ax,aw){ac(ap,aq,ax?[{error:ax}]:av(aw))})})}function hr(t){return/^_local/.test(t)}function E(t){for(var ag,ac=[],af=t.slice();ag=af.pop();){var ad=ag.pos,aa=ag.ids,aj=aa[0],ap=aa[1],ah=aa[2],ak=0===ah.length,am=ag.history?ag.history.slice():[];am.push({id:aj,opts:ap}),ak&&ac.push({pos:ad+1-am.length,ids:am});for(var ab=0,al=ah.length;al>ab;ab++){af.push({pos:ad+1,ids:ah[ab],history:am})}}return ac.reverse()}function a7(t){return 0|Math.random()*t}function I(t,ab){ab=ab||a5.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=a5[a7(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=a5[3&a7(16)|8];break;default:ac+=a5[a7(16)]}}return ac}function J(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(aa){var t;if(aa?"string"!=typeof aa?t=gx(g9):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=gx(ig)):t=gx(gY),t){throw t}}function a0(t){if(!/^\d+\-./.test(t)){return gx(gs)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function bn(t,ab){for(var ag=t.start-t.ids.length+1,aa=t.ids,ad=[aa[0],ab,[]],ac=1,af=aa.length;af>ac;ac++){ad=[aa[ac],{status:"missing"},[ad]]}return[{pos:ag,ids:ad}]}function ar(aa,aj){var ad,ag,af,ac={status:"available"};if(aa._deleted&&(ac.deleted=!0),aj){if(aa._id||(aa._id=I()),ag=I(32,16).toLowerCase(),aa._rev){if(af=a0(aa._rev),af.error){return af}aa._rev_tree=[{pos:af.prefix,ids:[af.id,{status:"missing"},[[ag,ac,[]]]]}],ad=af.prefix+1}else{aa._rev_tree=[{pos:1,ids:[ag,ac,[]]}],ad=1}}else{if(aa._revisions&&(aa._rev_tree=bn(aa._revisions,ac),ad=aa._revisions.start,ag=aa._revisions.ids[0]),!aa._rev_tree){if(af=a0(aa._rev),af.error){return af}ad=af.prefix,ag=af.id,aa._rev_tree=[{pos:ad,ids:[ag,ac,[]]}]}}C(aa._id),aa._rev=ad+"-"+ag;var ak={metadata:{},data:{}};for(var ah in aa){if(Object.prototype.hasOwnProperty.call(aa,ah)){var ab="_"===ah[0];if(ab&&!hR[ah]){var t=gx(gl,ah);throw t.message=gl.message+": "+ah,t}ab&&!gE[ah]?ak.metadata[ah.slice(1)]=aa[ah]:ak.data[ah]=aa[ah]}}return ak}function hM(aa,t){return t>aa?-1:aa>t?1:0}function iz(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function dn(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function hb(aa){for(var ac=0;ac<aa.length;ac++){var ad=aa[ac];if(ad._deleted){delete ad._attachments}else{if(ad._attachments){for(var ab=Object.keys(ad._attachments),t=0;t<ab.length;t++){var af=ab[t];ad._attachments[af]=fR(ad._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function iK(aa,ac){var ad=hM(aa._id,ac._id);if(0!==ad){return ad}var ab=aa._revisions?aa._revisions.start:0,t=ac._revisions?ac._revisions.start:0;return hM(ab,t)}function ai(t){var aa={},ab=[];return f2(t,function(ah,ac,ag,ad){var af=ac+"-"+ag;return ah&&(aa[af]=0),void 0!==ad&&ab.push({from:ad,to:af}),af}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function g6(aa,ac,ad){var ab="limit" in ac?ac.keys.slice(ac.skip,ac.limit+ac.skip):ac.skip>0?ac.keys.slice(ac.skip):ac.keys;if(ac.descending&&ab.reverse(),!ab.length){return aa._allDocs({limit:0},ad)}var t={offset:ac.skip};return gy.all(ab.map(function(af){var ag=ez.extend({key:af,deleted:"ok"},ac);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new gy(function(aj,ah){aa._allDocs(ag,function(ak,al){return ak?ah(ak):(t.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return t.rows=af,t})}function h9(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),O.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&h9(t)})})})}function g3(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function gT(){a4.EventEmitter.call(this)}function iE(){this.isReady=!1,this.failed=!1,this.queue=[]}function hH(t){t&&X.debug&&console.error(t)}function hN(t,ab){function ag(){ac.emit("destroyed",ad),ac.emit(ad,"destroyed")}function aa(){t.removeListener("destroyed",ag),t.emit("destroyed",t)}var ad=ab.originalName,ac=t.constructor,af=ac._destructionListeners;t.once("destroyed",ag),af.has(ad)||af.set(ad,[]),af.get(ad).push(aa)}function gG(aa,ac,ad){if(!(this instanceof gG)){return new gG(aa,ac,ad)}var ab=this;("function"==typeof ac||"undefined"==typeof ac)&&(ad=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ad&&(ad=hH),aa=aa||ac.name,ac=ho(ac),delete ac.name,this.__opts=ac;var t=ad;ab.auto_compaction=ac.auto_compaction,ab.prefix=gG.prefix,gT.call(ab),ab.taskqueue=new iE;var af=new gy(function(al,ah){ad=function(ap,am){return ap?ah(ap):(delete am.then,void al(am))},ac=ho(ac);var ak,ag,aj=ac.name||aa;return function(){try{if("string"!=typeof aj){throw ag=new Error("Missing/invalid DB name"),ag.code=400,ag}if(ak=gG.parseAdapter(aj,ac),ac.originalName=aj,ac.name=ak.name,ac.prefix&&"http"!==ak.adapter&&"https"!==ak.adapter&&(ac.name=ac.prefix+ac.name),ac.adapter=ac.adapter||ak.adapter,ab._adapter=ac.adapter,gw("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aj,!gG.adapters[ac.adapter]){throw ag=new Error("Adapter is missing"),ag.code=404,ag}if(!gG.adapters[ac.adapter].valid()){throw ag=new Error("Invalid Adapter"),ag.code=404,ag}}catch(am){ab.taskqueue.fail(am)}}(),ag?ah(ag):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void gG.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ad(am)):(hN(ab,ac),ab.emit("created",ab),gG.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ad(null,ab))}))});af.then(function(ag){t(null,ag)},t),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function fZ(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function hg(){return v}function f7(aa){Object.keys(a4.EventEmitter.prototype).forEach(function(ab){"function"==typeof a4.EventEmitter.prototype[ab]&&(aa[ab]=gM[ab].bind(gM))});var t=aa._destructionListeners=new ja.Map;aa.on("destroyed",function(ab){t.has(ab)&&(t.get(ab).forEach(function(ac){ac()}),t["delete"](ab))})}function fr(aa){for(var ac=aa.length,ad=new ArrayBuffer(ac),ab=new Uint8Array(ad),t=0;ac>t;t++){ab[t]=aa.charCodeAt(t)}return ad}function gO(aa,t){return U([fr(aa)],{type:t})}function hV(t){for(var ab=fV.exec(t),ag={},aa=14;aa--;){var ad=S[aa],ac=ab[aa]||"",af=-1!==["user","password"].indexOf(ad);ag[ad]=af?decodeURIComponent(ac):ac}return ag[er]={},ag[S[12]].replace(fn,function(ah,ak,aj){ak&&(ag[er][ak]=aj)}),ag}function o(aa,ac,ad){try{return !aa(ac,ad)}catch(ab){var t="Filter function threw: "+ab.toString();return gx(ei,t)}}function i8(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&o(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function hl(aa,t){"console" in X&&"info" in console&&console.info("The above "+aa+" is totally normal. "+t)}function ge(aa,ac,ad,ab,t){return aa.get(ac)["catch"](function(af){if(404===af.status){return"http"===aa.type()&&hl(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ab,_id:ac,history:[],replicator:fs,version:a8}}throw af}).then(function(af){return t.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ab}),af.history.unshift({last_seq:ad,session_id:ab}),af.history=af.history.slice(0,gQ),af.version=a8,af.replicator=fs,af.session_id=ab,af.last_seq=ad,aa.put(af)["catch"](function(ag){if(409===ag.status){return ge(aa,ac,ad,ab,t)}throw ag}))})}function B(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function gC(t,ab){if(t.session_id===ab.session_id){return{last_seq:t.last_seq,history:t.history||[]}}var ac=t.history||[],aa=ab.history||[];return il(ac,aa)}function il(ac,aa){var af=ac[0],ah=ac.slice(1),ag=aa[0],ab=aa.slice(1);if(!af||0===aa.length){return{last_seq:fh,history:[]}}var ad=af.session_id;if(gV(ad,aa)){return{last_seq:af.last_seq,history:ac}}var t=ag.session_id;return gV(t,ah)?{last_seq:ag.last_seq,history:ab}:il(ah,ab)}function gV(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:gV(t,aa):!1}function h3(t,ab){t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1;var ac=Math.random(),aa=ab-t;return ~~(aa*ac+t)}function i7(aa){var t=0;return aa||(t=2000),h3(aa,t)}function jj(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=i7),ab.emit("requestError",ac),("active"===ab.state||"pending"===ab.state)&&(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=gW})),t.current_back_off=t.current_back_off||gW,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function hX(t){return h1(t)}function he(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function fb(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function gL(t){return Object.keys(t).sort(io.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function gX(t,ab,ag){var aa=ag.doc_ids?ag.doc_ids.sort(io.collate):"",ad=ag.filter?ag.filter.toString():"",ac="",af="";return ag.filter&&ag.query_params&&(ac=JSON.stringify(gL(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),gy.all([t.id(),ab.id()]).then(function(ah){var aj=ah[0]+ah[1]+ad+af+ac+aa;return fd(aj)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function iy(t){return/^1-/.test(t)}function ce(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0,attachments:!0,binary:!0}}function fz(ab,aa,ad){function ag(){var ak=ce(aa);if(ak.docs.length){return ab.bulkGet(ak).then(function(al){if(ad.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&aj.push(ap.ok)})})})}}function af(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function ac(ak){return ab.allDocs({keys:ak,include_docs:!0}).then(function(al){if(ad.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&iy(am.value.rev)&&!af(am.doc)&&(aj.push(am.doc),delete aa[am.id])})})}function t(){var ak=Object.keys(aa).filter(function(am){var al=aa[am].missing;return 1===al.length&&iy(al[0])});return ak.length>0?ac(ak):void 0}function ah(){return aj}aa=ho(aa);var aj=[];return gy.resolve().then(t).then(ag).then(ah)}function iP(aH,aG,al,ax,am){function ad(){return aa?gy.resolve():gX(aH,aG,al).then(function(aS){aD=aS,aa=new B(aH,aG,aD,ax)})}function au(){if(aN=[],0!==aQ.docs.length){var aS=aQ.docs;return aG.bulkDocs({docs:aS,new_edits:!1}).then(function(aT){if(ax.cancelled){throw ac(),new Error("cancelled")}var aW=[],aU={};aT.forEach(function(aY){aY.error&&(am.doc_write_failures++,aW.push(aY),aU[aY.id]=aY)}),aC=aC.concat(aW),am.docs_written+=aQ.docs.length-aW.length;var aV=aW.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aU[aZ._id];aY?ax.emit("denied",ho(aY)):aN.push(aZ)}),aV.length>0){var aX=new Error("bulkDocs error");throw aX.other_errors=aW,ay("target.bulkDocs failed to write docs",aX),new Error("bulkWrite partial failure")}},function(aT){throw am.doc_write_failures+=aS.length,aT})}}function aE(){am.last_seq=aP=aQ.seq;var aS=ho(am);return aN.length&&(aS.docs=aN,ax.emit("change",aS)),ab=!0,aa.writeCheckpoint(aQ.seq,aA).then(function(){if(ab=!1,ax.cancelled){throw ac(),new Error("cancelled")}aQ=void 0,aj()})["catch"](function(aT){throw ab=!1,ay("writeCheckpoint completed with error",aT),aT})}function aK(){var aS={};return aQ.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aG.revsDiff(aS).then(function(aT){if(ax.cancelled){throw ac(),new Error("cancelled")}aQ.diffs=aT})}function aw(){return fz(aH,aQ.diffs,ax).then(function(aS){aS.forEach(function(aT){delete aQ.diffs[aT._id],am.docs_read++,aQ.docs.push(aT)})})}function aJ(){if(!ax.cancelled&&!aQ){if(0===ag.length){return void ah(!0)}aQ=ag.shift(),aK().then(aw).then(au).then(aE).then(aJ)["catch"](function(aS){ay("batch processing terminated with error",aS)})}}function ah(aS){return 0===aq.changes.length?void (0!==ag.length||aQ||((af&&aF.live||az)&&(ax.state="pending",ax.emit("paused")),az&&ac())):void ((aS||az||aq.changes.length>=aB)&&(ag.push(aq),aq={seq:0,changes:[],docs:[]},("pending"===ax.state||"stopped"===ax.state)&&(ax.state="active",ax.emit("active")),aJ()))}function ay(aT,aS){ak||(aS.message||(aS.message=aT),am.ok=!1,am.status="aborting",am.errors.push(aS),aC=aC.concat(aS),ag=[],aq={seq:0,changes:[],docs:[]},ac())}function ac(){if(!(ak||ax.cancelled&&(am.status="cancelled",ab))){am.status=am.status||"complete",am.end_time=new Date,am.last_seq=aP,ak=!0;var aT=aC.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=aC.pop();aC.length>0&&(aS.other_errors=aC),aS.result=am,jj(al,ax,aS,function(){iP(aH,aG,al,ax)})}else{am.errors=aC,ax.emit("complete",am),ax.removeAllListeners()}}}function ap(aT){if(ax.cancelled){return ac()}var aS=i8(al)(aT);aS&&(aq.seq=aT.seq,aq.changes.push(aT),ah(0===ag.length))}function aL(aS){return aI=!1,ax.cancelled?ac():(aS.results.length>0?(aF.since=aS.last_seq,aj()):af?(aF.live=!0,aj()):az=!0,void ah(!0))}function t(aS){return aI=!1,ax.cancelled?ac():void ay("changes rejected",aS)}function aj(){function aS(){aT.cancel()}function aU(){ax.removeListener("cancel",aS)}if(!aI&&!az&&ag.length<aM){aI=!0,ax._changes&&(ax.removeListener("cancel",ax._abortChanges),ax._changes.cancel()),ax.once("cancel",aS);var aT=aH.changes(aF).on("change",ap);aT.then(aU,aU),aT.then(aL)["catch"](t),al.retry&&(ax._changes=aT,ax._abortChanges=aS)}}function aO(){ad().then(function(){return ax.cancelled?void ac():aa.getCheckpoint().then(function(aS){aP=aS,aF={since:aP,limit:aB,batch_size:aB,style:"all_docs",doc_ids:aR,return_docs:!0},al.filter&&("string"!=typeof al.filter?aF.include_docs=!0:aF.filter=al.filter),"heartbeat" in al&&(aF.heartbeat=al.heartbeat),"timeout" in al&&(aF.timeout=al.timeout),al.query_params&&(aF.query_params=al.query_params),al.view&&(aF.view=al.view),aj()})})["catch"](function(aS){ay("getCheckpoint rejected with ",aS)})}function av(aS){throw ab=!1,ay("writeCheckpoint completed with error",aS),aS}var aQ,aD,aa,ag=[],aq={seq:0,changes:[],docs:[]},ab=!1,az=!1,ak=!1,aP=0,af=al.continuous||al.live||!1,aB=al.batch_size||100,aM=al.batches_limit||10,aI=!1,aR=al.doc_ids,aC=[],aN=[],aA=I();am=am||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aF={};return ax.ready(aH,aG),ax.cancelled?void ac():(ax._addedListeners||(ax.once("cancel",ac),"function"==typeof al.complete&&(ax.once("error",al.complete),ax.once("complete",function(aS){al.complete(null,aS)})),ax._addedListeners=!0),void ("undefined"==typeof al.since?aO():ad().then(function(){return ab=!0,aa.writeCheckpoint(al.since,aA)}).then(function(){return ab=!1,ax.cancelled?void ac():(aP=al.since,void aO())})["catch"](av)))}function fY(){a4.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new gy(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function r(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function iT(t,ab,ag,aa){if("function"==typeof ag&&(aa=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gx(ei,"`doc_ids` filter parameter is not a list.")}ag.complete=aa,ag=ho(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ad=new fY(ag),ac=r(t,ag),af=r(ab,ag);return iP(ac,af,ag,ad),ad}function hw(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=ho(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=ga.toPouch(t,ac),ab=ga.toPouch(ab,ac),new es(t,ab,ac,aa)}function es(ag,aq,ap,ad){function au(ay){aj.emit("change",{direction:"pull",change:ay})}function ak(ay){aj.emit("change",{direction:"push",change:ay})}function aa(ay){aj.emit("denied",{direction:"push",doc:ay})}function am(ay){aj.emit("denied",{direction:"pull",doc:ay})}function av(){aj.pushPaused=!0,aj.pullPaused&&aj.emit("paused")}function ac(){aj.pullPaused=!0,aj.pushPaused&&aj.emit("paused")}function ah(){aj.pushPaused=!1,aj.pullPaused&&aj.emit("active",{direction:"push"})}function al(){aj.pullPaused=!1,aj.pushPaused&&aj.emit("active",{direction:"pull"})}function af(ay){return function(aC,az){var aE="change"===aC&&(az===au||az===ak),aA="denied"===aC&&(az===am||az===aa),aD="paused"===aC&&(az===ac||az===av),aB="active"===aC&&(az===al||az===ah);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aj.removeAllListeners(aC))}}var aj=this;this.canceled=!1;var ab=ap.push?ez.extend({},ap,ap.push):ap,aw=ap.pull?ez.extend({},ap,ap.pull):ap;this.push=ft(ag,aq,ab),this.pull=ft(aq,ag,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ap.live&&(this.push.on("complete",aj.pull.cancel.bind(aj.pull)),this.pull.on("complete",aj.push.cancel.bind(aj.push))),this.on("newListener",function(ay){"change"===ay?(aj.pull.on("change",au),aj.push.on("change",ak)):"denied"===ay?(aj.pull.on("denied",am),aj.push.on("denied",aa)):"active"===ay?(aj.pull.on("active",al),aj.push.on("active",ah)):"paused"===ay&&(aj.pull.on("paused",ac),aj.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aj.pull.removeListener("change",au),aj.push.removeListener("change",ak)):"denied"===ay?(aj.pull.removeListener("denied",am),aj.push.removeListener("denied",aa)):"active"===ay?(aj.pull.removeListener("active",al),aj.push.removeListener("active",ah)):"paused"===ay&&(aj.pull.removeListener("paused",ac),aj.push.removeListener("paused",av))}),this.pull.on("removeListener",af("pull")),this.push.on("removeListener",af("push"));var t=gy.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aj.emit("complete",az),ad&&ad(null,az),aj.removeAllListeners(),az},function(ay){if(aj.cancel(),ad?ad(ay):aj.emit("error",ay),aj.removeAllListeners(),ad){throw ay}});this.then=function(ay,az){return t.then(ay,az)},this["catch"]=function(ay){return t["catch"](ay)}}function gz(aa,t){return gO(iR(aa),t)}function it(aa){for(var ac="",ad=new Uint8Array(aa),ab=ad.byteLength,t=0;ab>t;t++){ac+=String.fromCharCode(ad[t])}return ac}function gu(t,ab){if("undefined"==typeof FileReader){return ab(it((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(it(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function hd(t){return new gy(function(aa){gu(t,function(ab){aa(h1(ab))})})}function be(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function T(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=gz(ab.data,ab.content_type)})}function gU(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function i3(t){return t._attachments&&Object.keys(t._attachments)?gy.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?hd(aa.data).then(function(ac){aa.data=ac}):void 0})):gy.resolve()}function j(t){var aa=hV(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function i0(aa,t){return i5(aa,aa.db+"/"+t)}function i5(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function h0(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function ir(af,al){function aa(aw,av,az){var ay=aw.ajax||{},ax=ez.extend(ho(ap),ay,av);return g1(ax.method+" "+ax.url),f.ajax(ax,az)}function ad(av,aw){return new gy(function(ax,ay){aa(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function ab(av,aw){return gA(av,dt(function(ax){aj().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function aj(){if(af.skipSetup||af.skip_setup){return gy.resolve()}if(am){return am}var av={method:"GET",url:ag};return am=ad({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(hl(404,"PouchDB is just detecting if the remote exists."),ad({},{method:"PUT",url:ag})):gy.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:gy.reject(aw)}),am["catch"](function(){am=null}),am}function aq(av){return av.split("/").map(encodeURIComponent).join("/")}var ak=this,au=j;af.getHost&&(au=af.getHost);var t=au(af.name,af),ag=i0(t,"");af=ho(af);var ap=af.ajax||{};if(ak.getUrl=function(){return ag},ak.getHeaders=function(){return ap.headers||{}},af.auth||t.auth){var ah=af.auth||t.auth,ac=h1(ah.username+":"+ah.password);ap.headers=ap.headers||{},ap.headers.Authorization="Basic "+ac}var am;setTimeout(function(){al(null,ak)}),ak.type=function(){return"http"},ak.id=ab("id",function(av){aa({},{method:"GET",url:i5(t,"")},function(ay,aw){var ax=aw&&aw.uuid?aw.uuid+t.db:i0(t,"");av(null,ax)})}),ak.request=ab("request",function(av,aw){av.url=i0(t,av.url),aa({},av,aw)}),ak.compact=ab("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=ho(av),aa(av,{url:i0(t,"_compact"),method:"POST"},function(){function ax(){ak.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),ak.bulkGet=gA("bulkGet",function(aB,aA){function aw(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),aa({},{url:i0(t,"_bulk_get"+h0(aD)),method:"POST",body:{docs:aB.docs}},aC)}function ax(){function aC(aJ){return function(aK,aL){aG[aJ]=aL.results,++aI===aE&&aA(null,{results:be(aG)})}}for(var aF=hy,aE=Math.ceil(aB.docs.length/aF),aI=0,aG=new Array(aE),aH=0;aE>aH;aH++){var aD=fR(aB,["revs","attachments"]);aD.docs=aB.docs.slice(aH*aF,Math.min(aB.docs.length,(aH+1)*aF)),fl(az,aD,aC(aH))}}var az=this,av=i5(t,""),ay=go[av];"boolean"!=typeof ay?aw(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(go[av]=!1,hl(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aE)}else{go[av]=!0,aA(null,aD)}}):ay?aw(aA):ax()}),ak._info=function(av){aj().then(function(){aa({},{method:"GET",url:i0(t,"")},function(aw,ax){return aw?av(aw):(ax.host=i0(t,""),void av(null,ax))})})["catch"](av)},ak.get=ab("get",function(aB,aA,aw){function ax(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?gy.all(aE.map(function(aF){var aH=aC[aF],aG=gU(aD._id)+"/"+aq(aF)+"?rev="+aD._rev;return ad(aA,{method:"GET",url:i0(t,aG),binary:!0}).then(function(aI){return aA.binary?aI:hd(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function az(aC){return Array.isArray(aC)?gy.all(aC.map(function(aD){return aD.ok?ax(aD.ok):void 0})):ax(aC)}"function"==typeof aA&&(aw=aA,aA={}),aA=ho(aA);var ay={};aA.revs&&(ay.revs=!0),aA.revs_info&&(ay.revs_info=!0),aA.open_revs&&("all"!==aA.open_revs&&(aA.open_revs=JSON.stringify(aA.open_revs)),ay.open_revs=aA.open_revs),aA.rev&&(ay.rev=aA.rev),aA.conflicts&&(ay.conflicts=aA.conflicts),aB=gU(aB);var av={method:"GET",url:i0(t,aB+h0(ay))};ad(aA,av).then(function(aC){return gy.resolve().then(function(){return aA.attachments?az(aC):void 0}).then(function(){aw(null,aC)})})["catch"](aw)}),ak.remove=ab("remove",function(aw,ay,ax,av){var aA;"string"==typeof ay?(aA={_id:aw,_rev:ay},"function"==typeof ax&&(av=ax,ax={})):(aA=aw,"function"==typeof ay?(av=ay,ax={}):(av=ax,ax=ay));var az=aA._rev||ax.rev;aa(ax,{method:"DELETE",url:i0(t,gU(aA._id))+"?rev="+az},av)}),ak.getAttachment=ab("getAttachment",function(ay,aA,ax,aw){"function"==typeof ax&&(aw=ax,ax={});var av=ax.rev?"?rev="+ax.rev:"",az=i0(t,gU(ay))+"/"+aq(aA)+av;aa(ax,{method:"GET",url:az,binary:!0},aw)}),ak.removeAttachment=ab("removeAttachment",function(aw,av,ax,az){var ay=i0(t,gU(aw)+"/"+aq(av))+"?rev="+ax;aa({},{method:"DELETE",url:ay},az)}),ak.putAttachment=ab("putAttachment",function(av,aD,aB,az,ay,aC){"function"==typeof ay&&(aC=ay,ay=az,az=aB,aB=null);var aE=gU(av)+"/"+aq(aD),aw=i0(t,aE);if(aB&&(aw+="?rev="+aB),"string"==typeof az){var ax;try{ax=iR(az)}catch(aA){return aC(gx(ib,"Attachment is not a valid base64 string"))}az=ax?gO(ax,ay):""}var aF={headers:{"Content-Type":ay},method:"PUT",url:aw,processData:!1,body:az,timeout:ap.timeout||60000};aa({},aF,aC)}),ak._bulkDocs=function(ax,aw,av){ax.new_edits=aw.new_edits,aj().then(function(){return gy.all(ax.docs.map(i3))}).then(function(){aa(aw,{method:"POST",url:i0(t,"_bulk_docs"),body:ax},function(ay,az){return ay?av(ay):(az.forEach(function(aA){aA.ok=!0}),void av(null,az))})})["catch"](av)},ak.allDocs=ab("allDocs",function(aw,aB){"function"==typeof aw&&(aB=aw,aw={}),aw=ho(aw);var ax,aA={},az="GET";aw.conflicts&&(aA.conflicts=!0),aw.descending&&(aA.descending=!0),aw.include_docs&&(aA.include_docs=!0),aw.attachments&&(aA.attachments=!0),aw.key&&(aA.key=JSON.stringify(aw.key)),aw.start_key&&(aw.startkey=aw.start_key),aw.startkey&&(aA.startkey=JSON.stringify(aw.startkey)),aw.end_key&&(aw.endkey=aw.end_key),aw.endkey&&(aA.endkey=JSON.stringify(aw.endkey)),"undefined"!=typeof aw.inclusive_end&&(aA.inclusive_end=!!aw.inclusive_end),"undefined"!=typeof aw.limit&&(aA.limit=aw.limit),"undefined"!=typeof aw.skip&&(aA.skip=aw.skip);var av=h0(aA);if("undefined"!=typeof aw.keys){var ay="keys="+encodeURIComponent(JSON.stringify(aw.keys));ay.length+av.length+1<=h?av+="&"+ay:(az="POST",ax={keys:aw.keys})}ad(aw,{method:az,url:i0(t,"_all_docs"+av),body:ax}).then(function(aC){aw.include_docs&&aw.attachments&&aw.binary&&aC.rows.forEach(T),aB(null,aC)})["catch"](aB)}),ak._changes=function(av){var aC="batch_size" in av?av.batch_size:br;av=ho(av),av.timeout="timeout" in av?av.timeout:"timeout" in ap?ap.timeout:30000;var aB,ax=av.timeout?{timeout:av.timeout-5000}:{},aH="undefined"!=typeof av.limit?av.limit:!1;aB="return_docs" in av?av.return_docs:"returnDocs" in av?av.returnDocs:!0;var aD=aH;if(av.style&&(ax.style=av.style),(av.include_docs||av.filter&&"function"==typeof av.filter)&&(ax.include_docs=!0),av.attachments&&(ax.attachments=!0),av.continuous&&(ax.feed="longpoll"),av.conflicts&&(ax.conflicts=!0),av.descending&&(ax.descending=!0),"heartbeat" in av?av.heartbeat&&(ax.heartbeat=av.heartbeat):ax.heartbeat=10000,av.filter&&"string"==typeof av.filter&&(ax.filter=av.filter,"_view"===av.filter&&av.view&&"string"==typeof av.view&&(ax.view=av.view)),av.query_params&&"object"==typeof av.query_params){for(var aF in av.query_params){av.query_params.hasOwnProperty(aF)&&(ax[aF]=av.query_params[aF])}}var aw,aJ="GET";if(av.doc_ids){ax.filter="_doc_ids";var az=JSON.stringify(av.doc_ids);az.length<h?ax.doc_ids=az:(aJ="POST",aw={doc_ids:av.doc_ids})}var aA,aG,aI=function(aM,aK){if(!av.aborted){ax.since=aM,"object"==typeof ax.since&&(ax.since=JSON.stringify(ax.since)),av.descending?aH&&(ax.limit=aD):ax.limit=!aH||aD>aC?aC:aD;var aL={method:aJ,url:i0(t,"_changes"+h0(ax)),timeout:av.timeout,body:aw};aG=aM,av.aborted||aj().then(function(){aA=aa(av,aL,aK)})["catch"](aK)}},aE={results:[]},ay=function(aL,aO){if(!av.aborted){var aK=0;if(aO&&aO.results){aK=aO.results.length,aE.last_seq=aO.last_seq;var aN={};aN.query=av.query_params,aO.results=aO.results.filter(function(aQ){aD--;var aP=i8(av)(aQ);return aP&&(av.include_docs&&av.attachments&&av.binary&&T(aQ),aB&&aE.results.push(aQ),av.onChange(aQ)),aP})}else{if(aL){return av.aborted=!0,void av.complete(aL)}}aO&&aO.last_seq&&(aG=aO.last_seq);var aM=aH&&0>=aD||aO&&aC>aK||av.descending;(!av.continuous||aH&&0>=aD)&&aM?av.complete(null,aE):setTimeout(function(){aI(aG,ay)},0)}};return aI(av.since||0,ay),{cancel:function(){av.aborted=!0,aA&&aA.abort()}}},ak.revsDiff=ab("revsDiff",function(ax,aw,av){"function"==typeof aw&&(av=aw,aw={}),aa(aw,{method:"POST",url:i0(t,"_revs_diff"),body:ax},av)}),ak._close=function(av){av()},ak._destroy=function(aw,av){aa(aw,{url:i0(t,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(ak.emit("destroyed"),ak.constructor.emit("destroyed",af.name),void av(null,ay))})}}function hn(){this.promise=new gy(function(t){t()})}function iG(t){return f1.hash(t)}function f8(ac){var aa=ac.db,af=ac.viewName,ah=ac.map,ag=ac.reduce,ab=ac.temporary,ad=ah.toString()+(ag&&ag.toString())+"undefined";if(!ab&&aa._cachedViews){var t=aa._cachedViews[ad];if(t){return gy.resolve(t)}}return aa.info().then(function(ak){function al(am){am.views=am.views||{};var aq=af;-1===aq.indexOf("/")&&(aq=af+"/"+af);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ab?"temp":iG(ad));return n(aa,"_local/mrviews",al).then(function(){return aa.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:aa,adapter:aa.adapter,mapFun:ah,reduceFun:ag};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ab||(aa._cachedViews=aa._cachedViews||{},aa._cachedViews[ad]=aq,aq.db.once("destroyed",function(){delete aa._cachedViews[ad]})),aq})})})})}function fT(aa,ac,ad,ab,t,af){return iF("return ("+aa.replace(/;\s*$/,"")+");",{emit:ac,sum:ad,log:ab,isArray:t,toJSON:af})}function gj(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function gF(t){return 1===t.length&&/^1-/.test(t[0].rev)}function gq(t,aa){try{t.emit("error",aa)}catch(ab){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(aa)}}function q(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return gq(t,aa),{error:aa}}}function gP(t,aa){var ab=ey(t.key,aa.key);return 0!==ab?ab:ey(t.value,aa.value)}function ix(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function hf(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function g8(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gz(ac.data,ac.content_type)})})}function iq(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&g8(aa),aa}}function gt(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new w(t)}function i1(ac){for(var aa=0,af=0,ah=ac.length;ah>af;af++){var ag=ac[af];if("number"!=typeof ag){if(!Array.isArray(ag)){throw gt("_sum")}aa="number"==typeof aa?[aa]:aa;for(var ab=0,ad=ag.length;ad>ab;ab++){var t=ag[ab];if("number"!=typeof t){throw gt("_sum")}"undefined"==typeof aa[ab]?aa.push(t):aa[ab]+=t}}else{"number"==typeof aa?aa+=ag:aa[0]+=ag}}return aa}function id(aa,ac,ad,ab){var t=ac[aa];"undefined"!=typeof t&&(ab&&(t=encodeURIComponent(JSON.stringify(t))),ad.push(aa+"="+t))}function y(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function ii(t){return t.group_level=y(t.group_level),t.limit=y(t.limit),t.skip=y(t.skip),t}function eq(t){if(t){if("number"!=typeof t){return new hS('Invalid value for integer: "'+t+'"')}if(0>t){return new hS('Invalid value for positive integer: "'+t+'"')}}}function ew(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&ey(t[ac],t[aa])>0){throw new hS("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new hS("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new hS("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=eq(t[af]);if(ad){throw ad}})}function fu(ab,aa,ad){var ag,af=[],ac="GET";if(id("reduce",ad,af),id("include_docs",ad,af),id("attachments",ad,af),id("limit",ad,af),id("descending",ad,af),id("group",ad,af),id("group_level",ad,af),id("skip",ad,af),id("stale",ad,af),id("conflicts",ad,af),id("startkey",ad,af,!0),id("start_key",ad,af,!0),id("endkey",ad,af,!0),id("end_key",ad,af,!0),id("inclusive_end",ad,af),id("key",ad,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ad.keys){var t=2000,ah="keys="+encodeURIComponent(JSON.stringify(ad.keys));ah.length+af.length+1<=t?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?ag={keys:ad.keys}:aa.keys=ad.keys)}if("string"==typeof aa){var aj=gj(aa);return ab.request({method:ac,url:"_design/"+aj[0]+"/_view/"+aj[1]+af,body:ag}).then(iq(ad))}return ag=ag||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?ag[ak]=aa[ak]:ag[ak]=aa[ak].toString()}),ab.request({method:"POST",url:"_temp_view"+af,body:ag}).then(iq(ad))}function fS(t,aa,ab){return new gy(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function f5(t){return new gy(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function g(t){return function(aa){if(404===aa.status){return t}throw aa}}function iJ(t,aj,ad){function ag(){return gF(ab)?gy.resolve(ah):aj.db.get(aa)["catch"](g(ah))}function af(am){return am.keys.length?aj.db.allDocs({keys:am.keys,include_docs:!0}):gy.resolve({rows:[]})}function ac(au,ap){for(var ay=[],aA={},az=0,ax=ap.rows.length;ax>az;az++){var av=ap.rows[az],am=av.doc;if(am&&(ay.push(am),aA[am._id]=!0,am._deleted=!al[am._id],!am._deleted)){var aq=al[am._id];"value" in aq&&(am.value=aq.value)}}var aw=Object.keys(al);return aw.forEach(function(aD){if(!aA[aD]){var aB={_id:aD},aC=al[aD];"value" in aC&&(aB.value=aC.value),ay.push(aB)}}),au.keys=ji(aw.concat(au.keys)),ay.push(au),ay}var aa="_local/doc_"+t,ah={_id:aa,keys:[]},ak=ad[t],al=ak.indexableKeysToKeyValues,ab=ak.changes;return ag().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function hT(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](g({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return gy.all(ad.map(function(ag){return iJ(ag,t,ab)})).then(function(ah){var ag=be(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function P(t){var aa="string"==typeof t?t:t.name,ab=hE[aa];return ab||(ab=hE[aa]=new hn),ab}function hB(t){return ik(P(t),function(){return a9(t)})()}function a9(ab){function aa(am,ak){var al={id:af._id,key:iV(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=iV(ak)),ag.push(al)}function ad(ak,al){return function(){return hT(ab,ak,al)}}var ag,af,ac;if("function"==typeof ab.mapFun&&2===ab.mapFun.length){var t=ab.mapFun;ac=function(ak){return t(ak,aa)}}else{ac=fT(ab.mapFun.toString(),aa,i1,gg,Array.isArray,JSON.parse)}var ah=ab.seq||0,aj=new hn;return new gy(function(ap,ak){function al(){aj.finish().then(function(){ab.seq=ah,ap()})}function am(){function aq(au){ak(au)}ab.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:iZ}).on("complete",function(aF){var ax=aF.results;if(!ax.length){return al()}for(var aC={},aA=0,aD=ax.length;aD>aA;aA++){var aw=ax[aA];if("_"!==aw.doc._id[0]){ag=[],af=aw.doc,af._deleted||q(ab.sourceDB,ac,[af]),ag.sort(gP);for(var aG,ay={},au=0,aE=ag.length;aE>au;au++){var aB=ag[au],az=[aB.key,aB.id];0===ey(aB.key,aG)&&az.push(au);var av=hC(az);ay[av]=aB,aG=aB.key}aC[aw.doc._id]={indexableKeysToKeyValues:ay,changes:aw.changes}}ah=aw.seq}return aj.add(ad(aC,ah)),ax.length<iZ?al():am()}).on("error",aq)}am()})}function g5(t,aj,ad){0===ad.group_level&&delete ad.group_level;var ag,af=ad.group||ad.group_level;ag=hi[t.reduceFun]?hi[t.reduceFun]:fT(t.reduceFun.toString(),null,i1,gg,Array.isArray,JSON.parse);var ac=[],aa=ad.group_level;aj.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&"number"==typeof aa&&(ap=ap.length>aa?ap.slice(0,aa):ap),am&&0===ey(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void ac.push({key:[[ap,aq.id]],value:[aq.value]})});for(var ah=0,ak=ac.length;ak>ah;ah++){var al=ac[ah],ab=q(t.sourceDB,ag,[al.key,al.value,!1]);if(ab.error&&ab.error instanceof w){throw ab.error}al.value=ab.error?null:ab.output,al.key=al.key[0][0]}return{rows:ix(ac,ad.limit,ad.skip)}}function fo(aa,t){return ik(P(aa),function(){return hI(aa,t)})()}function hI(t,ag){function ac(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ad=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=ip(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function af(au){var av;if(av=aa?g5(t,au,ag):{total_rows:ad,offset:aj,rows:au},ag.include_docs){var aq=ji(au.map(hf));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ag.conflicts,attachments:ag.attachments,binary:ag.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=hf(ay),az=aw["$"+aA];az&&(ay.doc=az)}),av})}return av}var ad,aa=t.reduceFun&&ag.reduce!==!1,aj=ag.skip||0;if("undefined"==typeof ag.keys||ag.keys.length||(ag.limit=0,delete ag.keys),"undefined"!=typeof ag.keys){var ap=ag.keys,ah=ap.map(function(au){var aq={startkey:hC([au]),endkey:hC([au,{}])};return ac(aq)});return gy.all(ah).then(be).then(af)}var ak={descending:ag.descending};if(ag.start_key&&(ag.startkey=ag.start_key),ag.end_key&&(ag.endkey=ag.end_key),"undefined"!=typeof ag.startkey&&(ak.startkey=hC(ag.descending?[ag.startkey,{}]:[ag.startkey])),"undefined"!=typeof ag.endkey){var am=ag.inclusive_end!==!1;ag.descending&&(am=!am),ak.endkey=hC(am?[ag.endkey,{}]:[ag.endkey])}if("undefined"!=typeof ag.key){var ab=hC([ag.key]),al=hC([ag.key,{}]);ak.descending?(ak.endkey=ab,ak.startkey=al):(ak.startkey=ab,ak.endkey=al)}return aa||("number"==typeof ag.limit&&(ak.limit=ag.limit),ak.skip=aj),ac(ak).then(af)}function en(t){return t.request({method:"POST",url:"_view_cleanup"})}function gr(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=gj(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return ik(P(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return gy.all(af).then(function(){return{ok:!0}})})},g({ok:!0}))}function hU(ag,t,ac){if("http"===ag.type()){return fu(ag,t,ac)}if("function"==typeof ag._query){return fS(ag,t,ac)}if("string"!=typeof t){ew(ac,t);var af={db:ag,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return ae.add(function(){return f8(af).then(function(ak){function aj(){return ak.db.destroy()}return g2(hB(ak).then(function(){return fo(ak,ac)}),aj)})}),ae.finish()}var aa=t,ad=gj(aa),ah=ad[0],ab=ad[1];return ag.get("_design/"+ah).then(function(al){var ak=al.views&&al.views[ab];if(!ak||"string"!=typeof ak.map){throw new gN("ddoc "+ah+" has no view named "+ab)}ew(ac,ak);var aj={db:ag,viewName:aa,map:ak.map,reduce:ak.reduce};return f8(aj).then(function(am){return"ok"===ac.stale||"update_after"===ac.stale?("update_after"===ac.stale&&O.nextTick(function(){hB(am)}),fo(am,ac)):hB(am).then(function(){return fo(am,ac)})})})}function hS(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,hS)}catch(t){}}function gN(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,gN)}catch(t){}}function w(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,w)}catch(t){}}function jg(t){return"'"+t+"'"}function iO(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function iX(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function fi(t){return delete t._id,delete t._rev,JSON.stringify(t)}function W(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function fj(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function M(aa,ac,ad,ab,t){return"SELECT "+aa+" FROM "+("string"==typeof ac?ac:ac.join(" JOIN "))+(ad?" ON "+ad:"")+(ab?" WHERE "+("string"==typeof ab?ab:ab.join(" AND ")):"")+(t?" ORDER BY "+t:"")}function at(t,ab,ag){function aa(){++ac===t.length&&ad()}function ad(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+fa+" WHERE seq IN "+fj(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+fa+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+fa+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new ja.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+fa+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+jc+" WHERE digest=?",[az]))})})})}})}}if(t.length){var ac=0,af=[];t.forEach(function(aj){var ah="SELECT seq FROM "+u+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ab,aj],function(al,am){if(!am.rows.length){return aa()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+u+" WHERE seq=?",[ak],aa)})})}}function m(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gx(hL,ab,ac))}}function hK(aa){if("size" in aa){return 1000000*aa.size}var t=/Android/.test(window.navigator.userAgent);return t?5000000:1}function jf(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function bo(t,aa){try{return{db:t(aa)}}catch(ab){return{error:ab}}}function iQ(t){var aa=iI[t.name];if(!aa){var ab=jf();aa=iI[t.name]=bo(ab,t),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return aa}function eo(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function fv(t){fZ()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):hg()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function hj(){a4.EventEmitter.call(this),this._listeners={},fv(this)}function ia(t){return decodeURIComponent(window.escape(t))}function ao(t){return 65>t?t-48:t-55}function g4(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(ao(t.charCodeAt(ab++))<<4|ao(t.charCodeAt(ab++)))}return aa}function hW(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(ao(t.charCodeAt(ab+2))<<12|ao(t.charCodeAt(ab+3))<<8|ao(t.charCodeAt(ab))<<4|ao(t.charCodeAt(ab+1))),ab+=4}return aa}function fX(aa,t){return"UTF-8"===t?ia(g4(aa,0,aa.length)):hW(aa,0,aa.length)}function a3(aa){try{return JSON.parse(aa)}catch(t){return fp.parse(aa)}}function hp(aa){try{return JSON.stringify(aa)}catch(t){return fp.stringify(aa)}}function f0(ah,ab,ag){function t(ak){try{return iR(ak)}catch(al){var aj=gx(ib,"Attachment is not a valid base64 string");return{error:aj}}}function ac(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=t(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===ab?al.data=gO(ak,al.content_type):"base64"===ab?al.data=h1(ak):al.data=ak,fd(ak).then(function(am){al.digest="md5-"+am,aj()})}else{hY(al.data,function(am){"binary"===ab?al.data=it(am):"base64"===ab&&(al.data=h1(it(am))),fd(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function af(){ad++,ah.length===ad&&(aa?ag(aa):ag())}if(!ah.length){return ag()}var aa,ad=0;ah.forEach(function(ak){function am(aq){aa=aq,al++,al===aj.length&&af()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return af()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ac(ak.data._attachments[ap],am)}})}function R(aa,t){return aa.pos-t.pos}function i4(aa,ac,ad){for(var ab,t=0,af=aa.length;af>t;){ab=t+af>>>1,ad(aa[ab],ac)<0?t=ab+1:af=ab}return t}function h7(t,ab,ac){var aa=i4(t,ab,ac);t.splice(aa,0,ab)}function h6(ac,aa){for(var af,ah,ag=aa,ab=ac.length;ab>ag;ag++){var ad=ac[ag],t=[ad.id,ad.opts,[]];ah?(ah[2].push(t),ah=t):af=ah=t}return af}function hm(aa,t){return aa[0]<t[0]?-1:1}function fm(aa,aj){for(var ad=[{tree1:aa,tree2:aj}],ag=!1;ad.length>0;){var af=ad.pop(),ac=af.tree1,ak=af.tree2;(ac[1].status||ak[1].status)&&(ac[1].status="available"===ac[1].status||"available"===ak[1].status?"available":"missing");for(var ah=0;ah<ak[2].length;ah++){if(ac[2][0]){for(var ab=!1,t=0;t<ac[2].length;t++){ac[2][t][0]===ak[2][ah][0]&&(ad.push({tree1:ac[2][t],tree2:ak[2][ah]}),ab=!0)}ab||(ag="new_branch",h7(ac[2],ak[2][ah],hm))}else{ag="new_leaf",ac[2][0]=ak[2][ah]}}}return{conflicts:ag,tree:aa}}function hZ(ac,ah,aq){var ab,av=[],al=!1,ak=!1;if(!ac.length){return{tree:[ah],conflicts:"new_leaf"}}for(var af=0,aw=ac.length;aw>af;af++){var t=ac[af];if(t.pos===ah.pos&&t.ids[0]===ah.ids[0]){ab=fm(t.ids,ah.ids),av.push({pos:t.pos,ids:ab.tree}),al=al||ab.conflicts,ak=!0}else{if(aq!==!0){var ad=t.pos<ah.pos?t:ah,am=t.pos<ah.pos?ah:t,aa=am.pos-ad.pos,aj=[],ax=[];for(ax.push({ids:ad.ids,diff:aa,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],au=0,ap=az.length;ap>au;au++){ax.push({ids:az[au],diff:ay.diff-1,parent:ay.ids,parentIdx:au})}}else{ay.ids[0]===am.ids[0]&&aj.push(ay)}}var ag=aj[0];ag?(ab=fm(ag.ids,am.ids),ag.parent[2][ag.parentIdx]=ab.tree,av.push({pos:ad.pos,ids:ad.ids}),al=al||ab.conflicts,ak=!0):av.push(t)}else{av.push(t)}}}return ak||av.push(ah),av.sort(R),{tree:av,conflicts:al||"internal_node"}}function Y(aa,aj){for(var ad,ag=E(aa),af=0,ac=ag.length;ac>af;af++){var ak=ag[af],ah=ak.ids,ab=Math.max(0,ah.length-aj),t={pos:ak.pos+ab,ids:h6(ah,ab)};ad=ad?hZ(ad,t,!0).tree:[t]}return ad}function jk(t,ab,ac){var aa=hZ(t,ab);return{tree:Y(aa.tree,ac),conflicts:aa.conflicts}}function ct(aa,aj){for(var ad,ag=aa.slice(),af=aj.split("-"),ac=parseInt(af[0],10),ak=af[1];ad=ag.pop();){if(ad.pos===ac&&ad.ids[0]===ak){return !0}for(var ah=ad.ids[2],ab=0,t=ah.length;t>ab;ab++){ag.push({pos:ad.pos+1,ids:ah[ab]})}}return !1}function ev(aa,ac,aq,ax,au,ah,aj,az){if(ct(ac.rev_tree,aq.metadata.rev)){return ax[au]=aq,ah()}var ag=ac.winningRev||cn(ac),t="deleted" in ac?ac.deleted:ij(ac,ag),ab="deleted" in aq.metadata?aq.metadata.deleted:ij(aq.metadata),ak=/^1-/.test(aq.metadata.rev);if(t&&!ab&&az&&ak){var af=aq.data;af._rev=ag,af._id=aq.metadata.id,aq=ar(af,az)}var aw=jk(ac.rev_tree,aq.metadata.rev_tree[0],aa),ay=az&&(t&&ab||!t&&"new_leaf"!==aw.conflicts||t&&!ab&&"new_branch"===aw.conflicts);if(ay){var am=gx(z);return ax[au]=am,ah()}var av=aq.metadata.rev;aq.metadata.rev_tree=aw.tree,ac.rev_map&&(aq.metadata.rev_map=ac.rev_map);var ap,ad=cn(aq.metadata),al=ij(aq.metadata,ad),aA=t===al?0:al>t?-1:1;ap=av===ad?al:ij(aq.metadata,av),aj(aq,ad,al,ap,!0,aA,au,ah)}function hc(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function gR(af,al,aa,ad,ab,aj,aq,ak,au){function t(aA,aC,aB){var ay=cn(aA.metadata),az=ij(aA.metadata,ay);if("was_delete" in ak&&az){return aj[aC]=gx(gD,"deleted"),aB()}var aw=ap&&hc(aA);if(aw){var av=gx(z);return aj[aC]=av,aB()}var ax=az?0:1;aq(aA,ay,az,az,!1,ax,aC,aB)}function ag(){++ac===am&&au&&au()}af=af||1000;var ap=ak.new_edits,ah=new ja.Map,ac=0,am=al.length;al.forEach(function(aw,ay){if(aw._id&&hr(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aa[ax](aw,{ctx:ab},function(aA,az){aj[ay]=aA||az,ag()})}var av=aw.metadata.id;ah.has(av)?(am--,ah.get(av).push([aw,ay])):ah.set(av,[[aw,ay]])}),ah.forEach(function(ay,aw){function ax(){++az<ay.length?av():ag()}function av(){var aC=ay[az],aB=aC[0],aA=aC[1];if(ad.has(aw)){ev(af,ad.get(aw),aB,aj,aA,ax,aq,ap)}else{var aD=jk([],aB.metadata.rev_tree[0],af);aB.metadata.rev_tree=aD.tree,t(aB,aA,ax)}}var az=0;av()})}function im(aa){var t=[];return f2(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function hs(t,aB,aq,ay,av,af,ah){function az(){return ak?ah(ak):(af.notify(ay._name),ay._docCount=-1,void ah(null,am))}function aj(aD,aE){var aC="SELECT count(*) as cnt FROM "+jc+" WHERE digest=?";ab.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gx(hJ,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ap(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aw.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aj(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aa(aF,aJ,aC,aG,aL,aQ,aH,aM){function aD(){function aX(bg,bc){function bh(){return ++bf===ba.length&&bc(),!1}function bb(bj){var bi="INSERT INTO "+fa+" (digest, seq) VALUES (?,?)",bk=[aW._attachments[bj].digest,bg];ab.executeSql(bi,bk,bh,bh)}var bf=0,ba=Object.keys(aW._attachments||{});if(!ba.length){return bc()}for(var bd=0;bd<ba.length;bd++){bb(ba[bd])}}var aW=aF.data,aS=aG?1:0,aT=aW._id,aZ=aW._rev,aU=fi(aW),aV="INSERT INTO "+u+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aY=[aT,aZ,aU,aS];ab.executeSql(aV,aY,function(ba,bb){var bc=bb.insertId;aX(bc,function(){aI(ba,bc)})},function(){var ba=M("seq",u,null,"doc_id=? AND rev=?");return ab.executeSql(ba,[aT,aZ],function(bd,bf){var bc=bf.rows.item(0).seq,bb="UPDATE "+u+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aU,aS,aT,aZ];bd.executeSql(bb,bg,function(bh){aX(bc,function(){aI(bh,bc)})})}),!1})}function aK(aS){aN||(aS?(aN=aS,aM(aN)):aR===aP.length&&aD())}function aO(aS){aR++,aK(aS)}function aE(){if(aL&&ay.auto_compaction){var aS=aF.metadata.id,aT=im(aF.metadata);at(aT,aS,ab)}}function aI(aW,aS){aE(),aF.metadata.seq=aS,delete aF.metadata.rev;var aU=aL?"UPDATE "+gp+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+u+" WHERE doc_id="+gp+".id AND rev=?) WHERE id=?":"INSERT INTO "+gp+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=hp(aF.metadata),aX=aF.metadata.id,aV=aL?[aT,aS,aJ,aX]:[aX,aS,aS,aT];aW.executeSql(aU,aV,function(){am[aH]={ok:!0,id:aF.metadata.id,rev:aJ},ac.set(aX,aF.metadata),aM()})}var aN=null,aR=0;aF.data._id=aF.metadata.id,aF.data._rev=aF.metadata.rev;var aP=Object.keys(aF.data._attachments||{});aG&&(aF.data._deleted=!0),aP.forEach(function(aU){var aT=aF.data._attachments[aU];if(aT.stub){aR++,aK()}else{var aS=aT.data;delete aT.data;var aV=aT.digest;ax(aV,aS,aO)}}),aP.length||aD()}function ag(){gR(t.revs_limit,aw,ay,ac,ab,am,aa,aq)}function ad(aD){function aE(){++aC===aw.length&&aD()}if(!aw.length){return aD()}var aC=0;aw.forEach(function(aG){if(aG._id&&hr(aG._id)){return aE()}var aF=aG.metadata.id;ab.executeSql("SELECT json FROM "+gp+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=a3(aI.rows.item(0).json);ac.set(aF,aJ)}aE()})})}function ax(aD,aF,aC){var aE="SELECT digest FROM "+jc+" WHERE digest=?";ab.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+jc+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iO(aF)],function(){aC()},function(){return aC(),!1}))})}var aA=aq.new_edits,au=aB.docs,aw=au.map(function(aC){if(aC._id&&hr(aC._id)){return aC}var aD=ar(aC,aA);return aD}),al=aw.filter(function(aC){return aC.error});if(al.length){return ah(al[0])}var ab,ak,am=new Array(aw.length),ac=new ja.Map;f0(aw,"binary",function(aC){return aC?ah(aC):void av.transaction(function(aD){ab=aD,ap(function(aE){aE?ak=aE:ad(ag)})},m(ah),az)})}function h8(ab,aa,ad,ag,af){function ac(){++aj===ah.length&&af&&af()}function t(am,ak){var al=am._attachments[ak],ap={binary:aa.binary,ctx:ag};ad._getAttachment(al,ap,function(aq,au){am._attachments[ak]=ez.extend(fR(al,["digest","content_type"]),{data:au}),ac()})}var ah=Object.keys(ab._attachments||{});if(!ah.length){return af&&af()}var aj=0;ah.forEach(function(ak){aa.attachments&&aa.include_docs?t(ab,ak):(ab._attachments[ak].stub=!0,ac())})}function jh(am,aA){function aq(){hg()&&(window.localStorage["_pouch__websqldb_"+al._name]=!0),aA(null,al)}function ay(aC,aD){aC.executeSql(i),aC.executeSql("ALTER TABLE "+u+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(fU),aC.executeSql("ALTER TABLE "+gp+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+gp+" (local, id)");var aE="SELECT "+gp+".winningseq AS seq, "+gp+".json AS metadata FROM "+u+" JOIN "+gp+" ON "+u+".seq = "+gp+".winningseq";aC.executeSql(aE,[],function(aK,aF){for(var aM=[],aH=[],aI=0;aI<aF.rows.length;aI++){var aL=aF.rows.item(aI),aG=aL.seq,aJ=JSON.parse(aL.metadata);ij(aJ)&&aM.push(aG),hr(aJ.id)&&aH.push(aJ.id)}aK.executeSql("UPDATE "+gp+"SET local = 1 WHERE id IN "+fj(aH.length),aH,function(){aK.executeSql("UPDATE "+u+" SET deleted = 1 WHERE seq IN "+fj(aM.length),aM,aD)})})})})}function av(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+gv+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+gp+".id AS id, "+u+".json AS data FROM "+u+" JOIN "+gp+" ON "+u+".seq = "+gp+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aI,aG){function aJ(){if(!aH.length){return aE(aI)}var aL=aH.shift(),aM=JSON.parse(aL.data)._rev;aI.executeSql("INSERT INTO "+gv+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+gp+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+u+" WHERE seq=?",[aL.seq],function(){aJ()})})})}for(var aH=[],aK=0;aK<aG.rows.length;aK++){aH.push(aG.rows.item(aK))}aJ()})})}function ac(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aL=aG.shift(),aN=fX(aL.hex,aB),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aI=aN.substring(aK+2),aJ="UPDATE "+u+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aJ,[aM,aI,aN],function(){aH()})}aH()}var aE="ALTER TABLE "+u+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+u+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(ff,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+u;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function aw(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+jc;aH.executeSql(aG,[],function(aM,aK){function aN(){var aO=M(fc+", "+gp+".id AS id",[gp,u],a6,null,gp+".id ");aO+=" LIMIT "+aJ+" OFFSET "+aI,aI+=aJ,aM.executeSql(aO,[],function(aR,aW){function aZ(bc,bd){var bb=aU[bc]=aU[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aW.rows.length){return aF(aR)}for(var aU={},aP=0;aP<aW.rows.length;aP++){for(var aX=aW.rows.item(aP),aY=W(aX.data,aX.id,aX.rev),ba=Object.keys(aY._attachments||{}),aS=0;aS<ba.length;aS++){var aV=aY._attachments[ba[aS]];aZ(aV.digest,aX.seq)}}var aQ=[];if(Object.keys(aU).forEach(function(bb){var bc=aU[bb];bc.forEach(function(bd){aQ.push([bb,bd])})}),!aQ.length){return aN()}var aT=0;aQ.forEach(function(bc){var bb="INSERT INTO "+fa+" (digest, seq) VALUES (?,?)";aR.executeSql(bb,bc,function(){++aT===aQ.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aF(aM)}var aI=0,aJ=10;aN()})}var aE="CREATE TABLE IF NOT EXISTS "+fa+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(jb,[],function(aH){aH.executeSql(hv,[],aC)})})}function az(aD,aE){var aC="ALTER TABLE "+jc+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function ap(aD,aE){var aC="ALTER TABLE "+gp+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+gp+" SET max_seq=(SELECT MAX(seq) FROM "+u+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aI){var aH="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+gp+" (max_seq)";aI.executeSql(aH,[],aE)})})}function ak(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;aB=2===aG.length?"UTF-8":"UTF-16",aD()})}function t(){for(;ag.length>0;){var aC=ag.pop();aC(null,aa)}}function aj(aG,aJ){if(0===aJ){var aC="CREATE TABLE IF NOT EXISTS "+hG+" (dbid, db_version INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+jc+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aI="CREATE TABLE IF NOT EXISTS "+fa+" (digest, seq INTEGER)",aF="CREATE TABLE IF NOT EXISTS "+gp+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aH="CREATE TABLE IF NOT EXISTS "+u+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aD="CREATE TABLE IF NOT EXISTS "+gv+" (id UNIQUE, rev, json)";aG.executeSql(aE),aG.executeSql(aD),aG.executeSql(aI,[],function(){aG.executeSql(hv),aG.executeSql(jb)}),aG.executeSql(aF,[],function(){aG.executeSql(i),aG.executeSql(aH,[],function(){aG.executeSql(fU),aG.executeSql(ff),aG.executeSql(aC,[],function(){var aP="INSERT INTO "+hG+" (db_version, dbid) VALUES (?,?)";aa=I();var aO=[hP,aa];aG.executeSql(aP,aO,function(){t()})})})})}else{var aK=function(){var aO=hP>aJ;aO&&aG.executeSql("UPDATE "+hG+" SET db_version = "+hP);var aP="SELECT dbid FROM "+hG;aG.executeSql(aP,[],function(aR,aQ){aa=aQ.rows.item(0).dbid,t()})},aN=[ay,av,ac,aw,az,ap,aK],aM=aJ,aL=function(aO){aN[aM-1](aO,aL),aM++};aL(aG)}}function ab(){af.transaction(function(aC){ak(aC,function(){ax(aC)})},m(aA),aq)}function ax(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+hG;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+hG,[],function(aH,aI){var aG=aI.rows.item(0).db_version;aj(aH,aG)}):aE.executeSql("ALTER TABLE "+hG+" ADD COLUMN db_version INTEGER",[],function(){aj(aE,1)}):aj(aE,0)})}function ad(aD,aE){if(-1!==al._docCount){return aE(al._docCount)}var aC=M("COUNT("+gp+".id) AS 'num'",[gp,u],a6,u+".deleted=0");aD.executeSql(aC,[],function(aG,aF){al._docCount=aF.rows.item(0).num,aE(al._docCount)})}var aB,al=this,aa=null,ah=hK(am),ag=[];al._docCount=-1,al._name=am.name;var au=iQ({name:al._name,version:gI,description:al._name,size:ah,location:am.location,createFromLocation:am.createFromLocation,androidDatabaseImplementation:am.androidDatabaseImplementation});if(au.error){return m(aA)(au.error)}var af=au.db;"function"!=typeof af.readTransaction&&(af.readTransaction=af.transaction),ab(),al.type=function(){return"websql"},al._id=f3(function(aC){aC(null,aa)}),al._info=function(aC){af.readTransaction(function(aD){ad(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+u;aD.executeSql(aF,[],function(aI,aH){var aG=aH.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aG,sqlite_plugin:af._sqlitePlugin,websql_encoding:aB})})})},m(aC))},al._bulkDocs=function(aE,aC,aD){hs(am,aE,aC,al,af,jh.Changes,aD)},al._get=function(aG,aC,aI){function aL(){aI(aE,{doc:aK,metadata:aH,ctx:aJ})}var aK,aH,aE,aJ=aC.ctx;if(!aJ){return af.readTransaction(function(aM){al._get(aG,ez.extend({ctx:aM},aC),aI)})}var aD,aF;aC.rev?(aD=M(fc,[gp,u],gp+".id="+u+".doc_id",[u+".doc_id=?",u+".rev=?"]),aF=[aG,aC.rev]):(aD=M(fc,[gp,u],a6,gp+".id=?"),aF=[aG]),aJ.executeSql(aD,aF,function(aO,aN){if(!aN.rows.length){return aE=gx(gD,"missing"),aL()}var aM=aN.rows.item(0);return aH=a3(aM.metadata),aM.deleted&&!aC.rev?(aE=gx(gD,"deleted"),aL()):(aK=W(aM.data,aH.id,aM.rev),void aL())})},al._allDocs=function(aE,aL){var aO,aF=[],aD="startkey" in aE?aE.startkey:!1,aI="endkey" in aE?aE.endkey:!1,aN="key" in aE?aE.key:!1,aK="descending" in aE?aE.descending:!1,aM="limit" in aE?aE.limit:-1,aP="skip" in aE?aE.skip:0,aG=aE.inclusive_end!==!1,aJ=[],aC=[];if(aN!==!1){aC.push(gp+".id = ?"),aJ.push(aN)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aC.push(gp+".id "+(aK?"<=":">=")+" ?"),aJ.push(aD)),aI!==!1){var aH=aK?">":"<";aG&&(aH+="="),aC.push(gp+".id "+aH+" ?"),aJ.push(aI)}aN!==!1&&(aC.push(gp+".id = ?"),aJ.push(aN))}}"ok"!==aE.deleted&&aC.push(u+".deleted = 0"),af.readTransaction(function(aQ){ad(aQ,function(aS){if(aO=aS,0!==aM){var aR=M(fc,[gp,u],a6,aC,gp+".id "+(aK?"DESC":"ASC"));aR+=" LIMIT "+aM+" OFFSET "+aP,aQ.executeSql(aR,aJ,function(aZ,aT){for(var bb=0,ba=aT.rows.length;ba>bb;bb++){var aW=aT.rows.item(bb),aU=a3(aW.metadata),aV=aU.id,aX=W(aW.data,aV,aW.rev),aY=aX._rev,bc={id:aV,key:aV,value:{rev:aY}};if(aE.include_docs&&(bc.doc=aX,bc.doc._rev=aY,aE.conflicts&&(bc.doc._conflicts=cr(aU)),h8(bc.doc,aE,al,aZ)),aW.deleted){if("ok"!==aE.deleted){continue}bc.value.deleted=!0,bc.doc=null}aF.push(bc)}})}})},m(aL),function(){aL(null,{total_rows:aO,offset:aE.skip,rows:aF})})},al._changes=function(aD){function aH(){var aM=gp+".json AS metadata, "+gp+".max_seq AS maxSeq, "+u+".json AS winningDoc, "+u+".rev AS winningRev ",aL=gp+" JOIN "+u,aN=gp+".id="+u+".doc_id AND "+gp+".winningseq="+u+".seq",aO=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aO.push(gp+".id IN "+fj(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aK="maxSeq "+(aE?"DESC":"ASC"),aQ=M(aM,aL,aN,aO,aK),aS=i8(aD);aD.view||aD.filter||(aQ+=" LIMIT "+aI);var aP=aD.since||0;af.readTransaction(function(aT){aT.executeSql(aQ,aR,function(aY,aW){function aX(bf){return function(){aD.onChange(bf)}}for(var aZ=0,bc=aW.rows.length;bc>aZ;aZ++){var aU=aW.rows.item(aZ),aV=a3(aU.metadata);aP=aU.maxSeq;var bd=W(aU.winningDoc,aV.id,aU.winningRev),ba=aD.processChange(bd,aV,aD);ba.seq=aU.maxSeq;var bb=aS(ba);if("object"==typeof bb){return aD.complete(bb)}if(bb&&(aF++,aJ&&aC.push(ba),aD.attachments&&aD.include_docs?h8(bd,aD,al,aY,aX(ba)):aX(ba)()),aF===aI){break}}})},m(aD.complete),function(){aD.continuous||aD.complete(null,{results:aC,last_seq:aP})})}if(aD=ho(aD),aD.continuous){var aG=al._name+":"+I();return jh.Changes.addListener(al._name,aG,al,aD),jh.Changes.notify(al._name),{cancel:function(){jh.Changes.removeListener(al._name,aG)}}}var aE=aD.descending;aD.since=aD.since&&!aE?aD.since:0;var aI="limit" in aD?aD.limit:-1;0===aI&&(aI=1);var aJ;aJ="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aC=[],aF=0;aH()},al._close=function(aC){aC()},al._getAttachment=function(aD,aH,aG){var aE,aI=aH.ctx,aJ=aD.digest,aC=aD.content_type,aF="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+jc+" WHERE digest=?";aI.executeSql(aF,[aJ],function(aL,aK){var aN=aK.rows.item(0),aM=aN.escaped?iX(aN.body):fX(aN.body,aB);aE=aH.binary?gO(aM,aC):h1(aM),aG(null,aE)})},al._getRevisionTree=function(aC,aD){af.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+gp+" WHERE id = ?";aE.executeSql(aF,[aC],function(aH,aG){if(aG.rows.length){var aI=a3(aG.rows.item(0).metadata);aD(null,aI.rev_tree)}else{aD(gx(gD))}})})},al._doCompaction=function(aD,aE,aC){return aE.length?void af.transaction(function(aF){var aG="SELECT json AS metadata FROM "+gp+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){var aI=a3(aJ.rows.item(0).metadata);f2(aI.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aK="UPDATE "+gp+" SET json = ? WHERE id = ?";aH.executeSql(aK,[hp(aI),aD])}),at(aE,aD,aF)},m(aC),function(){aC()}):aC()},al._getLocal=function(aC,aD){af.readTransaction(function(aE){var aF="SELECT json, rev FROM "+gv+" WHERE id=?";aE.executeSql(aF,[aC],function(aG,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=W(aH.json,aC,aH.rev);aD(null,aJ)}else{aD(gx(gD))}})})},al._putLocal=function(aF,aC,aH){function aJ(aN){var aL,aM;aG?(aL="UPDATE "+gv+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aI,aD,aE,aG]):(aL="INSERT INTO "+gv+" (id, rev, json) VALUES (?,?,?)",aM=[aE,aI,aD]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aK={ok:!0,id:aE,rev:aI},aC.ctx&&aH(null,aK)):aH(gx(z))},function(){return aH(gx(z)),!1})}"function"==typeof aC&&(aH=aC,aC={}),delete aF._revisions;var aI,aG=aF._rev,aE=aF._id;aI=aG?aF._rev="0-"+(parseInt(aG.split("-")[1],10)+1):aF._rev="0-1";var aK,aD=fi(aF);aC.ctx?aJ(aC.ctx):af.transaction(aJ,m(aH),function(){aK&&aH(null,aK)})},al._removeLocal=function(aE,aG,aC){function aF(aH){var aI="DELETE FROM "+gv+" WHERE id=? AND rev=?",aJ=[aE._id,aE._rev];aH.executeSql(aI,aJ,function(aL,aK){return aK.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(gx(gD))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):af.transaction(aF,m(aC),function(){aD&&aC(null,aD)})},al._destroy=function(aC,aD){jh.Changes.removeAllListeners(al._name),af.transaction(function(aE){var aF=[gp,u,jc,hG,gv,fa];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},m(aD),function(){hg()&&(delete window.localStorage["_pouch__websqldb_"+al._name],delete window.localStorage[al._name]),aD(null,{ok:!0})})}}function iw(t,ab,ac){try{t.apply(ab,ac)}catch(aa){"undefined"!=typeof PouchDB&&PouchDB.emit("error",aa)}}function iA(){if(!gK.running&&gK.queue.length){gK.running=!0;var t=gK.queue.shift();t.action(function(ab,aa){iw(t.callback,this,[ab,aa]),gK.running=!1,O.nextTick(iA)})}}function ht(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gx(hO,aa,ab.type))}}function fy(t,aa,ab){return{data:hp(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function iW(aa){if(!aa){return null}var t=a3(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function g7(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function gZ(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:gz(t,ab):U([""],{type:ab})):t?"string"!=typeof t?gu(t,function(ad){aa(h1(ad))}):aa(t):aa("")}function D(ac,aa,af,ah){function ag(){++t===ad.length&&ah&&ah()}function ab(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=af.objectStore(an).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ag()}}var ad=Object.keys(ac._attachments||{});if(!ad.length){return ah&&ah()}var t=0;ad.forEach(function(aj){aa.attachments&&aa.include_docs?ab(ac,aj):(ac._attachments[aj].stub=!0,ag())})}function fg(aa,t){return gy.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return gy.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new gy(function(aj){gZ(ah,af,t,function(ak){ac.doc._attachments[ag]=ez.extend(fR(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function iU(aa,aj,ad){function ag(){t--,t||af()}function af(){ac.length&&ac.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ah["delete"](am)}})}var ac=[],ak=ad.objectStore(gb),ah=ad.objectStore(an),ab=ad.objectStore(gH),t=aa.length;aa.forEach(function(al){var am=ak.index("_doc_id_rev"),ap=aj+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ag()}ak["delete"](au);var av=ab.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ac.push(ax),ab["delete"](aw.primaryKey),aw["continue"]()}else{ag()}}}})}function gi(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function s(ak,ah,aF,ab,aH,am,av){function af(){var aO=[iN,gb,an,iB,hD,gH],aP=gi(aH,aO,"readwrite");return aP.error?av(aP.error):(ax=aP.txn,ax.onabort=ht(av),ax.ontimeout=ht(av),ax.oncomplete=aL,aq=ax.objectStore(iN),ap=ax.objectStore(gb),au=ax.objectStore(an),ag=ax.objectStore(gH),void aN(function(aQ){return aQ?(aI=!0,av(aQ)):void ay()}))}function aw(){gR(ak.revs_limit,aG,ab,az,ax,ac,aK,aF)}function ay(){function aR(){++aP===aG.length&&aw()}function aT(aW){var aV=iW(aW.target.result);aV&&az.set(aV.id,aV),aR()}if(aG.length){for(var aP=0,aS=0,aQ=aG.length;aQ>aS;aS++){var aU=aG[aS];if(aU._id&&hr(aU._id)){aR()}else{var aO=aq.get(aU.metadata.id);aO.onsuccess=aT}}}}function aL(){aI||(am.notify(ab._meta.name),ab._meta.docCount+=t,av(null,ac))}function aA(aP,aQ){var aO=au.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=gx(hJ,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(aG.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){aA(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function aK(aR,aX,aT,aV,aU,aS,aP,aW){t+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?al(aR,aX,aT,aU,aP,aW):void aJ(aR,aX,aT,aU,aP,aW)}function aC(aO){var aP=im(aO.metadata);iU(aP,aO.metadata.id,ax)}function aJ(aP,aW,aT,aU,aR,aY){function aV(ba){aU&&ab.auto_compaction&&aC(aP),aS.seq=ba.target.result,delete aS.rev;var bb=fy(aS,aW,aT),bc=aq.put(bb);bc.onsuccess=aZ}function aX(bb){bb.preventDefault(),bb.stopPropagation();var bc=ap.index("_doc_id_rev"),ba=bc.getKey(aQ._doc_id_rev);ba.onsuccess=function(bd){var bf=ap.put(aQ,bd.target.result);bf.onsuccess=aV}}function aZ(){ac[aR]={ok:!0,id:aS.id,rev:aW},az.set(aP.metadata.id,aP.metadata),aB(aP,aS.seq,aY)}var aQ=aP.data,aS=aP.metadata;aQ._doc_id_rev=aS.id+"::"+aS.rev,delete aQ._id,delete aQ._rev;var aO=ap.put(aQ);aO.onsuccess=aV,aO.onerror=aX}function al(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&aJ(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(bb){var aZ=aQ.data._attachments[bb];if(aZ.stub){aP++,aO()}else{var bc=aZ.data;delete aZ.data;var ba=aZ.digest;aM(ba,bc,aW)}})}function aB(aR,aU,aP){function aS(){++aV===aO.length&&aP()}function aQ(aW){var aX=aR.data._attachments[aW].digest,aY=ag.put({seq:aU,digestSeq:aX+"::"+aU});aY.onsuccess=aS,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aS()}}var aV=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function aM(aP,aR,aO){var aQ=au.count(aP);aQ.onsuccess=function(aV){var aU=aV.target.result;if(aU){return aO()}var aS={digest:aP,body:aR},aT=au.put(aS);aT.onsuccess=aO}}for(var ax,aq,ap,au,ag,aa,aG=ah.docs,t=0,aE=0,aD=aG.length;aD>aE;aE++){var aj=aG[aE];aj._id&&hr(aj._id)||(aj=aG[aE]=ar(aj,aF.new_edits),aj.error&&!aa&&(aa=aj))}if(aa){return av(aa)}var ac=new Array(aG.length),az=new ja.Map,aI=!1,ad=ab._meta.blobSupport?"blob":"base64";f0(aG,ad,function(aO){return aO?av(aO):void af()})}function i9(aa,ac,ad,ab,t){try{if(aa&&ac){return t?IDBKeyRange.bound(ac,aa,!ad,!1):IDBKeyRange.bound(aa,ac,!1,!ad)}if(aa){return t?IDBKeyRange.upperBound(aa):IDBKeyRange.lowerBound(aa)}if(ac){return t?IDBKeyRange.lowerBound(ac,!ad):IDBKeyRange.upperBound(ac,!ad)}if(ab){return IDBKeyRange.only(ab)}}catch(af){return{error:af}}return null}function gf(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(gx(hO,ac.name,ac.message))}function hA(aa,ac,ad,ab){function t(ax,ak){function aA(aL,aM,aK){var aN=aL.id+"::"+aK;aI.get(aN).onsuccess=function(aO){aM.doc=g7(aO.target.result),ax.conflicts&&(aM.doc._conflicts=cr(aL)),D(aM.doc,ax,aD)}}function av(aN,aL,aM){var aO={id:aM.id,key:aM.id,value:{rev:aL}},aK=aM.deleted;if("ok"===ax.deleted){aB.push(aO),aK?(aO.value.deleted=!0,aO.doc=null):ax.include_docs&&aA(aM,aO,aL)}else{if(!aK&&au--<=0&&(aB.push(aO),ax.include_docs&&aA(aM,aO,aL),0===--am)){return}}aN["continue"]()}function aj(aK){ag=ac._meta.docCount;var aM=aK.target.result;if(aM){var aL=iW(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aq(){ak(null,{total_rows:ag,offset:ax.skip,rows:aB})}function az(){ax.attachments?fg(aB,ax.binary).then(aq):aq()}var ap="startkey" in ax?ax.startkey:!1,ay="endkey" in ax?ax.endkey:!1,aH="key" in ax?ax.key:!1,au=ax.skip||0,am="number"==typeof ax.limit?ax.limit:-1,aG=ax.inclusive_end!==!1,aE="descending" in ax&&ax.descending?"prev":null,aC=i9(ap,ay,aG,aH,aE);if(aC&&aC.error){return gf(ac,ax,aC.error,ak)}var ah=[iN,gb];ax.attachments&&ah.push(an);var aJ=gi(ad,ah,"readonly");if(aJ.error){return ak(aJ.error)}var aD=aJ.txn,al=aD.objectStore(iN),aF=aD.objectStore(gb),aw=aE?al.openCursor(aC,aE):al.openCursor(aC),aI=aF.index("_doc_id_rev"),aB=[],ag=0;aD.oncomplete=az,aw.onsuccess=aj}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ac._meta.docCount,offset:ah.skip,rows:[]}):void t(ah,ag)}af(aa,ab)}function ee(t){return new gy(function(ab){var aa=U([""]);t.objectStore(fq).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function iH(t,aa){var ab=this;gK.queue.push({action:function(ac){i2(ab,t,ac)},callback:aa}),iA()}function i2(ak,ap,ag){function ad(av){var aw=av.createObjectStore(iN,{keyPath:"id"});av.createObjectStore(gb,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(an,{keyPath:"digest"}),av.createObjectStore(iB,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(fq),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(hD,{keyPath:"_id"});var au=av.createObjectStore(gH,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ab(av,aw){var au=av.objectStore(iN);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=ij(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function ah(au){au.createObjectStore(hD,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function aq(aw,av){var ay=aw.objectStore(hD),ax=aw.objectStore(iN),az=aw.objectStore(gb),au=ax.openCursor();au.onsuccess=function(aB){var aE=aB.target.result;if(aE){var aK=aE.value,aH=aK.id,aI=hr(aH),aL=cn(aK);if(aI){var aC=aH+"::"+aL,aF=aH+"::",aA=aH+"::~",aD=az.index("_doc_id_rev"),aG=IDBKeyRange.bound(aF,aA,!1,!1),aJ=aD.openCursor(aG);aJ.onsuccess=function(aN){if(aJ=aN.target.result){var aM=aJ.value;aM._doc_id_rev===aC&&ay.put(aM),az["delete"](aJ.primaryKey),aJ["continue"]()}else{ax["delete"](aE.primaryKey),aE["continue"]()}}}else{aE["continue"]()}}else{av&&av()}}}function t(au){var av=au.createObjectStore(gH,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function aj(aw,av){var ay=aw.objectStore(gb),ax=aw.objectStore(an),az=aw.objectStore(gH),au=ax.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ay.openCursor().onsuccess=function(aJ){var aD=aJ.target.result;if(!aD){return av()}for(var aE=aD.value,aL=aD.primaryKey,aH=Object.keys(aE._attachments||{}),aF={},aG=0;aG<aH.length;aG++){var aI=aE._attachments[aH[aG]];aF[aI.digest]=!0}var aK=Object.keys(aF);for(aG=0;aG<aK.length;aG++){var aC=aK[aG];az.put({seq:aL,digestSeq:aC+"::"+aL})}aD["continue"]()}):av()}}function al(ax){function av(az){return az.data?iW(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ax.objectStore(gb),ay=ax.objectStore(iN),aw=ay.openCursor();aw.onsuccess=function(az){function aC(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=fy(aD,aD.winningRev,aD.deleted),aF=ay.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=az.target.result;if(aB){var aD=av(aB.value);return aD.winningRev=aD.winningRev||cn(aD),aD.seq?aA():void aC()}}}var ac=ap.name,am=null;ak._meta=null,ak.type=function(){return"idb"},ak._id=f3(function(au){au(null,ak._meta.instanceId)}),ak._bulkDocs=function(au,aw,av){s(ap,au,aw,ak,am,iH.Changes,av)},ak._get=function(ay,au,az){function aB(){az(ax,{doc:aA,metadata:av,ctx:aC})}var aA,av,ax,aC=au.ctx;if(!aC){var aw=gi(am,[iN,gb,an],"readonly");if(aw.error){return az(aw.error)}aC=aw.txn}aC.objectStore(iN).get(ay).onsuccess=function(aG){if(av=iW(aG.target.result),!av){return ax=gx(gD,"missing"),aB()}if(ij(av)&&!au.rev){return ax=gx(gD,"deleted"),aB()}var aE=aC.objectStore(gb),aD=au.rev||av.winningRev,aF=av.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=g7(aA)),aA?void aB():(ax=gx(gD,"missing"),aB())}}},ak._getAttachment=function(ay,aA,ax){var aw;if(aA.ctx){aw=aA.ctx}else{var av=gi(am,[iN,gb,an],"readonly");if(av.error){return ax(av.error)}aw=av.txn}var az=ay.digest,au=ay.content_type;aw.objectStore(an).get(az).onsuccess=function(aC){var aB=aC.target.result.body;gZ(aB,au,aA.binary,function(aD){ax(null,aD)})}},ak._info=function(aA){if(null===am||!ic[ac]){var aw=new Error("db isn't open");return aw.id="idbNull",aA(aw)}var av,ax,az=gi(am,[gb],"readonly");if(az.error){return aA(az.error)}var au=az.txn,ay=au.objectStore(gb).openCursor(null,"prev");ay.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,ax=ak._meta.docCount},au.oncomplete=function(){aA(null,{doc_count:ax,update_seq:av,idb_attachment_format:ak._meta.blobSupport?"binary":"base64"})}},ak._allDocs=function(av,au){hA(av,ak,am,au)},ak._changes=function(aJ){function aw(aP){function aM(){return aS.seq!==aR?aP["continue"]():(aL=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aF.get(aU);aT.onsuccess=function(aV){aN(g7(aV.target.result))}}function aN(aU){var aT=aJ.processChange(aU,aS,aJ);aT.seq=aS.seq;var aV=aG(aT);return"object"==typeof aV?aJ.complete(aV):(aV&&(aB++,az&&av.push(aT),aJ.attachments&&aJ.include_docs?D(aU,aJ,aK,function(){fg([aT],aJ.binary).then(function(){aJ.onChange(aT)})}):aJ.onChange(aT)),void (aB!==aI&&aP["continue"]()))}var aQ=g7(aP.value),aR=aP.key;if(aH&&!aH.has(aQ._id)){return aP["continue"]()}var aS;return(aS=aC.get(aQ._id))?aM():void (ax.get(aQ._id).onsuccess=function(aT){aS=iW(aT.target.result),aC.set(aQ._id,aS),aM()})}function aE(aN){var aM=aN.target.result;aM&&aw(aM)}function ay(){var aM=[iN,gb];aJ.attachments&&aM.push(an);var aN=gi(am,aM,"readonly");if(aN.error){return aJ.complete(aN.error)}aK=aN.txn,aK.onabort=ht(aJ.complete),aK.oncomplete=au,aA=aK.objectStore(gb),ax=aK.objectStore(iN),aF=aA.index("_doc_id_rev");var aO;aO=aJ.descending?aA.openCursor(null,"prev"):aA.openCursor(IDBKeyRange.lowerBound(aJ.since,!0)),aO.onsuccess=aE}function au(){function aM(){aJ.complete(null,{results:av,last_seq:aL})}!aJ.continuous&&aJ.attachments?fg(av).then(aM):aM()}if(aJ=ho(aJ),aJ.continuous){var aD=ac+":"+I();return iH.Changes.addListener(ac,aD,ak,aJ),iH.Changes.notify(ac),{cancel:function(){iH.Changes.removeListener(ac,aD)}}}var aH=aJ.doc_ids&&new ja.Set(aJ.doc_ids);aJ.since=aJ.since||0;var aL=aJ.since,aI="limit" in aJ?aJ.limit:-1;0===aI&&(aI=1);var az;az="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aK,aA,ax,aF,av=[],aB=0,aG=i8(aJ),aC=new ja.Map;ay()},ak._close=function(au){return null===am?au(gx(gm)):(am.close(),delete ic[ac],am=null,void au())},ak._getRevisionTree=function(ax,av){var au=gi(am,[iN],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(iN).get(ax);aw.onsuccess=function(aA){var az=iW(aA.target.result);az?av(null,az.rev_tree):av(gx(gD))}},ak._doCompaction=function(ay,aA,ax){var aw=[iN,gb,an,gH],av=gi(am,aw,"readwrite");if(av.error){return ax(av.error)}var az=av.txn,au=az.objectStore(iN);au.get(ay).onsuccess=function(aC){var aE=iW(aC.target.result);f2(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==aA.indexOf(aF)&&(aK.status="missing")}),iU(aA,ay,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(iN).put(fy(aE,aD,aB))},az.onabort=ht(ax),az.oncomplete=function(){ax()}},ak._getLocal=function(ax,av){var au=gi(am,[hD],"readonly");if(au.error){return av(au.error)}var ay=au.txn,aw=ay.objectStore(hD).get(ax);aw.onerror=ht(av),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,av(null,az)):av(gx(gD))}},ak._putLocal=function(ay,aD,az){"function"==typeof aD&&(az=aD,aD={}),delete ay._revisions;var aB=ay._rev,aA=ay._id;aB?ay._rev="0-"+(parseInt(aB.split("-")[1],10)+1):ay._rev="0-1";var av,aw=aD.ctx;if(!aw){var aC=gi(am,[hD],"readwrite");if(aC.error){return az(aC.error)}aw=aC.txn,aw.onerror=ht(az),aw.oncomplete=function(){av&&az(null,av)}}var au,ax=aw.objectStore(hD);aB?(au=ax.get(aA),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aB){var aG=ax.put(ay);aG.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)}}else{az(gx(z))}}):(au=ax.add(ay),au.onerror=function(aE){az(gx(z)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){av={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&az(null,av)})},ak._removeLocal=function(ay,au,az){"function"==typeof au&&(az=au,au={});var aB=au.ctx;if(!aB){var aA=gi(am,[hD],"readwrite");if(aA.error){return az(aA.error)}aB=aA.txn,aB.oncomplete=function(){av&&az(null,av)}}var av,ax=ay._id,aC=aB.objectStore(hD),aw=aC.get(ax);aw.onerror=ht(az),aw.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ay._rev?(aC["delete"](ax),av={ok:!0,id:ax,rev:"0-0"},au.ctx&&az(null,av)):az(gx(gD))}},ak._destroy=function(av,aw){iH.Changes.removeAllListeners(ac),iH.openReqList[ac]&&iH.openReqList[ac].result&&(iH.openReqList[ac].result.close(),delete ic[ac]);var au=indexedDB.deleteDatabase(ac);au.onsuccess=function(){iH.openReqList[ac]&&(iH.openReqList[ac]=null),hg()&&ac in localStorage&&delete localStorage[ac],aw(null,{ok:!0})},au.onerror=ht(aw)};var af=ic[ac];if(af){return am=af.idb,ak._meta=af.global,void O.nextTick(function(){ag(null,ak)})}var aa;aa=ap.storage?et(ac,ap.storage):indexedDB.open(ac,iu),"openReqList" in iH||(iH.openReqList={}),iH.openReqList[ac]=aa,aa.onupgradeneeded=function(aw){function ay(){var aA=au[az-1];az++,aA&&aA(ax,ay)}var av=aw.target.result;if(aw.oldVersion<1){return ad(av)}var ax=aw.currentTarget.transaction;aw.oldVersion<3&&ah(av),aw.oldVersion<4&&t(av);var au=[ab,aq,aj,al],az=aw.oldVersion;ay()},aa.onsuccess=function(ax){am=ax.target.result,am.onversionchange=function(){am.close(),delete ic[ac]},am.onabort=function(aA){console.error("Database has a global failure",aA.target.error),am.close(),delete ic[ac]};var ay=am.transaction([iB,fq,iN],"readwrite"),az=ay.objectStore(iB).get(iB),av=null,au=null,aw=null;az.onsuccess=function(aB){var aD=function(){null!==av&&null!==au&&null!==aw&&(ak._meta={name:ac,instanceId:aw,blobSupport:av,docCount:au},ic[ac]={idb:am,global:ak._meta},ag(null,ak))},aA=aB.target.result||{id:iB};ac+"_id" in aA?(aw=aA[ac+"_id"],aD()):(aw=I(),aA[ac+"_id"]=aw,ay.objectStore(iB).put(aA).onsuccess=function(){aD()}),gB||(gB=ee(ay)),gB.then(function(aE){av=aE,aD()});var aC=ay.objectStore(iN).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){au=aE.target.result,aD()}}},aa.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),ag(gx(hO,av))}}function et(t,aa){try{return indexedDB.open(t,{version:iu,storage:aa})}catch(ab){return indexedDB.open(t,iu)}}var ez=e(7),V="default" in ez?ez["default"]:ez,hq=e(6);hq="default" in hq?hq["default"]:hq;var ja=e(12);ja="default" in ja?ja["default"]:ja;var a4=e(4),dt=e(1);dt="default" in dt?dt["default"]:dt;var gw=e(2);gw="default" in gw?gw["default"]:gw;var io=e(10),iL="default" in io?io["default"]:io,hh=e(8);hh="default" in hh?hh["default"]:hh;var iF=e(14);iF="default" in iF?iF["default"]:iF;var f1=e(15);f1="default" in f1?f1["default"]:f1;var fp=e(16);fp="default" in fp?fp["default"]:fp;var gy="function"==typeof Promise?Promise:hh,fW=gk();hq(a2,Error),a2.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var f9=new a2({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hF=new a2({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),gD=new a2({status:404,error:"not_found",reason:"missing"}),z=new a2({status:409,error:"conflict",reason:"Document update conflict"}),g9=new a2({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gY=new a2({status:412,error:"missing_id",reason:"_id is required for puts"}),ig=new a2({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),gm=new a2({status:412,error:"precondition_failed",reason:"Database not open"}),iY=new a2({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),ib=new a2({status:500,error:"badarg",reason:"Some query argument is invalid"}),x=new a2({status:400,error:"invalid_request",reason:"Request was invalid"}),ie=new a2({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),gl=new a2({status:500,error:"doc_validation",reason:"Bad special document member"}),ei=new a2({status:400,error:"bad_request",reason:"Something wrong with the request"}),ex=new a2({status:400,error:"bad_request",reason:"Document must be a JSON object"}),gS=new a2({status:404,error:"not_found",reason:"Database not found"}),hO=new a2({status:500,error:"indexed_db_went_bad",reason:"unknown"}),hL=new a2({status:500,error:"web_sql_went_bad",reason:"unknown"}),iD=new a2({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),hQ=new a2({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),gs=new a2({status:400,error:"bad_request",reason:"Invalid rev format"}),hu=new a2({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),hJ=new a2({status:412,error:"missing_stub"}),co=new a2({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),i6={UNAUTHORIZED:f9,MISSING_BULK_DOCS:hF,MISSING_DOC:gD,REV_CONFLICT:z,INVALID_ID:g9,MISSING_ID:gY,RESERVED_ID:ig,NOT_OPEN:gm,UNKNOWN_ERROR:iY,BAD_ARG:ib,INVALID_REQUEST:x,QUERY_PARSE_ERROR:ie,DOC_VALIDATION:gl,BAD_REQUEST:ei,NOT_AN_OBJECT:ex,DB_MISSING:gS,WSQ_ERROR:hL,LDB_ERROR:iD,FORBIDDEN:hQ,INVALID_REV:gs,FILE_EXISTS:hu,MISSING_STUB:hJ,IDB_ERROR:hO,INVALID_URL:co},hx=function(aa,ac,ad){var ab=Object.keys(i6).filter(function(af){var ag=i6[af];return"function"!=typeof ag&&ag[aa]===ac}),t=ad&&ab.filter(function(af){var ag=i6[af];return ag.message===ad})[0]||ab[0];return t?i6[t]:null},gn=function(){},K=gw("pouchdb:api");hq(A,a4.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(aa){var ac=this,ad=aa.complete;if(aa=ho(aa),"live" in aa&&!("continuous" in aa)&&(aa.continuous=aa.live),aa.processChange=gh,"latest"===aa.since&&(aa.since="now"),aa.since||(aa.since=0),"now"===aa.since){return void this.db.info().then(function(af){return ac.isCancelled?void ad(null,{status:"cancelled"}):(aa.since=af.update_seq,void ac.doChanges(aa))},ad)}if(aa.continuous&&"now"!==aa.since&&this.db.info().then(function(af){ac.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),aa.filter&&"string"==typeof aa.filter&&("_view"===aa.filter?aa.view=F(aa.view):aa.filter=F(aa.filter),"http"!==this.db.type()&&!aa.doc_ids)){return this.filterChanges(aa)}"descending" in aa||(aa.descending=!1),aa.limit=0===aa.limit?1:aa.limit,aa.complete=ad;var ab=this.db._changes(aa);if(ab&&"function"==typeof ab.cancel){var t=ac.cancel;ac.cancel=dt(function(af){ab.cancel(),t.apply(this,af)})}},A.prototype.filterChanges=function(aa){var ac=this,ad=aa.complete;if("_view"===aa.filter){if(!aa.view||"string"!=typeof aa.view){var ab=gx(ei,"`view` filter parameter not found or invalid.");return ad(ab)}var t=L(aa.view);this.db.get("_design/"+t[0],function(aj,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(aj){return ad(fx(aj))}var ah=ag&&ag.views&&ag.views[t[1]]&&ag.views[t[1]].map;return ah?(aa.filter=de(ah),void ac.doChanges(aa)):ad(gx(gD,ag.views?"missing json key: "+t[1]:"missing json key: views"))})}else{var af=L(aa.filter);if(!af){return ac.doChanges(aa)}this.db.get("_design/"+af[0],function(ah,ag){if(ac.isCancelled){return ad(null,{status:"cancelled"})}if(ah){return ad(fx(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(aa.filter=h5(aj),void ac.doChanges(aa)):ad(gx(gD,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var a5="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),hR=J(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gE=J(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);hq(gT,a4.EventEmitter),gT.prototype.post=gA("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(gx(ex)):void this.bulkDocs({docs:[t]},aa,dn(ab))}),gT.prototype.put=gA("put",dt(function(t){var ab,ag,aa,ad,ac=t.shift(),af="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(ad=t.pop())(gx(ex))}for(;;){if(ab=t.shift(),ag=typeof ab,"string"!==ag||af?"string"!==ag||!af||"_rev" in ac?"object"===ag?aa=ab:"function"===ag&&(ad=ab):ac._rev=ab:(ac._id=ab,af=!0),!t.length){break}}return aa=aa||{},C(ac._id),hr(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,ad):this._putLocal(ac,ad):void this.bulkDocs({docs:[ac]},aa,dn(ad))})),gT.prototype.putAttachment=gA("putAttachment",function(ac,aa,af,ah,ag,ab){function ad(aj){return aj._attachments=aj._attachments||{},aj._attachments[aa]={content_type:ag,data:ah},t.put(aj)}var t=this;return"function"==typeof ag&&(ab=ag,ag=ah,ah=af,af=null),"undefined"==typeof ag&&(ag=ah,ah=af,af=null),t.get(ac).then(function(aj){if(aj._rev!==af){throw gx(z)}return ad(aj)},function(aj){if(aj.reason===gD.message){return ad({_id:ac})}throw aj})}),gT.prototype.removeAttachment=gA("removeAttachment",function(aa,ac,ad,ab){var t=this;t.get(aa,function(af,ag){return af?void ab(af):ag._rev!==ad?void ab(gx(z)):ag._attachments?(delete ag._attachments[ac],0===Object.keys(ag._attachments).length&&delete ag._attachments,void t.put(ag,ab)):ab()})}),gT.prototype.remove=gA("remove",function(aa,ac,ad,ab){var t;"string"==typeof ac?(t={_id:aa,_rev:ac},"function"==typeof ad&&(ab=ad,ad={})):(t=aa,"function"==typeof ac?(ab=ac,ad={}):(ab=ad,ad=ac)),ad=ad||{},ad.was_delete=!0;var af={_id:t._id,_rev:t._rev||ad.rev};return af._deleted=!0,hr(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(t,ab):void this.bulkDocs({docs:[af]},ad,dn(ab))}),gT.prototype.revsDiff=gA("revsDiff",function(ac,aa,af){function ah(ak,aj){t.has(ak)||t.set(ak,{missing:[]}),t.get(ak).missing.push(aj)}function ag(aj,ak){var al=ac[aj].slice(0);f2(ak,function(aq,av,aw,ap,au){var ax=av+"-"+aw,am=al.indexOf(ax);-1!==am&&(al.splice(am,1),"available"!==au.status&&ah(aj,ax))}),al.forEach(function(am){ah(aj,am)})}"function"==typeof aa&&(af=aa,aa={});var ab=Object.keys(ac);if(!ab.length){return af(null,{})}var ad=0,t=new ja.Map;ab.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){t.set(aj,{missing:ac[aj]})}else{if(al){return af(al)}ag(aj,am)}if(++ad===ab.length){var ak={};return t.forEach(function(ap,aq){ak[aq]=ap}),af(null,ak)}})},this)}),gT.prototype.bulkGet=gA("bulkGet",function(aa,t){fl(this,aa,t)}),gT.prototype.compactDocument=gA("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(ag,aj){if(ag){return ac(ag)}var af=ai(aj),ah=[],ad=[];Object.keys(af).forEach(function(ak){af[ak]>ab&&ah.push(ak)}),f2(aj,function(ap,au,al,aq,am){var ak=au+"-"+al;"available"===am.status&&-1!==ah.indexOf(ak)&&ad.push(ak)}),aa._doCompaction(t,ad,ac)})}),gT.prototype.compact=gA("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&h9(ab)}),gT.prototype._compact=function(t,ab){function ag(ah){af.push(ad.compactDocument(ah.id,0))}function aa(aj){var ah=aj.last_seq;gy.all(af).then(function(){return n(ad,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ab(null,{ok:!0})})["catch"](ab)}var ad=this,ac={return_docs:!1,last_seq:t.last_seq||0},af=[];ad.changes(ac).on("change",ag).on("complete",aa).on("error",ab)},gT.prototype.get=gA("get",function(ac,aa,af){function ah(){var ak=[],aj=ag.length;return aj?void ag.forEach(function(al){ab.get(ac,{rev:al,revs:aa.revs,attachments:aa.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||af(null,ak)})}):af(null,ak)}if("function"==typeof aa&&(af=aa,aa={}),"string"!=typeof ac){return af(gx(g9))}if(hr(ac)&&"function"==typeof this._getLocal){return this._getLocal(ac,af)}var ag=[],ab=this;if(!aa.open_revs){return this._get(ac,aa,function(aw,aB){if(aw){return af(aw)}var aq=aB.doc,ay=aB.metadata,ap=aB.ctx;if(aa.conflicts){var al=cr(ay);al.length&&(aq._conflicts=al)}if(ij(ay,aq._rev)&&(aq._deleted=!0),aa.revs||aa.revs_info){var au=E(ay.rev_tree),ax=iz(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aq._rev.split("-")[1])}),ak=ax.ids.map(function(aC){return aC.id}).indexOf(aq._rev.split("-")[1])+1,av=ax.ids.length-ak;if(ax.ids.splice(ak,av),ax.ids.reverse(),aa.revs&&(aq._revisions={start:ax.pos+ax.ids.length-1,ids:ax.ids.map(function(aC){return aC.id})}),aa.revs_info){var aj=ax.pos+ax.ids.length;aq._revs_info=ax.ids.map(function(aC){return aj--,{rev:aj+"-"+aC.id,status:aC.opts.status}})}}if(aa.attachments&&aq._attachments){var az=aq._attachments,am=Object.keys(az).length;if(0===am){return af(null,aq)}Object.keys(az).forEach(function(aC){this._getAttachment(az[aC],{binary:aa.binary,ctx:ap},function(aE,aD){var aF=aq._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--am||af(null,aq)})},ab)}else{if(aq._attachments){for(var aA in aq._attachments){aq._attachments.hasOwnProperty(aA)&&(aq._attachments[aA].stub=!0)}}af(null,aq)}})}if("all"===aa.open_revs){this._getRevisionTree(ac,function(ak,aj){return ak?af(ak):(ag=eu(aj).map(function(al){return al.rev}),void ah())})}else{if(!Array.isArray(aa.open_revs)){return af(gx(iY,"function_clause"))}ag=aa.open_revs;for(var ad=0;ad<ag.length;ad++){var t=ag[ad];if("string"!=typeof t||!/^\d+-/.test(t)){return af(gx(gs))}}ah()}}),gT.prototype.getAttachment=gA("getAttachment",function(aa,ac,ad,ab){var t=this;ad instanceof Function&&(ab=ad,ad={}),this._get(aa,ad,function(af,ag){return af?ab(af):ag.doc._attachments&&ag.doc._attachments[ac]?(ad.ctx=ag.ctx,ad.binary=!0,t._getAttachment(ag.doc._attachments[ac],ad,ab),void 0):ab(gx(gD))})}),gT.prototype.allDocs=gA("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(gx(ie,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return g6(this,t,aa)}}return this._allDocs(t,aa)}),gT.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new A(this,aa,t)},gT.prototype.close=gA("close",function(t){return this._closed=!0,this._close(t)}),gT.prototype.info=gA("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),gT.prototype.id=gA("id",function(t){return this._id(t)}),gT.prototype.bulkDocs=gA("bulkDocs",function(aa,ac,ad){if("function"==typeof ac&&(ad=ac,ac={}),ac=ac||{},Array.isArray(aa)&&(aa={docs:aa}),!aa||!aa.docs||!Array.isArray(aa.docs)){return ad(gx(hF))}for(var ab=0;ab<aa.docs.length;++ab){if("object"!=typeof aa.docs[ab]||Array.isArray(aa.docs[ab])){return ad(gx(ex))}}var t;return aa.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){t=t||g3(ag)})}),t?ad(gx(ei,t)):("new_edits" in ac||("new_edits" in aa?ac.new_edits=aa.new_edits:ac.new_edits=!0),ac.new_edits||"http"===this.type()||aa.docs.sort(iK),hb(aa.docs),this._bulkDocs(aa,ac,function(af,ag){return af?ad(af):(ac.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ad(null,ag))}))}),gT.prototype.registerDependentDatabase=gA("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);n(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),gT.prototype.destroy=gA("destroy",function(aa,ac){function ad(){ab._destroy(aa,function(ag,af){return ag?ac(ag):(ab.emit("destroyed"),void ac(null,af||{ok:!0}))})}"function"==typeof aa&&(ac=aa,aa={});var ab=this,t="use_prefix" in ab?ab.use_prefix:!0;return"http"===ab.type()?ad():void ab.get("_local/_pouch_dependentDbs",function(ag,aj){if(ag){return 404!==ag.status?ac(ag):ad()}var af=aj.dependentDbs,ah=ab.constructor,ak=Object.keys(af).map(function(al){var am=t?al.replace(new RegExp("^"+ah.prefix),""):al;return new ah(am,ab.__opts).destroy()});gy.all(ak).then(ad,ac)})}),iE.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},iE.prototype.fail=function(t){this.failed=t,this.execute()},iE.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},iE.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hq(gG,gT),gG.debug=gw;var v;if(fZ()){v=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),v=!!localStorage.getItem("_pouch_check_localstorage")}catch(jd){v=!1}}gG.adapters={},gG.preferredAdapters=[],gG.prefix="_pouch_";var gM=new a4.EventEmitter;f7(gG),gG.parseAdapter=function(ac,aa){var af,ah,ag=ac.match(/([a-z\-]*):\/\/(.*)/);if(ag){if(ac=/http(s?)/.test(ag[1])?ag[1]+"://"+ag[2]:ag[2],af=ag[1],!gG.adapters[af].valid()){throw"Invalid adapter"}return{name:ac,adapter:ag[1]}}var ab="idb" in gG.adapters&&"websql" in gG.adapters&&hg()&&localStorage["_pouch__websqldb_"+gG.prefix+ac];if(aa.adapter){ah=aa.adapter}else{if("undefined"!=typeof aa&&aa.db){ah="leveldb"}else{for(var ad=0;ad<gG.preferredAdapters.length;++ad){if(ah=gG.preferredAdapters[ad],ah in gG.adapters){if(ab&&"idb"===ah){console.log('PouchDB is downgrading "'+ac+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}af=gG.adapters[ah];var t=af&&"use_prefix" in af?af.use_prefix:!0;return{name:t?gG.prefix+ac:ac,adapter:ah}},gG.adapter=function(t,aa,ab){aa.valid()&&(gG.adapters[t]=aa,ab&&gG.preferredAdapters.push(t))},gG.plugin=function(t){return Object.keys(t).forEach(function(aa){gG.prototype[aa]=t[aa]}),gG},gG.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=ez.extend({},aa,ad),void gG.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hq(t,gG),f7(t),t.preferredAdapters=gG.preferredAdapters.slice(),Object.keys(gG).forEach(function(ab){ab in t||(t[ab]=gG[ab])}),t};var iR=function(t){return atob(t)},h1=function(t){return btoa(t)},S=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],er="queryKey",fn=/(?:^|&)([^&=]*)=?([^&]*)/g,fV=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,l=V.extend,f={ajax:f6,parseUri:hV,uuid:I,Promise:gy,atob:iR,btoa:h1,binaryStringToBlobOrBuffer:gO,clone:ho,extend:l,createError:gx},je=iL.collate,a8=1,fs="pouchdb",gQ=5,fh=0;B.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},B.prototype.updateTarget=function(aa,t){return ge(this.target,this.id,aa,t,this.returnValue)},B.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?gy.resolve(!0):ge(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return ab.readOnlySource=!0,!0}throw ac})};var g0={undefined:function(aa,t){return 0===je(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return gC(t,aa).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return fh}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in g0?g0[ab](aa,ac):fh},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:fh}).then(function(){return fh},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):fh})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return fh})};var gW=0,a1=X.setImmediate||X.setTimeout,hk=32768,fd=f3(function(aa,aj){function ad(){var aq=ah*ac,al=aq+ac;if(ah++,ak>ah){t(ab,aa,aq,al),a1(ad)}else{t(ab,aa,aq,al);var ap=ab.end(!0),am=hX(ap);aj(null,am),ab.destroy()}}var ag="string"==typeof aa,af=ag?aa.length:aa.byteLength,ac=Math.min(hk,af),ak=Math.ceil(af/ac),ah=0,ab=ag?new f1:new f1.ArrayBuffer,t=ag?fb:he;ad()});hq(fY,a4.EventEmitter),fY.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},fY.prototype.ready=function(aa,ac){function ad(){t.cancel()}function ab(){aa.removeListener("destroyed",ad),ac.removeListener("destroyed",ad)}var t=this;t._readyCalled||(t._readyCalled=!0,aa.once("destroyed",ad),ac.once("destroyed",ad),t.once("complete",ab))};var ga={replicate:iT,toPouch:r},ft=ga.replicate;hq(es,a4.EventEmitter),es.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var br=25,hy=50,go={},h=1800,g1=gw("pouchdb:http");ir.valid=function(){return !0};var ih=function(aa,t){return t&&aa.then(function(ab){O.nextTick(function(){t(null,ab)})},function(ab){O.nextTick(function(){t(ab)})}),aa},gc=function(t){return dt(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&ih(ab,aa),ab})},iS=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},h2=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},Z=function(aa){for(var ac={},ad=0,ab=aa.length;ab>ad;ad++){ac["$"+aa[ad]]=!0}var t=Object.keys(ac),af=new Array(t.length);for(ad=0,ab=t.length;ab>ad;ad++){af[ad]=t[ad].substring(1)}return af},h4={uniq:Z,sequentialize:h2,fin:iS,callbackify:gc,promisedCallback:ih};hn.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},hn.prototype.finish=function(){return this.promise};var gg,ey=iL.collate,hC=iL.toIndexableString,iV=iL.normalizeKey,ip=iL.parseIndexableString;gg="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var hz=h4.callbackify,ik=h4.sequentialize,ji=h4.uniq,g2=h4.fin,ha=h4.promisedCallback,hE={},ae=new hn,iZ=50,hi={_sum:function(aa,t){return i1(t)},_count:function(aa,t){return t.length},_stats:function(t,aa){function ab(ac){for(var af=0,ag=0,ad=ac.length;ad>ag;ag++){var ah=ac[ag];af+=ah*ah}return af}return{sum:i1(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},bt=hz(function(){var t=this;return"http"===t.type()?en(t):"function"==typeof t._viewCleanup?f5(t):gr(t)}),H=function(aa,ac,ad){"function"==typeof ac&&(ad=ac,ac={}),ac=ac?ii(ac):{},"function"==typeof aa&&(aa={map:aa});var ab=this,t=gy.resolve().then(function(){return hU(ab,aa,ac)});return ha(t,ad),t};hq(hS,Error),hq(gN,Error),hq(w,Error);var fw={query:H,viewCleanup:bt},hP=7,gp=jg("document-store"),u=jg("by-sequence"),jc=jg("attach-store"),gv=jg("local-store"),hG=jg("metadata-store"),fa=jg("attach-seq-store"),iI={};hq(hj,a4.EventEmitter),hj.prototype.addListener=function(t,ab,ag,aa){function ad(){function ah(){af=!1}if(ac._listeners[ab]){if(af){return void (af="waiting")}af=!0;var aj=fR(aa,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>aa.since&&!aa.cancelled&&(aa.since=ak.seq,aa.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ad()},0),af=!1}).on("error",ah)}}if(!this._listeners[ab]){var ac=this,af=!1;this._listeners[ab]=ad,this.on(t,ad)}},hj.prototype.removeListener=function(aa,t){t in this._listeners&&a4.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},hj.prototype.notifyLocalWindows=function(t){fZ()?chrome.storage.local.set({dbName:t}):hg()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},hj.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var gI=1,fU="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+u+" (seq, deleted)",ff="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+u+" (doc_id, rev)",i="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+gp+" (winningseq)",hv="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+fa+" (seq)",jb="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+fa+" (digest, seq)",a6=u+".seq = "+gp+".winningseq",fc=u+".seq AS seq, "+u+".deleted AS deleted, "+u+".json AS data, "+u+".rev AS rev, "+gp+".json AS metadata";jh.valid=eo,jh.Changes=new hj;var gB,iu=5,iN="document-store",gb="by-sequence",an="attach-store",gH="attach-seq-store",iB="meta-store",hD="local-store",fq="detect-blob-support",gK={running:!1,queue:[]},ic={};iH.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},iH.Changes=new hj;var iM={idb:iH,websql:jh};gG.ajax=f6,gG.utils=f,gG.Errors=i6,gG.replicate=ga.replicate,gG.sync=hw,gG.version="5.2.0",gG.adapter("http",ir),gG.adapter("https",ir),gG.plugin(fw),Object.keys(iM).forEach(function(t){gG.adapter(t,iM[t],!0)}),a.exports=gG}).call(this,e(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});